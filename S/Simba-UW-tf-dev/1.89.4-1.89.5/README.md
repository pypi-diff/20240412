# Comparing `tmp/Simba-UW-tf-dev-1.89.4.tar.gz` & `tmp/Simba-UW-tf-dev-1.89.5.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "dist/Simba-UW-tf-dev-1.89.4.tar", last modified: Thu Apr  4 17:31:02 2024, max compression
+gzip compressed data, was "dist/Simba-UW-tf-dev-1.89.5.tar", last modified: Thu Apr 11 20:42:17 2024, max compression
```

## Comparing `Simba-UW-tf-dev-1.89.4.tar` & `Simba-UW-tf-dev-1.89.5.tar`

### file list

```diff
@@ -1,624 +1,637 @@
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:02.000000 Simba-UW-tf-dev-1.89.4/
--rw-r--r--   0 simon      (501) staff       (20)     2797 2024-04-04 17:31:02.000000 Simba-UW-tf-dev-1.89.4/PKG-INFO
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/ui/
--rw-r--r--   0 simon      (501) staff       (20)     6148 2024-03-28 13:50:53.000000 Simba-UW-tf-dev-1.89.4/simba/ui/.DS_Store
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:02.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/
--rw-r--r--   0 simon      (501) staff       (20)    11467 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/mutual_exclusivity_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     4070 2024-03-29 20:30:28.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/movement_analysis_time_bins_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     1676 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/csv_2_parquet_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     2566 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/quick_path_plot_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     2873 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/batch_preprocess_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     8835 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/heatmap_location_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     9734 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/clf_probability_plot_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     3456 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/movement_analysis_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     4631 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/set_machine_model_parameters_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)    11362 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/clf_plot_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)    24905 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/path_plot_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     1184 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/remove_roi_features_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     6692 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/targeted_annotation_clips_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     3340 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/smoothing_interpolation_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     2174 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/roi_size_standardizer_popup.py
--rw-r--r--   0 simon      (501) staff       (20)     6630 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/visualize_pose_in_dir_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     5068 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/roi_analysis_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     7898 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/outlier_settings_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     9048 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/gantt_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     6293 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/clf_validation_plot_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     8529 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/severity_analysis_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     3221 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/fsttc_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     4231 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/kleinberg_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     7979 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/directing_other_animals_plot_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     9785 2024-03-29 16:15:58.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/spontaneous_alternation_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     6076 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/pose_reorganizer_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     3437 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/animal_directing_other_animals_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     3402 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/append_roi_features_animals_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     3468 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/clf_by_timebins_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     9153 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/heatmap_clf_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     9235 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/data_plot_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)    11785 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/roi_features_plot_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     9118 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/pup_retrieval_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     5577 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/boolean_conditional_slicer_pup_up.py
--rw-r--r--   0 simon      (501) staff       (20)      584 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/about_simba_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     5451 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/clf_descriptive_statistics_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)    10747 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/roi_tracking_plot_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     1795 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/append_roi_features_bodypart_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     7312 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/directing_animal_to_bodypart_plot_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     6546 2024-02-16 01:12:37.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/clf_add_remove_print_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)    64679 2024-03-14 19:32:58.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/video_processing_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     7800 2024-04-04 16:47:32.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/validation_plot_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     6160 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/clf_by_roi_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     2741 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/make_path_plot_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     3622 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/direction_animal_to_bodypart_settings_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     6166 2024-03-06 18:18:27.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/create_user_defined_pose_configuration_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     1072 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/archive_files_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     4716 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/pose_bp_drop_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)    11832 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/distance_plot_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     4673 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/subset_feature_extractor_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     3290 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/third_party_annotator_appender_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     4134 2024-03-31 17:07:13.000000 Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/roi_analysis_time_bins_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)    16701 2024-02-08 00:53:55.000000 Simba-UW-tf-dev-1.89.4/simba/ui/video_info_ui.py
--rw-r--r--   0 simon      (501) staff       (20)     6573 2024-03-04 17:48:55.000000 Simba-UW-tf-dev-1.89.4/simba/ui/user_defined_pose_creator.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/ui/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    14374 2024-03-06 18:18:27.000000 Simba-UW-tf-dev-1.89.4/simba/ui/create_project_ui.py
--rw-r--r--   0 simon      (501) staff       (20)    14487 2024-02-08 00:53:55.000000 Simba-UW-tf-dev-1.89.4/simba/ui/tkinter_functions.py
--rw-r--r--   0 simon      (501) staff       (20)    38870 2024-04-04 16:45:40.000000 Simba-UW-tf-dev-1.89.4/simba/ui/machine_model_settings_ui.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/labelling/
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/labelling/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    24423 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/labelling/labelling_interface.py
--rw-r--r--   0 simon      (501) staff       (20)     2362 2024-02-21 02:33:04.000000 Simba-UW-tf-dev-1.89.4/simba/labelling/targeted_annotations_clips.py
--rw-r--r--   0 simon      (501) staff       (20)     3974 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/labelling/extract_labelled_frames.py
--rw-r--r--   0 simon      (501) staff       (20)    31269 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/labelling/labelling_advanced_interface.py
--rw-r--r--   0 simon      (501) staff       (20)    10012 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/labelling/play_annotation_video.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:02.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/
--rw-r--r--   0 simon      (501) staff       (20)    15004 2024-03-29 19:51:46.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/dbcv_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)     5077 2024-03-29 19:51:46.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/cluster_validation_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)     3645 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/enums.py
--rw-r--r--   0 simon      (501) staff       (20)     6148 2024-04-03 14:33:55.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/.DS_Store
--rw-r--r--   0 simon      (501) staff       (20)     9036 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/cluster_video_visualizer.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:02.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/pop_ups/
--rw-r--r--   0 simon      (501) staff       (20)     4642 2024-03-26 23:50:53.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/pop_ups/cluster_videos_popup.py
--rw-r--r--   0 simon      (501) staff       (20)     4027 2024-02-20 21:35:22.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/pop_ups/transform_cluster_popup.py
--rw-r--r--   0 simon      (501) staff       (20)     5048 2024-02-15 23:45:22.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/pop_ups/embedding_correlations_popup.py
--rw-r--r--   0 simon      (501) staff       (20)     6148 2024-04-02 14:39:26.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/pop_ups/.DS_Store
--rw-r--r--   0 simon      (501) staff       (20)     4070 2024-02-20 21:35:22.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/pop_ups/transform_dim_reduction_popup.py
--rw-r--r--   0 simon      (501) staff       (20)    11182 2024-02-15 23:45:22.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/pop_ups/fit_dim_reduction_popup.py
--rw-r--r--   0 simon      (501) staff       (20)     2546 2024-03-29 19:51:46.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/pop_ups/data_extractor_popup.py
--rw-r--r--   0 simon      (501) staff       (20)     4536 2024-03-29 19:51:46.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/pop_ups/cluster_validation_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     9305 2024-02-15 23:45:22.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/pop_ups/fit_cluster_popup.py
--rw-r--r--   0 simon      (501) staff       (20)     2574 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/pop_ups/clusterer_comparison_popup.py
--rw-r--r--   0 simon      (501) staff       (20)     6527 2024-03-26 23:50:53.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/pop_ups/grid_search_visualizer_popup.py
--rw-r--r--   0 simon      (501) staff       (20)     4332 2024-03-28 20:02:59.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/pop_ups/cluster_xai_popup.py
--rw-r--r--   0 simon      (501) staff       (20)     3820 2024-03-29 16:15:58.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/pop_ups/cluster_frequentist_stats_popup.py
--rw-r--r--   0 simon      (501) staff       (20)     2355 2024-02-20 21:35:22.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/pop_ups/print_embedding_info_popup.py
--rw-r--r--   0 simon      (501) staff       (20)     9946 2024-04-02 18:34:25.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/dataset_creator.py
--rw-r--r--   0 simon      (501) staff       (20)    12982 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/unsupervised_main.py
--rw-r--r--   0 simon      (501) staff       (20)    10175 2024-03-27 12:56:51.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/grid_search_visualizers.py
--rw-r--r--   0 simon      (501) staff       (20)    16005 2024-03-29 16:15:58.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/data_extractor.py
--rw-r--r--   0 simon      (501) staff       (20)     5241 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/outlier_detector.py
--rw-r--r--   0 simon      (501) staff       (20)    10397 2024-03-29 16:15:58.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/cluster_frequentist_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)     5798 2024-03-27 12:56:51.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/embedding_correlation_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    18194 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/cluster_xai_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)    15581 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/umap_embedder.py
--rw-r--r--   0 simon      (501) staff       (20)     5582 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/clusterer_comparison_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)     4652 2024-03-26 19:09:58.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/bout_aggregator.py
--rw-r--r--   0 simon      (501) staff       (20)     2188 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/data_map.yaml
--rw-r--r--   0 simon      (501) staff       (20)    14765 2024-03-26 19:09:58.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/hdbscan_clusterer.py
--rw-r--r--   0 simon      (501) staff       (20)     3862 2024-02-15 21:37:53.000000 Simba-UW-tf-dev-1.89.4/simba/unsupervised/tsne.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/bounding_box_tools/
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/bounding_box_tools/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     8511 2024-02-08 00:53:55.000000 Simba-UW-tf-dev-1.89.4/simba/bounding_box_tools/agg_boundary_stats.py
--rw-r--r--   0 simon      (501) staff       (20)    27255 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/bounding_box_tools/boundary_menus.py
--rw-r--r--   0 simon      (501) staff       (20)    10064 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/bounding_box_tools/boundary_statistics.py
--rw-r--r--   0 simon      (501) staff       (20)     7146 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/bounding_box_tools/find_boundaries.py
--rw-r--r--   0 simon      (501) staff       (20)    12066 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/bounding_box_tools/visualize_boundaries.py
--rw-r--r--   0 simon      (501) staff       (20)    18436 2024-04-03 14:47:57.000000 Simba-UW-tf-dev-1.89.4/simba/.DS_Store
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/
--rw-r--r--   0 simon      (501) staff       (20)    57052 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/feature_extractor_14bp.py
--rw-r--r--   0 simon      (501) staff       (20)    28094 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/feature_extractor_7bp.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/
--rw-r--r--   0 simon      (501) staff       (20)     1757 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/doctests.py
--rw-r--r--   0 simon      (501) staff       (20)    29328 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/fish_feature_extractor_2023_version_3.py
--rw-r--r--   0 simon      (501) staff       (20)     2705 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/read_in_mp.py
--rw-r--r--   0 simon      (501) staff       (20)     2689 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/peaks.py
--rw-r--r--   0 simon      (501) staff       (20)    16727 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/fish_feature_extractor_2022.py
--rw-r--r--   0 simon      (501) staff       (20)     2144 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/convex_hull_3_scratch_3.py
--rw-r--r--   0 simon      (501) staff       (20)     5762 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/convex_hull_scratch_1.py
--rw-r--r--   0 simon      (501) staff       (20)    26425 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/fish_feature_extractor_2023_version_2.py
--rw-r--r--   0 simon      (501) staff       (20)     7535 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/egocentrical_aligner.py
--rw-r--r--   0 simon      (501) staff       (20)     1274 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/count_values_in_range.py
--rw-r--r--   0 simon      (501) staff       (20)     5011 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/graph_creator.py
--rw-r--r--   0 simon      (501) staff       (20)     3954 2024-02-07 20:55:52.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/termite_rois.csv
--rw-r--r--   0 simon      (501) staff       (20)      736 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/mutual_exclusive.py
--rw-r--r--   0 simon      (501) staff       (20)     2883 2024-02-07 20:55:52.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/video_color.py
--rw-r--r--   0 simon      (501) staff       (20)     2055 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/graph_3d_plotter.py
--rw-r--r--   0 simon      (501) staff       (20)     5515 2024-02-07 20:55:52.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/video_rotator.py
--rw-r--r--   0 simon      (501) staff       (20)     2932 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/add_probability_cnt_features.py
--rw-r--r--   0 simon      (501) staff       (20)     1619 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/make_splash.py
--rw-r--r--   0 simon      (501) staff       (20)    37024 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/fish_feature_extractor_2023_version_5.py
--rw-r--r--   0 simon      (501) staff       (20)     1613 2024-02-07 20:55:52.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/time_stamp_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)     5515 2024-02-07 20:55:52.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/video_rotator_mp.py
--rw-r--r--   0 simon      (501) staff       (20)    37022 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/fish_feature_extractor_2023_version_4.py
--rw-r--r--   0 simon      (501) staff       (20)     2068 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/convex_hull_scratch_2.py
--rw-r--r--   0 simon      (501) staff       (20)    36307 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/feature_extractor_8bps_2_animals.py
--rw-r--r--   0 simon      (501) staff       (20)     6148 2024-02-21 02:05:27.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/.DS_Store
--rw-r--r--   0 simon      (501) staff       (20)     4091 2024-02-16 21:14:07.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/perimeter_jit.py
--rw-r--r--   0 simon      (501) staff       (20)    26471 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/feature_subsets.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    10043 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/feature_extractor_user_defined.py
--rw-r--r--   0 simon      (501) staff       (20)    61607 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/feature_extractor_16bp.py
--rw-r--r--   0 simon      (501) staff       (20)    37328 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/feature_extractor_9bp.py
--rw-r--r--   0 simon      (501) staff       (20)    31163 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/feature_extractor_8bp.py
--rw-r--r--   0 simon      (501) staff       (20)    21427 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/feature_extractor_4bp.py
--rw-r--r--   0 simon      (501) staff       (20)    65534 2024-03-01 16:55:51.000000 Simba-UW-tf-dev-1.89.4/simba/feature_extractors/amber_feature_extractor.py
--rw-r--r--   0 simon      (501) staff       (20)     1025 2024-02-15 19:54:23.000000 Simba-UW-tf-dev-1.89.4/simba/requirements.txt
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/mixins/
--rw-r--r--   0 simon      (501) staff       (20)    40917 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/mixins/annotator_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)    78729 2024-04-03 16:12:54.000000 Simba-UW-tf-dev-1.89.4/simba/mixins/timeseries_features_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)     6148 2024-04-03 14:38:30.000000 Simba-UW-tf-dev-1.89.4/simba/mixins/.DS_Store
--rw-r--r--   0 simon      (501) staff       (20)    53232 2024-03-29 19:51:46.000000 Simba-UW-tf-dev-1.89.4/simba/mixins/pop_up_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)    48428 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/mixins/config_reader.py
--rw-r--r--   0 simon      (501) staff       (20)    56178 2024-03-19 20:48:49.000000 Simba-UW-tf-dev-1.89.4/simba/mixins/circular_statistics.py
--rw-r--r--   0 simon      (501) staff       (20)    32080 2024-03-14 19:32:58.000000 Simba-UW-tf-dev-1.89.4/simba/mixins/network_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/mixins/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    24046 2024-02-20 21:35:22.000000 Simba-UW-tf-dev-1.89.4/simba/mixins/pose_importer_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)     3020 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/mixins/video_processing_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)    35309 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.89.4/simba/mixins/feature_extraction_supplement_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)   143047 2024-04-04 16:47:34.000000 Simba-UW-tf-dev-1.89.4/simba/mixins/statistics_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)    44711 2024-03-14 19:32:58.000000 Simba-UW-tf-dev-1.89.4/simba/mixins/feature_extraction_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)    78530 2024-04-04 14:00:03.000000 Simba-UW-tf-dev-1.89.4/simba/mixins/plotting_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)      391 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/mixins/abstract_classes.py
--rw-r--r--   0 simon      (501) staff       (20)    56806 2024-03-07 19:24:42.000000 Simba-UW-tf-dev-1.89.4/simba/mixins/image_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)      880 2024-03-06 18:18:27.000000 Simba-UW-tf-dev-1.89.4/simba/mixins/unsupervised_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)   132883 2024-03-29 19:51:46.000000 Simba-UW-tf-dev-1.89.4/simba/mixins/train_model_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)   166246 2024-03-29 16:15:58.000000 Simba-UW-tf-dev-1.89.4/simba/mixins/geometry_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)    24978 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/mixins/feature_extraction_circular_mixin.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/third_party_label_appenders/
--rw-r--r--   0 simon      (501) staff       (20)     6639 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/third_party_label_appenders/deepethogram_importer.py
--rw-r--r--   0 simon      (501) staff       (20)    12306 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/third_party_label_appenders/BORIS_appender.py
--rw-r--r--   0 simon      (501) staff       (20)     9739 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/third_party_label_appenders/observer_importer.py
--rw-r--r--   0 simon      (501) staff       (20)     6148 2024-03-22 19:49:42.000000 Simba-UW-tf-dev-1.89.4/simba/third_party_label_appenders/.DS_Store
--rw-r--r--   0 simon      (501) staff       (20)     5508 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/third_party_label_appenders/boris_source_cleaner.py
--rw-r--r--   0 simon      (501) staff       (20)    18982 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/third_party_label_appenders/tools.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/third_party_label_appenders/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    18852 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/third_party_label_appenders/third_party_appender.py
--rw-r--r--   0 simon      (501) staff       (20)     9215 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/third_party_label_appenders/ethovision_import.py
--rw-r--r--   0 simon      (501) staff       (20)     7456 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/third_party_label_appenders/BENTO_appender.py
--rw-r--r--   0 simon      (501) staff       (20)     5662 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/third_party_label_appenders/solomon_importer.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/cue_light_tools/
--rw-r--r--   0 simon      (501) staff       (20)     8841 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/cue_light_tools/cue_light_clf_statistics.py
--rw-r--r--   0 simon      (501) staff       (20)    14451 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/cue_light_tools/cue_light_analyzer.py
--rw-r--r--   0 simon      (501) staff       (20)    18274 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/cue_light_tools/cue_light_menues.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/cue_light_tools/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     1921 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/cue_light_tools/cue_light_tools.py
--rw-r--r--   0 simon      (501) staff       (20)    19237 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/cue_light_tools/cue_light_visualizer.py
--rw-r--r--   0 simon      (501) staff       (20)    15278 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/cue_light_tools/cue_light_movement_statistics.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/__init__.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:02.000000 Simba-UW-tf-dev-1.89.4/simba/utils/
--rw-r--r--   0 simon      (501) staff       (20)    13211 2024-02-16 01:12:37.000000 Simba-UW-tf-dev-1.89.4/simba/utils/config_creator.py
--rw-r--r--   0 simon      (501) staff       (20)    26038 2024-03-27 13:42:19.000000 Simba-UW-tf-dev-1.89.4/simba/utils/enums.py
--rw-r--r--   0 simon      (501) staff       (20)    10394 2024-02-20 21:35:22.000000 Simba-UW-tf-dev-1.89.4/simba/utils/custom_feature_extractor.py
--rw-r--r--   0 simon      (501) staff       (20)     6148 2024-03-28 13:50:53.000000 Simba-UW-tf-dev-1.89.4/simba/utils/.DS_Store
--rw-r--r--   0 simon      (501) staff       (20)     7737 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.89.4/simba/utils/warnings.py
--rw-r--r--   0 simon      (501) staff       (20)    47299 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.89.4/simba/utils/checks.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/utils/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    75371 2024-04-04 16:47:32.000000 Simba-UW-tf-dev-1.89.4/simba/utils/read_write.py
--rw-r--r--   0 simon      (501) staff       (20)    15327 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.89.4/simba/utils/lookups.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:02.000000 Simba-UW-tf-dev-1.89.4/simba/utils/cli/
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/utils/cli/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     7129 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/utils/cli/cli_tools.py
--rw-r--r--   0 simon      (501) staff       (20)    17086 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/utils/errors.py
--rw-r--r--   0 simon      (501) staff       (20)    44962 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.89.4/simba/utils/data.py
--rw-r--r--   0 simon      (501) staff       (20)      717 2024-03-06 18:18:27.000000 Simba-UW-tf-dev-1.89.4/simba/utils/keyboard_listener.py
--rw-r--r--   0 simon      (501) staff       (20)     4205 2024-02-21 03:51:46.000000 Simba-UW-tf-dev-1.89.4/simba/utils/printing.py
--rw-r--r--   0 simon      (501) staff       (20)   243998 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/SimBA_logo.ico
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/pose_processors/
--rw-r--r--   0 simon      (501) staff       (20)     8626 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/pose_processors/reorganize_keypoint.py
--rw-r--r--   0 simon      (501) staff       (20)     5840 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/pose_processors/remove_keypoints.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/pose_processors/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     2872 2024-02-15 23:39:58.000000 Simba-UW-tf-dev-1.89.4/simba/pose_processors/pose_reset.py
--rw-r--r--   0 simon      (501) staff       (20)     6313 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/pose_processors/reverse_pose.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/
--rw-r--r--   0 simon      (501) staff       (20)      786 2024-03-06 18:18:27.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/doctests.py
--rw-r--r--   0 simon      (501) staff       (20)    29328 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/fish_feature_extractor_2023_version_3.py
--rw-r--r--   0 simon      (501) staff       (20)     2387 2024-03-08 14:35:02.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/dprime.py
--rw-r--r--   0 simon      (501) staff       (20)     2516 2024-03-18 17:01:43.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/linear_fretchet.py
--rw-r--r--   0 simon      (501) staff       (20)     2705 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/read_in_mp.py
--rw-r--r--   0 simon      (501) staff       (20)    39146 2024-04-03 16:37:52.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/two_fish_feature_extractor_040324.py
--rw-r--r--   0 simon      (501) staff       (20)     2391 2024-03-14 12:45:59.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/piotr_120324 3.py.zip
--rw-r--r--   0 simon      (501) staff       (20)     2036 2024-03-28 18:29:59.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/dunn_index.py
--rw-r--r--   0 simon      (501) staff       (20)     3567 2024-03-18 15:02:27.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/hausdorff.py
--rw-r--r--   0 simon      (501) staff       (20)     2689 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/peaks.py
--rw-r--r--   0 simon      (501) staff       (20)    16727 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/fish_feature_extractor_2022.py
--rw-r--r--   0 simon      (501) staff       (20)     3494 2024-04-03 13:42:02.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/colinear_features.py
--rw-r--r--   0 simon      (501) staff       (20)     8921 2024-03-22 13:56:46.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/spontaneous_alternation_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)     2144 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/convex_hull_3_scratch_3.py
--rw-r--r--   0 simon      (501) staff       (20)     1103 2024-03-29 16:26:34.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/silhouette_score.py
--rw-r--r--   0 simon      (501) staff       (20)    33092 2024-02-22 15:57:45.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/cuda_jit.ipynb
--rw-r--r--   0 simon      (501) staff       (20)     5762 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/convex_hull_scratch_1.py
--rw-r--r--   0 simon      (501) staff       (20)     1867 2024-03-12 19:23:40.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/directed_hausdorff.py
--rw-r--r--   0 simon      (501) staff       (20)      963 2024-03-13 18:20:52.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/shannon_diversity_index.py
--rw-r--r--   0 simon      (501) staff       (20)     3726 2024-03-12 13:31:58.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/sequential_lag_analysis.py
--rw-r--r--   0 simon      (501) staff       (20)     1254 2024-03-13 16:09:50.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/wilcoxon.py
--rw-r--r--   0 simon      (501) staff       (20)     6148 2024-04-03 14:47:57.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/.DS_Store
--rw-r--r--   0 simon      (501) staff       (20)     3328 2024-03-08 15:05:36.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/data.npy
--rw-r--r--   0 simon      (501) staff       (20)    12626 2024-03-25 20:59:27.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/distances.py
--rw-r--r--   0 simon      (501) staff       (20)    26425 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/fish_feature_extractor_2023_version_2.py
--rw-r--r--   0 simon      (501) staff       (20)     2699 2024-03-10 16:29:57.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/cohens_kappa.py
--rw-r--r--   0 simon      (501) staff       (20)     2465 2024-03-08 17:38:19.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/paths.py
--rw-r--r--   0 simon      (501) staff       (20)     1048 2024-03-13 14:41:23.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/outliers_tietjen.py
--rw-r--r--   0 simon      (501) staff       (20)     1424 2024-02-26 15:46:14.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/train_model.py
--rw-r--r--   0 simon      (501) staff       (20)     3171 2024-02-27 21:31:05.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/amber_tests.py
--rw-r--r--   0 simon      (501) staff       (20)     3590 2024-03-11 17:05:31.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/line_locate_point.py
--rw-r--r--   0 simon      (501) staff       (20)     3182 2024-02-24 20:57:19.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/multifrm_to_points.py
--rw-r--r--   0 simon      (501) staff       (20)       69 2024-03-18 18:17:24.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/lcs.py
--rw-r--r--   0 simon      (501) staff       (20)     7535 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/egocentrical_aligner.py
--rw-r--r--   0 simon      (501) staff       (20)     2350 2024-03-12 17:58:33.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/add_body_part.py
--rw-r--r--   0 simon      (501) staff       (20)     1008 2024-03-12 13:29:20.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/grubbs_test.py
--rw-r--r--   0 simon      (501) staff       (20)     3399 2024-02-16 01:12:37.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/slide_circ_mean.py
--rw-r--r--   0 simon      (501) staff       (20)     1835 2024-03-28 22:56:59.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/calinski_harabasz.py
--rw-r--r--   0 simon      (501) staff       (20)     1282 2024-02-27 21:31:05.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/roi_feature_visualizer_example.py
--rw-r--r--   0 simon      (501) staff       (20)    10076 2024-03-22 16:51:40.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/spontaneuous_alternation_plotter.py
--rw-r--r--   0 simon      (501) staff       (20)      895 2024-03-12 14:09:55.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/runs_test.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:46:33.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     2287 2024-03-25 16:45:04.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/total_variation_distance.py
--rw-r--r--   0 simon      (501) staff       (20)     3056 2024-02-27 21:31:05.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/crop_single_polygon.py
--rw-r--r--   0 simon      (501) staff       (20)     8010 2024-03-24 19:48:22.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/joint_plotter.py
--rw-r--r--   0 simon      (501) staff       (20)     2552 2024-04-02 14:48:59.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/elliptic_envelope.py
--rw-r--r--   0 simon      (501) staff       (20)     1016 2024-03-14 14:57:29.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/roi_definition_csvs_to_h5.py.zip
--rw-r--r--   0 simon      (501) staff       (20)     1276 2024-03-12 17:58:38.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/add_body_part.py.zip
--rw-r--r--   0 simon      (501) staff       (20)      921 2024-02-26 15:46:14.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/roi_feature_visualizer_example.py.zip
--rw-r--r--   0 simon      (501) staff       (20)     1274 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/count_values_in_range.py
--rw-r--r--   0 simon      (501) staff       (20)     2174 2024-03-14 14:56:26.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/roi_definition_csvs_to_h5.py
--rw-r--r--   0 simon      (501) staff       (20)     1656 2024-03-30 18:32:44.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/distance_velocity.py
--rw-r--r--   0 simon      (501) staff       (20)     5011 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/graph_creator.py
--rw-r--r--   0 simon      (501) staff       (20)     3954 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/termite_rois.csv
--rw-r--r--   0 simon      (501) staff       (20)     1351 2024-03-26 21:10:40.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/unsupervised_lof.py
--rw-r--r--   0 simon      (501) staff       (20)     2553 2024-03-11 15:09:38.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/siegel_tukey.py
--rw-r--r--   0 simon      (501) staff       (20)      958 2024-03-13 18:05:08.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/berger_parker.py
--rw-r--r--   0 simon      (501) staff       (20)     2845 2024-03-28 19:23:54.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/davis_bouldin.py
--rw-r--r--   0 simon      (501) staff       (20)     7215 2024-02-26 15:46:14.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/crop_circles_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     1410 2024-03-19 12:49:24.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/heading.py
--rw-r--r--   0 simon      (501) staff       (20)     2243 2024-03-13 18:35:02.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/piotr_120324 2.py.zip
--rw-r--r--   0 simon      (501) staff       (20)      736 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/mutual_exclusive.py
--rw-r--r--   0 simon      (501) staff       (20)     2907 2024-03-14 19:31:25.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/grangercausalitytests.py
--rw-r--r--   0 simon      (501) staff       (20)     2432 2024-03-19 20:48:43.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/multiframe_is_shape_covered.py
--rw-r--r--   0 simon      (501) staff       (20)      592 2024-02-27 21:31:33.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/redis.py
--rw-r--r--   0 simon      (501) staff       (20)     2893 2024-02-26 20:49:33.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/video_color.py
--rw-r--r--   0 simon      (501) staff       (20)     2055 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/graph_3d_plotter.py
--rw-r--r--   0 simon      (501) staff       (20)     6186 2024-03-18 12:44:45.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/piotr_120324.py
--rw-r--r--   0 simon      (501) staff       (20)     5515 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/video_rotator.py
--rw-r--r--   0 simon      (501) staff       (20)     1004 2024-03-12 13:11:45.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/hartley_fmax.py
--rw-r--r--   0 simon      (501) staff       (20)       84 2024-04-03 17:05:23.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/calc_N_degree_direction_switches.py
--rw-r--r--   0 simon      (501) staff       (20)     2307 2024-02-27 21:31:33.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/fix_clahe.py
--rw-r--r--   0 simon      (501) staff       (20)     1836 2024-03-10 15:38:46.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/cochran_q.py
--rw-r--r--   0 simon      (501) staff       (20)      682 2024-03-13 19:19:43.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/menhinicks_index.py
--rw-r--r--   0 simon      (501) staff       (20)     2932 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/add_probability_cnt_features.py
--rw-r--r--   0 simon      (501) staff       (20)    13575 2024-03-20 11:47:11.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/spontanous_alternations.py
--rw-r--r--   0 simon      (501) staff       (20)     2268 2024-03-13 13:59:07.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/piotr_120324.py.zip
--rw-r--r--   0 simon      (501) staff       (20)     4655 2024-03-06 18:18:27.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/velocity_aggregator.py
--rw-r--r--   0 simon      (501) staff       (20)     1619 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/make_splash.py
--rw-r--r--   0 simon      (501) staff       (20)    37024 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/fish_feature_extractor_2023_version_5.py
--rw-r--r--   0 simon      (501) staff       (20)     1073 2024-03-13 16:46:16.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/simpson_diversity_index.py
--rw-r--r--   0 simon      (501) staff       (20)     2396 2024-03-17 16:55:38.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/piotr_120324 4.py.zip
--rw-r--r--   0 simon      (501) staff       (20)     5336 2024-02-10 20:28:08.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/geometry_ex.py
--rw-r--r--   0 simon      (501) staff       (20)     1613 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/time_stamp_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)     1505 2024-03-28 14:36:24.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/line_plot.py
--rw-r--r--   0 simon      (501) staff       (20)     5515 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/video_rotator_mp.py
--rw-r--r--   0 simon      (501) staff       (20)     5690 2024-02-10 20:28:08.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/statistics_ex.py
--rw-r--r--   0 simon      (501) staff       (20)     1391 2024-03-18 23:21:46.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/sliding_displacement.py
--rw-r--r--   0 simon      (501) staff       (20)      925 2024-03-11 13:06:04.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/wald_wolfowitz.py
--rw-r--r--   0 simon      (501) staff       (20)     2369 2024-03-14 17:07:10.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/linestring_path.py
--rw-r--r--   0 simon      (501) staff       (20)     2233 2024-03-18 15:20:48.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/cronbach_alpha.py
--rw-r--r--   0 simon      (501) staff       (20)     2809 2024-03-08 21:15:58.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/mcnamar.py
--rw-r--r--   0 simon      (501) staff       (20)    37022 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/fish_feature_extractor_2023_version_4.py
--rw-r--r--   0 simon      (501) staff       (20)     6220 2024-02-24 20:57:19.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/AmberFeatureExtractor.py.zip
--rw-r--r--   0 simon      (501) staff       (20)    69423 2024-02-20 14:30:23.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/amber_featurizer.py
--rw-r--r--   0 simon      (501) staff       (20)      837 2024-03-13 18:56:21.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/margalef_diversification_index.py
--rw-r--r--   0 simon      (501) staff       (20)      997 2024-03-17 17:49:00.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/biweight_midcorrelation.py
--rw-r--r--   0 simon      (501) staff       (20)     2186 2024-03-18 15:31:23.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/madmedianrule.py
--rw-r--r--   0 simon      (501) staff       (20)     2915 2024-04-01 14:12:59.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/adjusted_rand_score.py
--rw-r--r--   0 simon      (501) staff       (20)     2068 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/sandbox/convex_hull_scratch_2.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/
--rw-r--r--   0 simon      (501) staff       (20)     8538 2024-02-23 18:25:51.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/directing_animals_to_bodypart_visualizer.py
--rw-r--r--   0 simon      (501) staff       (20)    10127 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/gantt_creator.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/tools/
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:43:56.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/tools/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     5946 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/tools/tkinter_tools.py
--rw-r--r--   0 simon      (501) staff       (20)    17927 2024-04-04 16:23:22.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/ROI_plotter_mp.py
--rw-r--r--   0 simon      (501) staff       (20)     6148 2024-03-28 13:50:53.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/.DS_Store
--rw-r--r--   0 simon      (501) staff       (20)    19270 2024-03-31 17:21:01.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/shap_agg_stats_visualizer.py
--rw-r--r--   0 simon      (501) staff       (20)    11178 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/gantt_creator_mp.py
--rw-r--r--   0 simon      (501) staff       (20)    15819 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/heat_mapper_clf_mp.py
--rw-r--r--   0 simon      (501) staff       (20)    10376 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/probability_plot_creator.py
--rw-r--r--   0 simon      (501) staff       (20)     8467 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/circular_plotting.py
--rw-r--r--   0 simon      (501) staff       (20)    16868 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/plot_clf_results.py
--rw-r--r--   0 simon      (501) staff       (20)    16620 2024-02-27 15:29:59.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/plot_clf_results_mp.py
--rw-r--r--   0 simon      (501) staff       (20)    22893 2024-02-21 04:33:19.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/ROI_feature_visualizer.py
--rw-r--r--   0 simon      (501) staff       (20)    13622 2024-02-21 04:25:14.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/heat_mapper_location.py
--rw-r--r--   0 simon      (501) staff       (20)    11075 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/probability_plot_creator_mp.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     5253 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/interactive_probability_grapher.py
--rw-r--r--   0 simon      (501) staff       (20)     6517 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/plot_pose_in_dir.py
--rw-r--r--   0 simon      (501) staff       (20)    20951 2024-04-04 17:19:55.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/single_run_model_validation_video.py
--rw-r--r--   0 simon      (501) staff       (20)    16537 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/frame_mergerer_ffmpeg.py
--rw-r--r--   0 simon      (501) staff       (20)    10667 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/pose_plotter_mp.py
--rw-r--r--   0 simon      (501) staff       (20)     9368 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/directing_animals_visualizer_mp.py
--rw-r--r--   0 simon      (501) staff       (20)    14389 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/clf_validator.py
--rw-r--r--   0 simon      (501) staff       (20)    22754 2024-03-06 18:18:21.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/path_plotter_mp.py
--rw-r--r--   0 simon      (501) staff       (20)    14075 2024-02-24 20:34:51.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/ROI_feature_visualizer_mp.py
--rw-r--r--   0 simon      (501) staff       (20)    10774 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/data_plotter.py
--rw-r--r--   0 simon      (501) staff       (20)    13091 2024-03-26 23:49:10.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/spontaneous_alternation_plotter.py
--rw-r--r--   0 simon      (501) staff       (20)    23178 2024-02-21 17:08:03.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/path_plotter.py
--rw-r--r--   0 simon      (501) staff       (20)     9311 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/ez_lineplot.py
--rw-r--r--   0 simon      (501) staff       (20)    12514 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/distance_plotter_mp.py
--rw-r--r--   0 simon      (501) staff       (20)    22994 2024-02-21 04:08:15.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/ROI_plotter.py
--rw-r--r--   0 simon      (501) staff       (20)    10034 2024-03-19 12:54:07.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/geometry_plotter.py
--rw-r--r--   0 simon      (501) staff       (20)    16661 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/clf_validator_mp.py
--rw-r--r--   0 simon      (501) staff       (20)    14224 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/heat_mapper_clf.py
--rw-r--r--   0 simon      (501) staff       (20)    10899 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/distance_plotter.py
--rw-r--r--   0 simon      (501) staff       (20)    19075 2024-04-04 17:22:21.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/single_run_model_validation_video_mp.py
--rw-r--r--   0 simon      (501) staff       (20)    12286 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/directing_animals_visualizer.py
--rw-r--r--   0 simon      (501) staff       (20)    11453 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/circular_feature_overlay_plotter.py
--rw-r--r--   0 simon      (501) staff       (20)    14576 2024-02-21 04:11:21.000000 Simba-UW-tf-dev-1.89.4/simba/plotting/heat_mapper_location_mp.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/dash_app/
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:44:15.000000 Simba-UW-tf-dev-1.89.4/simba/dash_app/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    72715 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/dash_app/SimBA_dash_app.py
--rw-r--r--   0 simon      (501) staff       (20)     4965 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/dash_app/run_dash_tkinter.py
--rw-r--r--   0 simon      (501) staff       (20)    47546 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/dash_app/dash_app.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/data_processors/
--rw-r--r--   0 simon      (501) staff       (20)    14926 2024-03-29 16:15:58.000000 Simba-UW-tf-dev-1.89.4/simba/data_processors/spontaneous_alternation_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)    11813 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/data_processors/agg_clf_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)     6148 2024-03-28 13:50:53.000000 Simba-UW-tf-dev-1.89.4/simba/data_processors/.DS_Store
--rw-r--r--   0 simon      (501) staff       (20)    13224 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/data_processors/severity_bout_based_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)    39110 2024-03-19 12:54:07.000000 Simba-UW-tf-dev-1.89.4/simba/data_processors/interpolation_smoothing.py
--rw-r--r--   0 simon      (501) staff       (20)    10968 2024-02-21 19:10:40.000000 Simba-UW-tf-dev-1.89.4/simba/data_processors/directing_animal_to_bodypart.py
--rw-r--r--   0 simon      (501) staff       (20)     9580 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/data_processors/timebins_clf_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)    20288 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/data_processors/fsttc_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/data_processors/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     4793 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/data_processors/boolean_conditional_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)     7117 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/data_processors/interpolate_pose.py
--rw-r--r--   0 simon      (501) staff       (20)    16335 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/data_processors/directing_other_animals_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)     8957 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/data_processors/gibbs_sampler.py
--rw-r--r--   0 simon      (501) staff       (20)    10054 2024-04-04 16:23:22.000000 Simba-UW-tf-dev-1.89.4/simba/data_processors/timebins_movement_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)     5255 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/data_processors/severity_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)    18517 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/data_processors/pup_retrieval_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)     3118 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/data_processors/pybursts_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)    13660 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/data_processors/severity_frame_based_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)     8738 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/data_processors/mutual_exclusivity_corrector.py
--rw-r--r--   0 simon      (501) staff       (20)    12919 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/data_processors/kleinberg_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)    10196 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/data_processors/movement_calculator.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/model/
--rw-r--r--   0 simon      (501) staff       (20)    23586 2024-04-04 17:13:01.000000 Simba-UW-tf-dev-1.89.4/simba/model/train_rf.py
--rw-r--r--   0 simon      (501) staff       (20)     4969 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/model/inference_batch.py
--rw-r--r--   0 simon      (501) staff       (20)    14036 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/model/train_multiclass_rf.py
--rw-r--r--   0 simon      (501) staff       (20)     3937 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/model/inference_multiclass_batch.py
--rw-r--r--   0 simon      (501) staff       (20)    15931 2024-02-20 14:30:06.000000 Simba-UW-tf-dev-1.89.4/simba/model/grid_search_multiclass_rf.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:41:19.000000 Simba-UW-tf-dev-1.89.4/simba/model/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    16987 2024-02-22 11:58:09.000000 Simba-UW-tf-dev-1.89.4/simba/model/grid_search_rf.py
--rw-r--r--   0 simon      (501) staff       (20)     3768 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/model/inference_validation.py
--rw-r--r--   0 simon      (501) staff       (20)     6872 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/model/train_multilabel_rf.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/roi_tools/
--rw-r--r--   0 simon      (501) staff       (20)    12190 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_time_bin_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)     1803 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_movement_analyzer.py
--rw-r--r--   0 simon      (501) staff       (20)     6148 2024-03-22 19:49:42.000000 Simba-UW-tf-dev-1.89.4/simba/roi_tools/.DS_Store
--rw-r--r--   0 simon      (501) staff       (20)    50018 2024-03-11 20:20:39.000000 Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_define.py
--rw-r--r--   0 simon      (501) staff       (20)     3616 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_reset.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/roi_tools/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     9876 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_size_standardizer.py
--rw-r--r--   0 simon      (501) staff       (20)    30615 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_analyzer.py
--rw-r--r--   0 simon      (501) staff       (20)    15704 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_feature_analyzer.py
--rw-r--r--   0 simon      (501) staff       (20)     4386 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_multiply.py
--rw-r--r--   0 simon      (501) staff       (20)     2313 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_size_calculations.py
--rw-r--r--   0 simon      (501) staff       (20)     3716 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_zoom.py
--rw-r--r--   0 simon      (501) staff       (20)    13394 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_directing_analyzer.py
--rw-r--r--   0 simon      (501) staff       (20)    11974 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_move_shape.py
--rw-r--r--   0 simon      (501) staff       (20)     5470 2024-02-21 03:51:46.000000 Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_menus.py
--rw-r--r--   0 simon      (501) staff       (20)    16129 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_clf_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)    29730 2024-03-14 14:41:12.000000 Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_image.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/pose_importers/
--rw-r--r--   0 simon      (501) staff       (20)    10711 2024-02-20 21:35:22.000000 Simba-UW-tf-dev-1.89.4/simba/pose_importers/sleap_csv_importer.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/pose_importers/misc/
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:47:31.000000 Simba-UW-tf-dev-1.89.4/simba/pose_importers/misc/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     8084 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/pose_importers/misc/apt_trk_importer.py
--rw-r--r--   0 simon      (501) staff       (20)     2577 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/pose_importers/read_DANNCE_mat.py
--rw-r--r--   0 simon      (501) staff       (20)     6148 2024-03-22 19:49:42.000000 Simba-UW-tf-dev-1.89.4/simba/pose_importers/.DS_Store
--rw-r--r--   0 simon      (501) staff       (20)    14268 2024-02-20 21:35:22.000000 Simba-UW-tf-dev-1.89.4/simba/pose_importers/sleap_h5_importer.py
--rw-r--r--   0 simon      (501) staff       (20)     8161 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/pose_importers/madlc_importer.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/pose_importers/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    13672 2024-02-20 21:35:22.000000 Simba-UW-tf-dev-1.89.4/simba/pose_importers/sleap_slp_importer.py
--rw-r--r--   0 simon      (501) staff       (20)     8645 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/pose_importers/import_mars.py
--rw-r--r--   0 simon      (501) staff       (20)     7464 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/pose_importers/dlc_importer_csv.py
--rw-r--r--   0 simon      (501) staff       (20)     8417 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/pose_importers/trk_importer.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/pose_configurations/
--rw-r--r--   0 simon      (501) staff       (20)     8196 2024-03-19 18:18:43.000000 Simba-UW-tf-dev-1.89.4/simba/pose_configurations/.DS_Store
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/pose_configurations/bp_names/
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:47:10.000000 Simba-UW-tf-dev-1.89.4/simba/pose_configurations/bp_names/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     4485 2024-03-04 19:10:54.000000 Simba-UW-tf-dev-1.89.4/simba/pose_configurations/bp_names/bp_names.csv
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/pose_configurations/no_animals/
--rw-r--r--   0 simon      (501) staff       (20)       27 2024-03-04 19:10:54.000000 Simba-UW-tf-dev-1.89.4/simba/pose_configurations/no_animals/no_animals.csv
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:47:18.000000 Simba-UW-tf-dev-1.89.4/simba/pose_configurations/no_animals/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:47:05.000000 Simba-UW-tf-dev-1.89.4/simba/pose_configurations/__init__.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/pose_configurations/configuration_names/
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:47:14.000000 Simba-UW-tf-dev-1.89.4/simba/pose_configurations/configuration_names/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)      273 2024-03-04 19:10:54.000000 Simba-UW-tf-dev-1.89.4/simba/pose_configurations/configuration_names/pose_config_names.csv
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/pose_configurations/schematics/
--rw-r--r--   0 simon      (501) staff       (20)    39805 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/pose_configurations/schematics/8.png
--rw-r--r--   0 simon      (501) staff       (20)    62501 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/pose_configurations/schematics/9.png
--rw-r--r--   0 simon      (501) staff       (20)     6172 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/pose_configurations/schematics/12.png
--rw-r--r--   0 simon      (501) staff       (20)    34231 2024-02-20 18:50:39.000000 Simba-UW-tf-dev-1.89.4/simba/pose_configurations/schematics/13.png
--rw-r--r--   0 simon      (501) staff       (20)    69501 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/pose_configurations/schematics/11.png
--rw-r--r--   0 simon      (501) staff       (20)    69410 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/pose_configurations/schematics/10.png
--rw-r--r--   0 simon      (501) staff       (20)    16000 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/pose_configurations/schematics/4.png
--rw-r--r--   0 simon      (501) staff       (20)    28150 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/pose_configurations/schematics/5.png
--rw-r--r--   0 simon      (501) staff       (20)    31140 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/pose_configurations/schematics/7.png
--rw-r--r--   0 simon      (501) staff       (20)    30634 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/pose_configurations/schematics/6.png
--rw-r--r--   0 simon      (501) staff       (20)    15417 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/pose_configurations/schematics/2.png
--rw-r--r--   0 simon      (501) staff       (20)    15786 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/pose_configurations/schematics/3.png
--rw-r--r--   0 simon      (501) staff       (20)    18939 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/pose_configurations/schematics/1.png
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:02.000000 Simba-UW-tf-dev-1.89.4/simba/video_processors/
--rw-r--r--   0 simon      (501) staff       (20)    82015 2024-03-25 14:32:13.000000 Simba-UW-tf-dev-1.89.4/simba/video_processors/video_processing.py
--rw-r--r--   0 simon      (501) staff       (20)     6148 2024-03-26 15:01:23.000000 Simba-UW-tf-dev-1.89.4/simba/video_processors/.DS_Store
--rw-r--r--   0 simon      (501) staff       (20)     5578 2024-02-26 16:02:32.000000 Simba-UW-tf-dev-1.89.4/simba/video_processors/roi_selector_circle.py
--rw-r--r--   0 simon      (501) staff       (20)     9073 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/video_processors/px_to_mm.py
--rw-r--r--   0 simon      (501) staff       (20)    35053 2024-02-26 15:42:07.000000 Simba-UW-tf-dev-1.89.4/simba/video_processors/batch_process_menus.py
--rw-r--r--   0 simon      (501) staff       (20)    11439 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/video_processors/multi_cropper.py
--rw-r--r--   0 simon      (501) staff       (20)     3066 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/video_processors/extract_frames.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/video_processors/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     6598 2024-02-26 21:50:01.000000 Simba-UW-tf-dev-1.89.4/simba/video_processors/roi_selector.py
--rw-r--r--   0 simon      (501) staff       (20)    10007 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/video_processors/calculate_px_dist.py
--rw-r--r--   0 simon      (501) staff       (20)     5963 2024-02-27 21:31:05.000000 Simba-UW-tf-dev-1.89.4/simba/video_processors/roi_selector_polygon.py
--rw-r--r--   0 simon      (501) staff       (20)     4926 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/video_processors/extract_seqframes.py
--rw-r--r--   0 simon      (501) staff       (20)    15117 2024-02-24 20:57:19.000000 Simba-UW-tf-dev-1.89.4/simba/video_processors/batch_process_create_ffmpeg_commands.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/outlier_tools/
--rw-r--r--   0 simon      (501) staff       (20)     7837 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/outlier_tools/outlier_corrector_movement.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/outlier_tools/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    14462 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/outlier_tools/outlier_corrector_location_advanced.py
--rw-r--r--   0 simon      (501) staff       (20)    13117 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/outlier_tools/outlier_corrector_movement_advanced.py
--rw-r--r--   0 simon      (501) staff       (20)    10396 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/outlier_tools/outlier_corrector_location.py
--rw-r--r--   0 simon      (501) staff       (20)     2751 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/outlier_tools/skip_outlier_correction.py
--rw-r--r--   0 simon      (501) staff       (20)    81172 2024-04-04 16:47:32.000000 Simba-UW-tf-dev-1.89.4/simba/SimBA.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/assets/
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/assets/unsupervised/
--rw-r--r--   0 simon      (501) staff       (20)   109483 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/unsupervised/model_names.parquet
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:45:36.000000 Simba-UW-tf-dev-1.89.4/simba/assets/unsupervised/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    14175 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/unsupervised/features.csv
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/assets/shap/
--rw-r--r--   0 simon      (501) staff       (20)     1177 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/shap/down_arrow.jpg
--rw-r--r--   0 simon      (501) staff       (20)     1733 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/shap/intruder_shape.jpg
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/assets/shap/feature_categories/
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:45:25.000000 Simba-UW-tf-dev-1.89.4/simba/assets/shap/feature_categories/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    17420 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/shap/feature_categories/shap_feature_categories.csv
--rw-r--r--   0 simon      (501) staff       (20)     1665 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/shap/resident_shape.jpg
--rw-r--r--   0 simon      (501) staff       (20)     2415 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/shap/resident_intruder_shape.jpg
--rw-r--r--   0 simon      (501) staff       (20)     2012 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/shap/animal_distances.jpg
--rw-r--r--   0 simon      (501) staff       (20)     4422 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/shap/baseline_scale.jpg
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:45:21.000000 Simba-UW-tf-dev-1.89.4/simba/assets/shap/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)   353824 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/shap/ubuntu.regular.ttf
--rw-r--r--   0 simon      (501) staff       (20)     6672 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/shap/side_scale.jpg
--rw-r--r--   0 simon      (501) staff       (20)   189004 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/shap/UbuntuMono-Regular.ttf
--rw-r--r--   0 simon      (501) staff       (20)     2737 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/shap/side_scale_5.jpg
--rw-r--r--   0 simon      (501) staff       (20)     1785 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/shap/intruder_movement.jpg
--rw-r--r--   0 simon      (501) staff       (20)     1435 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/shap/resident_movement.jpg
--rw-r--r--   0 simon      (501) staff       (20)     3134 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/shap/color_bar.jpg
--rw-r--r--   0 simon      (501) staff       (20)     2120 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/shap/resident_intruder_movement.jpg
--rw-r--r--   0 simon      (501) staff       (20)    10244 2024-03-10 13:27:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/.DS_Store
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/assets/lookups/
--rw-r--r--   0 simon      (501) staff       (20)   270783 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/lookups/model_names.parquet
--rw-r--r--   0 simon      (501) staff       (20)     2987 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/lookups/feature_extraction_headers.csv
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:45:11.000000 Simba-UW-tf-dev-1.89.4/simba/assets/lookups/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    26256 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/lookups/critical_values_05.pickle
--rw-r--r--   0 simon      (501) staff       (20)    14175 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/lookups/features.csv
--rw-r--r--   0 simon      (501) staff       (20)    14175 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/lookups/unsupervised_example_x.csv
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:41:54.000000 Simba-UW-tf-dev-1.89.4/simba/assets/__init__.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/assets/stl/
--rw-r--r--   0 simon      (501) staff       (20)   551576 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/stl/operant_tray.stl
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:45:31.000000 Simba-UW-tf-dev-1.89.4/simba/assets/stl/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    67647 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/stl/operant_lever.stl
--rw-r--r--   0 simon      (501) staff       (20)    92896 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/stl/operant_walls.stl
--rw-r--r--   0 simon      (501) staff       (20)  4759984 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/stl/grid_floor.stl
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/assets/img/
--rw-r--r--   0 simon      (501) staff       (20)   489479 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/img/splash_2024.mp4
--rw-r--r--   0 simon      (501) staff       (20)    79863 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/img/bg_2024.png
--rw-r--r--   0 simon      (501) staff       (20)   399272 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/img/about_me.png
--rw-r--r--   0 simon      (501) staff       (20)   117108 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/img/splash.mp4
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:45:02.000000 Simba-UW-tf-dev-1.89.4/simba/assets/img/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)   322242 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/img/bg_2.png
--rw-r--r--   0 simon      (501) staff       (20)      165 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/img/~$splash.pptx
--rw-r--r--   0 simon      (501) staff       (20)    69267 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/img/splash.pptx
--rw-r--r--   0 simon      (501) staff       (20)   204362 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/img/bg.png
--rw-r--r--   0 simon      (501) staff       (20)   189004 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/UbuntuMono-Regular.ttf
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/
--rw-r--r--   0 simon      (501) staff       (20)     1350 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/factory.png
--rw-r--r--   0 simon      (501) staff       (20)     1413 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/cluster.png
--rw-r--r--   0 simon      (501) staff       (20)     1340 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/load.png
--rw-r--r--   0 simon      (501) staff       (20)     4507 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/gif.png
--rw-r--r--   0 simon      (501) staff       (20)     4566 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/pose.png
--rw-r--r--   0 simon      (501) staff       (20)     1943 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/features.png
--rw-r--r--   0 simon      (501) staff       (20)     4896 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/settings.png
--rw-r--r--   0 simon      (501) staff       (20)     2090 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/stopwatch.png
--rw-r--r--   0 simon      (501) staff       (20)     1252 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/link.png
--rw-r--r--   0 simon      (501) staff       (20)    14250 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/dash_simba.css
--rw-r--r--   0 simon      (501) staff       (20)      917 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/documentation.png
--rw-r--r--   0 simon      (501) staff       (20)     4503 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/fps.png
--rw-r--r--   0 simon      (501) staff       (20)     1299 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/dimensionality_reduction.png
--rw-r--r--   0 simon      (501) staff       (20)     4823 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/roi.png
--rw-r--r--   0 simon      (501) staff       (20)   171446 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/simba_logo_2.png
--rw-r--r--   0 simon      (501) staff       (20)      920 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/superimpose.png
--rw-r--r--   0 simon      (501) staff       (20)     1136 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/label.png
--rw-r--r--   0 simon      (501) staff       (20)     1016 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/change.png
--rw-r--r--   0 simon      (501) staff       (20)    59896 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/readthedocs_logo.png
--rw-r--r--   0 simon      (501) staff       (20)     1124 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/crop.png
--rw-r--r--   0 simon      (501) staff       (20)     2146 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/rotate.png
--rw-r--r--   0 simon      (501) staff       (20)     1921 2024-02-26 14:29:54.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/circle.png
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:44:37.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     1057 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/path.png
--rw-r--r--   0 simon      (501) staff       (20)     1148 2024-02-26 20:39:14.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/polygon.png
--rw-r--r--   0 simon      (501) staff       (20)      950 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/clip.png
--rw-r--r--   0 simon      (501) staff       (20)     2121 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/restart.png
--rw-r--r--   0 simon      (501) staff       (20)     4653 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/calipher.png
--rw-r--r--   0 simon      (501) staff       (20)     1291 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/add_on.png
--rw-r--r--   0 simon      (501) staff       (20)     4695 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/create.png
--rw-r--r--   0 simon      (501) staff       (20)    78182 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/SimBA_logo.ico
--rw-r--r--   0 simon      (501) staff       (20)     1067 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/print.png
--rw-r--r--   0 simon      (501) staff       (20)     4653 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/clf.png
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/concat_icons/
--rw-r--r--   0 simon      (501) staff       (20)     6027 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/concat_icons/mosaic.png
--rw-r--r--   0 simon      (501) staff       (20)     5654 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/concat_icons/vertical.png
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:44:45.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/concat_icons/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     5542 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/concat_icons/horizontal.png
--rw-r--r--   0 simon      (501) staff       (20)     5939 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/concat_icons/mixed_mosaic.png
--rw-r--r--   0 simon      (501) staff       (20)     2060 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/merge.png
--rw-r--r--   0 simon      (501) staff       (20)     1252 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/clean.png
--rw-r--r--   0 simon      (501) staff       (20)     4725 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/clf_2.png
--rw-r--r--   0 simon      (501) staff       (20)     4795 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/visualize.png
--rw-r--r--   0 simon      (501) staff       (20)     2142 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/concat.png
--rw-r--r--   0 simon      (501) staff       (20)     1474 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/boris.png
--rw-r--r--   0 simon      (501) staff       (20)     4804 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/frames.png
--rw-r--r--   0 simon      (501) staff       (20)     2425 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/video.png
--rw-r--r--   0 simon      (501) staff       (20)     2089 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/sample.png
--rw-r--r--   0 simon      (501) staff       (20)     1471 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/metrics.png
--rw-r--r--   0 simon      (501) staff       (20)     4555 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/grey.png
--rw-r--r--   0 simon      (501) staff       (20)      930 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/exit.png
--rw-r--r--   0 simon      (501) staff       (20)     4751 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/outlier.png
--rw-r--r--   0 simon      (501) staff       (20)     4392 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/clahe.png
--rw-r--r--   0 simon      (501) staff       (20)     4637 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/trash.png
--rw-r--r--   0 simon      (501) staff       (20)     1239 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/about.png
--rw-r--r--   0 simon      (501) staff       (20)     4666 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/convert.png
--rw-r--r--   0 simon      (501) staff       (20)    93229 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/SimBA_logo.icns
--rw-r--r--   0 simon      (501) staff       (20)      991 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/reorganize.png
--rw-r--r--   0 simon      (501) staff       (20)     4784 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/browse.png
--rw-r--r--   0 simon      (501) staff       (20)    30707 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/SimBA_logo.png
--rw-r--r--   0 simon      (501) staff       (20)     2293 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/ethovision.png
--rw-r--r--   0 simon      (501) staff       (20)     1018 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/icons/close.png
--rw-r--r--   0 simon      (501) staff       (20)    13672 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/dash_simba_base.css
--rw-r--r--   0 simon      (501) staff       (20)    31812 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.4/simba/assets/TheGoldenLab.PNG
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/Simba_UW_tf_dev.egg-info/
--rw-r--r--   0 simon      (501) staff       (20)     2797 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/Simba_UW_tf_dev.egg-info/PKG-INFO
--rw-r--r--   0 simon      (501) staff       (20)    22555 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/Simba_UW_tf_dev.egg-info/SOURCES.txt
--rw-r--r--   0 simon      (501) staff       (20)       44 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/Simba_UW_tf_dev.egg-info/entry_points.txt
--rw-r--r--   0 simon      (501) staff       (20)      753 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/Simba_UW_tf_dev.egg-info/requires.txt
--rw-r--r--   0 simon      (501) staff       (20)        6 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/Simba_UW_tf_dev.egg-info/top_level.txt
--rw-r--r--   0 simon      (501) staff       (20)        1 2024-04-04 17:31:01.000000 Simba-UW-tf-dev-1.89.4/Simba_UW_tf_dev.egg-info/dependency_links.txt
--rw-r--r--   0 simon      (501) staff       (20)    35127 2024-02-07 18:56:10.000000 Simba-UW-tf-dev-1.89.4/LICENSE
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-04 17:31:02.000000 Simba-UW-tf-dev-1.89.4/tests/
--rw-r--r--   0 simon      (501) staff       (20)     4944 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.89.4/tests/test_data_processors.py
--rw-r--r--   0 simon      (501) staff       (20)    13415 2024-03-01 16:43:04.000000 Simba-UW-tf-dev-1.89.4/tests/test_circlular_stats.py
--rw-r--r--   0 simon      (501) staff       (20)    13400 2024-03-27 14:14:56.000000 Simba-UW-tf-dev-1.89.4/tests/test_stats.py
--rw-r--r--   0 simon      (501) staff       (20)     5385 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.89.4/tests/test_distance_plotter.py
--rw-r--r--   0 simon      (501) staff       (20)    11863 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.89.4/tests/test_train_model_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)     6525 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.89.4/tests/test_feature_extraction_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)     1739 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.89.4/tests/test_utils_data.py
--rw-r--r--   0 simon      (501) staff       (20)     8120 2024-03-01 19:06:25.000000 Simba-UW-tf-dev-1.89.4/tests/test_config_reader_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)     1070 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.89.4/tests/test_outlier_correctors.py
--rw-r--r--   0 simon      (501) staff       (20)     4435 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.89.4/tests/test_visualize_directing_animals.py
--rw-r--r--   0 simon      (501) staff       (20)     1596 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.89.4/tests/test_featurizers.py
--rw-r--r--   0 simon      (501) staff       (20)     8570 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.89.4/tests/test_video_processors.py
--rw-r--r--   0 simon      (501) staff       (20)     3554 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.89.4/tests/test_thirdparty_appenders.py
--rw-r--r--   0 simon      (501) staff       (20)     3021 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.89.4/tests/test_validation_clips.py
--rw-r--r--   0 simon      (501) staff       (20)     3992 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.89.4/tests/test_roi_tools.py
--rw-r--r--   0 simon      (501) staff       (20)      318 2024-03-04 20:16:28.000000 Simba-UW-tf-dev-1.89.4/MANIFEST.in
--rw-r--r--   0 simon      (501) staff       (20)    18403 2024-02-12 00:49:21.000000 Simba-UW-tf-dev-1.89.4/README.md
--rw-r--r--   0 simon      (501) staff       (20)     1426 2024-04-04 17:30:52.000000 Simba-UW-tf-dev-1.89.4/setup.py
--rw-r--r--   0 simon      (501) staff       (20)       38 2024-04-04 17:31:02.000000 Simba-UW-tf-dev-1.89.4/setup.cfg
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/
+-rw-r--r--   0 simon      (501) staff       (20)     2797 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/PKG-INFO
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:16.000000 Simba-UW-tf-dev-1.89.5/simba/
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/ui/
+-rw-r--r--   0 simon      (501) staff       (20)     6148 2024-03-28 13:50:53.000000 Simba-UW-tf-dev-1.89.5/simba/ui/.DS_Store
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/
+-rw-r--r--   0 simon      (501) staff       (20)    11467 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/mutual_exclusivity_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     4070 2024-03-29 20:30:28.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/movement_analysis_time_bins_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     1676 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/csv_2_parquet_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     2566 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/quick_path_plot_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     2873 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/batch_preprocess_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     8835 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/heatmap_location_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     9734 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/clf_probability_plot_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     3456 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/movement_analysis_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     4631 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/set_machine_model_parameters_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)    11362 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/clf_plot_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)    24905 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/path_plot_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     1184 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/remove_roi_features_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     6692 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/targeted_annotation_clips_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     3340 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/smoothing_interpolation_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     2174 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/roi_size_standardizer_popup.py
+-rw-r--r--   0 simon      (501) staff       (20)     6997 2024-04-11 20:25:55.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/visualize_pose_in_dir_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     5068 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/roi_analysis_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     7898 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/outlier_settings_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     9048 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/gantt_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     6293 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/clf_validation_plot_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     8529 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/severity_analysis_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     3221 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/fsttc_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     4231 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/kleinberg_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     7979 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/directing_other_animals_plot_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     9785 2024-03-29 16:15:58.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/spontaneous_alternation_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     6076 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/pose_reorganizer_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     3437 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/animal_directing_other_animals_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     3402 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/append_roi_features_animals_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     3468 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/clf_by_timebins_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     9153 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/heatmap_clf_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     9235 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/data_plot_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)    11785 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/roi_features_plot_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     9118 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/pup_retrieval_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     5577 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/boolean_conditional_slicer_pup_up.py
+-rw-r--r--   0 simon      (501) staff       (20)      584 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/about_simba_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     5451 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/clf_descriptive_statistics_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)    10747 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/roi_tracking_plot_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     1795 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/append_roi_features_bodypart_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     7312 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/directing_animal_to_bodypart_plot_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     6546 2024-02-16 01:12:37.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/clf_add_remove_print_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)    66309 2024-04-11 20:42:04.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/video_processing_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     7800 2024-04-04 16:47:32.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/validation_plot_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     6160 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/clf_by_roi_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     2741 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/make_path_plot_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     3622 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/direction_animal_to_bodypart_settings_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     6166 2024-03-06 18:18:27.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/create_user_defined_pose_configuration_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     1072 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/archive_files_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     4716 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/pose_bp_drop_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)    12174 2024-04-11 20:42:04.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/distance_plot_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     4673 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/subset_feature_extractor_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     3290 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/third_party_annotator_appender_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     4134 2024-03-31 17:07:13.000000 Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/roi_analysis_time_bins_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)    16701 2024-02-08 00:53:55.000000 Simba-UW-tf-dev-1.89.5/simba/ui/video_info_ui.py
+-rw-r--r--   0 simon      (501) staff       (20)     6573 2024-04-11 20:25:55.000000 Simba-UW-tf-dev-1.89.5/simba/ui/user_defined_pose_creator.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/ui/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    14374 2024-03-06 18:18:27.000000 Simba-UW-tf-dev-1.89.5/simba/ui/create_project_ui.py
+-rw-r--r--   0 simon      (501) staff       (20)    14487 2024-02-08 00:53:55.000000 Simba-UW-tf-dev-1.89.5/simba/ui/tkinter_functions.py
+-rw-r--r--   0 simon      (501) staff       (20)    38870 2024-04-04 16:45:40.000000 Simba-UW-tf-dev-1.89.5/simba/ui/machine_model_settings_ui.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/labelling/
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/labelling/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    24423 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/labelling/labelling_interface.py
+-rw-r--r--   0 simon      (501) staff       (20)     2362 2024-02-21 02:33:04.000000 Simba-UW-tf-dev-1.89.5/simba/labelling/targeted_annotations_clips.py
+-rw-r--r--   0 simon      (501) staff       (20)     3974 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/labelling/extract_labelled_frames.py
+-rw-r--r--   0 simon      (501) staff       (20)    31269 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/labelling/labelling_advanced_interface.py
+-rw-r--r--   0 simon      (501) staff       (20)    10012 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/labelling/play_annotation_video.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/
+-rw-r--r--   0 simon      (501) staff       (20)    15004 2024-03-29 19:51:46.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/dbcv_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)     5077 2024-03-29 19:51:46.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/cluster_validation_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)     3645 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/enums.py
+-rw-r--r--   0 simon      (501) staff       (20)     6148 2024-04-03 14:33:55.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/.DS_Store
+-rw-r--r--   0 simon      (501) staff       (20)     9036 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/cluster_video_visualizer.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/pop_ups/
+-rw-r--r--   0 simon      (501) staff       (20)     4642 2024-03-26 23:50:53.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/pop_ups/cluster_videos_popup.py
+-rw-r--r--   0 simon      (501) staff       (20)     4027 2024-02-20 21:35:22.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/pop_ups/transform_cluster_popup.py
+-rw-r--r--   0 simon      (501) staff       (20)     5048 2024-02-15 23:45:22.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/pop_ups/embedding_correlations_popup.py
+-rw-r--r--   0 simon      (501) staff       (20)     6148 2024-04-02 14:39:26.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/pop_ups/.DS_Store
+-rw-r--r--   0 simon      (501) staff       (20)     4070 2024-02-20 21:35:22.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/pop_ups/transform_dim_reduction_popup.py
+-rw-r--r--   0 simon      (501) staff       (20)    11182 2024-02-15 23:45:22.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/pop_ups/fit_dim_reduction_popup.py
+-rw-r--r--   0 simon      (501) staff       (20)     2546 2024-03-29 19:51:46.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/pop_ups/data_extractor_popup.py
+-rw-r--r--   0 simon      (501) staff       (20)     4536 2024-03-29 19:51:46.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/pop_ups/cluster_validation_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     9305 2024-02-15 23:45:22.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/pop_ups/fit_cluster_popup.py
+-rw-r--r--   0 simon      (501) staff       (20)     2574 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/pop_ups/clusterer_comparison_popup.py
+-rw-r--r--   0 simon      (501) staff       (20)     6527 2024-03-26 23:50:53.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/pop_ups/grid_search_visualizer_popup.py
+-rw-r--r--   0 simon      (501) staff       (20)     4332 2024-03-28 20:02:59.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/pop_ups/cluster_xai_popup.py
+-rw-r--r--   0 simon      (501) staff       (20)     3820 2024-03-29 16:15:58.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/pop_ups/cluster_frequentist_stats_popup.py
+-rw-r--r--   0 simon      (501) staff       (20)     2355 2024-02-20 21:35:22.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/pop_ups/print_embedding_info_popup.py
+-rw-r--r--   0 simon      (501) staff       (20)     9946 2024-04-02 18:34:25.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/dataset_creator.py
+-rw-r--r--   0 simon      (501) staff       (20)    12982 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/unsupervised_main.py
+-rw-r--r--   0 simon      (501) staff       (20)    10175 2024-03-27 12:56:51.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/grid_search_visualizers.py
+-rw-r--r--   0 simon      (501) staff       (20)    16005 2024-03-29 16:15:58.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/data_extractor.py
+-rw-r--r--   0 simon      (501) staff       (20)     5241 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/outlier_detector.py
+-rw-r--r--   0 simon      (501) staff       (20)    10397 2024-03-29 16:15:58.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/cluster_frequentist_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)     5798 2024-03-27 12:56:51.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/embedding_correlation_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    18194 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/cluster_xai_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)    15581 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/umap_embedder.py
+-rw-r--r--   0 simon      (501) staff       (20)     5582 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/clusterer_comparison_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)     4652 2024-03-26 19:09:58.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/bout_aggregator.py
+-rw-r--r--   0 simon      (501) staff       (20)     2188 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/data_map.yaml
+-rw-r--r--   0 simon      (501) staff       (20)    14765 2024-03-26 19:09:58.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/hdbscan_clusterer.py
+-rw-r--r--   0 simon      (501) staff       (20)     3862 2024-02-15 21:37:53.000000 Simba-UW-tf-dev-1.89.5/simba/unsupervised/tsne.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/bounding_box_tools/
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/bounding_box_tools/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     8511 2024-02-08 00:53:55.000000 Simba-UW-tf-dev-1.89.5/simba/bounding_box_tools/agg_boundary_stats.py
+-rw-r--r--   0 simon      (501) staff       (20)    27255 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/bounding_box_tools/boundary_menus.py
+-rw-r--r--   0 simon      (501) staff       (20)    10064 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/bounding_box_tools/boundary_statistics.py
+-rw-r--r--   0 simon      (501) staff       (20)     7146 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/bounding_box_tools/find_boundaries.py
+-rw-r--r--   0 simon      (501) staff       (20)    12066 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/bounding_box_tools/visualize_boundaries.py
+-rw-r--r--   0 simon      (501) staff       (20)    18436 2024-04-10 01:59:19.000000 Simba-UW-tf-dev-1.89.5/simba/.DS_Store
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/
+-rw-r--r--   0 simon      (501) staff       (20)    57052 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/feature_extractor_14bp.py
+-rw-r--r--   0 simon      (501) staff       (20)    28094 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/feature_extractor_7bp.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/
+-rw-r--r--   0 simon      (501) staff       (20)     1757 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/doctests.py
+-rw-r--r--   0 simon      (501) staff       (20)    29328 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/fish_feature_extractor_2023_version_3.py
+-rw-r--r--   0 simon      (501) staff       (20)     2705 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/read_in_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)     2689 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/peaks.py
+-rw-r--r--   0 simon      (501) staff       (20)    16727 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/fish_feature_extractor_2022.py
+-rw-r--r--   0 simon      (501) staff       (20)     2144 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/convex_hull_3_scratch_3.py
+-rw-r--r--   0 simon      (501) staff       (20)     5762 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/convex_hull_scratch_1.py
+-rw-r--r--   0 simon      (501) staff       (20)    26425 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/fish_feature_extractor_2023_version_2.py
+-rw-r--r--   0 simon      (501) staff       (20)     7535 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/egocentrical_aligner.py
+-rw-r--r--   0 simon      (501) staff       (20)     1274 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/count_values_in_range.py
+-rw-r--r--   0 simon      (501) staff       (20)     5011 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/graph_creator.py
+-rw-r--r--   0 simon      (501) staff       (20)     3954 2024-02-07 20:55:52.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/termite_rois.csv
+-rw-r--r--   0 simon      (501) staff       (20)      736 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/mutual_exclusive.py
+-rw-r--r--   0 simon      (501) staff       (20)     2883 2024-02-07 20:55:52.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/video_color.py
+-rw-r--r--   0 simon      (501) staff       (20)     2055 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/graph_3d_plotter.py
+-rw-r--r--   0 simon      (501) staff       (20)     5515 2024-02-07 20:55:52.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/video_rotator.py
+-rw-r--r--   0 simon      (501) staff       (20)     2932 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/add_probability_cnt_features.py
+-rw-r--r--   0 simon      (501) staff       (20)     1619 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/make_splash.py
+-rw-r--r--   0 simon      (501) staff       (20)    37024 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/fish_feature_extractor_2023_version_5.py
+-rw-r--r--   0 simon      (501) staff       (20)     1613 2024-02-07 20:55:52.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/time_stamp_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)     5515 2024-02-07 20:55:52.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/video_rotator_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)    37022 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/fish_feature_extractor_2023_version_4.py
+-rw-r--r--   0 simon      (501) staff       (20)     2068 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/convex_hull_scratch_2.py
+-rw-r--r--   0 simon      (501) staff       (20)    36307 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/feature_extractor_8bps_2_animals.py
+-rw-r--r--   0 simon      (501) staff       (20)     6148 2024-02-21 02:05:27.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/.DS_Store
+-rw-r--r--   0 simon      (501) staff       (20)     4091 2024-02-16 21:14:07.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/perimeter_jit.py
+-rw-r--r--   0 simon      (501) staff       (20)    26471 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/feature_subsets.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    10043 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/feature_extractor_user_defined.py
+-rw-r--r--   0 simon      (501) staff       (20)    61607 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/feature_extractor_16bp.py
+-rw-r--r--   0 simon      (501) staff       (20)    37328 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/feature_extractor_9bp.py
+-rw-r--r--   0 simon      (501) staff       (20)    31163 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/feature_extractor_8bp.py
+-rw-r--r--   0 simon      (501) staff       (20)    21427 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/feature_extractor_4bp.py
+-rw-r--r--   0 simon      (501) staff       (20)    65534 2024-03-01 16:55:51.000000 Simba-UW-tf-dev-1.89.5/simba/feature_extractors/amber_feature_extractor.py
+-rw-r--r--   0 simon      (501) staff       (20)     1033 2024-04-11 12:52:35.000000 Simba-UW-tf-dev-1.89.5/simba/requirements.txt
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/mixins/
+-rw-r--r--   0 simon      (501) staff       (20)    40917 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/mixins/annotator_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)    84153 2024-04-11 20:25:55.000000 Simba-UW-tf-dev-1.89.5/simba/mixins/timeseries_features_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)     6148 2024-04-03 14:38:30.000000 Simba-UW-tf-dev-1.89.5/simba/mixins/.DS_Store
+-rw-r--r--   0 simon      (501) staff       (20)    53232 2024-03-29 19:51:46.000000 Simba-UW-tf-dev-1.89.5/simba/mixins/pop_up_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)    48428 2024-04-11 20:42:04.000000 Simba-UW-tf-dev-1.89.5/simba/mixins/config_reader.py
+-rw-r--r--   0 simon      (501) staff       (20)    56305 2024-04-11 20:25:55.000000 Simba-UW-tf-dev-1.89.5/simba/mixins/circular_statistics.py
+-rw-r--r--   0 simon      (501) staff       (20)    32080 2024-03-14 19:32:58.000000 Simba-UW-tf-dev-1.89.5/simba/mixins/network_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/mixins/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    24046 2024-02-20 21:35:22.000000 Simba-UW-tf-dev-1.89.5/simba/mixins/pose_importer_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)     3020 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/mixins/video_processing_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)    35642 2024-04-11 20:42:04.000000 Simba-UW-tf-dev-1.89.5/simba/mixins/feature_extraction_supplement_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)   149080 2024-04-11 20:42:04.000000 Simba-UW-tf-dev-1.89.5/simba/mixins/statistics_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)    44711 2024-03-14 19:32:58.000000 Simba-UW-tf-dev-1.89.5/simba/mixins/feature_extraction_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)    87052 2024-04-11 20:42:04.000000 Simba-UW-tf-dev-1.89.5/simba/mixins/plotting_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)      391 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/mixins/abstract_classes.py
+-rw-r--r--   0 simon      (501) staff       (20)    56806 2024-03-07 19:24:42.000000 Simba-UW-tf-dev-1.89.5/simba/mixins/image_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)      880 2024-03-06 18:18:27.000000 Simba-UW-tf-dev-1.89.5/simba/mixins/unsupervised_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)   132883 2024-03-29 19:51:46.000000 Simba-UW-tf-dev-1.89.5/simba/mixins/train_model_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)   166028 2024-04-11 20:42:04.000000 Simba-UW-tf-dev-1.89.5/simba/mixins/geometry_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)    24978 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/mixins/feature_extraction_circular_mixin.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/third_party_label_appenders/
+-rw-r--r--   0 simon      (501) staff       (20)     6639 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/third_party_label_appenders/deepethogram_importer.py
+-rw-r--r--   0 simon      (501) staff       (20)    12306 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/third_party_label_appenders/BORIS_appender.py
+-rw-r--r--   0 simon      (501) staff       (20)     9739 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/third_party_label_appenders/observer_importer.py
+-rw-r--r--   0 simon      (501) staff       (20)     6148 2024-03-22 19:49:42.000000 Simba-UW-tf-dev-1.89.5/simba/third_party_label_appenders/.DS_Store
+-rw-r--r--   0 simon      (501) staff       (20)     5508 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/third_party_label_appenders/boris_source_cleaner.py
+-rw-r--r--   0 simon      (501) staff       (20)    18982 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/third_party_label_appenders/tools.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/third_party_label_appenders/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    18852 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/third_party_label_appenders/third_party_appender.py
+-rw-r--r--   0 simon      (501) staff       (20)     9215 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/third_party_label_appenders/ethovision_import.py
+-rw-r--r--   0 simon      (501) staff       (20)     7456 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/third_party_label_appenders/BENTO_appender.py
+-rw-r--r--   0 simon      (501) staff       (20)     5662 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/third_party_label_appenders/solomon_importer.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/cue_light_tools/
+-rw-r--r--   0 simon      (501) staff       (20)     8841 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/cue_light_tools/cue_light_clf_statistics.py
+-rw-r--r--   0 simon      (501) staff       (20)    14451 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/cue_light_tools/cue_light_analyzer.py
+-rw-r--r--   0 simon      (501) staff       (20)    18274 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/cue_light_tools/cue_light_menues.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/cue_light_tools/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     1921 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/cue_light_tools/cue_light_tools.py
+-rw-r--r--   0 simon      (501) staff       (20)    19237 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/cue_light_tools/cue_light_visualizer.py
+-rw-r--r--   0 simon      (501) staff       (20)    15278 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/cue_light_tools/cue_light_movement_statistics.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/__init__.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/utils/
+-rw-r--r--   0 simon      (501) staff       (20)    13211 2024-02-16 01:12:37.000000 Simba-UW-tf-dev-1.89.5/simba/utils/config_creator.py
+-rw-r--r--   0 simon      (501) staff       (20)    26038 2024-03-27 13:42:19.000000 Simba-UW-tf-dev-1.89.5/simba/utils/enums.py
+-rw-r--r--   0 simon      (501) staff       (20)    10420 2024-04-11 20:25:55.000000 Simba-UW-tf-dev-1.89.5/simba/utils/custom_feature_extractor.py
+-rw-r--r--   0 simon      (501) staff       (20)     6148 2024-03-28 13:50:53.000000 Simba-UW-tf-dev-1.89.5/simba/utils/.DS_Store
+-rw-r--r--   0 simon      (501) staff       (20)     7737 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.89.5/simba/utils/warnings.py
+-rw-r--r--   0 simon      (501) staff       (20)    49585 2024-04-11 20:42:04.000000 Simba-UW-tf-dev-1.89.5/simba/utils/checks.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/utils/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    77219 2024-04-11 20:42:04.000000 Simba-UW-tf-dev-1.89.5/simba/utils/read_write.py
+-rw-r--r--   0 simon      (501) staff       (20)    15357 2024-04-08 15:44:21.000000 Simba-UW-tf-dev-1.89.5/simba/utils/lookups.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/utils/cli/
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/utils/cli/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     7129 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/utils/cli/cli_tools.py
+-rw-r--r--   0 simon      (501) staff       (20)    17086 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/utils/errors.py
+-rw-r--r--   0 simon      (501) staff       (20)    44962 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.89.5/simba/utils/data.py
+-rw-r--r--   0 simon      (501) staff       (20)      717 2024-03-06 18:18:27.000000 Simba-UW-tf-dev-1.89.5/simba/utils/keyboard_listener.py
+-rw-r--r--   0 simon      (501) staff       (20)     4205 2024-02-21 03:51:46.000000 Simba-UW-tf-dev-1.89.5/simba/utils/printing.py
+-rw-r--r--   0 simon      (501) staff       (20)   243998 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/SimBA_logo.ico
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/pose_processors/
+-rw-r--r--   0 simon      (501) staff       (20)     8626 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/pose_processors/reorganize_keypoint.py
+-rw-r--r--   0 simon      (501) staff       (20)     5840 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/pose_processors/remove_keypoints.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/pose_processors/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     2872 2024-02-15 23:39:58.000000 Simba-UW-tf-dev-1.89.5/simba/pose_processors/pose_reset.py
+-rw-r--r--   0 simon      (501) staff       (20)     6313 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/pose_processors/reverse_pose.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/
+-rw-r--r--   0 simon      (501) staff       (20)      786 2024-03-06 18:18:27.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/doctests.py
+-rw-r--r--   0 simon      (501) staff       (20)    29328 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/fish_feature_extractor_2023_version_3.py
+-rw-r--r--   0 simon      (501) staff       (20)     2387 2024-03-08 14:35:02.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/dprime.py
+-rw-r--r--   0 simon      (501) staff       (20)     2516 2024-03-18 17:01:43.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/linear_fretchet.py
+-rw-r--r--   0 simon      (501) staff       (20)     2705 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/read_in_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)     2391 2024-03-14 12:45:59.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/piotr_120324 3.py.zip
+-rw-r--r--   0 simon      (501) staff       (20)     2036 2024-03-28 18:29:59.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/dunn_index.py
+-rw-r--r--   0 simon      (501) staff       (20)     3640 2024-04-08 13:30:56.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/hausdorff.py
+-rw-r--r--   0 simon      (501) staff       (20)     2689 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/peaks.py
+-rw-r--r--   0 simon      (501) staff       (20)    16727 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/fish_feature_extractor_2022.py
+-rw-r--r--   0 simon      (501) staff       (20)     3494 2024-04-03 13:42:02.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/colinear_features.py
+-rw-r--r--   0 simon      (501) staff       (20)     8921 2024-03-22 13:56:46.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/spontaneous_alternation_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)    21658 2024-04-10 16:31:38.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/horizontal_videos_concat.py
+-rw-r--r--   0 simon      (501) staff       (20)     2144 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/convex_hull_3_scratch_3.py
+-rw-r--r--   0 simon      (501) staff       (20)     1103 2024-03-29 16:26:34.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/silhouette_score.py
+-rw-r--r--   0 simon      (501) staff       (20)     3607 2024-04-09 14:21:58.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/two_fish_feature_extractor_040924.py.zip
+-rw-r--r--   0 simon      (501) staff       (20)    33092 2024-02-22 15:57:45.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/cuda_jit.ipynb
+-rw-r--r--   0 simon      (501) staff       (20)     5762 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/convex_hull_scratch_1.py
+-rw-r--r--   0 simon      (501) staff       (20)     1867 2024-03-12 19:23:40.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/directed_hausdorff.py
+-rw-r--r--   0 simon      (501) staff       (20)      963 2024-03-13 18:20:52.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/shannon_diversity_index.py
+-rw-r--r--   0 simon      (501) staff       (20)     3726 2024-03-12 13:31:58.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/sequential_lag_analysis.py
+-rw-r--r--   0 simon      (501) staff       (20)     1254 2024-03-13 16:09:50.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/wilcoxon.py
+-rw-r--r--   0 simon      (501) staff       (20)     6148 2024-04-09 15:37:24.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/.DS_Store
+-rw-r--r--   0 simon      (501) staff       (20)     3328 2024-03-08 15:05:36.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/data.npy
+-rw-r--r--   0 simon      (501) staff       (20)    12626 2024-03-25 20:59:27.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/distances.py
+-rw-r--r--   0 simon      (501) staff       (20)    26425 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/fish_feature_extractor_2023_version_2.py
+-rw-r--r--   0 simon      (501) staff       (20)     2699 2024-03-10 16:29:57.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/cohens_kappa.py
+-rw-r--r--   0 simon      (501) staff       (20)     2465 2024-03-08 17:38:19.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/paths.py
+-rw-r--r--   0 simon      (501) staff       (20)     1048 2024-03-13 14:41:23.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/outliers_tietjen.py
+-rw-r--r--   0 simon      (501) staff       (20)     1424 2024-02-26 15:46:14.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/train_model.py
+-rw-r--r--   0 simon      (501) staff       (20)     3171 2024-02-27 21:31:05.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/amber_tests.py
+-rw-r--r--   0 simon      (501) staff       (20)     3590 2024-03-11 17:05:31.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/line_locate_point.py
+-rw-r--r--   0 simon      (501) staff       (20)     3182 2024-02-24 20:57:19.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/multifrm_to_points.py
+-rw-r--r--   0 simon      (501) staff       (20)       69 2024-03-18 18:17:24.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/lcs.py
+-rw-r--r--   0 simon      (501) staff       (20)    12448 2024-04-09 14:14:37.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/two_fish_feature_extractor_040924.py
+-rw-r--r--   0 simon      (501) staff       (20)     7535 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/egocentrical_aligner.py
+-rw-r--r--   0 simon      (501) staff       (20)     2350 2024-03-12 17:58:33.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/add_body_part.py
+-rw-r--r--   0 simon      (501) staff       (20)     1008 2024-03-12 13:29:20.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/grubbs_test.py
+-rw-r--r--   0 simon      (501) staff       (20)     3399 2024-02-16 01:12:37.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/slide_circ_mean.py
+-rw-r--r--   0 simon      (501) staff       (20)     1835 2024-03-28 22:56:59.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/calinski_harabasz.py
+-rw-r--r--   0 simon      (501) staff       (20)     1282 2024-02-27 21:31:05.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/roi_feature_visualizer_example.py
+-rw-r--r--   0 simon      (501) staff       (20)    10076 2024-03-22 16:51:40.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/spontaneuous_alternation_plotter.py
+-rw-r--r--   0 simon      (501) staff       (20)      895 2024-03-12 14:09:55.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/runs_test.py
+-rw-r--r--   0 simon      (501) staff       (20)     2516 2024-04-06 11:33:24.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/pct_counts_in_top_N.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:46:33.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     2287 2024-03-25 16:45:04.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/total_variation_distance.py
+-rw-r--r--   0 simon      (501) staff       (20)     3056 2024-02-27 21:31:05.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/crop_single_polygon.py
+-rw-r--r--   0 simon      (501) staff       (20)     8010 2024-03-24 19:48:22.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/joint_plotter.py
+-rw-r--r--   0 simon      (501) staff       (20)     2552 2024-04-02 14:48:59.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/elliptic_envelope.py
+-rw-r--r--   0 simon      (501) staff       (20)     1016 2024-03-14 14:57:29.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/roi_definition_csvs_to_h5.py.zip
+-rw-r--r--   0 simon      (501) staff       (20)     1276 2024-03-12 17:58:38.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/add_body_part.py.zip
+-rw-r--r--   0 simon      (501) staff       (20)      921 2024-02-26 15:46:14.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/roi_feature_visualizer_example.py.zip
+-rw-r--r--   0 simon      (501) staff       (20)     2631 2024-04-05 16:23:07.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/sliding_crosscorrelation.py
+-rw-r--r--   0 simon      (501) staff       (20)     1274 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/count_values_in_range.py
+-rw-r--r--   0 simon      (501) staff       (20)     2174 2024-03-14 14:56:26.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/roi_definition_csvs_to_h5.py
+-rw-r--r--   0 simon      (501) staff       (20)     1656 2024-03-30 18:32:44.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/distance_velocity.py
+-rw-r--r--   0 simon      (501) staff       (20)     5011 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/graph_creator.py
+-rw-r--r--   0 simon      (501) staff       (20)     5666 2024-04-11 15:28:58.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/line_plot_plotly.py
+-rw-r--r--   0 simon      (501) staff       (20)     3954 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/termite_rois.csv
+-rw-r--r--   0 simon      (501) staff       (20)     1351 2024-03-26 21:10:40.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/unsupervised_lof.py
+-rw-r--r--   0 simon      (501) staff       (20)     2553 2024-03-11 15:09:38.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/siegel_tukey.py
+-rw-r--r--   0 simon      (501) staff       (20)      958 2024-03-13 18:05:08.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/berger_parker.py
+-rw-r--r--   0 simon      (501) staff       (20)     4177 2024-04-10 01:56:43.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/isolation_forest.py
+-rw-r--r--   0 simon      (501) staff       (20)     2845 2024-03-28 19:23:54.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/davis_bouldin.py
+-rw-r--r--   0 simon      (501) staff       (20)     4094 2024-04-10 14:09:54.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/vertical_video_concatenator.py
+-rw-r--r--   0 simon      (501) staff       (20)     2770 2024-04-07 19:14:13.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/batch_video_to_greyscale.py
+-rw-r--r--   0 simon      (501) staff       (20)     7215 2024-02-26 15:46:14.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/crop_circles_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     1410 2024-03-19 12:49:24.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/heading.py
+-rw-r--r--   0 simon      (501) staff       (20)     2243 2024-03-13 18:35:02.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/piotr_120324 2.py.zip
+-rw-r--r--   0 simon      (501) staff       (20)      736 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/mutual_exclusive.py
+-rw-r--r--   0 simon      (501) staff       (20)     2907 2024-03-14 19:31:25.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/grangercausalitytests.py
+-rw-r--r--   0 simon      (501) staff       (20)     2432 2024-03-19 20:48:43.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/multiframe_is_shape_covered.py
+-rw-r--r--   0 simon      (501) staff       (20)      592 2024-02-27 21:31:33.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/redis.py
+-rw-r--r--   0 simon      (501) staff       (20)     2893 2024-02-26 20:49:33.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/video_color.py
+-rw-r--r--   0 simon      (501) staff       (20)     2055 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/graph_3d_plotter.py
+-rw-r--r--   0 simon      (501) staff       (20)     6186 2024-03-18 12:44:45.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/piotr_120324.py
+-rw-r--r--   0 simon      (501) staff       (20)     5515 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/video_rotator.py
+-rw-r--r--   0 simon      (501) staff       (20)     1004 2024-03-12 13:11:45.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/hartley_fmax.py
+-rw-r--r--   0 simon      (501) staff       (20)       84 2024-04-03 17:05:23.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/calc_N_degree_direction_switches.py
+-rw-r--r--   0 simon      (501) staff       (20)     2307 2024-02-27 21:31:33.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/fix_clahe.py
+-rw-r--r--   0 simon      (501) staff       (20)     1836 2024-03-10 15:38:46.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/cochran_q.py
+-rw-r--r--   0 simon      (501) staff       (20)      682 2024-03-13 19:19:43.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/menhinicks_index.py
+-rw-r--r--   0 simon      (501) staff       (20)     2932 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/add_probability_cnt_features.py
+-rw-r--r--   0 simon      (501) staff       (20)    13575 2024-03-20 11:47:11.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/spontanous_alternations.py
+-rw-r--r--   0 simon      (501) staff       (20)     2268 2024-03-13 13:59:07.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/piotr_120324.py.zip
+-rw-r--r--   0 simon      (501) staff       (20)     4655 2024-03-06 18:18:27.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/velocity_aggregator.py
+-rw-r--r--   0 simon      (501) staff       (20)     1619 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/make_splash.py
+-rw-r--r--   0 simon      (501) staff       (20)     4478 2024-04-08 20:43:42.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/abod.py
+-rw-r--r--   0 simon      (501) staff       (20)    37024 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/fish_feature_extractor_2023_version_5.py
+-rw-r--r--   0 simon      (501) staff       (20)     1073 2024-03-13 16:46:16.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/simpson_diversity_index.py
+-rw-r--r--   0 simon      (501) staff       (20)     2396 2024-03-17 16:55:38.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/piotr_120324 4.py.zip
+-rw-r--r--   0 simon      (501) staff       (20)     5336 2024-02-10 20:28:08.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/geometry_ex.py
+-rw-r--r--   0 simon      (501) staff       (20)     1613 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/time_stamp_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)     1505 2024-03-28 14:36:24.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/line_plot.py
+-rw-r--r--   0 simon      (501) staff       (20)     5515 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/video_rotator_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)    15996 2024-04-09 13:41:30.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/unsupervised_outliers.py
+-rw-r--r--   0 simon      (501) staff       (20)     5690 2024-02-10 20:28:08.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/statistics_ex.py
+-rw-r--r--   0 simon      (501) staff       (20)     1391 2024-03-18 23:21:46.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/sliding_displacement.py
+-rw-r--r--   0 simon      (501) staff       (20)      925 2024-03-11 13:06:04.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/wald_wolfowitz.py
+-rw-r--r--   0 simon      (501) staff       (20)     1814 2024-04-05 14:36:58.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/sliding_autoc.py
+-rw-r--r--   0 simon      (501) staff       (20)     2369 2024-03-14 17:07:10.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/linestring_path.py
+-rw-r--r--   0 simon      (501) staff       (20)     2233 2024-03-18 15:20:48.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/cronbach_alpha.py
+-rw-r--r--   0 simon      (501) staff       (20)     2809 2024-03-08 21:15:58.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/mcnamar.py
+-rw-r--r--   0 simon      (501) staff       (20)    37022 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/fish_feature_extractor_2023_version_4.py
+-rw-r--r--   0 simon      (501) staff       (20)     6220 2024-02-24 20:57:19.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/AmberFeatureExtractor.py.zip
+-rw-r--r--   0 simon      (501) staff       (20)     1933 2024-04-10 15:09:25.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/mosaic.py
+-rw-r--r--   0 simon      (501) staff       (20)    69423 2024-02-20 14:30:23.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/amber_featurizer.py
+-rw-r--r--   0 simon      (501) staff       (20)      837 2024-03-13 18:56:21.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/margalef_diversification_index.py
+-rw-r--r--   0 simon      (501) staff       (20)      997 2024-03-17 17:49:00.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/biweight_midcorrelation.py
+-rw-r--r--   0 simon      (501) staff       (20)     2186 2024-03-18 15:31:23.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/madmedianrule.py
+-rw-r--r--   0 simon      (501) staff       (20)     2915 2024-04-01 14:12:59.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/adjusted_rand_score.py
+-rw-r--r--   0 simon      (501) staff       (20)     2068 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/sandbox/convex_hull_scratch_2.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/
+-rw-r--r--   0 simon      (501) staff       (20)     8538 2024-02-23 18:25:51.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/directing_animals_to_bodypart_visualizer.py
+-rw-r--r--   0 simon      (501) staff       (20)    10127 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/gantt_creator.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/tools/
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:43:56.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/tools/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     5946 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/tools/tkinter_tools.py
+-rw-r--r--   0 simon      (501) staff       (20)    17927 2024-04-04 16:23:22.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/ROI_plotter_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)     6148 2024-03-28 13:50:53.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/.DS_Store
+-rw-r--r--   0 simon      (501) staff       (20)    19270 2024-03-31 17:21:01.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/shap_agg_stats_visualizer.py
+-rw-r--r--   0 simon      (501) staff       (20)    11178 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/gantt_creator_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)    15819 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/heat_mapper_clf_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)    10376 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/probability_plot_creator.py
+-rw-r--r--   0 simon      (501) staff       (20)     8467 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/circular_plotting.py
+-rw-r--r--   0 simon      (501) staff       (20)    16868 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/plot_clf_results.py
+-rw-r--r--   0 simon      (501) staff       (20)    16620 2024-02-27 15:29:59.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/plot_clf_results_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)    22893 2024-02-21 04:33:19.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/ROI_feature_visualizer.py
+-rw-r--r--   0 simon      (501) staff       (20)    13622 2024-02-21 04:25:14.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/heat_mapper_location.py
+-rw-r--r--   0 simon      (501) staff       (20)    11075 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/probability_plot_creator_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     5253 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/interactive_probability_grapher.py
+-rw-r--r--   0 simon      (501) staff       (20)     6517 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/plot_pose_in_dir.py
+-rw-r--r--   0 simon      (501) staff       (20)    20950 2024-04-11 20:25:55.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/single_run_model_validation_video.py
+-rw-r--r--   0 simon      (501) staff       (20)     8732 2024-04-11 20:42:04.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/frame_mergerer_ffmpeg.py
+-rw-r--r--   0 simon      (501) staff       (20)    10667 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/pose_plotter_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)     9368 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/directing_animals_visualizer_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)    14389 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/clf_validator.py
+-rw-r--r--   0 simon      (501) staff       (20)    22754 2024-03-06 18:18:21.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/path_plotter_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)    14075 2024-02-24 20:34:51.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/ROI_feature_visualizer_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)    10774 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/data_plotter.py
+-rw-r--r--   0 simon      (501) staff       (20)    13091 2024-03-26 23:49:10.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/spontaneous_alternation_plotter.py
+-rw-r--r--   0 simon      (501) staff       (20)    23178 2024-02-21 17:08:03.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/path_plotter.py
+-rw-r--r--   0 simon      (501) staff       (20)     9311 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/ez_lineplot.py
+-rw-r--r--   0 simon      (501) staff       (20)    16855 2024-04-11 20:42:04.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/distance_plotter_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)    22994 2024-02-21 04:08:15.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/ROI_plotter.py
+-rw-r--r--   0 simon      (501) staff       (20)    10034 2024-03-19 12:54:07.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/geometry_plotter.py
+-rw-r--r--   0 simon      (501) staff       (20)    16661 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/clf_validator_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)    14224 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/heat_mapper_clf.py
+-rw-r--r--   0 simon      (501) staff       (20)    12037 2024-04-11 20:42:04.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/distance_plotter.py
+-rw-r--r--   0 simon      (501) staff       (20)    19073 2024-04-11 20:26:33.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/single_run_model_validation_video_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)    12286 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/directing_animals_visualizer.py
+-rw-r--r--   0 simon      (501) staff       (20)    11453 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/circular_feature_overlay_plotter.py
+-rw-r--r--   0 simon      (501) staff       (20)    14576 2024-02-21 04:11:21.000000 Simba-UW-tf-dev-1.89.5/simba/plotting/heat_mapper_location_mp.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/dash_app/
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:44:15.000000 Simba-UW-tf-dev-1.89.5/simba/dash_app/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    72715 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/dash_app/SimBA_dash_app.py
+-rw-r--r--   0 simon      (501) staff       (20)     4965 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/dash_app/run_dash_tkinter.py
+-rw-r--r--   0 simon      (501) staff       (20)    47546 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/dash_app/dash_app.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/data_processors/
+-rw-r--r--   0 simon      (501) staff       (20)    14926 2024-03-29 16:15:58.000000 Simba-UW-tf-dev-1.89.5/simba/data_processors/spontaneous_alternation_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)    11813 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/data_processors/agg_clf_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)     6148 2024-03-28 13:50:53.000000 Simba-UW-tf-dev-1.89.5/simba/data_processors/.DS_Store
+-rw-r--r--   0 simon      (501) staff       (20)    13224 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/data_processors/severity_bout_based_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)    39110 2024-03-19 12:54:07.000000 Simba-UW-tf-dev-1.89.5/simba/data_processors/interpolation_smoothing.py
+-rw-r--r--   0 simon      (501) staff       (20)    10968 2024-02-21 19:10:40.000000 Simba-UW-tf-dev-1.89.5/simba/data_processors/directing_animal_to_bodypart.py
+-rw-r--r--   0 simon      (501) staff       (20)     9580 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/data_processors/timebins_clf_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)    20288 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/data_processors/fsttc_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/data_processors/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     4793 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/data_processors/boolean_conditional_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)     7117 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/data_processors/interpolate_pose.py
+-rw-r--r--   0 simon      (501) staff       (20)    16335 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/data_processors/directing_other_animals_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)     8957 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/data_processors/gibbs_sampler.py
+-rw-r--r--   0 simon      (501) staff       (20)    10054 2024-04-04 16:23:22.000000 Simba-UW-tf-dev-1.89.5/simba/data_processors/timebins_movement_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)     5255 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/data_processors/severity_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)    18517 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/data_processors/pup_retrieval_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)     3118 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/data_processors/pybursts_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)    13660 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/data_processors/severity_frame_based_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)     8738 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/data_processors/mutual_exclusivity_corrector.py
+-rw-r--r--   0 simon      (501) staff       (20)    12919 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/data_processors/kleinberg_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)    10196 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/data_processors/movement_calculator.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/model/
+-rw-r--r--   0 simon      (501) staff       (20)    23779 2024-04-11 20:25:55.000000 Simba-UW-tf-dev-1.89.5/simba/model/train_rf.py
+-rw-r--r--   0 simon      (501) staff       (20)     4969 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/model/inference_batch.py
+-rw-r--r--   0 simon      (501) staff       (20)    14036 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/model/train_multiclass_rf.py
+-rw-r--r--   0 simon      (501) staff       (20)     3937 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/model/inference_multiclass_batch.py
+-rw-r--r--   0 simon      (501) staff       (20)    15931 2024-02-20 14:30:06.000000 Simba-UW-tf-dev-1.89.5/simba/model/grid_search_multiclass_rf.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:41:19.000000 Simba-UW-tf-dev-1.89.5/simba/model/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    16987 2024-02-22 11:58:09.000000 Simba-UW-tf-dev-1.89.5/simba/model/grid_search_rf.py
+-rw-r--r--   0 simon      (501) staff       (20)     3768 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/model/inference_validation.py
+-rw-r--r--   0 simon      (501) staff       (20)     6872 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/model/train_multilabel_rf.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/roi_tools/
+-rw-r--r--   0 simon      (501) staff       (20)    12190 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_time_bin_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)     1803 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_movement_analyzer.py
+-rw-r--r--   0 simon      (501) staff       (20)     6148 2024-03-22 19:49:42.000000 Simba-UW-tf-dev-1.89.5/simba/roi_tools/.DS_Store
+-rw-r--r--   0 simon      (501) staff       (20)    50018 2024-03-11 20:20:39.000000 Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_define.py
+-rw-r--r--   0 simon      (501) staff       (20)     3616 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_reset.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/roi_tools/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     9876 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_size_standardizer.py
+-rw-r--r--   0 simon      (501) staff       (20)    30615 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_analyzer.py
+-rw-r--r--   0 simon      (501) staff       (20)    15704 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_feature_analyzer.py
+-rw-r--r--   0 simon      (501) staff       (20)     4386 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_multiply.py
+-rw-r--r--   0 simon      (501) staff       (20)     2313 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_size_calculations.py
+-rw-r--r--   0 simon      (501) staff       (20)     3716 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_zoom.py
+-rw-r--r--   0 simon      (501) staff       (20)    13394 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_directing_analyzer.py
+-rw-r--r--   0 simon      (501) staff       (20)    11974 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_move_shape.py
+-rw-r--r--   0 simon      (501) staff       (20)     5470 2024-02-21 03:51:46.000000 Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_menus.py
+-rw-r--r--   0 simon      (501) staff       (20)    16129 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_clf_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)    29730 2024-03-14 14:41:12.000000 Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_image.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/pose_importers/
+-rw-r--r--   0 simon      (501) staff       (20)    10711 2024-02-20 21:35:22.000000 Simba-UW-tf-dev-1.89.5/simba/pose_importers/sleap_csv_importer.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/pose_importers/misc/
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:47:31.000000 Simba-UW-tf-dev-1.89.5/simba/pose_importers/misc/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     8084 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/pose_importers/misc/apt_trk_importer.py
+-rw-r--r--   0 simon      (501) staff       (20)     2577 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/pose_importers/read_DANNCE_mat.py
+-rw-r--r--   0 simon      (501) staff       (20)     6148 2024-03-22 19:49:42.000000 Simba-UW-tf-dev-1.89.5/simba/pose_importers/.DS_Store
+-rw-r--r--   0 simon      (501) staff       (20)    14268 2024-02-20 21:35:22.000000 Simba-UW-tf-dev-1.89.5/simba/pose_importers/sleap_h5_importer.py
+-rw-r--r--   0 simon      (501) staff       (20)     8161 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/pose_importers/madlc_importer.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/pose_importers/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    13672 2024-02-20 21:35:22.000000 Simba-UW-tf-dev-1.89.5/simba/pose_importers/sleap_slp_importer.py
+-rw-r--r--   0 simon      (501) staff       (20)     8645 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/pose_importers/import_mars.py
+-rw-r--r--   0 simon      (501) staff       (20)     7464 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/pose_importers/dlc_importer_csv.py
+-rw-r--r--   0 simon      (501) staff       (20)     8417 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/pose_importers/trk_importer.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/pose_configurations/
+-rw-r--r--   0 simon      (501) staff       (20)     8196 2024-03-19 18:18:43.000000 Simba-UW-tf-dev-1.89.5/simba/pose_configurations/.DS_Store
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/pose_configurations/bp_names/
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:47:10.000000 Simba-UW-tf-dev-1.89.5/simba/pose_configurations/bp_names/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     4485 2024-03-04 19:10:54.000000 Simba-UW-tf-dev-1.89.5/simba/pose_configurations/bp_names/bp_names.csv
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/pose_configurations/no_animals/
+-rw-r--r--   0 simon      (501) staff       (20)       27 2024-03-04 19:10:54.000000 Simba-UW-tf-dev-1.89.5/simba/pose_configurations/no_animals/no_animals.csv
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:47:18.000000 Simba-UW-tf-dev-1.89.5/simba/pose_configurations/no_animals/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:47:05.000000 Simba-UW-tf-dev-1.89.5/simba/pose_configurations/__init__.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/pose_configurations/configuration_names/
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:47:14.000000 Simba-UW-tf-dev-1.89.5/simba/pose_configurations/configuration_names/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)      273 2024-03-04 19:10:54.000000 Simba-UW-tf-dev-1.89.5/simba/pose_configurations/configuration_names/pose_config_names.csv
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/pose_configurations/schematics/
+-rw-r--r--   0 simon      (501) staff       (20)    39805 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/pose_configurations/schematics/8.png
+-rw-r--r--   0 simon      (501) staff       (20)    62501 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/pose_configurations/schematics/9.png
+-rw-r--r--   0 simon      (501) staff       (20)     6172 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/pose_configurations/schematics/12.png
+-rw-r--r--   0 simon      (501) staff       (20)    34231 2024-02-20 18:50:39.000000 Simba-UW-tf-dev-1.89.5/simba/pose_configurations/schematics/13.png
+-rw-r--r--   0 simon      (501) staff       (20)    69501 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/pose_configurations/schematics/11.png
+-rw-r--r--   0 simon      (501) staff       (20)    69410 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/pose_configurations/schematics/10.png
+-rw-r--r--   0 simon      (501) staff       (20)    16000 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/pose_configurations/schematics/4.png
+-rw-r--r--   0 simon      (501) staff       (20)    28150 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/pose_configurations/schematics/5.png
+-rw-r--r--   0 simon      (501) staff       (20)    31140 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/pose_configurations/schematics/7.png
+-rw-r--r--   0 simon      (501) staff       (20)    30634 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/pose_configurations/schematics/6.png
+-rw-r--r--   0 simon      (501) staff       (20)    15417 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/pose_configurations/schematics/2.png
+-rw-r--r--   0 simon      (501) staff       (20)    15786 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/pose_configurations/schematics/3.png
+-rw-r--r--   0 simon      (501) staff       (20)    18939 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/pose_configurations/schematics/1.png
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/video_processors/
+-rw-r--r--   0 simon      (501) staff       (20)   113176 2024-04-11 20:42:04.000000 Simba-UW-tf-dev-1.89.5/simba/video_processors/video_processing.py
+-rw-r--r--   0 simon      (501) staff       (20)     6148 2024-03-26 15:01:23.000000 Simba-UW-tf-dev-1.89.5/simba/video_processors/.DS_Store
+-rw-r--r--   0 simon      (501) staff       (20)     5577 2024-04-08 11:29:52.000000 Simba-UW-tf-dev-1.89.5/simba/video_processors/roi_selector_circle.py
+-rw-r--r--   0 simon      (501) staff       (20)     9073 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/video_processors/px_to_mm.py
+-rw-r--r--   0 simon      (501) staff       (20)    35053 2024-02-26 15:42:07.000000 Simba-UW-tf-dev-1.89.5/simba/video_processors/batch_process_menus.py
+-rw-r--r--   0 simon      (501) staff       (20)    11439 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/video_processors/multi_cropper.py
+-rw-r--r--   0 simon      (501) staff       (20)     3066 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/video_processors/extract_frames.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/video_processors/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     6598 2024-02-26 21:50:01.000000 Simba-UW-tf-dev-1.89.5/simba/video_processors/roi_selector.py
+-rw-r--r--   0 simon      (501) staff       (20)    10007 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/video_processors/calculate_px_dist.py
+-rw-r--r--   0 simon      (501) staff       (20)     5963 2024-02-27 21:31:05.000000 Simba-UW-tf-dev-1.89.5/simba/video_processors/roi_selector_polygon.py
+-rw-r--r--   0 simon      (501) staff       (20)     4926 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/video_processors/extract_seqframes.py
+-rw-r--r--   0 simon      (501) staff       (20)    15117 2024-04-11 20:42:04.000000 Simba-UW-tf-dev-1.89.5/simba/video_processors/batch_process_create_ffmpeg_commands.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/outlier_tools/
+-rw-r--r--   0 simon      (501) staff       (20)     7837 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/outlier_tools/outlier_corrector_movement.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/outlier_tools/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    14462 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/outlier_tools/outlier_corrector_location_advanced.py
+-rw-r--r--   0 simon      (501) staff       (20)    13117 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/outlier_tools/outlier_corrector_movement_advanced.py
+-rw-r--r--   0 simon      (501) staff       (20)    10396 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/outlier_tools/outlier_corrector_location.py
+-rw-r--r--   0 simon      (501) staff       (20)     2751 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/outlier_tools/skip_outlier_correction.py
+-rw-r--r--   0 simon      (501) staff       (20)    81222 2024-04-11 20:25:55.000000 Simba-UW-tf-dev-1.89.5/simba/SimBA.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:16.000000 Simba-UW-tf-dev-1.89.5/simba/assets/
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/assets/unsupervised/
+-rw-r--r--   0 simon      (501) staff       (20)   109483 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/unsupervised/model_names.parquet
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:45:36.000000 Simba-UW-tf-dev-1.89.5/simba/assets/unsupervised/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    14175 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/unsupervised/features.csv
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:16.000000 Simba-UW-tf-dev-1.89.5/simba/assets/shap/
+-rw-r--r--   0 simon      (501) staff       (20)     1177 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/shap/down_arrow.jpg
+-rw-r--r--   0 simon      (501) staff       (20)     1733 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/shap/intruder_shape.jpg
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:16.000000 Simba-UW-tf-dev-1.89.5/simba/assets/shap/feature_categories/
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:45:25.000000 Simba-UW-tf-dev-1.89.5/simba/assets/shap/feature_categories/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    17420 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/shap/feature_categories/shap_feature_categories.csv
+-rw-r--r--   0 simon      (501) staff       (20)     1665 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/shap/resident_shape.jpg
+-rw-r--r--   0 simon      (501) staff       (20)     2415 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/shap/resident_intruder_shape.jpg
+-rw-r--r--   0 simon      (501) staff       (20)     2012 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/shap/animal_distances.jpg
+-rw-r--r--   0 simon      (501) staff       (20)     4422 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/shap/baseline_scale.jpg
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:45:21.000000 Simba-UW-tf-dev-1.89.5/simba/assets/shap/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)   353824 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/shap/ubuntu.regular.ttf
+-rw-r--r--   0 simon      (501) staff       (20)     6672 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/shap/side_scale.jpg
+-rw-r--r--   0 simon      (501) staff       (20)   189004 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/shap/UbuntuMono-Regular.ttf
+-rw-r--r--   0 simon      (501) staff       (20)     2737 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/shap/side_scale_5.jpg
+-rw-r--r--   0 simon      (501) staff       (20)     1785 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/shap/intruder_movement.jpg
+-rw-r--r--   0 simon      (501) staff       (20)     1435 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/shap/resident_movement.jpg
+-rw-r--r--   0 simon      (501) staff       (20)     3134 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/shap/color_bar.jpg
+-rw-r--r--   0 simon      (501) staff       (20)     2120 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/shap/resident_intruder_movement.jpg
+-rw-r--r--   0 simon      (501) staff       (20)    10244 2024-04-09 23:07:16.000000 Simba-UW-tf-dev-1.89.5/simba/assets/.DS_Store
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:16.000000 Simba-UW-tf-dev-1.89.5/simba/assets/lookups/
+-rw-r--r--   0 simon      (501) staff       (20)   270783 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/lookups/model_names.parquet
+-rw-r--r--   0 simon      (501) staff       (20)     2987 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/lookups/feature_extraction_headers.csv
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:45:11.000000 Simba-UW-tf-dev-1.89.5/simba/assets/lookups/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    26256 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/lookups/critical_values_05.pickle
+-rw-r--r--   0 simon      (501) staff       (20)    14175 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/lookups/features.csv
+-rw-r--r--   0 simon      (501) staff       (20)    14175 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/lookups/unsupervised_example_x.csv
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:41:54.000000 Simba-UW-tf-dev-1.89.5/simba/assets/__init__.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/simba/assets/stl/
+-rw-r--r--   0 simon      (501) staff       (20)   551576 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/stl/operant_tray.stl
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:45:31.000000 Simba-UW-tf-dev-1.89.5/simba/assets/stl/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    67647 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/stl/operant_lever.stl
+-rw-r--r--   0 simon      (501) staff       (20)    92896 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/stl/operant_walls.stl
+-rw-r--r--   0 simon      (501) staff       (20)  4759984 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/stl/grid_floor.stl
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:16.000000 Simba-UW-tf-dev-1.89.5/simba/assets/img/
+-rw-r--r--   0 simon      (501) staff       (20)   489479 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/img/splash_2024.mp4
+-rw-r--r--   0 simon      (501) staff       (20)    79863 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/img/bg_2024.png
+-rw-r--r--   0 simon      (501) staff       (20)   399272 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/img/about_me.png
+-rw-r--r--   0 simon      (501) staff       (20)   117108 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/img/splash.mp4
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:45:02.000000 Simba-UW-tf-dev-1.89.5/simba/assets/img/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)   322242 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/img/bg_2.png
+-rw-r--r--   0 simon      (501) staff       (20)      165 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/img/~$splash.pptx
+-rw-r--r--   0 simon      (501) staff       (20)    69267 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/img/splash.pptx
+-rw-r--r--   0 simon      (501) staff       (20)   204362 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/img/bg.png
+-rw-r--r--   0 simon      (501) staff       (20)   189004 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/UbuntuMono-Regular.ttf
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:16.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/
+-rw-r--r--   0 simon      (501) staff       (20)     1350 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/factory.png
+-rw-r--r--   0 simon      (501) staff       (20)     1413 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/cluster.png
+-rw-r--r--   0 simon      (501) staff       (20)     1340 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/load.png
+-rw-r--r--   0 simon      (501) staff       (20)     4507 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/gif.png
+-rw-r--r--   0 simon      (501) staff       (20)     4566 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/pose.png
+-rw-r--r--   0 simon      (501) staff       (20)     1943 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/features.png
+-rw-r--r--   0 simon      (501) staff       (20)     6148 2024-04-09 15:42:22.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/.DS_Store
+-rw-r--r--   0 simon      (501) staff       (20)     4896 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/settings.png
+-rw-r--r--   0 simon      (501) staff       (20)     2090 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/stopwatch.png
+-rw-r--r--   0 simon      (501) staff       (20)     1252 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/link.png
+-rw-r--r--   0 simon      (501) staff       (20)    14250 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/dash_simba.css
+-rw-r--r--   0 simon      (501) staff       (20)      917 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/documentation.png
+-rw-r--r--   0 simon      (501) staff       (20)     4503 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/fps.png
+-rw-r--r--   0 simon      (501) staff       (20)     1299 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/dimensionality_reduction.png
+-rw-r--r--   0 simon      (501) staff       (20)     4823 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/roi.png
+-rw-r--r--   0 simon      (501) staff       (20)   171446 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/simba_logo_2.png
+-rw-r--r--   0 simon      (501) staff       (20)      920 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/superimpose.png
+-rw-r--r--   0 simon      (501) staff       (20)     1136 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/label.png
+-rw-r--r--   0 simon      (501) staff       (20)     1016 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/change.png
+-rw-r--r--   0 simon      (501) staff       (20)    59896 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/readthedocs_logo.png
+-rw-r--r--   0 simon      (501) staff       (20)     1124 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/crop.png
+-rw-r--r--   0 simon      (501) staff       (20)     2146 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/rotate.png
+-rw-r--r--   0 simon      (501) staff       (20)     1921 2024-02-26 14:29:54.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/circle.png
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:44:37.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     1057 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/path.png
+-rw-r--r--   0 simon      (501) staff       (20)     1148 2024-02-26 20:39:14.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/polygon.png
+-rw-r--r--   0 simon      (501) staff       (20)      950 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/clip.png
+-rw-r--r--   0 simon      (501) staff       (20)     2121 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/restart.png
+-rw-r--r--   0 simon      (501) staff       (20)     4653 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/calipher.png
+-rw-r--r--   0 simon      (501) staff       (20)     1291 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/add_on.png
+-rw-r--r--   0 simon      (501) staff       (20)     4695 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/create.png
+-rw-r--r--   0 simon      (501) staff       (20)    78182 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/SimBA_logo.ico
+-rw-r--r--   0 simon      (501) staff       (20)     1067 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/print.png
+-rw-r--r--   0 simon      (501) staff       (20)     4653 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/clf.png
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:16.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/concat_icons/
+-rw-r--r--   0 simon      (501) staff       (20)     6027 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/concat_icons/mosaic.png
+-rw-r--r--   0 simon      (501) staff       (20)     5654 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/concat_icons/vertical.png
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:44:45.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/concat_icons/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     5542 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/concat_icons/horizontal.png
+-rw-r--r--   0 simon      (501) staff       (20)     5939 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/concat_icons/mixed_mosaic.png
+-rw-r--r--   0 simon      (501) staff       (20)     2060 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/merge.png
+-rw-r--r--   0 simon      (501) staff       (20)     1252 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/clean.png
+-rw-r--r--   0 simon      (501) staff       (20)     4725 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/clf_2.png
+-rw-r--r--   0 simon      (501) staff       (20)     4795 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/visualize.png
+-rw-r--r--   0 simon      (501) staff       (20)     2142 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/concat.png
+-rw-r--r--   0 simon      (501) staff       (20)     1474 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/boris.png
+-rw-r--r--   0 simon      (501) staff       (20)     4804 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/frames.png
+-rw-r--r--   0 simon      (501) staff       (20)     2425 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/video.png
+-rw-r--r--   0 simon      (501) staff       (20)     2089 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/sample.png
+-rw-r--r--   0 simon      (501) staff       (20)     1471 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/metrics.png
+-rw-r--r--   0 simon      (501) staff       (20)     4555 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/grey.png
+-rw-r--r--   0 simon      (501) staff       (20)      930 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/exit.png
+-rw-r--r--   0 simon      (501) staff       (20)     4751 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/outlier.png
+-rw-r--r--   0 simon      (501) staff       (20)     4392 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/clahe.png
+-rw-r--r--   0 simon      (501) staff       (20)     4637 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/trash.png
+-rw-r--r--   0 simon      (501) staff       (20)     1239 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/about.png
+-rw-r--r--   0 simon      (501) staff       (20)     4666 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/convert.png
+-rw-r--r--   0 simon      (501) staff       (20)    93229 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/SimBA_logo.icns
+-rw-r--r--   0 simon      (501) staff       (20)      991 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/reorganize.png
+-rw-r--r--   0 simon      (501) staff       (20)     4784 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/browse.png
+-rw-r--r--   0 simon      (501) staff       (20)    30707 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/SimBA_logo.png
+-rw-r--r--   0 simon      (501) staff       (20)     2293 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/ethovision.png
+-rw-r--r--   0 simon      (501) staff       (20)     1018 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/icons/close.png
+-rw-r--r--   0 simon      (501) staff       (20)    13672 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/dash_simba_base.css
+-rw-r--r--   0 simon      (501) staff       (20)    31812 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.89.5/simba/assets/TheGoldenLab.PNG
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:16.000000 Simba-UW-tf-dev-1.89.5/Simba_UW_tf_dev.egg-info/
+-rw-r--r--   0 simon      (501) staff       (20)     2797 2024-04-11 20:42:16.000000 Simba-UW-tf-dev-1.89.5/Simba_UW_tf_dev.egg-info/PKG-INFO
+-rw-r--r--   0 simon      (501) staff       (20)    23031 2024-04-11 20:42:16.000000 Simba-UW-tf-dev-1.89.5/Simba_UW_tf_dev.egg-info/SOURCES.txt
+-rw-r--r--   0 simon      (501) staff       (20)       44 2024-04-11 20:42:16.000000 Simba-UW-tf-dev-1.89.5/Simba_UW_tf_dev.egg-info/entry_points.txt
+-rw-r--r--   0 simon      (501) staff       (20)      753 2024-04-11 20:42:16.000000 Simba-UW-tf-dev-1.89.5/Simba_UW_tf_dev.egg-info/requires.txt
+-rw-r--r--   0 simon      (501) staff       (20)        6 2024-04-11 20:42:16.000000 Simba-UW-tf-dev-1.89.5/Simba_UW_tf_dev.egg-info/top_level.txt
+-rw-r--r--   0 simon      (501) staff       (20)        1 2024-04-11 20:42:16.000000 Simba-UW-tf-dev-1.89.5/Simba_UW_tf_dev.egg-info/dependency_links.txt
+-rw-r--r--   0 simon      (501) staff       (20)    35127 2024-02-07 18:56:10.000000 Simba-UW-tf-dev-1.89.5/LICENSE
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/tests/
+-rw-r--r--   0 simon      (501) staff       (20)     4753 2024-04-11 20:40:04.000000 Simba-UW-tf-dev-1.89.5/tests/test_data_processors.py
+-rw-r--r--   0 simon      (501) staff       (20)    13415 2024-03-01 16:43:04.000000 Simba-UW-tf-dev-1.89.5/tests/test_circlular_stats.py
+-rw-r--r--   0 simon      (501) staff       (20)    13399 2024-04-11 20:36:51.000000 Simba-UW-tf-dev-1.89.5/tests/test_stats.py
+-rw-r--r--   0 simon      (501) staff       (20)     5375 2024-04-11 17:06:47.000000 Simba-UW-tf-dev-1.89.5/tests/test_distance_plotter.py
+-rw-r--r--   0 simon      (501) staff       (20)    11863 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.89.5/tests/test_train_model_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)     6525 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.89.5/tests/test_feature_extraction_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)     1739 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.89.5/tests/test_utils_data.py
+-rw-r--r--   0 simon      (501) staff       (20)     8120 2024-03-01 19:06:25.000000 Simba-UW-tf-dev-1.89.5/tests/test_config_reader_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)     1070 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.89.5/tests/test_outlier_correctors.py
+-rw-r--r--   0 simon      (501) staff       (20)     4435 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.89.5/tests/test_visualize_directing_animals.py
+-rw-r--r--   0 simon      (501) staff       (20)     1596 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.89.5/tests/test_featurizers.py
+-rw-r--r--   0 simon      (501) staff       (20)     8570 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.89.5/tests/test_video_processors.py
+-rw-r--r--   0 simon      (501) staff       (20)     3554 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.89.5/tests/test_thirdparty_appenders.py
+-rw-r--r--   0 simon      (501) staff       (20)     3021 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.89.5/tests/test_validation_clips.py
+-rw-r--r--   0 simon      (501) staff       (20)     3992 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.89.5/tests/test_roi_tools.py
+-rw-r--r--   0 simon      (501) staff       (20)      318 2024-03-04 20:16:28.000000 Simba-UW-tf-dev-1.89.5/MANIFEST.in
+-rw-r--r--   0 simon      (501) staff       (20)    18403 2024-02-12 00:49:21.000000 Simba-UW-tf-dev-1.89.5/README.md
+-rw-r--r--   0 simon      (501) staff       (20)     1426 2024-04-11 20:42:14.000000 Simba-UW-tf-dev-1.89.5/setup.py
+-rw-r--r--   0 simon      (501) staff       (20)       38 2024-04-11 20:42:17.000000 Simba-UW-tf-dev-1.89.5/setup.cfg
```

### Comparing `Simba-UW-tf-dev-1.89.4/PKG-INFO` & `Simba-UW-tf-dev-1.89.5/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: Simba-UW-tf-dev
-Version: 1.89.4
+Version: 1.89.5
 Summary: Toolkit for computer classification of behaviors in experimental animals
 Home-page: https://github.com/sgoldenlab/simba
 Author: Simon Nilsson, Jia Jie Choong, Sophia Hwang
 Author-email: sronilsson@gmail.com
 License: GNU Lesser General Public License v3 (LGPLv3)
 Platform: UNKNOWN
 Classifier: Programming Language :: Python :: 3
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/.DS_Store` & `Simba-UW-tf-dev-1.89.5/simba/ui/.DS_Store`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/mutual_exclusivity_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/mutual_exclusivity_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/movement_analysis_time_bins_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/movement_analysis_time_bins_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/csv_2_parquet_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/csv_2_parquet_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/quick_path_plot_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/quick_path_plot_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/batch_preprocess_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/batch_preprocess_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/heatmap_location_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/heatmap_location_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/clf_probability_plot_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/clf_probability_plot_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/movement_analysis_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/movement_analysis_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/set_machine_model_parameters_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/set_machine_model_parameters_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/clf_plot_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/clf_plot_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/path_plot_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/path_plot_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/remove_roi_features_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/remove_roi_features_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/targeted_annotation_clips_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/targeted_annotation_clips_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/smoothing_interpolation_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/smoothing_interpolation_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/roi_size_standardizer_popup.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/roi_size_standardizer_popup.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/visualize_pose_in_dir_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/visualize_pose_in_dir_pop_up.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,9 +1,10 @@
 __author__ = "Simon Nilsson"
 
+import threading
 from tkinter import *
 
 from simba.mixins.pop_up_mixin import PopUpMixin
 from simba.plotting.pose_plotter_mp import PosePlotter
 from simba.ui.tkinter_functions import (CreateLabelFrameWithIcon, DropDownMenu,
                                         FolderSelect)
 from simba.utils.checks import check_if_dir_exists
@@ -52,15 +53,15 @@
         self.core_cnt_dropdown = DropDownMenu(
             settings_frame,
             "Core count (higher for faster runtime):",
             list(range(1, find_core_cnt()[0])),
             "30",
         )
         self.core_cnt_dropdown.setChoices(1)
-        run_btn = Button(
+        self.run_btn = Button(
             self.main_frm,
             text="VISUALIZE POSE",
             font=Formats.LABELFRAME_HEADER_FORMAT.value,
             fg="blue",
             command=lambda: self.run(),
         )
         self.advanced_settings_btn = Button(
@@ -72,15 +73,15 @@
         )
         settings_frame.grid(row=0, sticky=W)
         self.input_folder.grid(row=0, column=0, sticky=NW)
         self.output_folder.grid(row=1, column=0, sticky=NW)
         self.circle_size_dropdown.grid(row=2, column=0, sticky=NW)
         self.sample_size_dropdown.grid(row=3, column=0, sticky=NW)
         self.core_cnt_dropdown.grid(row=4, column=0, sticky=NW)
-        run_btn.grid(row=5, column=0)
+        self.run_btn.grid(row=5, column=0)
         self.advanced_settings_btn.grid(row=6, column=0)
         self.color_lookup = None
 
         self.main_frm.mainloop()
 
     def run(self):
         circle_size_int = int(self.circle_size_dropdown.getChoices())
@@ -102,38 +103,47 @@
             in_dir=input_folder,
             out_dir=output_folder,
             circle_size=circle_size_int,
             core_cnt=int(self.core_cnt_dropdown.getChoices()),
             color_settings=self.color_lookup,
             sample_time=sample_time,
         )
-        pose_plotter.run()
+
+        threading.Thread(target=pose_plotter.run()).start()
 
     def launch_adv_settings(self):
         if self.advanced_settings_btn["text"] == "OPEN ADVANCED SETTINGS":
             self.advanced_settings_btn.configure(text="CLOSE ADVANCED SETTINGS")
             self.adv_settings_frm = LabelFrame(
                 self.main_frm,
                 text="ADVANCED SETTINGS",
                 font=Formats.LABELFRAME_HEADER_FORMAT.value,
                 pady=5,
                 padx=5,
             )
+            self.run_btn = Button(
+                self.adv_settings_frm,
+                text="VISUALIZE POSE",
+                font=Formats.LABELFRAME_HEADER_FORMAT.value,
+                fg="blue",
+                command=lambda: self.run(),
+            )
             self.confirm_btn = Button(
                 self.adv_settings_frm,
                 text="Confirm",
                 command=lambda: self.launch_clr_menu(),
             )
             self.specify_animals_dropdown = DropDownMenu(
                 self.adv_settings_frm, "ANIMAL COUNT: ", list(range(1, 11)), "20"
             )
             self.specify_animals_dropdown.setChoices(1)
             self.adv_settings_frm.grid(row=5, column=0, pady=10)
             self.specify_animals_dropdown.grid(row=0, column=0, sticky=NW)
             self.confirm_btn.grid(row=0, column=1)
+            self.run_btn.grid(row=2, column=0)
         elif self.advanced_settings_btn["text"] == "CLOSE ADVANCED SETTINGS":
             if hasattr(self, "adv_settings_frm"):
                 self.adv_settings_frm.destroy()
                 self.color_lookup = None
             self.advanced_settings_btn.configure(text="OPEN ADVANCED SETTINGS")
 
     def launch_clr_menu(self):
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/roi_analysis_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/roi_analysis_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/outlier_settings_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/outlier_settings_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/gantt_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/gantt_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/clf_validation_plot_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/clf_validation_plot_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/severity_analysis_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/severity_analysis_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/fsttc_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/fsttc_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/kleinberg_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/kleinberg_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/directing_other_animals_plot_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/directing_other_animals_plot_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/spontaneous_alternation_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/spontaneous_alternation_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/pose_reorganizer_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/pose_reorganizer_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/animal_directing_other_animals_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/animal_directing_other_animals_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/append_roi_features_animals_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/append_roi_features_animals_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/clf_by_timebins_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/clf_by_timebins_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/heatmap_clf_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/heatmap_clf_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/data_plot_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/data_plot_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/roi_features_plot_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/roi_features_plot_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/pup_retrieval_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/pup_retrieval_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/boolean_conditional_slicer_pup_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/boolean_conditional_slicer_pup_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/about_simba_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/about_simba_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/clf_descriptive_statistics_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/clf_descriptive_statistics_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/roi_tracking_plot_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/roi_tracking_plot_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/append_roi_features_bodypart_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/append_roi_features_bodypart_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/directing_animal_to_bodypart_plot_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/directing_animal_to_bodypart_plot_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/clf_add_remove_print_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/clf_add_remove_print_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/video_processing_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/video_processing_pop_up.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,14 +1,15 @@
 __author__ = "Simon Nilsson"
 
 import glob
 import os
 import sys
 import threading
 from tkinter import *
+from typing import Optional, Union
 
 from PIL import Image, ImageTk
 
 import simba
 from simba.labelling.extract_labelled_frames import AnnotationFrameExtractor
 from simba.mixins.config_reader import ConfigReader
 from simba.mixins.pop_up_mixin import PopUpMixin
@@ -27,18 +28,18 @@
 from simba.utils.read_write import (concatenate_videos_in_folder, get_fn_ext,
                                     get_video_meta_data)
 from simba.video_processors.extract_seqframes import extract_seq_frames
 from simba.video_processors.multi_cropper import MultiCropper
 from simba.video_processors.px_to_mm import get_coordinates_nilsson
 from simba.video_processors.video_processing import (
     VideoRotator, batch_convert_video_format, batch_create_frames,
-    change_fps_of_multiple_videos, change_img_format, change_single_video_fps,
-    clahe_enhance_video, clip_video_in_range, convert_to_mp4,
-    convert_video_powerpoint_compatible_format, copy_img_folder,
-    crop_multiple_videos, crop_multiple_videos_circles,
+    batch_video_to_greyscale, change_fps_of_multiple_videos, change_img_format,
+    change_single_video_fps, clahe_enhance_video, clip_video_in_range,
+    convert_to_mp4, convert_video_powerpoint_compatible_format,
+    copy_img_folder, crop_multiple_videos, crop_multiple_videos_circles,
     crop_multiple_videos_polygons, crop_single_video, crop_single_video_circle,
     crop_single_video_polygon, downsample_video, extract_frame_range,
     extract_frames_single_video, frames_to_movie, gif_creator,
     multi_split_video, remove_beginning_of_video, superimpose_frame_count,
     video_concatenator, video_to_greyscale)
 
 sys.setrecursionlimit(10**7)
@@ -230,42 +231,78 @@
 
 #       self.main_frm.mainloop()
 # _ = ClipVideoPopUp()
 
 
 class GreyscaleSingleVideoPopUp(PopUpMixin):
     def __init__(self):
-        super().__init__(title="GREYSCALE SINGLE VIDEO")
-        settings_frm = CreateLabelFrameWithIcon(
+        super().__init__(title="GREYSCALE VIDEO")
+        video_frm = CreateLabelFrameWithIcon(
             parent=self.main_frm,
             header="GREYSCALE VIDEO",
             icon_name=Keys.DOCUMENTATION.value,
             icon_link=Links.VIDEO_TOOLS.value,
         )
         self.selected_video = FileSelect(
-            settings_frm,
-            "VIDEO PATH",
+            video_frm,
+            "VIDEO FILE PATH",
             title="Select a video file",
-            lblwidth=10,
+            lblwidth=20,
             file_types=[("VIDEO FILE", Options.ALL_VIDEO_FORMAT_STR_OPTIONS.value)],
         )
-        self.use_gpu_var = BooleanVar(value=False)
-        use_gpu_cb = Checkbutton(
-            settings_frm, text="Use GPU (reduced runtime)", variable=self.use_gpu_var
+        self.use_gpu_var_video = BooleanVar(value=False)
+        use_gpu_video_cb = Checkbutton(
+            video_frm, text="Use GPU (reduced runtime)", variable=self.use_gpu_var_video
+        )
+        run_video_btn = Button(
+            video_frm, text="RUN", command=lambda: self.run_video(), fg="blue"
         )
 
-        settings_frm.grid(row=0, column=0, sticky="NW")
+        dir_frm = CreateLabelFrameWithIcon(
+            parent=self.main_frm,
+            header="GREYSCALE VIDEO DIRECTORY",
+            icon_name=Keys.DOCUMENTATION.value,
+            icon_link=Links.VIDEO_TOOLS.value,
+        )
+        self.dir_selected = FolderSelect(
+            dir_frm,
+            "VIDEO DIRECTORY PATH",
+            title="Select folder with videos",
+            lblwidth=20,
+        )
+        self.use_gpu_var_dir = BooleanVar(value=False)
+        use_gpu_dir_cb = Checkbutton(
+            dir_frm, text="Use GPU (reduced runtime)", variable=self.use_gpu_var_dir
+        )
+        run_dir_btn = Button(
+            dir_frm, text="RUN", command=lambda: self.run_dir(), fg="blue"
+        )
+
+        video_frm.grid(row=0, column=0, sticky="NW")
         self.selected_video.grid(row=0, column=0, sticky="NW")
-        use_gpu_cb.grid(row=1, column=0, sticky="NW")
-        self.create_run_frm(run_function=self.run)
+        use_gpu_video_cb.grid(row=1, column=0, sticky="NW")
+        run_video_btn.grid(row=2, column=0, sticky="NW")
 
-    def run(self):
+        dir_frm.grid(row=1, column=0, sticky="NW")
+        self.dir_selected.grid(row=0, column=0, sticky="NW")
+        use_gpu_dir_cb.grid(row=1, column=0, sticky="NW")
+        run_dir_btn.grid(row=2, column=0, sticky="NW")
+
+        self.main_frm.mainloop()
+
+    def run_video(self):
         check_file_exist_and_readable(file_path=self.selected_video.file_path)
         video_to_greyscale(
-            file_path=self.selected_video.file_path, gpu=self.use_gpu_var.get()
+            file_path=self.selected_video.file_path, gpu=self.use_gpu_var_video.get()
+        )
+
+    def run_dir(self):
+        check_if_dir_exists(in_dir=self.dir_selected.folder_path)
+        batch_video_to_greyscale(
+            directory=self.dir_selected.folder_path, gpu=self.use_gpu_var_dir.get()
         )
 
 
 class SuperImposeFrameCountPopUp(PopUpMixin):
     def __init__(self):
         super().__init__(title="SUPERIMPOSE FRAME COUNT ON VIDEO")
         settings_frm = CreateLabelFrameWithIcon(
@@ -1039,15 +1076,15 @@
         use_gpu_cb.grid(row=3, column=0, sticky=NW)
         horizontal_radio_btn.grid(row=4, column=0, sticky=NW)
         vertical_radio_btn.grid(row=5, column=0, sticky=NW)
         run_btn.grid(row=1, column=0, sticky=NW)
 
 
 class ConcatenatorPopUp(PopUpMixin, ConfigReader):
-    def __init__(self, config_path: str or None):
+    def __init__(self, config_path: Optional[Union[str, os.PathLike]] = None):
         PopUpMixin.__init__(self, title="MERGE (CONCATENATE) VIDEOS")
         self.config_path = config_path
         self.select_video_cnt_frm = CreateLabelFrameWithIcon(
             parent=self.main_frm,
             header="VIDEOS #",
             icon_name=Keys.DOCUMENTATION.value,
             icon_link=Links.CONCAT_VIDEOS.value,
@@ -1060,14 +1097,15 @@
             self.select_video_cnt_frm,
             text="SELECT",
             command=lambda: self.populate_table(),
         )
         self.select_video_cnt_frm.grid(row=0, column=0, sticky=NW)
         self.select_video_cnt_dropdown.grid(row=0, column=0, sticky=NW)
         self.select_video_cnt_btn.grid(row=0, column=1, sticky=NW)
+        self.main_frm.mainloop()
 
     def populate_table(self):
         if hasattr(self, "video_table_frm"):
             self.video_table_frm.destroy()
             self.join_type_frm.destroy()
         self.video_table_frm = LabelFrame(
             self.main_frm,
@@ -1098,15 +1136,15 @@
             self.videos_dict[cnt].grid(row=cnt, column=0, sticky=NW)
 
         self.join_type_var = StringVar()
         self.icons_dict = {}
         simba_dir = os.path.dirname(simba.__file__)
         icon_assets_dir = os.path.join(simba_dir, Paths.ICON_ASSETS.value)
         concat_icon_dir = os.path.join(icon_assets_dir, "concat_icons")
-        for file_cnt, file_path in enumerate(glob.glob(concat_icon_dir + "/*")):
+        for file_cnt, file_path in enumerate(glob.glob(concat_icon_dir + "/*.png")):
             _, file_name, _ = get_fn_ext(file_path)
             self.icons_dict[file_name] = {}
             self.icons_dict[file_name]["img"] = ImageTk.PhotoImage(
                 Image.open(file_path)
             )
             self.icons_dict[file_name]["btn"] = Radiobutton(
                 self.join_type_frm,
@@ -1127,19 +1165,19 @@
             padx=5,
             font=Formats.LABELFRAME_HEADER_FORMAT.value,
             fg="black",
         )
         self.resolution_width = DropDownMenu(
             self.resolution_frm, "Width", ["480", "640", "1280", "1920", "2560"], "15"
         )
-        self.resolution_width.setChoices("640")
+        self.resolution_width.setChoices("480")
         self.resolution_height = DropDownMenu(
             self.resolution_frm, "Height", ["480", "640", "1280", "1920", "2560"], "15"
         )
-        self.resolution_height.setChoices("480")
+        self.resolution_height.setChoices("640")
         self.gpu_frm = LabelFrame(
             self.main_frm,
             text="GPU",
             pady=5,
             padx=5,
             font=Formats.LABELFRAME_HEADER_FORMAT.value,
             fg="black",
@@ -1154,36 +1192,41 @@
         self.resolution_width.grid(row=0, column=0, sticky=NW)
         self.resolution_height.grid(row=1, column=0, sticky=NW)
 
         run_btn = Button(self.main_frm, text="RUN", command=lambda: self.run())
         run_btn.grid(row=5, column=0, sticky=NW)
 
     def run(self):
-        videos_info = {}
+        file_paths = []
         for cnt, (video_name, video_data) in enumerate(self.videos_dict.items()):
             _ = get_video_meta_data(video_path=video_data.file_path)
-            videos_info["Video {}".format(str(cnt + 1))] = video_data.file_path
+            file_paths.append(video_data.file_path)
 
-        if (len(videos_info.keys()) < 3) & (self.join_type_var.get() == "mixed_mosaic"):
+        if (len(file_paths) < 3) & (self.join_type_var.get() == "mixed_mosaic"):
             raise MixedMosaicError(
-                msg="Ff using the mixed mosaic join type, please tick check-boxes for at least three video types.",
+                msg="If using the mixed mosaic join type, please tick check-boxes for at least three video types.",
                 source=self.__class__.__name__,
             )
-        if (len(videos_info.keys()) < 3) & (self.join_type_var.get() == "mosaic"):
+        if (len(file_paths) < 3) & (self.join_type_var.get() == "mosaic"):
             self.join_type_var.set(value="vertical")
 
-        _ = FrameMergererFFmpeg(
+        video_merger = FrameMergererFFmpeg(
             config_path=self.config_path,
-            frame_types=videos_info,
+            video_paths=file_paths,
             video_height=int(self.resolution_height.getChoices()),
             video_width=int(self.resolution_width.getChoices()),
             concat_type=self.join_type_var.get(),
             gpu=self.use_gpu_var.get(),
         )
 
+        threading.Thread(target=video_merger.run())
+
+
+# ConcatenatorPopUp(config_path='/Users/simon/Desktop/envs/simba/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini')
+
 
 class VideoRotatorPopUp(PopUpMixin):
     def __init__(self):
         super().__init__(title="ROTATE VIDEOS")
         self.save_dir_frm = CreateLabelFrameWithIcon(
             parent=self.main_frm,
             header="SAVE LOCATION",
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/validation_plot_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/validation_plot_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/clf_by_roi_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/clf_by_roi_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/make_path_plot_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/make_path_plot_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/direction_animal_to_bodypart_settings_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/direction_animal_to_bodypart_settings_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/create_user_defined_pose_configuration_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/create_user_defined_pose_configuration_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/archive_files_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/archive_files_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/pose_bp_drop_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/pose_bp_drop_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/distance_plot_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/distance_plot_pop_up.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,11 @@
 __author__ = "Simon Nilsson"
 
 import os
+import threading
 from collections import defaultdict
 from tkinter import *
 
 import numpy as np
 
 from simba.mixins.config_reader import ConfigReader
 from simba.mixins.pop_up_mixin import PopUpMixin
@@ -236,58 +237,69 @@
                 self.files_found_dict[self.single_video_dropdown.getChoices()]
             ]
 
         line_attr = defaultdict(list)
         for attr in (self.bp_1, self.bp_2, self.distance_clrs):
             for key, value in attr.items():
                 line_attr[key].append(value.getChoices())
+        line_attr = list(line_attr.values())
 
-        for cnt, (k, v) in enumerate(line_attr.items()):
+        for cnt, v in enumerate(line_attr):
             if v[0] == v[1]:
                 raise DuplicationError(
                     msg=f"DISTANCE LINE {cnt+1} ERROR: The two body-parts cannot be the same body-part.",
                     source=self.__class__.__name__,
                 )
 
         width = int(self.resolution_dropdown.getChoices().split("×")[0])
         height = int(self.resolution_dropdown.getChoices().split("×")[1])
         check_int(
             name="DISTANCE FONT SIZE", value=self.font_size_entry.entry_get, min_value=1
         )
         check_int(
             name="DISTANCE LINE WIDTH", value=self.line_width.entry_get, min_value=1
         )
+        max_y = self.max_y_dropdown.getChoices()
+        if max_y == "auto":
+            max_y = -1
+        else:
+            max_y = int(max_y)
+
         style_attr = {
             "width": width,
             "height": height,
             "line width": int(self.line_width.entry_get),
             "font size": int(self.font_size_entry.entry_get),
             "opacity": float(self.opacity_dropdown.getChoices()),
-            "y_max": self.max_y_dropdown.getChoices(),
+            "y_max": max_y,
         }
+
         if not self.multiprocess_var.get():
             distance_plotter = DistancePlotterSingleCore(
                 config_path=self.config_path,
                 frame_setting=self.distance_frames_var.get(),
                 video_setting=self.distance_videos_var.get(),
                 final_img=self.distance_final_img_var.get(),
                 style_attr=style_attr,
-                files_found=data_paths,
+                data_paths=data_paths,
                 line_attr=line_attr,
             )
         else:
             distance_plotter = DistancePlotterMultiCore(
                 config_path=self.config_path,
                 frame_setting=self.distance_frames_var.get(),
                 video_setting=self.distance_videos_var.get(),
                 final_img=self.distance_final_img_var.get(),
                 style_attr=style_attr,
-                files_found=data_paths,
+                data_paths=data_paths,
                 line_attr=line_attr,
                 core_cnt=int(self.multiprocess_dropdown.getChoices()),
             )
 
-        distance_plotter.run()
+        threading.Thread(distance_plotter.run()).start()
+
+
+# _ = DistancePlotterPopUp(config_path='/Users/simon/Desktop/envs/simba/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini')
 
 
 # _ = DistancePlotterPopUp(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini')
 # _ = DistancePlotterPopUp(config_path='/Users/simon/Desktop/envs/troubleshooting/Termites_5/project_folder/project_config.ini')
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/subset_feature_extractor_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/subset_feature_extractor_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/third_party_annotator_appender_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/third_party_annotator_appender_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/pop_ups/roi_analysis_time_bins_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/pop_ups/roi_analysis_time_bins_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/video_info_ui.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/video_info_ui.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/user_defined_pose_creator.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/user_defined_pose_creator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/create_project_ui.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/create_project_ui.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/tkinter_functions.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/tkinter_functions.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/ui/machine_model_settings_ui.py` & `Simba-UW-tf-dev-1.89.5/simba/ui/machine_model_settings_ui.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/labelling/labelling_interface.py` & `Simba-UW-tf-dev-1.89.5/simba/labelling/labelling_interface.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/labelling/targeted_annotations_clips.py` & `Simba-UW-tf-dev-1.89.5/simba/labelling/targeted_annotations_clips.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/labelling/extract_labelled_frames.py` & `Simba-UW-tf-dev-1.89.5/simba/labelling/extract_labelled_frames.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/labelling/labelling_advanced_interface.py` & `Simba-UW-tf-dev-1.89.5/simba/labelling/labelling_advanced_interface.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/labelling/play_annotation_video.py` & `Simba-UW-tf-dev-1.89.5/simba/labelling/play_annotation_video.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/dbcv_calculator.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/dbcv_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/cluster_validation_calculator.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/cluster_validation_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/enums.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/enums.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/.DS_Store` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/.DS_Store`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/cluster_video_visualizer.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/cluster_video_visualizer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/pop_ups/cluster_videos_popup.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/pop_ups/cluster_videos_popup.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/pop_ups/transform_cluster_popup.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/pop_ups/transform_cluster_popup.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/pop_ups/embedding_correlations_popup.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/pop_ups/embedding_correlations_popup.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/pop_ups/.DS_Store` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/pop_ups/.DS_Store`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/pop_ups/transform_dim_reduction_popup.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/pop_ups/transform_dim_reduction_popup.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/pop_ups/fit_dim_reduction_popup.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/pop_ups/fit_dim_reduction_popup.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/pop_ups/data_extractor_popup.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/pop_ups/data_extractor_popup.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/pop_ups/cluster_validation_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/pop_ups/cluster_validation_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/pop_ups/fit_cluster_popup.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/pop_ups/fit_cluster_popup.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/pop_ups/clusterer_comparison_popup.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/pop_ups/clusterer_comparison_popup.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/pop_ups/grid_search_visualizer_popup.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/pop_ups/grid_search_visualizer_popup.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/pop_ups/cluster_xai_popup.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/pop_ups/cluster_xai_popup.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/pop_ups/cluster_frequentist_stats_popup.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/pop_ups/cluster_frequentist_stats_popup.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/pop_ups/print_embedding_info_popup.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/pop_ups/print_embedding_info_popup.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/dataset_creator.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/dataset_creator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/unsupervised_main.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/unsupervised_main.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/grid_search_visualizers.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/grid_search_visualizers.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/data_extractor.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/data_extractor.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/outlier_detector.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/outlier_detector.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/cluster_frequentist_calculator.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/cluster_frequentist_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/embedding_correlation_calculator.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/embedding_correlation_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/cluster_xai_calculator.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/cluster_xai_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/umap_embedder.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/umap_embedder.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/clusterer_comparison_calculator.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/clusterer_comparison_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/bout_aggregator.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/bout_aggregator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/data_map.yaml` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/data_map.yaml`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/hdbscan_clusterer.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/hdbscan_clusterer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/unsupervised/tsne.py` & `Simba-UW-tf-dev-1.89.5/simba/unsupervised/tsne.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/bounding_box_tools/agg_boundary_stats.py` & `Simba-UW-tf-dev-1.89.5/simba/bounding_box_tools/agg_boundary_stats.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/bounding_box_tools/boundary_menus.py` & `Simba-UW-tf-dev-1.89.5/simba/bounding_box_tools/boundary_menus.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/bounding_box_tools/boundary_statistics.py` & `Simba-UW-tf-dev-1.89.5/simba/bounding_box_tools/boundary_statistics.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/bounding_box_tools/find_boundaries.py` & `Simba-UW-tf-dev-1.89.5/simba/bounding_box_tools/find_boundaries.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/bounding_box_tools/visualize_boundaries.py` & `Simba-UW-tf-dev-1.89.5/simba/bounding_box_tools/visualize_boundaries.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/.DS_Store` & `Simba-UW-tf-dev-1.89.5/simba/.DS_Store`

 * *Files 2% similar despite different names*

```diff
@@ -292,20 +292,20 @@
 00001230: 4c01 4d01 4f01 5001 5201 5b01 5c01 5e01  L.M.O.P.R.[.\.^.
 00001240: 5f01 6101 6a01 6b01 6c01 6e01 7701 7801  _.a.j.k.l.n.w.x.
 00001250: 7a01 7b01 7d01 8601 8701 8901 8a01 8c01  z.{.}...........
 00001260: 9501 9601 9801 9901 9b01 9c01 a501 b200  ................
 00001270: 0000 0000 0002 0100 0000 0000 0000 4900  ..............I.
 00001280: 0000 0000 0000 0000 0000 0000 0001 b300  ................
 00001290: 0000 0700 7300 6100 6e00 6400 6200 6f00  ....s.a.n.d.b.o.
-000012a0: 786d 6f44 4462 6c6f 6200 0000 08e4 7eb0  xmoDDblob.....~.
-000012b0: a3d0 dec5 4100 0000 0700 7300 6100 6e00  ....A.....s.a.n.
+000012a0: 786d 6f44 4462 6c6f 6200 0000 0854 90ea  xmoDDblob....T..
+000012b0: ad14 e3c5 4100 0000 0700 7300 6100 6e00  ....A.....s.a.n.
 000012c0: 6400 6200 6f00 786d 6f64 4462 6c6f 6200  d.b.o.xmodDblob.
-000012d0: 0000 08e4 7eb0 a3d0 dec5 4100 0000 0700  ....~.....A.....
+000012d0: 0000 0854 90ea ad14 e3c5 4100 0000 0700  ...T......A.....
 000012e0: 7300 6100 6e00 6400 6200 6f00 7870 6831  s.a.n.d.b.o.xph1
-000012f0: 5363 6f6d 7000 0000 0000 0d20 0000 0000  Scomp...... ....
+000012f0: 5363 6f6d 7000 0000 0000 0da0 0000 0000  Scomp...........
 00001300: 0700 7300 6100 6e00 6400 6200 6f00 7876  ..s.a.n.d.b.o.xv
 00001310: 5372 6e6c 6f6e 6700 0000 0100 0000 1b00  Srnlong.........
 00001320: 7400 6800 6900 7200 6400 5f00 7000 6100  t.h.i.r.d._.p.a.
 00001330: 7200 7400 7900 5f00 6c00 6100 6200 6500  r.t.y._.l.a.b.e.
 00001340: 6c00 5f00 6100 7000 7000 6500 6e00 6400  l._.a.p.p.e.n.d.
 00001350: 6500 7200 736c 6731 5363 6f6d 7000 0000  e.r.slg1Scomp...
 00001360: 0000 034f 3f00 0000 1b00 7400 6800 6900  ...O?.....t.h.i.
@@ -320,20 +320,20 @@
 000013f0: 4462 6c6f 6200 0000 088e 6402 d844 c7c5  Dblob.....d..D..
 00001400: 4100 0000 1b00 7400 6800 6900 7200 6400  A.....t.h.i.r.d.
 00001410: 5f00 7000 6100 7200 7400 7900 5f00 6c00  _.p.a.r.t.y._.l.
 00001420: 6100 6200 6500 6c00 5f00 6100 7000 7000  a.b.e.l._.a.p.p.
 00001430: 6500 6e00 6400 6500 7200 7370 6831 5363  e.n.d.e.r.sph1Sc
 00001440: 6f6d 7000 0000 0000 0440 0000 0000 0200  omp......@......
 00001450: 7500 696c 6731 5363 6f6d 7000 0000 0000  u.ilg1Scomp.....
-00001460: 0c50 8900 0000 0200 7500 696d 6f44 4462  .P......u.imoDDb
-00001470: 6c6f 6200 0000 08fb 029d 6ecb d9c5 4100  lob.......n...A.
+00001460: 0c5d 3700 0000 0200 7500 696d 6f44 4462  .]7.....u.imoDDb
+00001470: 6c6f 6200 0000 08ed 1d48 4118 e0c5 4100  lob......HA...A.
 00001480: 0000 0200 7500 696d 6f64 4462 6c6f 6200  ....u.imodDblob.
-00001490: 0000 08fb 029d 6ecb d9c5 4100 0000 0200  ......n...A.....
+00001490: 0000 08ed 1d48 4118 e0c5 4100 0000 0200  .....HA...A.....
 000014a0: 7500 6970 6831 5363 6f6d 7000 0000 0000  u.iph1Scomp.....
-000014b0: 0fd0 0000 0000 0c00 7500 6e00 7300 7500  ........u.n.s.u.
+000014b0: 0ff0 0000 0000 0c00 7500 6e00 7300 7500  ........u.n.s.u.
 000014c0: 7000 6500 7200 7600 6900 7300 6500 6462  p.e.r.v.i.s.e.db
 000014d0: 7773 7062 6c6f 6200 0000 b862 706c 6973  wspblob....bplis
 000014e0: 7430 30d6 0102 0304 0506 0708 0708 0b08  t00.............
 000014f0: 5d53 686f 7753 7461 7475 7342 6172 5b53  ]ShowStatusBar[S
 00001500: 686f 7754 6f6f 6c62 6172 5b53 686f 7754  howToolbar[ShowT
 00001510: 6162 5669 6577 5f10 1443 6f6e 7461 696e  abView_..Contain
 00001520: 6572 5368 6f77 5369 6465 6261 725c 5769  erShowSidebar\Wi
@@ -341,15 +341,15 @@
 00001540: 6964 6562 6172 0809 0809 5f10 187b 7b31  idebar...._..{{1
 00001550: 3836 2c20 3137 327d 2c20 7b39 3230 2c20  86, 172}, {920, 
 00001560: 3433 367d 7d09 0815 232f 3b52 5f6b 6c6d  436}}...#/;R_klm
 00001570: 6e6f 8a00 0000 0000 0001 0100 0000 0000  no..............
 00001580: 0000 0d00 0000 0000 0000 0000 0000 0000  ................
 00001590: 0000 8b00 0000 0c00 7500 6e00 7300 7500  ........u.n.s.u.
 000015a0: 7000 6500 7200 7600 6900 7300 6500 646c  p.e.r.v.i.s.e.dl
-000015b0: 6731 5363 6f6d 7000 0000 0000 0ac1 b200  g1Scomp.........
+000015b0: 6731 5363 6f6d 7000 0000 0000 0ac9 5700  g1Scomp.......W.
 000015c0: 0000 0c00 7500 6e00 7300 7500 7000 6500  ....u.n.s.u.p.e.
 000015d0: 7200 7600 6900 7300 6500 646c 7376 4362  r.v.i.s.e.dlsvCb
 000015e0: 6c6f 6200 0003 0a62 706c 6973 7430 30d8  lob....bplist00.
 000015f0: 0102 0304 0506 0708 090a 0b1b 5556 570a  ............UVW.
 00001600: 5f10 1276 6965 774f 7074 696f 6e73 5665  _..viewOptionsVe
 00001610: 7273 696f 6e5f 100f 7368 6f77 4963 6f6e  rsion_..showIcon
 00001620: 5072 6576 6965 7757 636f 6c75 6d6e 735f  PreviewWcolumns_
@@ -436,18 +436,18 @@
 00001b30: 0163 0164 0165 016e 016f 0170 0172 0174  .c.d.e.n.o.p.r.t
 00001b40: 017d 017e 017f 0181 018a 018b 018c 018e  .}.~............
 00001b50: 0190 0191 019a 01a7 01b0 0000 0000 0000  ................
 00001b60: 0201 0000 0000 0000 0048 0000 0000 0000  .........H......
 00001b70: 0000 0000 0000 0000 01b1 0000 000c 0075  ...............u
 00001b80: 006e 0073 0075 0070 0065 0072 0076 0069  .n.s.u.p.e.r.v.i
 00001b90: 0073 0065 0064 6d6f 4444 626c 6f62 0000  .s.e.dmoDDblob..
-00001ba0: 0008 d751 2b3c 46de c541 0000 000c 0075  ...Q+<F..A.....u
+00001ba0: 0008 5c5c 2c4a 0edf c541 0000 000c 0075  ..\\,J...A.....u
 00001bb0: 006e 0073 0075 0070 0065 0072 0076 0069  .n.s.u.p.e.r.v.i
 00001bc0: 0073 0065 0064 6d6f 6444 626c 6f62 0000  .s.e.dmodDblob..
-00001bd0: 0008 d751 2b3c 46de c541 0000 000c 0075  ...Q+<F..A.....u
+00001bd0: 0008 5c5c 2c4a 0edf c541 0000 000c 0075  ..\\,J...A.....u
 00001be0: 006e 0073 0075 0070 0065 0072 0076 0069  .n.s.u.p.e.r.v.i
 00001bf0: 0073 0065 0064 7068 3153 636f 6d70 0000  .s.e.dph1Scomp..
 00001c00: 0000 000d f000 0000 000c 0075 006e 0073  ...........u.n.s
 00001c10: 0075 0070 0065 0072 0076 0069 0073 0065  .u.p.e.r.v.i.s.e
 00001c20: 0064 7653 726e 6c6f 6e67 0000 0001 0000  .dvSrnlong......
 00001c30: 0005 0075 0074 0069 006c 0073 6277 7370  ...u.t.i.l.sbwsp
 00001c40: 626c 6f62 0000 00b8 6270 6c69 7374 3030  blob....bplist00
@@ -459,19 +459,19 @@
 00001ca0: 7742 6f75 6e64 735b 5368 6f77 5369 6465  wBounds[ShowSide
 00001cb0: 6261 7208 0908 095f 1018 7b7b 3333 392c  bar...._..{{339,
 00001cc0: 2033 3532 7d2c 207b 3932 302c 2034 3336   352}, {920, 436
 00001cd0: 7d7d 0908 1523 2f3b 525f 6b6c 6d6e 6f8a  }}...#/;R_klmno.
 00001ce0: 0000 0000 0000 0101 0000 0000 0000 000d  ................
 00001cf0: 0000 0000 0000 0000 0000 0000 0000 008b  ................
 00001d00: 0000 0005 0075 0074 0069 006c 0073 6c67  .....u.t.i.l.slg
-00001d10: 3153 636f 6d70 0000 0000 0007 d1f6 0000  1Scomp..........
+00001d10: 3153 636f 6d70 0000 0000 0007 e52f 0000  1Scomp......./..
 00001d20: 0005 0075 0074 0069 006c 0073 6d6f 4444  ...u.t.i.l.smoDD
-00001d30: 626c 6f62 0000 0008 fed7 40ea cede c541  blob......@....A
+00001d30: 626c 6f62 0000 0008 6589 25de 0fe3 c541  blob....e.%....A
 00001d40: 0000 0005 0075 0074 0069 006c 0073 6d6f  .....u.t.i.l.smo
-00001d50: 6444 626c 6f62 0000 0008 fed7 40ea cede  dDblob......@...
+00001d50: 6444 626c 6f62 0000 0008 6589 25de 0fe3  dDblob....e.%...
 00001d60: c541 0000 0005 0075 0074 0069 006c 0073  .A.....u.t.i.l.s
 00001d70: 7068 3153 636f 6d70 0000 0000 0008 f000  ph1Scomp........
 00001d80: 0000 0005 0075 0074 0069 006c 0073 7653  .....u.t.i.l.svS
 00001d90: 726e 6c6f 6e67 0000 0001 0000 0010 0076  rnlong.........v
 00001da0: 0069 0064 0065 006f 005f 0070 0072 006f  .i.d.e.o._.p.r.o
 00001db0: 0063 0065 0073 0073 006f 0072 0073 6277  .c.e.s.s.o.r.sbw
 00001dc0: 7370 626c 6f62 0000 00b8 6270 6c69 7374  spblob....bplist
@@ -485,283 +485,283 @@
 00001e40: 392c 2033 3532 7d2c 207b 3932 302c 2034  9, 352}, {920, 4
 00001e50: 3336 7d7d 0908 1523 2f3b 525f 6b6c 6d6e  36}}...#/;R_klmn
 00001e60: 6f8a 0000 0000 0000 0101 0000 0000 0000  o...............
 00001e70: 000d 0000 0000 0000 0000 0000 0000 0000  ................
 00001e80: 008b 0000 0010 0076 0069 0064 0065 006f  .......v.i.d.e.o
 00001e90: 005f 0070 0072 006f 0063 0065 0073 0073  ._.p.r.o.c.e.s.s
 00001ea0: 006f 0072 0073 6c67 3153 636f 6d70 0000  .o.r.slg1Scomp..
-00001eb0: 0000 0004 e699 0000 0010 0076 0069 0064  ...........v.i.d
+00001eb0: 0000 0005 cb2d 0000 0010 0076 0069 0064  .....-.....v.i.d
 00001ec0: 0065 006f 005f 0070 0072 006f 0063 0065  .e.o._.p.r.o.c.e
 00001ed0: 0073 0073 006f 0072 0073 6d6f 4444 626c  .s.s.o.r.smoDDbl
-00001ee0: 6f62 0000 0008 c421 dc36 e1d8 c541 0000  ob.....!.6...A..
+00001ee0: 6f62 0000 0008 08d1 aa9f 0fe3 c541 0000  ob...........A..
 00001ef0: 0010 0076 0069 0064 0065 006f 005f 0070  ...v.i.d.e.o._.p
 00001f00: 0072 006f 0063 0065 0073 0073 006f 0072  .r.o.c.e.s.s.o.r
-00001f10: 0073 6d6f 6444 626c 6f62 0000 0008 c421  .smodDblob.....!
-00001f20: dc36 e1d8 c541 0000 0010 0076 0069 0064  .6...A.....v.i.d
+00001f10: 0073 6d6f 6444 626c 6f62 0000 0008 08d1  .smodDblob......
+00001f20: aa9f 0fe3 c541 0000 0010 0076 0069 0064  .....A.....v.i.d
 00001f30: 0065 006f 005f 0070 0072 006f 0063 0065  .e.o._.p.r.o.c.e
 00001f40: 0073 0073 006f 0072 0073 7068 3153 636f  .s.s.o.r.sph1Sco
-00001f50: 6d70 0000 0000 0005 c000 0000 0010 0076  mp.............v
+00001f50: 6d70 0000 0000 0006 a000 0000 0010 0076  mp.............v
 00001f60: 0069 0064 0065 006f 005f 0070 0072 006f  .i.d.e.o._.p.r.o
 00001f70: 0063 0065 0073 0073 006f 0072 0073 7653  .c.e.s.s.o.r.svS
 00001f80: 726e 6c6f 6e67 0000 0001 0000 0000 0000  rnlong..........
 00001f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002000: 0000 0000 0000 0000 0000 002f 0000 000b  .........../....
 00002010: 005f 005f 0070 0079 0063 0061 0063 0068  ._._.p.y.c.a.c.h
 00002020: 0065 005f 005f 6c67 3153 636f 6d70 0000  .e._._lg1Scomp..
-00002030: 0000 0000 dfe7 0000 000b 005f 005f 0070  ..........._._.p
+00002030: 0000 0000 e07d 0000 000b 005f 005f 0070  .....}....._._.p
 00002040: 0079 0063 0061 0063 0068 0065 005f 005f  .y.c.a.c.h.e._._
-00002050: 6d6f 4444 626c 6f62 0000 0008 83cd d373  moDDblob.......s
-00002060: 99db c541 0000 000b 005f 005f 0070 0079  ...A....._._.p.y
+00002050: 6d6f 4444 626c 6f62 0000 0008 4db3 b752  moDDblob....M..R
+00002060: 18e0 c541 0000 000b 005f 005f 0070 0079  ...A....._._.p.y
 00002070: 0063 0061 0063 0068 0065 005f 005f 6d6f  .c.a.c.h.e._._mo
-00002080: 6444 626c 6f62 0000 0008 04fd b53a 39da  dDblob.......:9.
+00002080: 6444 626c 6f62 0000 0008 4db3 b752 18e0  dDblob....M..R..
 00002090: c541 0000 000b 005f 005f 0070 0079 0063  .A....._._.p.y.c
 000020a0: 0061 0063 0068 0065 005f 005f 7068 3153  .a.c.h.e._._ph1S
 000020b0: 636f 6d70 0000 0000 0000 f000 0000 0006  comp............
 000020c0: 0061 0073 0073 0065 0074 0073 6277 7370  .a.s.s.e.t.sbwsp
-000020d0: 626c 6f62 0000 00b8 6270 6c69 7374 3030  blob....bplist00
+000020d0: 626c 6f62 0000 00b7 6270 6c69 7374 3030  blob....bplist00
 000020e0: d601 0203 0405 0607 0807 080b 085d 5368  .............]Sh
 000020f0: 6f77 5374 6174 7573 4261 725b 5368 6f77  owStatusBar[Show
 00002100: 546f 6f6c 6261 725b 5368 6f77 5461 6256  Toolbar[ShowTabV
 00002110: 6965 775f 1014 436f 6e74 6169 6e65 7253  iew_..ContainerS
 00002120: 686f 7753 6964 6562 6172 5c57 696e 646f  howSidebar\Windo
 00002130: 7742 6f75 6e64 735b 5368 6f77 5369 6465  wBounds[ShowSide
-00002140: 6261 7208 0908 095f 1018 7b7b 3236 302c  bar...._..{{260,
-00002150: 2033 3239 7d2c 207b 3932 302c 2034 3336   329}, {920, 436
-00002160: 7d7d 0908 1523 2f3b 525f 6b6c 6d6e 6f8a  }}...#/;R_klmno.
-00002170: 0000 0000 0000 0101 0000 0000 0000 000d  ................
-00002180: 0000 0000 0000 0000 0000 0000 0000 008b  ................
-00002190: 0000 0006 0061 0073 0073 0065 0074 0073  .....a.s.s.e.t.s
-000021a0: 6c67 3153 636f 6d70 0000 0000 0089 edf0  lg1Scomp........
-000021b0: 0000 0006 0061 0073 0073 0065 0074 0073  .....a.s.s.e.t.s
-000021c0: 6d6f 4444 626c 6f62 0000 0008 ee16 90c8  moDDblob........
-000021d0: abba c541 0000 0006 0061 0073 0073 0065  ...A.....a.s.s.e
-000021e0: 0074 0073 6d6f 6444 626c 6f62 0000 0008  .t.smodDblob....
-000021f0: ee16 90c8 abba c541 0000 0006 0061 0073  .......A.....a.s
-00002200: 0073 0065 0074 0073 7068 3153 636f 6d70  .s.e.t.sph1Scomp
-00002210: 0000 0000 008d b000 0000 0006 0061 0073  .............a.s
-00002220: 0073 0065 0074 0073 7653 726e 6c6f 6e67  .s.e.t.svSrnlong
-00002230: 0000 0001 0000 0012 0062 006f 0075 006e  .........b.o.u.n
-00002240: 0064 0069 006e 0067 005f 0062 006f 0078  .d.i.n.g._.b.o.x
-00002250: 005f 0074 006f 006f 006c 0073 6c67 3153  ._.t.o.o.l.slg1S
-00002260: 636f 6d70 0000 0000 0003 222b 0000 0012  comp......"+....
-00002270: 0062 006f 0075 006e 0064 0069 006e 0067  .b.o.u.n.d.i.n.g
-00002280: 005f 0062 006f 0078 005f 0074 006f 006f  ._.b.o.x._.t.o.o
-00002290: 006c 0073 6d6f 4444 626c 6f62 0000 0008  .l.smoDDblob....
-000022a0: ac91 fad1 2eba c541 0000 0012 0062 006f  .......A.....b.o
-000022b0: 0075 006e 0064 0069 006e 0067 005f 0062  .u.n.d.i.n.g._.b
-000022c0: 006f 0078 005f 0074 006f 006f 006c 0073  .o.x._.t.o.o.l.s
-000022d0: 6d6f 6444 626c 6f62 0000 0008 ac91 fad1  modDblob........
-000022e0: 2eba c541 0000 0012 0062 006f 0075 006e  ...A.....b.o.u.n
-000022f0: 0064 0069 006e 0067 005f 0062 006f 0078  .d.i.n.g._.b.o.x
-00002300: 005f 0074 006f 006f 006c 0073 7068 3153  ._.t.o.o.l.sph1S
-00002310: 636f 6d70 0000 0000 0003 d000 0000 000f  comp............
-00002320: 0063 0075 0065 005f 006c 0069 0067 0068  .c.u.e._.l.i.g.h
-00002330: 0074 005f 0074 006f 006f 006c 0073 6c67  .t._.t.o.o.l.slg
-00002340: 3153 636f 6d70 0000 0000 0002 b27a 0000  1Scomp.......z..
-00002350: 000f 0063 0075 0065 005f 006c 0069 0067  ...c.u.e._.l.i.g
-00002360: 0068 0074 005f 0074 006f 006f 006c 0073  .h.t._.t.o.o.l.s
-00002370: 6d6f 4444 626c 6f62 0000 0008 eea3 afe9  moDDblob........
-00002380: 04ba c541 0000 000f 0063 0075 0065 005f  ...A.....c.u.e._
-00002390: 006c 0069 0067 0068 0074 005f 0074 006f  .l.i.g.h.t._.t.o
-000023a0: 006f 006c 0073 6d6f 6444 626c 6f62 0000  .o.l.smodDblob..
-000023b0: 0008 eea3 afe9 04ba c541 0000 000f 0063  .........A.....c
-000023c0: 0075 0065 005f 006c 0069 0067 0068 0074  .u.e._.l.i.g.h.t
-000023d0: 005f 0074 006f 006f 006c 0073 7068 3153  ._.t.o.o.l.sph1S
-000023e0: 636f 6d70 0000 0000 0003 8000 0000 0008  comp............
-000023f0: 0064 0061 0073 0068 005f 0061 0070 0070  .d.a.s.h._.a.p.p
-00002400: 6c67 3153 636f 6d70 0000 0000 0001 e92a  lg1Scomp.......*
-00002410: 0000 0008 0064 0061 0073 0068 005f 0061  .....d.a.s.h._.a
-00002420: 0070 0070 6d6f 4444 626c 6f62 0000 0008  .p.pmoDDblob....
-00002430: de5f c487 0aba c541 0000 0008 0064 0061  ._.....A.....d.a
-00002440: 0073 0068 005f 0061 0070 0070 6d6f 6444  .s.h._.a.p.pmodD
-00002450: 626c 6f62 0000 0008 de5f c487 0aba c541  blob....._.....A
-00002460: 0000 0008 0064 0061 0073 0068 005f 0061  .....d.a.s.h._.a
-00002470: 0070 0070 7068 3153 636f 6d70 0000 0000  .p.pph1Scomp....
-00002480: 0002 0000 0000 000f 0064 0061 0074 0061  .........d.a.t.a
-00002490: 005f 0070 0072 006f 0063 0065 0073 0073  ._.p.r.o.c.e.s.s
-000024a0: 006f 0072 0073 6c67 3153 636f 6d70 0000  .o.r.slg1Scomp..
-000024b0: 0000 0007 3c1c 0000 000f 0064 0061 0074  ....<......d.a.t
-000024c0: 0061 005f 0070 0072 006f 0063 0065 0073  .a._.p.r.o.c.e.s
-000024d0: 0073 006f 0072 0073 6d6f 4444 626c 6f62  .s.o.r.smoDDblob
-000024e0: 0000 0008 c704 c5e0 e7dc c541 0000 000f  ...........A....
-000024f0: 0064 0061 0074 0061 005f 0070 0072 006f  .d.a.t.a._.p.r.o
-00002500: 0063 0065 0073 0073 006f 0072 0073 6d6f  .c.e.s.s.o.r.smo
-00002510: 6444 626c 6f62 0000 0008 9a39 b23f e0da  dDblob.....9.?..
-00002520: c541 0000 000f 0064 0061 0074 0061 005f  .A.....d.a.t.a._
-00002530: 0070 0072 006f 0063 0065 0073 0073 006f  .p.r.o.c.e.s.s.o
-00002540: 0072 0073 7068 3153 636f 6d70 0000 0000  .r.sph1Scomp....
-00002550: 0009 0000 0000 0012 0066 0065 0061 0074  .........f.e.a.t
-00002560: 0075 0072 0065 005f 0065 0078 0074 0072  .u.r.e._.e.x.t.r
-00002570: 0061 0063 0074 006f 0072 0073 6277 7370  .a.c.t.o.r.sbwsp
-00002580: 626c 6f62 0000 00b9 6270 6c69 7374 3030  blob....bplist00
-00002590: d601 0203 0405 0607 0807 080b 085d 5368  .............]Sh
-000025a0: 6f77 5374 6174 7573 4261 725b 5368 6f77  owStatusBar[Show
-000025b0: 546f 6f6c 6261 725b 5368 6f77 5461 6256  Toolbar[ShowTabV
-000025c0: 6965 775f 1014 436f 6e74 6169 6e65 7253  iew_..ContainerS
-000025d0: 686f 7753 6964 6562 6172 5c57 696e 646f  howSidebar\Windo
-000025e0: 7742 6f75 6e64 735b 5368 6f77 5369 6465  wBounds[ShowSide
-000025f0: 6261 7208 0908 095f 1019 7b7b 3939 2c20  bar...._..{{99, 
-00002600: 2d31 3636 7d2c 207b 3132 3833 2c20 3638  -166}, {1283, 68
-00002610: 397d 7d09 0815 232f 3b52 5f6b 6c6d 6e6f  9}}...#/;R_klmno
-00002620: 8b00 0000 0000 0001 0100 0000 0000 0000  ................
-00002630: 0d00 0000 0000 0000 0000 0000 0000 0000  ................
-00002640: 8c00 0000 1200 6600 6500 6100 7400 7500  ......f.e.a.t.u.
-00002650: 7200 6500 5f00 6500 7800 7400 7200 6100  r.e._.e.x.t.r.a.
-00002660: 6300 7400 6f00 7200 736c 6731 5363 6f6d  c.t.o.r.slg1Scom
-00002670: 7000 0000 0000 0c96 c500 0000 1200 6600  p.............f.
-00002680: 6500 6100 7400 7500 7200 6500 5f00 6500  e.a.t.u.r.e._.e.
-00002690: 7800 7400 7200 6100 6300 7400 6f00 7200  x.t.r.a.c.t.o.r.
-000026a0: 736d 6f44 4462 6c6f 6200 0000 08c5 75b6  smoDDblob.....u.
-000026b0: 0b20 c9c5 4100 0000 1200 6600 6500 6100  . ..A.....f.e.a.
-000026c0: 7400 7500 7200 6500 5f00 6500 7800 7400  t.u.r.e._.e.x.t.
-000026d0: 7200 6100 6300 7400 6f00 7200 736d 6f64  r.a.c.t.o.r.smod
-000026e0: 4462 6c6f 6200 0000 08c5 75b6 0b20 c9c5  Dblob.....u.. ..
-000026f0: 4100 0000 1200 6600 6500 6100 7400 7500  A.....f.e.a.t.u.
-00002700: 7200 6500 5f00 6500 7800 7400 7200 6100  r.e._.e.x.t.r.a.
-00002710: 6300 7400 6f00 7200 7370 6831 5363 6f6d  c.t.o.r.sph1Scom
-00002720: 7000 0000 0000 0e60 0000 0000 1200 6600  p......`......f.
-00002730: 6500 6100 7400 7500 7200 6500 5f00 6500  e.a.t.u.r.e._.e.
-00002740: 7800 7400 7200 6100 6300 7400 6f00 7200  x.t.r.a.c.t.o.r.
-00002750: 7376 5372 6e6c 6f6e 6700 0000 0100 0000  svSrnlong.......
-00002760: 0900 6c00 6100 6200 6500 6c00 6c00 6900  ..l.a.b.e.l.l.i.
-00002770: 6e00 676c 6731 5363 6f6d 7000 0000 0000  n.glg1Scomp.....
-00002780: 0272 f000 0000 0900 6c00 6100 6200 6500  .r......l.a.b.e.
-00002790: 6c00 6c00 6900 6e00 676d 6f44 4462 6c6f  l.l.i.n.gmoDDblo
-000027a0: 6200 0000 0822 8d49 30cc c2c5 4100 0000  b....".I0...A...
-000027b0: 0900 6c00 6100 6200 6500 6c00 6c00 6900  ..l.a.b.e.l.l.i.
-000027c0: 6e00 676d 6f64 4462 6c6f 6200 0000 0822  n.gmodDblob...."
-000027d0: 8d49 30cc c2c5 4100 0000 0900 6c00 6100  .I0...A.....l.a.
-000027e0: 6200 6500 6c00 6c00 6900 6e00 6770 6831  b.e.l.l.i.n.gph1
-000027f0: 5363 6f6d 7000 0000 0000 02d0 0000 0000  Scomp...........
-00002800: 0600 6d00 6900 7800 6900 6e00 7362 7773  ..m.i.x.i.n.sbws
-00002810: 7062 6c6f 6200 0000 b862 706c 6973 7430  pblob....bplist0
-00002820: 30d6 0102 0304 0506 0708 0708 0b08 5d53  0.............]S
-00002830: 686f 7753 7461 7475 7342 6172 5b53 686f  howStatusBar[Sho
-00002840: 7754 6f6f 6c62 6172 5b53 686f 7754 6162  wToolbar[ShowTab
-00002850: 5669 6577 5f10 1443 6f6e 7461 696e 6572  View_..Container
-00002860: 5368 6f77 5369 6465 6261 725c 5769 6e64  ShowSidebar\Wind
-00002870: 6f77 426f 756e 6473 5b53 686f 7753 6964  owBounds[ShowSid
-00002880: 6562 6172 0809 0809 5f10 187b 7b32 3839  ebar...._..{{289
-00002890: 2c20 3330 307d 2c20 7b39 3230 2c20 3433  , 300}, {920, 43
-000028a0: 367d 7d09 0815 232f 3b52 5f6b 6c6d 6e6f  6}}...#/;R_klmno
-000028b0: 8a00 0000 0000 0001 0100 0000 0000 0000  ................
-000028c0: 0d00 0000 0000 0000 0000 0000 0000 0000  ................
-000028d0: 8b00 0000 0600 6d00 6900 7800 6900 6e00  ......m.i.x.i.n.
-000028e0: 736c 6731 5363 6f6d 7000 0000 0001 5691  slg1Scomp.....V.
-000028f0: 0a00 0000 0600 6d00 6900 7800 6900 6e00  ......m.i.x.i.n.
-00002900: 736c 7376 4362 6c6f 6200 0003 0a62 706c  slsvCblob....bpl
-00002910: 6973 7430 30d8 0102 0304 0506 0708 090a  ist00...........
-00002920: 0b1b 5556 0a58 5869 636f 6e53 697a 655f  ..UV.XXiconSize_
-00002930: 100f 7368 6f77 4963 6f6e 5072 6576 6965  ..showIconPrevie
-00002940: 7757 636f 6c75 6d6e 735f 1011 6361 6c63  wWcolumns_..calc
-00002950: 756c 6174 6541 6c6c 5369 7a65 7358 7465  ulateAllSizesXte
-00002960: 7874 5369 7a65 5a73 6f72 7443 6f6c 756d  xtSizeZsortColum
-00002970: 6e5f 1010 7573 6552 656c 6174 6976 6544  n_..useRelativeD
-00002980: 6174 6573 5f10 1276 6965 774f 7074 696f  ates_..viewOptio
-00002990: 6e73 5665 7273 696f 6e23 4030 0000 0000  nsVersion#@0....
-000029a0: 0000 09ae 0c15 1d22 262b 3035 3a3e 4347  ......."&+05:>CG
-000029b0: 4c50 d40d 0e0f 100a 120a 1457 7669 7369  LP.........Wvisi
-000029c0: 626c 6555 7769 6474 6859 6173 6365 6e64  bleUwidthYascend
-000029d0: 696e 675a 6964 656e 7469 6669 6572 0911  ingZidentifier..
-000029e0: 012c 0954 6e61 6d65 d410 1617 1819 1a1b  .,.Tname........
-000029f0: 1b55 7769 6474 6859 6173 6365 6e64 696e  .UwidthYascendin
-00002a00: 6757 7669 7369 626c 6558 7562 6971 7569  gWvisibleXubiqui
-00002a10: 7479 1023 0808 d40d 0e0f 100a 1f1b 2109  ty.#..........!.
-00002a20: 10b5 085c 6461 7465 4d6f 6469 6669 6564  ...\dateModified
-00002a30: d40d 0e0f 101b 1f1b 2508 085b 6461 7465  ........%..[date
-00002a40: 4372 6561 7465 64d4 0d0e 0f10 0a28 1b2a  Created......(.*
-00002a50: 0910 6108 5473 697a 65d4 0d0e 0f10 0a2d  ..a.Tsize......-
-00002a60: 0a2f 0910 7309 546b 696e 64d4 0d0e 0f10  ./..s.Tkind.....
-00002a70: 1b32 0a34 0810 6409 556c 6162 656c d40d  .2.4..d.Ulabel..
-00002a80: 0e0f 101b 370a 3908 104b 0957 7665 7273  ....7.9..K.Wvers
-00002a90: 696f 6ed4 0d0e 0f10 1b12 0a3d 0809 5863  ion........=..Xc
-00002aa0: 6f6d 6d65 6e74 73d4 0d0e 0f10 1b40 1b42  omments......@.B
-00002ab0: 0810 c808 5e64 6174 654c 6173 744f 7065  ....^dateLastOpe
-00002ac0: 6e65 64d4 1016 1718 441f 1b1b 5964 6174  ned.....D...Ydat
-00002ad0: 6541 6464 6564 0808 d418 1617 101b 491b  eAdded........I.
-00002ae0: 4b08 10d2 085a 7368 6172 654f 776e 6572  K....ZshareOwner
-00002af0: d418 1617 101b 491b 4f08 085f 100f 7368  ......I.O.._..sh
-00002b00: 6172 654c 6173 7445 6469 746f 72d4 1816  areLastEditor...
-00002b10: 1710 1b49 1b53 0808 5f10 1069 6e76 6974  ...I.S.._..invit
-00002b20: 6174 696f 6e53 7461 7475 7308 2340 2800  ationStatus.#@(.
-00002b30: 0000 0000 005c 6461 7465 4d6f 6469 6669  .....\dateModifi
-00002b40: 6564 0910 0100 0800 1900 2200 3400 3c00  ed........".4.<.
-00002b50: 5000 5900 6400 7700 8c00 9500 9600 a500  P.Y.d.w.........
-00002b60: ae00 b600 bc00 c600 d100 d200 d500 d600  ................
-00002b70: db00 e400 ea00 f400 fc01 0501 0701 0801  ................
-00002b80: 0901 1201 1301 1501 1601 2301 2c01 2d01  ..........#.,.-.
-00002b90: 2e01 3a01 4301 4401 4601 4701 4c01 5501  ..:.C.D.F.G.L.U.
-00002ba0: 5601 5801 5901 5e01 6701 6801 6a01 6b01  V.X.Y.^.g.h.j.k.
-00002bb0: 7101 7a01 7b01 7d01 7e01 8601 8f01 9001  q.z.{.}.~.......
-00002bc0: 9101 9a01 a301 a401 a601 a701 b601 bf01  ................
-00002bd0: c901 ca01 cb01 d401 d501 d701 d801 e301  ................
-00002be0: ec01 ed01 ee02 0002 0902 0a02 0b02 1e02  ................
-00002bf0: 1f02 2802 3502 3600 0000 0000 0002 0100  ..(.5.6.........
-00002c00: 0000 0000 0000 5900 0000 0000 0000 0000  ......Y.........
-00002c10: 0000 0000 0002 3800 0000 0600 6d00 6900  ......8.....m.i.
-00002c20: 7800 6900 6e00 736c 7376 7062 6c6f 6200  x.i.n.slsvpblob.
-00002c30: 0002 6162 706c 6973 7430 30d8 0102 0304  ..abplist00.....
-00002c40: 0506 0708 090a 0b1d 4546 0a33 5869 636f  ........EF.3Xico
-00002c50: 6e53 697a 655f 100f 7368 6f77 4963 6f6e  nSize_..showIcon
-00002c60: 5072 6576 6965 7757 636f 6c75 6d6e 735f  PreviewWcolumns_
-00002c70: 1011 6361 6c63 756c 6174 6541 6c6c 5369  ..calculateAllSi
-00002c80: 7a65 7358 7465 7874 5369 7a65 5a73 6f72  zesXtextSizeZsor
-00002c90: 7443 6f6c 756d 6e5f 1010 7573 6552 656c  tColumn_..useRel
-00002ca0: 6174 6976 6544 6174 6573 5f10 1276 6965  ativeDates_..vie
-00002cb0: 774f 7074 696f 6e73 5665 7273 696f 6e23  wOptionsVersion#
-00002cc0: 4030 0000 0000 0000 09d9 0c0d 0e0f 1011  @0..............
-00002cd0: 1213 1415 1e23 282d 3236 3b3f 5863 6f6d  .....#(-26;?Xcom
-00002ce0: 6d65 6e74 7355 6c61 6265 6c57 7665 7273  mentsUlabelWvers
-00002cf0: 696f 6e5b 6461 7465 4372 6561 7465 6454  ion[dateCreatedT
-00002d00: 7369 7a65 5c64 6174 654d 6f64 6966 6965  size\dateModifie
-00002d10: 6454 6b69 6e64 546e 616d 655e 6461 7465  dTkindTname^date
-00002d20: 4c61 7374 4f70 656e 6564 d416 1718 191a  LastOpened......
-00002d30: 1b0a 1d55 696e 6465 7855 7769 6474 6859  ...UindexUwidthY
-00002d40: 6173 6365 6e64 696e 6757 7669 7369 626c  ascendingWvisibl
-00002d50: 6510 0711 012c 0908 d416 1718 191f 200a  e....,........ .
-00002d60: 1d10 0510 6409 08d4 1617 1819 2425 0a1d  ....d.......$%..
-00002d70: 1006 104b 0908 d416 1718 1929 2a1d 1d10  ...K.......)*...
-00002d80: 0210 b508 08d4 1617 1819 2e2f 1d0a 1003  .........../....
-00002d90: 1061 0809 d416 1718 1933 2a1d 0a10 0108  .a.......3*.....
-00002da0: 09d4 1617 1819 3738 0a0a 1004 1073 0909  ......78.....s..
-00002db0: d416 1718 193c 1b0a 0a10 0009 09d4 1617  .....<..........
-00002dc0: 1819 4041 1d1d 1008 10c8 0808 0823 4028  ..@A.........#@(
-00002dd0: 0000 0000 0000 5c64 6174 654d 6f64 6966  ......\dateModif
-00002de0: 6965 6409 0008 0019 0022 0034 003c 0050  ied......".4.<.P
-00002df0: 0059 0064 0077 008c 0095 0096 00a9 00b2  .Y.d.w..........
-00002e00: 00b8 00c0 00cc 00d1 00de 00e3 00e8 00f7  ................
-00002e10: 0100 0106 010c 0116 011e 0120 0123 0124  ........... .#.$
-00002e20: 0125 012e 0130 0132 0133 0134 013d 013f  .%...0.2.3.4.=.?
-00002e30: 0141 0142 0143 014c 014e 0150 0151 0152  .A.B.C.L.N.P.Q.R
-00002e40: 015b 015d 015f 0160 0161 016a 016c 016d  .[.]._.`.a.j.l.m
-00002e50: 016e 0177 0179 017b 017c 017d 0186 0188  .n.w.y.{.|.}....
-00002e60: 0189 018a 0193 0195 0197 0198 0199 019a  ................
-00002e70: 01a3 01b0 0000 0000 0000 0201 0000 0000  ................
-00002e80: 0000 0048 0000 0000 0000 0000 0000 0000  ...H............
-00002e90: 0000 01b1 0000 0006 006d 0069 0078 0069  .........m.i.x.i
-00002ea0: 006e 0073 6d6f 4444 626c 6f62 0000 0008  .n.smoDDblob....
-00002eb0: de7a 031c 2fde c541 0000 0006 006d 0069  .z../..A.....m.i
-00002ec0: 0078 0069 006e 0073 6d6f 6444 626c 6f62  .x.i.n.smodDblob
-00002ed0: 0000 0008 de7a 031c 2fde c541 0000 0006  .....z../..A....
-00002ee0: 006d 0069 0078 0069 006e 0073 7068 3153  .m.i.x.i.n.sph1S
-00002ef0: 636f 6d70 0000 0000 0165 1000 0000 0006  comp.....e......
-00002f00: 006d 0069 0078 0069 006e 0073 7653 726e  .m.i.x.i.n.svSrn
-00002f10: 6c6f 6e67 0000 0001 0000 0005 006d 006f  long.........m.o
-00002f20: 0064 0065 006c 6c67 3153 636f 6d70 0000  .d.e.llg1Scomp..
-00002f30: 0000 0002 297f 0000 0005 006d 006f 0064  ....)......m.o.d
-00002f40: 0065 006c 6d6f 4444 626c 6f62 0000 0008  .e.lmoDDblob....
-00002f50: 75d5 ea28 b7c3 c541 0000 0005 006d 006f  u..(...A.....m.o
-00002f60: 0064 0065 006c 6d6f 6444 626c 6f62 0000  .d.e.lmodDblob..
-00002f70: 0008 75d5 ea28 b7c3 c541 0072 0073 7653  ..u..(...A.r.svS
+00002140: 6261 7208 0908 095f 1017 7b7b 3433 2c20  bar...._..{{43, 
+00002150: 3834 7d2c 207b 3131 3830 2c20 3536 387d  84}, {1180, 568}
+00002160: 7d09 0815 232f 3b52 5f6b 6c6d 6e6f 8900  }...#/;R_klmno..
+00002170: 0000 0000 0001 0100 0000 0000 0000 0d00  ................
+00002180: 0000 0000 0000 0000 0000 0000 0000 8a00  ................
+00002190: 0000 0600 6100 7300 7300 6500 7400 736c  ....a.s.s.e.t.sl
+000021a0: 6731 5363 6f6d 7000 0000 0000 8a05 f400  g1Scomp.........
+000021b0: 0000 0600 6100 7300 7300 6500 7400 736d  ....a.s.s.e.t.sm
+000021c0: 6f44 4462 6c6f 6200 0000 08ee 1690 c8ab  oDDblob.........
+000021d0: bac5 4100 0000 0600 6100 7300 7300 6500  ..A.....a.s.s.e.
+000021e0: 7400 736d 6f64 4462 6c6f 6200 0000 08ee  t.smodDblob.....
+000021f0: 1690 c8ab bac5 4100 0000 0600 6100 7300  ......A.....a.s.
+00002200: 7300 6500 7400 7370 6831 5363 6f6d 7000  s.e.t.sph1Scomp.
+00002210: 0000 0000 8dd0 0000 0000 0600 6100 7300  ............a.s.
+00002220: 7300 6500 7400 7376 5372 6e6c 6f6e 6700  s.e.t.svSrnlong.
+00002230: 0000 0100 0000 1200 6200 6f00 7500 6e00  ........b.o.u.n.
+00002240: 6400 6900 6e00 6700 5f00 6200 6f00 7800  d.i.n.g._.b.o.x.
+00002250: 5f00 7400 6f00 6f00 6c00 736c 6731 5363  _.t.o.o.l.slg1Sc
+00002260: 6f6d 7000 0000 0000 0322 2b00 0000 1200  omp......"+.....
+00002270: 6200 6f00 7500 6e00 6400 6900 6e00 6700  b.o.u.n.d.i.n.g.
+00002280: 5f00 6200 6f00 7800 5f00 7400 6f00 6f00  _.b.o.x._.t.o.o.
+00002290: 6c00 736d 6f44 4462 6c6f 6200 0000 08ac  l.smoDDblob.....
+000022a0: 91fa d12e bac5 4100 0000 1200 6200 6f00  ......A.....b.o.
+000022b0: 7500 6e00 6400 6900 6e00 6700 5f00 6200  u.n.d.i.n.g._.b.
+000022c0: 6f00 7800 5f00 7400 6f00 6f00 6c00 736d  o.x._.t.o.o.l.sm
+000022d0: 6f64 4462 6c6f 6200 0000 08ac 91fa d12e  odDblob.........
+000022e0: bac5 4100 0000 1200 6200 6f00 7500 6e00  ..A.....b.o.u.n.
+000022f0: 6400 6900 6e00 6700 5f00 6200 6f00 7800  d.i.n.g._.b.o.x.
+00002300: 5f00 7400 6f00 6f00 6c00 7370 6831 5363  _.t.o.o.l.sph1Sc
+00002310: 6f6d 7000 0000 0000 03d0 0000 0000 0f00  omp.............
+00002320: 6300 7500 6500 5f00 6c00 6900 6700 6800  c.u.e._.l.i.g.h.
+00002330: 7400 5f00 7400 6f00 6f00 6c00 736c 6731  t._.t.o.o.l.slg1
+00002340: 5363 6f6d 7000 0000 0000 02b2 7a00 0000  Scomp.......z...
+00002350: 0f00 6300 7500 6500 5f00 6c00 6900 6700  ..c.u.e._.l.i.g.
+00002360: 6800 7400 5f00 7400 6f00 6f00 6c00 736d  h.t._.t.o.o.l.sm
+00002370: 6f44 4462 6c6f 6200 0000 08ee a3af e904  oDDblob.........
+00002380: bac5 4100 0000 0f00 6300 7500 6500 5f00  ..A.....c.u.e._.
+00002390: 6c00 6900 6700 6800 7400 5f00 7400 6f00  l.i.g.h.t._.t.o.
+000023a0: 6f00 6c00 736d 6f64 4462 6c6f 6200 0000  o.l.smodDblob...
+000023b0: 08ee a3af e904 bac5 4100 0000 0f00 6300  ........A.....c.
+000023c0: 7500 6500 5f00 6c00 6900 6700 6800 7400  u.e._.l.i.g.h.t.
+000023d0: 5f00 7400 6f00 6f00 6c00 7370 6831 5363  _.t.o.o.l.sph1Sc
+000023e0: 6f6d 7000 0000 0000 0380 0000 0000 0800  omp.............
+000023f0: 6400 6100 7300 6800 5f00 6100 7000 706c  d.a.s.h._.a.p.pl
+00002400: 6731 5363 6f6d 7000 0000 0000 01e9 2a00  g1Scomp.......*.
+00002410: 0000 0800 6400 6100 7300 6800 5f00 6100  ....d.a.s.h._.a.
+00002420: 7000 706d 6f44 4462 6c6f 6200 0000 08de  p.pmoDDblob.....
+00002430: 5fc4 870a bac5 4100 0000 0800 6400 6100  _.....A.....d.a.
+00002440: 7300 6800 5f00 6100 7000 706d 6f64 4462  s.h._.a.p.pmodDb
+00002450: 6c6f 6200 0000 08de 5fc4 870a bac5 4100  lob....._.....A.
+00002460: 0000 0800 6400 6100 7300 6800 5f00 6100  ....d.a.s.h._.a.
+00002470: 7000 7070 6831 5363 6f6d 7000 0000 0000  p.pph1Scomp.....
+00002480: 0200 0000 0000 0f00 6400 6100 7400 6100  ........d.a.t.a.
+00002490: 5f00 7000 7200 6f00 6300 6500 7300 7300  _.p.r.o.c.e.s.s.
+000024a0: 6f00 7200 736c 6731 5363 6f6d 7000 0000  o.r.slg1Scomp...
+000024b0: 0000 073c 1400 0000 0f00 6400 6100 7400  ...<......d.a.t.
+000024c0: 6100 5f00 7000 7200 6f00 6300 6500 7300  a._.p.r.o.c.e.s.
+000024d0: 7300 6f00 7200 736d 6f44 4462 6c6f 6200  s.o.r.smoDDblob.
+000024e0: 0000 0893 9d02 bd85 dfc5 4100 0000 0f00  ..........A.....
+000024f0: 6400 6100 7400 6100 5f00 7000 7200 6f00  d.a.t.a._.p.r.o.
+00002500: 6300 6500 7300 7300 6f00 7200 736d 6f64  c.e.s.s.o.r.smod
+00002510: 4462 6c6f 6200 0000 0893 9d02 bd85 dfc5  Dblob...........
+00002520: 4100 0000 0f00 6400 6100 7400 6100 5f00  A.....d.a.t.a._.
+00002530: 7000 7200 6f00 6300 6500 7300 7300 6f00  p.r.o.c.e.s.s.o.
+00002540: 7200 7370 6831 5363 6f6d 7000 0000 0000  r.sph1Scomp.....
+00002550: 0900 0000 0000 1200 6600 6500 6100 7400  ........f.e.a.t.
+00002560: 7500 7200 6500 5f00 6500 7800 7400 7200  u.r.e._.e.x.t.r.
+00002570: 6100 6300 7400 6f00 7200 7362 7773 7062  a.c.t.o.r.sbwspb
+00002580: 6c6f 6200 0000 b962 706c 6973 7430 30d6  lob....bplist00.
+00002590: 0102 0304 0506 0708 0708 0b08 5d53 686f  ............]Sho
+000025a0: 7753 7461 7475 7342 6172 5b53 686f 7754  wStatusBar[ShowT
+000025b0: 6f6f 6c62 6172 5b53 686f 7754 6162 5669  oolbar[ShowTabVi
+000025c0: 6577 5f10 1443 6f6e 7461 696e 6572 5368  ew_..ContainerSh
+000025d0: 6f77 5369 6465 6261 725c 5769 6e64 6f77  owSidebar\Window
+000025e0: 426f 756e 6473 5b53 686f 7753 6964 6562  Bounds[ShowSideb
+000025f0: 6172 0809 0809 5f10 197b 7b39 392c 202d  ar...._..{{99, -
+00002600: 3136 367d 2c20 7b31 3238 332c 2036 3839  166}, {1283, 689
+00002610: 7d7d 0908 1523 2f3b 525f 6b6c 6d6e 6f8b  }}...#/;R_klmno.
+00002620: 0000 0000 0000 0101 0000 0000 0000 000d  ................
+00002630: 0000 0000 0000 0000 0000 0000 0000 008c  ................
+00002640: 0000 0012 0066 0065 0061 0074 0075 0072  .....f.e.a.t.u.r
+00002650: 0065 005f 0065 0078 0074 0072 0061 0063  .e._.e.x.t.r.a.c
+00002660: 0074 006f 0072 0073 6c67 3153 636f 6d70  .t.o.r.slg1Scomp
+00002670: 0000 0000 000c 9d20 0000 0012 0066 0065  ....... .....f.e
+00002680: 0061 0074 0075 0072 0065 005f 0065 0078  .a.t.u.r.e._.e.x
+00002690: 0074 0072 0061 0063 0074 006f 0072 0073  .t.r.a.c.t.o.r.s
+000026a0: 6d6f 4444 626c 6f62 0000 0008 c575 b60b  moDDblob.....u..
+000026b0: 20c9 c541 0000 0012 0066 0065 0061 0074   ..A.....f.e.a.t
+000026c0: 0075 0072 0065 005f 0065 0078 0074 0072  .u.r.e._.e.x.t.r
+000026d0: 0061 0063 0074 006f 0072 0073 6d6f 6444  .a.c.t.o.r.smodD
+000026e0: 626c 6f62 0000 0008 c575 b60b 20c9 c541  blob.....u.. ..A
+000026f0: 0000 0012 0066 0065 0061 0074 0075 0072  .....f.e.a.t.u.r
+00002700: 0065 005f 0065 0078 0074 0072 0061 0063  .e._.e.x.t.r.a.c
+00002710: 0074 006f 0072 0073 7068 3153 636f 6d70  .t.o.r.sph1Scomp
+00002720: 0000 0000 000e 7000 0000 0012 0066 0065  ......p......f.e
+00002730: 0061 0074 0075 0072 0065 005f 0065 0078  .a.t.u.r.e._.e.x
+00002740: 0074 0072 0061 0063 0074 006f 0072 0073  .t.r.a.c.t.o.r.s
+00002750: 7653 726e 6c6f 6e67 0000 0001 0000 0009  vSrnlong........
+00002760: 006c 0061 0062 0065 006c 006c 0069 006e  .l.a.b.e.l.l.i.n
+00002770: 0067 6c67 3153 636f 6d70 0000 0000 0002  .glg1Scomp......
+00002780: 72f0 0000 0009 006c 0061 0062 0065 006c  r......l.a.b.e.l
+00002790: 006c 0069 006e 0067 6d6f 4444 626c 6f62  .l.i.n.gmoDDblob
+000027a0: 0000 0008 228d 4930 ccc2 c541 0000 0009  ....".I0...A....
+000027b0: 006c 0061 0062 0065 006c 006c 0069 006e  .l.a.b.e.l.l.i.n
+000027c0: 0067 6d6f 6444 626c 6f62 0000 0008 228d  .gmodDblob....".
+000027d0: 4930 ccc2 c541 0000 0009 006c 0061 0062  I0...A.....l.a.b
+000027e0: 0065 006c 006c 0069 006e 0067 7068 3153  .e.l.l.i.n.gph1S
+000027f0: 636f 6d70 0000 0000 0002 d000 0000 0006  comp............
+00002800: 006d 0069 0078 0069 006e 0073 6277 7370  .m.i.x.i.n.sbwsp
+00002810: 626c 6f62 0000 00b8 6270 6c69 7374 3030  blob....bplist00
+00002820: d601 0203 0405 0607 0807 080b 085d 5368  .............]Sh
+00002830: 6f77 5374 6174 7573 4261 725b 5368 6f77  owStatusBar[Show
+00002840: 546f 6f6c 6261 725b 5368 6f77 5461 6256  Toolbar[ShowTabV
+00002850: 6965 775f 1014 436f 6e74 6169 6e65 7253  iew_..ContainerS
+00002860: 686f 7753 6964 6562 6172 5c57 696e 646f  howSidebar\Windo
+00002870: 7742 6f75 6e64 735b 5368 6f77 5369 6465  wBounds[ShowSide
+00002880: 6261 7208 0908 095f 1018 7b7b 3238 392c  bar...._..{{289,
+00002890: 2033 3030 7d2c 207b 3932 302c 2034 3336   300}, {920, 436
+000028a0: 7d7d 0908 1523 2f3b 525f 6b6c 6d6e 6f8a  }}...#/;R_klmno.
+000028b0: 0000 0000 0000 0101 0000 0000 0000 000d  ................
+000028c0: 0000 0000 0000 0000 0000 0000 0000 008b  ................
+000028d0: 0000 0006 006d 0069 0078 0069 006e 0073  .....m.i.x.i.n.s
+000028e0: 6c67 3153 636f 6d70 0000 0000 0191 a7a5  lg1Scomp........
+000028f0: 0000 0006 006d 0069 0078 0069 006e 0073  .....m.i.x.i.n.s
+00002900: 6c73 7643 626c 6f62 0000 030a 6270 6c69  lsvCblob....bpli
+00002910: 7374 3030 d801 0203 0405 0607 0809 0a0b  st00............
+00002920: 1b55 560a 5858 6963 6f6e 5369 7a65 5f10  .UV.XXiconSize_.
+00002930: 0f73 686f 7749 636f 6e50 7265 7669 6577  .showIconPreview
+00002940: 5763 6f6c 756d 6e73 5f10 1163 616c 6375  Wcolumns_..calcu
+00002950: 6c61 7465 416c 6c53 697a 6573 5874 6578  lateAllSizesXtex
+00002960: 7453 697a 655a 736f 7274 436f 6c75 6d6e  tSizeZsortColumn
+00002970: 5f10 1075 7365 5265 6c61 7469 7665 4461  _..useRelativeDa
+00002980: 7465 735f 1012 7669 6577 4f70 7469 6f6e  tes_..viewOption
+00002990: 7356 6572 7369 6f6e 2340 3000 0000 0000  sVersion#@0.....
+000029a0: 0009 ae0c 151d 2226 2b30 353a 3e43 474c  ......"&+05:>CGL
+000029b0: 50d4 0d0e 0f10 0a12 0a14 5776 6973 6962  P.........Wvisib
+000029c0: 6c65 5577 6964 7468 5961 7363 656e 6469  leUwidthYascendi
+000029d0: 6e67 5a69 6465 6e74 6966 6965 7209 1101  ngZidentifier...
+000029e0: 2c09 546e 616d 65d4 1016 1718 191a 1b1b  ,.Tname.........
+000029f0: 5577 6964 7468 5961 7363 656e 6469 6e67  UwidthYascending
+00002a00: 5776 6973 6962 6c65 5875 6269 7175 6974  WvisibleXubiquit
+00002a10: 7910 2308 08d4 0d0e 0f10 0a1f 1b21 0910  y.#..........!..
+00002a20: b508 5c64 6174 654d 6f64 6966 6965 64d4  ..\dateModified.
+00002a30: 0d0e 0f10 1b1f 1b25 0808 5b64 6174 6543  .......%..[dateC
+00002a40: 7265 6174 6564 d40d 0e0f 100a 281b 2a09  reated......(.*.
+00002a50: 1061 0854 7369 7a65 d40d 0e0f 100a 2d0a  .a.Tsize......-.
+00002a60: 2f09 1073 0954 6b69 6e64 d40d 0e0f 101b  /..s.Tkind......
+00002a70: 320a 3408 1064 0955 6c61 6265 6cd4 0d0e  2.4..d.Ulabel...
+00002a80: 0f10 1b37 0a39 0810 4b09 5776 6572 7369  ...7.9..K.Wversi
+00002a90: 6f6e d40d 0e0f 101b 120a 3d08 0958 636f  on........=..Xco
+00002aa0: 6d6d 656e 7473 d40d 0e0f 101b 401b 4208  mments......@.B.
+00002ab0: 10c8 085e 6461 7465 4c61 7374 4f70 656e  ...^dateLastOpen
+00002ac0: 6564 d410 1617 1844 1f1b 1b59 6461 7465  ed.....D...Ydate
+00002ad0: 4164 6465 6408 08d4 1816 1710 1b49 1b4b  Added........I.K
+00002ae0: 0810 d208 5a73 6861 7265 4f77 6e65 72d4  ....ZshareOwner.
+00002af0: 1816 1710 1b49 1b4f 0808 5f10 0f73 6861  .....I.O.._..sha
+00002b00: 7265 4c61 7374 4564 6974 6f72 d418 1617  reLastEditor....
+00002b10: 101b 491b 5308 085f 1010 696e 7669 7461  ..I.S.._..invita
+00002b20: 7469 6f6e 5374 6174 7573 0823 4028 0000  tionStatus.#@(..
+00002b30: 0000 0000 5c64 6174 654d 6f64 6966 6965  ....\dateModifie
+00002b40: 6409 1001 0008 0019 0022 0034 003c 0050  d........".4.<.P
+00002b50: 0059 0064 0077 008c 0095 0096 00a5 00ae  .Y.d.w..........
+00002b60: 00b6 00bc 00c6 00d1 00d2 00d5 00d6 00db  ................
+00002b70: 00e4 00ea 00f4 00fc 0105 0107 0108 0109  ................
+00002b80: 0112 0113 0115 0116 0123 012c 012d 012e  .........#.,.-..
+00002b90: 013a 0143 0144 0146 0147 014c 0155 0156  .:.C.D.F.G.L.U.V
+00002ba0: 0158 0159 015e 0167 0168 016a 016b 0171  .X.Y.^.g.h.j.k.q
+00002bb0: 017a 017b 017d 017e 0186 018f 0190 0191  .z.{.}.~........
+00002bc0: 019a 01a3 01a4 01a6 01a7 01b6 01bf 01c9  ................
+00002bd0: 01ca 01cb 01d4 01d5 01d7 01d8 01e3 01ec  ................
+00002be0: 01ed 01ee 0200 0209 020a 020b 021e 021f  ................
+00002bf0: 0228 0235 0236 0000 0000 0000 0201 0000  .(.5.6..........
+00002c00: 0000 0000 0059 0000 0000 0000 0000 0000  .....Y..........
+00002c10: 0000 0000 0238 0000 0006 006d 0069 0078  .....8.....m.i.x
+00002c20: 0069 006e 0073 6c73 7670 626c 6f62 0000  .i.n.slsvpblob..
+00002c30: 0261 6270 6c69 7374 3030 d801 0203 0405  .abplist00......
+00002c40: 0607 0809 0a0b 1d45 460a 3358 6963 6f6e  .......EF.3Xicon
+00002c50: 5369 7a65 5f10 0f73 686f 7749 636f 6e50  Size_..showIconP
+00002c60: 7265 7669 6577 5763 6f6c 756d 6e73 5f10  reviewWcolumns_.
+00002c70: 1163 616c 6375 6c61 7465 416c 6c53 697a  .calculateAllSiz
+00002c80: 6573 5874 6578 7453 697a 655a 736f 7274  esXtextSizeZsort
+00002c90: 436f 6c75 6d6e 5f10 1075 7365 5265 6c61  Column_..useRela
+00002ca0: 7469 7665 4461 7465 735f 1012 7669 6577  tiveDates_..view
+00002cb0: 4f70 7469 6f6e 7356 6572 7369 6f6e 2340  OptionsVersion#@
+00002cc0: 3000 0000 0000 0009 d90c 0d0e 0f10 1112  0...............
+00002cd0: 1314 151e 2328 2d32 363b 3f58 636f 6d6d  ....#(-26;?Xcomm
+00002ce0: 656e 7473 556c 6162 656c 5776 6572 7369  entsUlabelWversi
+00002cf0: 6f6e 5b64 6174 6543 7265 6174 6564 5473  on[dateCreatedTs
+00002d00: 697a 655c 6461 7465 4d6f 6469 6669 6564  ize\dateModified
+00002d10: 546b 696e 6454 6e61 6d65 5e64 6174 654c  TkindTname^dateL
+00002d20: 6173 744f 7065 6e65 64d4 1617 1819 1a1b  astOpened.......
+00002d30: 0a1d 5569 6e64 6578 5577 6964 7468 5961  ..UindexUwidthYa
+00002d40: 7363 656e 6469 6e67 5776 6973 6962 6c65  scendingWvisible
+00002d50: 1007 1101 2c09 08d4 1617 1819 1f20 0a1d  ....,........ ..
+00002d60: 1005 1064 0908 d416 1718 1924 250a 1d10  ...d.......$%...
+00002d70: 0610 4b09 08d4 1617 1819 292a 1d1d 1002  ..K.......)*....
+00002d80: 10b5 0808 d416 1718 192e 2f1d 0a10 0310  ........../.....
+00002d90: 6108 09d4 1617 1819 332a 1d0a 1001 0809  a.......3*......
+00002da0: d416 1718 1937 380a 0a10 0410 7309 09d4  .....78.....s...
+00002db0: 1617 1819 3c1b 0a0a 1000 0909 d416 1718  ....<...........
+00002dc0: 1940 411d 1d10 0810 c808 0808 2340 2800  .@A.........#@(.
+00002dd0: 0000 0000 005c 6461 7465 4d6f 6469 6669  .....\dateModifi
+00002de0: 6564 0900 0800 1900 2200 3400 3c00 5000  ed......".4.<.P.
+00002df0: 5900 6400 7700 8c00 9500 9600 a900 b200  Y.d.w...........
+00002e00: b800 c000 cc00 d100 de00 e300 e800 f701  ................
+00002e10: 0001 0601 0c01 1601 1e01 2001 2301 2401  .......... .#.$.
+00002e20: 2501 2e01 3001 3201 3301 3401 3d01 3f01  %...0.2.3.4.=.?.
+00002e30: 4101 4201 4301 4c01 4e01 5001 5101 5201  A.B.C.L.N.P.Q.R.
+00002e40: 5b01 5d01 5f01 6001 6101 6a01 6c01 6d01  [.]._.`.a.j.l.m.
+00002e50: 6e01 7701 7901 7b01 7c01 7d01 8601 8801  n.w.y.{.|.}.....
+00002e60: 8901 8a01 9301 9501 9701 9801 9901 9a01  ................
+00002e70: a301 b000 0000 0000 0002 0100 0000 0000  ................
+00002e80: 0000 4800 0000 0000 0000 0000 0000 0000  ..H.............
+00002e90: 0001 b100 0000 0600 6d00 6900 7800 6900  ........m.i.x.i.
+00002ea0: 6e00 736d 6f44 4462 6c6f 6200 0000 084b  n.smoDDblob....K
+00002eb0: c8be cede e2c5 4100 0000 0600 6d00 6900  ......A.....m.i.
+00002ec0: 7800 6900 6e00 736d 6f64 4462 6c6f 6200  x.i.n.smodDblob.
+00002ed0: 0000 084b c8be cede e2c5 4100 0000 0600  ...K......A.....
+00002ee0: 6d00 6900 7800 6900 6e00 7370 6831 5363  m.i.x.i.n.sph1Sc
+00002ef0: 6f6d 7000 0000 0001 a260 0000 0000 0600  omp......`......
+00002f00: 6d00 6900 7800 6900 6e00 7376 5372 6e6c  m.i.x.i.n.svSrnl
+00002f10: 6f6e 6700 0000 0100 0000 0500 6d00 6f00  ong.........m.o.
+00002f20: 6400 6500 6c6c 6731 5363 6f6d 7000 0000  d.e.llg1Scomp...
+00002f30: 0000 022a bc00 0000 0500 6d00 6f00 6400  ...*......m.o.d.
+00002f40: 6500 6c6d 6f44 4462 6c6f 6200 0000 0895  e.lmoDDblob.....
+00002f50: a698 57bf e2c5 4100 0000 0500 6d00 6f00  ..W...A.....m.o.
+00002f60: 6400 6500 6c6d 6f64 4462 6c6f 6200 0000  d.e.lmodDblob...
+00002f70: 0895 a698 57bf e2c5 416f 0072 0073 7653  ....W...Ao.r.svS
 00002f80: 726e 6c6f 6e67 0000 0001 0000 0000 0000  rnlong..........
 00002f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -790,15 +790,15 @@
 00003150: 5369 6465 6261 7208 0908 095f 1018 7b7b  Sidebar...._..{{
 00003160: 3333 392c 2033 3532 7d2c 207b 3932 302c  339, 352}, {920,
 00003170: 2034 3336 7d7d 0908 1523 2f3b 525f 6b6c   436}}...#/;R_kl
 00003180: 6d6e 6f8a 0000 0000 0000 0101 0000 0000  mno.............
 00003190: 0000 000d 0000 0000 0000 0000 0000 0000  ................
 000031a0: 0000 008b 0000 0008 0070 006c 006f 0074  .........p.l.o.t
 000031b0: 0074 0069 006e 0067 6c67 3153 636f 6d70  .t.i.n.glg1Scomp
-000031c0: 0000 0000 000f ab0f 0000 0008 0070 006c  .............p.l
+000031c0: 0000 0000 000f bd3d 0000 0008 0070 006c  .......=.....p.l
 000031d0: 006f 0074 0074 0069 006e 0067 6c73 7643  .o.t.t.i.n.glsvC
 000031e0: 626c 6f62 0000 0326 6270 6c69 7374 3030  blob...&bplist00
 000031f0: da01 0203 0405 0607 0809 0a0b 0c0d 1a54  ...............T
 00003200: 5556 570c 5958 6963 6f6e 5369 7a65 5f10  UVW.YXiconSize_.
 00003210: 0f73 686f 7749 636f 6e50 7265 7669 6577  .showIconPreview
 00003220: 5763 6f6c 756d 6e73 5f10 1163 616c 6375  Wcolumns_..calcu
 00003230: 6c61 7465 416c 6c53 697a 6573 5f10 0f73  lateAllSizes_..s
@@ -888,20 +888,20 @@
 00003770: 7a01 8301 8401 8601 8701 8901 9201 9301  z...............
 00003780: 9401 9601 9f01 a001 a201 a301 a501 ae01  ................
 00003790: af01 b001 b201 bb01 bc01 be01 bf01 c101  ................
 000037a0: c201 cb01 d401 dd01 e200 0000 0000 0002  ................
 000037b0: 0100 0000 0000 0000 4c00 0000 0000 0000  ........L.......
 000037c0: 0000 0000 0000 0001 e300 0000 0800 7000  ..............p.
 000037d0: 6c00 6f00 7400 7400 6900 6e00 676d 6f44  l.o.t.t.i.n.gmoD
-000037e0: 4462 6c6f 6200 0000 08a9 d9d8 7ee9 dcc5  Dblob.......~...
+000037e0: 4462 6c6f 6200 0000 0837 24ea ed0f e3c5  Dblob....7$.....
 000037f0: 4100 0000 0800 7000 6c00 6f00 7400 7400  A.....p.l.o.t.t.
 00003800: 6900 6e00 676d 6f64 4462 6c6f 6200 0000  i.n.gmodDblob...
-00003810: 08d6 b215 3bcb d9c5 4100 0000 0800 7000  ....;...A.....p.
+00003810: 0837 24ea ed0f e3c5 4100 0000 0800 7000  .7$.....A.....p.
 00003820: 6c00 6f00 7400 7400 6900 6e00 6770 6831  l.o.t.t.i.n.gph1
-00003830: 5363 6f6d 7000 0000 0000 1320 0000 0000  Scomp...... ....
+00003830: 5363 6f6d 7000 0000 0000 1330 0000 0000  Scomp......0....
 00003840: 0800 7000 6c00 6f00 7400 7400 6900 6e00  ..p.l.o.t.t.i.n.
 00003850: 6776 5372 6e6c 6f6e 6700 0000 0100 0000  gvSrnlong.......
 00003860: 1300 7000 6f00 7300 6500 5f00 6300 6f00  ..p.o.s.e._.c.o.
 00003870: 6e00 6600 6900 6700 7500 7200 6100 7400  n.f.i.g.u.r.a.t.
 00003880: 6900 6f00 6e00 7362 7773 7062 6c6f 6200  i.o.n.sbwspblob.
 00003890: 0000 b862 706c 6973 7430 30d6 0102 0304  ...bplist00.....
 000038a0: 0506 0708 0708 0b08 5d53 686f 7753 7461  ........]ShowSta
@@ -989,40 +989,40 @@
 00003dc0: 6964 6562 6172 0809 0809 5f10 187b 7b31  idebar...._..{{1
 00003dd0: 3232 2c20 3735 7d2c 207b 3132 3833 2c20  22, 75}, {1283, 
 00003de0: 3638 397d 7d09 0815 232f 3b52 5f6b 6c6d  689}}...#/;R_klm
 00003df0: 6e6f 8a00 0000 0000 0001 0100 0000 0000  no..............
 00003e00: 0000 0d00 0000 0000 0000 0000 0000 0000  ................
 00003e10: 0000 8b00 0000 0900 7200 6f00 6900 5f00  ........r.o.i._.
 00003e20: 7400 6f00 6f00 6c00 736c 6731 5363 6f6d  t.o.o.l.slg1Scom
-00003e30: 7000 0000 0000 06d8 5300 0000 0900 7200  p.......S.....r.
+00003e30: 7000 0000 0000 06ef 1100 0000 0900 7200  p.............r.
 00003e40: 6f00 6900 5f00 7400 6f00 6f00 6c00 736d  o.i._.t.o.o.l.sm
-00003e50: 6f44 4462 6c6f 6200 0000 0873 9869 e2e7  oDDblob....s.i..
-00003e60: dcc5 4100 0000 0900 7200 6f00 6900 5f00  ..A.....r.o.i._.
+00003e50: 6f44 4462 6c6f 6200 0000 08e1 a42a 4a0e  oDDblob......*J.
+00003e60: dfc5 4100 0000 0900 7200 6f00 6900 5f00  ..A.....r.o.i._.
 00003e70: 7400 6f00 6f00 6c00 736d 6f64 4462 6c6f  t.o.o.l.smodDblo
-00003e80: 6200 0000 08b2 0bf1 ee48 dcc5 4100 0000  b........H..A...
+00003e80: 6200 0000 08e1 a42a 4a0e dfc5 4100 0000  b......*J...A...
 00003e90: 0900 7200 6f00 6900 5f00 7400 6f00 6f00  ..r.o.i._.t.o.o.
 00003ea0: 6c00 7370 6831 5363 6f6d 7000 0000 0000  l.sph1Scomp.....
-00003eb0: 0850 0000 0000 0900 7200 6f00 6900 5f00  .P......r.o.i._.
+00003eb0: 0860 0000 0000 0900 7200 6f00 6900 5f00  .`......r.o.i._.
 00003ec0: 7400 6f00 6f00 6c00 7376 5372 6e6c 6f6e  t.o.o.l.svSrnlon
 00003ed0: 6700 0000 0100 0000 0700 7300 6100 6e00  g.........s.a.n.
 00003ee0: 6400 6200 6f00 7862 7773 7062 6c6f 6200  d.b.o.xbwspblob.
-00003ef0: 0000 b962 706c 6973 7430 30d6 0102 0304  ...bplist00.....
+00003ef0: 0000 b762 706c 6973 7430 30d6 0102 0304  ...bplist00.....
 00003f00: 0506 0708 0708 0b08 5d53 686f 7753 7461  ........]ShowSta
 00003f10: 7475 7342 6172 5b53 686f 7754 6f6f 6c62  tusBar[ShowToolb
 00003f20: 6172 5b53 686f 7754 6162 5669 6577 5f10  ar[ShowTabView_.
 00003f30: 1443 6f6e 7461 696e 6572 5368 6f77 5369  .ContainerShowSi
 00003f40: 6465 6261 725c 5769 6e64 6f77 426f 756e  debar\WindowBoun
 00003f50: 6473 5b53 686f 7753 6964 6562 6172 0809  ds[ShowSidebar..
-00003f60: 0809 5f10 197b 7b32 3435 2c20 3133 397d  .._..{{245, 139}
-00003f70: 2c20 7b31 3138 302c 2035 3638 7d7d 0908  , {1180, 568}}..
-00003f80: 1523 2f3b 525f 6b6c 6d6e 6f8b 0000 0000  .#/;R_klmno.....
-00003f90: 0000 0101 0000 0000 0000 000d 0000 0000  ................
-00003fa0: 0000 0000 0000 0000 0000 008c 0000 0007  ................
-00003fb0: 0073 0061 006e 0064 0062 006f 0078 6c67  .s.a.n.d.b.o.xlg
-00003fc0: 3153 636f 6d70 0000 0000 0009 9657 0000  1Scomp.......W..
+00003f60: 0809 5f10 177b 7b34 332c 2038 347d 2c20  .._..{{43, 84}, 
+00003f70: 7b31 3138 302c 2035 3638 7d7d 0908 1523  {1180, 568}}...#
+00003f80: 2f3b 525f 6b6c 6d6e 6f89 0000 0000 0000  /;R_klmno.......
+00003f90: 0101 0000 0000 0000 000d 0000 0000 0000  ................
+00003fa0: 0000 0000 0000 0000 008a 0000 0007 0073  ...............s
+00003fb0: 0061 006e 0064 0062 006f 0078 6c67 3153  .a.n.d.b.o.xlg1S
+00003fc0: 636f 6d70 0000 0000 0009 c561 0000 0000  comp.......a....
 00003fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004000: 0000 0000 0000 0006 0000 0000 0000 400b  ..............@.
 00004010: 0000 0045 0000 100c 0000 040a 0000 200c  ...E.......... .
 00004020: 0000 300c 0000 0000 0000 0000 0000 0000  ..0.............
 00004030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -1144,10 +1144,10 @@
 00004770: 7a01 8301 8401 8601 8701 8901 9201 9301  z...............
 00004780: 9401 9601 9f01 a001 a201 a301 a501 ae01  ................
 00004790: af01 b001 b201 bb01 bc01 be01 bf01 c101  ................
 000047a0: c201 cb01 d401 dd01 e200 0000 0000 0002  ................
 000047b0: 0100 0000 0000 0000 4c00 0000 0000 0000  ........L.......
 000047c0: 0000 0000 0000 0001 e300 0000 0800 7000  ..............p.
 000047d0: 6c00 6f00 7400 7400 6900 6e00 676d 6f44  l.o.t.t.i.n.gmoD
-000047e0: 4462 6c6f 6200 0000 08a9 d9d8 7ee9 dcc5  Dblob.......~...
+000047e0: 4462 6c6f 6200 0000 0837 24ea ed0f e3c5  Dblob....7$.....
 000047f0: 4100 0000 0800 7000 6c00 6f00 7400 7400  A.....p.l.o.t.t.
 00004800: 6900 6e00                                i.n.
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/feature_extractor_14bp.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/feature_extractor_14bp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/feature_extractor_7bp.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/feature_extractor_7bp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/doctests.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/doctests.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/fish_feature_extractor_2023_version_3.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/fish_feature_extractor_2023_version_3.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/read_in_mp.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/read_in_mp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/peaks.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/peaks.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/fish_feature_extractor_2022.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/fish_feature_extractor_2022.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/convex_hull_3_scratch_3.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/convex_hull_3_scratch_3.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/convex_hull_scratch_1.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/convex_hull_scratch_1.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/fish_feature_extractor_2023_version_2.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/fish_feature_extractor_2023_version_2.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/egocentrical_aligner.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/egocentrical_aligner.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/count_values_in_range.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/count_values_in_range.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/graph_creator.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/graph_creator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/termite_rois.csv` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/termite_rois.csv`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/mutual_exclusive.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/mutual_exclusive.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/video_color.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/video_color.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/graph_3d_plotter.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/graph_3d_plotter.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/video_rotator.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/video_rotator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/add_probability_cnt_features.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/add_probability_cnt_features.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/make_splash.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/make_splash.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/fish_feature_extractor_2023_version_5.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/fish_feature_extractor_2023_version_5.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/time_stamp_calculator.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/time_stamp_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/video_rotator_mp.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/video_rotator_mp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/fish_feature_extractor_2023_version_4.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/fish_feature_extractor_2023_version_4.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/misc/convex_hull_scratch_2.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/misc/convex_hull_scratch_2.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/feature_extractor_8bps_2_animals.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/feature_extractor_8bps_2_animals.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/.DS_Store` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/.DS_Store`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/perimeter_jit.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/perimeter_jit.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/feature_subsets.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/feature_subsets.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/feature_extractor_user_defined.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/feature_extractor_user_defined.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/feature_extractor_16bp.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/feature_extractor_16bp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/feature_extractor_9bp.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/feature_extractor_9bp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/feature_extractor_8bp.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/feature_extractor_8bp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/feature_extractor_4bp.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/feature_extractor_4bp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/feature_extractors/amber_feature_extractor.py` & `Simba-UW-tf-dev-1.89.5/simba/feature_extractors/amber_feature_extractor.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/requirements.txt` & `Simba-UW-tf-dev-1.89.5/simba/requirements.txt`

 * *Files 14% similar despite different names*

```diff
@@ -13,14 +13,15 @@
 numpy;python_version>="3.9"
 opencv-python == 3.4.5.20;python_version=="3.6"
 opencv-python;python_version>="3.9"
 pandas==0.25.3;python_version=="3.6"
 pandas;python_version>="3.9"
 scikit-image
 scipy
+kaleido
 seaborn == 0.9.0
 scikit-learn
 tabulate == 0.8.3;python_version=="3.6"
 tabulate == 0.9.0;python_version>="3.9"
 tqdm == 4.30.0
 xgboost == 0.90
 yellowbrick
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/mixins/annotator_mixin.py` & `Simba-UW-tf-dev-1.89.5/simba/mixins/annotator_mixin.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/mixins/timeseries_features_mixin.py` & `Simba-UW-tf-dev-1.89.5/simba/mixins/timeseries_features_mixin.py`

 * *Files 3% similar despite different names*

```diff
@@ -34,4888 +34,5227 @@
 00000210: 6672 6f6d 2074 7970 696e 675f 6578 7465  from typing_exte
 00000220: 6e73 696f 6e73 2069 6d70 6f72 7420 4c69  nsions import Li
 00000230: 7465 7261 6c0a 0a69 6d70 6f72 7420 7479  teral..import ty
 00000240: 7069 6e67 0a66 726f 6d20 7479 7069 6e67  ping.from typing
 00000250: 2069 6d70 6f72 7420 6765 745f 7479 7065   import get_type
 00000260: 5f68 696e 7473 0a0a 6672 6f6d 2073 696d  _hints..from sim
 00000270: 6261 2e75 7469 6c73 2e63 6865 636b 7320  ba.utils.checks 
-00000280: 696d 706f 7274 2028 6368 6563 6b5f 696e  import (check_in
-00000290: 7374 616e 6365 2c20 6368 6563 6b5f 696e  stance, check_in
-000002a0: 742c 2063 6865 636b 5f73 7472 2c0a 2020  t, check_str,.  
+00000280: 696d 706f 7274 2028 6368 6563 6b5f 666c  import (check_fl
+00000290: 6f61 742c 2063 6865 636b 5f69 6e73 7461  oat, check_insta
+000002a0: 6e63 652c 2063 6865 636b 5f69 6e74 2c0a  nce, check_int,.
 000002b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000002c0: 2020 2020 2020 2020 2020 2020 2020 6368                ch
-000002d0: 6563 6b5f 7468 6174 5f63 6f6c 756d 6e5f  eck_that_column_
-000002e0: 6578 6973 742c 2063 6865 636b 5f76 616c  exist, check_val
-000002f0: 6964 5f6c 7374 290a 6672 6f6d 2073 696d  id_lst).from sim
-00000300: 6261 2e75 7469 6c73 2e72 6561 645f 7772  ba.utils.read_wr
-00000310: 6974 6520 696d 706f 7274 2066 696e 645f  ite import find_
-00000320: 636f 7265 5f63 6e74 0a0a 0a63 6c61 7373  core_cnt...class
-00000330: 2054 696d 6573 6572 6965 7346 6561 7475   TimeseriesFeatu
-00000340: 7265 4d69 7869 6e28 6f62 6a65 6374 293a  reMixin(object):
-00000350: 0a20 2020 2022 2222 0a20 2020 2054 696d  .    """.    Tim
-00000360: 652d 7365 7269 6573 206d 6574 686f 6473  e-series methods
-00000370: 2066 6f63 7573 6564 206f 6e20 7369 676e   focused on sign
-00000380: 616c 2063 6f6d 706c 6578 6974 7920 696e  al complexity in
-00000390: 2073 6c69 6469 6e67 2077 696e 646f 7773   sliding windows
-000003a0: 2e20 4d61 696e 6c79 2069 6e20 7469 6d65  . Mainly in time
-000003b0: 2d64 6f6d 6169 6e20 2d20 6666 7420 6d65  -domain - fft me
-000003c0: 7468 6f64 7320 2874 6872 6f75 6768 2065  thods (through e
-000003d0: 2e67 2e20 7363 6970 7929 0a20 2020 2049  .g. scipy).    I
-000003e0: 2776 6520 666f 756e 6420 736f 2066 6172  've found so far
-000003f0: 2068 6173 206e 6f74 2062 6565 6e20 6661   has not been fa
-00000400: 7374 2065 6e6f 7567 6820 666f 7220 726f  st enough for ro
-00000410: 6c6c 696e 6720 7769 6e64 6f77 7320 696e  lling windows in
-00000420: 206c 6172 6765 2064 6174 6173 6574 732e   large datasets.
-00000430: 0a0a 2020 2020 2e2e 2069 6d61 6765 3a3a  ..    .. image::
-00000440: 205f 7374 6174 6963 2f69 6d67 2f74 735f   _static/img/ts_
-00000450: 7275 6e74 696d 6573 2e70 6e67 0a20 2020  runtimes.png.   
-00000460: 2020 2020 3a77 6964 7468 3a20 3132 3030      :width: 1200
-00000470: 0a20 2020 2020 2020 3a61 6c69 676e 3a20  .       :align: 
-00000480: 6365 6e74 6572 0a0a 2020 2020 2e2e 206e  center..    .. n
-00000490: 6f74 653a 3a0a 2020 2020 2020 204d 616e  ote::.       Man
-000004a0: 7920 6d65 7468 6f64 2068 6173 206e 756d  y method has num
-000004b0: 6261 2074 7970 6564 2060 7369 676e 6174  ba typed `signat
-000004c0: 7572 6573 203c 6874 7470 733a 2f2f 6e75  ures <https://nu
-000004d0: 6d62 612e 7079 6461 7461 2e6f 7267 2f6e  mba.pydata.org/n
-000004e0: 756d 6261 2d64 6f63 2f6c 6174 6573 742f  umba-doc/latest/
-000004f0: 7265 6665 7265 6e63 652f 7479 7065 732e  reference/types.
-00000500: 6874 6d6c 3e60 5f20 746f 2064 6563 7265  html>`_ to decre
-00000510: 6173 650a 2020 2020 2020 2063 6f6d 7069  ase.       compi
-00000520: 6c61 7469 6f6e 2074 696d 6520 7468 726f  lation time thro
-00000530: 7567 6820 7265 6475 6365 6420 7479 7065  ugh reduced type
-00000540: 2069 6e66 6572 656e 6365 2e20 4d61 6b65   inference. Make
-00000550: 2073 7572 6520 746f 2070 6173 7320 7468   sure to pass th
-00000560: 6520 636f 7272 6563 7420 6474 7970 6573  e correct dtypes
-00000570: 2061 7320 696e 6469 6361 7465 6420 6279   as indicated by
-00000580: 2073 6967 6e61 7475 7265 2064 6563 6f72   signature decor
-00000590: 6174 6f72 732e 0a0a 2020 2020 2e2e 2069  ators...    .. i
-000005a0: 6d70 6f72 7461 6e74 3a3a 0a20 2020 2020  mportant::.     
-000005b0: 2020 5365 6520 7265 6665 7265 6e63 6573    See references
-000005c0: 2066 6f72 206d 6174 7572 6520 7061 636b   for mature pack
-000005d0: 6167 6573 2063 6f6d 7075 7469 6e67 206d  ages computing m
-000005e0: 6f72 6520 6578 7465 6e73 6976 6520 7469  ore extensive ti
-000005f0: 6d65 7365 7269 6573 206d 6561 7375 7265  meseries measure
-00000600: 6d65 6e74 730a 0a20 2020 2020 2020 2e2e  ments..       ..
-00000610: 205b 315d 2060 6365 7369 756d 203c 6874   [1] `cesium <ht
-00000620: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
-00000630: 2f63 6573 6975 6d2d 6d6c 2f63 6573 6975  /cesium-ml/cesiu
-00000640: 6d3e 605f 2e0a 2020 2020 2020 202e 2e20  m>`_..       .. 
-00000650: 5b32 5d20 6065 6567 6c69 6220 3c68 7474  [2] `eeglib <htt
-00000660: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
-00000670: 5869 756c 3130 392f 6565 676c 6962 3e60  Xiul109/eeglib>`
-00000680: 5f2e 0a20 2020 2020 2020 2e2e 205b 335d  _..       .. [3]
-00000690: 2060 616e 7472 6f70 7920 3c68 7474 7073   `antropy <https
-000006a0: 3a2f 2f67 6974 6875 622e 636f 6d2f 7261  ://github.com/ra
-000006b0: 7068 6165 6c76 616c 6c61 742f 616e 7472  phaelvallat/antr
-000006c0: 6f70 793e 605f 2e0a 2020 2020 2020 202e  opy>`_..       .
-000006d0: 2e20 5b34 5d20 6074 7366 7265 7368 203c  . [4] `tsfresh <
-000006e0: 6874 7470 733a 2f2f 7473 6672 6573 682e  https://tsfresh.
-000006f0: 7265 6164 7468 6564 6f63 732e 696f 3e60  readthedocs.io>`
-00000700: 5f2e 0a20 2020 2020 2020 2e2e 205b 355d  _..       .. [5]
-00000710: 2060 7079 6361 7265 7420 3c68 7474 7073   `pycaret <https
-00000720: 3a2f 2f67 6974 6875 622e 636f 6d2f 7079  ://github.com/py
-00000730: 6361 7265 742f 7079 6361 7265 743e 605f  caret/pycaret>`_
-00000740: 2e0a 2020 2020 2222 220a 0a20 2020 2064  ..    """..    d
-00000750: 6566 205f 5f69 6e69 745f 5f28 7365 6c66  ef __init__(self
-00000760: 293a 0a20 2020 2020 2020 2070 6173 730a  ):.        pass.
-00000770: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
-00000780: 6f64 0a20 2020 2040 6e6a 6974 2822 2866  od.    @njit("(f
-00000790: 6c6f 6174 3332 5b3a 5d2c 2922 290a 2020  loat32[:],)").  
-000007a0: 2020 6465 6620 686a 6f72 745f 7061 7261    def hjort_para
-000007b0: 6d65 7465 7273 2864 6174 613a 206e 702e  meters(data: np.
-000007c0: 6e64 6172 7261 7929 202d 3e20 2866 6c6f  ndarray) -> (flo
-000007d0: 6174 2c20 666c 6f61 742c 2066 6c6f 6174  at, float, float
-000007e0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-000007f0: 2020 2020 2020 204a 6974 7465 6420 636f         Jitted co
-00000800: 6d70 7574 6520 6f66 2048 6a6f 7274 6820  mpute of Hjorth 
-00000810: 7061 7261 6d65 7465 7273 2066 6f72 2061  parameters for a
-00000820: 2067 6976 656e 2074 696d 6520 7365 7269   given time seri
-00000830: 6573 2064 6174 612e 2048 6a6f 7274 6820  es data. Hjorth 
-00000840: 7061 7261 6d65 7465 7273 2064 6573 6372  parameters descr
-00000850: 6962 650a 2020 2020 2020 2020 6d6f 6269  ibe.        mobi
-00000860: 6c69 7479 2c20 636f 6d70 6c65 7869 7479  lity, complexity
-00000870: 2c20 616e 6420 6163 7469 7669 7479 206f  , and activity o
-00000880: 6620 6120 7469 6d65 2073 6572 6965 732e  f a time series.
-00000890: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-000008a0: 206e 756d 7079 2e6e 6461 7272 6179 2064   numpy.ndarray d
-000008b0: 6174 613a 2041 2031 2d64 696d 656e 7369  ata: A 1-dimensi
-000008c0: 6f6e 616c 206e 756d 7079 2061 7272 6179  onal numpy array
-000008d0: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
-000008e0: 7469 6d65 2073 6572 6965 7320 6461 7461  time series data
-000008f0: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-00000900: 6e3a 2074 7570 6c65 0a20 2020 2020 2020  n: tuple.       
-00000910: 2020 2020 2041 2074 7570 6c65 2063 6f6e       A tuple con
-00000920: 7461 696e 696e 6720 7468 6520 666f 6c6c  taining the foll
-00000930: 6f77 696e 6720 486a 6f72 7468 2070 6172  owing Hjorth par
-00000940: 616d 6574 6572 733a 0a20 2020 2020 2020  ameters:.       
-00000950: 2020 2020 202d 2061 6374 6976 6974 7920       - activity 
-00000960: 2866 6c6f 6174 293a 2054 6865 2061 6374  (float): The act
-00000970: 6976 6974 7920 6f66 2074 6865 2074 696d  ivity of the tim
-00000980: 6520 7365 7269 6573 2c20 7768 6963 6820  e series, which 
-00000990: 6973 2074 6865 2076 6172 6961 6e63 6520  is the variance 
-000009a0: 6f66 2074 6865 2069 6e70 7574 2064 6174  of the input dat
-000009b0: 612e 0a20 2020 2020 2020 2020 2020 202d  a..            -
-000009c0: 206d 6f62 696c 6974 7920 2866 6c6f 6174   mobility (float
-000009d0: 293a 2054 6865 206d 6f62 696c 6974 7920  ): The mobility 
-000009e0: 6f66 2074 6865 2074 696d 6520 7365 7269  of the time seri
-000009f0: 6573 2c20 6361 6c63 756c 6174 6564 2061  es, calculated a
-00000a00: 7320 7468 6520 7371 7561 7265 2072 6f6f  s the square roo
-00000a10: 7420 6f66 2074 6865 2076 6172 6961 6e63  t of the varianc
-00000a20: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00000a30: 6f66 2074 6865 2066 6972 7374 2064 6572  of the first der
-00000a40: 6976 6174 6976 6520 6f66 2074 6865 2069  ivative of the i
-00000a50: 6e70 7574 2064 6174 6120 6469 7669 6465  nput data divide
-00000a60: 6420 6279 2074 6865 2076 6172 6961 6e63  d by the varianc
-00000a70: 6520 6f66 2074 6865 2069 6e70 7574 2064  e of the input d
-00000a80: 6174 612e 0a20 2020 2020 2020 2020 2020  ata..           
-00000a90: 202d 2063 6f6d 706c 6578 6974 7920 2866   - complexity (f
-00000aa0: 6c6f 6174 293a 2054 6865 2063 6f6d 706c  loat): The compl
-00000ab0: 6578 6974 7920 6f66 2074 6865 2074 696d  exity of the tim
-00000ac0: 6520 7365 7269 6573 2c20 6361 6c63 756c  e series, calcul
-00000ad0: 6174 6564 2061 7320 7468 6520 7371 7561  ated as the squa
-00000ae0: 7265 2072 6f6f 7420 6f66 2074 6865 2076  re root of the v
-00000af0: 6172 6961 6e63 650a 2020 2020 2020 2020  ariance.        
-00000b00: 2020 2020 2020 6f66 2074 6865 2073 6563        of the sec
-00000b10: 6f6e 6420 6465 7269 7661 7469 7665 206f  ond derivative o
-00000b20: 6620 7468 6520 696e 7075 7420 6461 7461  f the input data
-00000b30: 2064 6976 6964 6564 2062 7920 7468 6520   divided by the 
-00000b40: 7661 7269 616e 6365 206f 6620 7468 6520  variance of the 
-00000b50: 6669 7273 7420 6465 7269 7661 7469 7665  first derivative
-00000b60: 2c20 616e 6420 7468 656e 0a20 2020 2020  , and then.     
-00000b70: 2020 2020 2020 2020 2064 6976 6964 6564           divided
-00000b80: 2062 7920 7468 6520 6d6f 6269 6c69 7479   by the mobility
-00000b90: 2e0a 0a20 2020 2020 2020 203a 6578 616d  ...        :exam
-00000ba0: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
-00000bb0: 2064 6174 6120 3d20 6e70 2e61 7272 6179   data = np.array
-00000bc0: 285b 312e 302c 2032 2e30 2c20 332e 302c  ([1.0, 2.0, 3.0,
-00000bd0: 2034 2e30 2c20 352e 305d 2c20 6474 7970   4.0, 5.0], dtyp
-00000be0: 653d 6e70 2e66 6c6f 6174 3332 290a 2020  e=np.float32).  
-00000bf0: 2020 2020 2020 3e3e 3e20 5469 6d65 7365        >>> Timese
-00000c00: 7269 6573 4665 6174 7572 654d 6978 696e  riesFeatureMixin
-00000c10: 2829 2e68 6a6f 7274 5f70 6172 616d 6574  ().hjort_paramet
-00000c20: 6572 7328 6461 7461 290a 2020 2020 2020  ers(data).      
-00000c30: 2020 3e3e 3e20 2832 2e35 2c20 302e 352c    >>> (2.5, 0.5,
-00000c40: 2030 2e34 3038 3234 3832 3930 3436 3338   0.4082482904638
-00000c50: 3633 3129 0a0a 2020 2020 2020 2020 3a6d  631)..        :m
-00000c60: 6174 683a 606d 6f62 696c 6974 7920 3d20  ath:`mobility = 
-00000c70: 5c73 7172 747b 5c5c 6672 6163 7b64 785f  \sqrt{\\frac{dx_
-00000c80: 7b76 6172 7d7d 7b78 5f7b 7661 727d 7d7d  {var}}{x_{var}}}
-00000c90: 600a 0a20 2020 2020 2020 203a 6d61 7468  `..        :math
-00000ca0: 3a60 636f 6d70 6c65 7869 7479 203d 205c  :`complexity = \
-00000cb0: 7371 7274 7b5c 5c66 7261 637b 6464 785f  sqrt{\\frac{ddx_
-00000cc0: 7b76 6172 7d7d 7b64 785f 7b76 6172 7d7d  {var}}{dx_{var}}
-00000cd0: 202f 206d 6f62 696c 6974 797d 600a 2020   / mobility}`.  
-00000ce0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00000cf0: 2020 6478 203d 206e 702e 6469 6666 286e    dx = np.diff(n
-00000d00: 702e 6173 636f 6e74 6967 756f 7573 6172  p.ascontiguousar
-00000d10: 7261 7928 6461 7461 2929 0a20 2020 2020  ray(data)).     
-00000d20: 2020 2064 6478 203d 206e 702e 6469 6666     ddx = np.diff
-00000d30: 286e 702e 6173 636f 6e74 6967 756f 7573  (np.ascontiguous
-00000d40: 6172 7261 7928 6478 2929 0a20 2020 2020  array(dx)).     
-00000d50: 2020 2078 5f76 6172 2c20 6478 5f76 6172     x_var, dx_var
-00000d60: 203d 206e 702e 7661 7228 6461 7461 292c   = np.var(data),
-00000d70: 206e 702e 7661 7228 6478 290a 2020 2020   np.var(dx).    
-00000d80: 2020 2020 6966 2028 785f 7661 7220 3c3d      if (x_var <=
-00000d90: 2030 2920 6f72 2028 6478 5f76 6172 203c   0) or (dx_var <
-00000da0: 3d20 3029 3a0a 2020 2020 2020 2020 2020  = 0):.          
-00000db0: 2020 7265 7475 726e 2030 2c20 302c 2030    return 0, 0, 0
-00000dc0: 0a0a 2020 2020 2020 2020 6464 785f 7661  ..        ddx_va
-00000dd0: 7220 3d20 6e70 2e76 6172 2864 6478 290a  r = np.var(ddx).
-00000de0: 2020 2020 2020 2020 6d6f 6269 6c69 7479          mobility
-00000df0: 203d 206e 702e 7371 7274 2864 785f 7661   = np.sqrt(dx_va
-00000e00: 7220 2f20 785f 7661 7229 0a20 2020 2020  r / x_var).     
-00000e10: 2020 2063 6f6d 706c 6578 6974 7920 3d20     complexity = 
-00000e20: 6e70 2e73 7172 7428 6464 785f 7661 7220  np.sqrt(ddx_var 
-00000e30: 2f20 6478 5f76 6172 2920 2f20 6d6f 6269  / dx_var) / mobi
-00000e40: 6c69 7479 0a20 2020 2020 2020 2061 6374  lity.        act
-00000e50: 6976 6974 7920 3d20 6e70 2e76 6172 2864  ivity = np.var(d
-00000e60: 6174 6129 0a0a 2020 2020 2020 2020 7265  ata)..        re
-00000e70: 7475 726e 2061 6374 6976 6974 792c 206d  turn activity, m
-00000e80: 6f62 696c 6974 792c 2063 6f6d 706c 6578  obility, complex
-00000e90: 6974 790a 0a20 2020 2040 7374 6174 6963  ity..    @static
-00000ea0: 6d65 7468 6f64 0a20 2020 2040 6e6a 6974  method.    @njit
-00000eb0: 2822 2866 6c6f 6174 3332 5b3a 5d2c 2066  ("(float32[:], f
-00000ec0: 6c6f 6174 3634 5b3a 5d2c 2069 6e74 3634  loat64[:], int64
-00000ed0: 2922 290a 2020 2020 6465 6620 736c 6964  )").    def slid
-00000ee0: 696e 675f 686a 6f72 745f 7061 7261 6d65  ing_hjort_parame
-00000ef0: 7465 7273 280a 2020 2020 2020 2020 6461  ters(.        da
-00000f00: 7461 3a20 6e70 2e6e 6461 7272 6179 2c20  ta: np.ndarray, 
-00000f10: 7769 6e64 6f77 5f73 697a 6573 3a20 6e70  window_sizes: np
-00000f20: 2e6e 6461 7272 6179 2c20 7361 6d70 6c65  .ndarray, sample
-00000f30: 5f72 6174 653a 2069 6e74 0a20 2020 2029  _rate: int.    )
-00000f40: 202d 3e20 6e70 2e6e 6461 7272 6179 3a0a   -> np.ndarray:.
-00000f50: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00000f60: 2020 2020 4a69 7474 6564 2063 6f6d 7075      Jitted compu
-00000f70: 7465 206f 6620 486a 6f72 7468 2070 6172  te of Hjorth par
-00000f80: 616d 6574 6572 732c 2069 6e63 6c75 6469  ameters, includi
-00000f90: 6e67 206d 6f62 696c 6974 792c 2063 6f6d  ng mobility, com
-00000fa0: 706c 6578 6974 792c 2061 6e64 2061 6374  plexity, and act
-00000fb0: 6976 6974 792c 2066 6f72 0a20 2020 2020  ivity, for.     
-00000fc0: 2020 2073 6c69 6469 6e67 2077 696e 646f     sliding windo
-00000fd0: 7773 206f 6620 7661 7279 696e 6720 7369  ws of varying si
-00000fe0: 7a65 7320 6170 706c 6965 6420 746f 2074  zes applied to t
-00000ff0: 6865 2069 6e70 7574 2064 6174 6120 6172  he input data ar
-00001000: 7261 792e 0a0a 2020 2020 2020 2020 3a70  ray...        :p
-00001010: 6172 616d 206e 702e 6e64 6172 7261 7920  aram np.ndarray 
-00001020: 6461 7461 3a20 496e 7075 7420 6461 7461  data: Input data
-00001030: 2061 7272 6179 2e0a 2020 2020 2020 2020   array..        
-00001040: 3a70 6172 616d 206e 702e 6e64 6172 7261  :param np.ndarra
-00001050: 7920 7769 6e64 6f77 5f73 697a 6573 3a20  y window_sizes: 
-00001060: 4172 7261 7920 6f66 2077 696e 646f 7720  Array of window 
-00001070: 7369 7a65 7320 2869 6e20 7365 636f 6e64  sizes (in second
-00001080: 7329 2e0a 2020 2020 2020 2020 3a70 6172  s)..        :par
-00001090: 616d 2069 6e74 2073 616d 706c 655f 7261  am int sample_ra
-000010a0: 7465 3a20 5361 6d70 6c69 6e67 2072 6174  te: Sampling rat
-000010b0: 6520 6f66 2074 6865 2064 6174 6120 696e  e of the data in
-000010c0: 2073 616d 706c 6573 2070 6572 2073 6563   samples per sec
-000010d0: 6f6e 642e 0a20 2020 2020 2020 203a 7265  ond..        :re
-000010e0: 7475 726e 206e 702e 6e64 6172 7261 793a  turn np.ndarray:
-000010f0: 2041 6e20 6172 7261 7920 636f 6e74 6169   An array contai
-00001100: 6e69 6e67 2048 6a6f 7274 6820 7061 7261  ning Hjorth para
-00001110: 6d65 7465 7273 2066 6f72 2065 6163 6820  meters for each 
-00001120: 7769 6e64 6f77 2073 697a 6520 616e 6420  window size and 
-00001130: 6461 7461 2070 6f69 6e74 2e0a 2020 2020  data point..    
-00001140: 2020 2020 2020 2020 2020 2020 2020 2054                 T
-00001150: 6865 2073 6861 7065 206f 6620 7468 6520  he shape of the 
-00001160: 7265 7375 6c74 2061 7272 6179 2069 7320  result array is 
-00001170: 2833 2c20 6461 7461 2e73 6861 7065 5b30  (3, data.shape[0
-00001180: 5d2c 2077 696e 646f 775f 7369 7a65 732e  ], window_sizes.
-00001190: 7368 6170 655b 305d 292e 0a20 2020 2020  shape[0])..     
-000011a0: 2020 2020 2020 2020 2020 2020 2020 5468                Th
-000011b0: 6520 7468 7265 6520 7061 7261 6d65 7465  e three paramete
-000011c0: 7273 2061 7265 2073 746f 7265 6420 696e  rs are stored in
-000011d0: 2074 6865 2066 6972 7374 2064 696d 656e   the first dimen
-000011e0: 7369 6f6e 2028 3020 2d20 6d6f 6269 6c69  sion (0 - mobili
-000011f0: 7479 2c20 3120 2d20 636f 6d70 6c65 7869  ty, 1 - complexi
-00001200: 7479 2c0a 2020 2020 2020 2020 2020 2020  ty,.            
-00001210: 2020 2020 2020 2032 202d 2061 6374 6976         2 - activ
-00001220: 6974 7929 2c20 616e 6420 7468 6520 7265  ity), and the re
-00001230: 6d61 696e 696e 6720 6469 6d65 6e73 696f  maining dimensio
-00001240: 6e73 2063 6f72 7265 7370 6f6e 6420 746f  ns correspond to
-00001250: 2064 6174 6120 706f 696e 7473 2061 6e64   data points and
-00001260: 2077 696e 646f 7720 7369 7a65 732e 0a0a   window sizes...
-00001270: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00001280: 2020 2020 7265 7375 6c74 7320 3d20 6e70      results = np
-00001290: 2e66 756c 6c28 2833 2c20 6461 7461 2e73  .full((3, data.s
-000012a0: 6861 7065 5b30 5d2c 2077 696e 646f 775f  hape[0], window_
-000012b0: 7369 7a65 732e 7368 6170 655b 305d 292c  sizes.shape[0]),
-000012c0: 202d 312e 3029 0a20 2020 2020 2020 2066   -1.0).        f
-000012d0: 6f72 2069 2069 6e20 7261 6e67 6528 7769  or i in range(wi
-000012e0: 6e64 6f77 5f73 697a 6573 2e73 6861 7065  ndow_sizes.shape
-000012f0: 5b30 5d29 3a0a 2020 2020 2020 2020 2020  [0]):.          
-00001300: 2020 7769 6e64 6f77 5f73 697a 6520 3d20    window_size = 
-00001310: 696e 7428 7769 6e64 6f77 5f73 697a 6573  int(window_sizes
-00001320: 5b69 5d20 2a20 7361 6d70 6c65 5f72 6174  [i] * sample_rat
-00001330: 6529 0a20 2020 2020 2020 2020 2020 2066  e).            f
-00001340: 6f72 206c 2c20 7220 696e 207a 6970 280a  or l, r in zip(.
-00001350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001360: 7072 616e 6765 2830 2c20 6461 7461 2e73  prange(0, data.s
-00001370: 6861 7065 5b30 5d20 2b20 3129 2c20 7072  hape[0] + 1), pr
-00001380: 616e 6765 2877 696e 646f 775f 7369 7a65  ange(window_size
-00001390: 2c20 6461 7461 2e73 6861 7065 5b30 5d20  , data.shape[0] 
-000013a0: 2b20 3129 0a20 2020 2020 2020 2020 2020  + 1).           
-000013b0: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
-000013c0: 2020 2020 7361 6d70 6c65 203d 2064 6174      sample = dat
-000013d0: 615b 6c3a 725d 0a20 2020 2020 2020 2020  a[l:r].         
-000013e0: 2020 2020 2020 2064 7820 3d20 6e70 2e64         dx = np.d
-000013f0: 6966 6628 6e70 2e61 7363 6f6e 7469 6775  iff(np.ascontigu
-00001400: 6f75 7361 7272 6179 2873 616d 706c 6529  ousarray(sample)
-00001410: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00001420: 2020 6464 7820 3d20 6e70 2e64 6966 6628    ddx = np.diff(
-00001430: 6e70 2e61 7363 6f6e 7469 6775 6f75 7361  np.ascontiguousa
-00001440: 7272 6179 2864 7829 290a 2020 2020 2020  rray(dx)).      
-00001450: 2020 2020 2020 2020 2020 785f 7661 722c            x_var,
-00001460: 2064 785f 7661 7220 3d20 6e70 2e76 6172   dx_var = np.var
-00001470: 2873 616d 706c 6529 2c20 6e70 2e76 6172  (sample), np.var
-00001480: 2864 7829 0a20 2020 2020 2020 2020 2020  (dx).           
-00001490: 2020 2020 2069 6620 2878 5f76 6172 203c       if (x_var <
-000014a0: 3d20 3029 206f 7220 2864 785f 7661 7220  = 0) or (dx_var 
-000014b0: 3c3d 2030 293a 0a20 2020 2020 2020 2020  <= 0):.         
-000014c0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-000014d0: 7473 5b30 2c20 7220 2b20 312c 2069 5d20  ts[0, r + 1, i] 
-000014e0: 3d20 300a 2020 2020 2020 2020 2020 2020  = 0.            
-000014f0: 2020 2020 2020 2020 7265 7375 6c74 735b          results[
-00001500: 312c 2072 202b 2031 2c20 695d 203d 2030  1, r + 1, i] = 0
-00001510: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001520: 2020 2020 2072 6573 756c 7473 5b32 2c20       results[2, 
-00001530: 7220 2b20 312c 2069 5d20 3d20 300a 2020  r + 1, i] = 0.  
-00001540: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00001550: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00001560: 2020 2020 2020 2020 6464 785f 7661 7220          ddx_var 
-00001570: 3d20 6e70 2e76 6172 2864 6478 290a 2020  = np.var(ddx).  
-00001580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001590: 2020 6d6f 6269 6c69 7479 203d 206e 702e    mobility = np.
-000015a0: 7371 7274 2864 785f 7661 7220 2f20 785f  sqrt(dx_var / x_
-000015b0: 7661 7229 0a20 2020 2020 2020 2020 2020  var).           
-000015c0: 2020 2020 2020 2020 2063 6f6d 706c 6578           complex
-000015d0: 6974 7920 3d20 6e70 2e73 7172 7428 6464  ity = np.sqrt(dd
-000015e0: 785f 7661 7220 2f20 6478 5f76 6172 2920  x_var / dx_var) 
-000015f0: 2f20 6d6f 6269 6c69 7479 0a20 2020 2020  / mobility.     
-00001600: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00001610: 6374 6976 6974 7920 3d20 6e70 2e76 6172  ctivity = np.var
-00001620: 2873 616d 706c 6529 0a20 2020 2020 2020  (sample).       
-00001630: 2020 2020 2020 2020 2020 2020 2072 6573               res
-00001640: 756c 7473 5b30 2c20 7220 2b20 312c 2069  ults[0, r + 1, i
-00001650: 5d20 3d20 6d6f 6269 6c69 7479 0a20 2020  ] = mobility.   
-00001660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001670: 2072 6573 756c 7473 5b31 2c20 7220 2b20   results[1, r + 
-00001680: 312c 2069 5d20 3d20 636f 6d70 6c65 7869  1, i] = complexi
-00001690: 7479 0a20 2020 2020 2020 2020 2020 2020  ty.             
-000016a0: 2020 2020 2020 2072 6573 756c 7473 5b32         results[2
-000016b0: 2c20 7220 2b20 312c 2069 5d20 3d20 6163  , r + 1, i] = ac
-000016c0: 7469 7669 7479 0a0a 2020 2020 2020 2020  tivity..        
-000016d0: 7265 7475 726e 2072 6573 756c 7473 2e61  return results.a
-000016e0: 7374 7970 6528 6e70 2e66 6c6f 6174 3332  stype(np.float32
-000016f0: 290a 0a20 2020 2040 7374 6174 6963 6d65  )..    @staticme
-00001700: 7468 6f64 0a20 2020 2040 6e6a 6974 285b  thod.    @njit([
-00001710: 2866 6c6f 6174 3332 5b3a 5d2c 2062 6f6f  (float32[:], boo
-00001720: 6c65 616e 292c 2028 666c 6f61 7433 325b  lean), (float32[
-00001730: 3a5d 2c20 7479 7065 732e 6d69 7363 2e4f  :], types.misc.O
-00001740: 6d69 7474 6564 2854 7275 6529 295d 290a  mitted(True))]).
-00001750: 2020 2020 6465 6620 6c6f 6361 6c5f 6d61      def local_ma
-00001760: 7869 6d61 5f6d 696e 696d 6128 6461 7461  xima_minima(data
-00001770: 3a20 6e70 2e6e 6461 7272 6179 2c20 6d61  : np.ndarray, ma
-00001780: 7869 6d61 3a20 626f 6f6c 203d 2054 7275  xima: bool = Tru
-00001790: 6529 202d 3e20 6e70 2e6e 6461 7272 6179  e) -> np.ndarray
-000017a0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-000017b0: 2020 2020 2020 4a69 7474 6564 2063 6f6d        Jitted com
-000017c0: 7075 7465 206f 6620 7468 6520 6c6f 6361  pute of the loca
-000017d0: 6c20 6d61 7869 6d61 206f 7220 6d69 6e69  l maxima or mini
-000017e0: 6d61 2064 6566 696e 6564 2061 7320 7661  ma defined as va
-000017f0: 6c75 6573 2077 6869 6368 2061 7265 2068  lues which are h
-00001800: 6967 6865 7220 6f72 206c 6f77 6572 2074  igher or lower t
-00001810: 6861 6e20 696d 6d65 6469 6174 656c 7920  han immediately 
-00001820: 7072 6563 6564 696e 6720 616e 6420 7072  preceding and pr
-00001830: 6f63 6565 6469 6e67 2074 696d 652d 7365  oceeding time-se
-00001840: 7269 6573 206e 6569 6768 626f 7273 2c20  ries neighbors, 
-00001850: 7265 7065 6374 6976 656c 792e 0a20 2020  repectively..   
-00001860: 2020 2020 2052 6574 7572 6e73 2032 4420       Returns 2D 
-00001870: 6e70 2e6e 6461 7272 6179 2077 6974 6820  np.ndarray with 
-00001880: 636f 6c75 6d6e 7320 7265 7072 6573 656e  columns represen
-00001890: 7469 6e67 2069 6478 2061 6e64 2076 616c  ting idx and val
-000018a0: 7565 7320 6f66 206c 6f63 616c 206d 6178  ues of local max
-000018b0: 696d 612e 0a0a 2020 2020 2020 2020 3a70  ima...        :p
-000018c0: 6172 616d 206e 702e 6e64 6172 7261 7920  aram np.ndarray 
-000018d0: 6461 7461 3a20 5469 6d65 2d73 6572 6965  data: Time-serie
-000018e0: 7320 6461 7461 2e0a 2020 2020 2020 2020  s data..        
-000018f0: 3a70 6172 616d 2062 6f6f 6c20 6d61 7869  :param bool maxi
-00001900: 6d61 3a20 4966 2054 7275 652c 2072 6574  ma: If True, ret
-00001910: 7572 6e73 206d 6178 696d 612e 2045 6c73  urns maxima. Els
-00001920: 652c 206d 696e 696d 612e 0a20 2020 2020  e, minima..     
-00001930: 2020 203a 7265 7475 726e 206e 702e 6e64     :return np.nd
-00001940: 6172 7261 793a 2032 4420 6e70 2e6e 6461  array: 2D np.nda
-00001950: 7272 6179 2077 6974 6820 636f 6c75 6d6e  rray with column
-00001960: 7320 7265 7072 6573 656e 7469 6e67 2069  s representing i
-00001970: 6478 2069 6e20 696e 7075 7420 6461 7461  dx in input data
-00001980: 2069 6e20 6669 7273 7420 636f 6c75 6d6e   in first column
-00001990: 2061 6e64 2076 616c 7565 7320 6f66 206c   and values of l
-000019a0: 6f63 616c 206d 6178 696d 6120 696e 2073  ocal maxima in s
-000019b0: 6563 6f6e 6420 636f 6c75 6d6e 0a0a 2020  econd column..  
-000019c0: 2020 2020 2020 3a65 7861 6d70 6c65 3a0a        :example:.
-000019d0: 2020 2020 2020 2020 3e3e 3e20 6461 7461          >>> data
-000019e0: 203d 206e 702e 6172 7261 7928 5b33 2e39   = np.array([3.9
-000019f0: 2c20 372e 352c 2020 342e 322c 2036 2e32  , 7.5,  4.2, 6.2
-00001a00: 2c20 372e 352c 2033 2e39 2c20 362e 322c  , 7.5, 3.9, 6.2,
-00001a10: 2036 2e35 2c20 372e 322c 2039 2e35 5d29   6.5, 7.2, 9.5])
-00001a20: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
-00001a30: 3332 290a 2020 2020 2020 2020 3e3e 3e20  32).        >>> 
-00001a40: 5469 6d65 7365 7269 6573 4665 6174 7572  TimeseriesFeatur
-00001a50: 654d 6978 696e 2829 2e6c 6f63 616c 5f6d  eMixin().local_m
-00001a60: 6178 696d 615f 6d69 6e69 6d61 2864 6174  axima_minima(dat
-00001a70: 613d 6461 7461 2c20 6d61 7869 6d61 3d54  a=data, maxima=T
-00001a80: 7275 6529 0a20 2020 2020 2020 203e 3e3e  rue).        >>>
-00001a90: 205b 5b31 2c20 372e 355d 2c20 5b34 2c20   [[1, 7.5], [4, 
-00001aa0: 372e 355d 2c20 5b39 2c20 392e 355d 5d0a  7.5], [9, 9.5]].
-00001ab0: 2020 2020 2020 2020 3e3e 3e20 5469 6d65          >>> Time
-00001ac0: 7365 7269 6573 4665 6174 7572 654d 6978  seriesFeatureMix
-00001ad0: 696e 2829 2e6c 6f63 616c 5f6d 6178 696d  in().local_maxim
-00001ae0: 615f 6d69 6e69 6d61 2864 6174 613d 6461  a_minima(data=da
-00001af0: 7461 2c20 6d61 7869 6d61 3d46 616c 7365  ta, maxima=False
-00001b00: 290a 2020 2020 2020 2020 3e3e 3e20 5b5b  ).        >>> [[
-00001b10: 302c 2033 2e39 5d2c 205b 322c 2034 2e32  0, 3.9], [2, 4.2
-00001b20: 5d2c 205b 352c 2033 2e39 5d5d 0a0a 2020  ], [5, 3.9]]..  
-00001b30: 2020 2020 2020 2e2e 2069 6d61 6765 3a3a        .. image::
-00001b40: 205f 7374 6174 6963 2f69 6d67 2f6c 6f63   _static/img/loc
-00001b50: 616c 5f6d 6178 696d 615f 6d69 6e69 6d61  al_maxima_minima
-00001b60: 2e70 6e67 0a20 2020 2020 2020 2020 2020  .png.           
-00001b70: 3a77 6964 7468 3a20 3630 300a 2020 2020  :width: 600.    
-00001b80: 2020 2020 2020 203a 616c 6967 6e3a 2063         :align: c
-00001b90: 656e 7465 720a 0a20 2020 2020 2020 2022  enter..        "
-00001ba0: 2222 0a20 2020 2020 2020 2069 6620 6e6f  "".        if no
-00001bb0: 7420 6d61 7869 6d61 3a0a 2020 2020 2020  t maxima:.      
-00001bc0: 2020 2020 2020 6461 7461 203d 202d 6461        data = -da
-00001bd0: 7461 0a20 2020 2020 2020 2072 6573 756c  ta.        resul
-00001be0: 7473 203d 206e 702e 6675 6c6c 2828 6461  ts = np.full((da
-00001bf0: 7461 2e73 6861 7065 5b30 5d2c 2032 292c  ta.shape[0], 2),
-00001c00: 202d 312e 3029 0a20 2020 2020 2020 2069   -1.0).        i
-00001c10: 6620 6461 7461 5b30 5d20 3e3d 2064 6174  f data[0] >= dat
-00001c20: 615b 315d 3a0a 2020 2020 2020 2020 2020  a[1]:.          
-00001c30: 2020 6966 206e 6f74 206d 6178 696d 613a    if not maxima:
-00001c40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001c50: 2072 6573 756c 7473 5b30 2c20 3a5d 203d   results[0, :] =
-00001c60: 206e 702e 6172 7261 7928 5b30 2c20 2d64   np.array([0, -d
-00001c70: 6174 615b 305d 5d29 0a20 2020 2020 2020  ata[0]]).       
-00001c80: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00001c90: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-00001ca0: 7473 5b30 2c20 3a5d 203d 206e 702e 6172  ts[0, :] = np.ar
-00001cb0: 7261 7928 5b30 2c20 6461 7461 5b30 5d5d  ray([0, data[0]]
-00001cc0: 290a 2020 2020 2020 2020 6966 2064 6174  ).        if dat
-00001cd0: 615b 2d31 5d20 3e3d 2064 6174 615b 2d32  a[-1] >= data[-2
-00001ce0: 5d3a 0a20 2020 2020 2020 2020 2020 2069  ]:.            i
-00001cf0: 6620 6e6f 7420 6d61 7869 6d61 3a0a 2020  f not maxima:.  
-00001d00: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00001d10: 7375 6c74 735b 2d31 2c20 3a5d 203d 206e  sults[-1, :] = n
-00001d20: 702e 6172 7261 7928 5b64 6174 612e 7368  p.array([data.sh
-00001d30: 6170 655b 305d 202d 2031 2c20 2d64 6174  ape[0] - 1, -dat
-00001d40: 615b 2d31 5d5d 290a 2020 2020 2020 2020  a[-1]]).        
-00001d50: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00001d60: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-00001d70: 735b 2d31 2c20 3a5d 203d 206e 702e 6172  s[-1, :] = np.ar
-00001d80: 7261 7928 5b64 6174 612e 7368 6170 655b  ray([data.shape[
-00001d90: 305d 202d 2031 2c20 6461 7461 5b2d 315d  0] - 1, data[-1]
-00001da0: 5d29 0a20 2020 2020 2020 2066 6f72 2069  ]).        for i
-00001db0: 2069 6e20 7072 616e 6765 2831 2c20 6461   in prange(1, da
-00001dc0: 7461 2e73 6861 7065 5b30 5d20 2d20 3129  ta.shape[0] - 1)
-00001dd0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00001de0: 2064 6174 615b 6920 2d20 315d 203c 2064   data[i - 1] < d
-00001df0: 6174 615b 695d 203e 2064 6174 615b 6920  ata[i] > data[i 
-00001e00: 2b20 315d 3a0a 2020 2020 2020 2020 2020  + 1]:.          
-00001e10: 2020 2020 2020 6966 206e 6f74 206d 6178        if not max
-00001e20: 696d 613a 0a20 2020 2020 2020 2020 2020  ima:.           
-00001e30: 2020 2020 2020 2020 2072 6573 756c 7473           results
-00001e40: 5b69 2c20 3a5d 203d 206e 702e 6172 7261  [i, :] = np.arra
-00001e50: 7928 5b69 2c20 2d64 6174 615b 695d 5d29  y([i, -data[i]])
-00001e60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001e70: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00001e80: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-00001e90: 7473 5b69 2c20 3a5d 203d 206e 702e 6172  ts[i, :] = np.ar
-00001ea0: 7261 7928 5b69 2c20 6461 7461 5b69 5d5d  ray([i, data[i]]
-00001eb0: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-00001ec0: 6e20 7265 7375 6c74 735b 6e70 2e61 7267  n results[np.arg
-00001ed0: 7768 6572 6528 7265 7375 6c74 735b 3a2c  where(results[:,
-00001ee0: 2030 5d2e 5420 213d 202d 3129 2e66 6c61   0].T != -1).fla
-00001ef0: 7474 656e 2829 5d2e 6173 7479 7065 286e  tten()].astype(n
-00001f00: 702e 666c 6f61 7433 3229 0a0a 2020 2020  p.float32)..    
-00001f10: 4073 7461 7469 636d 6574 686f 640a 2020  @staticmethod.  
-00001f20: 2020 406e 6a69 7428 2228 666c 6f61 7433    @njit("(float3
-00001f30: 325b 3a5d 2c20 666c 6f61 7436 3429 2229  2[:], float64)")
-00001f40: 0a20 2020 2064 6566 2063 726f 7373 696e  .    def crossin
-00001f50: 6773 2864 6174 613a 206e 702e 6e64 6172  gs(data: np.ndar
-00001f60: 7261 792c 2076 616c 3a20 666c 6f61 7429  ray, val: float)
-00001f70: 202d 3e20 696e 743a 0a20 2020 2020 2020   -> int:.       
-00001f80: 2022 2222 0a20 2020 2020 2020 204a 6974   """.        Jit
-00001f90: 7465 6420 636f 6d70 7574 6520 6f66 2074  ted compute of t
-00001fa0: 6865 2063 6f75 6e74 2069 6e20 7469 6d65  he count in time
-00001fb0: 2d73 6572 6965 7320 7768 6572 6520 7365  -series where se
-00001fc0: 7175 656e 7469 616c 2076 616c 7565 7320  quential values 
-00001fd0: 6372 6f73 7365 7320 6120 6465 6669 6e65  crosses a define
-00001fe0: 6420 7661 6c75 652e 0a0a 0a20 2020 2020  d value....     
-00001ff0: 2020 202e 2e20 696d 6167 653a 3a20 5f73     .. image:: _s
-00002000: 7461 7469 632f 696d 672f 6372 6f73 7369  tatic/img/crossi
-00002010: 6e67 732e 706e 670a 2020 2020 2020 2020  ngs.png.        
-00002020: 2020 203a 7769 6474 683a 2036 3030 0a20     :width: 600. 
-00002030: 2020 2020 2020 2020 2020 3a61 6c69 676e            :align
-00002040: 3a20 6365 6e74 6572 0a0a 2020 2020 2020  : center..      
-00002050: 2020 3a70 6172 616d 206e 702e 6e64 6172    :param np.ndar
-00002060: 7261 7920 6461 7461 3a20 5469 6d65 2d73  ray data: Time-s
-00002070: 6572 6965 7320 6461 7461 2e0a 2020 2020  eries data..    
-00002080: 2020 2020 3a70 6172 616d 2066 6c6f 6174      :param float
-00002090: 2076 616c 3a20 4372 6f73 7320 7661 6c75   val: Cross valu
-000020a0: 652e 2045 2e67 2e2c 2074 6f20 636f 756e  e. E.g., to coun
-000020b0: 7420 7468 6520 6e75 6d62 6572 206f 6620  t the number of 
-000020c0: 7a65 726f 2d63 726f 7373 696e 6773 2c20  zero-crossings, 
-000020d0: 7061 7373 2060 3060 2e0a 2020 2020 2020  pass `0`..      
-000020e0: 2020 3a72 6574 7572 6e20 696e 743a 2043    :return int: C
-000020f0: 6f75 6e74 206f 6620 6576 656e 7473 2077  ount of events w
-00002100: 6865 7265 2073 6571 7565 6e74 6961 6c20  here sequential 
-00002110: 7661 6c75 6573 2063 726f 7373 6573 2060  values crosses `
-00002120: 6076 616c 6060 2e0a 0a20 2020 2020 2020  `val``...       
-00002130: 203a 6578 616d 706c 653a 0a20 2020 2020   :example:.     
-00002140: 2020 203e 3e3e 2064 6174 6120 3d20 6e70     >>> data = np
-00002150: 2e61 7272 6179 285b 332e 392c 2037 2e35  .array([3.9, 7.5
-00002160: 2c20 2034 2e32 2c20 362e 322c 2037 2e35  ,  4.2, 6.2, 7.5
-00002170: 2c20 332e 392c 2036 2e32 2c20 362e 352c  , 3.9, 6.2, 6.5,
-00002180: 2037 2e32 2c20 392e 355d 292e 6173 7479   7.2, 9.5]).asty
-00002190: 7065 286e 702e 666c 6f61 7433 3229 0a20  pe(np.float32). 
-000021a0: 2020 2020 2020 203e 3e3e 2054 696d 6573         >>> Times
-000021b0: 6572 6965 7346 6561 7475 7265 4d69 7869  eriesFeatureMixi
-000021c0: 6e28 292e 6372 6f73 7369 6e67 7328 6461  n().crossings(da
-000021d0: 7461 3d64 6174 612c 2076 616c 3d37 290a  ta=data, val=7).
-000021e0: 2020 2020 2020 2020 3e3e 3e20 350a 2020          >>> 5.  
-000021f0: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-00002200: 2020 2063 6e74 2c20 6c61 7374 5f76 616c     cnt, last_val
-00002210: 203d 2030 2c20 2d31 0a20 2020 2020 2020   = 0, -1.       
-00002220: 2069 6620 6461 7461 5b30 5d20 3e20 7661   if data[0] > va
-00002230: 6c3a 0a20 2020 2020 2020 2020 2020 206c  l:.            l
-00002240: 6173 745f 7661 6c20 3d20 310a 2020 2020  ast_val = 1.    
-00002250: 2020 2020 666f 7220 6920 696e 2070 7261      for i in pra
-00002260: 6e67 6528 312c 2064 6174 612e 7368 6170  nge(1, data.shap
-00002270: 655b 305d 293a 0a20 2020 2020 2020 2020  e[0]):.         
-00002280: 2020 2063 7572 7265 6e74 5f76 616c 203d     current_val =
-00002290: 202d 310a 2020 2020 2020 2020 2020 2020   -1.            
-000022a0: 6966 2064 6174 615b 695d 203e 2076 616c  if data[i] > val
-000022b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000022c0: 2020 6375 7272 656e 745f 7661 6c20 3d20    current_val = 
-000022d0: 310a 2020 2020 2020 2020 2020 2020 6966  1.            if
-000022e0: 206c 6173 745f 7661 6c20 213d 2063 7572   last_val != cur
-000022f0: 7265 6e74 5f76 616c 3a0a 2020 2020 2020  rent_val:.      
-00002300: 2020 2020 2020 2020 2020 636e 7420 2b3d            cnt +=
-00002310: 2031 0a20 2020 2020 2020 2020 2020 206c   1.            l
-00002320: 6173 745f 7661 6c20 3d20 6375 7272 656e  ast_val = curren
-00002330: 745f 7661 6c0a 0a20 2020 2020 2020 2072  t_val..        r
-00002340: 6574 7572 6e20 636e 740a 0a20 2020 2040  eturn cnt..    @
-00002350: 7374 6174 6963 6d65 7468 6f64 0a20 2020  staticmethod.   
-00002360: 2040 6e6a 6974 2822 2866 6c6f 6174 3332   @njit("(float32
-00002370: 5b3a 5d2c 2066 6c6f 6174 3634 2c20 2066  [:], float64,  f
-00002380: 6c6f 6174 3634 5b3a 5d2c 2069 6e74 3634  loat64[:], int64
-00002390: 2c29 2229 0a20 2020 2064 6566 2073 6c69  ,)").    def sli
-000023a0: 6469 6e67 5f63 726f 7373 696e 6773 280a  ding_crossings(.
-000023b0: 2020 2020 2020 2020 6461 7461 3a20 6e70          data: np
-000023c0: 2e6e 6461 7272 6179 2c20 7661 6c3a 2066  .ndarray, val: f
-000023d0: 6c6f 6174 2c20 7469 6d65 5f77 696e 646f  loat, time_windo
-000023e0: 7773 3a20 6e70 2e6e 6461 7272 6179 2c20  ws: np.ndarray, 
-000023f0: 6670 733a 2069 6e74 0a20 2020 2029 202d  fps: int.    ) -
-00002400: 3e20 6e70 2e6e 6461 7272 6179 3a0a 2020  > np.ndarray:.  
-00002410: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00002420: 2020 436f 6d70 7574 6520 7468 6520 6e75    Compute the nu
-00002430: 6d62 6572 206f 6620 6372 6f73 7369 6e67  mber of crossing
-00002440: 7320 6f76 6572 2073 6c69 6469 6e67 2077  s over sliding w
-00002450: 696e 646f 7773 2069 6e20 6120 6461 7461  indows in a data
-00002460: 2061 7272 6179 2e0a 0a20 2020 2020 2020   array...       
-00002470: 2043 6f6d 7075 7465 7320 7468 6520 6e75   Computes the nu
-00002480: 6d62 6572 206f 6620 7469 6d65 7320 6120  mber of times a 
-00002490: 7661 6c75 6520 696e 2074 6865 2064 6174  value in the dat
-000024a0: 6120 6172 7261 7920 6372 6f73 7365 7320  a array crosses 
-000024b0: 6120 6769 7665 6e20 7468 7265 7368 6f6c  a given threshol
-000024c0: 640a 2020 2020 2020 2020 7661 6c75 6520  d.        value 
-000024d0: 7769 7468 696e 2073 6c69 6469 6e67 2077  within sliding w
-000024e0: 696e 646f 7773 206f 6620 7661 7279 696e  indows of varyin
-000024f0: 6720 7369 7a65 732e 2054 6865 206e 756d  g sizes. The num
-00002500: 6265 7220 6f66 2063 726f 7373 696e 6773  ber of crossings
-00002510: 2069 7320 636f 6d70 7574 6564 2066 6f72   is computed for
-00002520: 2065 6163 680a 2020 2020 2020 2020 7769   each.        wi
-00002530: 6e64 6f77 2073 697a 6520 616e 6420 7374  ndow size and st
-00002540: 6f72 6564 2069 6e20 7468 6520 7265 7375  ored in the resu
-00002550: 6c74 2061 7272 6179 2077 6865 7265 2063  lt array where c
-00002560: 6f6c 756d 6e73 2072 6570 7265 7365 6e74  olumns represent
-00002570: 7320 7469 6d65 2077 696e 646f 7773 2e0a  s time windows..
-00002580: 0a20 2020 2020 2020 202e 2e20 6e6f 7465  .        .. note
-00002590: 3a3a 0a20 2020 2020 2020 2020 2020 466f  ::.           Fo
-000025a0: 7220 6672 616d 6573 206f 6363 7572 7269  r frames occurri
-000025b0: 6e67 2062 6566 6f72 6520 6120 636f 6d70  ng before a comp
-000025c0: 6c65 7465 2074 696d 6520 7769 6e64 6f77  lete time window
-000025d0: 2c20 2d31 2e30 2069 7320 7265 7475 726e  , -1.0 is return
-000025e0: 6564 2e0a 0a20 2020 2020 2020 202e 2e20  ed...        .. 
-000025f0: 696d 6167 653a 3a20 5f73 7461 7469 632f  image:: _static/
-00002600: 696d 672f 736c 6964 696e 675f 6372 6f73  img/sliding_cros
-00002610: 7369 6e67 732e 706e 670a 2020 2020 2020  sings.png.      
-00002620: 2020 2020 203a 7769 6474 683a 2031 3530       :width: 150
-00002630: 300a 2020 2020 2020 2020 2020 203a 616c  0.           :al
-00002640: 6967 6e3a 2063 656e 7465 720a 0a20 2020  ign: center..   
-00002650: 2020 2020 203a 7061 7261 6d20 6e70 2e6e       :param np.n
-00002660: 6461 7272 6179 2064 6174 613a 2049 6e70  darray data: Inp
-00002670: 7574 2064 6174 6120 6172 7261 792e 0a20  ut data array.. 
-00002680: 2020 2020 2020 203a 7061 7261 6d20 666c         :param fl
-00002690: 6f61 7420 7661 6c3a 2054 6872 6573 686f  oat val: Thresho
-000026a0: 6c64 2076 616c 7565 2066 6f72 2063 726f  ld value for cro
-000026b0: 7373 696e 6773 2e0a 2020 2020 2020 2020  ssings..        
-000026c0: 3a70 6172 616d 206e 702e 6e64 6172 7261  :param np.ndarra
-000026d0: 7920 7469 6d65 5f77 696e 646f 7773 3a20  y time_windows: 
-000026e0: 4172 7261 7920 6f66 2077 696e 646f 7720  Array of window 
-000026f0: 7369 7a65 7320 2869 6e20 7365 636f 6e64  sizes (in second
-00002700: 7329 2e0a 2020 2020 2020 2020 3a70 6172  s)..        :par
-00002710: 616d 2069 6e74 2073 616d 706c 655f 7261  am int sample_ra
-00002720: 7465 3a20 5361 6d70 6c69 6e67 2072 6174  te: Sampling rat
-00002730: 6520 6f66 2074 6865 2064 6174 6120 696e  e of the data in
-00002740: 2073 616d 706c 6573 2070 6572 2073 6563   samples per sec
-00002750: 6f6e 642e 0a20 2020 2020 2020 203a 7265  ond..        :re
-00002760: 7475 726e 206e 702e 6e64 6172 7261 793a  turn np.ndarray:
-00002770: 2041 6e20 6172 7261 7920 636f 6e74 6169   An array contai
-00002780: 6e69 6e67 2074 6865 206e 756d 6265 7220  ning the number 
-00002790: 6f66 2063 726f 7373 696e 6773 2066 6f72  of crossings for
-000027a0: 2065 6163 6820 7769 6e64 6f77 2073 697a   each window siz
-000027b0: 6520 616e 6420 6461 7461 2070 6f69 6e74  e and data point
-000027c0: 2e20 5468 6520 7368 6170 6520 6f66 2074  . The shape of t
-000027d0: 6865 2072 6573 756c 7420 6172 7261 7920  he result array 
-000027e0: 6973 2028 6461 7461 2e73 6861 7065 5b30  is (data.shape[0
-000027f0: 5d2c 2077 696e 646f 775f 7369 7a65 732e  ], window_sizes.
-00002800: 7368 6170 655b 305d 292e 0a0a 2020 2020  shape[0])...    
-00002810: 2020 2020 3a65 7861 6d70 6c65 3a0a 2020      :example:.  
-00002820: 2020 2020 2020 3e3e 3e20 6461 7461 203d        >>> data =
-00002830: 206e 702e 6172 7261 7928 5b33 2e39 2c20   np.array([3.9, 
-00002840: 372e 352c 2020 342e 322c 2036 2e32 2c20  7.5,  4.2, 6.2, 
-00002850: 372e 352c 2033 2e39 2c20 362e 322c 2036  7.5, 3.9, 6.2, 6
-00002860: 2e35 2c20 372e 322c 2039 2e35 5d29 2e61  .5, 7.2, 9.5]).a
-00002870: 7374 7970 6528 6e70 2e66 6c6f 6174 3332  stype(np.float32
-00002880: 290a 2020 2020 2020 2020 3e3e 3e20 7265  ).        >>> re
-00002890: 7375 6c74 7320 3d20 5469 6d65 7365 7269  sults = Timeseri
-000028a0: 6573 4665 6174 7572 654d 6978 696e 2829  esFeatureMixin()
-000028b0: 2e73 6c69 6469 6e67 5f63 726f 7373 696e  .sliding_crossin
-000028c0: 6773 2864 6174 613d 6461 7461 2c20 7469  gs(data=data, ti
-000028d0: 6d65 5f77 696e 646f 7773 3d6e 702e 6172  me_windows=np.ar
-000028e0: 7261 7928 5b31 2e30 5d29 2c20 6670 733d  ray([1.0]), fps=
-000028f0: 322e 302c 2076 616c 3d37 2e30 290a 2020  2.0, val=7.0).  
-00002900: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-00002910: 2020 2072 6573 756c 7473 203d 206e 702e     results = np.
-00002920: 6675 6c6c 2828 6461 7461 2e73 6861 7065  full((data.shape
-00002930: 5b30 5d2c 2074 696d 655f 7769 6e64 6f77  [0], time_window
-00002940: 732e 7368 6170 655b 305d 292c 202d 312e  s.shape[0]), -1.
-00002950: 3029 0a20 2020 2020 2020 2066 6f72 2069  0).        for i
-00002960: 2069 6e20 7072 616e 6765 2874 696d 655f   in prange(time_
-00002970: 7769 6e64 6f77 732e 7368 6170 655b 305d  windows.shape[0]
-00002980: 293a 0a20 2020 2020 2020 2020 2020 2077  ):.            w
-00002990: 696e 646f 775f 7369 7a65 203d 2069 6e74  indow_size = int
-000029a0: 2874 696d 655f 7769 6e64 6f77 735b 695d  (time_windows[i]
-000029b0: 202a 2066 7073 290a 2020 2020 2020 2020   * fps).        
-000029c0: 2020 2020 666f 7220 6c2c 2072 2069 6e20      for l, r in 
-000029d0: 7a69 7028 0a20 2020 2020 2020 2020 2020  zip(.           
-000029e0: 2020 2020 2070 7261 6e67 6528 302c 2064       prange(0, d
-000029f0: 6174 612e 7368 6170 655b 305d 202b 2031  ata.shape[0] + 1
-00002a00: 292c 2070 7261 6e67 6528 7769 6e64 6f77  ), prange(window
-00002a10: 5f73 697a 652c 2064 6174 612e 7368 6170  _size, data.shap
-00002a20: 655b 305d 202b 2031 290a 2020 2020 2020  e[0] + 1).      
-00002a30: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
-00002a40: 2020 2020 2020 2020 2073 616d 706c 6520           sample 
-00002a50: 3d20 6461 7461 5b6c 3a72 5d0a 2020 2020  = data[l:r].    
-00002a60: 2020 2020 2020 2020 2020 2020 636e 742c              cnt,
-00002a70: 206c 6173 745f 7661 6c20 3d20 302c 202d   last_val = 0, -
-00002a80: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
-00002a90: 2020 6966 2073 616d 706c 655b 305d 203e    if sample[0] >
-00002aa0: 2076 616c 3a0a 2020 2020 2020 2020 2020   val:.          
-00002ab0: 2020 2020 2020 2020 2020 6c61 7374 5f76            last_v
-00002ac0: 616c 203d 2031 0a20 2020 2020 2020 2020  al = 1.         
-00002ad0: 2020 2020 2020 2066 6f72 206a 2069 6e20         for j in 
-00002ae0: 7072 616e 6765 2831 2c20 7361 6d70 6c65  prange(1, sample
-00002af0: 2e73 6861 7065 5b30 5d29 3a0a 2020 2020  .shape[0]):.    
-00002b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002b10: 6375 7272 656e 745f 7661 6c20 3d20 2d31  current_val = -1
-00002b20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002b30: 2020 2020 2069 6620 7361 6d70 6c65 5b6a       if sample[j
-00002b40: 5d20 3e20 7661 6c3a 0a20 2020 2020 2020  ] > val:.       
-00002b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002b60: 2063 7572 7265 6e74 5f76 616c 203d 2031   current_val = 1
-00002b70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002b80: 2020 2020 2069 6620 6c61 7374 5f76 616c       if last_val
-00002b90: 2021 3d20 6375 7272 656e 745f 7661 6c3a   != current_val:
-00002ba0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002bb0: 2020 2020 2020 2020 2063 6e74 202b 3d20           cnt += 
-00002bc0: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
-00002bd0: 2020 2020 2020 6c61 7374 5f76 616c 203d        last_val =
-00002be0: 2063 7572 7265 6e74 5f76 616c 0a20 2020   current_val.   
-00002bf0: 2020 2020 2020 2020 2020 2020 2072 6573               res
-00002c00: 756c 7473 5b72 202d 2031 2c20 695d 203d  ults[r - 1, i] =
-00002c10: 2063 6e74 0a0a 2020 2020 2020 2020 7265   cnt..        re
-00002c20: 7475 726e 2072 6573 756c 7473 2e61 7374  turn results.ast
-00002c30: 7970 6528 6e70 2e69 6e74 3332 290a 0a20  ype(np.int32).. 
-00002c40: 2020 2040 7374 6174 6963 6d65 7468 6f64     @staticmethod
-00002c50: 0a20 2020 2040 6e6a 6974 2822 2866 6c6f  .    @njit("(flo
-00002c60: 6174 3332 5b3a 5d2c 2069 6e74 3634 2c20  at32[:], int64, 
-00002c70: 696e 7436 342c 2029 222c 2063 6163 6865  int64, )", cache
-00002c80: 3d54 7275 652c 2066 6173 746d 6174 683d  =True, fastmath=
-00002c90: 5472 7565 290a 2020 2020 6465 6620 7065  True).    def pe
-00002ca0: 7263 656e 7469 6c65 5f64 6966 6665 7265  rcentile_differe
-00002cb0: 6e63 6528 0a20 2020 2020 2020 2064 6174  nce(.        dat
-00002cc0: 613a 206e 702e 6e64 6172 7261 792c 2075  a: np.ndarray, u
-00002cd0: 7070 6572 5f70 6374 3a20 696e 742c 206c  pper_pct: int, l
-00002ce0: 6f77 6572 5f70 6374 3a20 696e 740a 2020  ower_pct: int.  
-00002cf0: 2020 2920 2d3e 2066 6c6f 6174 3a0a 2020    ) -> float:.  
-00002d00: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00002d10: 2020 4a69 7474 6564 2063 6f6d 7075 7465    Jitted compute
-00002d20: 206f 6620 7468 6520 6469 6666 6572 656e   of the differen
-00002d30: 6365 2062 6574 7765 656e 2074 6865 2060  ce between the `
-00002d40: 6075 7070 6572 6060 2061 6e64 2060 606c  `upper`` and ``l
-00002d50: 6f77 6572 6060 2070 6572 6365 6e74 696c  ower`` percentil
-00002d60: 6573 206f 6620 7468 6520 6461 7461 2061  es of the data a
-00002d70: 730a 2020 2020 2020 2020 6120 7065 7263  s.        a perc
-00002d80: 656e 7461 6765 206f 6620 7468 6520 6d65  entage of the me
-00002d90: 6469 616e 2076 616c 7565 2e20 4865 6c70  dian value. Help
-00002da0: 7320 756e 6465 7273 7461 6e64 696e 6720  s understanding 
-00002db0: 7468 6520 7370 7265 6164 206f 7220 7661  the spread or va
-00002dc0: 7269 6162 696c 6974 7920 6f66 2074 6865  riability of the
-00002dd0: 2064 6174 6120 7769 7468 696e 2073 7065   data within spe
-00002de0: 6369 6669 6564 2070 6572 6365 6e74 696c  cified percentil
-00002df0: 6573 2e0a 0a20 2020 2020 2020 202e 2e20  es...        .. 
-00002e00: 6e6f 7465 3a3a 0a20 2020 2020 2020 2020  note::.         
-00002e10: 2020 4164 6170 7465 6420 6672 6f6d 2060    Adapted from `
-00002e20: 6365 7369 756d 203c 6874 7470 733a 2f2f  cesium <https://
-00002e30: 6769 7468 7562 2e63 6f6d 2f63 6573 6975  github.com/cesiu
-00002e40: 6d2d 6d6c 2f63 6573 6975 6d3e 605f 2e0a  m-ml/cesium>`_..
-00002e50: 0a20 2020 2020 2020 202e 2e20 696d 6167  .        .. imag
-00002e60: 653a 3a20 5f73 7461 7469 632f 696d 672f  e:: _static/img/
-00002e70: 7065 7263 656e 7469 6c65 5f64 6966 6665  percentile_diffe
-00002e80: 7265 6e63 652e 706e 670a 2020 2020 2020  rence.png.      
-00002e90: 2020 2020 203a 7769 6474 683a 2036 3030       :width: 600
-00002ea0: 0a20 2020 2020 2020 2020 2020 3a61 6c69  .           :ali
-00002eb0: 676e 3a20 6365 6e74 6572 0a0a 2020 2020  gn: center..    
-00002ec0: 2020 2020 3a70 6172 616d 6574 6572 206e      :parameter n
-00002ed0: 702e 6e64 6172 7261 7920 6461 7461 3a20  p.ndarray data: 
-00002ee0: 3144 2061 7272 6179 206f 6620 7265 7072  1D array of repr
-00002ef0: 6573 656e 7469 6e67 2074 696d 652d 7365  esenting time-se
-00002f00: 7269 6573 2e0a 2020 2020 2020 2020 3a70  ries..        :p
-00002f10: 6172 616d 6574 6572 2069 6e74 2075 7070  arameter int upp
-00002f20: 6572 5f70 6374 3a20 5570 7065 722d 626f  er_pct: Upper-bo
-00002f30: 756e 6461 7279 2070 6572 6365 6e74 696c  undary percentil
-00002f40: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
-00002f50: 6d65 7465 7220 696e 7420 6c6f 7765 725f  meter int lower_
-00002f60: 7063 743a 204c 6f77 6572 2d62 6f75 6e64  pct: Lower-bound
-00002f70: 6172 7920 7065 7263 656e 7469 6c65 2e0a  ary percentile..
-00002f80: 2020 2020 2020 2020 3a72 6574 7572 6e73          :returns
-00002f90: 2066 6c6f 6174 3a20 5468 6520 6469 6666   float: The diff
-00002fa0: 6572 656e 6365 2062 6574 7765 656e 2074  erence between t
-00002fb0: 6865 2060 6075 7070 6572 6060 2061 6e64  he ``upper`` and
-00002fc0: 2060 606c 6f77 6572 6060 2070 6572 6365   ``lower`` perce
-00002fd0: 6e74 696c 6573 206f 6620 7468 6520 6461  ntiles of the da
-00002fe0: 7461 2061 7320 6120 7065 7263 656e 7461  ta as a percenta
-00002ff0: 6765 206f 6620 7468 6520 6d65 6469 616e  ge of the median
-00003000: 2076 616c 7565 2e0a 0a20 2020 2020 2020   value...       
-00003010: 203a 6578 616d 706c 6573 3a0a 2020 2020   :examples:.    
-00003020: 2020 2020 3e3e 3e20 6461 7461 203d 206e      >>> data = n
-00003030: 702e 6172 7261 7928 5b33 2e39 2c20 372e  p.array([3.9, 7.
-00003040: 352c 2020 342e 322c 2036 2e32 2c20 372e  5,  4.2, 6.2, 7.
-00003050: 352c 2033 2e39 2c20 362e 322c 2036 2e35  5, 3.9, 6.2, 6.5
-00003060: 2c20 372e 322c 2039 2e35 5d29 2e61 7374  , 7.2, 9.5]).ast
-00003070: 7970 6528 6e70 2e66 6c6f 6174 3332 290a  ype(np.float32).
-00003080: 2020 2020 2020 2020 3e3e 3e20 5469 6d65          >>> Time
-00003090: 7365 7269 6573 4665 6174 7572 654d 6978  seriesFeatureMix
-000030a0: 696e 2829 2e70 6572 6365 6e74 696c 655f  in().percentile_
-000030b0: 6469 6666 6572 656e 6365 2864 6174 613d  difference(data=
-000030c0: 6461 7461 2c20 7570 7065 725f 7063 743d  data, upper_pct=
-000030d0: 3935 2c20 6c6f 7765 725f 7063 743d 3529  95, lower_pct=5)
-000030e0: 0a20 2020 2020 2020 203e 3e3e 2030 2e37  .        >>> 0.7
-000030f0: 3430 3135 3734 3736 3431 3235 3137 370a  401574764125177.
-00003100: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00003110: 2020 2020 2075 7070 6572 5f76 616c 2c20       upper_val, 
-00003120: 6c6f 7765 725f 7661 6c20 3d20 6e70 2e70  lower_val = np.p
-00003130: 6572 6365 6e74 696c 6528 6461 7461 2c20  ercentile(data, 
-00003140: 7570 7065 725f 7063 7429 2c20 6e70 2e70  upper_pct), np.p
-00003150: 6572 6365 6e74 696c 6528 0a20 2020 2020  ercentile(.     
-00003160: 2020 2020 2020 2064 6174 612c 206c 6f77         data, low
-00003170: 6572 5f70 6374 0a20 2020 2020 2020 2029  er_pct.        )
-00003180: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00003190: 6e70 2e61 6273 2875 7070 6572 5f76 616c  np.abs(upper_val
-000031a0: 202d 206c 6f77 6572 5f76 616c 2920 2f20   - lower_val) / 
-000031b0: 6e70 2e6d 6564 6961 6e28 6461 7461 290a  np.median(data).
-000031c0: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
-000031d0: 6f64 0a20 2020 2040 6e6a 6974 2822 2866  od.    @njit("(f
-000031e0: 6c6f 6174 3332 5b3a 5d2c 2069 6e74 3634  loat32[:], int64
-000031f0: 2c20 696e 7436 342c 2066 6c6f 6174 3634  , int64, float64
-00003200: 5b3a 5d2c 2069 6e74 3634 2c20 2922 2c20  [:], int64, )", 
-00003210: 6361 6368 653d 5472 7565 2c20 6661 7374  cache=True, fast
-00003220: 6d61 7468 3d54 7275 6529 0a20 2020 2064  math=True).    d
-00003230: 6566 2073 6c69 6469 6e67 5f70 6572 6365  ef sliding_perce
-00003240: 6e74 696c 655f 6469 6666 6572 656e 6365  ntile_difference
-00003250: 280a 2020 2020 2020 2020 6461 7461 3a20  (.        data: 
-00003260: 6e70 2e6e 6461 7272 6179 2c0a 2020 2020  np.ndarray,.    
-00003270: 2020 2020 7570 7065 725f 7063 743a 2069      upper_pct: i
-00003280: 6e74 2c0a 2020 2020 2020 2020 6c6f 7765  nt,.        lowe
-00003290: 725f 7063 743a 2069 6e74 2c0a 2020 2020  r_pct: int,.    
-000032a0: 2020 2020 7769 6e64 6f77 5f73 697a 6573      window_sizes
-000032b0: 3a20 6e70 2e6e 6461 7272 6179 2c0a 2020  : np.ndarray,.  
-000032c0: 2020 2020 2020 6670 733a 2069 6e74 2c0a        fps: int,.
-000032d0: 2020 2020 2920 2d3e 206e 702e 6e64 6172      ) -> np.ndar
-000032e0: 7261 793a 0a20 2020 2020 2020 2022 2222  ray:.        """
-000032f0: 0a20 2020 2020 2020 204a 6974 7465 6420  .        Jitted 
-00003300: 636f 6d70 7574 6573 2074 6865 2064 6966  computes the dif
-00003310: 6665 7265 6e63 6520 6265 7477 6565 6e20  ference between 
-00003320: 7468 6520 7570 7065 7220 616e 6420 6c6f  the upper and lo
-00003330: 7765 7220 7065 7263 656e 7469 6c65 7320  wer percentiles 
-00003340: 7769 7468 696e 2061 2073 6c69 6469 6e67  within a sliding
-00003350: 2077 696e 646f 7720 666f 7220 6561 6368   window for each
-00003360: 2070 6f73 6974 696f 6e0a 2020 2020 2020   position.      
-00003370: 2020 696e 2074 6865 2074 696d 6520 7365    in the time se
-00003380: 7269 6573 2075 7369 6e67 2076 6172 696f  ries using vario
-00003390: 7573 2077 696e 646f 7720 7369 7a65 732e  us window sizes.
-000033a0: 2049 7420 7265 7475 726e 7320 6120 3244   It returns a 2D
-000033b0: 2061 7272 6179 2077 6865 7265 2065 6163   array where eac
-000033c0: 6820 726f 7720 636f 7272 6573 706f 6e64  h row correspond
-000033d0: 7320 746f 2061 2070 6f73 6974 696f 6e20  s to a position 
-000033e0: 696e 2074 6865 2074 696d 6520 7365 7269  in the time seri
-000033f0: 6573 2c0a 2020 2020 2020 2020 616e 6420  es,.        and 
-00003400: 6561 6368 2063 6f6c 756d 6e20 636f 7272  each column corr
-00003410: 6573 706f 6e64 7320 746f 2061 2064 6966  esponds to a dif
-00003420: 6665 7265 6e74 2077 696e 646f 7720 7369  ferent window si
-00003430: 7a65 2e20 5468 6520 7265 7375 6c74 7320  ze. The results 
-00003440: 6172 6520 6361 6c63 756c 6174 6564 2061  are calculated a
-00003450: 7320 7468 6520 6162 736f 6c75 7465 2064  s the absolute d
-00003460: 6966 6665 7265 6e63 6520 6265 7477 6565  ifference betwee
-00003470: 6e0a 2020 2020 2020 2020 7570 7065 7220  n.        upper 
-00003480: 616e 6420 6c6f 7765 7220 7065 7263 656e  and lower percen
-00003490: 7469 6c65 7320 6469 7669 6465 6420 6279  tiles divided by
-000034a0: 2074 6865 206d 6564 6961 6e20 6f66 2074   the median of t
-000034b0: 6865 2077 696e 646f 772e 0a0a 2020 2020  he window...    
-000034c0: 2020 2020 3a70 6172 616d 206e 702e 6e64      :param np.nd
-000034d0: 6172 7261 7920 6461 7461 3a20 5468 6520  array data: The 
-000034e0: 696e 7075 7420 7469 6d65 2073 6572 6965  input time serie
-000034f0: 7320 6461 7461 2e0a 2020 2020 2020 2020  s data..        
-00003500: 3a70 6172 616d 2069 6e74 2075 7070 6572  :param int upper
-00003510: 5f70 6374 3a20 5468 6520 7570 7065 7220  _pct: The upper 
-00003520: 7065 7263 656e 7469 6c65 2076 616c 7565  percentile value
-00003530: 2066 6f72 2074 6865 2077 696e 646f 7720   for the window 
-00003540: 2865 2e67 2e2c 2039 3520 666f 7220 7468  (e.g., 95 for th
-00003550: 6520 3935 7468 2070 6572 6365 6e74 696c  e 95th percentil
-00003560: 6529 2e0a 2020 2020 2020 2020 3a70 6172  e)..        :par
-00003570: 616d 2069 6e74 206c 6f77 6572 5f70 6374  am int lower_pct
-00003580: 3a20 5468 6520 6c6f 7765 7220 7065 7263  : The lower perc
-00003590: 656e 7469 6c65 2076 616c 7565 2066 6f72  entile value for
-000035a0: 2074 6865 2077 696e 646f 7720 2865 2e67   the window (e.g
-000035b0: 2e2c 2035 2066 6f72 2074 6865 2035 7468  ., 5 for the 5th
-000035c0: 2070 6572 6365 6e74 696c 6529 2e0a 2020   percentile)..  
-000035d0: 2020 2020 2020 3a70 6172 616d 206e 702e        :param np.
-000035e0: 6e64 6172 7261 7920 7769 6e64 6f77 5f73  ndarray window_s
-000035f0: 697a 6573 3a20 416e 2061 7272 6179 206f  izes: An array o
-00003600: 6620 7769 6e64 6f77 2073 697a 6573 2028  f window sizes (
-00003610: 696e 2073 6563 6f6e 6473 2920 746f 2075  in seconds) to u
-00003620: 7365 2066 6f72 2074 6865 2073 6c69 6469  se for the slidi
-00003630: 6e67 2063 616c 6375 6c61 7469 6f6e 2e0a  ng calculation..
-00003640: 2020 2020 2020 2020 3a70 6172 616d 2069          :param i
-00003650: 6e74 2073 616d 706c 655f 7261 7465 3a20  nt sample_rate: 
-00003660: 5468 6520 7361 6d70 6c69 6e67 2072 6174  The sampling rat
-00003670: 6520 2873 616d 706c 6573 2070 6572 2073  e (samples per s
-00003680: 6563 6f6e 6429 206f 6620 7468 6520 7469  econd) of the ti
-00003690: 6d65 2073 6572 6965 7320 6461 7461 2e0a  me series data..
-000036a0: 2020 2020 2020 2020 3a72 6574 7572 6e20          :return 
-000036b0: 6e70 2e6e 6461 7272 6179 3a20 4120 3244  np.ndarray: A 2D
-000036c0: 2061 7272 6179 2063 6f6e 7461 696e 696e   array containin
-000036d0: 6720 7468 6520 6469 6666 6572 656e 6365  g the difference
-000036e0: 2062 6574 7765 656e 2075 7070 6572 2061   between upper a
-000036f0: 6e64 206c 6f77 6572 2070 6572 6365 6e74  nd lower percent
-00003700: 696c 6573 2066 6f72 2065 6163 6820 7769  iles for each wi
-00003710: 6e64 6f77 2073 697a 652e 0a0a 2020 2020  ndow size...    
-00003720: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00003730: 7265 7375 6c74 7320 3d20 6e70 2e66 756c  results = np.ful
-00003740: 6c28 2864 6174 612e 7368 6170 655b 305d  l((data.shape[0]
-00003750: 2c20 7769 6e64 6f77 5f73 697a 6573 2e73  , window_sizes.s
-00003760: 6861 7065 5b30 5d29 2c20 2d31 2e30 290a  hape[0]), -1.0).
-00003770: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-00003780: 2070 7261 6e67 6528 7769 6e64 6f77 5f73   prange(window_s
-00003790: 697a 6573 2e73 6861 7065 5b30 5d29 3a0a  izes.shape[0]):.
-000037a0: 2020 2020 2020 2020 2020 2020 7769 6e64              wind
-000037b0: 6f77 5f73 697a 6520 3d20 696e 7428 7769  ow_size = int(wi
-000037c0: 6e64 6f77 5f73 697a 6573 5b69 5d20 2a20  ndow_sizes[i] * 
-000037d0: 6670 7329 0a20 2020 2020 2020 2020 2020  fps).           
-000037e0: 2066 6f72 206c 2c20 7220 696e 207a 6970   for l, r in zip
-000037f0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00003800: 2020 7072 616e 6765 2830 2c20 6461 7461    prange(0, data
-00003810: 2e73 6861 7065 5b30 5d20 2b20 3129 2c20  .shape[0] + 1), 
-00003820: 7072 616e 6765 2877 696e 646f 775f 7369  prange(window_si
-00003830: 7a65 2c20 6461 7461 2e73 6861 7065 5b30  ze, data.shape[0
-00003840: 5d20 2b20 3129 0a20 2020 2020 2020 2020  ] + 1).         
-00003850: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
-00003860: 2020 2020 2020 7361 6d70 6c65 203d 2064        sample = d
-00003870: 6174 615b 6c3a 725d 0a20 2020 2020 2020  ata[l:r].       
-00003880: 2020 2020 2020 2020 2075 7070 6572 5f76           upper_v
-00003890: 616c 2c20 6c6f 7765 725f 7661 6c20 3d20  al, lower_val = 
-000038a0: 6e70 2e70 6572 6365 6e74 696c 6528 7361  np.percentile(sa
-000038b0: 6d70 6c65 2c20 7570 7065 725f 7063 7429  mple, upper_pct)
-000038c0: 2c20 6e70 2e70 6572 6365 6e74 696c 6528  , np.percentile(
-000038d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000038e0: 2020 2020 2073 616d 706c 652c 206c 6f77       sample, low
-000038f0: 6572 5f70 6374 0a20 2020 2020 2020 2020  er_pct.         
-00003900: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00003910: 2020 2020 2020 2020 206d 6564 6961 6e20           median 
-00003920: 3d20 6e70 2e6d 6564 6961 6e28 7361 6d70  = np.median(samp
-00003930: 6c65 290a 2020 2020 2020 2020 2020 2020  le).            
-00003940: 2020 2020 6966 206d 6564 6961 6e20 213d      if median !=
-00003950: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-00003960: 2020 2020 2020 2020 7265 7375 6c74 735b          results[
-00003970: 7220 2d20 312c 2069 5d20 3d20 6e70 2e61  r - 1, i] = np.a
-00003980: 6273 2875 7070 6572 5f76 616c 202d 206c  bs(upper_val - l
-00003990: 6f77 6572 5f76 616c 2920 2f20 6d65 6469  ower_val) / medi
-000039a0: 616e 0a20 2020 2020 2020 2020 2020 2020  an.             
-000039b0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-000039c0: 2020 2020 2020 2020 2020 2020 2072 6573               res
-000039d0: 756c 7473 5b72 202d 2031 2c20 695d 203d  ults[r - 1, i] =
-000039e0: 202d 312e 300a 0a20 2020 2020 2020 2072   -1.0..        r
-000039f0: 6574 7572 6e20 7265 7375 6c74 732e 6173  eturn results.as
-00003a00: 7479 7065 286e 702e 666c 6f61 7433 3229  type(np.float32)
-00003a10: 0a0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
-00003a20: 686f 640a 2020 2020 406e 6a69 7428 2228  hod.    @njit("(
-00003a30: 666c 6f61 7436 345b 3a5d 2c20 666c 6f61  float64[:], floa
-00003a40: 7436 342c 2922 290a 2020 2020 6465 6620  t64,)").    def 
-00003a50: 7065 7263 656e 745f 6265 796f 6e64 5f6e  percent_beyond_n
-00003a60: 5f73 7464 2864 6174 613a 206e 702e 6e64  _std(data: np.nd
-00003a70: 6172 7261 792c 206e 3a20 666c 6f61 7429  array, n: float)
-00003a80: 202d 3e20 666c 6f61 743a 0a20 2020 2020   -> float:.     
-00003a90: 2020 2022 2222 0a20 2020 2020 2020 204a     """.        J
-00003aa0: 6974 7465 6420 636f 6d70 7574 6520 6f66  itted compute of
-00003ab0: 2074 6865 2072 6174 696f 206f 6620 7661   the ratio of va
-00003ac0: 6c75 6573 2069 6e20 7469 6d65 2d73 6572  lues in time-ser
-00003ad0: 6965 7320 6d6f 7265 2074 6861 6e20 4e20  ies more than N 
-00003ae0: 7374 616e 6461 7264 2064 6576 6961 7469  standard deviati
-00003af0: 6f6e 7320 6672 6f6d 2074 6865 206d 6561  ons from the mea
-00003b00: 6e20 6f66 2074 6865 2074 696d 652d 7365  n of the time-se
-00003b10: 7269 6573 2e0a 0a20 2020 2020 2020 203a  ries...        :
-00003b20: 7061 7261 6d65 7465 7220 6e70 2e6e 6461  parameter np.nda
-00003b30: 7272 6179 2064 6174 613a 2031 4420 6172  rray data: 1D ar
-00003b40: 7261 7920 7265 7072 6573 656e 7469 6e67  ray representing
-00003b50: 2074 696d 652d 7365 7269 6573 2e0a 2020   time-series..  
-00003b60: 2020 2020 2020 3a70 6172 616d 6574 6572        :parameter
-00003b70: 2066 6c6f 6174 206e 3a20 5374 616e 6461   float n: Standa
-00003b80: 7264 2064 6576 6961 7469 6f6e 2063 7574  rd deviation cut
-00003b90: 2d6f 6666 2e0a 2020 2020 2020 2020 3a72  -off..        :r
-00003ba0: 6574 7572 6e73 2066 6c6f 6174 3a20 5261  eturns float: Ra
-00003bb0: 7469 6f20 6f66 2076 616c 7565 7320 696e  tio of values in
-00003bc0: 2060 6064 6174 6160 6020 7468 6174 2066   ``data`` that f
-00003bd0: 616c 6c20 6d6f 7265 2074 6861 6e20 6060  all more than ``
-00003be0: 6e60 6020 7374 616e 6461 7264 2064 6576  n`` standard dev
-00003bf0: 6961 7469 6f6e 7320 6672 6f6d 206d 6561  iations from mea
-00003c00: 6e20 6f66 2060 6064 6174 6160 602e 0a0a  n of ``data``...
-00003c10: 2020 2020 2020 2020 2e2e 206e 6f74 653a          .. note:
-00003c20: 3a0a 2020 2020 2020 2020 2020 2041 6461  :.           Ada
-00003c30: 7074 6564 2066 726f 6d20 6063 6573 6975  pted from `cesiu
-00003c40: 6d20 3c68 7474 7073 3a2f 2f67 6974 6875  m <https://githu
-00003c50: 622e 636f 6d2f 6365 7369 756d 2d6d 6c2f  b.com/cesium-ml/
-00003c60: 6365 7369 756d 3e60 5f2e 0a0a 2020 2020  cesium>`_...    
-00003c70: 2020 2020 2020 204f 6464 6574 6974 793a         Oddetity:
-00003c80: 206d 6561 6e20 6361 6c63 756c 6174 696f   mean calculatio
-00003c90: 6e20 6973 2069 6e63 6f72 7265 6374 2069  n is incorrect i
-00003ca0: 6620 7061 7373 696e 6720 666c 6f61 7433  f passing float3
-00003cb0: 3220 6461 7461 2062 7574 2063 6f72 7265  2 data but corre
-00003cc0: 6374 2069 6620 7061 7373 696e 6720 666c  ct if passing fl
-00003cd0: 6f61 7436 342e 0a0a 2020 2020 2020 2020  oat64...        
-00003ce0: 2e2e 2069 6d61 6765 3a3a 205f 7374 6174  .. image:: _stat
-00003cf0: 6963 2f69 6d67 2f70 6572 6365 6e74 5f62  ic/img/percent_b
-00003d00: 6579 6f6e 645f 6e5f 7374 642e 706e 670a  eyond_n_std.png.
-00003d10: 2020 2020 2020 2020 2020 203a 7769 6474             :widt
-00003d20: 683a 2036 3030 0a20 2020 2020 2020 2020  h: 600.         
-00003d30: 2020 3a61 6c69 676e 3a20 6365 6e74 6572    :align: center
-00003d40: 0a0a 2020 2020 2020 2020 3a65 7861 6d70  ..        :examp
-00003d50: 6c65 733a 0a20 2020 2020 2020 203e 3e3e  les:.        >>>
-00003d60: 2064 6174 6120 3d20 6e70 2e61 7272 6179   data = np.array
-00003d70: 285b 332e 392c 2037 2e35 2c20 2034 2e32  ([3.9, 7.5,  4.2
-00003d80: 2c20 362e 322c 2037 2e35 2c20 332e 392c  , 6.2, 7.5, 3.9,
-00003d90: 2036 2e32 2c20 362e 352c 2037 2e32 2c20   6.2, 6.5, 7.2, 
-00003da0: 392e 355d 292e 6173 7479 7065 286e 702e  9.5]).astype(np.
-00003db0: 666c 6f61 7433 3229 0a20 2020 2020 2020  float32).       
-00003dc0: 203e 3e3e 2054 696d 6573 6572 6965 7346   >>> TimeseriesF
-00003dd0: 6561 7475 7265 4d69 7869 6e28 292e 7065  eatureMixin().pe
-00003de0: 7263 656e 745f 6265 796f 6e64 5f6e 5f73  rcent_beyond_n_s
-00003df0: 7464 2864 6174 613d 6461 7461 2c20 6e3d  td(data=data, n=
-00003e00: 3129 0a20 2020 2020 2020 203e 3e3e 2030  1).        >>> 0
-00003e10: 2e31 0a0a 2020 2020 2020 2020 2222 220a  .1..        """.
-00003e20: 2020 2020 2020 2020 6d20 3d20 6e70 2e6d          m = np.m
-00003e30: 6561 6e28 6461 7461 290a 2020 2020 2020  ean(data).      
-00003e40: 2020 7374 6420 3d20 6e70 2e73 7464 2864    std = np.std(d
-00003e50: 6174 6129 0a20 2020 2020 2020 2074 6172  ata).        tar
-00003e60: 6765 7420 3d20 6d20 2b20 2873 7464 202a  get = m + (std *
-00003e70: 206e 290a 2020 2020 2020 2020 7265 7475   n).        retu
-00003e80: 726e 206e 702e 6172 6777 6865 7265 2864  rn np.argwhere(d
-00003e90: 6174 6120 3e20 7461 7267 6574 292e 7368  ata > target).sh
-00003ea0: 6170 655b 305d 202f 2064 6174 612e 7368  ape[0] / data.sh
-00003eb0: 6170 655b 305d 0a0a 2020 2020 4073 7461  ape[0]..    @sta
-00003ec0: 7469 636d 6574 686f 640a 2020 2020 406e  ticmethod.    @n
-00003ed0: 6a69 7428 2228 666c 6f61 7436 345b 3a5d  jit("(float64[:]
-00003ee0: 2c20 666c 6f61 7436 342c 2066 6c6f 6174  , float64, float
-00003ef0: 3634 5b3a 5d2c 2069 6e74 3634 2c29 222c  64[:], int64,)",
-00003f00: 2063 6163 6865 3d54 7275 652c 2066 6173   cache=True, fas
-00003f10: 746d 6174 683d 5472 7565 290a 2020 2020  tmath=True).    
-00003f20: 6465 6620 736c 6964 696e 675f 7065 7263  def sliding_perc
-00003f30: 656e 745f 6265 796f 6e64 5f6e 5f73 7464  ent_beyond_n_std
-00003f40: 280a 2020 2020 2020 2020 6461 7461 3a20  (.        data: 
-00003f50: 6e70 2e6e 6461 7272 6179 2c20 6e3a 2066  np.ndarray, n: f
-00003f60: 6c6f 6174 2c20 7769 6e64 6f77 5f73 697a  loat, window_siz
-00003f70: 6573 3a20 6e70 2e6e 6461 7272 6179 2c20  es: np.ndarray, 
-00003f80: 7361 6d70 6c65 5f72 6174 653a 2069 6e74  sample_rate: int
-00003f90: 0a20 2020 2029 202d 3e20 6e70 2e6e 6461  .    ) -> np.nda
-00003fa0: 7272 6179 3a0a 2020 2020 2020 2020 2222  rray:.        ""
-00003fb0: 220a 2020 2020 2020 2020 436f 6d70 7574  ".        Comput
-00003fc0: 6564 2074 6865 2070 6572 6365 6e74 6167  ed the percentag
-00003fd0: 6520 6f66 2064 6174 6120 706f 696e 7473  e of data points
-00003fe0: 2074 6861 7420 6578 6365 6564 2027 6e27   that exceed 'n'
-00003ff0: 2073 7461 6e64 6172 6420 6465 7669 6174   standard deviat
-00004000: 696f 6e73 2066 726f 6d20 7468 6520 6d65  ions from the me
-00004010: 616e 2066 6f72 2065 6163 6820 706f 7369  an for each posi
-00004020: 7469 6f6e 2069 6e0a 2020 2020 2020 2020  tion in.        
-00004030: 7468 6520 7469 6d65 2073 6572 6965 7320  the time series 
-00004040: 7573 696e 6720 7661 7269 6f75 7320 7769  using various wi
-00004050: 6e64 6f77 2073 697a 6573 2e20 4974 2072  ndow sizes. It r
-00004060: 6574 7572 6e73 2061 2032 4420 6172 7261  eturns a 2D arra
-00004070: 7920 7768 6572 6520 6561 6368 2072 6f77  y where each row
-00004080: 2063 6f72 7265 7370 6f6e 6473 2074 6f20   corresponds to 
-00004090: 6120 706f 7369 7469 6f6e 2069 6e20 7468  a position in th
-000040a0: 6520 7469 6d65 2073 6572 6965 732c 0a20  e time series,. 
-000040b0: 2020 2020 2020 2061 6e64 2065 6163 6820         and each 
-000040c0: 636f 6c75 6d6e 2063 6f72 7265 7370 6f6e  column correspon
-000040d0: 6473 2074 6f20 6120 6469 6666 6572 656e  ds to a differen
-000040e0: 7420 7769 6e64 6f77 2073 697a 652e 2054  t window size. T
-000040f0: 6865 2072 6573 756c 7473 2061 7265 2067  he results are g
-00004100: 6976 656e 2061 7320 6120 7065 7263 656e  iven as a percen
-00004110: 7461 6765 206f 6620 6461 7461 2070 6f69  tage of data poi
-00004120: 6e74 7320 6265 796f 6e64 2074 6865 2074  nts beyond the t
-00004130: 6872 6573 686f 6c64 2e0a 0a20 2020 2020  hreshold...     
-00004140: 2020 203a 7061 7261 6d20 6e70 2e6e 6461     :param np.nda
-00004150: 7272 6179 2064 6174 613a 2054 6865 2069  rray data: The i
-00004160: 6e70 7574 2074 696d 6520 7365 7269 6573  nput time series
-00004170: 2064 6174 612e 0a20 2020 2020 2020 203a   data..        :
-00004180: 7061 7261 6d20 666c 6f61 7420 6e3a 2054  param float n: T
-00004190: 6865 206e 756d 6265 7220 6f66 2073 7461  he number of sta
-000041a0: 6e64 6172 6420 6465 7669 6174 696f 6e73  ndard deviations
-000041b0: 2074 6f20 6465 7465 726d 696e 6520 7468   to determine th
-000041c0: 6520 7468 7265 7368 6f6c 642e 0a20 2020  e threshold..   
-000041d0: 2020 2020 203a 7061 7261 6d20 6e70 2e6e       :param np.n
-000041e0: 6461 7272 6179 2077 696e 646f 775f 7369  darray window_si
-000041f0: 7a65 733a 2041 6e20 6172 7261 7920 6f66  zes: An array of
-00004200: 2077 696e 646f 7720 7369 7a65 7320 2869   window sizes (i
-00004210: 6e20 7365 636f 6e64 7329 2074 6f20 7573  n seconds) to us
-00004220: 6520 666f 7220 7468 6520 736c 6964 696e  e for the slidin
-00004230: 6720 6361 6c63 756c 6174 696f 6e2e 0a20  g calculation.. 
-00004240: 2020 2020 2020 203a 7061 7261 6d20 696e         :param in
-00004250: 7420 7361 6d70 6c65 5f72 6174 653a 2054  t sample_rate: T
-00004260: 6865 2073 616d 706c 696e 6720 7261 7465  he sampling rate
-00004270: 2028 7361 6d70 6c65 7320 7065 7220 7365   (samples per se
-00004280: 636f 6e64 2920 6f66 2074 6865 2074 696d  cond) of the tim
-00004290: 6520 7365 7269 6573 2064 6174 612e 0a20  e series data.. 
-000042a0: 2020 2020 2020 203a 7265 7475 726e 206e         :return n
-000042b0: 702e 6e64 6172 7261 793a 2041 2032 4420  p.ndarray: A 2D 
-000042c0: 6172 7261 7920 636f 6e74 6169 6e69 6e67  array containing
-000042d0: 2074 6865 2070 6572 6365 6e74 6167 6520   the percentage 
-000042e0: 6f66 2064 6174 6120 706f 696e 7473 2062  of data points b
-000042f0: 6579 6f6e 6420 7468 6520 7370 6563 6966  eyond the specif
-00004300: 6965 6420 276e 2720 7374 616e 6461 7264  ied 'n' standard
-00004310: 2064 6576 6961 7469 6f6e 7320 666f 7220   deviations for 
-00004320: 6561 6368 2077 696e 646f 7720 7369 7a65  each window size
-00004330: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
-00004340: 2020 2020 2020 2072 6573 756c 7473 203d         results =
-00004350: 206e 702e 6675 6c6c 2828 6461 7461 2e73   np.full((data.s
-00004360: 6861 7065 5b30 5d2c 2077 696e 646f 775f  hape[0], window_
-00004370: 7369 7a65 732e 7368 6170 655b 305d 292c  sizes.shape[0]),
-00004380: 202d 312e 3029 0a20 2020 2020 2020 2074   -1.0).        t
-00004390: 6172 6765 7420 3d20 286e 702e 7374 6428  arget = (np.std(
-000043a0: 6461 7461 2920 2a20 6e29 202b 206e 702e  data) * n) + np.
-000043b0: 6d65 616e 2864 6174 6129 0a20 2020 2020  mean(data).     
-000043c0: 2020 2066 6f72 2069 2069 6e20 7072 616e     for i in pran
-000043d0: 6765 2877 696e 646f 775f 7369 7a65 732e  ge(window_sizes.
-000043e0: 7368 6170 655b 305d 293a 0a20 2020 2020  shape[0]):.     
-000043f0: 2020 2020 2020 2077 696e 646f 775f 7369         window_si
-00004400: 7a65 203d 2069 6e74 2877 696e 646f 775f  ze = int(window_
-00004410: 7369 7a65 735b 695d 202a 2073 616d 706c  sizes[i] * sampl
-00004420: 655f 7261 7465 290a 2020 2020 2020 2020  e_rate).        
-00004430: 2020 2020 666f 7220 6c2c 2072 2069 6e20      for l, r in 
-00004440: 7a69 7028 0a20 2020 2020 2020 2020 2020  zip(.           
-00004450: 2020 2020 2070 7261 6e67 6528 302c 2064       prange(0, d
-00004460: 6174 612e 7368 6170 655b 305d 202b 2031  ata.shape[0] + 1
-00004470: 292c 2070 7261 6e67 6528 7769 6e64 6f77  ), prange(window
-00004480: 5f73 697a 652c 2064 6174 612e 7368 6170  _size, data.shap
-00004490: 655b 305d 202b 2031 290a 2020 2020 2020  e[0] + 1).      
-000044a0: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
-000044b0: 2020 2020 2020 2020 2073 616d 706c 6520           sample 
-000044c0: 3d20 6461 7461 5b6c 3a72 5d0a 2020 2020  = data[l:r].    
-000044d0: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-000044e0: 6c74 735b 7220 2d20 312c 2069 5d20 3d20  lts[r - 1, i] = 
-000044f0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00004500: 2020 2020 2020 6e70 2e61 7267 7768 6572        np.argwher
-00004510: 6528 6e70 2e61 6273 2873 616d 706c 6529  e(np.abs(sample)
-00004520: 203e 2074 6172 6765 7429 2e73 6861 7065   > target).shape
-00004530: 5b30 5d20 2f20 7361 6d70 6c65 2e73 6861  [0] / sample.sha
-00004540: 7065 5b30 5d0a 2020 2020 2020 2020 2020  pe[0].          
-00004550: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00004560: 2072 6574 7572 6e20 7265 7375 6c74 732e   return results.
-00004570: 6173 7479 7065 286e 702e 666c 6f61 7433  astype(np.float3
-00004580: 3229 0a0a 2020 2020 4073 7461 7469 636d  2)..    @staticm
-00004590: 6574 686f 640a 2020 2020 406e 6a69 7428  ethod.    @njit(
-000045a0: 2228 666c 6f61 7433 325b 3a5d 2c20 696e  "(float32[:], in
-000045b0: 7436 342c 2069 6e74 3634 2c20 2922 2c20  t64, int64, )", 
-000045c0: 6661 7374 6d61 7468 3d54 7275 6529 0a20  fastmath=True). 
-000045d0: 2020 2064 6566 2070 6572 6365 6e74 5f69     def percent_i
-000045e0: 6e5f 7065 7263 656e 7469 6c65 5f77 696e  n_percentile_win
-000045f0: 646f 7728 6461 7461 3a20 6e70 2e6e 6461  dow(data: np.nda
-00004600: 7272 6179 2c20 7570 7065 725f 7063 743a  rray, upper_pct:
-00004610: 2069 6e74 2c20 6c6f 7765 725f 7063 743a   int, lower_pct:
-00004620: 2069 6e74 293a 0a20 2020 2020 2020 2022   int):.        "
-00004630: 2222 0a20 2020 2020 2020 204a 6974 7465  "".        Jitte
-00004640: 6420 636f 6d70 7574 6520 6f66 2074 6865  d compute of the
-00004650: 2072 6174 696f 206f 6620 7661 6c75 6573   ratio of values
-00004660: 2069 6e20 7469 6d65 2d73 6572 6965 7320   in time-series 
-00004670: 7468 6174 2066 616c 6c20 6265 7477 6565  that fall betwee
-00004680: 6e20 7468 6520 6060 7570 7065 7260 6020  n the ``upper`` 
-00004690: 616e 6420 6060 6c6f 7765 7260 6020 7065  and ``lower`` pe
-000046a0: 7263 656e 7469 6c65 2e0a 0a20 2020 2020  rcentile...     
-000046b0: 2020 203a 7061 7261 6d65 7465 7220 6e70     :parameter np
-000046c0: 2e6e 6461 7272 6179 2064 6174 613a 2031  .ndarray data: 1
-000046d0: 4420 6172 7261 7920 6f66 2072 6570 7265  D array of repre
-000046e0: 7365 6e74 696e 6720 7469 6d65 2d73 6572  senting time-ser
-000046f0: 6965 732e 0a20 2020 2020 2020 203a 7061  ies..        :pa
-00004700: 7261 6d65 7465 7220 696e 7420 7570 7065  rameter int uppe
-00004710: 725f 7063 743a 2055 7070 6572 2d62 6f75  r_pct: Upper-bou
-00004720: 6e64 6172 7920 7065 7263 656e 7469 6c65  ndary percentile
-00004730: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00004740: 6574 6572 2069 6e74 206c 6f77 6572 5f70  eter int lower_p
-00004750: 6374 3a20 4c6f 7765 722d 626f 756e 6461  ct: Lower-bounda
-00004760: 7279 2070 6572 6365 6e74 696c 652e 0a20  ry percentile.. 
-00004770: 2020 2020 2020 203a 7265 7475 726e 7320         :returns 
-00004780: 666c 6f61 743a 2052 6174 696f 206f 6620  float: Ratio of 
-00004790: 7661 6c75 6573 2069 6e20 6060 6461 7461  values in ``data
-000047a0: 6060 2074 6861 7420 6661 6c6c 2077 6974  `` that fall wit
-000047b0: 6869 6e20 6060 7570 7065 725f 7063 7460  hin ``upper_pct`
-000047c0: 6020 616e 6420 6060 6c6f 7765 725f 7063  ` and ``lower_pc
-000047d0: 7460 6020 7065 7263 656e 7469 6c65 732e  t`` percentiles.
-000047e0: 0a0a 2020 2020 2020 2020 2e2e 206e 6f74  ..        .. not
-000047f0: 653a 3a0a 2020 2020 2020 2020 2020 2041  e::.           A
-00004800: 6461 7074 6564 2066 726f 6d20 6063 6573  dapted from `ces
-00004810: 6975 6d20 3c68 7474 7073 3a2f 2f67 6974  ium <https://git
-00004820: 6875 622e 636f 6d2f 6365 7369 756d 2d6d  hub.com/cesium-m
-00004830: 6c2f 6365 7369 756d 3e60 5f2e 0a0a 2020  l/cesium>`_...  
-00004840: 2020 2020 2020 2e2e 2069 6d61 6765 3a3a        .. image::
-00004850: 205f 7374 6174 6963 2f69 6d67 2f70 6572   _static/img/per
-00004860: 6365 6e74 5f69 6e5f 7065 7263 656e 7469  cent_in_percenti
-00004870: 6c65 5f77 696e 646f 772e 706e 670a 2020  le_window.png.  
-00004880: 2020 2020 2020 2020 203a 7769 6474 683a           :width:
-00004890: 2036 3030 0a20 2020 2020 2020 2020 2020   600.           
-000048a0: 3a61 6c69 676e 3a20 6365 6e74 6572 0a0a  :align: center..
-000048b0: 2020 2020 2020 2020 3a65 7861 6d70 6c65          :example
-000048c0: 3a0a 2020 2020 2020 2020 3e3e 3e20 6461  :.        >>> da
-000048d0: 7461 203d 206e 702e 6172 7261 7928 5b33  ta = np.array([3
-000048e0: 2e39 2c20 372e 352c 2020 342e 322c 2036  .9, 7.5,  4.2, 6
-000048f0: 2e32 2c20 372e 352c 2033 2e39 2c20 362e  .2, 7.5, 3.9, 6.
-00004900: 322c 2036 2e35 2c20 372e 322c 2039 2e35  2, 6.5, 7.2, 9.5
-00004910: 5d29 2e61 7374 7970 6528 6e70 2e66 6c6f  ]).astype(np.flo
-00004920: 6174 3332 290a 2020 2020 2020 2020 3e3e  at32).        >>
-00004930: 3e20 5469 6d65 7365 7269 6573 4665 6174  > TimeseriesFeat
-00004940: 7572 654d 6978 696e 2829 2e70 6572 6365  ureMixin().perce
-00004950: 6e74 5f69 6e5f 7065 7263 656e 7469 6c65  nt_in_percentile
-00004960: 5f77 696e 646f 7728 6461 7461 2c20 7570  _window(data, up
-00004970: 7065 725f 7063 743d 3730 2c20 6c6f 7765  per_pct=70, lowe
-00004980: 725f 7063 743d 3330 290a 2020 2020 2020  r_pct=30).      
-00004990: 2020 3e3e 3e20 302e 340a 2020 2020 2020    >>> 0.4.      
-000049a0: 2020 2222 220a 0a20 2020 2020 2020 2075    """..        u
-000049b0: 7070 6572 5f76 616c 2c20 6c6f 7765 725f  pper_val, lower_
-000049c0: 7661 6c20 3d20 6e70 2e70 6572 6365 6e74  val = np.percent
-000049d0: 696c 6528 6461 7461 2c20 7570 7065 725f  ile(data, upper_
-000049e0: 7063 7429 2c20 6e70 2e70 6572 6365 6e74  pct), np.percent
-000049f0: 696c 6528 0a20 2020 2020 2020 2020 2020  ile(.           
-00004a00: 2064 6174 612c 206c 6f77 6572 5f70 6374   data, lower_pct
-00004a10: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00004a20: 2020 2072 6574 7572 6e20 280a 2020 2020     return (.    
-00004a30: 2020 2020 2020 2020 6e70 2e61 7267 7768          np.argwh
-00004a40: 6572 6528 2864 6174 6120 3c3d 2075 7070  ere((data <= upp
-00004a50: 6572 5f76 616c 2920 2620 2864 6174 6120  er_val) & (data 
-00004a60: 3e3d 206c 6f77 6572 5f76 616c 2929 2e66  >= lower_val)).f
-00004a70: 6c61 7474 656e 2829 2e73 6861 7065 5b30  latten().shape[0
-00004a80: 5d0a 2020 2020 2020 2020 2020 2020 2f20  ].            / 
-00004a90: 6461 7461 2e73 6861 7065 5b30 5d0a 2020  data.shape[0].  
-00004aa0: 2020 2020 2020 290a 0a20 2020 2040 7374        )..    @st
-00004ab0: 6174 6963 6d65 7468 6f64 0a20 2020 2040  aticmethod.    @
-00004ac0: 6e6a 6974 2822 2866 6c6f 6174 3332 5b3a  njit("(float32[:
-00004ad0: 5d2c 2069 6e74 3634 2c20 696e 7436 342c  ], int64, int64,
-00004ae0: 2066 6c6f 6174 3634 5b3a 5d2c 2069 6e74   float64[:], int
-00004af0: 3634 2922 2c20 6361 6368 653d 5472 7565  64)", cache=True
-00004b00: 2c20 6661 7374 6d61 7468 3d54 7275 6529  , fastmath=True)
-00004b10: 0a20 2020 2064 6566 2073 6c69 6469 6e67  .    def sliding
-00004b20: 5f70 6572 6365 6e74 5f69 6e5f 7065 7263  _percent_in_perc
-00004b30: 656e 7469 6c65 5f77 696e 646f 7728 0a20  entile_window(. 
-00004b40: 2020 2020 2020 2064 6174 613a 206e 702e         data: np.
-00004b50: 6e64 6172 7261 792c 0a20 2020 2020 2020  ndarray,.       
-00004b60: 2075 7070 6572 5f70 6374 3a20 696e 742c   upper_pct: int,
-00004b70: 0a20 2020 2020 2020 206c 6f77 6572 5f70  .        lower_p
-00004b80: 6374 3a20 696e 742c 0a20 2020 2020 2020  ct: int,.       
-00004b90: 2077 696e 646f 775f 7369 7a65 733a 206e   window_sizes: n
-00004ba0: 702e 6e64 6172 7261 792c 0a20 2020 2020  p.ndarray,.     
-00004bb0: 2020 2073 616d 706c 655f 7261 7465 3a20     sample_rate: 
-00004bc0: 696e 742c 0a20 2020 2029 3a0a 2020 2020  int,.    ):.    
-00004bd0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00004be0: 4a69 7474 6564 2063 6f6d 7075 7465 206f  Jitted compute o
-00004bf0: 6620 7468 6520 7065 7263 656e 7461 6765  f the percentage
-00004c00: 206f 6620 6461 7461 2070 6f69 6e74 7320   of data points 
-00004c10: 6661 6c6c 696e 6720 7769 7468 696e 2061  falling within a
-00004c20: 2070 6572 6365 6e74 696c 6520 7769 6e64   percentile wind
-00004c30: 6f77 2069 6e20 6120 736c 6964 696e 6720  ow in a sliding 
-00004c40: 6d61 6e6e 6572 2e0a 0a20 2020 2020 2020  manner...       
-00004c50: 2054 6865 2066 756e 6374 696f 6e20 636f   The function co
-00004c60: 6d70 7574 6573 2074 6865 2070 6572 6365  mputes the perce
-00004c70: 6e74 6167 6520 6f66 2064 6174 6120 706f  ntage of data po
-00004c80: 696e 7473 2077 6974 6869 6e20 7468 6520  ints within the 
-00004c90: 7370 6563 6966 6965 6420 7065 7263 656e  specified percen
-00004ca0: 7469 6c65 2077 696e 646f 7720 666f 7220  tile window for 
-00004cb0: 6561 6368 2070 6f73 6974 696f 6e20 696e  each position in
-00004cc0: 2074 6865 2074 696d 6520 7365 7269 6573   the time series
-00004cd0: 0a20 2020 2020 2020 2075 7369 6e67 2076  .        using v
-00004ce0: 6172 696f 7573 2077 696e 646f 7720 7369  arious window si
-00004cf0: 7a65 732e 2049 7420 7265 7475 726e 7320  zes. It returns 
-00004d00: 6120 3244 2061 7272 6179 2077 6865 7265  a 2D array where
-00004d10: 2065 6163 6820 726f 7720 636f 7272 6573   each row corres
-00004d20: 706f 6e64 7320 746f 2061 2070 6f73 6974  ponds to a posit
-00004d30: 696f 6e20 696e 2074 6865 2074 696d 6520  ion in the time 
-00004d40: 7365 7269 6573 2c20 616e 6420 6561 6368  series, and each
-00004d50: 2063 6f6c 756d 6e0a 2020 2020 2020 2020   column.        
-00004d60: 636f 7272 6573 706f 6e64 7320 746f 2061  corresponds to a
-00004d70: 2064 6966 6665 7265 6e74 2077 696e 646f   different windo
-00004d80: 7720 7369 7a65 2e20 5468 6520 7265 7375  w size. The resu
-00004d90: 6c74 7320 6172 6520 6769 7665 6e20 6173  lts are given as
-00004da0: 2061 2070 6572 6365 6e74 6167 6520 6f66   a percentage of
-00004db0: 2064 6174 6120 706f 696e 7473 2077 6974   data points wit
-00004dc0: 6869 6e20 7468 6520 7065 7263 656e 7469  hin the percenti
-00004dd0: 6c65 2077 696e 646f 772e 0a0a 2020 2020  le window...    
-00004de0: 2020 2020 3a70 6172 616d 206e 702e 6e64      :param np.nd
-00004df0: 6172 7261 7920 6461 7461 3a20 5468 6520  array data: The 
-00004e00: 696e 7075 7420 7469 6d65 2073 6572 6965  input time serie
-00004e10: 7320 6461 7461 2e0a 2020 2020 2020 2020  s data..        
-00004e20: 3a70 6172 616d 2069 6e74 2075 7070 6572  :param int upper
-00004e30: 5f70 6374 3a20 5468 6520 7570 7065 7220  _pct: The upper 
-00004e40: 7065 7263 656e 7469 6c65 2076 616c 7565  percentile value
-00004e50: 2066 6f72 2074 6865 2077 696e 646f 7720   for the window 
-00004e60: 2865 2e67 2e2c 2039 3520 666f 7220 7468  (e.g., 95 for th
-00004e70: 6520 3935 7468 2070 6572 6365 6e74 696c  e 95th percentil
-00004e80: 6529 2e0a 2020 2020 2020 2020 3a70 6172  e)..        :par
-00004e90: 616d 2069 6e74 206c 6f77 6572 5f70 6374  am int lower_pct
-00004ea0: 3a20 5468 6520 6c6f 7765 7220 7065 7263  : The lower perc
-00004eb0: 656e 7469 6c65 2076 616c 7565 2066 6f72  entile value for
-00004ec0: 2074 6865 2077 696e 646f 7720 2865 2e67   the window (e.g
-00004ed0: 2e2c 2035 2066 6f72 2074 6865 2035 7468  ., 5 for the 5th
-00004ee0: 2070 6572 6365 6e74 696c 6529 2e0a 2020   percentile)..  
-00004ef0: 2020 2020 2020 3a70 6172 616d 206e 702e        :param np.
-00004f00: 6e64 6172 7261 7920 7769 6e64 6f77 5f73  ndarray window_s
-00004f10: 697a 6573 3a20 416e 2061 7272 6179 206f  izes: An array o
-00004f20: 6620 7769 6e64 6f77 2073 697a 6573 2028  f window sizes (
-00004f30: 696e 2073 6563 6f6e 6473 2920 746f 2075  in seconds) to u
-00004f40: 7365 2066 6f72 2074 6865 2073 6c69 6469  se for the slidi
-00004f50: 6e67 2063 616c 6375 6c61 7469 6f6e 2e0a  ng calculation..
-00004f60: 2020 2020 2020 2020 3a70 6172 616d 2069          :param i
-00004f70: 6e74 2073 616d 706c 655f 7261 7465 3a20  nt sample_rate: 
-00004f80: 5468 6520 7361 6d70 6c69 6e67 2072 6174  The sampling rat
-00004f90: 6520 2873 616d 706c 6573 2070 6572 2073  e (samples per s
-00004fa0: 6563 6f6e 6429 206f 6620 7468 6520 7469  econd) of the ti
-00004fb0: 6d65 2073 6572 6965 7320 6461 7461 2e0a  me series data..
-00004fc0: 2020 2020 2020 2020 3a72 6574 7572 6e20          :return 
-00004fd0: 6e70 2e6e 6461 7272 6179 3a20 4120 3244  np.ndarray: A 2D
-00004fe0: 2061 7272 6179 2063 6f6e 7461 696e 696e   array containin
-00004ff0: 6720 7468 6520 7065 7263 656e 7461 6765  g the percentage
-00005000: 206f 6620 6461 7461 2070 6f69 6e74 7320   of data points 
-00005010: 7769 7468 696e 2074 6865 2070 6572 6365  within the perce
-00005020: 6e74 696c 6520 7769 6e64 6f77 2066 6f72  ntile window for
-00005030: 2065 6163 6820 7769 6e64 6f77 2073 697a   each window siz
-00005040: 652e 0a0a 2020 2020 2020 2020 2222 220a  e...        """.
-00005050: 2020 2020 2020 2020 7265 7375 6c74 7320          results 
-00005060: 3d20 6e70 2e66 756c 6c28 2864 6174 612e  = np.full((data.
-00005070: 7368 6170 655b 305d 2c20 7769 6e64 6f77  shape[0], window
-00005080: 5f73 697a 6573 2e73 6861 7065 5b30 5d29  _sizes.shape[0])
-00005090: 2c20 2d31 2e30 290a 2020 2020 2020 2020  , -1.0).        
-000050a0: 7570 7065 725f 7661 6c2c 206c 6f77 6572  upper_val, lower
-000050b0: 5f76 616c 203d 206e 702e 7065 7263 656e  _val = np.percen
-000050c0: 7469 6c65 2864 6174 612c 2075 7070 6572  tile(data, upper
-000050d0: 5f70 6374 292c 206e 702e 7065 7263 656e  _pct), np.percen
-000050e0: 7469 6c65 280a 2020 2020 2020 2020 2020  tile(.          
-000050f0: 2020 6461 7461 2c20 6c6f 7765 725f 7063    data, lower_pc
-00005100: 740a 2020 2020 2020 2020 290a 2020 2020  t.        ).    
-00005110: 2020 2020 666f 7220 6920 696e 2070 7261      for i in pra
-00005120: 6e67 6528 7769 6e64 6f77 5f73 697a 6573  nge(window_sizes
-00005130: 2e73 6861 7065 5b30 5d29 3a0a 2020 2020  .shape[0]):.    
-00005140: 2020 2020 2020 2020 7769 6e64 6f77 5f73          window_s
-00005150: 697a 6520 3d20 696e 7428 7769 6e64 6f77  ize = int(window
-00005160: 5f73 697a 6573 5b69 5d20 2a20 7361 6d70  _sizes[i] * samp
-00005170: 6c65 5f72 6174 6529 0a20 2020 2020 2020  le_rate).       
-00005180: 2020 2020 2066 6f72 206c 2c20 7220 696e       for l, r in
-00005190: 207a 6970 280a 2020 2020 2020 2020 2020   zip(.          
-000051a0: 2020 2020 2020 7072 616e 6765 2830 2c20        prange(0, 
-000051b0: 6461 7461 2e73 6861 7065 5b30 5d20 2b20  data.shape[0] + 
-000051c0: 3129 2c20 7072 616e 6765 2877 696e 646f  1), prange(windo
-000051d0: 775f 7369 7a65 2c20 6461 7461 2e73 6861  w_size, data.sha
-000051e0: 7065 5b30 5d20 2b20 3129 0a20 2020 2020  pe[0] + 1).     
-000051f0: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
-00005200: 2020 2020 2020 2020 2020 7361 6d70 6c65            sample
-00005210: 203d 2064 6174 615b 6c3a 725d 0a20 2020   = data[l:r].   
-00005220: 2020 2020 2020 2020 2020 2020 2072 6573               res
-00005230: 756c 7473 5b72 202d 2031 2c20 695d 203d  ults[r - 1, i] =
-00005240: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-00005250: 2020 2020 2020 206e 702e 6172 6777 6865         np.argwhe
-00005260: 7265 2828 7361 6d70 6c65 203c 3d20 7570  re((sample <= up
-00005270: 7065 725f 7661 6c29 2026 2028 7361 6d70  per_val) & (samp
-00005280: 6c65 203e 3d20 6c6f 7765 725f 7661 6c29  le >= lower_val)
-00005290: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000052a0: 2020 2020 2020 2e66 6c61 7474 656e 2829        .flatten()
-000052b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000052c0: 2020 2020 202e 7368 6170 655b 305d 0a20       .shape[0]. 
-000052d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000052e0: 2020 202f 2073 616d 706c 652e 7368 6170     / sample.shap
-000052f0: 655b 305d 0a20 2020 2020 2020 2020 2020  e[0].           
-00005300: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00005310: 7265 7475 726e 2072 6573 756c 7473 2e61  return results.a
-00005320: 7374 7970 6528 6e70 2e66 6c6f 6174 3332  stype(np.float32
-00005330: 290a 0a20 2020 2040 7374 6174 6963 6d65  )..    @staticme
-00005340: 7468 6f64 0a20 2020 2040 6e6a 6974 2822  thod.    @njit("
-00005350: 2866 6c6f 6174 3332 5b3a 5d2c 2922 2c20  (float32[:],)", 
-00005360: 6661 7374 6d61 7468 3d54 7275 652c 2063  fastmath=True, c
-00005370: 6163 6865 3d54 7275 6529 0a20 2020 2064  ache=True).    d
-00005380: 6566 2070 6574 726f 7369 616e 5f66 7261  ef petrosian_fra
-00005390: 6374 616c 5f64 696d 656e 7369 6f6e 2864  ctal_dimension(d
-000053a0: 6174 613a 206e 702e 6e64 6172 7261 7929  ata: np.ndarray)
-000053b0: 202d 3e20 666c 6f61 743a 0a20 2020 2020   -> float:.     
-000053c0: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
-000053d0: 616c 6375 6c61 7465 2074 6865 2050 6574  alculate the Pet
-000053e0: 726f 7369 616e 2046 7261 6374 616c 2044  rosian Fractal D
-000053f0: 696d 656e 7369 6f6e 2028 5046 4429 206f  imension (PFD) o
-00005400: 6620 6120 6769 7665 6e20 7469 6d65 2073  f a given time s
-00005410: 6572 6965 7320 6461 7461 2e20 5468 6520  eries data. The 
-00005420: 5046 4420 6973 2061 206d 6561 7375 7265  PFD is a measure
-00005430: 206f 6620 7468 650a 2020 2020 2020 2020   of the.        
-00005440: 6972 7265 6775 6c61 7269 7479 206f 7220  irregularity or 
-00005450: 7365 6c66 2d73 696d 696c 6172 6974 7920  self-similarity 
-00005460: 6f66 2061 2074 696d 6520 7365 7269 6573  of a time series
-00005470: 2e20 4c61 7267 6572 2076 616c 7565 7320  . Larger values 
-00005480: 696e 6469 6361 7465 2068 6967 6865 7220  indicate higher 
-00005490: 636f 6d70 6c65 7869 7479 2e20 4c6f 7765  complexity. Lowe
-000054a0: 7220 7661 6c75 6573 2069 6e64 6963 6174  r values indicat
-000054b0: 6520 6c6f 7765 7220 636f 6d70 6c65 7869  e lower complexi
-000054c0: 7479 2e0a 0a20 2020 2020 2020 202e 2e20  ty...        .. 
-000054d0: 6e6f 7465 3a3a 0a20 2020 2020 2020 2020  note::.         
-000054e0: 2020 5468 6520 5046 4420 6973 2063 6f6d    The PFD is com
-000054f0: 7075 7465 6420 6261 7365 6420 6f6e 2074  puted based on t
-00005500: 6865 206e 756d 6265 7220 6f66 2073 6967  he number of sig
-00005510: 6e20 6368 616e 6765 7320 696e 2074 6865  n changes in the
-00005520: 2066 6972 7374 2064 6572 6976 6174 6976   first derivativ
-00005530: 6520 6f66 2074 6865 2074 696d 6520 7365  e of the time se
-00005540: 7269 6573 2e20 4966 2074 6865 2069 6e70  ries. If the inp
-00005550: 7574 2064 6174 6120 6973 2065 6d70 7479  ut data is empty
-00005560: 206f 7220 6e6f 2073 6967 6e20 6368 616e   or no sign chan
-00005570: 6765 7320 6172 6520 666f 756e 642c 2074  ges are found, t
-00005580: 6865 2050 4644 2069 7320 7265 7475 726e  he PFD is return
-00005590: 6564 2061 7320 2d31 2e30 2e20 4164 6170  ed as -1.0. Adap
-000055a0: 7465 6420 6672 6f6d 2060 6565 676c 6962  ted from `eeglib
-000055b0: 203c 6874 7470 733a 2f2f 6769 7468 7562   <https://github
-000055c0: 2e63 6f6d 2f58 6975 6c31 3039 2f65 6567  .com/Xiul109/eeg
-000055d0: 6c69 622f 3e60 5f2e 0a0a 2020 2020 2020  lib/>`_...      
-000055e0: 2020 2e2e 206d 6174 683a 3a0a 2020 2020    .. math::.    
-000055f0: 2020 2020 2020 2050 4644 203d 205c 5c66         PFD = \\f
-00005600: 7261 637b 5c5c 6c6f 675f 7b31 307d 284e  rac{\\log_{10}(N
-00005610: 297d 7b5c 5c6c 6f67 5f7b 3130 7d28 4e29  )}{\\log_{10}(N)
-00005620: 202b 205c 5c6c 6f67 5f7b 3130 7d5c 5c6c   + \\log_{10}\\l
-00005630: 6566 7428 5c5c 6672 6163 7b4e 7d7b 4e20  eft(\\frac{N}{N 
-00005640: 2b20 302e 3420 5c5c 6364 6f74 207a 437d  + 0.4 \\cdot zC}
-00005650: 5c5c 7269 6768 7429 7d0a 0a20 2020 2020  \\right)}..     
-00005660: 2020 203a 7061 7261 6d65 7465 7220 6e70     :parameter np
-00005670: 2e6e 6461 7272 6179 2064 6174 613a 2041  .ndarray data: A
-00005680: 2031 2d64 696d 656e 7369 6f6e 616c 206e   1-dimensional n
-00005690: 756d 7079 2061 7272 6179 2063 6f6e 7461  umpy array conta
-000056a0: 696e 696e 6720 7468 6520 7469 6d65 2073  ining the time s
-000056b0: 6572 6965 7320 6461 7461 2e0a 2020 2020  eries data..    
-000056c0: 2020 2020 3a72 6574 7572 6e73 2066 6c6f      :returns flo
-000056d0: 6174 3a20 5468 6520 5065 7472 6f73 6961  at: The Petrosia
-000056e0: 6e20 4672 6163 7461 6c20 4469 6d65 6e73  n Fractal Dimens
-000056f0: 696f 6e20 6f66 2074 6865 2069 6e70 7574  ion of the input
-00005700: 2074 696d 6520 7365 7269 6573 2e0a 0a20   time series... 
-00005710: 2020 2020 2020 203a 6578 616d 706c 6573         :examples
-00005720: 3a0a 2020 2020 2020 2020 3e3e 3e20 7420  :.        >>> t 
-00005730: 3d20 6e70 2e6c 696e 7370 6163 6528 302c  = np.linspace(0,
-00005740: 2035 302c 2069 6e74 2834 3431 3030 202a   50, int(44100 *
-00005750: 2032 2e30 292c 2065 6e64 706f 696e 743d   2.0), endpoint=
-00005760: 4661 6c73 6529 0a20 2020 2020 2020 203e  False).        >
-00005770: 3e3e 2073 696e 655f 7761 7665 203d 2031  >> sine_wave = 1
-00005780: 2e30 202a 206e 702e 7369 6e28 3220 2a20  .0 * np.sin(2 * 
-00005790: 6e70 2e70 6920 2a20 312e 3020 2a20 7429  np.pi * 1.0 * t)
-000057a0: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
-000057b0: 3332 290a 2020 2020 2020 2020 3e3e 3e20  32).        >>> 
-000057c0: 5469 6d65 7365 7269 6573 4665 6174 7572  TimeseriesFeatur
-000057d0: 654d 6978 696e 2829 2e70 6574 726f 7369  eMixin().petrosi
-000057e0: 616e 5f66 7261 6374 616c 5f64 696d 656e  an_fractal_dimen
-000057f0: 7369 6f6e 2864 6174 613d 7369 6e65 5f77  sion(data=sine_w
-00005800: 6176 6529 0a20 2020 2020 2020 203e 3e3e  ave).        >>>
-00005810: 2031 2e30 3030 3033 3938 3138 3730 3232   1.0000398187022
-00005820: 3731 390a 2020 2020 2020 2020 3e3e 3e20  719.        >>> 
-00005830: 6e70 2e72 616e 646f 6d2e 7368 7566 666c  np.random.shuffl
-00005840: 6528 7369 6e65 5f77 6176 6529 0a20 2020  e(sine_wave).   
-00005850: 2020 2020 203e 3e3e 2054 696d 6573 6572       >>> Timeser
-00005860: 6965 7346 6561 7475 7265 4d69 7869 6e28  iesFeatureMixin(
-00005870: 292e 7065 7472 6f73 6961 6e5f 6672 6163  ).petrosian_frac
-00005880: 7461 6c5f 6469 6d65 6e73 696f 6e28 6461  tal_dimension(da
-00005890: 7461 3d73 696e 655f 7761 7665 290a 2020  ta=sine_wave).  
-000058a0: 2020 2020 2020 3e3e 3e20 312e 3032 3131        >>> 1.0211
-000058b0: 3632 3533 3438 3734 3332 3138 0a20 2020  625348743218.   
-000058c0: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-000058d0: 2020 6461 7461 203d 2028 6461 7461 202d    data = (data -
-000058e0: 206e 702e 6d69 6e28 6461 7461 2929 202f   np.min(data)) /
-000058f0: 2028 6e70 2e6d 6178 2864 6174 6129 202d   (np.max(data) -
-00005900: 206e 702e 6d69 6e28 6461 7461 2929 0a20   np.min(data)). 
-00005910: 2020 2020 2020 2064 6572 6976 6174 6976         derivativ
-00005920: 6520 3d20 6461 7461 5b31 3a5d 202d 2064  e = data[1:] - d
-00005930: 6174 615b 3a2d 315d 0a20 2020 2020 2020  ata[:-1].       
-00005940: 2069 6620 6465 7269 7661 7469 7665 2e73   if derivative.s
-00005950: 6861 7065 5b30 5d20 3d3d 2030 3a0a 2020  hape[0] == 0:.  
-00005960: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00005970: 202d 312e 300a 2020 2020 2020 2020 7a43   -1.0.        zC
-00005980: 2c20 6c61 7374 5f76 616c 203d 2030 2c20  , last_val = 0, 
-00005990: 2d31 0a20 2020 2020 2020 2069 6620 6465  -1.        if de
-000059a0: 7269 7661 7469 7665 5b30 5d20 3e20 302e  rivative[0] > 0.
-000059b0: 303a 0a20 2020 2020 2020 2020 2020 206c  0:.            l
-000059c0: 6173 745f 7661 6c20 3d20 310a 2020 2020  ast_val = 1.    
-000059d0: 2020 2020 666f 7220 6920 696e 2070 7261      for i in pra
-000059e0: 6e67 6528 312c 2064 6572 6976 6174 6976  nge(1, derivativ
-000059f0: 652e 7368 6170 655b 305d 293a 0a20 2020  e.shape[0]):.   
-00005a00: 2020 2020 2020 2020 2063 7572 7265 6e74           current
-00005a10: 5f76 616c 203d 202d 310a 2020 2020 2020  _val = -1.      
-00005a20: 2020 2020 2020 6966 2064 6572 6976 6174        if derivat
-00005a30: 6976 655b 695d 203e 2030 2e30 3a0a 2020  ive[i] > 0.0:.  
-00005a40: 2020 2020 2020 2020 2020 2020 2020 6375                cu
-00005a50: 7272 656e 745f 7661 6c20 3d20 310a 2020  rrent_val = 1.  
-00005a60: 2020 2020 2020 2020 2020 6966 206c 6173            if las
-00005a70: 745f 7661 6c20 213d 2063 7572 7265 6e74  t_val != current
-00005a80: 5f76 616c 3a0a 2020 2020 2020 2020 2020  _val:.          
-00005a90: 2020 2020 2020 7a43 202b 3d20 310a 2020        zC += 1.  
-00005aa0: 2020 2020 2020 2020 2020 6c61 7374 5f76            last_v
-00005ab0: 616c 203d 2063 7572 7265 6e74 5f76 616c  al = current_val
-00005ac0: 0a20 2020 2020 2020 2069 6620 7a43 203d  .        if zC =
-00005ad0: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
-00005ae0: 2072 6574 7572 6e20 2d31 2e30 0a0a 2020   return -1.0..  
-00005af0: 2020 2020 2020 7265 7475 726e 206e 702e        return np.
-00005b00: 6c6f 6731 3028 6461 7461 2e73 6861 7065  log10(data.shape
-00005b10: 5b30 5d29 202f 2028 0a20 2020 2020 2020  [0]) / (.       
-00005b20: 2020 2020 206e 702e 6c6f 6731 3028 6461       np.log10(da
-00005b30: 7461 2e73 6861 7065 5b30 5d29 0a20 2020  ta.shape[0]).   
-00005b40: 2020 2020 2020 2020 202b 206e 702e 6c6f           + np.lo
-00005b50: 6731 3028 6461 7461 2e73 6861 7065 5b30  g10(data.shape[0
-00005b60: 5d20 2f20 2864 6174 612e 7368 6170 655b  ] / (data.shape[
-00005b70: 305d 202b 2030 2e34 202a 207a 4329 290a  0] + 0.4 * zC)).
-00005b80: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
-00005b90: 7374 6174 6963 6d65 7468 6f64 0a20 2020  staticmethod.   
-00005ba0: 2040 6e6a 6974 2822 2866 6c6f 6174 3332   @njit("(float32
-00005bb0: 5b3a 5d2c 2066 6c6f 6174 3634 5b3a 5d2c  [:], float64[:],
-00005bc0: 2069 6e74 3634 2922 2c20 6661 7374 6d61   int64)", fastma
-00005bd0: 7468 3d54 7275 652c 2063 6163 6865 3d54  th=True, cache=T
-00005be0: 7275 6529 0a20 2020 2064 6566 2073 6c69  rue).    def sli
-00005bf0: 6469 6e67 5f70 6574 726f 7369 616e 5f66  ding_petrosian_f
-00005c00: 7261 6374 616c 5f64 696d 656e 7369 6f6e  ractal_dimension
-00005c10: 280a 2020 2020 2020 2020 6461 7461 3a20  (.        data: 
-00005c20: 6e70 2e6e 6461 7272 6179 2c20 7769 6e64  np.ndarray, wind
-00005c30: 6f77 5f73 697a 6573 3a20 6e70 2e6e 6461  ow_sizes: np.nda
-00005c40: 7272 6179 2c20 7361 6d70 6c65 5f72 6174  rray, sample_rat
-00005c50: 653a 2069 6e74 0a20 2020 2029 202d 3e20  e: int.    ) -> 
-00005c60: 6e70 2e6e 6461 7272 6179 3a0a 2020 2020  np.ndarray:.    
-00005c70: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00005c80: 4a69 7474 6564 2063 6f6d 7075 7465 206f  Jitted compute o
-00005c90: 6620 5065 7472 6f73 6961 6e20 4672 6163  f Petrosian Frac
-00005ca0: 7461 6c20 4469 6d65 6e73 696f 6e20 6f76  tal Dimension ov
-00005cb0: 6572 2073 6c69 6469 6e67 2077 696e 646f  er sliding windo
-00005cc0: 7773 2069 6e20 6120 6461 7461 2061 7272  ws in a data arr
-00005cd0: 6179 2e0a 0a20 2020 2020 2020 2054 6869  ay...        Thi
-00005ce0: 7320 6d65 7468 6f64 2063 6f6d 7075 7465  s method compute
-00005cf0: 7320 7468 6520 5065 7472 6f73 6961 6e20  s the Petrosian 
-00005d00: 4672 6163 7461 6c20 4469 6d65 6e73 696f  Fractal Dimensio
-00005d10: 6e20 666f 7220 736c 6964 696e 6720 7769  n for sliding wi
-00005d20: 6e64 6f77 7320 6f66 2076 6172 7969 6e67  ndows of varying
-00005d30: 2073 697a 6573 2061 7070 6c69 6564 0a20   sizes applied. 
-00005d40: 2020 2020 2020 2074 6f20 7468 6520 696e         to the in
-00005d50: 7075 7420 6461 7461 2061 7272 6179 2e20  put data array. 
-00005d60: 5468 6520 5065 7472 6f73 6961 6e20 4672  The Petrosian Fr
-00005d70: 6163 7461 6c20 4469 6d65 6e73 696f 6e20  actal Dimension 
-00005d80: 6973 2061 206d 6561 7375 7265 206f 6620  is a measure of 
-00005d90: 7369 676e 616c 2063 6f6d 706c 6578 6974  signal complexit
-00005da0: 792e 0a0a 2020 2020 2020 2020 3a70 6172  y...        :par
-00005db0: 616d 206e 702e 6e64 6172 7261 7920 6461  am np.ndarray da
-00005dc0: 7461 3a20 496e 7075 7420 6461 7461 2061  ta: Input data a
-00005dd0: 7272 6179 2e0a 2020 2020 2020 2020 3a70  rray..        :p
-00005de0: 6172 616d 206e 702e 6e64 6172 7261 7920  aram np.ndarray 
-00005df0: 7769 6e64 6f77 5f73 697a 6573 3a20 4172  window_sizes: Ar
-00005e00: 7261 7920 6f66 2077 696e 646f 7720 7369  ray of window si
-00005e10: 7a65 7320 2869 6e20 7365 636f 6e64 7329  zes (in seconds)
-00005e20: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00005e30: 2069 6e74 2073 616d 706c 655f 7261 7465   int sample_rate
-00005e40: 3a20 5361 6d70 6c69 6e67 2072 6174 6520  : Sampling rate 
-00005e50: 6f66 2074 6865 2064 6174 6120 696e 2073  of the data in s
-00005e60: 616d 706c 6573 2070 6572 2073 6563 6f6e  amples per secon
-00005e70: 642e 0a20 2020 2020 2020 203a 7265 7475  d..        :retu
-00005e80: 726e 206e 702e 6e64 6172 7261 793a 2041  rn np.ndarray: A
-00005e90: 6e20 6172 7261 7920 636f 6e74 6169 6e69  n array containi
-00005ea0: 6e67 2050 6574 726f 7369 616e 2046 7261  ng Petrosian Fra
-00005eb0: 6374 616c 2044 696d 656e 7369 6f6e 2076  ctal Dimension v
-00005ec0: 616c 7565 7320 666f 7220 6561 6368 2077  alues for each w
-00005ed0: 696e 646f 7720 7369 7a65 2061 6e64 2064  indow size and d
-00005ee0: 6174 610a 2020 2020 2020 2020 2020 2020  ata.            
-00005ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005f00: 706f 696e 742e 2054 6865 2073 6861 7065  point. The shape
-00005f10: 206f 6620 7468 6520 7265 7375 6c74 2061   of the result a
-00005f20: 7272 6179 2069 7320 2864 6174 612e 7368  rray is (data.sh
-00005f30: 6170 655b 305d 2c20 7769 6e64 6f77 5f73  ape[0], window_s
-00005f40: 697a 6573 2e73 6861 7065 5b30 5d29 2e0a  izes.shape[0])..
-00005f50: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-00005f60: 2020 2020 2020 7265 7375 6c74 7320 3d20        results = 
-00005f70: 6e70 2e66 756c 6c28 2864 6174 612e 7368  np.full((data.sh
-00005f80: 6170 655b 305d 2c20 7769 6e64 6f77 5f73  ape[0], window_s
-00005f90: 697a 6573 2e73 6861 7065 5b30 5d29 2c20  izes.shape[0]), 
-00005fa0: 2d31 2e30 290a 2020 2020 2020 2020 666f  -1.0).        fo
-00005fb0: 7220 6920 696e 2070 7261 6e67 6528 7769  r i in prange(wi
-00005fc0: 6e64 6f77 5f73 697a 6573 2e73 6861 7065  ndow_sizes.shape
-00005fd0: 5b30 5d29 3a0a 2020 2020 2020 2020 2020  [0]):.          
-00005fe0: 2020 7769 6e64 6f77 5f73 697a 6520 3d20    window_size = 
-00005ff0: 696e 7428 7769 6e64 6f77 5f73 697a 6573  int(window_sizes
-00006000: 5b69 5d20 2a20 7361 6d70 6c65 5f72 6174  [i] * sample_rat
-00006010: 6529 0a20 2020 2020 2020 2020 2020 2066  e).            f
-00006020: 6f72 206c 2c20 7220 696e 207a 6970 280a  or l, r in zip(.
-00006030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006040: 7072 616e 6765 2830 2c20 6461 7461 2e73  prange(0, data.s
-00006050: 6861 7065 5b30 5d20 2b20 3129 2c20 7072  hape[0] + 1), pr
-00006060: 616e 6765 2877 696e 646f 775f 7369 7a65  ange(window_size
-00006070: 2c20 6461 7461 2e73 6861 7065 5b30 5d20  , data.shape[0] 
-00006080: 2b20 3129 0a20 2020 2020 2020 2020 2020  + 1).           
-00006090: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
-000060a0: 2020 2020 7361 6d70 6c65 203d 2028 6461      sample = (da
-000060b0: 7461 5b6c 3a72 5d20 2d20 6e70 2e6d 696e  ta[l:r] - np.min
-000060c0: 2864 6174 615b 6c3a 725d 2929 202f 2028  (data[l:r])) / (
-000060d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000060e0: 2020 2020 206e 702e 6d61 7828 6461 7461       np.max(data
-000060f0: 5b6c 3a72 5d29 202d 206e 702e 6d69 6e28  [l:r]) - np.min(
-00006100: 6461 7461 5b6c 3a72 5d29 0a20 2020 2020  data[l:r]).     
-00006110: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00006120: 2020 2020 2020 2020 2020 2020 2064 6572               der
-00006130: 6976 6174 6976 6520 3d20 7361 6d70 6c65  ivative = sample
-00006140: 5b31 3a5d 202d 2073 616d 706c 655b 3a2d  [1:] - sample[:-
-00006150: 315d 0a20 2020 2020 2020 2020 2020 2020  1].             
-00006160: 2020 2069 6620 6465 7269 7661 7469 7665     if derivative
-00006170: 2e73 6861 7065 5b30 5d20 3d3d 2030 3a0a  .shape[0] == 0:.
-00006180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006190: 2020 2020 7265 7375 6c74 735b 7220 2d20      results[r - 
-000061a0: 312c 2069 5d20 3d20 2d31 2e30 0a20 2020  1, i] = -1.0.   
-000061b0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-000061c0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000061d0: 2020 2020 2020 207a 432c 206c 6173 745f         zC, last_
-000061e0: 7661 6c20 3d20 302c 202d 310a 2020 2020  val = 0, -1.    
-000061f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006200: 6966 2064 6572 6976 6174 6976 655b 305d  if derivative[0]
-00006210: 203e 2030 2e30 3a0a 2020 2020 2020 2020   > 0.0:.        
-00006220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006230: 6c61 7374 5f76 616c 203d 2031 0a20 2020  last_val = 1.   
-00006240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006250: 2066 6f72 206a 2069 6e20 7072 616e 6765   for j in prange
-00006260: 2831 2c20 6465 7269 7661 7469 7665 2e73  (1, derivative.s
-00006270: 6861 7065 5b30 5d29 3a0a 2020 2020 2020  hape[0]):.      
-00006280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006290: 2020 6375 7272 656e 745f 7661 6c20 3d20    current_val = 
-000062a0: 2d31 0a20 2020 2020 2020 2020 2020 2020  -1.             
-000062b0: 2020 2020 2020 2020 2020 2069 6620 6465             if de
-000062c0: 7269 7661 7469 7665 5b6a 5d20 3e20 302e  rivative[j] > 0.
-000062d0: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-000062e0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-000062f0: 7572 7265 6e74 5f76 616c 203d 2031 0a20  urrent_val = 1. 
-00006300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006310: 2020 2020 2020 2069 6620 6c61 7374 5f76         if last_v
-00006320: 616c 2021 3d20 6375 7272 656e 745f 7661  al != current_va
-00006330: 6c3a 0a20 2020 2020 2020 2020 2020 2020  l:.             
-00006340: 2020 2020 2020 2020 2020 2020 2020 207a                 z
-00006350: 4320 2b3d 2031 0a20 2020 2020 2020 2020  C += 1.         
-00006360: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00006370: 6173 745f 7661 6c20 3d20 6375 7272 656e  ast_val = curren
-00006380: 745f 7661 6c0a 2020 2020 2020 2020 2020  t_val.          
-00006390: 2020 2020 2020 2020 2020 6966 207a 4320            if zC 
-000063a0: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
-000063b0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-000063c0: 7375 6c74 735b 7220 2d20 312c 2069 5d20  sults[r - 1, i] 
-000063d0: 3d20 2d31 2e30 0a20 2020 2020 2020 2020  = -1.0.         
-000063e0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-000063f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006400: 2020 2020 2020 2020 2072 6573 756c 7473           results
-00006410: 5b72 202d 2031 2c20 695d 203d 206e 702e  [r - 1, i] = np.
-00006420: 6c6f 6731 3028 7361 6d70 6c65 2e73 6861  log10(sample.sha
-00006430: 7065 5b30 5d29 202f 2028 0a20 2020 2020  pe[0]) / (.     
-00006440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006450: 2020 2020 2020 206e 702e 6c6f 6731 3028         np.log10(
-00006460: 7361 6d70 6c65 2e73 6861 7065 5b30 5d29  sample.shape[0])
-00006470: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006480: 2020 2020 2020 2020 2020 2020 202b 206e               + n
-00006490: 702e 6c6f 6731 3028 7361 6d70 6c65 2e73  p.log10(sample.s
-000064a0: 6861 7065 5b30 5d20 2f20 2873 616d 706c  hape[0] / (sampl
-000064b0: 652e 7368 6170 655b 305d 202b 2030 2e34  e.shape[0] + 0.4
-000064c0: 202a 207a 4329 290a 2020 2020 2020 2020   * zC)).        
-000064d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000064e0: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-000064f0: 6e20 7265 7375 6c74 732e 6173 7479 7065  n results.astype
-00006500: 286e 702e 666c 6f61 7433 3229 0a0a 2020  (np.float32)..  
-00006510: 2020 4073 7461 7469 636d 6574 686f 640a    @staticmethod.
-00006520: 2020 2020 406e 6a69 7428 2228 666c 6f61      @njit("(floa
-00006530: 7433 325b 3a5d 2c20 696e 7436 3429 2229  t32[:], int64)")
-00006540: 0a20 2020 2064 6566 2068 6967 7563 6869  .    def higuchi
-00006550: 5f66 7261 6374 616c 5f64 696d 656e 7369  _fractal_dimensi
-00006560: 6f6e 2864 6174 613a 206e 702e 6e64 6172  on(data: np.ndar
-00006570: 7261 792c 206b 6d61 783a 2069 6e74 203d  ray, kmax: int =
-00006580: 2031 3029 3a0a 2020 2020 2020 2020 2222   10):.        ""
-00006590: 220a 2020 2020 2020 2020 4a69 7474 6564  ".        Jitted
-000065a0: 2063 6f6d 7075 7465 206f 6620 7468 6520   compute of the 
-000065b0: 4869 6775 6368 6920 4672 6163 7461 6c20  Higuchi Fractal 
-000065c0: 4469 6d65 6e73 696f 6e20 6f66 2061 2067  Dimension of a g
-000065d0: 6976 656e 2074 696d 6520 7365 7269 6573  iven time series
-000065e0: 2064 6174 612e 2054 6865 2048 6967 7563   data. The Higuc
-000065f0: 6869 2046 7261 6374 616c 2044 696d 656e  hi Fractal Dimen
-00006600: 7369 6f6e 2070 726f 7669 6465 7320 6120  sion provides a 
-00006610: 6d65 6173 7572 6520 6f66 2074 6865 2066  measure of the f
-00006620: 7261 6374 616c 0a20 2020 2020 2020 2063  ractal.        c
-00006630: 6f6d 706c 6578 6974 7920 6f66 2061 2074  omplexity of a t
-00006640: 696d 6520 7365 7269 6573 2e0a 0a20 2020  ime series...   
-00006650: 2020 2020 2054 6865 206d 6178 696d 756d       The maximum
-00006660: 2076 616c 7565 206f 6620 6b20 7573 6564   value of k used
-00006670: 2069 6e20 7468 6520 6361 6c63 756c 6174   in the calculat
-00006680: 696f 6e2e 2049 6e63 7265 6173 696e 6720  ion. Increasing 
-00006690: 6b6d 6178 2063 6f6e 7369 6465 7273 206c  kmax considers l
-000066a0: 6f6e 6765 7220 7365 7175 656e 6365 730a  onger sequences.
-000066b0: 2020 2020 2020 2020 2020 2020 6f66 2064              of d
-000066c0: 6174 612c 2070 726f 7669 6469 6e67 2061  ata, providing a
-000066d0: 206d 6f72 6520 6465 7461 696c 6564 2061   more detailed a
-000066e0: 6e61 6c79 7369 7320 6f66 2066 7261 6374  nalysis of fract
-000066f0: 616c 2063 6f6d 706c 6578 6974 792e 2044  al complexity. D
-00006700: 6566 6175 6c74 2069 7320 3130 2e0a 0a20  efault is 10... 
-00006710: 2020 2020 2020 203a 7061 7261 6d65 7465         :paramete
-00006720: 7220 6e70 2e6e 6461 7272 6179 2064 6174  r np.ndarray dat
-00006730: 613a 2041 2031 2d64 696d 656e 7369 6f6e  a: A 1-dimension
-00006740: 616c 206e 756d 7079 2061 7272 6179 2063  al numpy array c
-00006750: 6f6e 7461 696e 696e 6720 7468 6520 7469  ontaining the ti
-00006760: 6d65 2073 6572 6965 7320 6461 7461 2e0a  me series data..
-00006770: 2020 2020 2020 2020 3a70 6172 616d 6574          :paramet
-00006780: 6572 2069 6e74 206b 6d61 783a 2054 6865  er int kmax: The
-00006790: 206d 6178 696d 756d 2076 616c 7565 206f   maximum value o
-000067a0: 6620 6b20 7573 6564 2069 6e20 7468 6520  f k used in the 
-000067b0: 6361 6c63 756c 6174 696f 6e2e 2049 6e63  calculation. Inc
-000067c0: 7265 6173 696e 6720 6b6d 6178 2063 6f6e  reasing kmax con
-000067d0: 7369 6465 7273 206c 6f6e 6765 7220 7365  siders longer se
-000067e0: 7175 656e 6365 7320 6f66 2064 6174 612c  quences of data,
-000067f0: 2070 726f 7669 6469 6e67 2061 206d 6f72   providing a mor
-00006800: 6520 6465 7461 696c 6564 2061 6e61 6c79  e detailed analy
-00006810: 7369 7320 6f66 2066 7261 6374 616c 2063  sis of fractal c
-00006820: 6f6d 706c 6578 6974 792e 2044 6566 6175  omplexity. Defau
-00006830: 6c74 2069 7320 3130 2e0a 2020 2020 2020  lt is 10..      
-00006840: 2020 3a72 6574 7572 6e73 2066 6c6f 6174    :returns float
-00006850: 3a20 5468 6520 4869 6775 6368 6920 4672  : The Higuchi Fr
-00006860: 6163 7461 6c20 4469 6d65 6e73 696f 6e20  actal Dimension 
-00006870: 6f66 2074 6865 2069 6e70 7574 2074 696d  of the input tim
-00006880: 6520 7365 7269 6573 2e0a 0a20 2020 2020  e series...     
-00006890: 2020 202e 2e20 6e6f 7465 3a3a 0a20 2020     .. note::.   
-000068a0: 2020 2020 2020 2020 2d20 4164 6170 7465          - Adapte
-000068b0: 6420 6672 6f6d 2060 6565 676c 6962 203c  d from `eeglib <
-000068c0: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
-000068d0: 6f6d 2f58 6975 6c31 3039 2f65 6567 6c69  om/Xiul109/eegli
-000068e0: 622f 3e60 5f2e 0a0a 2020 2020 2020 2020  b/>`_...        
-000068f0: 2e2e 206d 6174 683a 3a0a 2020 2020 2020  .. math::.      
-00006900: 2020 2020 2048 4644 203d 205c 5c66 7261       HFD = \\fra
-00006910: 637b 5c5c 6c6f 6728 4e29 7d7b 5c5c 6c6f  c{\\log(N)}{\\lo
-00006920: 6728 4e29 202b 205c 5c6c 6f67 5c5c 6c65  g(N) + \\log\\le
-00006930: 6674 285c 5c66 7261 637b 4e7d 7b4e 202b  ft(\\frac{N}{N +
-00006940: 2030 2e34 205c 5c63 646f 7420 7a43 7d5c   0.4 \\cdot zC}\
-00006950: 5c72 6967 6874 297d 0a0a 2020 2020 2020  \right)}..      
-00006960: 2020 3a65 7861 6d70 6c65 3a0a 2020 2020    :example:.    
-00006970: 2020 2020 3e3e 3e20 7420 3d20 6e70 2e6c      >>> t = np.l
-00006980: 696e 7370 6163 6528 302c 2035 302c 2069  inspace(0, 50, i
-00006990: 6e74 2834 3431 3030 202a 2032 2e30 292c  nt(44100 * 2.0),
-000069a0: 2065 6e64 706f 696e 743d 4661 6c73 6529   endpoint=False)
-000069b0: 0a20 2020 2020 2020 203e 3e3e 2073 696e  .        >>> sin
-000069c0: 655f 7761 7665 203d 2031 2e30 202a 206e  e_wave = 1.0 * n
-000069d0: 702e 7369 6e28 3220 2a20 6e70 2e70 6920  p.sin(2 * np.pi 
-000069e0: 2a20 312e 3020 2a20 7429 2e61 7374 7970  * 1.0 * t).astyp
-000069f0: 6528 6e70 2e66 6c6f 6174 3332 290a 2020  e(np.float32).  
-00006a00: 2020 2020 2020 3e3e 3e20 7369 6e65 5f77        >>> sine_w
-00006a10: 6176 6520 3d20 2873 696e 655f 7761 7665  ave = (sine_wave
-00006a20: 202d 206e 702e 6d69 6e28 7369 6e65 5f77   - np.min(sine_w
-00006a30: 6176 6529 2920 2f20 286e 702e 6d61 7828  ave)) / (np.max(
-00006a40: 7369 6e65 5f77 6176 6529 202d 206e 702e  sine_wave) - np.
-00006a50: 6d69 6e28 7369 6e65 5f77 6176 6529 290a  min(sine_wave)).
-00006a60: 2020 2020 2020 2020 3e3e 3e20 5469 6d65          >>> Time
-00006a70: 7365 7269 6573 4665 6174 7572 654d 6978  seriesFeatureMix
-00006a80: 696e 2829 2e68 6967 7563 6869 5f66 7261  in().higuchi_fra
-00006a90: 6374 616c 5f64 696d 656e 7369 6f6e 2864  ctal_dimension(d
-00006aa0: 6174 613d 6461 7461 2c20 6b6d 6178 3d31  ata=data, kmax=1
-00006ab0: 3029 0a20 2020 2020 2020 203e 3e3e 2031  0).        >>> 1
-00006ac0: 2e30 3030 3135 3036 3830 3534 3139 3932  .000150680541992
-00006ad0: 320a 2020 2020 2020 2020 3e3e 3e20 6e70  2.        >>> np
-00006ae0: 2e72 616e 646f 6d2e 7368 7566 666c 6528  .random.shuffle(
-00006af0: 7369 6e65 5f77 6176 6529 0a20 2020 2020  sine_wave).     
-00006b00: 2020 203e 3e3e 2054 696d 6573 6572 6965     >>> Timeserie
-00006b10: 7346 6561 7475 7265 4d69 7869 6e28 292e  sFeatureMixin().
-00006b20: 6869 6775 6368 695f 6672 6163 7461 6c5f  higuchi_fractal_
-00006b30: 6469 6d65 6e73 696f 6e28 6461 7461 3d64  dimension(data=d
-00006b40: 6174 612c 206b 6d61 783d 3130 290a 2020  ata, kmax=10).  
-00006b50: 2020 2020 2020 3e3e 3e20 312e 3939 3936        >>> 1.9996
-00006b60: 3430 3232 3633 3634 3133 3537 0a20 2020  402263641357.   
-00006b70: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-00006b80: 2020 4c2c 204e 203d 206e 702e 7a65 726f    L, N = np.zero
-00006b90: 7328 6b6d 6178 202d 2031 292c 206c 656e  s(kmax - 1), len
-00006ba0: 2864 6174 6129 0a20 2020 2020 2020 2078  (data).        x
-00006bb0: 203d 206e 702e 6873 7461 636b 280a 2020   = np.hstack(.  
-00006bc0: 2020 2020 2020 2020 2020 280a 2020 2020            (.    
-00006bd0: 2020 2020 2020 2020 2020 2020 2d6e 702e              -np.
-00006be0: 6c6f 6728 6e70 2e61 7261 6e67 6528 322c  log(np.arange(2,
-00006bf0: 206b 6d61 7820 2b20 3129 292e 7265 7368   kmax + 1)).resh
-00006c00: 6170 6528 2d31 2c20 3129 2e61 7374 7970  ape(-1, 1).astyp
-00006c10: 6528 6e70 2e66 6c6f 6174 3332 292c 0a20  e(np.float32),. 
-00006c20: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00006c30: 702e 6f6e 6573 286b 6d61 7820 2d20 3129  p.ones(kmax - 1)
-00006c40: 2e72 6573 6861 7065 282d 312c 2031 292e  .reshape(-1, 1).
-00006c50: 6173 7479 7065 286e 702e 666c 6f61 7433  astype(np.float3
-00006c60: 3229 2c0a 2020 2020 2020 2020 2020 2020  2),.            
-00006c70: 290a 2020 2020 2020 2020 290a 2020 2020  ).        ).    
-00006c80: 2020 2020 666f 7220 6b20 696e 2070 7261      for k in pra
-00006c90: 6e67 6528 322c 206b 6d61 7820 2b20 3129  nge(2, kmax + 1)
-00006ca0: 3a0a 2020 2020 2020 2020 2020 2020 4c6b  :.            Lk
-00006cb0: 203d 206e 702e 7a65 726f 7328 6b29 0a20   = np.zeros(k). 
-00006cc0: 2020 2020 2020 2020 2020 2066 6f72 206d             for m
-00006cd0: 2069 6e20 7261 6e67 6528 302c 206b 293a   in range(0, k):
-00006ce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006cf0: 204c 6d6b 203d 2030 0a20 2020 2020 2020   Lmk = 0.       
-00006d00: 2020 2020 2020 2020 2066 6f72 2069 2069           for i i
-00006d10: 6e20 7261 6e67 6528 312c 2028 4e20 2d20  n range(1, (N - 
-00006d20: 6d29 202f 2f20 6b29 3a0a 2020 2020 2020  m) // k):.      
-00006d30: 2020 2020 2020 2020 2020 2020 2020 4c6d                Lm
-00006d40: 6b20 2b3d 2061 6273 2864 6174 615b 6d20  k += abs(data[m 
-00006d50: 2b20 6920 2a20 6b5d 202d 2064 6174 615b  + i * k] - data[
-00006d60: 6d20 2b20 6920 2a20 6b20 2d20 6b5d 290a  m + i * k - k]).
-00006d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006d80: 6465 6e6f 6d69 6e61 746f 7220 3d20 2828  denominator = ((
-00006d90: 4e20 2d20 6d29 202f 2f20 6b29 202a 206b  N - m) // k) * k
-00006da0: 202a 206b 0a20 2020 2020 2020 2020 2020   * k.           
-00006db0: 2020 2020 2069 6620 6465 6e6f 6d69 6e61       if denomina
-00006dc0: 746f 7220 3d3d 2030 3a0a 2020 2020 2020  tor == 0:.      
-00006dd0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00006de0: 7475 726e 202d 310a 2020 2020 2020 2020  turn -1.        
-00006df0: 2020 2020 2020 2020 4c6b 5b6d 5d20 3d20          Lk[m] = 
-00006e00: 4c6d 6b20 2a20 284e 202d 2031 2920 2f20  Lmk * (N - 1) / 
-00006e10: 2828 284e 202d 206d 2920 2f2f 206b 2920  (((N - m) // k) 
-00006e20: 2a20 6b20 2a20 6b29 0a20 2020 2020 2020  * k * k).       
-00006e30: 2020 2020 204c 6175 7820 3d20 6e70 2e6d       Laux = np.m
-00006e40: 6561 6e28 4c6b 290a 2020 2020 2020 2020  ean(Lk).        
-00006e50: 2020 2020 4c61 7578 203d 2030 2e30 3120      Laux = 0.01 
-00006e60: 2f20 6b20 6966 204c 6175 7820 3d3d 2030  / k if Laux == 0
-00006e70: 2065 6c73 6520 4c61 7578 0a20 2020 2020   else Laux.     
-00006e80: 2020 2020 2020 204c 5b6b 202d 2032 5d20         L[k - 2] 
-00006e90: 3d20 6e70 2e6c 6f67 284c 6175 7829 0a0a  = np.log(Laux)..
-00006ea0: 2020 2020 2020 2020 7265 7475 726e 206e          return n
-00006eb0: 702e 6c69 6e61 6c67 2e6c 7374 7371 2878  p.linalg.lstsq(x
-00006ec0: 2c20 4c2e 6173 7479 7065 286e 702e 666c  , L.astype(np.fl
-00006ed0: 6f61 7433 3229 295b 305d 5b30 5d0a 0a20  oat32))[0][0].. 
-00006ee0: 2020 2040 7374 6174 6963 6d65 7468 6f64     @staticmethod
-00006ef0: 0a20 2020 2040 6e6a 6974 2822 2866 6c6f  .    @njit("(flo
-00006f00: 6174 3332 5b3a 5d2c 2069 6e74 3634 2c20  at32[:], int64, 
-00006f10: 696e 7436 342c 2922 2c20 6661 7374 6d61  int64,)", fastma
-00006f20: 7468 3d54 7275 6529 0a20 2020 2064 6566  th=True).    def
-00006f30: 2070 6572 6d75 7461 7469 6f6e 5f65 6e74   permutation_ent
-00006f40: 726f 7079 2864 6174 613a 206e 702e 6e64  ropy(data: np.nd
-00006f50: 6172 7261 792c 2064 696d 656e 7369 6f6e  array, dimension
-00006f60: 3a20 696e 742c 2064 656c 6179 3a20 696e  : int, delay: in
-00006f70: 7429 202d 3e20 666c 6f61 743a 0a20 2020  t) -> float:.   
-00006f80: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00006f90: 2043 616c 6375 6c61 7465 2074 6865 2070   Calculate the p
-00006fa0: 6572 6d75 7461 7469 6f6e 2065 6e74 726f  ermutation entro
-00006fb0: 7079 206f 6620 6120 7469 6d65 2073 6572  py of a time ser
-00006fc0: 6965 732e 0a0a 2020 2020 2020 2020 5065  ies...        Pe
-00006fd0: 726d 7574 6174 696f 6e20 656e 7472 6f70  rmutation entrop
-00006fe0: 7920 6973 2061 206d 6561 7375 7265 206f  y is a measure o
-00006ff0: 6620 7468 6520 636f 6d70 6c65 7869 7479  f the complexity
-00007000: 206f 6620 6120 7469 6d65 2073 6572 6965   of a time serie
-00007010: 7320 6461 7461 2062 7920 7175 616e 7469  s data by quanti
-00007020: 6679 696e 670a 2020 2020 2020 2020 7468  fying.        th
-00007030: 6520 6972 7265 6775 6c61 7269 7479 2061  e irregularity a
-00007040: 6e64 2075 6e70 7265 6469 6374 6162 696c  nd unpredictabil
-00007050: 6974 7920 6f66 2069 7473 206f 7264 6572  ity of its order
-00007060: 2070 6174 7465 726e 732e 2049 7420 6973   patterns. It is
-00007070: 2063 6f6d 7075 7465 6420 6261 7365 6420   computed based 
-00007080: 6f6e 2074 6865 0a20 2020 2020 2020 2066  on the.        f
-00007090: 7265 7175 656e 6379 206f 6620 756e 6971  requency of uniq
-000070a0: 7565 206f 7264 6572 2070 6174 7465 726e  ue order pattern
-000070b0: 7320 6f66 2061 2067 6976 656e 2064 696d  s of a given dim
-000070c0: 656e 7369 6f6e 2069 6e20 7468 6520 7469  ension in the ti
-000070d0: 6d65 2073 6572 6965 7320 6461 7461 2e0a  me series data..
-000070e0: 0a20 2020 2020 2020 2054 6865 2070 6572  .        The per
-000070f0: 6d75 7461 7469 6f6e 2065 6e74 726f 7079  mutation entropy
-00007100: 2028 5045 2920 6973 2063 616c 6375 6c61   (PE) is calcula
-00007110: 7465 6420 7573 696e 6720 7468 6520 666f  ted using the fo
-00007120: 6c6c 6f77 696e 6720 666f 726d 756c 613a  llowing formula:
-00007130: 0a0a 2020 2020 2020 2020 2e2e 206d 6174  ..        .. mat
-00007140: 683a 3a0a 2020 2020 2020 2020 2020 2020  h::.            
-00007150: 5045 203d 202d 205c 5c73 756d 2870 5f69  PE = - \\sum(p_i
-00007160: 205c 5c6c 6f67 2870 5f69 2929 0a0a 2020   \\log(p_i))..  
-00007170: 2020 2020 2020 7768 6572 653a 0a20 2020        where:.   
-00007180: 2020 2020 202d 2050 4520 6973 2074 6865       - PE is the
-00007190: 2070 6572 6d75 7461 7469 6f6e 2065 6e74   permutation ent
-000071a0: 726f 7079 2e0a 2020 2020 2020 2020 2d20  ropy..        - 
-000071b0: 705f 6920 6973 2074 6865 2070 726f 6261  p_i is the proba
-000071c0: 6269 6c69 7479 206f 6620 6561 6368 2075  bility of each u
-000071d0: 6e69 7175 6520 6f72 6465 7220 7061 7474  nique order patt
-000071e0: 6572 6e2e 0a0a 2020 2020 2020 2020 3a70  ern...        :p
-000071f0: 6172 616d 206e 756d 7079 2e6e 6461 7272  aram numpy.ndarr
-00007200: 6179 2064 6174 613a 2054 6865 2074 696d  ay data: The tim
-00007210: 6520 7365 7269 6573 2064 6174 6120 666f  e series data fo
-00007220: 7220 7768 6963 6820 7065 726d 7574 6174  r which permutat
-00007230: 696f 6e20 656e 7472 6f70 7920 6973 2063  ion entropy is c
-00007240: 616c 6375 6c61 7465 642e 0a20 2020 2020  alculated..     
-00007250: 2020 203a 7061 7261 6d20 696e 7420 6469     :param int di
-00007260: 6d65 6e73 696f 6e3a 2049 7420 7370 6563  mension: It spec
-00007270: 6966 6965 7320 7468 6520 6c65 6e67 7468  ifies the length
-00007280: 206f 6620 7468 6520 6f72 6465 7220 7061   of the order pa
-00007290: 7474 6572 6e73 2074 6f20 6265 2063 6f6e  tterns to be con
-000072a0: 7369 6465 7265 642e 0a20 2020 2020 2020  sidered..       
-000072b0: 203a 7061 7261 6d20 696e 7420 6465 6c61   :param int dela
-000072c0: 793a 2054 696d 6520 6465 6c61 7920 6265  y: Time delay be
-000072d0: 7477 6565 6e20 656c 656d 656e 7473 2069  tween elements i
-000072e0: 6e20 616e 206f 7264 6572 2070 6174 7465  n an order patte
-000072f0: 726e 2e0a 2020 2020 2020 2020 3a72 6574  rn..        :ret
-00007300: 7572 6e20 666c 6f61 743a 2054 6865 2070  urn float: The p
-00007310: 6572 6d75 7461 7469 6f6e 2065 6e74 726f  ermutation entro
-00007320: 7079 206f 6620 7468 6520 7469 6d65 2073  py of the time s
-00007330: 6572 6965 732c 2069 6e64 6963 6174 696e  eries, indicatin
-00007340: 6720 6974 7320 636f 6d70 6c65 7869 7479  g its complexity
-00007350: 2061 6e64 2070 7265 6469 6374 6162 696c   and predictabil
-00007360: 6974 792e 2041 2068 6967 6865 7220 7065  ity. A higher pe
-00007370: 726d 7574 6174 696f 6e20 656e 7472 6f70  rmutation entrop
-00007380: 7920 7661 6c75 6520 696e 6469 6361 7465  y value indicate
-00007390: 7320 6869 6768 6572 2063 6f6d 706c 6578  s higher complex
-000073a0: 6974 7920 616e 6420 756e 7072 6564 6963  ity and unpredic
-000073b0: 7461 6269 6c69 7479 2069 6e20 7468 6520  tability in the 
-000073c0: 7469 6d65 2073 6572 6965 732e 0a0a 2020  time series...  
-000073d0: 2020 2020 2020 3a65 7861 6d70 6c65 3a0a        :example:.
-000073e0: 2020 2020 2020 2020 3e3e 3e20 7420 3d20          >>> t = 
-000073f0: 6e70 2e6c 696e 7370 6163 6528 302c 2035  np.linspace(0, 5
-00007400: 302c 2069 6e74 2834 3431 3030 202a 2032  0, int(44100 * 2
-00007410: 2e30 292c 2065 6e64 706f 696e 743d 4661  .0), endpoint=Fa
-00007420: 6c73 6529 0a20 2020 2020 2020 203e 3e3e  lse).        >>>
-00007430: 2073 696e 655f 7761 7665 203d 2031 2e30   sine_wave = 1.0
-00007440: 202a 206e 702e 7369 6e28 3220 2a20 6e70   * np.sin(2 * np
-00007450: 2e70 6920 2a20 312e 3020 2a20 7429 2e61  .pi * 1.0 * t).a
-00007460: 7374 7970 6528 6e70 2e66 6c6f 6174 3332  stype(np.float32
-00007470: 290a 2020 2020 2020 2020 3e3e 3e20 5469  ).        >>> Ti
-00007480: 6d65 7365 7269 6573 4665 6174 7572 654d  meseriesFeatureM
-00007490: 6978 696e 2829 2e70 6572 6d75 7461 7469  ixin().permutati
-000074a0: 6f6e 5f65 6e74 726f 7079 2864 6174 613d  on_entropy(data=
-000074b0: 7369 6e65 5f77 6176 652c 2064 696d 656e  sine_wave, dimen
-000074c0: 7369 6f6e 3d33 2c20 6465 6c61 793d 3129  sion=3, delay=1)
-000074d0: 0a20 2020 2020 2020 203e 3e3e 2030 2e37  .        >>> 0.7
-000074e0: 3031 3937 3030 3538 3636 3634 3037 0a20  01970058666407. 
-000074f0: 2020 2020 2020 203e 3e3e 206e 702e 7261         >>> np.ra
-00007500: 6e64 6f6d 2e73 6875 6666 6c65 2873 696e  ndom.shuffle(sin
-00007510: 655f 7761 7665 290a 2020 2020 2020 2020  e_wave).        
-00007520: 3e3e 3e20 5469 6d65 7365 7269 6573 4665  >>> TimeseriesFe
-00007530: 6174 7572 654d 6978 696e 2829 2e70 6572  atureMixin().per
-00007540: 6d75 7461 7469 6f6e 5f65 6e74 726f 7079  mutation_entropy
-00007550: 2864 6174 613d 7369 6e65 5f77 6176 652c  (data=sine_wave,
-00007560: 2064 696d 656e 7369 6f6e 3d33 2c20 6465   dimension=3, de
-00007570: 6c61 793d 3129 0a20 2020 2020 2020 203e  lay=1).        >
-00007580: 3e3e 2031 2e37 3931 3732 3434 3939 3334  >> 1.79172449934
-00007590: 3630 340a 2020 2020 2020 2020 2222 220a  604.        """.
-000075a0: 0a20 2020 2020 2020 206e 2c20 7065 726d  .        n, perm
-000075b0: 7574 6174 696f 6e73 2c20 636f 756e 7473  utations, counts
-000075c0: 203d 206c 656e 2864 6174 6129 2c20 4c69   = len(data), Li
-000075d0: 7374 2829 2c20 4c69 7374 2829 0a20 2020  st(), List().   
-000075e0: 2020 2020 2066 6f72 2069 2069 6e20 7072       for i in pr
-000075f0: 616e 6765 286e 202d 2028 6469 6d65 6e73  ange(n - (dimens
-00007600: 696f 6e20 2d20 3129 202a 2064 656c 6179  ion - 1) * delay
-00007610: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-00007620: 6e64 6963 6573 203d 206e 702e 6172 616e  ndices = np.aran
-00007630: 6765 2869 2c20 6920 2b20 6469 6d65 6e73  ge(i, i + dimens
-00007640: 696f 6e20 2a20 6465 6c61 792c 2064 656c  ion * delay, del
-00007650: 6179 290a 2020 2020 2020 2020 2020 2020  ay).            
-00007660: 7065 726d 7574 6174 696f 6e20 3d20 4c69  permutation = Li
-00007670: 7374 286e 702e 6172 6773 6f72 7428 6461  st(np.argsort(da
-00007680: 7461 5b69 6e64 6963 6573 5d29 290a 2020  ta[indices])).  
-00007690: 2020 2020 2020 2020 2020 6973 5f75 6e69            is_uni
-000076a0: 7175 6520 3d20 5472 7565 0a20 2020 2020  que = True.     
-000076b0: 2020 2020 2020 2066 6f72 206a 2069 6e20         for j in 
-000076c0: 7261 6e67 6528 6c65 6e28 7065 726d 7574  range(len(permut
-000076d0: 6174 696f 6e73 2929 3a0a 2020 2020 2020  ations)):.      
-000076e0: 2020 2020 2020 2020 2020 7020 3d20 7065            p = pe
-000076f0: 726d 7574 6174 696f 6e73 5b6a 5d0a 2020  rmutations[j].  
-00007700: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00007710: 206c 656e 2870 2920 3d3d 206c 656e 2870   len(p) == len(p
-00007720: 6572 6d75 7461 7469 6f6e 293a 0a20 2020  ermutation):.   
-00007730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007740: 2069 735f 6571 7561 6c20 3d20 5472 7565   is_equal = True
-00007750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007760: 2020 2020 2066 6f72 206b 2069 6e20 7261       for k in ra
-00007770: 6e67 6528 6c65 6e28 7029 293a 0a20 2020  nge(len(p)):.   
-00007780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007790: 2020 2020 2069 6620 705b 6b5d 2021 3d20       if p[k] != 
-000077a0: 7065 726d 7574 6174 696f 6e5b 6b5d 3a0a  permutation[k]:.
-000077b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000077c0: 2020 2020 2020 2020 2020 2020 6973 5f65              is_e
-000077d0: 7175 616c 203d 2046 616c 7365 0a20 2020  qual = False.   
-000077e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000077f0: 2020 2020 2020 2020 2062 7265 616b 0a20           break. 
-00007800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007810: 2020 2069 6620 6973 5f65 7175 616c 3a0a     if is_equal:.
-00007820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007830: 2020 2020 2020 2020 6973 5f75 6e69 7175          is_uniqu
-00007840: 6520 3d20 4661 6c73 650a 2020 2020 2020  e = False.      
-00007850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007860: 2020 636f 756e 7473 5b6a 5d20 2b3d 2031    counts[j] += 1
-00007870: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007880: 2020 2020 2020 2020 2062 7265 616b 0a20           break. 
-00007890: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-000078a0: 5f75 6e69 7175 653a 0a20 2020 2020 2020  _unique:.       
-000078b0: 2020 2020 2020 2020 2070 6572 6d75 7461           permuta
-000078c0: 7469 6f6e 732e 6170 7065 6e64 2870 6572  tions.append(per
-000078d0: 6d75 7461 7469 6f6e 290a 2020 2020 2020  mutation).      
-000078e0: 2020 2020 2020 2020 2020 636f 756e 7473            counts
-000078f0: 2e61 7070 656e 6428 3129 0a0a 2020 2020  .append(1)..    
-00007900: 2020 2020 746f 7461 6c5f 7065 726d 7574      total_permut
-00007910: 6174 696f 6e73 203d 206c 656e 2870 6572  ations = len(per
-00007920: 6d75 7461 7469 6f6e 7329 0a20 2020 2020  mutations).     
-00007930: 2020 2070 726f 6273 203d 206e 702e 656d     probs = np.em
-00007940: 7074 7928 746f 7461 6c5f 7065 726d 7574  pty(total_permut
-00007950: 6174 696f 6e73 2c20 6474 7970 653d 7479  ations, dtype=ty
-00007960: 7065 732e 666c 6f61 7436 3429 0a20 2020  pes.float64).   
-00007970: 2020 2020 2066 6f72 2069 2069 6e20 7072       for i in pr
-00007980: 616e 6765 2874 6f74 616c 5f70 6572 6d75  ange(total_permu
-00007990: 7461 7469 6f6e 7329 3a0a 2020 2020 2020  tations):.      
-000079a0: 2020 2020 2020 7072 6f62 735b 695d 203d        probs[i] =
-000079b0: 2063 6f75 6e74 735b 695d 202f 2028 6e20   counts[i] / (n 
-000079c0: 2d20 2864 696d 656e 7369 6f6e 202d 2031  - (dimension - 1
-000079d0: 2920 2a20 6465 6c61 7929 0a0a 2020 2020  ) * delay)..    
-000079e0: 2020 2020 7265 7475 726e 202d 6e70 2e73      return -np.s
-000079f0: 756d 2870 726f 6273 202a 206e 702e 6c6f  um(probs * np.lo
-00007a00: 6728 7072 6f62 7329 290a 0a20 2020 2040  g(probs))..    @
-00007a10: 7374 6174 6963 6d65 7468 6f64 0a20 2020  staticmethod.   
-00007a20: 2040 6e6a 6974 2822 2866 6c6f 6174 3332   @njit("(float32
-00007a30: 5b3a 5d2c 2922 2c20 6661 7374 6d61 7468  [:],)", fastmath
-00007a40: 3d54 7275 6529 0a20 2020 2064 6566 206c  =True).    def l
-00007a50: 696e 655f 6c65 6e67 7468 2864 6174 613a  ine_length(data:
-00007a60: 206e 702e 6e64 6172 7261 7929 202d 3e20   np.ndarray) -> 
-00007a70: 666c 6f61 743a 0a20 2020 2020 2020 2022  float:.        "
-00007a80: 2222 0a20 2020 2020 2020 2043 616c 6375  "".        Calcu
-00007a90: 6c61 7465 2074 6865 206c 696e 6520 6c65  late the line le
-00007aa0: 6e67 7468 206f 6620 6120 3144 2061 7272  ngth of a 1D arr
-00007ab0: 6179 2e0a 0a20 2020 2020 2020 204c 696e  ay...        Lin
-00007ac0: 6520 6c65 6e67 7468 2069 7320 6120 6d65  e length is a me
-00007ad0: 6173 7572 6520 6f66 2073 6967 6e61 6c20  asure of signal 
-00007ae0: 636f 6d70 6c65 7869 7479 2061 6e64 2069  complexity and i
-00007af0: 7320 636f 6d70 7574 6564 2062 7920 7375  s computed by su
-00007b00: 6d6d 696e 6720 7468 6520 6162 736f 6c75  mming the absolu
-00007b10: 7465 0a20 2020 2020 2020 2064 6966 6665  te.        diffe
-00007b20: 7265 6e63 6573 2062 6574 7765 656e 2063  rences between c
-00007b30: 6f6e 7365 6375 7469 7665 2065 6c65 6d65  onsecutive eleme
-00007b40: 6e74 7320 6f66 2074 6865 2069 6e70 7574  nts of the input
-00007b50: 2061 7272 6179 2e20 5573 6564 2069 6e20   array. Used in 
-00007b60: 4545 470a 2020 2020 2020 2020 616e 616c  EEG.        anal
-00007b70: 7973 6973 2061 6e64 206f 7468 6572 2073  ysis and other s
-00007b80: 6967 6e61 6c20 7072 6f63 6573 7369 6e67  ignal processing
-00007b90: 2061 7070 6c69 6361 7469 6f6e 7320 746f   applications to
-00007ba0: 2071 7561 6e74 6966 7920 7661 7269 6174   quantify variat
-00007bb0: 696f 6e73 2069 6e20 7468 6520 7369 676e  ions in the sign
-00007bc0: 616c 2e0a 0a20 2020 2020 2020 203a 7061  al...        :pa
-00007bd0: 7261 6d20 6e75 6d70 792e 6e64 6172 7261  ram numpy.ndarra
-00007be0: 7920 6461 7461 3a20 5468 6520 3144 2061  y data: The 1D a
-00007bf0: 7272 6179 2066 6f72 2077 6869 6368 2074  rray for which t
-00007c00: 6865 206c 696e 6520 6c65 6e67 7468 2069  he line length i
-00007c10: 7320 746f 2062 6520 6361 6c63 756c 6174  s to be calculat
-00007c20: 6564 2e0a 2020 2020 2020 2020 3a72 6574  ed..        :ret
-00007c30: 7572 6e20 666c 6f61 743a 2054 6865 206c  urn float: The l
-00007c40: 696e 6520 6c65 6e67 7468 206f 6620 7468  ine length of th
-00007c50: 6520 696e 7075 7420 6172 7261 792c 2069  e input array, i
-00007c60: 6e64 6963 6174 696e 6720 6974 7320 636f  ndicating its co
-00007c70: 6d70 6c65 7869 7479 2e0a 0a20 2020 2020  mplexity...     
-00007c80: 2020 202e 2e20 6d61 7468 3a3a 0a0a 2020     .. math::..  
-00007c90: 2020 2020 2020 2020 2020 4c4c 203d 205c            LL = \
-00007ca0: 7375 6d5f 7b69 3d31 7d5e 7b4e 2d31 7d20  sum_{i=1}^{N-1} 
-00007cb0: 7c78 5b69 5d20 2d20 785b 692d 315d 7c0a  |x[i] - x[i-1]|.
-00007cc0: 0a20 2020 2020 2020 2077 6865 7265 3a0a  .        where:.
-00007cd0: 2020 2020 2020 2020 2d20 4c4c 2069 7320          - LL is 
-00007ce0: 7468 6520 6c69 6e65 206c 656e 6774 682e  the line length.
-00007cf0: 0a20 2020 2020 2020 202d 204e 2069 7320  .        - N is 
-00007d00: 7468 6520 6e75 6d62 6572 206f 6620 656c  the number of el
-00007d10: 656d 656e 7473 2069 6e20 7468 6520 696e  ements in the in
-00007d20: 7075 7420 6461 7461 2061 7272 6179 2e0a  put data array..
-00007d30: 2020 2020 2020 2020 2d20 785b 695d 2072          - x[i] r
-00007d40: 6570 7265 7365 6e74 7320 7468 6520 7661  epresents the va
-00007d50: 6c75 6520 6f66 2074 6865 2064 6174 6120  lue of the data 
-00007d60: 6174 2069 6e64 6578 2069 2e0a 0a0a 2020  at index i....  
-00007d70: 2020 2020 2020 2e2e 2069 6d61 6765 3a3a        .. image::
-00007d80: 205f 7374 6174 6963 2f69 6d67 2f6c 696e   _static/img/lin
-00007d90: 655f 6c65 6e67 7468 2e70 6e67 0a20 2020  e_length.png.   
-00007da0: 2020 2020 2020 2020 3a77 6964 7468 3a20          :width: 
-00007db0: 3630 300a 2020 2020 2020 2020 2020 203a  600.           :
-00007dc0: 616c 6967 6e3a 2063 656e 7465 720a 0a20  align: center.. 
-00007dd0: 2020 2020 2020 203a 6578 616d 706c 653a         :example:
-00007de0: 0a20 2020 2020 2020 203e 3e3e 2064 6174  .        >>> dat
-00007df0: 6120 3d20 6e70 2e61 7272 6179 285b 312c  a = np.array([1,
-00007e00: 2034 2c20 322c 2033 2c20 352c 2036 2c20   4, 2, 3, 5, 6, 
-00007e10: 382c 2037 2c20 392c 2031 305d 292e 6173  8, 7, 9, 10]).as
-00007e20: 7479 7065 286e 702e 666c 6f61 7433 3229  type(np.float32)
-00007e30: 0a20 2020 2020 2020 203e 3e3e 2054 696d  .        >>> Tim
-00007e40: 6573 6572 6965 7346 6561 7475 7265 4d69  eseriesFeatureMi
-00007e50: 7869 6e28 292e 6c69 6e65 5f6c 656e 6774  xin().line_lengt
-00007e60: 6828 6461 7461 3d64 6174 6129 0a20 2020  h(data=data).   
-00007e70: 2020 2020 203e 3e3e 2031 322e 300a 2020       >>> 12.0.  
-00007e80: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-00007e90: 2020 2064 6966 6620 3d20 6e70 2e61 6273     diff = np.abs
-00007ea0: 286e 702e 6469 6666 2864 6174 612e 6173  (np.diff(data.as
-00007eb0: 7479 7065 286e 702e 666c 6f61 7436 3429  type(np.float64)
-00007ec0: 2929 0a20 2020 2020 2020 2072 6574 7572  )).        retur
-00007ed0: 6e20 6e70 2e73 756d 2864 6966 6629 0a0a  n np.sum(diff)..
-00007ee0: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
-00007ef0: 640a 2020 2020 406e 6a69 7428 2228 666c  d.    @njit("(fl
-00007f00: 6f61 7433 325b 3a5d 2c20 666c 6f61 7436  oat32[:], float6
-00007f10: 345b 3a5d 2c20 696e 7436 3429 222c 2066  4[:], int64)", f
-00007f20: 6173 746d 6174 683d 5472 7565 290a 2020  astmath=True).  
-00007f30: 2020 6465 6620 736c 6964 696e 675f 6c69    def sliding_li
-00007f40: 6e65 5f6c 656e 6774 6828 0a20 2020 2020  ne_length(.     
-00007f50: 2020 2064 6174 613a 206e 702e 6e64 6172     data: np.ndar
-00007f60: 7261 792c 2077 696e 646f 775f 7369 7a65  ray, window_size
-00007f70: 733a 206e 702e 6e64 6172 7261 792c 2073  s: np.ndarray, s
-00007f80: 616d 706c 655f 7261 7465 3a20 696e 740a  ample_rate: int.
-00007f90: 2020 2020 2920 2d3e 206e 702e 6e64 6172      ) -> np.ndar
-00007fa0: 7261 793a 0a20 2020 2020 2020 2022 2222  ray:.        """
-00007fb0: 0a20 2020 2020 2020 204a 6974 7465 6420  .        Jitted 
-00007fc0: 636f 6d70 7574 6520 6f66 2020 736c 6964  compute of  slid
-00007fd0: 696e 6720 6c69 6e65 206c 656e 6774 6820  ing line length 
-00007fe0: 666f 7220 6120 6769 7665 6e20 7469 6d65  for a given time
-00007ff0: 2073 6572 6965 7320 7573 696e 6720 6469   series using di
-00008000: 6666 6572 656e 7420 7769 6e64 6f77 2073  fferent window s
-00008010: 697a 6573 2e0a 0a20 2020 2020 2020 2054  izes...        T
-00008020: 6865 2066 756e 6374 696f 6e20 636f 6d70  he function comp
-00008030: 7574 6573 206c 696e 6520 6c65 6e67 7468  utes line length
-00008040: 2066 6f72 2074 6865 2069 6e70 7574 2064   for the input d
-00008050: 6174 6120 7573 696e 6720 7661 7269 6f75  ata using variou
-00008060: 7320 7769 6e64 6f77 2073 697a 6573 2e20  s window sizes. 
-00008070: 4974 2072 6574 7572 6e73 2061 2032 4420  It returns a 2D 
-00008080: 6172 7261 7920 7768 6572 6520 6561 6368  array where each
-00008090: 2072 6f77 0a20 2020 2020 2020 2063 6f72   row.        cor
-000080a0: 7265 7370 6f6e 6473 2074 6f20 6120 706f  responds to a po
-000080b0: 7369 7469 6f6e 2069 6e20 7468 6520 7469  sition in the ti
-000080c0: 6d65 2073 6572 6965 732c 2061 6e64 2065  me series, and e
-000080d0: 6163 6820 636f 6c75 6d6e 2063 6f72 7265  ach column corre
-000080e0: 7370 6f6e 6473 2074 6f20 6120 6469 6666  sponds to a diff
-000080f0: 6572 656e 7420 7769 6e64 6f77 2073 697a  erent window siz
-00008100: 652e 2054 6865 206c 696e 6520 6c65 6e67  e. The line leng
-00008110: 7468 0a20 2020 2020 2020 2069 7320 6361  th.        is ca
-00008120: 6c63 756c 6174 6564 2066 6f72 2065 6163  lculated for eac
-00008130: 6820 7769 6e64 6f77 2c20 616e 6420 7468  h window, and th
-00008140: 6520 7265 7375 6c74 7320 6172 6520 7265  e results are re
-00008150: 7475 726e 6564 2061 7320 6120 3244 2061  turned as a 2D a
-00008160: 7272 6179 206f 6620 666c 6f61 7433 3220  rray of float32 
-00008170: 7661 6c75 6573 2e0a 0a20 2020 2020 2020  values...       
-00008180: 203a 7061 7261 6d20 6e70 2e6e 6461 7272   :param np.ndarr
-00008190: 6179 2064 6174 613a 2031 4420 6172 7261  ay data: 1D arra
-000081a0: 7920 696e 7075 7420 6461 7461 2e0a 2020  y input data..  
-000081b0: 2020 2020 2020 3a70 6172 616d 2077 696e        :param win
-000081c0: 646f 775f 7369 7a65 733a 2041 6e20 6172  dow_sizes: An ar
-000081d0: 7261 7920 6f66 2077 696e 646f 7720 7369  ray of window si
-000081e0: 7a65 7320 2869 6e20 7365 636f 6e64 7329  zes (in seconds)
-000081f0: 2074 6f20 7573 6520 666f 7220 6c69 6e65   to use for line
-00008200: 206c 656e 6774 6820 6361 6c63 756c 6174   length calculat
-00008210: 696f 6e2e 0a20 2020 2020 2020 203a 7061  ion..        :pa
-00008220: 7261 6d20 7361 6d70 6c65 5f72 6174 653a  ram sample_rate:
-00008230: 2054 6865 2073 616d 706c 696e 6720 7261   The sampling ra
-00008240: 7465 2028 7361 6d70 6c65 7320 7065 7220  te (samples per 
-00008250: 7365 636f 6e64 2920 6f66 2074 6865 2074  second) of the t
-00008260: 696d 6520 7365 7269 6573 2064 6174 612e  ime series data.
-00008270: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-00008280: 206e 702e 6e64 6172 7261 793a 2041 2032   np.ndarray: A 2
-00008290: 4420 6172 7261 7920 636f 6e74 6169 6e69  D array containi
-000082a0: 6e67 206c 696e 6520 6c65 6e67 7468 2076  ng line length v
-000082b0: 616c 7565 7320 666f 7220 6561 6368 2077  alues for each w
-000082c0: 696e 646f 7720 7369 7a65 2061 7420 6561  indow size at ea
-000082d0: 6368 2070 6f73 6974 696f 6e20 696e 2074  ch position in t
-000082e0: 6865 2074 696d 6520 7365 7269 6573 2e0a  he time series..
-000082f0: 0a20 2020 2020 2020 202e 2e20 696d 6167  .        .. imag
-00008300: 653a 3a20 5f73 7461 7469 632f 696d 672f  e:: _static/img/
-00008310: 736c 6964 696e 675f 6c69 6e65 5f6c 656e  sliding_line_len
-00008320: 6774 682e 706e 670a 2020 2020 2020 2020  gth.png.        
-00008330: 2020 203a 7769 6474 683a 2036 3030 0a20     :width: 600. 
-00008340: 2020 2020 2020 2020 2020 3a61 6c69 676e            :align
-00008350: 3a20 6365 6e74 6572 0a0a 2020 2020 2020  : center..      
-00008360: 2020 3a65 7861 6d70 6c65 733a 0a20 2020    :examples:.   
-00008370: 2020 2020 203e 3e3e 2064 6174 6120 3d20       >>> data = 
-00008380: 6e70 2e61 7272 6179 285b 312c 2034 2c20  np.array([1, 4, 
-00008390: 322c 2033 2c20 352c 2036 2c20 382c 2037  2, 3, 5, 6, 8, 7
-000083a0: 2c20 392c 2031 305d 292e 6173 7479 7065  , 9, 10]).astype
-000083b0: 286e 702e 666c 6f61 7433 3229 0a20 2020  (np.float32).   
-000083c0: 2020 2020 203e 3e3e 2054 696d 6573 6572       >>> Timeser
-000083d0: 6965 7346 6561 7475 7265 4d69 7869 6e28  iesFeatureMixin(
-000083e0: 292e 736c 6964 696e 675f 6c69 6e65 5f6c  ).sliding_line_l
-000083f0: 656e 6774 6828 6461 7461 3d64 6174 612c  ength(data=data,
-00008400: 2077 696e 646f 775f 7369 7a65 733d 6e70   window_sizes=np
-00008410: 2e61 7272 6179 285b 312e 305d 292c 2073  .array([1.0]), s
-00008420: 616d 706c 655f 7261 7465 3d32 290a 2020  ample_rate=2).  
-00008430: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-00008440: 2020 2072 6573 756c 7473 203d 206e 702e     results = np.
-00008450: 6675 6c6c 2828 6461 7461 2e73 6861 7065  full((data.shape
-00008460: 5b30 5d2c 2077 696e 646f 775f 7369 7a65  [0], window_size
-00008470: 732e 7368 6170 655b 305d 292c 202d 312e  s.shape[0]), -1.
-00008480: 3029 0a20 2020 2020 2020 2066 6f72 2069  0).        for i
-00008490: 2069 6e20 7072 616e 6765 2877 696e 646f   in prange(windo
-000084a0: 775f 7369 7a65 732e 7368 6170 655b 305d  w_sizes.shape[0]
-000084b0: 293a 0a20 2020 2020 2020 2020 2020 2077  ):.            w
-000084c0: 696e 646f 775f 7369 7a65 203d 2069 6e74  indow_size = int
-000084d0: 2877 696e 646f 775f 7369 7a65 735b 695d  (window_sizes[i]
-000084e0: 202a 2073 616d 706c 655f 7261 7465 290a   * sample_rate).
-000084f0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00008500: 6c2c 2072 2069 6e20 7a69 7028 0a20 2020  l, r in zip(.   
-00008510: 2020 2020 2020 2020 2020 2020 2070 7261               pra
-00008520: 6e67 6528 302c 2064 6174 612e 7368 6170  nge(0, data.shap
-00008530: 655b 305d 202b 2031 292c 2070 7261 6e67  e[0] + 1), prang
-00008540: 6528 7769 6e64 6f77 5f73 697a 652c 2064  e(window_size, d
-00008550: 6174 612e 7368 6170 655b 305d 202b 2031  ata.shape[0] + 1
-00008560: 290a 2020 2020 2020 2020 2020 2020 293a  ).            ):
-00008570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008580: 2073 616d 706c 6520 3d20 6461 7461 5b6c   sample = data[l
-00008590: 3a72 5d0a 2020 2020 2020 2020 2020 2020  :r].            
-000085a0: 2020 2020 7265 7375 6c74 735b 7220 2d20      results[r - 
-000085b0: 312c 2069 5d20 3d20 6e70 2e73 756d 286e  1, i] = np.sum(n
-000085c0: 702e 6162 7328 6e70 2e64 6966 6628 7361  p.abs(np.diff(sa
-000085d0: 6d70 6c65 2e61 7374 7970 6528 6e70 2e66  mple.astype(np.f
-000085e0: 6c6f 6174 3634 2929 2929 0a20 2020 2020  loat64)))).     
-000085f0: 2020 2072 6574 7572 6e20 7265 7375 6c74     return result
-00008600: 732e 6173 7479 7065 286e 702e 666c 6f61  s.astype(np.floa
-00008610: 7433 3229 0a0a 2020 2020 4073 7461 7469  t32)..    @stati
-00008620: 636d 6574 686f 640a 2020 2020 406e 6a69  cmethod.    @nji
-00008630: 7428 2228 666c 6f61 7433 325b 3a5d 2c20  t("(float32[:], 
-00008640: 666c 6f61 7436 345b 3a5d 2c20 696e 7436  float64[:], int6
-00008650: 3429 222c 2066 6173 746d 6174 683d 5472  4)", fastmath=Tr
-00008660: 7565 2c20 6361 6368 653d 5472 7565 290a  ue, cache=True).
-00008670: 2020 2020 6465 6620 736c 6964 696e 675f      def sliding_
-00008680: 7661 7269 616e 6365 280a 2020 2020 2020  variance(.      
-00008690: 2020 6461 7461 3a20 6e70 2e6e 6461 7272    data: np.ndarr
-000086a0: 6179 2c20 7769 6e64 6f77 5f73 697a 6573  ay, window_sizes
-000086b0: 3a20 6e70 2e6e 6461 7272 6179 2c20 7361  : np.ndarray, sa
-000086c0: 6d70 6c65 5f72 6174 653a 2069 6e74 0a20  mple_rate: int. 
-000086d0: 2020 2029 202d 3e20 6e70 2e6e 6461 7272     ) -> np.ndarr
-000086e0: 6179 3a0a 2020 2020 2020 2020 2222 220a  ay:.        """.
-000086f0: 2020 2020 2020 2020 4a69 7474 6564 2063          Jitted c
-00008700: 6f6d 7075 7465 206f 6620 7468 6520 7661  ompute of the va
-00008710: 7269 616e 6365 206f 6620 6461 7461 2077  riance of data w
-00008720: 6974 6869 6e20 736c 6964 696e 6720 7769  ithin sliding wi
-00008730: 6e64 6f77 7320 6f66 2076 6172 7969 6e67  ndows of varying
-00008740: 2073 697a 6573 2061 7070 6c69 6564 2074   sizes applied t
-00008750: 6f0a 2020 2020 2020 2020 7468 6520 696e  o.        the in
-00008760: 7075 7420 6461 7461 2061 7272 6179 2e20  put data array. 
-00008770: 5661 7269 616e 6365 2069 7320 6120 6d65  Variance is a me
-00008780: 6173 7572 6520 6f66 2064 6174 6120 6469  asure of data di
-00008790: 7370 6572 7369 6f6e 206f 7220 7370 7265  spersion or spre
-000087a0: 6164 2e0a 0a20 2020 2020 2020 202e 2e20  ad...        .. 
-000087b0: 696d 6167 653a 3a20 5f73 7461 7469 632f  image:: _static/
-000087c0: 696d 672f 736c 6964 696e 675f 7661 7269  img/sliding_vari
-000087d0: 616e 6365 2e70 6e67 0a20 2020 2020 2020  ance.png.       
-000087e0: 2020 2020 3a77 6964 7468 3a20 3630 300a      :width: 600.
-000087f0: 2020 2020 2020 2020 2020 203a 616c 6967             :alig
-00008800: 6e3a 2063 656e 7465 720a 0a20 2020 2020  n: center..     
-00008810: 2020 203a 7061 7261 6d20 6461 7461 3a20     :param data: 
-00008820: 3164 2069 6e70 7574 2064 6174 6120 6172  1d input data ar
-00008830: 7261 792e 0a20 2020 2020 2020 203a 7061  ray..        :pa
-00008840: 7261 6d20 7769 6e64 6f77 5f73 697a 6573  ram window_sizes
-00008850: 3a20 4172 7261 7920 6f66 2077 696e 646f  : Array of windo
-00008860: 7720 7369 7a65 7320 2869 6e20 7365 636f  w sizes (in seco
-00008870: 6e64 7329 2e0a 2020 2020 2020 2020 3a70  nds)..        :p
-00008880: 6172 616d 2073 616d 706c 655f 7261 7465  aram sample_rate
-00008890: 3a20 5361 6d70 6c69 6e67 2072 6174 6520  : Sampling rate 
-000088a0: 6f66 2074 6865 2064 6174 6120 696e 2073  of the data in s
-000088b0: 616d 706c 6573 2070 6572 2073 6563 6f6e  amples per secon
-000088c0: 642e 0a20 2020 2020 2020 203a 7265 7475  d..        :retu
-000088d0: 726e 3a20 5661 7269 616e 6365 2076 616c  rn: Variance val
-000088e0: 7565 7320 666f 7220 6561 6368 2077 696e  ues for each win
-000088f0: 646f 7720 7369 7a65 2061 6e64 2064 6174  dow size and dat
-00008900: 6120 706f 696e 742e 2054 6865 2073 6861  a point. The sha
-00008910: 7065 206f 6620 7468 6520 7265 7375 6c74  pe of the result
-00008920: 2061 7272 6179 2069 7320 2864 6174 612e   array is (data.
-00008930: 7368 6170 655b 305d 2c20 7769 6e64 6f77  shape[0], window
-00008940: 5f73 697a 6573 2e73 6861 7065 5b30 5d29  _sizes.shape[0])
-00008950: 2e0a 0a20 2020 2020 2020 203a 6578 616d  ...        :exam
-00008960: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
-00008970: 2064 6174 6120 3d20 6e70 2e61 7272 6179   data = np.array
-00008980: 285b 312c 2032 2c20 332c 2031 2c20 322c  ([1, 2, 3, 1, 2,
-00008990: 2039 2c20 3137 2c20 322c 2031 302c 2034   9, 17, 2, 10, 4
-000089a0: 5d29 2e61 7374 7970 6528 6e70 2e66 6c6f  ]).astype(np.flo
-000089b0: 6174 3332 290a 2020 2020 2020 2020 3e3e  at32).        >>
-000089c0: 3e20 5469 6d65 7365 7269 6573 4665 6174  > TimeseriesFeat
-000089d0: 7572 654d 6978 696e 2829 2e73 6c69 6469  ureMixin().slidi
-000089e0: 6e67 5f76 6172 6961 6e63 6528 6461 7461  ng_variance(data
-000089f0: 3d64 6174 612c 2077 696e 646f 775f 7369  =data, window_si
-00008a00: 7a65 733d 6e70 2e61 7272 6179 285b 302e  zes=np.array([0.
-00008a10: 355d 292c 2073 616d 706c 655f 7261 7465  5]), sample_rate
-00008a20: 3d31 3029 0a20 2020 2020 2020 203e 3e3e  =10).        >>>
-00008a30: 205b 5b2d 312e 5d2c 5b2d 312e 5d2c 5b2d   [[-1.],[-1.],[-
-00008a40: 312e 5d2c 5b2d 312e 5d2c 5b20 302e 3536  1.],[-1.],[ 0.56
-00008a50: 5d2c 5b20 382e 3233 5d2c 5b33 352e 3834  ],[ 8.23],[35.84
-00008a60: 5d2c 5b33 392e 3230 5d2c 5b33 342e 3135  ],[39.20],[34.15
-00008a70: 5d2c 5b33 302e 3135 5d5d 290a 2020 2020  ],[30.15]]).    
-00008a80: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-00008a90: 2072 6573 756c 7473 203d 206e 702e 6675   results = np.fu
-00008aa0: 6c6c 2828 6461 7461 2e73 6861 7065 5b30  ll((data.shape[0
-00008ab0: 5d2c 2077 696e 646f 775f 7369 7a65 732e  ], window_sizes.
-00008ac0: 7368 6170 655b 305d 292c 202d 312e 3029  shape[0]), -1.0)
-00008ad0: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
-00008ae0: 6e20 7072 616e 6765 2877 696e 646f 775f  n prange(window_
-00008af0: 7369 7a65 732e 7368 6170 655b 305d 293a  sizes.shape[0]):
-00008b00: 0a20 2020 2020 2020 2020 2020 2077 696e  .            win
-00008b10: 646f 775f 7369 7a65 203d 2069 6e74 2877  dow_size = int(w
-00008b20: 696e 646f 775f 7369 7a65 735b 695d 202a  indow_sizes[i] *
-00008b30: 2073 616d 706c 655f 7261 7465 290a 2020   sample_rate).  
-00008b40: 2020 2020 2020 2020 2020 666f 7220 6c2c            for l,
-00008b50: 2072 2069 6e20 7a69 7028 0a20 2020 2020   r in zip(.     
-00008b60: 2020 2020 2020 2020 2020 2070 7261 6e67             prang
-00008b70: 6528 302c 2064 6174 612e 7368 6170 655b  e(0, data.shape[
-00008b80: 305d 202b 2031 292c 2070 7261 6e67 6528  0] + 1), prange(
-00008b90: 7769 6e64 6f77 5f73 697a 652c 2064 6174  window_size, dat
-00008ba0: 612e 7368 6170 655b 305d 202b 2031 290a  a.shape[0] + 1).
-00008bb0: 2020 2020 2020 2020 2020 2020 293a 0a20              ):. 
-00008bc0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00008bd0: 616d 706c 6520 3d20 6461 7461 5b6c 3a72  ample = data[l:r
-00008be0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00008bf0: 2020 7265 7375 6c74 735b 7220 2d20 312c    results[r - 1,
-00008c00: 2069 5d20 3d20 6e70 2e76 6172 2873 616d   i] = np.var(sam
-00008c10: 706c 6529 0a0a 2020 2020 2020 2020 7265  ple)..        re
-00008c20: 7475 726e 2072 6573 756c 7473 2e61 7374  turn results.ast
-00008c30: 7970 6528 6e70 2e66 6c6f 6174 3332 290a  ype(np.float32).
-00008c40: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
-00008c50: 6f64 0a20 2020 2040 6e6a 6974 280a 2020  od.    @njit(.  
-00008c60: 2020 2020 2020 2228 666c 6f61 7433 325b        "(float32[
-00008c70: 3a5d 2c20 666c 6f61 7436 345b 3a5d 2c20  :], float64[:], 
-00008c80: 696e 7436 342c 2074 7970 6573 2e4c 6973  int64, types.Lis
-00008c90: 7454 7970 6528 7479 7065 732e 756e 6963  tType(types.unic
-00008ca0: 6f64 655f 7479 7065 2929 222c 0a20 2020  ode_type))",.   
-00008cb0: 2020 2020 2066 6173 746d 6174 683d 5472       fastmath=Tr
-00008cc0: 7565 2c0a 2020 2020 2020 2020 6361 6368  ue,.        cach
-00008cd0: 653d 5472 7565 2c0a 2020 2020 290a 2020  e=True,.    ).  
-00008ce0: 2020 6465 6620 736c 6964 696e 675f 6465    def sliding_de
-00008cf0: 7363 7269 7074 6976 655f 7374 6174 6973  scriptive_statis
-00008d00: 7469 6373 280a 2020 2020 2020 2020 6461  tics(.        da
-00008d10: 7461 3a20 6e70 2e6e 6461 7272 6179 2c0a  ta: np.ndarray,.
-00008d20: 2020 2020 2020 2020 7769 6e64 6f77 5f73          window_s
-00008d30: 697a 6573 3a20 6e70 2e6e 6461 7272 6179  izes: np.ndarray
-00008d40: 2c0a 2020 2020 2020 2020 7361 6d70 6c65  ,.        sample
-00008d50: 5f72 6174 653a 2069 6e74 2c0a 2020 2020  _rate: int,.    
-00008d60: 2020 2020 7374 6174 6973 7469 6373 3a20      statistics: 
-00008d70: 4c69 7465 7261 6c5b 0a20 2020 2020 2020  Literal[.       
-00008d80: 2020 2020 2022 7661 7222 2c0a 2020 2020       "var",.    
-00008d90: 2020 2020 2020 2020 226d 6178 222c 0a20          "max",. 
-00008da0: 2020 2020 2020 2020 2020 2022 6d69 6e22             "min"
-00008db0: 2c0a 2020 2020 2020 2020 2020 2020 2273  ,.            "s
-00008dc0: 7464 222c 0a20 2020 2020 2020 2020 2020  td",.           
-00008dd0: 2022 6d65 6469 616e 222c 0a20 2020 2020   "median",.     
-00008de0: 2020 2020 2020 2022 6d65 616e 222c 0a20         "mean",. 
-00008df0: 2020 2020 2020 2020 2020 2022 6d61 6422             "mad"
-00008e00: 2c0a 2020 2020 2020 2020 2020 2020 2273  ,.            "s
-00008e10: 756d 222c 0a20 2020 2020 2020 2020 2020  um",.           
-00008e20: 2022 6d61 6322 2c0a 2020 2020 2020 2020   "mac",.        
-00008e30: 2020 2020 2272 6d73 222c 0a20 2020 2020      "rms",.     
-00008e40: 2020 2020 2020 2022 6162 7365 6e65 7267         "absenerg
-00008e50: 7922 2c0a 2020 2020 2020 2020 5d2c 0a20  y",.        ],. 
-00008e60: 2020 2029 202d 3e20 6e70 2e6e 6461 7272     ) -> np.ndarr
-00008e70: 6179 3a0a 2020 2020 2020 2020 2222 220a  ay:.        """.
-00008e80: 2020 2020 2020 2020 4a69 7474 6564 2063          Jitted c
-00008e90: 6f6d 7075 7465 206f 6620 6465 7363 7269  ompute of descri
-00008ea0: 7074 6976 6520 7374 6174 6973 7469 6373  ptive statistics
-00008eb0: 206f 7665 7220 736c 6964 696e 6720 7769   over sliding wi
-00008ec0: 6e64 6f77 7320 696e 2031 4420 6461 7461  ndows in 1D data
-00008ed0: 2061 7272 6179 2e0a 0a20 2020 2020 2020   array...       
-00008ee0: 2043 6f6d 7075 7465 7320 7661 7269 6f75   Computes variou
-00008ef0: 7320 6465 7363 7269 7074 6976 6520 7374  s descriptive st
-00008f00: 6174 6973 7469 6373 2028 652e 672e 2c20  atistics (e.g., 
-00008f10: 7661 7269 616e 6365 2c20 6d61 7869 6d75  variance, maximu
-00008f20: 6d2c 206d 696e 696d 756d 2c20 7374 616e  m, minimum, stan
-00008f30: 6461 7264 2064 6576 6961 7469 6f6e 2c0a  dard deviation,.
-00008f40: 2020 2020 2020 2020 6d65 6469 616e 2c20          median, 
-00008f50: 6d65 616e 2c20 6d65 6469 616e 2061 6273  mean, median abs
-00008f60: 6f6c 7574 6520 6465 7669 6174 696f 6e29  olute deviation)
-00008f70: 2066 6f72 2073 6c69 6469 6e67 2077 696e   for sliding win
-00008f80: 646f 7773 206f 6620 7661 7279 696e 6720  dows of varying 
-00008f90: 7369 7a65 7320 6170 706c 6965 6420 746f  sizes applied to
-00008fa0: 2074 6865 2069 6e70 7574 2064 6174 6120   the input data 
-00008fb0: 6172 7261 792e 0a0a 2020 2020 2020 2020  array...        
-00008fc0: 3a70 6172 616d 206e 702e 6e64 6172 7261  :param np.ndarra
-00008fd0: 7920 6461 7461 3a20 3144 2069 6e70 7574  y data: 1D input
-00008fe0: 2064 6174 6120 6172 7261 792e 0a20 2020   data array..   
-00008ff0: 2020 2020 203a 7061 7261 6d20 6e70 2e6e       :param np.n
-00009000: 6461 7272 6179 2077 696e 646f 775f 7369  darray window_si
-00009010: 7a65 733a 2041 7272 6179 206f 6620 7769  zes: Array of wi
-00009020: 6e64 6f77 2073 697a 6573 2028 696e 2073  ndow sizes (in s
-00009030: 6563 6f6e 6473 292e 0a20 2020 2020 2020  econds)..       
-00009040: 203a 7061 7261 6d20 696e 7420 7361 6d70   :param int samp
-00009050: 6c65 5f72 6174 653a 2053 616d 706c 696e  le_rate: Samplin
-00009060: 6720 7261 7465 206f 6620 7468 6520 6461  g rate of the da
-00009070: 7461 2069 6e20 7361 6d70 6c65 7320 7065  ta in samples pe
-00009080: 7220 7365 636f 6e64 2e0a 2020 2020 2020  r second..      
-00009090: 2020 3a70 6172 616d 2074 7970 6573 2e4c    :param types.L
-000090a0: 6973 7454 7970 6528 7479 7065 732e 756e  istType(types.un
-000090b0: 6963 6f64 655f 7479 7065 2920 7374 6174  icode_type) stat
-000090c0: 6973 7469 6373 3a20 4c69 7374 206f 6620  istics: List of 
-000090d0: 7374 6174 6973 7469 6373 2074 6f20 636f  statistics to co
-000090e0: 6d70 7574 652e 204f 7074 696f 6e73 3a20  mpute. Options: 
-000090f0: 2776 6172 272c 2027 6d61 7827 2c20 276d  'var', 'max', 'm
-00009100: 696e 272c 2027 7374 6427 2c20 276d 6564  in', 'std', 'med
-00009110: 6961 6e27 2c20 276d 6561 6e27 2c20 276d  ian', 'mean', 'm
-00009120: 6164 272c 2027 7375 6d27 2c20 276d 6163  ad', 'sum', 'mac
-00009130: 272c 2027 726d 7327 2c20 2761 6273 5f65  ', 'rms', 'abs_e
-00009140: 6e65 7267 7927 2e0a 2020 2020 2020 2020  nergy'..        
-00009150: 3a72 6574 7572 6e20 6e70 2e6e 6461 7272  :return np.ndarr
-00009160: 6179 3a20 4172 7261 7920 636f 6e74 6169  ay: Array contai
-00009170: 6e69 6e67 2074 6865 2073 656c 6563 7465  ning the selecte
-00009180: 6420 6465 7363 7269 7074 6976 6520 7374  d descriptive st
-00009190: 6174 6973 7469 6373 2066 6f72 2065 6163  atistics for eac
-000091a0: 6820 7769 6e64 6f77 2073 697a 652c 2064  h window size, d
-000091b0: 6174 6120 706f 696e 742c 2061 6e64 2073  ata point, and s
-000091c0: 7461 7469 7374 6963 2074 7970 652e 2054  tatistic type. T
-000091d0: 6865 2073 6861 7065 206f 6620 7468 6520  he shape of the 
-000091e0: 7265 7375 6c74 2061 7272 6179 2069 7320  result array is 
-000091f0: 286c 656e 2873 7461 7469 7374 6963 7329  (len(statistics)
-00009200: 2c20 6461 7461 2e73 6861 7065 5b30 5d2c  , data.shape[0],
-00009210: 2077 696e 646f 775f 7369 7a65 732e 7368   window_sizes.sh
-00009220: 6170 655b 3029 2e0a 0a20 2020 2020 2020  ape[0)...       
-00009230: 202e 2e20 6e6f 7465 3a3a 0a20 2020 2020   .. note::.     
-00009240: 2020 2020 2020 2d20 5468 6520 6073 7461        - The `sta
-00009250: 7469 7374 6963 7360 2070 6172 616d 6574  tistics` paramet
-00009260: 6572 2073 686f 756c 6420 6265 2061 206c  er should be a l
-00009270: 6973 7420 636f 6e74 6169 6e69 6e67 206f  ist containing o
-00009280: 6e65 206f 7220 6d6f 7265 206f 6620 7468  ne or more of th
-00009290: 6520 666f 6c6c 6f77 696e 6720 7374 6174  e following stat
-000092a0: 6973 7469 6373 3a0a 2020 2020 2020 2020  istics:.        
-000092b0: 2020 2027 7661 7227 2028 7661 7269 616e     'var' (varian
-000092c0: 6365 292c 2027 6d61 7827 2028 6d61 7869  ce), 'max' (maxi
-000092d0: 6d75 6d29 2c20 276d 696e 2720 286d 696e  mum), 'min' (min
-000092e0: 696d 756d 292c 2027 7374 6427 2028 7374  imum), 'std' (st
-000092f0: 616e 6461 7264 2064 6576 6961 7469 6f6e  andard deviation
-00009300: 292c 2027 6d65 6469 616e 2720 286d 6564  ), 'median' (med
-00009310: 6961 6e29 2c0a 2020 2020 2020 2020 2020  ian),.          
-00009320: 2027 6d65 616e 2720 286d 6561 6e29 2c20   'mean' (mean), 
-00009330: 276d 6164 2720 286d 6564 6961 6e20 6162  'mad' (median ab
-00009340: 736f 6c75 7465 2064 6576 6961 7469 6f6e  solute deviation
-00009350: 292c 2027 7375 6d27 2028 7375 6d29 2c20  ), 'sum' (sum), 
-00009360: 276d 6163 2720 286d 6561 6e20 6162 736f  'mac' (mean abso
-00009370: 6c75 7465 2063 6861 6e67 6529 2c0a 2020  lute change),.  
-00009380: 2020 2020 2020 2020 2027 726d 7327 2028           'rms' (
-00009390: 726f 6f74 206d 6561 6e20 7371 7561 7265  root mean square
-000093a0: 292c 2027 6162 7365 6e65 7267 7927 2028  ), 'absenergy' (
-000093b0: 6162 736f 6c75 7465 2065 6e65 7267 7929  absolute energy)
-000093c0: 2e0a 2020 2020 2020 2020 2020 202d 2049  ..           - I
-000093d0: 6620 7468 6520 7374 6174 6973 7469 6373  f the statistics
-000093e0: 206c 6973 7420 6973 205b 2776 6172 272c   list is ['var',
-000093f0: 2027 6d61 7827 2c20 276d 6561 6e27 5d2c   'max', 'mean'],
-00009400: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
-00009410: 3372 6420 6469 6d65 6e73 696f 6e20 6f72  3rd dimension or
-00009420: 6465 7220 696e 2074 6865 2072 6573 756c  der in the resul
-00009430: 7420 6172 7261 7920 7769 6c6c 2062 653a  t array will be:
-00009440: 205b 7661 7269 616e 6365 2c20 6d61 7869   [variance, maxi
-00009450: 6d75 6d2c 206d 6561 6e5d 0a0a 2020 2020  mum, mean]..    
-00009460: 2020 2020 3a65 7861 6d70 6c65 3a0a 2020      :example:.  
-00009470: 2020 2020 2020 3e3e 3e20 6461 7461 203d        >>> data =
-00009480: 206e 702e 6172 7261 7928 5b31 2c20 342c   np.array([1, 4,
-00009490: 2032 2c20 332c 2035 2c20 362c 2038 2c20   2, 3, 5, 6, 8, 
-000094a0: 372c 2039 2c20 3130 5d29 2e61 7374 7970  7, 9, 10]).astyp
-000094b0: 6528 6e70 2e66 6c6f 6174 3332 290a 2020  e(np.float32).  
-000094c0: 2020 2020 2020 3e3e 3e20 7265 7375 6c74        >>> result
-000094d0: 7320 3d20 5469 6d65 7365 7269 6573 4665  s = TimeseriesFe
-000094e0: 6174 7572 654d 6978 696e 2829 2e73 6c69  atureMixin().sli
-000094f0: 6469 6e67 5f64 6573 6372 6970 7469 7665  ding_descriptive
-00009500: 5f73 7461 7469 7374 6963 7328 6461 7461  _statistics(data
-00009510: 3d64 6174 612c 2077 696e 646f 775f 7369  =data, window_si
-00009520: 7a65 733d 6e70 2e61 7272 6179 285b 312e  zes=np.array([1.
-00009530: 302c 2035 2e30 5d29 2c20 7361 6d70 6c65  0, 5.0]), sample
-00009540: 5f72 6174 653d 322c 2073 7461 7469 7374  _rate=2, statist
-00009550: 6963 733d 7479 7065 642e 4c69 7374 285b  ics=typed.List([
-00009560: 2776 6172 272c 2027 6d61 7827 5d29 290a  'var', 'max'])).
-00009570: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
-00009580: 2020 2020 2072 6573 756c 7473 203d 206e       results = n
-00009590: 702e 6675 6c6c 2828 6c65 6e28 7374 6174  p.full((len(stat
-000095a0: 6973 7469 6373 292c 2064 6174 612e 7368  istics), data.sh
-000095b0: 6170 655b 305d 2c20 7769 6e64 6f77 5f73  ape[0], window_s
-000095c0: 697a 6573 2e73 6861 7065 5b30 5d29 2c20  izes.shape[0]), 
-000095d0: 2d31 2e30 290a 2020 2020 2020 2020 666f  -1.0).        fo
-000095e0: 7220 6a20 696e 2070 7261 6e67 6528 6c65  r j in prange(le
-000095f0: 6e28 7374 6174 6973 7469 6373 2929 3a0a  n(statistics)):.
-00009600: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00009610: 6920 696e 2070 7261 6e67 6528 7769 6e64  i in prange(wind
-00009620: 6f77 5f73 697a 6573 2e73 6861 7065 5b30  ow_sizes.shape[0
-00009630: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
-00009640: 2020 2020 7769 6e64 6f77 5f73 697a 6520      window_size 
-00009650: 3d20 696e 7428 7769 6e64 6f77 5f73 697a  = int(window_siz
-00009660: 6573 5b69 5d20 2a20 7361 6d70 6c65 5f72  es[i] * sample_r
-00009670: 6174 6529 0a20 2020 2020 2020 2020 2020  ate).           
-00009680: 2020 2020 2066 6f72 206c 2c20 7220 696e       for l, r in
-00009690: 207a 6970 280a 2020 2020 2020 2020 2020   zip(.          
-000096a0: 2020 2020 2020 2020 2020 7072 616e 6765            prange
-000096b0: 2830 2c20 6461 7461 2e73 6861 7065 5b30  (0, data.shape[0
-000096c0: 5d20 2b20 3129 2c20 7072 616e 6765 2877  ] + 1), prange(w
-000096d0: 696e 646f 775f 7369 7a65 2c20 6461 7461  indow_size, data
-000096e0: 2e73 6861 7065 5b30 5d20 2b20 3129 0a20  .shape[0] + 1). 
-000096f0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00009700: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00009710: 2020 2020 2020 7361 6d70 6c65 203d 2064        sample = d
-00009720: 6174 615b 6c3a 725d 0a20 2020 2020 2020  ata[l:r].       
-00009730: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00009740: 7374 6174 6973 7469 6373 5b6a 5d20 3d3d  statistics[j] ==
-00009750: 2022 7661 7222 3a0a 2020 2020 2020 2020   "var":.        
-00009760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009770: 7265 7375 6c74 735b 6a2c 2072 202d 2031  results[j, r - 1
-00009780: 2c20 695d 203d 206e 702e 7661 7228 7361  , i] = np.var(sa
-00009790: 6d70 6c65 290a 2020 2020 2020 2020 2020  mple).          
-000097a0: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
-000097b0: 7461 7469 7374 6963 735b 6a5d 203d 3d20  tatistics[j] == 
-000097c0: 226d 6178 223a 0a20 2020 2020 2020 2020  "max":.         
-000097d0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000097e0: 6573 756c 7473 5b6a 2c20 7220 2d20 312c  esults[j, r - 1,
-000097f0: 2069 5d20 3d20 6e70 2e6d 6178 2873 616d   i] = np.max(sam
-00009800: 706c 6529 0a20 2020 2020 2020 2020 2020  ple).           
-00009810: 2020 2020 2020 2020 2065 6c69 6620 7374           elif st
-00009820: 6174 6973 7469 6373 5b6a 5d20 3d3d 2022  atistics[j] == "
-00009830: 6d69 6e22 3a0a 2020 2020 2020 2020 2020  min":.          
-00009840: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00009850: 7375 6c74 735b 6a2c 2072 202d 2031 2c20  sults[j, r - 1, 
-00009860: 695d 203d 206e 702e 6d69 6e28 7361 6d70  i] = np.min(samp
-00009870: 6c65 290a 2020 2020 2020 2020 2020 2020  le).            
-00009880: 2020 2020 2020 2020 656c 6966 2073 7461          elif sta
-00009890: 7469 7374 6963 735b 6a5d 203d 3d20 2273  tistics[j] == "s
-000098a0: 7464 223a 0a20 2020 2020 2020 2020 2020  td":.           
-000098b0: 2020 2020 2020 2020 2020 2020 2072 6573               res
-000098c0: 756c 7473 5b6a 2c20 7220 2d20 312c 2069  ults[j, r - 1, i
-000098d0: 5d20 3d20 6e70 2e73 7464 2873 616d 706c  ] = np.std(sampl
-000098e0: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
-000098f0: 2020 2020 2020 2065 6c69 6620 7374 6174         elif stat
-00009900: 6973 7469 6373 5b6a 5d20 3d3d 2022 6d65  istics[j] == "me
-00009910: 6469 616e 223a 0a20 2020 2020 2020 2020  dian":.         
-00009920: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00009930: 6573 756c 7473 5b6a 2c20 7220 2d20 312c  esults[j, r - 1,
-00009940: 2069 5d20 3d20 6e70 2e6d 6564 6961 6e28   i] = np.median(
-00009950: 7361 6d70 6c65 290a 2020 2020 2020 2020  sample).        
-00009960: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-00009970: 2073 7461 7469 7374 6963 735b 6a5d 203d   statistics[j] =
-00009980: 3d20 226d 6561 6e22 3a0a 2020 2020 2020  = "mean":.      
-00009990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000099a0: 2020 7265 7375 6c74 735b 6a2c 2072 202d    results[j, r -
-000099b0: 2031 2c20 695d 203d 206e 702e 6d65 616e   1, i] = np.mean
-000099c0: 2873 616d 706c 6529 0a20 2020 2020 2020  (sample).       
-000099d0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-000099e0: 6620 7374 6174 6973 7469 6373 5b6a 5d20  f statistics[j] 
-000099f0: 3d3d 2022 6d61 6422 3a0a 2020 2020 2020  == "mad":.      
-00009a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009a10: 2020 7265 7375 6c74 735b 6a2c 2072 202d    results[j, r -
-00009a20: 2031 2c20 695d 203d 206e 702e 6d65 6469   1, i] = np.medi
-00009a30: 616e 280a 2020 2020 2020 2020 2020 2020  an(.            
-00009a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009a50: 6e70 2e61 6273 2873 616d 706c 6520 2d20  np.abs(sample - 
-00009a60: 6e70 2e6d 6564 6961 6e28 7361 6d70 6c65  np.median(sample
-00009a70: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
-00009a80: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00009a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009aa0: 2065 6c69 6620 7374 6174 6973 7469 6373   elif statistics
-00009ab0: 5b6a 5d20 3d3d 2022 7375 6d22 3a0a 2020  [j] == "sum":.  
-00009ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009ad0: 2020 2020 2020 7265 7375 6c74 735b 6a2c        results[j,
-00009ae0: 2072 202d 2031 2c20 695d 203d 206e 702e   r - 1, i] = np.
-00009af0: 7375 6d28 7361 6d70 6c65 290a 2020 2020  sum(sample).    
-00009b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009b10: 656c 6966 2073 7461 7469 7374 6963 735b  elif statistics[
-00009b20: 6a5d 203d 3d20 226d 6163 223a 0a20 2020  j] == "mac":.   
-00009b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009b40: 2020 2020 2072 6573 756c 7473 5b6a 2c20       results[j, 
-00009b50: 7220 2d20 312c 2069 5d20 3d20 6e70 2e6d  r - 1, i] = np.m
-00009b60: 6561 6e28 6e70 2e61 6273 2873 616d 706c  ean(np.abs(sampl
-00009b70: 655b 313a 5d20 2d20 7361 6d70 6c65 5b3a  e[1:] - sample[:
-00009b80: 2d31 5d29 290a 2020 2020 2020 2020 2020  -1])).          
-00009b90: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
-00009ba0: 7461 7469 7374 6963 735b 6a5d 203d 3d20  tatistics[j] == 
-00009bb0: 2272 6d73 223a 0a20 2020 2020 2020 2020  "rms":.         
-00009bc0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00009bd0: 6573 756c 7473 5b6a 2c20 7220 2d20 312c  esults[j, r - 1,
-00009be0: 2069 5d20 3d20 6e70 2e73 7172 7428 6e70   i] = np.sqrt(np
-00009bf0: 2e6d 6561 6e28 7361 6d70 6c65 2a2a 3229  .mean(sample**2)
-00009c00: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00009c10: 2020 2020 2020 656c 6966 2073 7461 7469        elif stati
-00009c20: 7374 6963 735b 6a5d 203d 3d20 2261 6273  stics[j] == "abs
-00009c30: 656e 6572 6779 223a 0a20 2020 2020 2020  energy":.       
-00009c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009c50: 2072 6573 756c 7473 5b6a 2c20 7220 2d20   results[j, r - 
-00009c60: 312c 2069 5d20 3d20 6e70 2e73 7172 7428  1, i] = np.sqrt(
-00009c70: 6e70 2e73 756d 2873 616d 706c 652a 2a32  np.sum(sample**2
-00009c80: 2929 0a0a 2020 2020 2020 2020 7265 7475  ))..        retu
-00009c90: 726e 2072 6573 756c 7473 2e61 7374 7970  rn results.astyp
-00009ca0: 6528 6e70 2e66 6c6f 6174 3332 290a 0a20  e(np.float32).. 
-00009cb0: 2020 2040 7374 6174 6963 6d65 7468 6f64     @staticmethod
-00009cc0: 0a20 2020 2064 6566 2064 6f6d 696e 616e  .    def dominan
-00009cd0: 745f 6672 6571 7565 6e63 6965 7328 0a20  t_frequencies(. 
-00009ce0: 2020 2020 2020 2064 6174 613a 206e 702e         data: np.
-00009cf0: 6e64 6172 7261 792c 0a20 2020 2020 2020  ndarray,.       
-00009d00: 2066 7073 3a20 666c 6f61 742c 0a20 2020   fps: float,.   
-00009d10: 2020 2020 206b 3a20 696e 742c 0a20 2020       k: int,.   
-00009d20: 2020 2020 2077 696e 646f 775f 6675 6e63       window_func
-00009d30: 7469 6f6e 3a20 4c69 7465 7261 6c5b 2248  tion: Literal["H
-00009d40: 616e 6e22 2c20 2248 616d 6d69 6e67 222c  ann", "Hamming",
-00009d50: 2022 426c 6163 6b6d 616e 225d 203d 204e   "Blackman"] = N
-00009d60: 6f6e 652c 0a20 2020 2029 3a0a 2020 2020  one,.    ):.    
-00009d70: 2020 2020 2222 2246 696e 6420 7468 6520      """Find the 
-00009d80: 4b20 646f 6d69 6e61 6e74 2066 7265 7175  K dominant frequ
-00009d90: 656e 6369 6573 2077 6974 6869 6e20 6120  encies within a 
-00009da0: 6665 6174 7572 6520 7665 6374 6f72 2222  feature vector""
-00009db0: 220a 0a20 2020 2020 2020 2069 6620 7769  "..        if wi
-00009dc0: 6e64 6f77 5f66 756e 6374 696f 6e20 3d3d  ndow_function ==
-00009dd0: 2022 4861 6e6e 223a 0a20 2020 2020 2020   "Hann":.       
-00009de0: 2020 2020 2064 6174 6120 3d20 6461 7461       data = data
-00009df0: 202a 206e 702e 6861 6e6e 696e 6728 6c65   * np.hanning(le
-00009e00: 6e28 6461 7461 2929 0a20 2020 2020 2020  n(data)).       
-00009e10: 2065 6c69 6620 7769 6e64 6f77 5f66 756e   elif window_fun
-00009e20: 6374 696f 6e20 3d3d 2022 4861 6d6d 696e  ction == "Hammin
-00009e30: 6722 3a0a 2020 2020 2020 2020 2020 2020  g":.            
-00009e40: 6461 7461 203d 2064 6174 6120 2a20 6e70  data = data * np
-00009e50: 2e68 616d 6d69 6e67 286c 656e 2864 6174  .hamming(len(dat
-00009e60: 6129 290a 2020 2020 2020 2020 656c 6966  a)).        elif
-00009e70: 2077 696e 646f 775f 6675 6e63 7469 6f6e   window_function
-00009e80: 203d 3d20 2242 6c61 636b 6d61 6e22 3a0a   == "Blackman":.
-00009e90: 2020 2020 2020 2020 2020 2020 6461 7461              data
-00009ea0: 203d 2064 6174 6120 2a20 6e70 2e62 6c61   = data * np.bla
-00009eb0: 636b 6d61 6e28 6c65 6e28 6461 7461 2929  ckman(len(data))
-00009ec0: 0a20 2020 2020 2020 2066 6674 5f72 6573  .        fft_res
-00009ed0: 756c 7420 3d20 6e70 2e66 6674 2e66 6674  ult = np.fft.fft
-00009ee0: 2864 6174 6129 0a20 2020 2020 2020 2066  (data).        f
-00009ef0: 7265 7175 656e 6369 6573 203d 206e 702e  requencies = np.
-00009f00: 6666 742e 6666 7466 7265 7128 6461 7461  fft.fftfreq(data
-00009f10: 2e73 6861 7065 5b30 5d2c 2031 202f 2066  .shape[0], 1 / f
-00009f20: 7073 290a 2020 2020 2020 2020 6d61 676e  ps).        magn
-00009f30: 6974 7564 6520 3d20 6e70 2e61 6273 2866  itude = np.abs(f
-00009f40: 6674 5f72 6573 756c 7429 0a0a 2020 2020  ft_result)..    
-00009f50: 2020 2020 7265 7475 726e 2066 7265 7175      return frequ
-00009f60: 656e 6369 6573 5b6e 702e 6172 6773 6f72  encies[np.argsor
-00009f70: 7428 6d61 676e 6974 7564 6529 5b2d 286b  t(magnitude)[-(k
-00009f80: 202b 2031 2920 3a20 2d31 5d5d 0a0a 2020   + 1) : -1]]..  
-00009f90: 2020 4073 7461 7469 636d 6574 686f 640a    @staticmethod.
-00009fa0: 2020 2020 406e 6a69 7428 0a20 2020 2020      @njit(.     
-00009fb0: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
-00009fc0: 2028 666c 6f61 7433 325b 3a5d 2c20 666c   (float32[:], fl
-00009fd0: 6f61 7436 342c 2062 6f6f 6c65 616e 292c  oat64, boolean),
-00009fe0: 0a20 2020 2020 2020 2020 2020 2028 666c  .            (fl
-00009ff0: 6f61 7433 325b 3a5d 2c20 666c 6f61 7436  oat32[:], float6
-0000a000: 342c 2074 7970 6573 2e6d 6973 632e 4f6d  4, types.misc.Om
-0000a010: 6974 7465 6428 5472 7565 2929 2c0a 2020  itted(True)),.  
-0000a020: 2020 2020 2020 5d0a 2020 2020 290a 2020        ].    ).  
-0000a030: 2020 6465 6620 6c6f 6e67 6573 745f 7374    def longest_st
-0000a040: 7269 6b65 2864 6174 613a 206e 702e 6e64  rike(data: np.nd
-0000a050: 6172 7261 792c 2074 6872 6573 686f 6c64  array, threshold
-0000a060: 3a20 666c 6f61 742c 2061 626f 7665 3a20  : float, above: 
-0000a070: 626f 6f6c 203d 2054 7275 6529 202d 3e20  bool = True) -> 
-0000a080: 696e 743a 0a20 2020 2020 2020 2022 2222  int:.        """
-0000a090: 0a20 2020 2020 2020 204a 6974 7465 6420  .        Jitted 
-0000a0a0: 636f 6d70 7574 6520 6f66 2074 6865 206c  compute of the l
-0000a0b0: 656e 6774 6820 6f66 2074 6865 206c 6f6e  ength of the lon
-0000a0c0: 6765 7374 2063 6f6e 7365 6375 7469 7665  gest consecutive
-0000a0d0: 2073 6571 7565 6e63 6520 6f66 2076 616c   sequence of val
-0000a0e0: 7565 7320 696e 2074 6865 2069 6e70 7574  ues in the input
-0000a0f0: 2064 6174 6120 7468 6174 2065 6974 6865   data that eithe
-0000a100: 7220 6578 6365 6564 0a20 2020 2020 2020  r exceed.       
-0000a110: 206f 7220 6661 6c6c 2062 656c 6f77 2061   or fall below a
-0000a120: 2073 7065 6369 6669 6564 2074 6872 6573   specified thres
-0000a130: 686f 6c64 2e0a 0a20 2020 2020 2020 202e  hold...        .
-0000a140: 2e20 696d 6167 653a 3a20 5f73 7461 7469  . image:: _stati
-0000a150: 632f 696d 672f 6c6f 6e67 6573 745f 7374  c/img/longest_st
-0000a160: 7269 6b65 2e70 6e67 0a20 2020 2020 2020  rike.png.       
-0000a170: 2020 2020 3a77 6964 7468 3a20 3730 300a      :width: 700.
-0000a180: 2020 2020 2020 2020 2020 203a 616c 6967             :alig
-0000a190: 6e3a 2063 656e 7465 720a 0a20 2020 2020  n: center..     
-0000a1a0: 2020 203a 7061 7261 6d20 6e70 2e6e 6461     :param np.nda
-0000a1b0: 7272 6179 2064 6174 613a 2054 6865 2069  rray data: The i
-0000a1c0: 6e70 7574 2031 4420 4e75 6d50 7920 6172  nput 1D NumPy ar
-0000a1d0: 7261 7920 636f 6e74 6169 6e69 6e67 2074  ray containing t
-0000a1e0: 6865 2076 616c 7565 7320 746f 2062 6520  he values to be 
-0000a1f0: 616e 616c 797a 6564 2e0a 2020 2020 2020  analyzed..      
-0000a200: 2020 3a70 6172 616d 2066 6c6f 6174 2074    :param float t
-0000a210: 6872 6573 686f 6c64 3a20 5468 6520 7468  hreshold: The th
-0000a220: 7265 7368 6f6c 6420 7661 6c75 6520 7573  reshold value us
-0000a230: 6564 2066 6f72 2074 6865 2063 6f6d 7061  ed for the compa
-0000a240: 7269 736f 6e2e 0a20 2020 2020 2020 203a  rison..        :
-0000a250: 7061 7261 6d20 626f 6f6c 2061 626f 7665  param bool above
-0000a260: 3a20 4966 2054 7275 652c 2074 6865 2066  : If True, the f
-0000a270: 756e 6374 696f 6e20 6c6f 6f6b 7320 666f  unction looks fo
-0000a280: 7220 7374 7269 6b65 7320 7768 6572 6520  r strikes where 
-0000a290: 7661 6c75 6573 2061 7265 2061 626f 7665  values are above
-0000a2a0: 206f 7220 6571 7561 6c20 746f 2074 6865   or equal to the
-0000a2b0: 2074 6872 6573 686f 6c64 2e20 4966 2046   threshold. If F
-0000a2c0: 616c 7365 2c20 6974 206c 6f6f 6b73 2066  alse, it looks f
-0000a2d0: 6f72 2073 7472 696b 6573 2077 6865 7265  or strikes where
-0000a2e0: 2076 616c 7565 7320 6172 6520 6265 6c6f   values are belo
-0000a2f0: 7720 6f72 2065 7175 616c 2074 6f20 7468  w or equal to th
-0000a300: 6520 7468 7265 7368 6f6c 642e 0a20 2020  e threshold..   
-0000a310: 2020 2020 203a 7265 7475 726e 2069 6e74       :return int
-0000a320: 3a20 5468 6520 6c65 6e67 7468 206f 6620  : The length of 
-0000a330: 7468 6520 6c6f 6e67 6573 7420 7374 7269  the longest stri
-0000a340: 6b65 2074 6861 7420 7361 7469 7366 6965  ke that satisfie
-0000a350: 7320 7468 6520 636f 6e64 6974 696f 6e2e  s the condition.
-0000a360: 0a0a 2020 2020 2020 2020 3a65 7861 6d70  ..        :examp
-0000a370: 6c65 3a0a 2020 2020 2020 2020 3e3e 3e20  le:.        >>> 
-0000a380: 6461 7461 203d 206e 702e 6172 7261 7928  data = np.array(
-0000a390: 5b31 2c20 382c 2032 2c20 3130 2c20 382c  [1, 8, 2, 10, 8,
-0000a3a0: 2036 2c20 382c 2031 2c20 312c 2031 5d29   6, 8, 1, 1, 1])
-0000a3b0: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
-0000a3c0: 3332 290a 2020 2020 2020 2020 3e3e 3e20  32).        >>> 
-0000a3d0: 5469 6d65 7365 7269 6573 4665 6174 7572  TimeseriesFeatur
-0000a3e0: 654d 6978 696e 2829 2e6c 6f6e 6765 7374  eMixin().longest
-0000a3f0: 5f73 7472 696b 6528 6461 7461 3d64 6174  _strike(data=dat
-0000a400: 612c 2074 6872 6573 686f 6c64 3d37 2c20  a, threshold=7, 
-0000a410: 6162 6f76 653d 5472 7565 290a 2020 2020  above=True).    
-0000a420: 2020 2020 3e3e 3e20 320a 2020 2020 2020      >>> 2.      
-0000a430: 2020 3e3e 3e20 5469 6d65 7365 7269 6573    >>> Timeseries
-0000a440: 4665 6174 7572 654d 6978 696e 2829 2e6c  FeatureMixin().l
-0000a450: 6f6e 6765 7374 5f73 7472 696b 6528 6461  ongest_strike(da
-0000a460: 7461 3d64 6174 612c 2074 6872 6573 686f  ta=data, thresho
-0000a470: 6c64 3d37 2c20 6162 6f76 653d 4661 6c73  ld=7, above=Fals
-0000a480: 6529 0a20 2020 2020 2020 203e 3e3e 2033  e).        >>> 3
-0000a490: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-0000a4a0: 2020 2020 2020 7265 7375 6c74 2c20 6c2c        result, l,
-0000a4b0: 2072 2c20 636e 7420 3d20 2d6e 702e 696e   r, cnt = -np.in
-0000a4c0: 662c 2030 2c20 302c 2030 0a20 2020 2020  f, 0, 0, 0.     
-0000a4d0: 2020 2077 6869 6c65 206c 203c 2064 6174     while l < dat
-0000a4e0: 612e 7368 6170 655b 305d 3a0a 2020 2020  a.shape[0]:.    
-0000a4f0: 2020 2020 2020 2020 6966 2061 626f 7665          if above
-0000a500: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000a510: 2020 6966 2064 6174 615b 6c5d 203e 3d20    if data[l] >= 
-0000a520: 7468 7265 7368 6f6c 643a 0a20 2020 2020  threshold:.     
-0000a530: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0000a540: 6e74 2c20 7220 3d20 636e 7420 2b20 312c  nt, r = cnt + 1,
-0000a550: 2072 202b 2031 0a20 2020 2020 2020 2020   r + 1.         
-0000a560: 2020 2020 2020 2020 2020 2077 6869 6c65             while
-0000a570: 2064 6174 615b 725d 203e 3d20 7468 7265   data[r] >= thre
-0000a580: 7368 6f6c 6420 616e 6420 7220 3c20 6461  shold and r < da
-0000a590: 7461 2e73 6861 7065 5b30 5d3a 0a20 2020  ta.shape[0]:.   
-0000a5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a5b0: 2020 2020 2063 6e74 2c20 7220 3d20 636e       cnt, r = cn
-0000a5c0: 7420 2b20 312c 2072 202b 2031 0a20 2020  t + 1, r + 1.   
-0000a5d0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-0000a5e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000a5f0: 6620 6461 7461 5b6c 5d20 3c3d 2074 6872  f data[l] <= thr
-0000a600: 6573 686f 6c64 3a0a 2020 2020 2020 2020  eshold:.        
-0000a610: 2020 2020 2020 2020 2020 2020 636e 742c              cnt,
-0000a620: 2072 203d 2063 6e74 202b 2031 2c20 7220   r = cnt + 1, r 
-0000a630: 2b20 310a 2020 2020 2020 2020 2020 2020  + 1.            
-0000a640: 2020 2020 2020 2020 7768 696c 6520 6461          while da
-0000a650: 7461 5b72 5d20 3c3d 2074 6872 6573 686f  ta[r] <= thresho
-0000a660: 6c64 2061 6e64 2072 203c 2064 6174 612e  ld and r < data.
-0000a670: 7368 6170 655b 305d 3a0a 2020 2020 2020  shape[0]:.      
-0000a680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a690: 2020 636e 742c 2072 203d 2063 6e74 202b    cnt, r = cnt +
-0000a6a0: 2031 2c20 7220 2b20 310a 0a20 2020 2020   1, r + 1..     
-0000a6b0: 2020 2020 2020 206c 202b 3d20 310a 2020         l += 1.  
-0000a6c0: 2020 2020 2020 2020 2020 6966 2063 6e74            if cnt
-0000a6d0: 203e 2072 6573 756c 743a 0a20 2020 2020   > result:.     
-0000a6e0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-0000a6f0: 7420 3d20 636e 740a 2020 2020 2020 2020  t = cnt.        
-0000a700: 2020 2020 6966 2064 6174 612e 7368 6170      if data.shap
-0000a710: 655b 305d 202d 206c 203c 2072 6573 756c  e[0] - l < resul
-0000a720: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
-0000a730: 2020 2062 7265 616b 0a20 2020 2020 2020     break.       
-0000a740: 2020 2020 2072 2c20 636e 7420 3d20 6c2c       r, cnt = l,
-0000a750: 2030 0a0a 2020 2020 2020 2020 7265 7475   0..        retu
-0000a760: 726e 2069 6e74 2872 6573 756c 7429 0a0a  rn int(result)..
-0000a770: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
-0000a780: 640a 2020 2020 406e 6a69 7428 0a20 2020  d.    @njit(.   
-0000a790: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-0000a7a0: 2020 2028 666c 6f61 7433 325b 3a5d 2c20     (float32[:], 
-0000a7b0: 666c 6f61 7436 342c 2066 6c6f 6174 3634  float64, float64
-0000a7c0: 5b3a 5d2c 2069 6e74 3634 2c20 626f 6f6c  [:], int64, bool
-0000a7d0: 6561 6e29 2c0a 2020 2020 2020 2020 2020  ean),.          
-0000a7e0: 2020 2866 6c6f 6174 3332 5b3a 5d2c 2066    (float32[:], f
-0000a7f0: 6c6f 6174 3634 2c20 666c 6f61 7436 345b  loat64, float64[
-0000a800: 3a5d 2c20 696e 7436 342c 2074 7970 6573  :], int64, types
-0000a810: 2e6d 6973 632e 4f6d 6974 7465 6428 5472  .misc.Omitted(Tr
-0000a820: 7565 2929 2c0a 2020 2020 2020 2020 5d0a  ue)),.        ].
-0000a830: 2020 2020 290a 2020 2020 6465 6620 736c      ).    def sl
-0000a840: 6964 696e 675f 6c6f 6e67 6573 745f 7374  iding_longest_st
-0000a850: 7269 6b65 280a 2020 2020 2020 2020 6461  rike(.        da
-0000a860: 7461 3a20 6e70 2e6e 6461 7272 6179 2c0a  ta: np.ndarray,.
-0000a870: 2020 2020 2020 2020 7468 7265 7368 6f6c          threshol
-0000a880: 643a 2066 6c6f 6174 2c0a 2020 2020 2020  d: float,.      
-0000a890: 2020 7469 6d65 5f77 696e 646f 7773 3a20    time_windows: 
-0000a8a0: 6e70 2e6e 6461 7272 6179 2c0a 2020 2020  np.ndarray,.    
-0000a8b0: 2020 2020 7361 6d70 6c65 5f72 6174 653a      sample_rate:
-0000a8c0: 2069 6e74 2c0a 2020 2020 2020 2020 6162   int,.        ab
-0000a8d0: 6f76 653a 2062 6f6f 6c2c 0a20 2020 2029  ove: bool,.    )
-0000a8e0: 202d 3e20 6e70 2e6e 6461 7272 6179 3a0a   -> np.ndarray:.
-0000a8f0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0000a900: 2020 2020 4a69 7474 6564 2063 6f6d 7075      Jitted compu
-0000a910: 7465 206f 6620 7468 6520 6c65 6e67 7468  te of the length
-0000a920: 206f 6620 7468 6520 6c6f 6e67 6573 7420   of the longest 
-0000a930: 7374 7269 6b65 206f 6620 7661 6c75 6573  strike of values
-0000a940: 2077 6974 6869 6e20 736c 6964 696e 6720   within sliding 
-0000a950: 7469 6d65 2077 696e 646f 7773 2074 6861  time windows tha
-0000a960: 7420 7361 7469 7366 7920 6120 6769 7665  t satisfy a give
-0000a970: 6e20 636f 6e64 6974 696f 6e2e 0a0a 2020  n condition...  
-0000a980: 2020 2020 2020 4361 6c63 756c 6174 6573        Calculates
-0000a990: 2074 6865 206c 656e 6774 6820 6f66 2074   the length of t
-0000a9a0: 6865 206c 6f6e 6765 7374 2063 6f6e 7365  he longest conse
-0000a9b0: 6375 7469 7665 2073 6571 7565 6e63 6520  cutive sequence 
-0000a9c0: 6f66 2076 616c 7565 7320 696e 2061 2031  of values in a 1
-0000a9d0: 4420 4e75 6d50 7920 6172 7261 792c 2077  D NumPy array, w
-0000a9e0: 6865 7265 2065 6163 680a 2020 2020 2020  here each.      
-0000a9f0: 2020 7365 7175 656e 6365 2069 7320 6465    sequence is de
-0000aa00: 7465 726d 696e 6564 2062 7920 6120 736c  termined by a sl
-0000aa10: 6964 696e 6720 7469 6d65 2077 696e 646f  iding time windo
-0000aa20: 772e 2054 6865 2063 6f6e 6469 7469 6f6e  w. The condition
-0000aa30: 2069 7320 7370 6563 6966 6965 6420 6279   is specified by
-0000aa40: 2061 2074 6872 6573 686f 6c64 2c20 616e   a threshold, an
-0000aa50: 640a 2020 2020 2020 2020 796f 7520 6361  d.        you ca
-0000aa60: 6e20 6368 6f6f 7365 2077 6865 7468 6572  n choose whether
-0000aa70: 2074 6f20 6c6f 6f6b 2066 6f72 2076 616c   to look for val
-0000aa80: 7565 7320 6162 6f76 6520 6f72 2062 656c  ues above or bel
-0000aa90: 6f77 2074 6865 2074 6872 6573 686f 6c64  ow the threshold
-0000aaa0: 2e0a 0a20 2020 2020 2020 202e 2e20 696d  ...        .. im
-0000aab0: 6167 653a 3a20 5f73 7461 7469 632f 696d  age:: _static/im
-0000aac0: 672f 736c 6964 696e 675f 6c6f 6e67 6573  g/sliding_longes
-0000aad0: 745f 7374 7269 6b65 2e70 6e67 0a20 2020  t_strike.png.   
-0000aae0: 2020 2020 2020 2020 3a77 6964 7468 3a20          :width: 
-0000aaf0: 3730 300a 2020 2020 2020 2020 2020 203a  700.           :
-0000ab00: 616c 6967 6e3a 2063 656e 7465 720a 0a20  align: center.. 
-0000ab10: 2020 2020 2020 203a 7061 7261 6d20 6e70         :param np
-0000ab20: 2e6e 6461 7272 6179 2064 6174 613a 2054  .ndarray data: T
-0000ab30: 6865 2069 6e70 7574 2031 4420 4e75 6d50  he input 1D NumP
-0000ab40: 7920 6172 7261 7920 636f 6e74 6169 6e69  y array containi
-0000ab50: 6e67 2074 6865 2076 616c 7565 7320 746f  ng the values to
-0000ab60: 2062 6520 616e 616c 797a 6564 2e0a 2020   be analyzed..  
-0000ab70: 2020 2020 2020 3a70 6172 616d 2066 6c6f        :param flo
-0000ab80: 6174 2074 6872 6573 686f 6c64 3a20 5468  at threshold: Th
-0000ab90: 6520 7468 7265 7368 6f6c 6420 7661 6c75  e threshold valu
-0000aba0: 6520 7573 6564 2066 6f72 2074 6865 2063  e used for the c
-0000abb0: 6f6d 7061 7269 736f 6e2e 0a20 2020 2020  omparison..     
-0000abc0: 2020 203a 7061 7261 6d20 6e70 2e6e 6461     :param np.nda
-0000abd0: 7272 6179 2074 696d 655f 7769 6e64 6f77  rray time_window
-0000abe0: 733a 2041 6e20 6172 7261 7920 636f 6e74  s: An array cont
-0000abf0: 6169 6e69 6e67 2074 6865 2074 696d 6520  aining the time 
-0000ac00: 7769 6e64 6f77 2073 697a 6573 2069 6e20  window sizes in 
-0000ac10: 7365 636f 6e64 732e 0a20 2020 2020 2020  seconds..       
-0000ac20: 203a 7061 7261 6d20 696e 7420 7361 6d70   :param int samp
-0000ac30: 6c65 5f72 6174 653a 2054 6865 2073 616d  le_rate: The sam
-0000ac40: 706c 6520 7261 7465 2069 6e20 7361 6d70  ple rate in samp
-0000ac50: 6c65 7320 7065 7220 7365 636f 6e64 2e0a  les per second..
-0000ac60: 2020 2020 2020 2020 3a70 6172 616d 2062          :param b
-0000ac70: 6f6f 6c20 6162 6f76 653a 2049 6620 5472  ool above: If Tr
-0000ac80: 7565 2c20 7468 6520 6675 6e63 7469 6f6e  ue, the function
-0000ac90: 206c 6f6f 6b73 2066 6f72 2073 7472 696b   looks for strik
-0000aca0: 6573 2077 6865 7265 2076 616c 7565 7320  es where values 
-0000acb0: 6172 6520 6162 6f76 6520 6f72 2065 7175  are above or equ
-0000acc0: 616c 2074 6f20 7468 6520 7468 7265 7368  al to the thresh
-0000acd0: 6f6c 642e 2049 6620 4661 6c73 652c 2069  old. If False, i
-0000ace0: 7420 6c6f 6f6b 7320 666f 7220 7374 7269  t looks for stri
-0000acf0: 6b65 7320 7768 6572 6520 7661 6c75 6573  kes where values
-0000ad00: 2061 7265 2062 656c 6f77 206f 7220 6571   are below or eq
-0000ad10: 7561 6c20 746f 2074 6865 2074 6872 6573  ual to the thres
-0000ad20: 686f 6c64 2e0a 2020 2020 2020 2020 3a72  hold..        :r
-0000ad30: 6574 7572 6e20 6e70 2e6e 6461 7272 6179  eturn np.ndarray
-0000ad40: 3a20 4120 3244 204e 756d 5079 2061 7272  : A 2D NumPy arr
-0000ad50: 6179 2077 6974 6820 6469 6d65 6e73 696f  ay with dimensio
-0000ad60: 6e73 2028 6461 7461 2e73 6861 7065 5b30  ns (data.shape[0
-0000ad70: 5d2c 2074 696d 655f 7769 6e64 6f77 732e  ], time_windows.
-0000ad80: 7368 6170 655b 305d 292e 2045 6163 6820  shape[0]). Each 
-0000ad90: 656c 656d 656e 7420 696e 2074 6865 2061  element in the a
-0000ada0: 7272 6179 2072 6570 7265 7365 6e74 7320  rray represents 
-0000adb0: 7468 6520 6c65 6e67 7468 206f 6620 7468  the length of th
-0000adc0: 6520 6c6f 6e67 6573 7420 7374 7269 6b65  e longest strike
-0000add0: 2074 6861 7420 7361 7469 7366 6965 7320   that satisfies 
-0000ade0: 7468 6520 636f 6e64 6974 696f 6e20 666f  the condition fo
-0000adf0: 7220 7468 650a 2020 2020 2020 2020 636f  r the.        co
-0000ae00: 7272 6573 706f 6e64 696e 6720 7469 6d65  rresponding time
-0000ae10: 2077 696e 646f 772e 0a0a 2020 2020 2020   window...      
-0000ae20: 2020 3a65 7861 6d70 6c65 3a0a 2020 2020    :example:.    
-0000ae30: 2020 2020 3e3e 3e20 6461 7461 203d 206e      >>> data = n
-0000ae40: 702e 6172 7261 7928 5b31 2c20 382c 2032  p.array([1, 8, 2
-0000ae50: 2c20 3130 2c20 382c 2036 2c20 382c 2031  , 10, 8, 6, 8, 1
-0000ae60: 2c20 312c 2031 5d29 2e61 7374 7970 6528  , 1, 1]).astype(
-0000ae70: 6e70 2e66 6c6f 6174 3332 290a 2020 2020  np.float32).    
-0000ae80: 2020 2020 3e3e 3e20 5469 6d65 7365 7269      >>> Timeseri
-0000ae90: 6573 4665 6174 7572 654d 6978 696e 2829  esFeatureMixin()
-0000aea0: 2e73 6c69 6469 6e67 5f6c 6f6e 6765 7374  .sliding_longest
-0000aeb0: 5f73 7472 696b 6528 6461 7461 3d64 6174  _strike(data=dat
-0000aec0: 612c 2074 6872 6573 686f 6c64 3d37 2c20  a, threshold=7, 
-0000aed0: 6162 6f76 653d 5472 7565 2c20 7469 6d65  above=True, time
-0000aee0: 5f77 696e 646f 7773 3d6e 702e 6172 7261  _windows=np.arra
-0000aef0: 7928 5b31 2e30 5d29 2c20 7361 6d70 6c65  y([1.0]), sample
-0000af00: 5f72 6174 653d 3229 0a20 2020 2020 2020  _rate=2).       
-0000af10: 203e 3e3e 205b 5b2d 312e 5d5b 2031 2e5d   >>> [[-1.][ 1.]
-0000af20: 5b20 312e 5d5b 2031 2e5d 5b20 322e 5d5b  [ 1.][ 1.][ 2.][
-0000af30: 2031 2e5d 5b20 312e 5d5b 2031 2e5d 5b20   1.][ 1.][ 1.][ 
-0000af40: 302e 5d5b 2030 2e5d 5d0a 2020 2020 2020  0.][ 0.]].      
-0000af50: 2020 3e3e 3e20 5469 6d65 7365 7269 6573    >>> Timeseries
-0000af60: 4665 6174 7572 654d 6978 696e 2829 2e73  FeatureMixin().s
-0000af70: 6c69 6469 6e67 5f6c 6f6e 6765 7374 5f73  liding_longest_s
-0000af80: 7472 696b 6528 6461 7461 3d64 6174 612c  trike(data=data,
-0000af90: 2074 6872 6573 686f 6c64 3d37 2c20 6162   threshold=7, ab
-0000afa0: 6f76 653d 5472 7565 2c20 7469 6d65 5f77  ove=True, time_w
-0000afb0: 696e 646f 7773 3d6e 702e 6172 7261 7928  indows=np.array(
-0000afc0: 5b31 2e30 5d29 2c20 7361 6d70 6c65 5f72  [1.0]), sample_r
-0000afd0: 6174 653d 3229 0a20 2020 2020 2020 203e  ate=2).        >
-0000afe0: 3e3e 205b 5b2d 312e 5d5b 2031 2e5d 5b20  >> [[-1.][ 1.][ 
-0000aff0: 312e 5d5b 2031 2e5d 5b20 302e 5d5b 2031  1.][ 1.][ 0.][ 1
-0000b000: 2e5d 5b20 312e 5d5b 2031 2e5d 5b20 322e  .][ 1.][ 1.][ 2.
-0000b010: 5d5b 2032 2e5d 5d0a 2020 2020 2020 2020  ][ 2.]].        
-0000b020: 2222 220a 0a20 2020 2020 2020 2072 6573  """..        res
-0000b030: 756c 7473 203d 206e 702e 6675 6c6c 2828  ults = np.full((
-0000b040: 6461 7461 2e73 6861 7065 5b30 5d2c 2074  data.shape[0], t
-0000b050: 696d 655f 7769 6e64 6f77 732e 7368 6170  ime_windows.shap
-0000b060: 655b 305d 292c 202d 312e 3029 0a0a 2020  e[0]), -1.0)..  
-0000b070: 2020 2020 2020 666f 7220 6920 696e 2070        for i in p
-0000b080: 7261 6e67 6528 7469 6d65 5f77 696e 646f  range(time_windo
-0000b090: 7773 2e73 6861 7065 5b30 5d29 3a0a 2020  ws.shape[0]):.  
-0000b0a0: 2020 2020 2020 2020 2020 7769 6e64 6f77            window
-0000b0b0: 5f73 697a 6520 3d20 696e 7428 7469 6d65  _size = int(time
-0000b0c0: 5f77 696e 646f 7773 5b69 5d20 2a20 7361  _windows[i] * sa
-0000b0d0: 6d70 6c65 5f72 6174 6529 0a20 2020 2020  mple_rate).     
-0000b0e0: 2020 2020 2020 2066 6f72 206c 312c 2072         for l1, r
-0000b0f0: 3120 696e 207a 6970 280a 2020 2020 2020  1 in zip(.      
-0000b100: 2020 2020 2020 2020 2020 7072 616e 6765            prange
-0000b110: 2830 2c20 6461 7461 2e73 6861 7065 5b30  (0, data.shape[0
-0000b120: 5d20 2b20 3129 2c20 7072 616e 6765 2877  ] + 1), prange(w
-0000b130: 696e 646f 775f 7369 7a65 2c20 6461 7461  indow_size, data
-0000b140: 2e73 6861 7065 5b30 5d20 2b20 3129 0a20  .shape[0] + 1). 
-0000b150: 2020 2020 2020 2020 2020 2029 3a0a 2020             ):.  
-0000b160: 2020 2020 2020 2020 2020 2020 2020 7361                sa
-0000b170: 6d70 6c65 203d 2064 6174 615b 6c31 3a72  mple = data[l1:r
-0000b180: 315d 0a20 2020 2020 2020 2020 2020 2020  1].             
-0000b190: 2020 2072 6573 756c 742c 206c 2c20 722c     result, l, r,
-0000b1a0: 2063 6e74 203d 202d 6e70 2e69 6e66 2c20   cnt = -np.inf, 
-0000b1b0: 302c 2030 2c20 300a 0a20 2020 2020 2020  0, 0, 0..       
-0000b1c0: 2020 2020 2020 2020 2077 6869 6c65 206c           while l
-0000b1d0: 203c 2073 616d 706c 652e 7368 6170 655b   < sample.shape[
-0000b1e0: 305d 3a0a 2020 2020 2020 2020 2020 2020  0]:.            
-0000b1f0: 2020 2020 2020 2020 6966 2061 626f 7665          if above
-0000b200: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000b210: 2020 2020 2020 2020 2020 6966 2073 616d            if sam
-0000b220: 706c 655b 6c5d 203e 3d20 7468 7265 7368  ple[l] >= thresh
-0000b230: 6f6c 643a 0a20 2020 2020 2020 2020 2020  old:.           
-0000b240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b250: 2063 6e74 2c20 7220 3d20 636e 7420 2b20   cnt, r = cnt + 
-0000b260: 312c 2072 202b 2031 0a20 2020 2020 2020  1, r + 1.       
-0000b270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b280: 2020 2020 2077 6869 6c65 2073 616d 706c       while sampl
-0000b290: 655b 725d 203e 3d20 7468 7265 7368 6f6c  e[r] >= threshol
-0000b2a0: 6420 616e 6420 7220 3c20 7361 6d70 6c65  d and r < sample
-0000b2b0: 2e73 6861 7065 5b30 5d3a 0a20 2020 2020  .shape[0]:.     
-0000b2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b2d0: 2020 2020 2020 2020 2020 2063 6e74 2c20             cnt, 
-0000b2e0: 7220 3d20 636e 7420 2b20 312c 2072 202b  r = cnt + 1, r +
-0000b2f0: 2031 0a20 2020 2020 2020 2020 2020 2020   1.             
-0000b300: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0000b310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b320: 2020 2020 2069 6620 7361 6d70 6c65 5b6c       if sample[l
-0000b330: 5d20 3c3d 2074 6872 6573 686f 6c64 3a0a  ] <= threshold:.
-0000b340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b350: 2020 2020 2020 2020 2020 2020 636e 742c              cnt,
-0000b360: 2072 203d 2063 6e74 202b 2031 2c20 7220   r = cnt + 1, r 
-0000b370: 2b20 310a 2020 2020 2020 2020 2020 2020  + 1.            
-0000b380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b390: 7768 696c 6520 7361 6d70 6c65 5b72 5d20  while sample[r] 
-0000b3a0: 3c3d 2074 6872 6573 686f 6c64 2061 6e64  <= threshold and
-0000b3b0: 2072 203c 2073 616d 706c 652e 7368 6170   r < sample.shap
-0000b3c0: 655b 305d 3a0a 2020 2020 2020 2020 2020  e[0]:.          
-0000b3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b3e0: 2020 2020 2020 636e 742c 2072 203d 2063        cnt, r = c
-0000b3f0: 6e74 202b 2031 2c20 7220 2b20 310a 0a20  nt + 1, r + 1.. 
-0000b400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b410: 2020 206c 202b 3d20 310a 2020 2020 2020     l += 1.      
-0000b420: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0000b430: 2063 6e74 203e 2072 6573 756c 743a 0a20   cnt > result:. 
-0000b440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b450: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
-0000b460: 636e 740a 2020 2020 2020 2020 2020 2020  cnt.            
-0000b470: 2020 2020 2020 2020 6966 2064 6174 612e          if data.
-0000b480: 7368 6170 655b 305d 202d 206c 203c 2072  shape[0] - l < r
-0000b490: 6573 756c 743a 0a20 2020 2020 2020 2020  esult:.         
-0000b4a0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000b4b0: 6573 756c 7473 5b72 202d 2031 2c20 695d  esults[r - 1, i]
-0000b4c0: 203d 2072 6573 756c 740a 2020 2020 2020   = result.      
-0000b4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b4e0: 2020 6272 6561 6b0a 2020 2020 2020 2020    break.        
-0000b4f0: 2020 2020 2020 2020 2020 2020 722c 2063              r, c
-0000b500: 6e74 203d 206c 2c20 300a 0a20 2020 2020  nt = l, 0..     
-0000b510: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-0000b520: 7473 5b72 3120 2d20 312c 2069 5d20 3d20  ts[r1 - 1, i] = 
-0000b530: 7265 7375 6c74 0a0a 2020 2020 2020 2020  result..        
-0000b540: 2020 2020 7265 7475 726e 2072 6573 756c      return resul
-0000b550: 7473 0a0a 2020 2020 4073 7461 7469 636d  ts..    @staticm
-0000b560: 6574 686f 640a 2020 2020 406e 6a69 7428  ethod.    @njit(
-0000b570: 0a20 2020 2020 2020 205b 0a20 2020 2020  .        [.     
-0000b580: 2020 2020 2020 2028 666c 6f61 7433 325b         (float32[
-0000b590: 3a5d 2c20 666c 6f61 7436 342c 2069 6e74  :], float64, int
-0000b5a0: 3634 2c20 626f 6f6c 6561 6e29 2c0a 2020  64, boolean),.  
-0000b5b0: 2020 2020 2020 2020 2020 2866 6c6f 6174            (float
-0000b5c0: 3332 5b3a 5d2c 2066 6c6f 6174 3634 2c20  32[:], float64, 
-0000b5d0: 696e 7436 342c 2074 7970 6573 2e6d 6973  int64, types.mis
-0000b5e0: 632e 4f6d 6974 7465 6428 5472 7565 2929  c.Omitted(True))
-0000b5f0: 2c0a 2020 2020 2020 2020 5d0a 2020 2020  ,.        ].    
-0000b600: 290a 2020 2020 6465 6620 7469 6d65 5f73  ).    def time_s
-0000b610: 696e 6365 5f70 7265 7669 6f75 735f 7468  ince_previous_th
-0000b620: 7265 7368 6f6c 6428 0a20 2020 2020 2020  reshold(.       
-0000b630: 2064 6174 613a 206e 702e 6e64 6172 7261   data: np.ndarra
-0000b640: 792c 2074 6872 6573 686f 6c64 3a20 666c  y, threshold: fl
-0000b650: 6f61 742c 2066 7073 3a20 696e 742c 2061  oat, fps: int, a
-0000b660: 626f 7665 3a20 626f 6f6c 0a20 2020 2029  bove: bool.    )
-0000b670: 202d 3e20 6e70 2e6e 6461 7272 6179 3a0a   -> np.ndarray:.
-0000b680: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0000b690: 2020 2020 4a69 7474 6564 2063 6f6d 7075      Jitted compu
-0000b6a0: 7465 206f 6620 7468 6520 7469 6d65 2028  te of the time (
-0000b6b0: 696e 2073 6563 6f6e 6473 2920 7468 6174  in seconds) that
-0000b6c0: 2068 6173 2065 6c61 7073 6564 2073 696e   has elapsed sin
-0000b6d0: 6365 2074 6865 206c 6173 7420 6f63 6375  ce the last occu
-0000b6e0: 7272 656e 6365 206f 6620 6120 7661 6c75  rrence of a valu
-0000b6f0: 6520 6162 6f76 6520 286f 7220 6265 6c6f  e above (or belo
-0000b700: 7729 0a20 2020 2020 2020 2061 2073 7065  w).        a spe
-0000b710: 6369 6669 6564 2074 6872 6573 686f 6c64  cified threshold
-0000b720: 2069 6e20 6120 7469 6d65 2073 6572 6965   in a time serie
-0000b730: 732e 2054 6865 2074 696d 6520 7365 7269  s. The time seri
-0000b740: 6573 2069 7320 6173 7375 6d65 6420 746f  es is assumed to
-0000b750: 2068 6176 6520 6120 636f 6e73 7461 6e74   have a constant
-0000b760: 2073 616d 706c 6520 7261 7465 2e0a 0a20   sample rate... 
-0000b770: 2020 2020 2020 202e 2e20 696d 6167 653a         .. image:
-0000b780: 3a20 5f73 7461 7469 632f 696d 672f 7469  : _static/img/ti
-0000b790: 6d65 5f73 696e 6365 5f70 7265 7669 6f75  me_since_previou
-0000b7a0: 735f 7468 7265 7368 6f6c 642e 706e 670a  s_threshold.png.
-0000b7b0: 2020 2020 2020 2020 2020 203a 7769 6474             :widt
-0000b7c0: 683a 2036 3030 0a20 2020 2020 2020 2020  h: 600.         
-0000b7d0: 2020 3a61 6c69 676e 3a20 6365 6e74 6572    :align: center
-0000b7e0: 0a0a 0a0a 2020 2020 2020 2020 3a70 6172  ....        :par
-0000b7f0: 616d 206e 702e 6e64 6172 7261 7920 6461  am np.ndarray da
-0000b800: 7461 3a20 5468 6520 696e 7075 7420 3144  ta: The input 1D
-0000b810: 2061 7272 6179 2063 6f6e 7461 696e 696e   array containin
-0000b820: 6720 7468 6520 7469 6d65 2073 6572 6965  g the time serie
-0000b830: 7320 6461 7461 2e0a 2020 2020 2020 2020  s data..        
-0000b840: 3a70 6172 616d 2069 6e74 2074 6872 6573  :param int thres
-0000b850: 686f 6c64 3a20 5468 6520 7468 7265 7368  hold: The thresh
-0000b860: 6f6c 6420 7661 6c75 6520 7573 6564 2066  old value used f
-0000b870: 6f72 2074 6865 2063 6f6d 7061 7269 736f  or the compariso
-0000b880: 6e2e 0a20 2020 2020 2020 203a 7061 7261  n..        :para
-0000b890: 6d20 696e 7420 6670 733a 2054 6865 2073  m int fps: The s
-0000b8a0: 616d 706c 6520 7261 7465 206f 6620 7468  ample rate of th
-0000b8b0: 6520 7469 6d65 2073 6572 6965 7320 696e  e time series in
-0000b8c0: 2073 616d 706c 6573 2070 6572 2073 6563   samples per sec
-0000b8d0: 6f6e 642e 0a20 2020 2020 2020 203a 7061  ond..        :pa
-0000b8e0: 7261 6d20 626f 6f6c 2061 626f 7665 3a20  ram bool above: 
-0000b8f0: 4966 2054 7275 652c 2074 6865 2066 756e  If True, the fun
-0000b900: 6374 696f 6e20 6c6f 6f6b 7320 666f 7220  ction looks for 
-0000b910: 7661 6c75 6573 2061 626f 7665 206f 7220  values above or 
-0000b920: 6571 7561 6c20 746f 2074 6865 2074 6872  equal to the thr
-0000b930: 6573 686f 6c64 2e20 4966 2046 616c 7365  eshold. If False
-0000b940: 2c20 6974 206c 6f6f 6b73 2066 6f72 2076  , it looks for v
-0000b950: 616c 7565 7320 6265 6c6f 7720 6f72 2065  alues below or e
-0000b960: 7175 616c 2074 6f20 7468 6520 7468 7265  qual to the thre
-0000b970: 7368 6f6c 642e 0a20 2020 2020 2020 203a  shold..        :
-0000b980: 7265 7475 726e 206e 702e 6e64 6172 7261  return np.ndarra
-0000b990: 793a 2041 2031 4420 6172 7261 7920 6f66  y: A 1D array of
-0000b9a0: 2074 6865 2073 616d 6520 6c65 6e67 7468   the same length
-0000b9b0: 2061 7320 7468 6520 696e 7075 7420 6461   as the input da
-0000b9c0: 7461 2e20 4561 6368 2065 6c65 6d65 6e74  ta. Each element
-0000b9d0: 2072 6570 7265 7365 6e74 7320 7468 6520   represents the 
-0000b9e0: 7469 6d65 2065 6c61 7073 6564 2028 696e  time elapsed (in
-0000b9f0: 2073 6563 6f6e 6473 2920 7369 6e63 6520   seconds) since 
-0000ba00: 7468 6520 6c61 7374 206f 6363 7572 7265  the last occurre
-0000ba10: 6e63 6520 6f66 2074 6865 2074 6872 6573  nce of the thres
-0000ba20: 686f 6c64 2076 616c 7565 2e20 4966 206e  hold value. If n
-0000ba30: 6f20 7468 7265 7368 6f6c 6420 7661 6c75  o threshold valu
-0000ba40: 6520 6973 2066 6f75 6e64 2062 6566 6f72  e is found befor
-0000ba50: 6520 7468 6520 6375 7272 656e 7420 6461  e the current da
-0000ba60: 7461 2070 6f69 6e74 2c20 7468 6520 636f  ta point, the co
-0000ba70: 7272 6573 706f 6e64 696e 6720 7265 7375  rresponding resu
-0000ba80: 6c74 2069 7320 7365 7420 746f 202d 312e  lt is set to -1.
-0000ba90: 302e 0a0a 2020 2020 2020 2020 3a65 7861  0...        :exa
-0000baa0: 6d70 6c65 733a 0a20 2020 2020 2020 203e  mples:.        >
-0000bab0: 3e3e 2064 6174 6120 3d20 6e70 2e61 7272  >> data = np.arr
-0000bac0: 6179 285b 312c 2038 2c20 322c 2031 302c  ay([1, 8, 2, 10,
-0000bad0: 2038 2c20 362c 2038 2c20 312c 2031 2c20   8, 6, 8, 1, 1, 
-0000bae0: 315d 292e 6173 7479 7065 286e 702e 666c  1]).astype(np.fl
-0000baf0: 6f61 7433 3229 0a20 2020 2020 2020 203e  oat32).        >
-0000bb00: 3e3e 2054 696d 6573 6572 6965 7346 6561  >> TimeseriesFea
-0000bb10: 7475 7265 4d69 7869 6e28 292e 7469 6d65  tureMixin().time
-0000bb20: 5f73 696e 6365 5f70 7265 7669 6f75 735f  _since_previous_
-0000bb30: 7468 7265 7368 6f6c 6428 6461 7461 3d64  threshold(data=d
-0000bb40: 6174 612c 2074 6872 6573 686f 6c64 3d37  ata, threshold=7
-0000bb50: 2e30 2c20 6162 6f76 653d 5472 7565 2c20  .0, above=True, 
-0000bb60: 7361 6d70 6c65 5f72 6174 653d 322e 3029  sample_rate=2.0)
-0000bb70: 0a20 2020 2020 2020 203e 3e3e 205b 2d31  .        >>> [-1
-0000bb80: 2e20 2c20 2030 2e20 2c20 2030 2e35 2c20  . ,  0. ,  0.5, 
-0000bb90: 2030 2e20 2c20 2030 2e20 2c20 2030 2e35   0. ,  0. ,  0.5
-0000bba0: 2c20 2030 2e20 2c20 2030 2e35 2c20 2031  ,  0. ,  0.5,  1
-0000bbb0: 2e20 2c20 2031 2e35 5d0a 2020 2020 2020  . ,  1.5].      
-0000bbc0: 2020 3e3e 3e20 5469 6d65 7365 7269 6573    >>> Timeseries
-0000bbd0: 4665 6174 7572 654d 6978 696e 2829 2e74  FeatureMixin().t
-0000bbe0: 696d 655f 7369 6e63 655f 7072 6576 696f  ime_since_previo
-0000bbf0: 7573 5f74 6872 6573 686f 6c64 2864 6174  us_threshold(dat
-0000bc00: 613d 6461 7461 2c20 7468 7265 7368 6f6c  a=data, threshol
-0000bc10: 643d 372e 302c 2061 626f 7665 3d46 616c  d=7.0, above=Fal
-0000bc20: 7365 2c20 7361 6d70 6c65 5f72 6174 653d  se, sample_rate=
-0000bc30: 322e 3029 0a20 2020 2020 2020 203e 3e3e  2.0).        >>>
-0000bc40: 205b 302e 202c 2030 2e35 2c20 302e 202c   [0. , 0.5, 0. ,
-0000bc50: 2030 2e35 2c20 312e 202c 2030 2e20 2c20   0.5, 1. , 0. , 
-0000bc60: 302e 352c 2030 2e20 2c20 302e 202c 2030  0.5, 0. , 0. , 0
-0000bc70: 2e20 5d0a 2020 2020 2020 2020 2222 220a  . ].        """.
-0000bc80: 0a20 2020 2020 2020 2072 6573 756c 7473  .        results
-0000bc90: 203d 206e 702e 6675 6c6c 2828 6461 7461   = np.full((data
-0000bca0: 2e73 6861 7065 5b30 5d29 2c20 2d31 2e30  .shape[0]), -1.0
-0000bcb0: 290a 2020 2020 2020 2020 6966 2061 626f  ).        if abo
-0000bcc0: 7665 3a0a 2020 2020 2020 2020 2020 2020  ve:.            
-0000bcd0: 6372 6974 6572 696f 6e5f 6964 7820 3d20  criterion_idx = 
-0000bce0: 6e70 2e61 7267 7768 6572 6528 6461 7461  np.argwhere(data
-0000bcf0: 203e 2074 6872 6573 686f 6c64 292e 666c   > threshold).fl
-0000bd00: 6174 7465 6e28 290a 2020 2020 2020 2020  atten().        
-0000bd10: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0000bd20: 2020 6372 6974 6572 696f 6e5f 6964 7820    criterion_idx 
-0000bd30: 3d20 6e70 2e61 7267 7768 6572 6528 6461  = np.argwhere(da
-0000bd40: 7461 203c 2074 6872 6573 686f 6c64 292e  ta < threshold).
-0000bd50: 666c 6174 7465 6e28 290a 0a20 2020 2020  flatten()..     
-0000bd60: 2020 2066 6f72 2069 2069 6e20 7072 616e     for i in pran
-0000bd70: 6765 2864 6174 612e 7368 6170 655b 305d  ge(data.shape[0]
-0000bd80: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-0000bd90: 6620 6162 6f76 6520 616e 6420 2864 6174  f above and (dat
-0000bda0: 615b 695d 203e 2074 6872 6573 686f 6c64  a[i] > threshold
-0000bdb0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0000bdc0: 2020 2072 6573 756c 7473 5b69 5d20 3d20     results[i] = 
-0000bdd0: 302e 300a 2020 2020 2020 2020 2020 2020  0.0.            
-0000bde0: 656c 6966 206e 6f74 2061 626f 7665 2061  elif not above a
-0000bdf0: 6e64 2028 6461 7461 5b69 5d20 3c20 7468  nd (data[i] < th
-0000be00: 7265 7368 6f6c 6429 3a0a 2020 2020 2020  reshold):.      
-0000be10: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-0000be20: 735b 695d 203d 2030 2e30 0a20 2020 2020  s[i] = 0.0.     
-0000be30: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0000be40: 2020 2020 2020 2020 2020 2020 2078 203d               x =
-0000be50: 2063 7269 7465 7269 6f6e 5f69 6478 5b6e   criterion_idx[n
-0000be60: 702e 6172 6777 6865 7265 2863 7269 7465  p.argwhere(crite
-0000be70: 7269 6f6e 5f69 6478 203c 2069 292e 666c  rion_idx < i).fl
-0000be80: 6174 7465 6e28 295d 0a20 2020 2020 2020  atten()].       
-0000be90: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
-0000bea0: 7829 203e 2030 3a0a 2020 2020 2020 2020  x) > 0:.        
-0000beb0: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-0000bec0: 6c74 735b 695d 203d 2028 6920 2d20 785b  lts[i] = (i - x[
-0000bed0: 2d31 5d29 202f 2066 7073 0a0a 2020 2020  -1]) / fps..    
-0000bee0: 2020 2020 7265 7475 726e 2072 6573 756c      return resul
-0000bef0: 7473 0a0a 2020 2020 4073 7461 7469 636d  ts..    @staticm
-0000bf00: 6574 686f 640a 2020 2020 406e 6a69 7428  ethod.    @njit(
-0000bf10: 0a20 2020 2020 2020 205b 0a20 2020 2020  .        [.     
-0000bf20: 2020 2020 2020 2028 666c 6f61 7433 325b         (float32[
-0000bf30: 3a5d 2c20 666c 6f61 7436 342c 2069 6e74  :], float64, int
-0000bf40: 3634 2c20 626f 6f6c 6561 6e29 2c0a 2020  64, boolean),.  
-0000bf50: 2020 2020 2020 2020 2020 2866 6c6f 6174            (float
-0000bf60: 3332 5b3a 5d2c 2066 6c6f 6174 3634 2c20  32[:], float64, 
-0000bf70: 696e 7436 342c 2074 7970 6573 2e6d 6973  int64, types.mis
-0000bf80: 632e 4f6d 6974 7465 6428 5472 7565 2929  c.Omitted(True))
-0000bf90: 2c0a 2020 2020 2020 2020 5d0a 2020 2020  ,.        ].    
-0000bfa0: 290a 2020 2020 6465 6620 7469 6d65 5f73  ).    def time_s
-0000bfb0: 696e 6365 5f70 7265 7669 6f75 735f 7461  ince_previous_ta
-0000bfc0: 7267 6574 5f76 616c 7565 280a 2020 2020  rget_value(.    
-0000bfd0: 2020 2020 6461 7461 3a20 6e70 2e6e 6461      data: np.nda
-0000bfe0: 7272 6179 2c20 7661 6c75 653a 2066 6c6f  rray, value: flo
-0000bff0: 6174 2c20 6670 733a 2069 6e74 2c20 696e  at, fps: int, in
-0000c000: 7665 7273 653a 2062 6f6f 6c20 3d20 4661  verse: bool = Fa
-0000c010: 6c73 650a 2020 2020 2920 2d3e 206e 702e  lse.    ) -> np.
-0000c020: 6e64 6172 7261 793a 0a20 2020 2020 2020  ndarray:.       
-0000c030: 2022 2222 0a20 2020 2020 2020 2043 616c   """.        Cal
-0000c040: 6375 6c61 7465 2074 6865 2074 696d 6520  culate the time 
-0000c050: 6475 7261 7469 6f6e 2028 696e 2073 6563  duration (in sec
-0000c060: 6f6e 6473 2920 7369 6e63 6520 7468 6520  onds) since the 
-0000c070: 7072 6576 696f 7573 206f 6363 7572 7265  previous occurre
-0000c080: 6e63 6520 6f66 2061 2073 7065 6369 6669  nce of a specifi
-0000c090: 6320 7661 6c75 6520 696e 2061 2064 6174  c value in a dat
-0000c0a0: 6120 6172 7261 792e 0a0a 2020 2020 2020  a array...      
-0000c0b0: 2020 4361 6c63 756c 6174 6573 2074 6865    Calculates the
-0000c0c0: 2074 696d 6520 6475 7261 7469 6f6e 2c20   time duration, 
-0000c0d0: 696e 2073 6563 6f6e 6473 2c20 6265 7477  in seconds, betw
-0000c0e0: 6565 6e20 6561 6368 2064 6174 6120 706f  een each data po
-0000c0f0: 696e 7420 616e 6420 7468 6520 7072 6576  int and the prev
-0000c100: 696f 7573 206f 6363 7572 7265 6e63 650a  ious occurrence.
-0000c110: 2020 2020 2020 2020 6f66 2061 2073 7065          of a spe
-0000c120: 6369 6669 6320 7661 6c75 6520 7769 7468  cific value with
-0000c130: 696e 2074 6865 2064 6174 6120 6172 7261  in the data arra
-0000c140: 792e 0a0a 2020 2020 2020 2020 2e2e 2069  y...        .. i
-0000c150: 6d61 6765 3a3a 205f 7374 6174 6963 2f69  mage:: _static/i
-0000c160: 6d67 2f74 696d 655f 7369 6e63 655f 7072  mg/time_since_pr
-0000c170: 6576 696f 7573 5f74 6172 6765 745f 7661  evious_target_va
-0000c180: 6c75 652e 706e 670a 2020 2020 2020 2020  lue.png.        
-0000c190: 2020 203a 7769 6474 683a 2037 3030 0a20     :width: 700. 
-0000c1a0: 2020 2020 2020 2020 2020 3a61 6c69 676e            :align
-0000c1b0: 3a20 6365 6e74 6572 0a0a 2020 2020 2020  : center..      
-0000c1c0: 2020 3a70 6172 616d 206e 702e 6e64 6172    :param np.ndar
-0000c1d0: 7261 7920 6461 7461 3a20 5468 6520 696e  ray data: The in
-0000c1e0: 7075 7420 3144 2061 7272 6179 2063 6f6e  put 1D array con
-0000c1f0: 7461 696e 696e 6720 7468 6520 7469 6d65  taining the time
-0000c200: 2073 6572 6965 7320 6461 7461 2e0a 2020   series data..  
-0000c210: 2020 2020 2020 3a70 6172 616d 2066 6c6f        :param flo
-0000c220: 6174 2076 616c 7565 3a20 5468 6520 7370  at value: The sp
-0000c230: 6563 6966 6963 2076 616c 7565 2074 6f20  ecific value to 
-0000c240: 7365 6172 6368 2066 6f72 2069 6e20 7468  search for in th
-0000c250: 6520 6461 7461 2061 7272 6179 2e0a 2020  e data array..  
-0000c260: 2020 2020 2020 3a70 6172 616d 2069 6e74        :param int
-0000c270: 2073 616d 706c 655f 7261 7465 3a20 5468   sample_rate: Th
-0000c280: 6520 7361 6d70 6c69 6e67 2072 6174 6520  e sampling rate 
-0000c290: 7768 6963 6820 6461 7461 2070 6f69 6e74  which data point
-0000c2a0: 7320 7765 7265 2063 6f6c 6c65 6374 6564  s were collected
-0000c2b0: 2e20 4974 2069 7320 7573 6564 2074 6f20  . It is used to 
-0000c2c0: 6361 6c63 756c 6174 6520 7468 6520 7469  calculate the ti
-0000c2d0: 6d65 2064 7572 6174 696f 6e20 696e 2073  me duration in s
-0000c2e0: 6563 6f6e 6473 2e0a 2020 2020 2020 2020  econds..        
-0000c2f0: 3a70 6172 616d 2062 6f6f 6c20 696e 7665  :param bool inve
-0000c300: 7273 653a 2049 6620 5472 7565 2c20 7468  rse: If True, th
-0000c310: 6520 6675 6e63 7469 6f6e 2063 616c 6375  e function calcu
-0000c320: 6c61 7465 7320 7468 6520 7469 6d65 2073  lates the time s
-0000c330: 696e 6365 2074 6865 2070 7265 7669 6f75  ince the previou
-0000c340: 7320 7661 6c75 6520 7468 6174 2069 7320  s value that is 
-0000c350: 4e4f 5420 6571 7561 6c20 746f 2074 6865  NOT equal to the
-0000c360: 2073 7065 6369 6669 6564 2027 7661 6c75   specified 'valu
-0000c370: 6527 2e20 4966 2046 616c 7365 2c20 6974  e'. If False, it
-0000c380: 2063 616c 6375 6c61 7465 7320 7468 6520   calculates the 
-0000c390: 7469 6d65 2073 696e 6365 2074 6865 2070  time since the p
-0000c3a0: 7265 7669 6f75 7320 6f63 6375 7272 656e  revious occurren
-0000c3b0: 6365 206f 6620 7468 6520 7370 6563 6966  ce of the specif
-0000c3c0: 6965 6420 2776 616c 7565 272e 0a20 2020  ied 'value'..   
-0000c3d0: 2020 2020 203a 7265 7475 726e 7320 6e70       :returns np
-0000c3e0: 2e6e 6461 7272 6179 3a20 4120 3144 204e  .ndarray: A 1D N
-0000c3f0: 756d 5079 2061 7272 6179 2063 6f6e 7461  umPy array conta
-0000c400: 696e 696e 6720 7468 6520 7469 6d65 2064  ining the time d
-0000c410: 7572 6174 696f 6e20 2869 6e20 7365 636f  uration (in seco
-0000c420: 6e64 7329 2073 696e 6365 2074 6865 2070  nds) since the p
-0000c430: 7265 7669 6f75 7320 6f63 6375 7272 656e  revious occurren
-0000c440: 6365 206f 6620 7468 6520 7370 6563 6966  ce of the specif
-0000c450: 6965 6420 2776 616c 7565 2720 666f 7220  ied 'value' for 
-0000c460: 6561 6368 2064 6174 6120 706f 696e 742e  each data point.
-0000c470: 0a0a 2020 2020 2020 2020 3a65 7861 6d70  ..        :examp
-0000c480: 6c65 3a0a 2020 2020 2020 2020 3e3e 3e20  le:.        >>> 
-0000c490: 6461 7461 203d 206e 702e 6172 7261 7928  data = np.array(
-0000c4a0: 5b38 2c20 382c 2032 2c20 3130 2c20 382c  [8, 8, 2, 10, 8,
-0000c4b0: 2036 2c20 382c 2031 2c20 312c 2031 5d29   6, 8, 1, 1, 1])
-0000c4c0: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
-0000c4d0: 3332 290a 2020 2020 2020 2020 3e3e 3e20  32).        >>> 
-0000c4e0: 5469 6d65 7365 7269 6573 4665 6174 7572  TimeseriesFeatur
-0000c4f0: 654d 6978 696e 2829 2e74 696d 655f 7369  eMixin().time_si
-0000c500: 6e63 655f 7072 6576 696f 7573 5f74 6172  nce_previous_tar
-0000c510: 6765 745f 7661 6c75 6528 6461 7461 3d64  get_value(data=d
-0000c520: 6174 612c 2076 616c 7565 3d38 2e30 2c20  ata, value=8.0, 
-0000c530: 696e 7665 7273 653d 4661 6c73 652c 2073  inverse=False, s
-0000c540: 616d 706c 655f 7261 7465 3d32 2e30 290a  ample_rate=2.0).
-0000c550: 2020 2020 2020 2020 3e3e 3e20 5b30 2e20          >>> [0. 
-0000c560: 2c20 302e 202c 2030 2e35 2c20 312e 202c  , 0. , 0.5, 1. ,
-0000c570: 2030 2e20 2c20 302e 352c 2030 2e20 2c20   0. , 0.5, 0. , 
-0000c580: 302e 352c 2031 2e20 2c20 312e 355d 290a  0.5, 1. , 1.5]).
-0000c590: 2020 2020 2020 2020 3e3e 3e20 5469 6d65          >>> Time
-0000c5a0: 7365 7269 6573 4665 6174 7572 654d 6978  seriesFeatureMix
-0000c5b0: 696e 2829 2e74 696d 655f 7369 6e63 655f  in().time_since_
-0000c5c0: 7072 6576 696f 7573 5f74 6172 6765 745f  previous_target_
-0000c5d0: 7661 6c75 6528 6461 7461 3d64 6174 612c  value(data=data,
-0000c5e0: 2076 616c 7565 3d38 2e30 2c20 696e 7665   value=8.0, inve
-0000c5f0: 7273 653d 5472 7565 2c20 7361 6d70 6c65  rse=True, sample
-0000c600: 5f72 6174 653d 322e 3029 0a20 2020 2020  _rate=2.0).     
-0000c610: 2020 203e 3e3e 205b 2d31 2e20 2c20 2d31     >>> [-1. , -1
-0000c620: 2e20 2c20 2030 2e20 2c20 2030 2e20 2c20  . ,  0. ,  0. , 
-0000c630: 2030 2e35 2c20 2030 2e20 2c20 2030 2e35   0.5,  0. ,  0.5
-0000c640: 2c20 2030 2e20 2c20 2030 2e20 2c20 2030  ,  0. ,  0. ,  0
-0000c650: 2e20 5d0a 2020 2020 2020 2020 2222 220a  . ].        """.
-0000c660: 0a20 2020 2020 2020 2072 6573 756c 7473  .        results
-0000c670: 203d 206e 702e 6675 6c6c 2828 6461 7461   = np.full((data
-0000c680: 2e73 6861 7065 5b30 5d29 2c20 2d31 2e30  .shape[0]), -1.0
-0000c690: 290a 2020 2020 2020 2020 6966 206e 6f74  ).        if not
-0000c6a0: 2069 6e76 6572 7365 3a0a 2020 2020 2020   inverse:.      
-0000c6b0: 2020 2020 2020 6372 6974 6572 696f 6e5f        criterion_
-0000c6c0: 6964 7820 3d20 6e70 2e61 7267 7768 6572  idx = np.argwher
-0000c6d0: 6528 6461 7461 203d 3d20 7661 6c75 6529  e(data == value)
-0000c6e0: 2e66 6c61 7474 656e 2829 0a20 2020 2020  .flatten().     
-0000c6f0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0000c700: 2020 2020 2063 7269 7465 7269 6f6e 5f69       criterion_i
-0000c710: 6478 203d 206e 702e 6172 6777 6865 7265  dx = np.argwhere
-0000c720: 2864 6174 6120 213d 2076 616c 7565 292e  (data != value).
-0000c730: 666c 6174 7465 6e28 290a 2020 2020 2020  flatten().      
-0000c740: 2020 6966 2063 7269 7465 7269 6f6e 5f69    if criterion_i
-0000c750: 6478 2e73 6861 7065 5b30 5d20 3d3d 2030  dx.shape[0] == 0
-0000c760: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0000c770: 7475 726e 206e 702e 6675 6c6c 2828 6461  turn np.full((da
-0000c780: 7461 2e73 6861 7065 5b30 5d29 2c20 2d31  ta.shape[0]), -1
-0000c790: 2e30 290a 2020 2020 2020 2020 666f 7220  .0).        for 
-0000c7a0: 6920 696e 2070 7261 6e67 6528 6461 7461  i in prange(data
-0000c7b0: 2e73 6861 7065 5b30 5d29 3a0a 2020 2020  .shape[0]):.    
-0000c7c0: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
-0000c7d0: 6e76 6572 7365 2061 6e64 2028 6461 7461  nverse and (data
-0000c7e0: 5b69 5d20 3d3d 2076 616c 7565 293a 0a20  [i] == value):. 
-0000c7f0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000c800: 6573 756c 7473 5b69 5d20 3d20 300a 2020  esults[i] = 0.  
-0000c810: 2020 2020 2020 2020 2020 656c 6966 2069            elif i
-0000c820: 6e76 6572 7365 2061 6e64 2028 6461 7461  nverse and (data
-0000c830: 5b69 5d20 213d 2076 616c 7565 293a 0a20  [i] != value):. 
-0000c840: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000c850: 6573 756c 7473 5b69 5d20 3d20 300a 2020  esults[i] = 0.  
-0000c860: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0000c870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c880: 7820 3d20 6372 6974 6572 696f 6e5f 6964  x = criterion_id
-0000c890: 785b 6e70 2e61 7267 7768 6572 6528 6372  x[np.argwhere(cr
-0000c8a0: 6974 6572 696f 6e5f 6964 7820 3c20 6929  iterion_idx < i)
-0000c8b0: 2e66 6c61 7474 656e 2829 5d0a 2020 2020  .flatten()].    
-0000c8c0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-0000c8d0: 656e 2878 2920 3e20 303a 0a20 2020 2020  en(x) > 0:.     
-0000c8e0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000c8f0: 6573 756c 7473 5b69 5d20 3d20 2869 202d  esults[i] = (i -
-0000c900: 2078 5b2d 315d 2920 2f20 6670 730a 2020   x[-1]) / fps.  
-0000c910: 2020 2020 2020 7265 7475 726e 2072 6573        return res
-0000c920: 756c 7473 0a0a 2020 2020 4073 7461 7469  ults..    @stati
-0000c930: 636d 6574 686f 640a 2020 2020 406e 6a69  cmethod.    @nji
-0000c940: 7428 2228 666c 6f61 7433 325b 3a5d 2c29  t("(float32[:],)
-0000c950: 2229 0a20 2020 2064 6566 2062 656e 666f  ").    def benfo
-0000c960: 7264 5f63 6f72 7265 6c61 7469 6f6e 2864  rd_correlation(d
-0000c970: 6174 613a 206e 702e 6e64 6172 7261 7929  ata: np.ndarray)
-0000c980: 202d 3e20 666c 6f61 743a 0a20 2020 2020   -> float:.     
-0000c990: 2020 2022 2222 0a20 2020 2020 2020 204a     """.        J
-0000c9a0: 6974 7465 6420 636f 6d70 7574 6520 6f66  itted compute of
-0000c9b0: 2074 6865 2063 6f72 7265 6c61 7469 6f6e   the correlation
-0000c9c0: 2062 6574 7765 656e 2074 6865 2042 656e   between the Ben
-0000c9d0: 666f 7264 2773 204c 6177 2064 6973 7472  ford's Law distr
-0000c9e0: 6962 7574 696f 6e20 616e 6420 7468 6520  ibution and the 
-0000c9f0: 6669 7273 742d 6469 6769 7420 6469 7374  first-digit dist
-0000ca00: 7269 6275 7469 6f6e 206f 6620 6769 7665  ribution of give
-0000ca10: 6e20 6461 7461 2e0a 0a20 2020 2020 2020  n data...       
-0000ca20: 2042 656e 666f 7264 2773 204c 6177 2064   Benford's Law d
-0000ca30: 6573 6372 6962 6573 2074 6865 2065 7870  escribes the exp
-0000ca40: 6563 7465 6420 6469 7374 7269 6275 7469  ected distributi
-0000ca50: 6f6e 206f 6620 6c65 6164 696e 6720 2866  on of leading (f
-0000ca60: 6972 7374 2920 6469 6769 7473 2069 6e20  irst) digits in 
-0000ca70: 6d61 6e79 2072 6561 6c2d 6c69 6665 2064  many real-life d
-0000ca80: 6174 6173 6574 732e 2054 6869 7320 6675  atasets. This fu
-0000ca90: 6e63 7469 6f6e 0a20 2020 2020 2020 2063  nction.        c
-0000caa0: 616c 6375 6c61 7465 7320 7468 6520 636f  alculates the co
-0000cab0: 7272 656c 6174 696f 6e20 6265 7477 6565  rrelation betwee
-0000cac0: 6e20 7468 6520 6578 7065 6374 6564 2042  n the expected B
-0000cad0: 656e 666f 7264 2773 204c 6177 2064 6973  enford's Law dis
-0000cae0: 7472 6962 7574 696f 6e20 616e 6420 7468  tribution and th
-0000caf0: 6520 6163 7475 616c 2064 6973 7472 6962  e actual distrib
-0000cb00: 7574 696f 6e20 6f66 2074 6865 0a20 2020  ution of the.   
-0000cb10: 2020 2020 2066 6972 7374 2064 6967 6974       first digit
-0000cb20: 7320 696e 2074 6865 2070 726f 7669 6465  s in the provide
-0000cb30: 6420 6461 7461 2e0a 0a20 2020 2020 2020  d data...       
-0000cb40: 202e 2e20 696d 6167 653a 3a20 5f73 7461   .. image:: _sta
-0000cb50: 7469 632f 696d 672f 6265 6e66 6f72 645f  tic/img/benford_
-0000cb60: 636f 7272 656c 6174 696f 6e2e 706e 670a  correlation.png.
-0000cb70: 2020 2020 2020 2020 2020 203a 7769 6474             :widt
-0000cb80: 683a 2036 3030 0a20 2020 2020 2020 2020  h: 600.         
-0000cb90: 2020 3a61 6c69 676e 3a20 6365 6e74 6572    :align: center
-0000cba0: 0a0a 2020 2020 2020 2020 2e2e 206e 6f74  ..        .. not
-0000cbb0: 653a 3a0a 2020 2020 2020 2020 2020 2041  e::.           A
-0000cbc0: 6461 7074 6564 2066 726f 6d20 6074 7366  dapted from `tsf
-0000cbd0: 7265 7368 203c 6874 7470 733a 2f2f 7473  resh <https://ts
-0000cbe0: 6672 6573 682e 7265 6164 7468 6564 6f63  fresh.readthedoc
-0000cbf0: 732e 696f 2f65 6e2f 6c61 7465 7374 2f5f  s.io/en/latest/_
-0000cc00: 6d6f 6475 6c65 732f 7473 6672 6573 682f  modules/tsfresh/
-0000cc10: 6665 6174 7572 655f 6578 7472 6163 7469  feature_extracti
-0000cc20: 6f6e 2f66 6561 7475 7265 5f63 616c 6375  on/feature_calcu
-0000cc30: 6c61 746f 7273 2e68 746d 6c23 6265 6e66  lators.html#benf
-0000cc40: 6f72 645f 636f 7272 656c 6174 696f 6e3e  ord_correlation>
-0000cc50: 605f 2e0a 0a20 2020 2020 2020 2020 2020  `_...           
-0000cc60: 5468 6520 7265 7475 726e 6564 2063 6f72  The returned cor
-0000cc70: 7265 6c61 7469 6f6e 2076 616c 7565 7320  relation values 
-0000cc80: 6172 6520 6361 6c63 756c 6174 6564 2075  are calculated u
-0000cc90: 7369 6e67 2050 6561 7273 6f6e 2773 2063  sing Pearson's c
-0000cca0: 6f72 7265 6c61 7469 6f6e 2063 6f65 6666  orrelation coeff
-0000ccb0: 6963 6965 6e74 2e0a 0a20 2020 2020 2020  icient...       
-0000ccc0: 203a 7061 7261 6d20 6e70 2e6e 6461 7272   :param np.ndarr
-0000ccd0: 6179 2064 6174 613a 2054 6865 2069 6e70  ay data: The inp
-0000cce0: 7574 2031 4420 6172 7261 7920 636f 6e74  ut 1D array cont
-0000ccf0: 6169 6e69 6e67 2074 6865 2074 696d 6520  aining the time 
-0000cd00: 7365 7269 6573 2064 6174 612e 0a20 2020  series data..   
-0000cd10: 2020 2020 203a 7265 7475 726e 2066 6c6f       :return flo
-0000cd20: 6174 3a20 5468 6520 636f 7272 656c 6174  at: The correlat
-0000cd30: 696f 6e20 636f 6566 6669 6369 656e 7420  ion coefficient 
-0000cd40: 6265 7477 6565 6e20 7468 6520 4265 6e66  between the Benf
-0000cd50: 6f72 6427 7320 4c61 7720 6469 7374 7269  ord's Law distri
-0000cd60: 6275 7469 6f6e 2061 6e64 2074 6865 2066  bution and the f
-0000cd70: 6972 7374 2d64 6967 6974 2064 6973 7472  irst-digit distr
-0000cd80: 6962 7574 696f 6e20 696e 2074 6865 2069  ibution in the i
-0000cd90: 6e70 7574 2064 6174 612e 2041 2068 6967  nput data. A hig
-0000cda0: 6865 7220 636f 7272 656c 6174 696f 6e20  her correlation 
-0000cdb0: 7661 6c75 6520 7375 6767 6573 7473 2074  value suggests t
-0000cdc0: 6861 7420 7468 6520 6461 7461 2066 6f6c  hat the data fol
-0000cdd0: 6c6f 7773 2074 6865 2065 7870 6563 7465  lows the expecte
-0000cde0: 6420 6469 7374 7269 6275 7469 6f6e 206d  d distribution m
-0000cdf0: 6f72 6520 636c 6f73 656c 792e 0a0a 2020  ore closely...  
-0000ce00: 2020 2020 2020 3a65 7861 6d70 6c65 733a        :examples:
-0000ce10: 0a20 2020 2020 2020 203e 3e3e 2064 6174  .        >>> dat
-0000ce20: 6120 3d20 6e70 2e61 7272 6179 285b 312c  a = np.array([1,
-0000ce30: 2038 2c20 322c 2031 302c 2038 2c20 362c   8, 2, 10, 8, 6,
-0000ce40: 2038 2c20 312c 2031 2c20 315d 292e 6173   8, 1, 1, 1]).as
-0000ce50: 7479 7065 286e 702e 666c 6f61 7433 3229  type(np.float32)
-0000ce60: 0a20 2020 2020 2020 203e 3e3e 2054 696d  .        >>> Tim
-0000ce70: 6573 6572 6965 7346 6561 7475 7265 4d69  eseriesFeatureMi
-0000ce80: 7869 6e28 292e 6265 6e66 6f72 645f 636f  xin().benford_co
-0000ce90: 7272 656c 6174 696f 6e28 6461 7461 3d64  rrelation(data=d
-0000cea0: 6174 6129 0a20 2020 2020 2020 203e 3e3e  ata).        >>>
-0000ceb0: 2030 2e36 3739 3735 3030 3337 3438 3331   0.6797500374831
-0000cec0: 3738 360a 2020 2020 2020 2020 2222 220a  786.        """.
-0000ced0: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
-0000cee0: 6e70 2e61 6273 2864 6174 6129 0a20 2020  np.abs(data).   
-0000cef0: 2020 2020 2062 656e 666f 7264 5f64 6973       benford_dis
-0000cf00: 7472 6962 7574 696f 6e20 3d20 6e70 2e61  tribution = np.a
-0000cf10: 7272 6179 285b 6e70 2e6c 6f67 3130 2831  rray([np.log10(1
-0000cf20: 202b 2031 202f 206e 2920 666f 7220 6e20   + 1 / n) for n 
-0000cf30: 696e 2072 616e 6765 2831 2c20 3130 295d  in range(1, 10)]
-0000cf40: 290a 2020 2020 2020 2020 6669 7273 745f  ).        first_
-0000cf50: 7661 6c73 2c20 6469 6769 745f 7261 7469  vals, digit_rati
-0000cf60: 6f20 3d20 6e70 2e66 756c 6c28 2864 6174  o = np.full((dat
-0000cf70: 612e 7368 6170 655b 305d 292c 206e 702e  a.shape[0]), np.
-0000cf80: 6e61 6e29 2c20 6e70 2e66 756c 6c28 392c  nan), np.full(9,
-0000cf90: 206e 702e 6e61 6e29 0a20 2020 2020 2020   np.nan).       
-0000cfa0: 2066 6f72 2069 2069 6e20 7072 616e 6765   for i in prange
-0000cfb0: 2864 6174 612e 7368 6170 655b 305d 293a  (data.shape[0]):
-0000cfc0: 0a20 2020 2020 2020 2020 2020 2066 6972  .            fir
-0000cfd0: 7374 5f76 616c 735b 695d 203d 2064 6174  st_vals[i] = dat
-0000cfe0: 615b 695d 202f 2f20 3130 202a 2a20 2869  a[i] // 10 ** (i
-0000cff0: 6e74 286e 702e 6c6f 6731 3028 6461 7461  nt(np.log10(data
-0000d000: 5b69 5d29 2920 2d20 3120 2b20 3129 0a0a  [i])) - 1 + 1)..
-0000d010: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-0000d020: 2072 616e 6765 2831 2c20 3130 293a 0a20   range(1, 10):. 
-0000d030: 2020 2020 2020 2020 2020 2064 6967 6974             digit
-0000d040: 5f72 6174 696f 5b69 202d 2031 5d20 3d20  _ratio[i - 1] = 
-0000d050: 6e70 2e61 7267 7768 6572 6528 6669 7273  np.argwhere(firs
-0000d060: 745f 7661 6c73 203d 3d20 6929 2e73 6861  t_vals == i).sha
-0000d070: 7065 5b30 5d20 2f20 6461 7461 2e73 6861  pe[0] / data.sha
-0000d080: 7065 5b30 5d0a 0a20 2020 2020 2020 2072  pe[0]..        r
-0000d090: 6574 7572 6e20 6e70 2e63 6f72 7263 6f65  eturn np.corrcoe
-0000d0a0: 6628 6265 6e66 6f72 645f 6469 7374 7269  f(benford_distri
-0000d0b0: 6275 7469 6f6e 2c20 6469 6769 745f 7261  bution, digit_ra
-0000d0c0: 7469 6f29 5b30 2c20 315d 0a0a 2020 2020  tio)[0, 1]..    
-0000d0d0: 4073 7461 7469 636d 6574 686f 640a 2020  @staticmethod.  
-0000d0e0: 2020 406e 6a69 7428 2228 666c 6f61 7433    @njit("(float3
-0000d0f0: 325b 3a5d 2c20 666c 6f61 7436 345b 3a5d  2[:], float64[:]
-0000d100: 2c20 696e 7436 3429 2229 0a20 2020 2064  , int64)").    d
-0000d110: 6566 2073 6c69 6469 6e67 5f62 656e 666f  ef sliding_benfo
-0000d120: 7264 5f63 6f72 7265 6c61 7469 6f6e 280a  rd_correlation(.
-0000d130: 2020 2020 2020 2020 6461 7461 3a20 6e70          data: np
-0000d140: 2e6e 6461 7272 6179 2c20 7469 6d65 5f77  .ndarray, time_w
-0000d150: 696e 646f 7773 3a20 6e70 2e6e 6461 7272  indows: np.ndarr
-0000d160: 6179 2c20 7361 6d70 6c65 5f72 6174 653a  ay, sample_rate:
-0000d170: 2069 6e74 0a20 2020 2029 202d 3e20 6e70   int.    ) -> np
-0000d180: 2e6e 6461 7272 6179 3a0a 2020 2020 2020  .ndarray:.      
-0000d190: 2020 2222 220a 2020 2020 2020 2020 4361    """.        Ca
-0000d1a0: 6c63 756c 6174 6520 7468 6520 736c 6964  lculate the slid
-0000d1b0: 696e 6720 4265 6e66 6f72 6427 7320 4c61  ing Benford's La
-0000d1c0: 7720 636f 7272 656c 6174 696f 6e20 636f  w correlation co
-0000d1d0: 6566 6669 6369 656e 7420 666f 7220 6120  efficient for a 
-0000d1e0: 6769 7665 6e20 6461 7461 7365 7420 7769  given dataset wi
-0000d1f0: 7468 696e 0a20 2020 2020 2020 2073 7065  thin.        spe
-0000d200: 6369 6669 6564 2074 696d 6520 7769 6e64  cified time wind
-0000d210: 6f77 732e 0a0a 2020 2020 2020 2020 4265  ows...        Be
-0000d220: 6e66 6f72 6427 7320 4c61 7720 6973 2061  nford's Law is a
-0000d230: 2073 7461 7469 7374 6963 616c 2070 6865   statistical phe
-0000d240: 6e6f 6d65 6e6f 6e20 7768 6572 6520 7468  nomenon where th
-0000d250: 6520 6c65 6164 696e 6720 6469 6769 7473  e leading digits
-0000d260: 206f 6620 6d61 6e79 2064 6174 6173 6574   of many dataset
-0000d270: 7320 666f 6c6c 6f77 2061 0a20 2020 2020  s follow a.     
-0000d280: 2020 2073 7065 6369 6669 6320 6469 7374     specific dist
-0000d290: 7269 6275 7469 6f6e 2070 6174 7465 726e  ribution pattern
-0000d2a0: 2e20 5468 6973 2066 756e 6374 696f 6e20  . This function 
-0000d2b0: 6361 6c63 756c 6174 6573 2074 6865 2063  calculates the c
-0000d2c0: 6f72 7265 6c61 7469 6f6e 2062 6574 7765  orrelation betwe
-0000d2d0: 656e 2074 6865 206f 6273 6572 7665 640a  en the observed.
-0000d2e0: 2020 2020 2020 2020 6469 7374 7269 6275          distribu
-0000d2f0: 7469 6f6e 206f 6620 6c65 6164 696e 6720  tion of leading 
-0000d300: 6469 6769 7473 2069 6e20 6120 6461 7461  digits in a data
-0000d310: 7365 7420 616e 6420 7468 6520 6964 6561  set and the idea
-0000d320: 6c20 4265 6e66 6f72 6427 7320 4c61 7720  l Benford's Law 
-0000d330: 6469 7374 7269 6275 7469 6f6e 2e0a 0a20  distribution... 
-0000d340: 2020 2020 2020 202e 2e20 6e6f 7465 3a3a         .. note::
-0000d350: 0a20 2020 2020 2020 2020 2020 4164 6170  .           Adap
-0000d360: 7465 6420 6672 6f6d 2060 7473 6672 6573  ted from `tsfres
-0000d370: 6820 3c68 7474 7073 3a2f 2f74 7366 7265  h <https://tsfre
-0000d380: 7368 2e72 6561 6474 6865 646f 6373 2e69  sh.readthedocs.i
-0000d390: 6f2f 656e 2f6c 6174 6573 742f 5f6d 6f64  o/en/latest/_mod
-0000d3a0: 756c 6573 2f74 7366 7265 7368 2f66 6561  ules/tsfresh/fea
-0000d3b0: 7475 7265 5f65 7874 7261 6374 696f 6e2f  ture_extraction/
-0000d3c0: 6665 6174 7572 655f 6361 6c63 756c 6174  feature_calculat
-0000d3d0: 6f72 732e 6874 6d6c 2362 656e 666f 7264  ors.html#benford
-0000d3e0: 5f63 6f72 7265 6c61 7469 6f6e 3e60 5f2e  _correlation>`_.
-0000d3f0: 0a0a 2020 2020 2020 2020 2020 2054 6865  ..           The
-0000d400: 2072 6574 7572 6e65 6420 636f 7272 656c   returned correl
-0000d410: 6174 696f 6e20 7661 6c75 6573 2061 7265  ation values are
-0000d420: 2063 616c 6375 6c61 7465 6420 7573 696e   calculated usin
-0000d430: 6720 5065 6172 736f 6e27 7320 636f 7272  g Pearson's corr
-0000d440: 656c 6174 696f 6e20 636f 6566 6669 6369  elation coeffici
-0000d450: 656e 742e 0a0a 2020 2020 2020 2020 5468  ent...        Th
-0000d460: 6520 636f 7272 656c 6174 696f 6e20 636f  e correlation co
-0000d470: 6566 6669 6369 656e 7420 6973 2063 616c  efficient is cal
-0000d480: 6375 6c61 7465 6420 6265 7477 6565 6e20  culated between 
-0000d490: 7468 6520 6f62 7365 7276 6564 206c 6561  the observed lea
-0000d4a0: 6469 6e67 2064 6967 6974 2064 6973 7472  ding digit distr
-0000d4b0: 6962 7574 696f 6e20 616e 640a 2020 2020  ibution and.    
-0000d4c0: 2020 2020 7468 6520 6964 6561 6c20 4265      the ideal Be
-0000d4d0: 6e66 6f72 6427 7320 4c61 7720 6469 7374  nford's Law dist
-0000d4e0: 7269 6275 7469 6f6e 2e0a 0a20 2020 2020  ribution...     
-0000d4f0: 2020 202e 2e20 6d61 7468 3a3a 0a0a 2020     .. math::..  
-0000d500: 2020 2020 2020 2020 2020 5028 6429 203d            P(d) =
-0000d510: 205c 5c6c 6f67 5f7b 3130 7d5c 5c6c 6566   \\log_{10}\\lef
-0000d520: 7428 3120 2b20 5c5c 6672 6163 7b31 7d7b  t(1 + \\frac{1}{
-0000d530: 647d 5c5c 7269 6768 7429 205c 5c71 7561  d}\\right) \\qua
-0000d540: 6420 5c5c 7465 7874 7b66 6f72 207d 2064  d \\text{for } d
-0000d550: 205c 5c69 6e20 5c7b 312c 2032 2c20 5c5c   \\in \{1, 2, \\
-0000d560: 6c64 6f74 732c 2039 5c7d 0a0a 2020 2020  ldots, 9\}..    
-0000d570: 2020 2020 3a70 6172 616d 206e 702e 6e64      :param np.nd
-0000d580: 6172 7261 7920 6461 7461 3a20 5468 6520  array data: The 
-0000d590: 696e 7075 7420 3144 2061 7272 6179 2063  input 1D array c
-0000d5a0: 6f6e 7461 696e 696e 6720 7468 6520 7469  ontaining the ti
-0000d5b0: 6d65 2073 6572 6965 7320 6461 7461 2e0a  me series data..
-0000d5c0: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
-0000d5d0: 702e 6e64 6172 7261 7920 7469 6d65 5f77  p.ndarray time_w
-0000d5e0: 696e 646f 7773 3a20 4120 3144 2061 7272  indows: A 1D arr
-0000d5f0: 6179 2063 6f6e 7461 696e 696e 6720 7468  ay containing th
-0000d600: 6520 7469 6d65 2077 696e 646f 7773 2028  e time windows (
-0000d610: 696e 2073 6563 6f6e 6473 2920 666f 7220  in seconds) for 
-0000d620: 7768 6963 6820 7468 6520 636f 7272 656c  which the correl
-0000d630: 6174 696f 6e20 7769 6c6c 2062 6520 6361  ation will be ca
-0000d640: 6c63 756c 6174 6564 2061 7420 6469 6666  lculated at diff
-0000d650: 6572 656e 7420 706f 696e 7473 2069 6e20  erent points in 
-0000d660: 7468 6520 6461 7461 7365 742e 0a20 2020  the dataset..   
-0000d670: 2020 2020 203a 7061 7261 6d20 696e 7420       :param int 
-0000d680: 7361 6d70 6c65 5f72 6174 653a 2054 6865  sample_rate: The
-0000d690: 2073 616d 706c 6520 7261 7465 2c20 696e   sample rate, in
-0000d6a0: 6469 6361 7469 6e67 2068 6f77 206d 616e  dicating how man
-0000d6b0: 7920 6461 7461 2070 6f69 6e74 7320 6172  y data points ar
-0000d6c0: 6520 636f 6c6c 6563 7465 6420 7065 7220  e collected per 
-0000d6d0: 7365 636f 6e64 2e0a 2020 2020 2020 2020  second..        
-0000d6e0: 3a72 6574 7572 6e20 6e70 2e6e 6461 7272  :return np.ndarr
-0000d6f0: 6179 3a20 3244 2061 7272 6179 2063 6f6e  ay: 2D array con
-0000d700: 7461 696e 696e 6720 7468 6520 636f 7272  taining the corr
-0000d710: 656c 6174 696f 6e20 636f 6566 6669 6369  elation coeffici
-0000d720: 656e 7420 7661 6c75 6573 2066 6f72 2065  ent values for e
-0000d730: 6163 6820 7469 6d65 2077 696e 646f 772e  ach time window.
-0000d740: 2057 6974 6820 7469 6d65 2077 696e 646f   With time windo
-0000d750: 7720 6c65 6e74 6873 2072 6570 7265 7365  w lenths represe
-0000d760: 6e74 6564 2062 7920 6469 6666 6572 656e  nted by differen
-0000d770: 7420 636f 6c75 6d6e 732e 0a0a 2020 2020  t columns...    
-0000d780: 2020 2020 3a65 7861 6d70 6c65 733a 0a20      :examples:. 
-0000d790: 2020 2020 2020 203e 3e3e 2064 6174 6120         >>> data 
-0000d7a0: 3d20 6e70 2e61 7272 6179 285b 312c 2038  = np.array([1, 8
-0000d7b0: 2c20 322c 2031 302c 2038 2c20 362c 2038  , 2, 10, 8, 6, 8
-0000d7c0: 2c20 312c 2031 2c20 315d 292e 6173 7479  , 1, 1, 1]).asty
-0000d7d0: 7065 286e 702e 666c 6f61 7433 3229 0a20  pe(np.float32). 
-0000d7e0: 2020 2020 2020 203e 3e3e 2073 6c69 6469         >>> slidi
-0000d7f0: 6e67 5f62 656e 666f 7264 5f63 6f72 7265  ng_benford_corre
-0000d800: 6c61 7469 6f6e 2864 6174 613d 6461 7461  lation(data=data
-0000d810: 2c20 7469 6d65 5f77 696e 646f 7773 3d6e  , time_windows=n
-0000d820: 702e 6172 7261 7928 5b31 2e30 5d29 2c20  p.array([1.0]), 
-0000d830: 7361 6d70 6c65 5f72 6174 653d 3229 0a20  sample_rate=2). 
-0000d840: 2020 2020 2020 203e 3e3e 205b 5b20 302e         >>> [[ 0.
-0000d850: 5d5b 302e 3434 375d 5b30 2e30 3137 5d5b  ][0.447][0.017][
-0000d860: 302e 3837 375d 5b30 2e34 3437 5d5b 302e  0.877][0.447][0.
-0000d870: 3335 385d 5b30 2e33 3538 5d5b 302e 3434  358][0.358][0.44
-0000d880: 375d 5b30 2e38 3634 5d5b 302e 3836 345d  7][0.864][0.864]
-0000d890: 5d0a 2020 2020 2020 2020 2222 220a 0a20  ].        """.. 
-0000d8a0: 2020 2020 2020 2064 6174 6120 3d20 6e70         data = np
-0000d8b0: 2e61 6273 2864 6174 6129 0a20 2020 2020  .abs(data).     
-0000d8c0: 2020 2062 656e 666f 7264 5f64 6973 7472     benford_distr
-0000d8d0: 6962 7574 696f 6e20 3d20 6e70 2e61 7272  ibution = np.arr
-0000d8e0: 6179 285b 6e70 2e6c 6f67 3130 2831 202b  ay([np.log10(1 +
-0000d8f0: 2031 202f 206e 2920 666f 7220 6e20 696e   1 / n) for n in
-0000d900: 2072 616e 6765 2831 2c20 3130 295d 290a   range(1, 10)]).
-0000d910: 2020 2020 2020 2020 7265 7375 6c74 7320          results 
-0000d920: 3d20 6e70 2e66 756c 6c28 2864 6174 612e  = np.full((data.
-0000d930: 7368 6170 655b 305d 2c20 7469 6d65 5f77  shape[0], time_w
-0000d940: 696e 646f 7773 2e73 6861 7065 5b30 5d29  indows.shape[0])
-0000d950: 2c20 302e 3029 0a20 2020 2020 2020 2066  , 0.0).        f
-0000d960: 6f72 2069 2069 6e20 7072 616e 6765 2874  or i in prange(t
-0000d970: 696d 655f 7769 6e64 6f77 732e 7368 6170  ime_windows.shap
-0000d980: 655b 305d 293a 0a20 2020 2020 2020 2020  e[0]):.         
-0000d990: 2020 2077 696e 646f 775f 7369 7a65 203d     window_size =
-0000d9a0: 2069 6e74 2874 696d 655f 7769 6e64 6f77   int(time_window
-0000d9b0: 735b 695d 202a 2073 616d 706c 655f 7261  s[i] * sample_ra
-0000d9c0: 7465 290a 2020 2020 2020 2020 2020 2020  te).            
-0000d9d0: 666f 7220 6c2c 2072 2069 6e20 7a69 7028  for l, r in zip(
-0000d9e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d9f0: 2070 7261 6e67 6528 302c 2064 6174 612e   prange(0, data.
-0000da00: 7368 6170 655b 305d 202b 2031 292c 2070  shape[0] + 1), p
-0000da10: 7261 6e67 6528 7769 6e64 6f77 5f73 697a  range(window_siz
-0000da20: 652c 2064 6174 612e 7368 6170 655b 305d  e, data.shape[0]
-0000da30: 202b 2031 290a 2020 2020 2020 2020 2020   + 1).          
-0000da40: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
-0000da50: 2020 2020 2066 6972 7374 5f76 616c 732c       first_vals,
-0000da60: 2064 6967 6974 5f72 6174 696f 203d 206e   digit_ratio = n
-0000da70: 702e 6675 6c6c 2828 6461 7461 2e73 6861  p.full((data.sha
-0000da80: 7065 5b30 5d29 2c20 6e70 2e6e 616e 292c  pe[0]), np.nan),
-0000da90: 206e 702e 6675 6c6c 280a 2020 2020 2020   np.full(.      
-0000daa0: 2020 2020 2020 2020 2020 2020 2020 392c                9,
-0000dab0: 206e 702e 6e61 6e0a 2020 2020 2020 2020   np.nan.        
-0000dac0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0000dad0: 2020 2020 2020 2020 2020 7361 6d70 6c65            sample
-0000dae0: 203d 2064 6174 615b 6c3a 725d 0a20 2020   = data[l:r].   
-0000daf0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-0000db00: 206b 2069 6e20 7261 6e67 6528 7361 6d70   k in range(samp
-0000db10: 6c65 2e73 6861 7065 5b30 5d29 3a0a 2020  le.shape[0]):.  
-0000db20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000db30: 2020 6669 7273 745f 7661 6c73 5b6b 5d20    first_vals[k] 
-0000db40: 3d20 7361 6d70 6c65 5b6b 5d20 2f2f 2031  = sample[k] // 1
-0000db50: 3020 2a2a 2028 0a20 2020 2020 2020 2020  0 ** (.         
-0000db60: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000db70: 6e74 286e 702e 6c6f 6731 3028 7361 6d70  nt(np.log10(samp
-0000db80: 6c65 5b6b 5d29 2920 2d20 3120 2b20 310a  le[k])) - 1 + 1.
-0000db90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dba0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0000dbb0: 2020 2020 2020 666f 7220 6b20 696e 2072        for k in r
-0000dbc0: 616e 6765 2831 2c20 3130 293a 0a20 2020  ange(1, 10):.   
-0000dbd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dbe0: 2064 6967 6974 5f72 6174 696f 5b6b 202d   digit_ratio[k -
-0000dbf0: 2031 5d20 3d20 280a 2020 2020 2020 2020   1] = (.        
-0000dc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dc10: 6e70 2e61 7267 7768 6572 6528 6669 7273  np.argwhere(firs
-0000dc20: 745f 7661 6c73 203d 3d20 6b29 2e73 6861  t_vals == k).sha
-0000dc30: 7065 5b30 5d20 2f20 7361 6d70 6c65 2e73  pe[0] / sample.s
-0000dc40: 6861 7065 5b30 5d0a 2020 2020 2020 2020  hape[0].        
-0000dc50: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0000dc60: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0000dc70: 7375 6c74 735b 7220 2d20 312c 2069 5d20  sults[r - 1, i] 
-0000dc80: 3d20 6e70 2e63 6f72 7263 6f65 6628 6265  = np.corrcoef(be
-0000dc90: 6e66 6f72 645f 6469 7374 7269 6275 7469  nford_distributi
-0000dca0: 6f6e 2c20 6469 6769 745f 7261 7469 6f29  on, digit_ratio)
-0000dcb0: 5b30 2c20 315d 0a0a 2020 2020 2020 2020  [0, 1]..        
-0000dcc0: 7265 7475 726e 2072 6573 756c 7473 2e61  return results.a
-0000dcd0: 7374 7970 6528 6e70 2e66 6c6f 6174 3332  stype(np.float32
-0000dce0: 290a 0a20 2020 2040 7374 6174 6963 6d65  )..    @staticme
-0000dcf0: 7468 6f64 0a20 2020 2040 6e6a 6974 2822  thod.    @njit("
-0000dd00: 2866 6c6f 6174 3332 5b3a 5d2c 2066 6c6f  (float32[:], flo
-0000dd10: 6174 3634 2c20 666c 6f61 7436 342c 2066  at64, float64, f
-0000dd20: 6c6f 6174 3634 2c20 666c 6f61 7436 342c  loat64, float64,
-0000dd30: 2066 6c6f 6174 3634 2922 2c20 6661 7374   float64)", fast
-0000dd40: 6d61 7468 3d54 7275 6529 0a20 2020 2064  math=True).    d
-0000dd50: 6566 2073 7069 6b65 5f66 696e 6465 7228  ef spike_finder(
-0000dd60: 0a20 2020 2020 2020 2064 6174 613a 206e  .        data: n
-0000dd70: 702e 6e64 6172 7261 792c 0a20 2020 2020  p.ndarray,.     
-0000dd80: 2020 2073 616d 706c 655f 7261 7465 3a20     sample_rate: 
-0000dd90: 696e 742c 0a20 2020 2020 2020 2062 6173  int,.        bas
-0000dda0: 656c 696e 653a 2066 6c6f 6174 2c0a 2020  eline: float,.  
-0000ddb0: 2020 2020 2020 6d69 6e5f 7370 696b 655f        min_spike_
-0000ddc0: 616d 706c 6974 7564 653a 2066 6c6f 6174  amplitude: float
-0000ddd0: 2c0a 2020 2020 2020 2020 6d69 6e5f 6677  ,.        min_fw
-0000dde0: 686d 3a20 666c 6f61 7420 3d20 2d6e 702e  hm: float = -np.
-0000ddf0: 696e 662c 0a20 2020 2020 2020 206d 696e  inf,.        min
-0000de00: 5f68 616c 665f 7769 6474 683a 2066 6c6f  _half_width: flo
-0000de10: 6174 203d 202d 6e70 2e69 6e66 2c0a 2020  at = -np.inf,.  
-0000de20: 2020 2920 2d3e 2066 6c6f 6174 3a0a 2020    ) -> float:.  
-0000de30: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0000de40: 2020 4964 656e 7469 6679 2061 6e64 2063    Identify and c
-0000de50: 6861 7261 6374 6572 697a 6520 7370 696b  haracterize spik
-0000de60: 6573 2069 6e20 6120 6769 7665 6e20 7469  es in a given ti
-0000de70: 6d65 2d73 6572 6965 7320 6461 7461 2073  me-series data s
-0000de80: 6571 7565 6e63 652e 2054 6869 7320 6d65  equence. This me
-0000de90: 7468 6f64 2069 6465 6e74 6966 6965 7320  thod identifies 
-0000dea0: 7370 696b 6573 2069 6e20 7468 6520 696e  spikes in the in
-0000deb0: 7075 7420 6461 7461 2062 6173 6564 206f  put data based o
-0000dec0: 6e20 7468 6520 7370 6563 6966 6965 6420  n the specified 
-0000ded0: 6372 6974 6572 6961 2061 6e64 2063 6861  criteria and cha
-0000dee0: 7261 6374 6572 697a 6573 0a20 2020 2020  racterizes.     
-0000def0: 2020 2065 6163 6820 6465 7465 6374 6564     each detected
-0000df00: 2073 7069 6b65 2062 7920 636f 6d70 7574   spike by comput
-0000df10: 696e 6720 6974 7320 616d 706c 6974 7564  ing its amplitud
-0000df20: 652c 2066 756c 6c2d 7769 6474 6820 6174  e, full-width at
-0000df30: 2068 616c 6620 6d61 7869 6d75 6d20 2846   half maximum (F
-0000df40: 5748 4d29 2c20 616e 6420 6861 6c66 2d77  WHM), and half-w
-0000df50: 6964 7468 2e0a 0a20 2020 2020 2020 203a  idth...        :
-0000df60: 7061 7261 6d20 6e70 2e6e 6461 7272 6179  param np.ndarray
-0000df70: 2064 6174 613a 2041 2031 4420 6172 7261   data: A 1D arra
-0000df80: 7920 636f 6e74 6169 6e69 6e67 2074 6865  y containing the
-0000df90: 2069 6e70 7574 2064 6174 6120 7365 7175   input data sequ
-0000dfa0: 656e 6365 2074 6f20 616e 616c 797a 652e  ence to analyze.
-0000dfb0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0000dfc0: 696e 7420 7361 6d70 6c65 5f72 6174 653a  int sample_rate:
-0000dfd0: 2054 6865 2073 616d 706c 6520 7261 7465   The sample rate
-0000dfe0: 2c20 696e 6469 6361 7469 6e67 2068 6f77  , indicating how
-0000dff0: 206d 616e 7920 6461 7461 2070 6f69 6e74   many data point
-0000e000: 7320 6172 6520 636f 6c6c 6563 7465 6420  s are collected 
-0000e010: 7065 7220 7365 636f 6e64 2e0a 2020 2020  per second..    
-0000e020: 2020 2020 3a70 6172 616d 2066 6c6f 6174      :param float
-0000e030: 2062 6173 656c 696e 653a 2054 6865 2062   baseline: The b
-0000e040: 6173 656c 696e 6520 7661 6c75 6520 7573  aseline value us
-0000e050: 6564 2074 6f20 6964 656e 7469 6679 2073  ed to identify s
-0000e060: 7069 6b65 732e 2041 6e79 2064 6174 6120  pikes. Any data 
-0000e070: 706f 696e 7420 6162 6f76 6520 2862 6173  point above (bas
-0000e080: 656c 696e 6520 2b20 6d69 6e5f 7370 696b  eline + min_spik
-0000e090: 655f 616d 706c 6974 7564 6529 2069 7320  e_amplitude) is 
-0000e0a0: 636f 6e73 6964 6572 6564 2070 6172 7420  considered part 
-0000e0b0: 6f66 2061 2073 7069 6b65 2e0a 2020 2020  of a spike..    
-0000e0c0: 2020 2020 3a70 6172 616d 2066 6c6f 6174      :param float
-0000e0d0: 206d 696e 5f73 7069 6b65 5f61 6d70 6c69   min_spike_ampli
-0000e0e0: 7475 6465 3a20 5468 6520 6d69 6e69 6d75  tude: The minimu
-0000e0f0: 6d20 616d 706c 6974 7564 6520 2861 626f  m amplitude (abo
-0000e100: 7665 2062 6173 656c 696e 6529 2072 6571  ve baseline) req
-0000e110: 7569 7265 6420 666f 7220 6120 7370 696b  uired for a spik
-0000e120: 6520 746f 2062 6520 636f 6e73 6964 6572  e to be consider
-0000e130: 6564 2e0a 2020 2020 2020 2020 3a70 6172  ed..        :par
-0000e140: 616d 204f 7074 696f 6e61 6c5b 666c 6f61  am Optional[floa
-0000e150: 745d 206d 696e 5f66 7768 6d3a 2054 6865  t] min_fwhm: The
-0000e160: 206d 696e 696d 756d 2066 756c 6c2d 7769   minimum full-wi
-0000e170: 6474 6820 6174 2068 616c 6620 6d61 7869  dth at half maxi
-0000e180: 6d75 6d20 2846 5748 4d29 2066 6f72 2061  mum (FWHM) for a
-0000e190: 2073 7069 6b65 2074 6f20 6265 2069 6e63   spike to be inc
-0000e1a0: 6c75 6465 642e 2049 6620 6e6f 7420 7370  luded. If not sp
-0000e1b0: 6563 6966 6965 642c 2069 7420 6465 6661  ecified, it defa
-0000e1c0: 756c 7473 2074 6f20 6e65 6761 7469 7665  ults to negative
-0000e1d0: 2069 6e66 696e 6974 792c 206d 6561 6e69   infinity, meani
-0000e1e0: 6e67 2069 7420 6973 206e 6f74 2063 6f6e  ng it is not con
-0000e1f0: 7369 6465 7265 6420 666f 7220 6669 6c74  sidered for filt
-0000e200: 6572 696e 672e 0a20 2020 2020 2020 203a  ering..        :
-0000e210: 7061 7261 6d20 4f70 7469 6f6e 616c 5b66  param Optional[f
-0000e220: 6c6f 6174 5d20 6d69 6e5f 6861 6c66 5f77  loat] min_half_w
-0000e230: 6964 7468 3a20 5468 6520 6d69 6e69 6d75  idth: The minimu
-0000e240: 6d20 6861 6c66 2d77 6964 7468 2072 6571  m half-width req
-0000e250: 7569 7265 6420 666f 7220 6120 7370 696b  uired for a spik
-0000e260: 6520 746f 2062 6520 696e 636c 7564 6564  e to be included
-0000e270: 2e20 4966 206e 6f74 2073 7065 6369 6669  . If not specifi
-0000e280: 6564 2c20 6974 2064 6566 6175 6c74 7320  ed, it defaults 
-0000e290: 746f 206e 6567 6174 6976 6520 696e 6669  to negative infi
-0000e2a0: 6e69 7479 2c20 6d65 616e 696e 6720 6974  nity, meaning it
-0000e2b0: 2069 7320 6e6f 7420 636f 6e73 6964 6572   is not consider
-0000e2c0: 6564 2066 6f72 2066 696c 7465 7269 6e67  ed for filtering
-0000e2d0: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-0000e2e0: 6e20 7475 706c 653a 2041 2074 7570 6c65  n tuple: A tuple
-0000e2f0: 2063 6f6e 7461 696e 696e 6720 7468 7265   containing thre
-0000e300: 6520 656c 656d 656e 7473 3a0a 2020 2020  e elements:.    
-0000e310: 2020 2020 2020 2020 2d20 7370 696b 655f          - spike_
-0000e320: 6964 7820 284c 6973 745b 6e70 2e6e 6461  idx (List[np.nda
-0000e330: 7272 6179 5d29 3a20 4120 6c69 7374 206f  rray]): A list o
-0000e340: 6620 3144 2061 7272 6179 732c 2065 6163  f 1D arrays, eac
-0000e350: 6820 7265 7072 6573 656e 7469 6e67 2074  h representing t
-0000e360: 6865 2069 6e64 6963 6573 206f 6620 7468  he indices of th
-0000e370: 6520 6461 7461 2070 6f69 6e74 7320 6265  e data points be
-0000e380: 6c6f 6e67 696e 6720 746f 2061 2064 6574  longing to a det
-0000e390: 6563 7465 6420 7370 696b 652e 0a20 2020  ected spike..   
-0000e3a0: 2020 2020 2020 2020 202d 2073 7069 6b65           - spike
-0000e3b0: 5f76 616c 7320 284c 6973 745b 6e70 2e6e  _vals (List[np.n
-0000e3c0: 6461 7272 6179 5d29 3a20 4120 6c69 7374  darray]): A list
-0000e3d0: 206f 6620 3144 2061 7272 6179 732c 2065   of 1D arrays, e
-0000e3e0: 6163 6820 636f 6e74 6169 6e69 6e67 2074  ach containing t
-0000e3f0: 6865 2076 616c 7565 7320 6f66 2074 6865  he values of the
-0000e400: 2064 6174 6120 706f 696e 7473 2077 6974   data points wit
-0000e410: 6869 6e20 6120 6465 7465 6374 6564 2073  hin a detected s
-0000e420: 7069 6b65 2e0a 2020 2020 2020 2020 2020  pike..          
-0000e430: 2020 2d20 7370 696b 655f 6469 6374 2028    - spike_dict (
-0000e440: 4469 6374 5b69 6e74 2c20 4469 6374 5b73  Dict[int, Dict[s
-0000e450: 7472 2c20 666c 6f61 745d 5d29 3a20 4120  tr, float]]): A 
-0000e460: 6469 6374 696f 6e61 7279 2077 6865 7265  dictionary where
-0000e470: 2074 6865 206b 6579 7320 6172 6520 7370   the keys are sp
-0000e480: 696b 6520 696e 6469 6365 732c 2061 6e64  ike indices, and
-0000e490: 2074 6865 2076 616c 7565 7320 6172 6520   the values are 
-0000e4a0: 6469 6374 696f 6e61 7269 6573 2063 6f6e  dictionaries con
-0000e4b0: 7461 696e 696e 6720 7370 696b 6520 6368  taining spike ch
-0000e4c0: 6172 6163 7465 7269 7374 6963 7320 696e  aracteristics in
-0000e4d0: 636c 7564 696e 6720 2761 6d70 6c69 7475  cluding 'amplitu
-0000e4e0: 6465 2720 2873 7069 6b65 2061 6d70 6c69  de' (spike ampli
-0000e4f0: 7475 6465 292c 2027 6677 686d 2720 2846  tude), 'fwhm' (F
-0000e500: 5748 4d29 2c20 616e 6420 2768 616c 665f  WHM), and 'half_
-0000e510: 7769 6474 6827 2028 6861 6c66 2d77 6964  width' (half-wid
-0000e520: 7468 292e 0a0a 2020 2020 2020 2020 2e2e  th)...        ..
-0000e530: 206e 6f74 653a 3a0a 2020 2020 2020 2020   note::.        
-0000e540: 2020 202d 2054 6865 2066 756e 6374 696f     - The functio
-0000e550: 6e20 7573 6573 2074 6865 204e 756d 6261  n uses the Numba
-0000e560: 204a 4954 2028 4a75 7374 2d49 6e2d 5469   JIT (Just-In-Ti
-0000e570: 6d65 2920 636f 6d70 696c 6174 696f 6e20  me) compilation 
-0000e580: 666f 7220 6f70 7469 6d69 7a65 6420 7065  for optimized pe
-0000e590: 7266 6f72 6d61 6e63 652e 2057 6974 686f  rformance. Witho
-0000e5a0: 7574 2066 6173 746d 6174 683d 5472 7565  ut fastmath=True
-0000e5b0: 2074 6865 7265 2069 7320 6e6f 2072 756e   there is no run
-0000e5c0: 7469 6d65 2069 6d70 726f 7665 6d65 6e74  time improvement
-0000e5d0: 206f 7665 7220 7374 616e 6461 7264 206e   over standard n
-0000e5e0: 756d 7079 2e0a 0a20 2020 2020 2020 203a  umpy...        :
-0000e5f0: 6578 616d 706c 653a 0a20 2020 2020 2020  example:.       
-0000e600: 203e 3e3e 2064 6174 6120 3d20 6e70 2e61   >>> data = np.a
-0000e610: 7272 6179 285b 302e 312c 2030 2e31 2c20  rray([0.1, 0.1, 
-0000e620: 302e 332c 2030 2e31 2c20 3130 2c20 3130  0.3, 0.1, 10, 10
-0000e630: 2c20 382c 2030 2e31 2c20 302e 312c 2030  , 8, 0.1, 0.1, 0
-0000e640: 2e31 2c20 3130 2c20 3130 2c20 382c 2039  .1, 10, 10, 8, 9
-0000e650: 392c 2030 2e31 2c20 3939 2c20 3939 2c20  9, 0.1, 99, 99, 
-0000e660: 302e 315d 292e 6173 7479 7065 286e 702e  0.1]).astype(np.
-0000e670: 666c 6f61 7433 3229 0a20 2020 2020 2020  float32).       
-0000e680: 203e 3e3e 2073 7069 6b65 5f69 6478 2c20   >>> spike_idx, 
-0000e690: 7370 696b 655f 7661 6c73 2c20 7370 696b  spike_vals, spik
-0000e6a0: 655f 7374 6174 7320 3d20 5469 6d65 7365  e_stats = Timese
-0000e6b0: 7269 6573 4665 6174 7572 654d 6978 696e  riesFeatureMixin
-0000e6c0: 2829 2e73 7069 6b65 5f66 696e 6465 7228  ().spike_finder(
-0000e6d0: 6461 7461 3d64 6174 612c 2062 6173 656c  data=data, basel
-0000e6e0: 696e 653d 312c 206d 696e 5f73 7069 6b65  ine=1, min_spike
-0000e6f0: 5f61 6d70 6c69 7475 6465 3d35 2c20 7361  _amplitude=5, sa
-0000e700: 6d70 6c65 5f72 6174 653d 322c 206d 696e  mple_rate=2, min
-0000e710: 5f66 7768 6d3d 2d6e 702e 696e 662c 206d  _fwhm=-np.inf, m
-0000e720: 696e 5f68 616c 665f 7769 6474 683d 302e  in_half_width=0.
-0000e730: 3030 3032 290a 2020 2020 2020 2020 2222  0002).        ""
-0000e740: 220a 0a20 2020 2020 2020 2073 7069 6b65  "..        spike
-0000e750: 5f69 6478 7320 3d20 6e70 2e61 7267 7768  _idxs = np.argwh
-0000e760: 6572 6528 6461 7461 203e 3d20 6261 7365  ere(data >= base
-0000e770: 6c69 6e65 202b 206d 696e 5f73 7069 6b65  line + min_spike
-0000e780: 5f61 6d70 6c69 7475 6465 292e 666c 6174  _amplitude).flat
-0000e790: 7465 6e28 290a 2020 2020 2020 2020 7370  ten().        sp
-0000e7a0: 696b 655f 6964 7820 3d20 6e70 2e73 706c  ike_idx = np.spl
-0000e7b0: 6974 280a 2020 2020 2020 2020 2020 2020  it(.            
-0000e7c0: 7370 696b 655f 6964 7873 2c20 6e70 2e61  spike_idxs, np.a
-0000e7d0: 7267 7768 6572 6528 7370 696b 655f 6964  rgwhere(spike_id
-0000e7e0: 7873 5b31 3a5d 202d 2073 7069 6b65 5f69  xs[1:] - spike_i
-0000e7f0: 6478 735b 3a2d 315d 2021 3d20 3129 2e66  dxs[:-1] != 1).f
-0000e800: 6c61 7474 656e 2829 202b 2031 0a20 2020  latten() + 1.   
-0000e810: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-0000e820: 7069 6b65 5f64 6963 7420 3d20 4469 6374  pike_dict = Dict
-0000e830: 2e65 6d70 7479 280a 2020 2020 2020 2020  .empty(.        
-0000e840: 2020 2020 6b65 795f 7479 7065 3d74 7970      key_type=typ
-0000e850: 6573 2e69 6e74 3634 2c0a 2020 2020 2020  es.int64,.      
-0000e860: 2020 2020 2020 7661 6c75 655f 7479 7065        value_type
-0000e870: 3d44 6963 742e 656d 7074 7928 0a20 2020  =Dict.empty(.   
-0000e880: 2020 2020 2020 2020 2020 2020 206b 6579               key
-0000e890: 5f74 7970 653d 7479 7065 732e 756e 6963  _type=types.unic
-0000e8a0: 6f64 655f 7479 7065 2c20 7661 6c75 655f  ode_type, value_
-0000e8b0: 7479 7065 3d74 7970 6573 2e66 6c6f 6174  type=types.float
-0000e8c0: 3634 0a20 2020 2020 2020 2020 2020 2029  64.            )
-0000e8d0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-0000e8e0: 2020 2020 7370 696b 655f 7661 6c73 203d      spike_vals =
-0000e8f0: 205b 5d0a 2020 2020 2020 2020 666f 7220   [].        for 
-0000e900: 6920 696e 2070 7261 6e67 6528 6c65 6e28  i in prange(len(
-0000e910: 7370 696b 655f 6964 7829 293a 0a20 2020  spike_idx)):.   
-0000e920: 2020 2020 2020 2020 2073 7069 6b65 5f64           spike_d
-0000e930: 6174 6120 3d20 6461 7461 5b73 7069 6b65  ata = data[spike
-0000e940: 5f69 6478 5b69 5d5d 0a20 2020 2020 2020  _idx[i]].       
-0000e950: 2020 2020 2073 7069 6b65 5f61 6d70 6c69       spike_ampli
-0000e960: 7475 6465 203d 206e 702e 6d61 7828 7370  tude = np.max(sp
-0000e970: 696b 655f 6461 7461 2920 2d20 6261 7365  ike_data) - base
-0000e980: 6c69 6e65 0a20 2020 2020 2020 2020 2020  line.           
-0000e990: 2068 616c 665f 7769 6474 685f 6964 7820   half_width_idx 
-0000e9a0: 3d20 6e70 2e61 7267 7768 6572 6528 7370  = np.argwhere(sp
-0000e9b0: 696b 655f 6461 7461 203e 2073 7069 6b65  ike_data > spike
-0000e9c0: 5f61 6d70 6c69 7475 6465 202f 2032 292e  _amplitude / 2).
-0000e9d0: 666c 6174 7465 6e28 290a 2020 2020 2020  flatten().      
-0000e9e0: 2020 2020 2020 7370 696b 655f 6469 6374        spike_dict
-0000e9f0: 5b69 5d20 3d20 7b0a 2020 2020 2020 2020  [i] = {.        
-0000ea00: 2020 2020 2020 2020 2261 6d70 6c69 7475          "amplitu
-0000ea10: 6465 223a 206e 702e 6d61 7828 7370 696b  de": np.max(spik
-0000ea20: 655f 6461 7461 2920 2d20 6261 7365 6c69  e_data) - baseli
-0000ea30: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-0000ea40: 2020 2020 2266 7768 6d22 3a20 2868 616c      "fwhm": (hal
-0000ea50: 665f 7769 6474 685f 6964 785b 2d31 5d20  f_width_idx[-1] 
-0000ea60: 2d20 6861 6c66 5f77 6964 7468 5f69 6478  - half_width_idx
-0000ea70: 5b30 5d29 202f 2073 616d 706c 655f 7261  [0]) / sample_ra
-0000ea80: 7465 2c0a 2020 2020 2020 2020 2020 2020  te,.            
-0000ea90: 2020 2020 2268 616c 665f 7769 6474 6822      "half_width"
-0000eaa0: 3a20 6861 6c66 5f77 6964 7468 5f69 6478  : half_width_idx
-0000eab0: 2e73 6861 7065 5b30 5d20 2f20 7361 6d70  .shape[0] / samp
-0000eac0: 6c65 5f72 6174 652c 0a20 2020 2020 2020  le_rate,.       
-0000ead0: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
-0000eae0: 2020 2073 7069 6b65 5f76 616c 732e 6170     spike_vals.ap
-0000eaf0: 7065 6e64 2873 7069 6b65 5f64 6174 6129  pend(spike_data)
-0000eb00: 0a0a 2020 2020 2020 2020 7265 6d6f 7665  ..        remove
-0000eb10: 5f69 6478 203d 205b 5d0a 2020 2020 2020  _idx = [].      
-0000eb20: 2020 666f 7220 6b2c 2076 2069 6e20 7370    for k, v in sp
-0000eb30: 696b 655f 6469 6374 2e69 7465 6d73 2829  ike_dict.items()
-0000eb40: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-0000eb50: 2028 765b 2266 7768 6d22 5d20 3c20 6d69   (v["fwhm"] < mi
-0000eb60: 6e5f 6677 686d 2920 6f72 2028 765b 2268  n_fwhm) or (v["h
-0000eb70: 616c 665f 7769 6474 6822 5d20 3c20 6d69  alf_width"] < mi
-0000eb80: 6e5f 6861 6c66 5f77 6964 7468 293a 0a20  n_half_width):. 
-0000eb90: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000eba0: 656d 6f76 655f 6964 782e 6170 7065 6e64  emove_idx.append
-0000ebb0: 286b 290a 2020 2020 2020 2020 666f 7220  (k).        for 
-0000ebc0: 6964 7820 696e 2072 656d 6f76 655f 6964  idx in remove_id
-0000ebd0: 783a 0a20 2020 2020 2020 2020 2020 2073  x:.            s
-0000ebe0: 7069 6b65 5f64 6963 742e 706f 7028 6964  pike_dict.pop(id
-0000ebf0: 7829 0a20 2020 2020 2020 2073 7069 6b65  x).        spike
-0000ec00: 5f69 6478 203d 205b 6920 666f 7220 6a2c  _idx = [i for j,
-0000ec10: 2069 2069 6e20 656e 756d 6572 6174 6528   i in enumerate(
-0000ec20: 7370 696b 655f 6964 7829 2069 6620 6a20  spike_idx) if j 
-0000ec30: 6e6f 7420 696e 2072 656d 6f76 655f 6964  not in remove_id
-0000ec40: 785d 0a20 2020 2020 2020 2073 7069 6b65  x].        spike
-0000ec50: 5f76 616c 7320 3d20 5b69 2066 6f72 206a  _vals = [i for j
-0000ec60: 2c20 6920 696e 2065 6e75 6d65 7261 7465  , i in enumerate
-0000ec70: 2873 7069 6b65 5f76 616c 7329 2069 6620  (spike_vals) if 
-0000ec80: 6a20 6e6f 7420 696e 2072 656d 6f76 655f  j not in remove_
-0000ec90: 6964 785d 0a0a 2020 2020 2020 2020 7265  idx]..        re
-0000eca0: 7475 726e 2073 7069 6b65 5f69 6478 2c20  turn spike_idx, 
-0000ecb0: 7370 696b 655f 7661 6c73 2c20 7370 696b  spike_vals, spik
-0000ecc0: 655f 6469 6374 0a0a 2020 2020 2320 406e  e_dict..    # @n
-0000ecd0: 6a69 7428 2228 666c 6f61 7433 325b 3a5d  jit("(float32[:]
-0000ece0: 2c20 7479 7065 732e 4c69 7374 2874 7970  , types.List(typ
-0000ecf0: 6573 2e41 7272 6179 2874 7970 6573 2e69  es.Array(types.i
-0000ed00: 6e74 3634 2c20 312c 2027 4327 2929 2c20  nt64, 1, 'C')), 
-0000ed10: 696e 7436 342c 2066 6c6f 6174 3634 2c20  int64, float64, 
-0000ed20: 666c 6f61 7436 3429 222c 2066 6173 746d  float64)", fastm
-0000ed30: 6174 683d 5472 7565 290a 2020 2020 4073  ath=True).    @s
-0000ed40: 7461 7469 636d 6574 686f 640a 2020 2020  taticmethod.    
-0000ed50: 406a 6974 286e 6f70 7974 686f 6e3d 5472  @jit(nopython=Tr
-0000ed60: 7565 2c20 6661 7374 6d61 7468 3d54 7275  ue, fastmath=Tru
-0000ed70: 6529 0a20 2020 2064 6566 2073 7069 6b65  e).    def spike
-0000ed80: 5f74 7261 696e 5f66 696e 6465 7228 0a20  _train_finder(. 
-0000ed90: 2020 2020 2020 2064 6174 613a 206e 702e         data: np.
-0000eda0: 6e64 6172 7261 792c 0a20 2020 2020 2020  ndarray,.       
-0000edb0: 2073 7069 6b65 5f69 6478 3a20 6c69 7374   spike_idx: list
-0000edc0: 2c0a 2020 2020 2020 2020 7361 6d70 6c65  ,.        sample
-0000edd0: 5f72 6174 653a 2066 6c6f 6174 2c0a 2020  _rate: float,.  
-0000ede0: 2020 2020 2020 6d69 6e5f 7370 696b 655f        min_spike_
-0000edf0: 7472 6169 6e5f 6c65 6e67 7468 3a20 666c  train_length: fl
-0000ee00: 6f61 7420 3d20 6e70 2e69 6e66 2c0a 2020  oat = np.inf,.  
-0000ee10: 2020 2020 2020 6d61 785f 7370 696b 655f        max_spike_
-0000ee20: 7472 6169 6e5f 7365 7061 7261 7469 6f6e  train_separation
-0000ee30: 3a20 666c 6f61 7420 3d20 6e70 2e69 6e66  : float = np.inf
-0000ee40: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-0000ee50: 2022 2222 0a20 2020 2020 2020 2049 6465   """.        Ide
-0000ee60: 6e74 6966 7920 616e 6420 616e 616c 797a  ntify and analyz
-0000ee70: 6520 7370 696b 6520 7472 6169 6e73 2066  e spike trains f
-0000ee80: 726f 6d20 6120 6c69 7374 206f 6620 7370  rom a list of sp
-0000ee90: 696b 6520 696e 6469 6365 732e 0a0a 2020  ike indices...  
-0000eea0: 2020 2020 2020 5468 6973 2066 756e 6374        This funct
-0000eeb0: 696f 6e20 7461 6b65 7320 7370 696b 6520  ion takes spike 
-0000eec0: 696e 6469 6365 7320 616e 6420 6164 6469  indices and addi
-0000eed0: 7469 6f6e 616c 2069 6e66 6f72 6d61 7469  tional informati
-0000eee0: 6f6e 2c20 7375 6368 2061 7320 7468 6520  on, such as the 
-0000eef0: 6461 7461 2c20 7361 6d70 6c65 2072 6174  data, sample rat
-0000ef00: 652c 0a20 2020 2020 2020 206d 696e 696d  e,.        minim
-0000ef10: 756d 2073 7069 6b65 2074 7261 696e 206c  um spike train l
-0000ef20: 656e 6774 682c 2061 6e64 206d 6178 696d  ength, and maxim
-0000ef30: 756d 2073 7069 6b65 2074 7261 696e 2073  um spike train s
-0000ef40: 6570 6172 6174 696f 6e2c 2074 6f20 6964  eparation, to id
-0000ef50: 656e 7469 6679 2061 6e64 2061 6e61 6c79  entify and analy
-0000ef60: 7a65 0a20 2020 2020 2020 2073 7069 6b65  ze.        spike
-0000ef70: 2074 7261 696e 7320 696e 2074 6865 2064   trains in the d
-0000ef80: 6174 612e 0a0a 2020 2020 2020 2020 2e2e  ata...        ..
-0000ef90: 206e 6f74 653a 3a0a 2020 2020 2020 2020   note::.        
-0000efa0: 2020 202d 2054 6865 2066 756e 6374 696f     - The functio
-0000efb0: 6e20 6d61 7920 7265 7475 726e 2061 6e20  n may return an 
-0000efc0: 656d 7074 7920 6469 6374 696f 6e61 7279  empty dictionary
-0000efd0: 2069 6620 6e6f 2073 7069 6b65 2074 7261   if no spike tra
-0000efe0: 696e 7320 6d65 6574 2074 6865 2063 7269  ins meet the cri
-0000eff0: 7465 7269 612e 0a20 2020 2020 2020 2020  teria..         
-0000f000: 2020 2d20 4120 7265 7175 6972 6564 2069    - A required i
-0000f010: 6e70 7574 2069 7320 6060 7370 696b 655f  nput is ``spike_
-0000f020: 6964 7860 602c 2077 6869 6368 2069 7320  idx``, which is 
-0000f030: 7265 7475 726e 6564 2062 7920 3a66 756e  returned by :fun
-0000f040: 633a 607e 7469 6d65 7365 7269 6573 5f66  c:`~timeseries_f
-0000f050: 6561 7475 7265 735f 6d69 7869 6e2e 5469  eatures_mixin.Ti
-0000f060: 6d65 7365 7269 6573 4665 6174 7572 654d  meseriesFeatureM
-0000f070: 6978 696e 2e73 7069 6b65 5f66 696e 6465  ixin.spike_finde
-0000f080: 7260 2e0a 0a0a 2020 2020 2020 2020 3a70  r`....        :p
-0000f090: 6172 616d 206e 702e 6e64 6172 7261 7920  aram np.ndarray 
-0000f0a0: 6461 7461 3a20 5468 6520 6461 7461 2066  data: The data f
-0000f0b0: 726f 6d20 7768 6963 6820 7370 696b 6520  rom which spike 
-0000f0c0: 7472 6169 6e73 2061 7265 2065 7874 7261  trains are extra
-0000f0d0: 6374 6564 2e0a 2020 2020 2020 2020 3a70  cted..        :p
-0000f0e0: 6172 616d 2074 7970 6573 2e4c 6973 7428  aram types.List(
-0000f0f0: 7479 7065 732e 4172 7261 7928 7479 7065  types.Array(type
-0000f100: 732e 696e 7436 342c 2031 2c20 2743 2729  s.int64, 1, 'C')
-0000f110: 2920 6461 7461 3a20 4120 6c69 7374 206f  ) data: A list o
-0000f120: 6620 7370 696b 6520 696e 6469 6365 732c  f spike indices,
-0000f130: 2074 7970 6963 616c 6c79 2061 7320 696e   typically as in
-0000f140: 7465 6765 7220 7469 6d65 7374 616d 7073  teger timestamps
-0000f150: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0000f160: 2066 6c6f 6174 2073 616d 706c 655f 7261   float sample_ra
-0000f170: 7465 3a20 5468 6520 7361 6d70 6c65 2072  te: The sample r
-0000f180: 6174 6520 6f66 2074 6865 2064 6174 612e  ate of the data.
-0000f190: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0000f1a0: 4f70 7469 6f6e 616c 5b66 6c6f 6174 5d20  Optional[float] 
-0000f1b0: 6d69 6e5f 7370 696b 655f 7472 6169 6e5f  min_spike_train_
-0000f1c0: 6c65 6e67 7468 3a20 5468 6520 6d69 6e69  length: The mini
-0000f1d0: 6d75 6d20 6c65 6e67 7468 2061 2073 7069  mum length a spi
-0000f1e0: 6b65 2074 7261 696e 206d 7573 7420 6861  ke train must ha
-0000f1f0: 7665 2074 6f20 6265 2063 6f6e 7369 6465  ve to be conside
-0000f200: 7265 642e 2044 6566 6175 6c74 2069 7320  red. Default is 
-0000f210: 7365 7420 746f 2070 6f73 6974 6976 6520  set to positive 
-0000f220: 696e 6669 6e69 7479 2c20 6d65 616e 696e  infinity, meanin
-0000f230: 6720 6e6f 206d 696e 696d 756d 206c 656e  g no minimum len
-0000f240: 6774 6820 6973 2065 6e66 6f72 6365 642e  gth is enforced.
-0000f250: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0000f260: 4f70 7469 6f6e 616c 5b66 6c6f 6174 5d20  Optional[float] 
-0000f270: 6d61 785f 7370 696b 655f 7472 6169 6e5f  max_spike_train_
-0000f280: 7365 7061 7261 7469 6f6e 3a20 5468 6520  separation: The 
-0000f290: 6d61 7869 6d75 6d20 616c 6c6f 7761 626c  maximum allowabl
-0000f2a0: 6520 7365 7061 7261 7469 6f6e 2062 6574  e separation bet
-0000f2b0: 7765 656e 2073 7069 6b65 7320 696e 2074  ween spikes in t
-0000f2c0: 6865 2073 616d 6520 7472 6169 6e2e 2044  he same train. D
-0000f2d0: 6566 6175 6c74 2069 7320 7365 7420 746f  efault is set to
-0000f2e0: 2070 6f73 6974 6976 6520 696e 6669 6e69   positive infini
-0000f2f0: 7479 2c20 6d65 616e 696e 6720 6e6f 206d  ty, meaning no m
-0000f300: 6178 696d 756d 2073 6570 6172 6174 696f  aximum separatio
-0000f310: 6e20 6973 2065 6e66 6f72 6365 642e 0a20  n is enforced.. 
-0000f320: 2020 2020 2020 203a 7265 7475 726e 2044         :return D
-0000f330: 6963 7454 7970 655b 696e 7436 342c 4469  ictType[int64,Di
-0000f340: 6374 5479 7065 5b75 6e69 636f 6465 5f74  ctType[unicode_t
-0000f350: 7970 652c 666c 6f61 7436 345d 5d3a 2041  ype,float64]]: A
-0000f360: 2064 6963 7469 6f6e 6172 7920 636f 6e74   dictionary cont
-0000f370: 6169 6e69 6e67 2069 6e66 6f72 6d61 7469  aining informati
-0000f380: 6f6e 2061 626f 7574 2069 6465 6e74 6966  on about identif
-0000f390: 6965 6420 7370 696b 6520 7472 6169 6e73  ied spike trains
-0000f3a0: 2e0a 0a20 2020 2020 2020 2045 6163 6820  ...        Each 
-0000f3b0: 656e 7472 7920 696e 2074 6865 2072 6574  entry in the ret
-0000f3c0: 7572 6e65 6420 6469 6374 696f 6e61 7279  urned dictionary
-0000f3d0: 2069 7320 696e 6465 7865 6420 6279 2061   is indexed by a
-0000f3e0: 6e20 696e 7465 6765 722c 2061 6e64 2063  n integer, and c
-0000f3f0: 6f6e 7461 696e 7320 7468 6520 666f 6c6c  ontains the foll
-0000f400: 6f77 696e 6720 696e 666f 726d 6174 696f  owing informatio
-0000f410: 6e3a 0a20 2020 2020 2020 2020 2020 202d  n:.            -
-0000f420: 2027 7472 6169 6e5f 7374 6172 745f 7469   'train_start_ti
-0000f430: 6d65 273a 2053 7461 7274 2074 696d 6520  me': Start time 
-0000f440: 6f66 2074 6865 2073 7069 6b65 2074 7261  of the spike tra
-0000f450: 696e 2069 6e20 7365 636f 6e64 732e 0a20  in in seconds.. 
-0000f460: 2020 2020 2020 2020 2020 202d 2027 7472             - 'tr
-0000f470: 6169 6e5f 656e 645f 7469 6d65 273a 2045  ain_end_time': E
-0000f480: 6e64 2074 696d 6520 6f66 2074 6865 2073  nd time of the s
-0000f490: 7069 6b65 2074 7261 696e 2069 6e20 7365  pike train in se
-0000f4a0: 636f 6e64 732e 0a20 2020 2020 2020 2020  conds..         
-0000f4b0: 2020 202d 2027 7472 6169 6e5f 7374 6172     - 'train_star
-0000f4c0: 745f 6f62 7327 3a20 5374 6172 7420 7469  t_obs': Start ti
-0000f4d0: 6d65 2069 6e64 6578 2069 6e20 6f62 7365  me index in obse
-0000f4e0: 7276 6174 696f 6e73 2e0a 2020 2020 2020  rvations..      
-0000f4f0: 2020 2020 2020 2d20 2774 7261 696e 5f65        - 'train_e
-0000f500: 6e64 5f6f 6273 273a 2045 6e64 2074 696d  nd_obs': End tim
-0000f510: 6520 696e 6465 7820 696e 206f 6273 6572  e index in obser
-0000f520: 7661 7469 6f6e 732e 0a20 2020 2020 2020  vations..       
-0000f530: 2020 2020 202d 2027 7370 696b 655f 636e       - 'spike_cn
-0000f540: 7427 3a20 4e75 6d62 6572 206f 6620 7370  t': Number of sp
-0000f550: 696b 6573 2069 6e20 7468 6520 7370 696b  ikes in the spik
-0000f560: 6520 7472 6169 6e2e 0a20 2020 2020 2020  e train..       
-0000f570: 2020 2020 202d 2027 7472 6169 6e5f 6c65       - 'train_le
-0000f580: 6e67 7468 5f6f 6273 5f63 6e74 273a 204c  ngth_obs_cnt': L
-0000f590: 656e 6774 6820 6f66 2074 6865 2073 7069  ength of the spi
-0000f5a0: 6b65 2074 7261 696e 2069 6e20 6f62 7365  ke train in obse
-0000f5b0: 7276 6174 696f 6e73 2e0a 2020 2020 2020  rvations..      
-0000f5c0: 2020 2020 2020 2d20 2774 7261 696e 5f6c        - 'train_l
-0000f5d0: 656e 6774 685f 6f62 735f 7327 3a20 4c65  ength_obs_s': Le
-0000f5e0: 6e67 7468 206f 6620 7468 6520 7370 696b  ngth of the spik
-0000f5f0: 6520 7472 6169 6e20 696e 2073 6563 6f6e  e train in secon
-0000f600: 6473 2e0a 2020 2020 2020 2020 2020 2020  ds..            
-0000f610: 2d20 2774 7261 696e 5f73 7069 6b65 5f6d  - 'train_spike_m
-0000f620: 6561 6e5f 6c65 6e67 7468 735f 7327 3a20  ean_lengths_s': 
-0000f630: 4d65 616e 206c 656e 6774 6820 6f66 2069  Mean length of i
-0000f640: 6e64 6976 6964 7561 6c20 7370 696b 6573  ndividual spikes
-0000f650: 2069 6e20 7365 636f 6e64 732e 0a20 2020   in seconds..   
-0000f660: 2020 2020 2020 2020 202d 2027 7472 6169           - 'trai
-0000f670: 6e5f 7370 696b 655f 7374 645f 6c65 6e67  n_spike_std_leng
-0000f680: 7468 5f6f 6273 273a 2053 7461 6e64 6172  th_obs': Standar
-0000f690: 6420 6465 7669 6174 696f 6e20 6f66 2073  d deviation of s
-0000f6a0: 7069 6b65 206c 656e 6774 6873 2069 6e20  pike lengths in 
-0000f6b0: 6f62 7365 7276 6174 696f 6e73 2e0a 2020  observations..  
-0000f6c0: 2020 2020 2020 2020 2020 2d20 2774 7261            - 'tra
-0000f6d0: 696e 5f73 7069 6b65 5f73 7464 5f6c 656e  in_spike_std_len
-0000f6e0: 6774 685f 7327 3a20 5374 616e 6461 7264  gth_s': Standard
-0000f6f0: 2064 6576 6961 7469 6f6e 206f 6620 7370   deviation of sp
-0000f700: 696b 6520 6c65 6e67 7468 7320 696e 2073  ike lengths in s
-0000f710: 6563 6f6e 6473 2e0a 2020 2020 2020 2020  econds..        
-0000f720: 2020 2020 2d20 2774 7261 696e 5f73 7069      - 'train_spi
-0000f730: 6b65 5f6d 6178 5f6c 656e 6774 685f 6f62  ke_max_length_ob
-0000f740: 7327 3a20 4d61 7869 6d75 6d20 7370 696b  s': Maximum spik
-0000f750: 6520 6c65 6e67 7468 2069 6e20 6f62 7365  e length in obse
-0000f760: 7276 6174 696f 6e73 2e0a 2020 2020 2020  rvations..      
-0000f770: 2020 2020 2020 2d20 2774 7261 696e 5f73        - 'train_s
-0000f780: 7069 6b65 5f6d 6178 5f6c 656e 6774 685f  pike_max_length_
-0000f790: 7327 3a20 4d61 7869 6d75 6d20 7370 696b  s': Maximum spik
-0000f7a0: 6520 6c65 6e67 7468 2069 6e20 7365 636f  e length in seco
-0000f7b0: 6e64 732e 0a20 2020 2020 2020 2020 2020  nds..           
-0000f7c0: 202d 2027 7472 6169 6e5f 7370 696b 655f   - 'train_spike_
-0000f7d0: 6d69 6e5f 6c65 6e67 7468 5f6f 6273 273a  min_length_obs':
-0000f7e0: 204d 696e 696d 756d 2073 7069 6b65 206c   Minimum spike l
-0000f7f0: 656e 6774 6820 696e 206f 6273 6572 7661  ength in observa
-0000f800: 7469 6f6e 732e 0a20 2020 2020 2020 2020  tions..         
-0000f810: 2020 202d 2027 7472 6169 6e5f 7370 696b     - 'train_spik
-0000f820: 655f 6d69 6e5f 6c65 6e67 7468 5f73 273a  e_min_length_s':
-0000f830: 204d 696e 696d 756d 2073 7069 6b65 206c   Minimum spike l
-0000f840: 656e 6774 6820 696e 2073 6563 6f6e 6473  ength in seconds
-0000f850: 2e0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-0000f860: 2774 7261 696e 5f6d 6561 6e5f 616d 706c  'train_mean_ampl
-0000f870: 6974 7564 6527 3a20 4d65 616e 2061 6d70  itude': Mean amp
-0000f880: 6c69 7475 6465 206f 6620 7468 6520 7370  litude of the sp
-0000f890: 696b 6520 7472 6169 6e2e 0a20 2020 2020  ike train..     
-0000f8a0: 2020 2020 2020 202d 2027 7472 6169 6e5f         - 'train_
-0000f8b0: 7374 645f 616d 706c 6974 7564 6527 3a20  std_amplitude': 
-0000f8c0: 5374 616e 6461 7264 2064 6576 6961 7469  Standard deviati
-0000f8d0: 6f6e 206f 6620 7370 696b 6520 616d 706c  on of spike ampl
-0000f8e0: 6974 7564 6573 2e0a 2020 2020 2020 2020  itudes..        
-0000f8f0: 2020 2020 2d20 2774 7261 696e 5f6d 696e      - 'train_min
-0000f900: 5f61 6d70 6c69 7475 6465 273a 204d 696e  _amplitude': Min
-0000f910: 696d 756d 2073 7069 6b65 2061 6d70 6c69  imum spike ampli
-0000f920: 7475 6465 2e0a 2020 2020 2020 2020 2020  tude..          
-0000f930: 2020 2d20 2774 7261 696e 5f6d 6178 5f61    - 'train_max_a
-0000f940: 6d70 6c69 7475 6465 273a 204d 6178 696d  mplitude': Maxim
-0000f950: 756d 2073 7069 6b65 2061 6d70 6c69 7475  um spike amplitu
-0000f960: 6465 2e0a 0a20 2020 2020 2020 203a 6578  de...        :ex
-0000f970: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
-0000f980: 3e3e 2064 6174 6120 3d20 6e70 2e61 7272  >> data = np.arr
-0000f990: 6179 285b 302e 312c 2030 2e31 2c20 302e  ay([0.1, 0.1, 0.
-0000f9a0: 332c 2030 2e31 2c20 3130 2c20 3130 2c20  3, 0.1, 10, 10, 
-0000f9b0: 382c 2030 2e31 2c20 302e 312c 2030 2e31  8, 0.1, 0.1, 0.1
-0000f9c0: 2c20 3130 2c20 3130 2c20 382c 2039 392c  , 10, 10, 8, 99,
-0000f9d0: 2030 2e31 2c20 3939 2c20 3939 2c20 302e   0.1, 99, 99, 0.
-0000f9e0: 315d 292e 6173 7479 7065 286e 702e 666c  1]).astype(np.fl
-0000f9f0: 6f61 7433 3229 0a20 2020 2020 2020 203e  oat32).        >
-0000fa00: 3e3e 2073 7069 6b65 5f69 6478 2c20 5f2c  >> spike_idx, _,
-0000fa10: 205f 203d 2054 696d 6573 6572 6965 7346   _ = TimeseriesF
-0000fa20: 6561 7475 7265 4d69 7869 6e28 292e 7370  eatureMixin().sp
-0000fa30: 696b 655f 6669 6e64 6572 2864 6174 613d  ike_finder(data=
-0000fa40: 6461 7461 2c20 6261 7365 6c69 6e65 3d30  data, baseline=0
-0000fa50: 2e33 2c20 6d69 6e5f 7370 696b 655f 616d  .3, min_spike_am
-0000fa60: 706c 6974 7564 653d 302e 322c 2073 616d  plitude=0.2, sam
-0000fa70: 706c 655f 7261 7465 3d32 2c20 6d69 6e5f  ple_rate=2, min_
-0000fa80: 6677 686d 3d2d 6e70 2e69 6e66 2c20 6d69  fwhm=-np.inf, mi
-0000fa90: 6e5f 6861 6c66 5f77 6964 7468 3d2d 6e70  n_half_width=-np
-0000faa0: 2e69 6e66 290a 2020 2020 2020 2020 3e3e  .inf).        >>
-0000fab0: 3e20 7265 7375 6c74 7320 3d20 5469 6d65  > results = Time
-0000fac0: 7365 7269 6573 4665 6174 7572 654d 6978  seriesFeatureMix
-0000fad0: 696e 2829 2e73 7069 6b65 5f74 7261 696e  in().spike_train
-0000fae0: 5f66 696e 6465 7228 6461 7461 3d64 6174  _finder(data=dat
-0000faf0: 612c 2073 7069 6b65 5f69 6478 3d74 7970  a, spike_idx=typ
-0000fb00: 6564 2e4c 6973 7428 7370 696b 655f 6964  ed.List(spike_id
-0000fb10: 7829 2c20 7361 6d70 6c65 5f72 6174 653d  x), sample_rate=
-0000fb20: 322e 302c 206d 696e 5f73 7069 6b65 5f74  2.0, min_spike_t
-0000fb30: 7261 696e 5f6c 656e 6774 683d 322e 302c  rain_length=2.0,
-0000fb40: 206d 6178 5f73 7069 6b65 5f74 7261 696e   max_spike_train
-0000fb50: 5f73 6570 6172 6174 696f 6e3d 322e 3029  _separation=2.0)
-0000fb60: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-0000fb70: 2020 2020 2020 280a 2020 2020 2020 2020        (.        
-0000fb80: 2020 2020 6c2c 0a20 2020 2020 2020 2020      l,.         
-0000fb90: 2020 2072 2c0a 2020 2020 2020 2020 2920     r,.        ) 
-0000fba0: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
-0000fbb0: 302c 0a20 2020 2020 2020 2020 2020 2031  0,.            1
-0000fbc0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-0000fbd0: 2020 2020 7472 6169 6e5f 6461 7461 5f69      train_data_i
-0000fbe0: 6478 203d 205b 5d0a 2020 2020 2020 2020  dx = [].        
-0000fbf0: 7472 6169 6e5f 7370 696b 6573 5f69 6478  train_spikes_idx
-0000fc00: 203d 205b 5d0a 2020 2020 2020 2020 6d61   = [].        ma
-0000fc10: 785f 7370 696b 655f 7472 6169 6e5f 7365  x_spike_train_se
-0000fc20: 7061 7261 7469 6f6e 203d 2069 6e74 286d  paration = int(m
-0000fc30: 6178 5f73 7069 6b65 5f74 7261 696e 5f73  ax_spike_train_s
-0000fc40: 6570 6172 6174 696f 6e20 2a20 7361 6d70  eparation * samp
-0000fc50: 6c65 5f72 6174 6529 0a20 2020 2020 2020  le_rate).       
-0000fc60: 206d 696e 5f73 7069 6b65 5f74 7261 696e   min_spike_train
-0000fc70: 5f6c 656e 6774 6820 3d20 696e 7428 6d69  _length = int(mi
-0000fc80: 6e5f 7370 696b 655f 7472 6169 6e5f 6c65  n_spike_train_le
-0000fc90: 6e67 7468 202a 2073 616d 706c 655f 7261  ngth * sample_ra
-0000fca0: 7465 290a 2020 2020 2020 2020 7768 696c  te).        whil
-0000fcb0: 6520 6c20 3c20 6c65 6e28 7370 696b 655f  e l < len(spike_
-0000fcc0: 6964 7829 3a0a 2020 2020 2020 2020 2020  idx):.          
-0000fcd0: 2020 6375 7272 656e 745f 7472 6169 6e2c    current_train,
-0000fce0: 2063 7572 7265 6e74 5f73 7069 6b65 5f69   current_spike_i
-0000fcf0: 6478 203d 2073 7069 6b65 5f69 6478 5b6c  dx = spike_idx[l
-0000fd00: 5d2c 205b 6c5d 0a20 2020 2020 2020 2020  ], [l].         
-0000fd10: 2020 2077 6869 6c65 2072 203c 206c 656e     while r < len
-0000fd20: 2873 7069 6b65 5f69 6478 2920 616e 6420  (spike_idx) and 
-0000fd30: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000fd40: 2020 2873 7069 6b65 5f69 6478 5b72 5d5b    (spike_idx[r][
-0000fd50: 305d 202d 2063 7572 7265 6e74 5f74 7261  0] - current_tra
-0000fd60: 696e 5b2d 315d 2920 3c3d 206d 6178 5f73  in[-1]) <= max_s
-0000fd70: 7069 6b65 5f74 7261 696e 5f73 6570 6172  pike_train_separ
-0000fd80: 6174 696f 6e0a 2020 2020 2020 2020 2020  ation.          
-0000fd90: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
-0000fda0: 2020 2020 2063 7572 7265 6e74 5f74 7261       current_tra
-0000fdb0: 696e 203d 206e 702e 6873 7461 636b 2828  in = np.hstack((
-0000fdc0: 6375 7272 656e 745f 7472 6169 6e2c 2073  current_train, s
-0000fdd0: 7069 6b65 5f69 6478 5b72 5d29 290a 2020  pike_idx[r])).  
-0000fde0: 2020 2020 2020 2020 2020 2020 2020 6375                cu
-0000fdf0: 7272 656e 745f 7370 696b 655f 6964 782e  rrent_spike_idx.
-0000fe00: 6170 7065 6e64 2872 290a 2020 2020 2020  append(r).      
-0000fe10: 2020 2020 2020 2020 2020 7220 2b3d 2031            r += 1
-0000fe20: 0a20 2020 2020 2020 2020 2020 206c 2c20  .            l, 
-0000fe30: 7220 3d20 722c 2072 202b 2031 0a20 2020  r = r, r + 1.   
-0000fe40: 2020 2020 2020 2020 2074 7261 696e 5f64           train_d
-0000fe50: 6174 615f 6964 782e 6170 7065 6e64 2863  ata_idx.append(c
-0000fe60: 7572 7265 6e74 5f74 7261 696e 290a 2020  urrent_train).  
-0000fe70: 2020 2020 2020 2020 2020 7472 6169 6e5f            train_
-0000fe80: 7370 696b 6573 5f69 6478 2e61 7070 656e  spikes_idx.appen
-0000fe90: 6428 6375 7272 656e 745f 7370 696b 655f  d(current_spike_
-0000fea0: 6964 7829 0a0a 2020 2020 2020 2020 7370  idx)..        sp
-0000feb0: 696b 655f 6469 6374 203d 2044 6963 742e  ike_dict = Dict.
-0000fec0: 656d 7074 7928 0a20 2020 2020 2020 2020  empty(.         
-0000fed0: 2020 206b 6579 5f74 7970 653d 7479 7065     key_type=type
-0000fee0: 732e 696e 7436 342c 0a20 2020 2020 2020  s.int64,.       
-0000fef0: 2020 2020 2076 616c 7565 5f74 7970 653d       value_type=
-0000ff00: 4469 6374 2e65 6d70 7479 280a 2020 2020  Dict.empty(.    
-0000ff10: 2020 2020 2020 2020 2020 2020 6b65 795f              key_
-0000ff20: 7479 7065 3d74 7970 6573 2e75 6e69 636f  type=types.unico
-0000ff30: 6465 5f74 7970 652c 2076 616c 7565 5f74  de_type, value_t
-0000ff40: 7970 653d 7479 7065 732e 666c 6f61 7436  ype=types.float6
-0000ff50: 340a 2020 2020 2020 2020 2020 2020 292c  4.            ),
-0000ff60: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-0000ff70: 2020 2066 6f72 2069 2069 6e20 7072 616e     for i in pran
-0000ff80: 6765 286c 656e 2874 7261 696e 5f64 6174  ge(len(train_dat
-0000ff90: 615f 6964 7829 293a 0a20 2020 2020 2020  a_idx)):.       
-0000ffa0: 2020 2020 2069 6620 7472 6169 6e5f 6461       if train_da
-0000ffb0: 7461 5f69 6478 5b69 5d2e 7368 6170 655b  ta_idx[i].shape[
-0000ffc0: 305d 203e 3d20 6d69 6e5f 7370 696b 655f  0] >= min_spike_
-0000ffd0: 7472 6169 6e5f 6c65 6e67 7468 3a0a 2020  train_length:.  
-0000ffe0: 2020 2020 2020 2020 2020 2020 2020 7370                sp
-0000fff0: 696b 655f 7472 6169 6e5f 616d 7073 203d  ike_train_amps =
-00010000: 2064 6174 615b 7472 6169 6e5f 6461 7461   data[train_data
-00010010: 5f69 6478 5b69 5d5d 0a20 2020 2020 2020  _idx[i]].       
-00010020: 2020 2020 2020 2020 2073 7069 6b65 5f74           spike_t
-00010030: 7261 696e 5f69 6478 203d 205b 0a20 2020  rain_idx = [.   
-00010040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010050: 206b 2066 6f72 206a 2c20 6b20 696e 2065   k for j, k in e
-00010060: 6e75 6d65 7261 7465 2873 7069 6b65 5f69  numerate(spike_i
-00010070: 6478 2920 6966 206a 2069 6e20 7472 6169  dx) if j in trai
-00010080: 6e5f 7370 696b 6573 5f69 6478 5b69 5d0a  n_spikes_idx[i].
-00010090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000100a0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-000100b0: 2020 7472 6169 6e5f 7370 696b 655f 6c65    train_spike_le
-000100c0: 6e67 7468 7320 3d20 6e70 2e61 7272 6179  ngths = np.array
-000100d0: 2828 5b6c 656e 286a 2920 666f 7220 6a20  (([len(j) for j 
-000100e0: 696e 2073 7069 6b65 5f74 7261 696e 5f69  in spike_train_i
-000100f0: 6478 5d29 290a 2020 2020 2020 2020 2020  dx])).          
-00010100: 2020 2020 2020 7370 696b 655f 6469 6374        spike_dict
-00010110: 5b69 6e74 2869 295d 203d 207b 0a20 2020  [int(i)] = {.   
-00010120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010130: 2022 7472 6169 6e5f 7374 6172 745f 7469   "train_start_ti
-00010140: 6d65 223a 2066 6c6f 6174 2874 7261 696e  me": float(train
-00010150: 5f64 6174 615f 6964 785b 695d 5b30 5d20  _data_idx[i][0] 
-00010160: 2a20 7361 6d70 6c65 5f72 6174 6529 2c0a  * sample_rate),.
-00010170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010180: 2020 2020 2274 7261 696e 5f65 6e64 5f74      "train_end_t
-00010190: 696d 6522 3a20 7472 6169 6e5f 6461 7461  ime": train_data
-000101a0: 5f69 6478 5b69 5d5b 2d31 5d20 2a20 7361  _idx[i][-1] * sa
-000101b0: 6d70 6c65 5f72 6174 652c 0a20 2020 2020  mple_rate,.     
-000101c0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000101d0: 7472 6169 6e5f 7374 6172 745f 6f62 7322  train_start_obs"
-000101e0: 3a20 7472 6169 6e5f 6461 7461 5f69 6478  : train_data_idx
-000101f0: 5b69 5d5b 305d 2c0a 2020 2020 2020 2020  [i][0],.        
-00010200: 2020 2020 2020 2020 2020 2020 2274 7261              "tra
-00010210: 696e 5f65 6e64 5f6f 6273 223a 2074 7261  in_end_obs": tra
-00010220: 696e 5f64 6174 615f 6964 785b 695d 5b2d  in_data_idx[i][-
-00010230: 315d 2c0a 2020 2020 2020 2020 2020 2020  1],.            
-00010240: 2020 2020 2020 2020 2273 7069 6b65 5f63          "spike_c
-00010250: 6e74 223a 206c 656e 2874 7261 696e 5f73  nt": len(train_s
-00010260: 7069 6b65 735f 6964 785b 695d 292c 0a20  pikes_idx[i]),. 
-00010270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010280: 2020 2022 7472 6169 6e5f 6c65 6e67 7468     "train_length
-00010290: 5f6f 6273 5f63 6e74 223a 206c 656e 2873  _obs_cnt": len(s
-000102a0: 7069 6b65 5f74 7261 696e 5f61 6d70 7329  pike_train_amps)
-000102b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000102c0: 2020 2020 2020 2274 7261 696e 5f6c 656e        "train_len
-000102d0: 6774 685f 6f62 735f 7322 3a20 6c65 6e28  gth_obs_s": len(
-000102e0: 7370 696b 655f 7472 6169 6e5f 616d 7073  spike_train_amps
-000102f0: 2920 2f20 7361 6d70 6c65 5f72 6174 652c  ) / sample_rate,
-00010300: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010310: 2020 2020 2022 7472 6169 6e5f 7370 696b       "train_spik
-00010320: 655f 6d65 616e 5f6c 656e 6774 6873 5f73  e_mean_lengths_s
-00010330: 223a 206e 702e 6d65 616e 2874 7261 696e  ": np.mean(train
-00010340: 5f73 7069 6b65 5f6c 656e 6774 6873 290a  _spike_lengths).
-00010350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010360: 2020 2020 2a20 7361 6d70 6c65 5f72 6174      * sample_rat
-00010370: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-00010380: 2020 2020 2020 2022 7472 6169 6e5f 7370         "train_sp
-00010390: 696b 655f 7374 645f 6c65 6e67 7468 5f6f  ike_std_length_o
-000103a0: 6273 223a 206e 702e 6d65 616e 2874 7261  bs": np.mean(tra
-000103b0: 696e 5f73 7069 6b65 5f6c 656e 6774 6873  in_spike_lengths
-000103c0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-000103d0: 2020 2020 2020 2022 7472 6169 6e5f 7370         "train_sp
-000103e0: 696b 655f 7374 645f 6c65 6e67 7468 5f73  ike_std_length_s
-000103f0: 223a 206e 702e 6d65 616e 2874 7261 696e  ": np.mean(train
-00010400: 5f73 7069 6b65 5f6c 656e 6774 6873 290a  _spike_lengths).
+000002c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000002d0: 6368 6563 6b5f 7374 722c 2063 6865 636b  check_str, check
+000002e0: 5f74 6861 745f 636f 6c75 6d6e 5f65 7869  _that_column_exi
+000002f0: 7374 2c0a 2020 2020 2020 2020 2020 2020  st,.            
+00000300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000310: 2020 2020 6368 6563 6b5f 7661 6c69 645f      check_valid_
+00000320: 6172 7261 792c 2063 6865 636b 5f76 616c  array, check_val
+00000330: 6964 5f6c 7374 290a 6672 6f6d 2073 696d  id_lst).from sim
+00000340: 6261 2e75 7469 6c73 2e72 6561 645f 7772  ba.utils.read_wr
+00000350: 6974 6520 696d 706f 7274 2066 696e 645f  ite import find_
+00000360: 636f 7265 5f63 6e74 0a0a 0a63 6c61 7373  core_cnt...class
+00000370: 2054 696d 6573 6572 6965 7346 6561 7475   TimeseriesFeatu
+00000380: 7265 4d69 7869 6e28 6f62 6a65 6374 293a  reMixin(object):
+00000390: 0a20 2020 2022 2222 0a20 2020 2054 696d  .    """.    Tim
+000003a0: 652d 7365 7269 6573 206d 6574 686f 6473  e-series methods
+000003b0: 2066 6f63 7573 6564 206f 6e20 7369 676e   focused on sign
+000003c0: 616c 2063 6f6d 706c 6578 6974 7920 696e  al complexity in
+000003d0: 2073 6c69 6469 6e67 2077 696e 646f 7773   sliding windows
+000003e0: 2e20 4d61 696e 6c79 2069 6e20 7469 6d65  . Mainly in time
+000003f0: 2d64 6f6d 6169 6e20 2d20 6666 7420 6d65  -domain - fft me
+00000400: 7468 6f64 7320 2874 6872 6f75 6768 2065  thods (through e
+00000410: 2e67 2e20 7363 6970 7929 0a20 2020 2049  .g. scipy).    I
+00000420: 2776 6520 666f 756e 6420 736f 2066 6172  've found so far
+00000430: 2068 6173 206e 6f74 2062 6565 6e20 6661   has not been fa
+00000440: 7374 2065 6e6f 7567 6820 666f 7220 726f  st enough for ro
+00000450: 6c6c 696e 6720 7769 6e64 6f77 7320 696e  lling windows in
+00000460: 206c 6172 6765 2064 6174 6173 6574 732e   large datasets.
+00000470: 0a0a 2020 2020 2e2e 2069 6d61 6765 3a3a  ..    .. image::
+00000480: 205f 7374 6174 6963 2f69 6d67 2f74 735f   _static/img/ts_
+00000490: 7275 6e74 696d 6573 2e70 6e67 0a20 2020  runtimes.png.   
+000004a0: 2020 2020 3a77 6964 7468 3a20 3132 3030      :width: 1200
+000004b0: 0a20 2020 2020 2020 3a61 6c69 676e 3a20  .       :align: 
+000004c0: 6365 6e74 6572 0a0a 2020 2020 2e2e 206e  center..    .. n
+000004d0: 6f74 653a 3a0a 2020 2020 2020 204d 616e  ote::.       Man
+000004e0: 7920 6d65 7468 6f64 2068 6173 206e 756d  y method has num
+000004f0: 6261 2074 7970 6564 2060 7369 676e 6174  ba typed `signat
+00000500: 7572 6573 203c 6874 7470 733a 2f2f 6e75  ures <https://nu
+00000510: 6d62 612e 7079 6461 7461 2e6f 7267 2f6e  mba.pydata.org/n
+00000520: 756d 6261 2d64 6f63 2f6c 6174 6573 742f  umba-doc/latest/
+00000530: 7265 6665 7265 6e63 652f 7479 7065 732e  reference/types.
+00000540: 6874 6d6c 3e60 5f20 746f 2064 6563 7265  html>`_ to decre
+00000550: 6173 650a 2020 2020 2020 2063 6f6d 7069  ase.       compi
+00000560: 6c61 7469 6f6e 2074 696d 6520 7468 726f  lation time thro
+00000570: 7567 6820 7265 6475 6365 6420 7479 7065  ugh reduced type
+00000580: 2069 6e66 6572 656e 6365 2e20 4d61 6b65   inference. Make
+00000590: 2073 7572 6520 746f 2070 6173 7320 7468   sure to pass th
+000005a0: 6520 636f 7272 6563 7420 6474 7970 6573  e correct dtypes
+000005b0: 2061 7320 696e 6469 6361 7465 6420 6279   as indicated by
+000005c0: 2073 6967 6e61 7475 7265 2064 6563 6f72   signature decor
+000005d0: 6174 6f72 732e 0a0a 2020 2020 2e2e 2069  ators...    .. i
+000005e0: 6d70 6f72 7461 6e74 3a3a 0a20 2020 2020  mportant::.     
+000005f0: 2020 5365 6520 7265 6665 7265 6e63 6573    See references
+00000600: 2066 6f72 206d 6174 7572 6520 7061 636b   for mature pack
+00000610: 6167 6573 2063 6f6d 7075 7469 6e67 206d  ages computing m
+00000620: 6f72 6520 6578 7465 6e73 6976 6520 7469  ore extensive ti
+00000630: 6d65 7365 7269 6573 206d 6561 7375 7265  meseries measure
+00000640: 6d65 6e74 730a 0a20 2020 2020 2020 2e2e  ments..       ..
+00000650: 205b 315d 2060 6365 7369 756d 203c 6874   [1] `cesium <ht
+00000660: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
+00000670: 2f63 6573 6975 6d2d 6d6c 2f63 6573 6975  /cesium-ml/cesiu
+00000680: 6d3e 605f 2e0a 2020 2020 2020 202e 2e20  m>`_..       .. 
+00000690: 5b32 5d20 6065 6567 6c69 6220 3c68 7474  [2] `eeglib <htt
+000006a0: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
+000006b0: 5869 756c 3130 392f 6565 676c 6962 3e60  Xiul109/eeglib>`
+000006c0: 5f2e 0a20 2020 2020 2020 2e2e 205b 335d  _..       .. [3]
+000006d0: 2060 616e 7472 6f70 7920 3c68 7474 7073   `antropy <https
+000006e0: 3a2f 2f67 6974 6875 622e 636f 6d2f 7261  ://github.com/ra
+000006f0: 7068 6165 6c76 616c 6c61 742f 616e 7472  phaelvallat/antr
+00000700: 6f70 793e 605f 2e0a 2020 2020 2020 202e  opy>`_..       .
+00000710: 2e20 5b34 5d20 6074 7366 7265 7368 203c  . [4] `tsfresh <
+00000720: 6874 7470 733a 2f2f 7473 6672 6573 682e  https://tsfresh.
+00000730: 7265 6164 7468 6564 6f63 732e 696f 3e60  readthedocs.io>`
+00000740: 5f2e 0a20 2020 2020 2020 2e2e 205b 355d  _..       .. [5]
+00000750: 2060 7079 6361 7265 7420 3c68 7474 7073   `pycaret <https
+00000760: 3a2f 2f67 6974 6875 622e 636f 6d2f 7079  ://github.com/py
+00000770: 6361 7265 742f 7079 6361 7265 743e 605f  caret/pycaret>`_
+00000780: 2e0a 2020 2020 2222 220a 0a20 2020 2064  ..    """..    d
+00000790: 6566 205f 5f69 6e69 745f 5f28 7365 6c66  ef __init__(self
+000007a0: 293a 0a20 2020 2020 2020 2070 6173 730a  ):.        pass.
+000007b0: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
+000007c0: 6f64 0a20 2020 2040 6e6a 6974 2822 2866  od.    @njit("(f
+000007d0: 6c6f 6174 3332 5b3a 5d2c 2922 290a 2020  loat32[:],)").  
+000007e0: 2020 6465 6620 686a 6f72 745f 7061 7261    def hjort_para
+000007f0: 6d65 7465 7273 2864 6174 613a 206e 702e  meters(data: np.
+00000800: 6e64 6172 7261 7929 202d 3e20 2866 6c6f  ndarray) -> (flo
+00000810: 6174 2c20 666c 6f61 742c 2066 6c6f 6174  at, float, float
+00000820: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00000830: 2020 2020 2020 204a 6974 7465 6420 636f         Jitted co
+00000840: 6d70 7574 6520 6f66 2048 6a6f 7274 6820  mpute of Hjorth 
+00000850: 7061 7261 6d65 7465 7273 2066 6f72 2061  parameters for a
+00000860: 2067 6976 656e 2074 696d 6520 7365 7269   given time seri
+00000870: 6573 2064 6174 612e 2048 6a6f 7274 6820  es data. Hjorth 
+00000880: 7061 7261 6d65 7465 7273 2064 6573 6372  parameters descr
+00000890: 6962 650a 2020 2020 2020 2020 6d6f 6269  ibe.        mobi
+000008a0: 6c69 7479 2c20 636f 6d70 6c65 7869 7479  lity, complexity
+000008b0: 2c20 616e 6420 6163 7469 7669 7479 206f  , and activity o
+000008c0: 6620 6120 7469 6d65 2073 6572 6965 732e  f a time series.
+000008d0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000008e0: 206e 756d 7079 2e6e 6461 7272 6179 2064   numpy.ndarray d
+000008f0: 6174 613a 2041 2031 2d64 696d 656e 7369  ata: A 1-dimensi
+00000900: 6f6e 616c 206e 756d 7079 2061 7272 6179  onal numpy array
+00000910: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
+00000920: 7469 6d65 2073 6572 6965 7320 6461 7461  time series data
+00000930: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
+00000940: 6e3a 2074 7570 6c65 0a20 2020 2020 2020  n: tuple.       
+00000950: 2020 2020 2041 2074 7570 6c65 2063 6f6e       A tuple con
+00000960: 7461 696e 696e 6720 7468 6520 666f 6c6c  taining the foll
+00000970: 6f77 696e 6720 486a 6f72 7468 2070 6172  owing Hjorth par
+00000980: 616d 6574 6572 733a 0a20 2020 2020 2020  ameters:.       
+00000990: 2020 2020 202d 2061 6374 6976 6974 7920       - activity 
+000009a0: 2866 6c6f 6174 293a 2054 6865 2061 6374  (float): The act
+000009b0: 6976 6974 7920 6f66 2074 6865 2074 696d  ivity of the tim
+000009c0: 6520 7365 7269 6573 2c20 7768 6963 6820  e series, which 
+000009d0: 6973 2074 6865 2076 6172 6961 6e63 6520  is the variance 
+000009e0: 6f66 2074 6865 2069 6e70 7574 2064 6174  of the input dat
+000009f0: 612e 0a20 2020 2020 2020 2020 2020 202d  a..            -
+00000a00: 206d 6f62 696c 6974 7920 2866 6c6f 6174   mobility (float
+00000a10: 293a 2054 6865 206d 6f62 696c 6974 7920  ): The mobility 
+00000a20: 6f66 2074 6865 2074 696d 6520 7365 7269  of the time seri
+00000a30: 6573 2c20 6361 6c63 756c 6174 6564 2061  es, calculated a
+00000a40: 7320 7468 6520 7371 7561 7265 2072 6f6f  s the square roo
+00000a50: 7420 6f66 2074 6865 2076 6172 6961 6e63  t of the varianc
+00000a60: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00000a70: 6f66 2074 6865 2066 6972 7374 2064 6572  of the first der
+00000a80: 6976 6174 6976 6520 6f66 2074 6865 2069  ivative of the i
+00000a90: 6e70 7574 2064 6174 6120 6469 7669 6465  nput data divide
+00000aa0: 6420 6279 2074 6865 2076 6172 6961 6e63  d by the varianc
+00000ab0: 6520 6f66 2074 6865 2069 6e70 7574 2064  e of the input d
+00000ac0: 6174 612e 0a20 2020 2020 2020 2020 2020  ata..           
+00000ad0: 202d 2063 6f6d 706c 6578 6974 7920 2866   - complexity (f
+00000ae0: 6c6f 6174 293a 2054 6865 2063 6f6d 706c  loat): The compl
+00000af0: 6578 6974 7920 6f66 2074 6865 2074 696d  exity of the tim
+00000b00: 6520 7365 7269 6573 2c20 6361 6c63 756c  e series, calcul
+00000b10: 6174 6564 2061 7320 7468 6520 7371 7561  ated as the squa
+00000b20: 7265 2072 6f6f 7420 6f66 2074 6865 2076  re root of the v
+00000b30: 6172 6961 6e63 650a 2020 2020 2020 2020  ariance.        
+00000b40: 2020 2020 2020 6f66 2074 6865 2073 6563        of the sec
+00000b50: 6f6e 6420 6465 7269 7661 7469 7665 206f  ond derivative o
+00000b60: 6620 7468 6520 696e 7075 7420 6461 7461  f the input data
+00000b70: 2064 6976 6964 6564 2062 7920 7468 6520   divided by the 
+00000b80: 7661 7269 616e 6365 206f 6620 7468 6520  variance of the 
+00000b90: 6669 7273 7420 6465 7269 7661 7469 7665  first derivative
+00000ba0: 2c20 616e 6420 7468 656e 0a20 2020 2020  , and then.     
+00000bb0: 2020 2020 2020 2020 2064 6976 6964 6564           divided
+00000bc0: 2062 7920 7468 6520 6d6f 6269 6c69 7479   by the mobility
+00000bd0: 2e0a 0a20 2020 2020 2020 203a 6578 616d  ...        :exam
+00000be0: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
+00000bf0: 2064 6174 6120 3d20 6e70 2e61 7272 6179   data = np.array
+00000c00: 285b 312e 302c 2032 2e30 2c20 332e 302c  ([1.0, 2.0, 3.0,
+00000c10: 2034 2e30 2c20 352e 305d 2c20 6474 7970   4.0, 5.0], dtyp
+00000c20: 653d 6e70 2e66 6c6f 6174 3332 290a 2020  e=np.float32).  
+00000c30: 2020 2020 2020 3e3e 3e20 5469 6d65 7365        >>> Timese
+00000c40: 7269 6573 4665 6174 7572 654d 6978 696e  riesFeatureMixin
+00000c50: 2829 2e68 6a6f 7274 5f70 6172 616d 6574  ().hjort_paramet
+00000c60: 6572 7328 6461 7461 290a 2020 2020 2020  ers(data).      
+00000c70: 2020 3e3e 3e20 2832 2e35 2c20 302e 352c    >>> (2.5, 0.5,
+00000c80: 2030 2e34 3038 3234 3832 3930 3436 3338   0.4082482904638
+00000c90: 3633 3129 0a0a 2020 2020 2020 2020 3a6d  631)..        :m
+00000ca0: 6174 683a 606d 6f62 696c 6974 7920 3d20  ath:`mobility = 
+00000cb0: 5c73 7172 747b 5c5c 6672 6163 7b64 785f  \sqrt{\\frac{dx_
+00000cc0: 7b76 6172 7d7d 7b78 5f7b 7661 727d 7d7d  {var}}{x_{var}}}
+00000cd0: 600a 0a20 2020 2020 2020 203a 6d61 7468  `..        :math
+00000ce0: 3a60 636f 6d70 6c65 7869 7479 203d 205c  :`complexity = \
+00000cf0: 7371 7274 7b5c 5c66 7261 637b 6464 785f  sqrt{\\frac{ddx_
+00000d00: 7b76 6172 7d7d 7b64 785f 7b76 6172 7d7d  {var}}{dx_{var}}
+00000d10: 202f 206d 6f62 696c 6974 797d 600a 2020   / mobility}`.  
+00000d20: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00000d30: 2020 6478 203d 206e 702e 6469 6666 286e    dx = np.diff(n
+00000d40: 702e 6173 636f 6e74 6967 756f 7573 6172  p.ascontiguousar
+00000d50: 7261 7928 6461 7461 2929 0a20 2020 2020  ray(data)).     
+00000d60: 2020 2064 6478 203d 206e 702e 6469 6666     ddx = np.diff
+00000d70: 286e 702e 6173 636f 6e74 6967 756f 7573  (np.ascontiguous
+00000d80: 6172 7261 7928 6478 2929 0a20 2020 2020  array(dx)).     
+00000d90: 2020 2078 5f76 6172 2c20 6478 5f76 6172     x_var, dx_var
+00000da0: 203d 206e 702e 7661 7228 6461 7461 292c   = np.var(data),
+00000db0: 206e 702e 7661 7228 6478 290a 2020 2020   np.var(dx).    
+00000dc0: 2020 2020 6966 2028 785f 7661 7220 3c3d      if (x_var <=
+00000dd0: 2030 2920 6f72 2028 6478 5f76 6172 203c   0) or (dx_var <
+00000de0: 3d20 3029 3a0a 2020 2020 2020 2020 2020  = 0):.          
+00000df0: 2020 7265 7475 726e 2030 2c20 302c 2030    return 0, 0, 0
+00000e00: 0a0a 2020 2020 2020 2020 6464 785f 7661  ..        ddx_va
+00000e10: 7220 3d20 6e70 2e76 6172 2864 6478 290a  r = np.var(ddx).
+00000e20: 2020 2020 2020 2020 6d6f 6269 6c69 7479          mobility
+00000e30: 203d 206e 702e 7371 7274 2864 785f 7661   = np.sqrt(dx_va
+00000e40: 7220 2f20 785f 7661 7229 0a20 2020 2020  r / x_var).     
+00000e50: 2020 2063 6f6d 706c 6578 6974 7920 3d20     complexity = 
+00000e60: 6e70 2e73 7172 7428 6464 785f 7661 7220  np.sqrt(ddx_var 
+00000e70: 2f20 6478 5f76 6172 2920 2f20 6d6f 6269  / dx_var) / mobi
+00000e80: 6c69 7479 0a20 2020 2020 2020 2061 6374  lity.        act
+00000e90: 6976 6974 7920 3d20 6e70 2e76 6172 2864  ivity = np.var(d
+00000ea0: 6174 6129 0a0a 2020 2020 2020 2020 7265  ata)..        re
+00000eb0: 7475 726e 2061 6374 6976 6974 792c 206d  turn activity, m
+00000ec0: 6f62 696c 6974 792c 2063 6f6d 706c 6578  obility, complex
+00000ed0: 6974 790a 0a20 2020 2040 7374 6174 6963  ity..    @static
+00000ee0: 6d65 7468 6f64 0a20 2020 2040 6e6a 6974  method.    @njit
+00000ef0: 2822 2866 6c6f 6174 3332 5b3a 5d2c 2066  ("(float32[:], f
+00000f00: 6c6f 6174 3634 5b3a 5d2c 2069 6e74 3634  loat64[:], int64
+00000f10: 2922 290a 2020 2020 6465 6620 736c 6964  )").    def slid
+00000f20: 696e 675f 686a 6f72 745f 7061 7261 6d65  ing_hjort_parame
+00000f30: 7465 7273 280a 2020 2020 2020 2020 6461  ters(.        da
+00000f40: 7461 3a20 6e70 2e6e 6461 7272 6179 2c20  ta: np.ndarray, 
+00000f50: 7769 6e64 6f77 5f73 697a 6573 3a20 6e70  window_sizes: np
+00000f60: 2e6e 6461 7272 6179 2c20 7361 6d70 6c65  .ndarray, sample
+00000f70: 5f72 6174 653a 2069 6e74 0a20 2020 2029  _rate: int.    )
+00000f80: 202d 3e20 6e70 2e6e 6461 7272 6179 3a0a   -> np.ndarray:.
+00000f90: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00000fa0: 2020 2020 4a69 7474 6564 2063 6f6d 7075      Jitted compu
+00000fb0: 7465 206f 6620 486a 6f72 7468 2070 6172  te of Hjorth par
+00000fc0: 616d 6574 6572 732c 2069 6e63 6c75 6469  ameters, includi
+00000fd0: 6e67 206d 6f62 696c 6974 792c 2063 6f6d  ng mobility, com
+00000fe0: 706c 6578 6974 792c 2061 6e64 2061 6374  plexity, and act
+00000ff0: 6976 6974 792c 2066 6f72 0a20 2020 2020  ivity, for.     
+00001000: 2020 2073 6c69 6469 6e67 2077 696e 646f     sliding windo
+00001010: 7773 206f 6620 7661 7279 696e 6720 7369  ws of varying si
+00001020: 7a65 7320 6170 706c 6965 6420 746f 2074  zes applied to t
+00001030: 6865 2069 6e70 7574 2064 6174 6120 6172  he input data ar
+00001040: 7261 792e 0a0a 2020 2020 2020 2020 3a70  ray...        :p
+00001050: 6172 616d 206e 702e 6e64 6172 7261 7920  aram np.ndarray 
+00001060: 6461 7461 3a20 496e 7075 7420 6461 7461  data: Input data
+00001070: 2061 7272 6179 2e0a 2020 2020 2020 2020   array..        
+00001080: 3a70 6172 616d 206e 702e 6e64 6172 7261  :param np.ndarra
+00001090: 7920 7769 6e64 6f77 5f73 697a 6573 3a20  y window_sizes: 
+000010a0: 4172 7261 7920 6f66 2077 696e 646f 7720  Array of window 
+000010b0: 7369 7a65 7320 2869 6e20 7365 636f 6e64  sizes (in second
+000010c0: 7329 2e0a 2020 2020 2020 2020 3a70 6172  s)..        :par
+000010d0: 616d 2069 6e74 2073 616d 706c 655f 7261  am int sample_ra
+000010e0: 7465 3a20 5361 6d70 6c69 6e67 2072 6174  te: Sampling rat
+000010f0: 6520 6f66 2074 6865 2064 6174 6120 696e  e of the data in
+00001100: 2073 616d 706c 6573 2070 6572 2073 6563   samples per sec
+00001110: 6f6e 642e 0a20 2020 2020 2020 203a 7265  ond..        :re
+00001120: 7475 726e 206e 702e 6e64 6172 7261 793a  turn np.ndarray:
+00001130: 2041 6e20 6172 7261 7920 636f 6e74 6169   An array contai
+00001140: 6e69 6e67 2048 6a6f 7274 6820 7061 7261  ning Hjorth para
+00001150: 6d65 7465 7273 2066 6f72 2065 6163 6820  meters for each 
+00001160: 7769 6e64 6f77 2073 697a 6520 616e 6420  window size and 
+00001170: 6461 7461 2070 6f69 6e74 2e0a 2020 2020  data point..    
+00001180: 2020 2020 2020 2020 2020 2020 2020 2054                 T
+00001190: 6865 2073 6861 7065 206f 6620 7468 6520  he shape of the 
+000011a0: 7265 7375 6c74 2061 7272 6179 2069 7320  result array is 
+000011b0: 2833 2c20 6461 7461 2e73 6861 7065 5b30  (3, data.shape[0
+000011c0: 5d2c 2077 696e 646f 775f 7369 7a65 732e  ], window_sizes.
+000011d0: 7368 6170 655b 305d 292e 0a20 2020 2020  shape[0])..     
+000011e0: 2020 2020 2020 2020 2020 2020 2020 5468                Th
+000011f0: 6520 7468 7265 6520 7061 7261 6d65 7465  e three paramete
+00001200: 7273 2061 7265 2073 746f 7265 6420 696e  rs are stored in
+00001210: 2074 6865 2066 6972 7374 2064 696d 656e   the first dimen
+00001220: 7369 6f6e 2028 3020 2d20 6d6f 6269 6c69  sion (0 - mobili
+00001230: 7479 2c20 3120 2d20 636f 6d70 6c65 7869  ty, 1 - complexi
+00001240: 7479 2c0a 2020 2020 2020 2020 2020 2020  ty,.            
+00001250: 2020 2020 2020 2032 202d 2061 6374 6976         2 - activ
+00001260: 6974 7929 2c20 616e 6420 7468 6520 7265  ity), and the re
+00001270: 6d61 696e 696e 6720 6469 6d65 6e73 696f  maining dimensio
+00001280: 6e73 2063 6f72 7265 7370 6f6e 6420 746f  ns correspond to
+00001290: 2064 6174 6120 706f 696e 7473 2061 6e64   data points and
+000012a0: 2077 696e 646f 7720 7369 7a65 732e 0a0a   window sizes...
+000012b0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000012c0: 2020 2020 7265 7375 6c74 7320 3d20 6e70      results = np
+000012d0: 2e66 756c 6c28 2833 2c20 6461 7461 2e73  .full((3, data.s
+000012e0: 6861 7065 5b30 5d2c 2077 696e 646f 775f  hape[0], window_
+000012f0: 7369 7a65 732e 7368 6170 655b 305d 292c  sizes.shape[0]),
+00001300: 202d 312e 3029 0a20 2020 2020 2020 2066   -1.0).        f
+00001310: 6f72 2069 2069 6e20 7261 6e67 6528 7769  or i in range(wi
+00001320: 6e64 6f77 5f73 697a 6573 2e73 6861 7065  ndow_sizes.shape
+00001330: 5b30 5d29 3a0a 2020 2020 2020 2020 2020  [0]):.          
+00001340: 2020 7769 6e64 6f77 5f73 697a 6520 3d20    window_size = 
+00001350: 696e 7428 7769 6e64 6f77 5f73 697a 6573  int(window_sizes
+00001360: 5b69 5d20 2a20 7361 6d70 6c65 5f72 6174  [i] * sample_rat
+00001370: 6529 0a20 2020 2020 2020 2020 2020 2066  e).            f
+00001380: 6f72 206c 2c20 7220 696e 207a 6970 280a  or l, r in zip(.
+00001390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000013a0: 7072 616e 6765 2830 2c20 6461 7461 2e73  prange(0, data.s
+000013b0: 6861 7065 5b30 5d20 2b20 3129 2c20 7072  hape[0] + 1), pr
+000013c0: 616e 6765 2877 696e 646f 775f 7369 7a65  ange(window_size
+000013d0: 2c20 6461 7461 2e73 6861 7065 5b30 5d20  , data.shape[0] 
+000013e0: 2b20 3129 0a20 2020 2020 2020 2020 2020  + 1).           
+000013f0: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
+00001400: 2020 2020 7361 6d70 6c65 203d 2064 6174      sample = dat
+00001410: 615b 6c3a 725d 0a20 2020 2020 2020 2020  a[l:r].         
+00001420: 2020 2020 2020 2064 7820 3d20 6e70 2e64         dx = np.d
+00001430: 6966 6628 6e70 2e61 7363 6f6e 7469 6775  iff(np.ascontigu
+00001440: 6f75 7361 7272 6179 2873 616d 706c 6529  ousarray(sample)
+00001450: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00001460: 2020 6464 7820 3d20 6e70 2e64 6966 6628    ddx = np.diff(
+00001470: 6e70 2e61 7363 6f6e 7469 6775 6f75 7361  np.ascontiguousa
+00001480: 7272 6179 2864 7829 290a 2020 2020 2020  rray(dx)).      
+00001490: 2020 2020 2020 2020 2020 785f 7661 722c            x_var,
+000014a0: 2064 785f 7661 7220 3d20 6e70 2e76 6172   dx_var = np.var
+000014b0: 2873 616d 706c 6529 2c20 6e70 2e76 6172  (sample), np.var
+000014c0: 2864 7829 0a20 2020 2020 2020 2020 2020  (dx).           
+000014d0: 2020 2020 2069 6620 2878 5f76 6172 203c       if (x_var <
+000014e0: 3d20 3029 206f 7220 2864 785f 7661 7220  = 0) or (dx_var 
+000014f0: 3c3d 2030 293a 0a20 2020 2020 2020 2020  <= 0):.         
+00001500: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+00001510: 7473 5b30 2c20 7220 2b20 312c 2069 5d20  ts[0, r + 1, i] 
+00001520: 3d20 300a 2020 2020 2020 2020 2020 2020  = 0.            
+00001530: 2020 2020 2020 2020 7265 7375 6c74 735b          results[
+00001540: 312c 2072 202b 2031 2c20 695d 203d 2030  1, r + 1, i] = 0
+00001550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001560: 2020 2020 2072 6573 756c 7473 5b32 2c20       results[2, 
+00001570: 7220 2b20 312c 2069 5d20 3d20 300a 2020  r + 1, i] = 0.  
+00001580: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00001590: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+000015a0: 2020 2020 2020 2020 6464 785f 7661 7220          ddx_var 
+000015b0: 3d20 6e70 2e76 6172 2864 6478 290a 2020  = np.var(ddx).  
+000015c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000015d0: 2020 6d6f 6269 6c69 7479 203d 206e 702e    mobility = np.
+000015e0: 7371 7274 2864 785f 7661 7220 2f20 785f  sqrt(dx_var / x_
+000015f0: 7661 7229 0a20 2020 2020 2020 2020 2020  var).           
+00001600: 2020 2020 2020 2020 2063 6f6d 706c 6578           complex
+00001610: 6974 7920 3d20 6e70 2e73 7172 7428 6464  ity = np.sqrt(dd
+00001620: 785f 7661 7220 2f20 6478 5f76 6172 2920  x_var / dx_var) 
+00001630: 2f20 6d6f 6269 6c69 7479 0a20 2020 2020  / mobility.     
+00001640: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00001650: 6374 6976 6974 7920 3d20 6e70 2e76 6172  ctivity = np.var
+00001660: 2873 616d 706c 6529 0a20 2020 2020 2020  (sample).       
+00001670: 2020 2020 2020 2020 2020 2020 2072 6573               res
+00001680: 756c 7473 5b30 2c20 7220 2b20 312c 2069  ults[0, r + 1, i
+00001690: 5d20 3d20 6d6f 6269 6c69 7479 0a20 2020  ] = mobility.   
+000016a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000016b0: 2072 6573 756c 7473 5b31 2c20 7220 2b20   results[1, r + 
+000016c0: 312c 2069 5d20 3d20 636f 6d70 6c65 7869  1, i] = complexi
+000016d0: 7479 0a20 2020 2020 2020 2020 2020 2020  ty.             
+000016e0: 2020 2020 2020 2072 6573 756c 7473 5b32         results[2
+000016f0: 2c20 7220 2b20 312c 2069 5d20 3d20 6163  , r + 1, i] = ac
+00001700: 7469 7669 7479 0a0a 2020 2020 2020 2020  tivity..        
+00001710: 7265 7475 726e 2072 6573 756c 7473 2e61  return results.a
+00001720: 7374 7970 6528 6e70 2e66 6c6f 6174 3332  stype(np.float32
+00001730: 290a 0a20 2020 2040 7374 6174 6963 6d65  )..    @staticme
+00001740: 7468 6f64 0a20 2020 2040 6e6a 6974 285b  thod.    @njit([
+00001750: 2866 6c6f 6174 3332 5b3a 5d2c 2062 6f6f  (float32[:], boo
+00001760: 6c65 616e 292c 2028 666c 6f61 7433 325b  lean), (float32[
+00001770: 3a5d 2c20 7479 7065 732e 6d69 7363 2e4f  :], types.misc.O
+00001780: 6d69 7474 6564 2854 7275 6529 295d 290a  mitted(True))]).
+00001790: 2020 2020 6465 6620 6c6f 6361 6c5f 6d61      def local_ma
+000017a0: 7869 6d61 5f6d 696e 696d 6128 6461 7461  xima_minima(data
+000017b0: 3a20 6e70 2e6e 6461 7272 6179 2c20 6d61  : np.ndarray, ma
+000017c0: 7869 6d61 3a20 626f 6f6c 203d 2054 7275  xima: bool = Tru
+000017d0: 6529 202d 3e20 6e70 2e6e 6461 7272 6179  e) -> np.ndarray
+000017e0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+000017f0: 2020 2020 2020 4a69 7474 6564 2063 6f6d        Jitted com
+00001800: 7075 7465 206f 6620 7468 6520 6c6f 6361  pute of the loca
+00001810: 6c20 6d61 7869 6d61 206f 7220 6d69 6e69  l maxima or mini
+00001820: 6d61 2064 6566 696e 6564 2061 7320 7661  ma defined as va
+00001830: 6c75 6573 2077 6869 6368 2061 7265 2068  lues which are h
+00001840: 6967 6865 7220 6f72 206c 6f77 6572 2074  igher or lower t
+00001850: 6861 6e20 696d 6d65 6469 6174 656c 7920  han immediately 
+00001860: 7072 6563 6564 696e 6720 616e 6420 7072  preceding and pr
+00001870: 6f63 6565 6469 6e67 2074 696d 652d 7365  oceeding time-se
+00001880: 7269 6573 206e 6569 6768 626f 7273 2c20  ries neighbors, 
+00001890: 7265 7065 6374 6976 656c 792e 0a20 2020  repectively..   
+000018a0: 2020 2020 2052 6574 7572 6e73 2032 4420       Returns 2D 
+000018b0: 6e70 2e6e 6461 7272 6179 2077 6974 6820  np.ndarray with 
+000018c0: 636f 6c75 6d6e 7320 7265 7072 6573 656e  columns represen
+000018d0: 7469 6e67 2069 6478 2061 6e64 2076 616c  ting idx and val
+000018e0: 7565 7320 6f66 206c 6f63 616c 206d 6178  ues of local max
+000018f0: 696d 612e 0a0a 2020 2020 2020 2020 3a70  ima...        :p
+00001900: 6172 616d 206e 702e 6e64 6172 7261 7920  aram np.ndarray 
+00001910: 6461 7461 3a20 5469 6d65 2d73 6572 6965  data: Time-serie
+00001920: 7320 6461 7461 2e0a 2020 2020 2020 2020  s data..        
+00001930: 3a70 6172 616d 2062 6f6f 6c20 6d61 7869  :param bool maxi
+00001940: 6d61 3a20 4966 2054 7275 652c 2072 6574  ma: If True, ret
+00001950: 7572 6e73 206d 6178 696d 612e 2045 6c73  urns maxima. Els
+00001960: 652c 206d 696e 696d 612e 0a20 2020 2020  e, minima..     
+00001970: 2020 203a 7265 7475 726e 206e 702e 6e64     :return np.nd
+00001980: 6172 7261 793a 2032 4420 6e70 2e6e 6461  array: 2D np.nda
+00001990: 7272 6179 2077 6974 6820 636f 6c75 6d6e  rray with column
+000019a0: 7320 7265 7072 6573 656e 7469 6e67 2069  s representing i
+000019b0: 6478 2069 6e20 696e 7075 7420 6461 7461  dx in input data
+000019c0: 2069 6e20 6669 7273 7420 636f 6c75 6d6e   in first column
+000019d0: 2061 6e64 2076 616c 7565 7320 6f66 206c   and values of l
+000019e0: 6f63 616c 206d 6178 696d 6120 696e 2073  ocal maxima in s
+000019f0: 6563 6f6e 6420 636f 6c75 6d6e 0a0a 2020  econd column..  
+00001a00: 2020 2020 2020 3a65 7861 6d70 6c65 3a0a        :example:.
+00001a10: 2020 2020 2020 2020 3e3e 3e20 6461 7461          >>> data
+00001a20: 203d 206e 702e 6172 7261 7928 5b33 2e39   = np.array([3.9
+00001a30: 2c20 372e 352c 2020 342e 322c 2036 2e32  , 7.5,  4.2, 6.2
+00001a40: 2c20 372e 352c 2033 2e39 2c20 362e 322c  , 7.5, 3.9, 6.2,
+00001a50: 2036 2e35 2c20 372e 322c 2039 2e35 5d29   6.5, 7.2, 9.5])
+00001a60: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
+00001a70: 3332 290a 2020 2020 2020 2020 3e3e 3e20  32).        >>> 
+00001a80: 5469 6d65 7365 7269 6573 4665 6174 7572  TimeseriesFeatur
+00001a90: 654d 6978 696e 2829 2e6c 6f63 616c 5f6d  eMixin().local_m
+00001aa0: 6178 696d 615f 6d69 6e69 6d61 2864 6174  axima_minima(dat
+00001ab0: 613d 6461 7461 2c20 6d61 7869 6d61 3d54  a=data, maxima=T
+00001ac0: 7275 6529 0a20 2020 2020 2020 203e 3e3e  rue).        >>>
+00001ad0: 205b 5b31 2c20 372e 355d 2c20 5b34 2c20   [[1, 7.5], [4, 
+00001ae0: 372e 355d 2c20 5b39 2c20 392e 355d 5d0a  7.5], [9, 9.5]].
+00001af0: 2020 2020 2020 2020 3e3e 3e20 5469 6d65          >>> Time
+00001b00: 7365 7269 6573 4665 6174 7572 654d 6978  seriesFeatureMix
+00001b10: 696e 2829 2e6c 6f63 616c 5f6d 6178 696d  in().local_maxim
+00001b20: 615f 6d69 6e69 6d61 2864 6174 613d 6461  a_minima(data=da
+00001b30: 7461 2c20 6d61 7869 6d61 3d46 616c 7365  ta, maxima=False
+00001b40: 290a 2020 2020 2020 2020 3e3e 3e20 5b5b  ).        >>> [[
+00001b50: 302c 2033 2e39 5d2c 205b 322c 2034 2e32  0, 3.9], [2, 4.2
+00001b60: 5d2c 205b 352c 2033 2e39 5d5d 0a0a 2020  ], [5, 3.9]]..  
+00001b70: 2020 2020 2020 2e2e 2069 6d61 6765 3a3a        .. image::
+00001b80: 205f 7374 6174 6963 2f69 6d67 2f6c 6f63   _static/img/loc
+00001b90: 616c 5f6d 6178 696d 615f 6d69 6e69 6d61  al_maxima_minima
+00001ba0: 2e70 6e67 0a20 2020 2020 2020 2020 2020  .png.           
+00001bb0: 3a77 6964 7468 3a20 3630 300a 2020 2020  :width: 600.    
+00001bc0: 2020 2020 2020 203a 616c 6967 6e3a 2063         :align: c
+00001bd0: 656e 7465 720a 0a20 2020 2020 2020 2022  enter..        "
+00001be0: 2222 0a20 2020 2020 2020 2069 6620 6e6f  "".        if no
+00001bf0: 7420 6d61 7869 6d61 3a0a 2020 2020 2020  t maxima:.      
+00001c00: 2020 2020 2020 6461 7461 203d 202d 6461        data = -da
+00001c10: 7461 0a20 2020 2020 2020 2072 6573 756c  ta.        resul
+00001c20: 7473 203d 206e 702e 6675 6c6c 2828 6461  ts = np.full((da
+00001c30: 7461 2e73 6861 7065 5b30 5d2c 2032 292c  ta.shape[0], 2),
+00001c40: 202d 312e 3029 0a20 2020 2020 2020 2069   -1.0).        i
+00001c50: 6620 6461 7461 5b30 5d20 3e3d 2064 6174  f data[0] >= dat
+00001c60: 615b 315d 3a0a 2020 2020 2020 2020 2020  a[1]:.          
+00001c70: 2020 6966 206e 6f74 206d 6178 696d 613a    if not maxima:
+00001c80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001c90: 2072 6573 756c 7473 5b30 2c20 3a5d 203d   results[0, :] =
+00001ca0: 206e 702e 6172 7261 7928 5b30 2c20 2d64   np.array([0, -d
+00001cb0: 6174 615b 305d 5d29 0a20 2020 2020 2020  ata[0]]).       
+00001cc0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00001cd0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+00001ce0: 7473 5b30 2c20 3a5d 203d 206e 702e 6172  ts[0, :] = np.ar
+00001cf0: 7261 7928 5b30 2c20 6461 7461 5b30 5d5d  ray([0, data[0]]
+00001d00: 290a 2020 2020 2020 2020 6966 2064 6174  ).        if dat
+00001d10: 615b 2d31 5d20 3e3d 2064 6174 615b 2d32  a[-1] >= data[-2
+00001d20: 5d3a 0a20 2020 2020 2020 2020 2020 2069  ]:.            i
+00001d30: 6620 6e6f 7420 6d61 7869 6d61 3a0a 2020  f not maxima:.  
+00001d40: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00001d50: 7375 6c74 735b 2d31 2c20 3a5d 203d 206e  sults[-1, :] = n
+00001d60: 702e 6172 7261 7928 5b64 6174 612e 7368  p.array([data.sh
+00001d70: 6170 655b 305d 202d 2031 2c20 2d64 6174  ape[0] - 1, -dat
+00001d80: 615b 2d31 5d5d 290a 2020 2020 2020 2020  a[-1]]).        
+00001d90: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00001da0: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+00001db0: 735b 2d31 2c20 3a5d 203d 206e 702e 6172  s[-1, :] = np.ar
+00001dc0: 7261 7928 5b64 6174 612e 7368 6170 655b  ray([data.shape[
+00001dd0: 305d 202d 2031 2c20 6461 7461 5b2d 315d  0] - 1, data[-1]
+00001de0: 5d29 0a20 2020 2020 2020 2066 6f72 2069  ]).        for i
+00001df0: 2069 6e20 7072 616e 6765 2831 2c20 6461   in prange(1, da
+00001e00: 7461 2e73 6861 7065 5b30 5d20 2d20 3129  ta.shape[0] - 1)
+00001e10: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00001e20: 2064 6174 615b 6920 2d20 315d 203c 2064   data[i - 1] < d
+00001e30: 6174 615b 695d 203e 2064 6174 615b 6920  ata[i] > data[i 
+00001e40: 2b20 315d 3a0a 2020 2020 2020 2020 2020  + 1]:.          
+00001e50: 2020 2020 2020 6966 206e 6f74 206d 6178        if not max
+00001e60: 696d 613a 0a20 2020 2020 2020 2020 2020  ima:.           
+00001e70: 2020 2020 2020 2020 2072 6573 756c 7473           results
+00001e80: 5b69 2c20 3a5d 203d 206e 702e 6172 7261  [i, :] = np.arra
+00001e90: 7928 5b69 2c20 2d64 6174 615b 695d 5d29  y([i, -data[i]])
+00001ea0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001eb0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00001ec0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+00001ed0: 7473 5b69 2c20 3a5d 203d 206e 702e 6172  ts[i, :] = np.ar
+00001ee0: 7261 7928 5b69 2c20 6461 7461 5b69 5d5d  ray([i, data[i]]
+00001ef0: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+00001f00: 6e20 7265 7375 6c74 735b 6e70 2e61 7267  n results[np.arg
+00001f10: 7768 6572 6528 7265 7375 6c74 735b 3a2c  where(results[:,
+00001f20: 2030 5d2e 5420 213d 202d 3129 2e66 6c61   0].T != -1).fla
+00001f30: 7474 656e 2829 5d2e 6173 7479 7065 286e  tten()].astype(n
+00001f40: 702e 666c 6f61 7433 3229 0a0a 2020 2020  p.float32)..    
+00001f50: 4073 7461 7469 636d 6574 686f 640a 2020  @staticmethod.  
+00001f60: 2020 406e 6a69 7428 2228 666c 6f61 7433    @njit("(float3
+00001f70: 325b 3a5d 2c20 666c 6f61 7436 3429 2229  2[:], float64)")
+00001f80: 0a20 2020 2064 6566 2063 726f 7373 696e  .    def crossin
+00001f90: 6773 2864 6174 613a 206e 702e 6e64 6172  gs(data: np.ndar
+00001fa0: 7261 792c 2076 616c 3a20 666c 6f61 7429  ray, val: float)
+00001fb0: 202d 3e20 696e 743a 0a20 2020 2020 2020   -> int:.       
+00001fc0: 2022 2222 0a20 2020 2020 2020 204a 6974   """.        Jit
+00001fd0: 7465 6420 636f 6d70 7574 6520 6f66 2074  ted compute of t
+00001fe0: 6865 2063 6f75 6e74 2069 6e20 7469 6d65  he count in time
+00001ff0: 2d73 6572 6965 7320 7768 6572 6520 7365  -series where se
+00002000: 7175 656e 7469 616c 2076 616c 7565 7320  quential values 
+00002010: 6372 6f73 7365 7320 6120 6465 6669 6e65  crosses a define
+00002020: 6420 7661 6c75 652e 0a0a 0a20 2020 2020  d value....     
+00002030: 2020 202e 2e20 696d 6167 653a 3a20 5f73     .. image:: _s
+00002040: 7461 7469 632f 696d 672f 6372 6f73 7369  tatic/img/crossi
+00002050: 6e67 732e 706e 670a 2020 2020 2020 2020  ngs.png.        
+00002060: 2020 203a 7769 6474 683a 2036 3030 0a20     :width: 600. 
+00002070: 2020 2020 2020 2020 2020 3a61 6c69 676e            :align
+00002080: 3a20 6365 6e74 6572 0a0a 2020 2020 2020  : center..      
+00002090: 2020 3a70 6172 616d 206e 702e 6e64 6172    :param np.ndar
+000020a0: 7261 7920 6461 7461 3a20 5469 6d65 2d73  ray data: Time-s
+000020b0: 6572 6965 7320 6461 7461 2e0a 2020 2020  eries data..    
+000020c0: 2020 2020 3a70 6172 616d 2066 6c6f 6174      :param float
+000020d0: 2076 616c 3a20 4372 6f73 7320 7661 6c75   val: Cross valu
+000020e0: 652e 2045 2e67 2e2c 2074 6f20 636f 756e  e. E.g., to coun
+000020f0: 7420 7468 6520 6e75 6d62 6572 206f 6620  t the number of 
+00002100: 7a65 726f 2d63 726f 7373 696e 6773 2c20  zero-crossings, 
+00002110: 7061 7373 2060 3060 2e0a 2020 2020 2020  pass `0`..      
+00002120: 2020 3a72 6574 7572 6e20 696e 743a 2043    :return int: C
+00002130: 6f75 6e74 206f 6620 6576 656e 7473 2077  ount of events w
+00002140: 6865 7265 2073 6571 7565 6e74 6961 6c20  here sequential 
+00002150: 7661 6c75 6573 2063 726f 7373 6573 2060  values crosses `
+00002160: 6076 616c 6060 2e0a 0a20 2020 2020 2020  `val``...       
+00002170: 203a 6578 616d 706c 653a 0a20 2020 2020   :example:.     
+00002180: 2020 203e 3e3e 2064 6174 6120 3d20 6e70     >>> data = np
+00002190: 2e61 7272 6179 285b 332e 392c 2037 2e35  .array([3.9, 7.5
+000021a0: 2c20 2034 2e32 2c20 362e 322c 2037 2e35  ,  4.2, 6.2, 7.5
+000021b0: 2c20 332e 392c 2036 2e32 2c20 362e 352c  , 3.9, 6.2, 6.5,
+000021c0: 2037 2e32 2c20 392e 355d 292e 6173 7479   7.2, 9.5]).asty
+000021d0: 7065 286e 702e 666c 6f61 7433 3229 0a20  pe(np.float32). 
+000021e0: 2020 2020 2020 203e 3e3e 2054 696d 6573         >>> Times
+000021f0: 6572 6965 7346 6561 7475 7265 4d69 7869  eriesFeatureMixi
+00002200: 6e28 292e 6372 6f73 7369 6e67 7328 6461  n().crossings(da
+00002210: 7461 3d64 6174 612c 2076 616c 3d37 290a  ta=data, val=7).
+00002220: 2020 2020 2020 2020 3e3e 3e20 350a 2020          >>> 5.  
+00002230: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+00002240: 2020 2063 6e74 2c20 6c61 7374 5f76 616c     cnt, last_val
+00002250: 203d 2030 2c20 2d31 0a20 2020 2020 2020   = 0, -1.       
+00002260: 2069 6620 6461 7461 5b30 5d20 3e20 7661   if data[0] > va
+00002270: 6c3a 0a20 2020 2020 2020 2020 2020 206c  l:.            l
+00002280: 6173 745f 7661 6c20 3d20 310a 2020 2020  ast_val = 1.    
+00002290: 2020 2020 666f 7220 6920 696e 2070 7261      for i in pra
+000022a0: 6e67 6528 312c 2064 6174 612e 7368 6170  nge(1, data.shap
+000022b0: 655b 305d 293a 0a20 2020 2020 2020 2020  e[0]):.         
+000022c0: 2020 2063 7572 7265 6e74 5f76 616c 203d     current_val =
+000022d0: 202d 310a 2020 2020 2020 2020 2020 2020   -1.            
+000022e0: 6966 2064 6174 615b 695d 203e 2076 616c  if data[i] > val
+000022f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00002300: 2020 6375 7272 656e 745f 7661 6c20 3d20    current_val = 
+00002310: 310a 2020 2020 2020 2020 2020 2020 6966  1.            if
+00002320: 206c 6173 745f 7661 6c20 213d 2063 7572   last_val != cur
+00002330: 7265 6e74 5f76 616c 3a0a 2020 2020 2020  rent_val:.      
+00002340: 2020 2020 2020 2020 2020 636e 7420 2b3d            cnt +=
+00002350: 2031 0a20 2020 2020 2020 2020 2020 206c   1.            l
+00002360: 6173 745f 7661 6c20 3d20 6375 7272 656e  ast_val = curren
+00002370: 745f 7661 6c0a 0a20 2020 2020 2020 2072  t_val..        r
+00002380: 6574 7572 6e20 636e 740a 0a20 2020 2040  eturn cnt..    @
+00002390: 7374 6174 6963 6d65 7468 6f64 0a20 2020  staticmethod.   
+000023a0: 2040 6e6a 6974 2822 2866 6c6f 6174 3332   @njit("(float32
+000023b0: 5b3a 5d2c 2066 6c6f 6174 3634 2c20 2066  [:], float64,  f
+000023c0: 6c6f 6174 3634 5b3a 5d2c 2069 6e74 3634  loat64[:], int64
+000023d0: 2c29 2229 0a20 2020 2064 6566 2073 6c69  ,)").    def sli
+000023e0: 6469 6e67 5f63 726f 7373 696e 6773 280a  ding_crossings(.
+000023f0: 2020 2020 2020 2020 6461 7461 3a20 6e70          data: np
+00002400: 2e6e 6461 7272 6179 2c20 7661 6c3a 2066  .ndarray, val: f
+00002410: 6c6f 6174 2c20 7469 6d65 5f77 696e 646f  loat, time_windo
+00002420: 7773 3a20 6e70 2e6e 6461 7272 6179 2c20  ws: np.ndarray, 
+00002430: 6670 733a 2069 6e74 0a20 2020 2029 202d  fps: int.    ) -
+00002440: 3e20 6e70 2e6e 6461 7272 6179 3a0a 2020  > np.ndarray:.  
+00002450: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00002460: 2020 436f 6d70 7574 6520 7468 6520 6e75    Compute the nu
+00002470: 6d62 6572 206f 6620 6372 6f73 7369 6e67  mber of crossing
+00002480: 7320 6f76 6572 2073 6c69 6469 6e67 2077  s over sliding w
+00002490: 696e 646f 7773 2069 6e20 6120 6461 7461  indows in a data
+000024a0: 2061 7272 6179 2e0a 0a20 2020 2020 2020   array...       
+000024b0: 2043 6f6d 7075 7465 7320 7468 6520 6e75   Computes the nu
+000024c0: 6d62 6572 206f 6620 7469 6d65 7320 6120  mber of times a 
+000024d0: 7661 6c75 6520 696e 2074 6865 2064 6174  value in the dat
+000024e0: 6120 6172 7261 7920 6372 6f73 7365 7320  a array crosses 
+000024f0: 6120 6769 7665 6e20 7468 7265 7368 6f6c  a given threshol
+00002500: 640a 2020 2020 2020 2020 7661 6c75 6520  d.        value 
+00002510: 7769 7468 696e 2073 6c69 6469 6e67 2077  within sliding w
+00002520: 696e 646f 7773 206f 6620 7661 7279 696e  indows of varyin
+00002530: 6720 7369 7a65 732e 2054 6865 206e 756d  g sizes. The num
+00002540: 6265 7220 6f66 2063 726f 7373 696e 6773  ber of crossings
+00002550: 2069 7320 636f 6d70 7574 6564 2066 6f72   is computed for
+00002560: 2065 6163 680a 2020 2020 2020 2020 7769   each.        wi
+00002570: 6e64 6f77 2073 697a 6520 616e 6420 7374  ndow size and st
+00002580: 6f72 6564 2069 6e20 7468 6520 7265 7375  ored in the resu
+00002590: 6c74 2061 7272 6179 2077 6865 7265 2063  lt array where c
+000025a0: 6f6c 756d 6e73 2072 6570 7265 7365 6e74  olumns represent
+000025b0: 7320 7469 6d65 2077 696e 646f 7773 2e0a  s time windows..
+000025c0: 0a20 2020 2020 2020 202e 2e20 6e6f 7465  .        .. note
+000025d0: 3a3a 0a20 2020 2020 2020 2020 2020 466f  ::.           Fo
+000025e0: 7220 6672 616d 6573 206f 6363 7572 7269  r frames occurri
+000025f0: 6e67 2062 6566 6f72 6520 6120 636f 6d70  ng before a comp
+00002600: 6c65 7465 2074 696d 6520 7769 6e64 6f77  lete time window
+00002610: 2c20 2d31 2e30 2069 7320 7265 7475 726e  , -1.0 is return
+00002620: 6564 2e0a 0a20 2020 2020 2020 202e 2e20  ed...        .. 
+00002630: 696d 6167 653a 3a20 5f73 7461 7469 632f  image:: _static/
+00002640: 696d 672f 736c 6964 696e 675f 6372 6f73  img/sliding_cros
+00002650: 7369 6e67 732e 706e 670a 2020 2020 2020  sings.png.      
+00002660: 2020 2020 203a 7769 6474 683a 2031 3530       :width: 150
+00002670: 300a 2020 2020 2020 2020 2020 203a 616c  0.           :al
+00002680: 6967 6e3a 2063 656e 7465 720a 0a20 2020  ign: center..   
+00002690: 2020 2020 203a 7061 7261 6d20 6e70 2e6e       :param np.n
+000026a0: 6461 7272 6179 2064 6174 613a 2049 6e70  darray data: Inp
+000026b0: 7574 2064 6174 6120 6172 7261 792e 0a20  ut data array.. 
+000026c0: 2020 2020 2020 203a 7061 7261 6d20 666c         :param fl
+000026d0: 6f61 7420 7661 6c3a 2054 6872 6573 686f  oat val: Thresho
+000026e0: 6c64 2076 616c 7565 2066 6f72 2063 726f  ld value for cro
+000026f0: 7373 696e 6773 2e0a 2020 2020 2020 2020  ssings..        
+00002700: 3a70 6172 616d 206e 702e 6e64 6172 7261  :param np.ndarra
+00002710: 7920 7469 6d65 5f77 696e 646f 7773 3a20  y time_windows: 
+00002720: 4172 7261 7920 6f66 2077 696e 646f 7720  Array of window 
+00002730: 7369 7a65 7320 2869 6e20 7365 636f 6e64  sizes (in second
+00002740: 7329 2e0a 2020 2020 2020 2020 3a70 6172  s)..        :par
+00002750: 616d 2069 6e74 2073 616d 706c 655f 7261  am int sample_ra
+00002760: 7465 3a20 5361 6d70 6c69 6e67 2072 6174  te: Sampling rat
+00002770: 6520 6f66 2074 6865 2064 6174 6120 696e  e of the data in
+00002780: 2073 616d 706c 6573 2070 6572 2073 6563   samples per sec
+00002790: 6f6e 642e 0a20 2020 2020 2020 203a 7265  ond..        :re
+000027a0: 7475 726e 206e 702e 6e64 6172 7261 793a  turn np.ndarray:
+000027b0: 2041 6e20 6172 7261 7920 636f 6e74 6169   An array contai
+000027c0: 6e69 6e67 2074 6865 206e 756d 6265 7220  ning the number 
+000027d0: 6f66 2063 726f 7373 696e 6773 2066 6f72  of crossings for
+000027e0: 2065 6163 6820 7769 6e64 6f77 2073 697a   each window siz
+000027f0: 6520 616e 6420 6461 7461 2070 6f69 6e74  e and data point
+00002800: 2e20 5468 6520 7368 6170 6520 6f66 2074  . The shape of t
+00002810: 6865 2072 6573 756c 7420 6172 7261 7920  he result array 
+00002820: 6973 2028 6461 7461 2e73 6861 7065 5b30  is (data.shape[0
+00002830: 5d2c 2077 696e 646f 775f 7369 7a65 732e  ], window_sizes.
+00002840: 7368 6170 655b 305d 292e 0a0a 2020 2020  shape[0])...    
+00002850: 2020 2020 3a65 7861 6d70 6c65 3a0a 2020      :example:.  
+00002860: 2020 2020 2020 3e3e 3e20 6461 7461 203d        >>> data =
+00002870: 206e 702e 6172 7261 7928 5b33 2e39 2c20   np.array([3.9, 
+00002880: 372e 352c 2020 342e 322c 2036 2e32 2c20  7.5,  4.2, 6.2, 
+00002890: 372e 352c 2033 2e39 2c20 362e 322c 2036  7.5, 3.9, 6.2, 6
+000028a0: 2e35 2c20 372e 322c 2039 2e35 5d29 2e61  .5, 7.2, 9.5]).a
+000028b0: 7374 7970 6528 6e70 2e66 6c6f 6174 3332  stype(np.float32
+000028c0: 290a 2020 2020 2020 2020 3e3e 3e20 7265  ).        >>> re
+000028d0: 7375 6c74 7320 3d20 5469 6d65 7365 7269  sults = Timeseri
+000028e0: 6573 4665 6174 7572 654d 6978 696e 2829  esFeatureMixin()
+000028f0: 2e73 6c69 6469 6e67 5f63 726f 7373 696e  .sliding_crossin
+00002900: 6773 2864 6174 613d 6461 7461 2c20 7469  gs(data=data, ti
+00002910: 6d65 5f77 696e 646f 7773 3d6e 702e 6172  me_windows=np.ar
+00002920: 7261 7928 5b31 2e30 5d29 2c20 6670 733d  ray([1.0]), fps=
+00002930: 322e 302c 2076 616c 3d37 2e30 290a 2020  2.0, val=7.0).  
+00002940: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+00002950: 2020 2072 6573 756c 7473 203d 206e 702e     results = np.
+00002960: 6675 6c6c 2828 6461 7461 2e73 6861 7065  full((data.shape
+00002970: 5b30 5d2c 2074 696d 655f 7769 6e64 6f77  [0], time_window
+00002980: 732e 7368 6170 655b 305d 292c 202d 312e  s.shape[0]), -1.
+00002990: 3029 0a20 2020 2020 2020 2066 6f72 2069  0).        for i
+000029a0: 2069 6e20 7072 616e 6765 2874 696d 655f   in prange(time_
+000029b0: 7769 6e64 6f77 732e 7368 6170 655b 305d  windows.shape[0]
+000029c0: 293a 0a20 2020 2020 2020 2020 2020 2077  ):.            w
+000029d0: 696e 646f 775f 7369 7a65 203d 2069 6e74  indow_size = int
+000029e0: 2874 696d 655f 7769 6e64 6f77 735b 695d  (time_windows[i]
+000029f0: 202a 2066 7073 290a 2020 2020 2020 2020   * fps).        
+00002a00: 2020 2020 666f 7220 6c2c 2072 2069 6e20      for l, r in 
+00002a10: 7a69 7028 0a20 2020 2020 2020 2020 2020  zip(.           
+00002a20: 2020 2020 2070 7261 6e67 6528 302c 2064       prange(0, d
+00002a30: 6174 612e 7368 6170 655b 305d 202b 2031  ata.shape[0] + 1
+00002a40: 292c 2070 7261 6e67 6528 7769 6e64 6f77  ), prange(window
+00002a50: 5f73 697a 652c 2064 6174 612e 7368 6170  _size, data.shap
+00002a60: 655b 305d 202b 2031 290a 2020 2020 2020  e[0] + 1).      
+00002a70: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+00002a80: 2020 2020 2020 2020 2073 616d 706c 6520           sample 
+00002a90: 3d20 6461 7461 5b6c 3a72 5d0a 2020 2020  = data[l:r].    
+00002aa0: 2020 2020 2020 2020 2020 2020 636e 742c              cnt,
+00002ab0: 206c 6173 745f 7661 6c20 3d20 302c 202d   last_val = 0, -
+00002ac0: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
+00002ad0: 2020 6966 2073 616d 706c 655b 305d 203e    if sample[0] >
+00002ae0: 2076 616c 3a0a 2020 2020 2020 2020 2020   val:.          
+00002af0: 2020 2020 2020 2020 2020 6c61 7374 5f76            last_v
+00002b00: 616c 203d 2031 0a20 2020 2020 2020 2020  al = 1.         
+00002b10: 2020 2020 2020 2066 6f72 206a 2069 6e20         for j in 
+00002b20: 7072 616e 6765 2831 2c20 7361 6d70 6c65  prange(1, sample
+00002b30: 2e73 6861 7065 5b30 5d29 3a0a 2020 2020  .shape[0]):.    
+00002b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002b50: 6375 7272 656e 745f 7661 6c20 3d20 2d31  current_val = -1
+00002b60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002b70: 2020 2020 2069 6620 7361 6d70 6c65 5b6a       if sample[j
+00002b80: 5d20 3e20 7661 6c3a 0a20 2020 2020 2020  ] > val:.       
+00002b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002ba0: 2063 7572 7265 6e74 5f76 616c 203d 2031   current_val = 1
+00002bb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002bc0: 2020 2020 2069 6620 6c61 7374 5f76 616c       if last_val
+00002bd0: 2021 3d20 6375 7272 656e 745f 7661 6c3a   != current_val:
+00002be0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002bf0: 2020 2020 2020 2020 2063 6e74 202b 3d20           cnt += 
+00002c00: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
+00002c10: 2020 2020 2020 6c61 7374 5f76 616c 203d        last_val =
+00002c20: 2063 7572 7265 6e74 5f76 616c 0a20 2020   current_val.   
+00002c30: 2020 2020 2020 2020 2020 2020 2072 6573               res
+00002c40: 756c 7473 5b72 202d 2031 2c20 695d 203d  ults[r - 1, i] =
+00002c50: 2063 6e74 0a0a 2020 2020 2020 2020 7265   cnt..        re
+00002c60: 7475 726e 2072 6573 756c 7473 2e61 7374  turn results.ast
+00002c70: 7970 6528 6e70 2e69 6e74 3332 290a 0a20  ype(np.int32).. 
+00002c80: 2020 2040 7374 6174 6963 6d65 7468 6f64     @staticmethod
+00002c90: 0a20 2020 2040 6e6a 6974 2822 2866 6c6f  .    @njit("(flo
+00002ca0: 6174 3332 5b3a 5d2c 2069 6e74 3634 2c20  at32[:], int64, 
+00002cb0: 696e 7436 342c 2029 222c 2063 6163 6865  int64, )", cache
+00002cc0: 3d54 7275 652c 2066 6173 746d 6174 683d  =True, fastmath=
+00002cd0: 5472 7565 290a 2020 2020 6465 6620 7065  True).    def pe
+00002ce0: 7263 656e 7469 6c65 5f64 6966 6665 7265  rcentile_differe
+00002cf0: 6e63 6528 0a20 2020 2020 2020 2064 6174  nce(.        dat
+00002d00: 613a 206e 702e 6e64 6172 7261 792c 2075  a: np.ndarray, u
+00002d10: 7070 6572 5f70 6374 3a20 696e 742c 206c  pper_pct: int, l
+00002d20: 6f77 6572 5f70 6374 3a20 696e 740a 2020  ower_pct: int.  
+00002d30: 2020 2920 2d3e 2066 6c6f 6174 3a0a 2020    ) -> float:.  
+00002d40: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00002d50: 2020 4a69 7474 6564 2063 6f6d 7075 7465    Jitted compute
+00002d60: 206f 6620 7468 6520 6469 6666 6572 656e   of the differen
+00002d70: 6365 2062 6574 7765 656e 2074 6865 2060  ce between the `
+00002d80: 6075 7070 6572 6060 2061 6e64 2060 606c  `upper`` and ``l
+00002d90: 6f77 6572 6060 2070 6572 6365 6e74 696c  ower`` percentil
+00002da0: 6573 206f 6620 7468 6520 6461 7461 2061  es of the data a
+00002db0: 730a 2020 2020 2020 2020 6120 7065 7263  s.        a perc
+00002dc0: 656e 7461 6765 206f 6620 7468 6520 6d65  entage of the me
+00002dd0: 6469 616e 2076 616c 7565 2e20 4865 6c70  dian value. Help
+00002de0: 7320 756e 6465 7273 7461 6e64 696e 6720  s understanding 
+00002df0: 7468 6520 7370 7265 6164 206f 7220 7661  the spread or va
+00002e00: 7269 6162 696c 6974 7920 6f66 2074 6865  riability of the
+00002e10: 2064 6174 6120 7769 7468 696e 2073 7065   data within spe
+00002e20: 6369 6669 6564 2070 6572 6365 6e74 696c  cified percentil
+00002e30: 6573 2e0a 0a20 2020 2020 2020 202e 2e20  es...        .. 
+00002e40: 6e6f 7465 3a3a 0a20 2020 2020 2020 2020  note::.         
+00002e50: 2020 4164 6170 7465 6420 6672 6f6d 2060    Adapted from `
+00002e60: 6365 7369 756d 203c 6874 7470 733a 2f2f  cesium <https://
+00002e70: 6769 7468 7562 2e63 6f6d 2f63 6573 6975  github.com/cesiu
+00002e80: 6d2d 6d6c 2f63 6573 6975 6d3e 605f 2e0a  m-ml/cesium>`_..
+00002e90: 0a20 2020 2020 2020 202e 2e20 696d 6167  .        .. imag
+00002ea0: 653a 3a20 5f73 7461 7469 632f 696d 672f  e:: _static/img/
+00002eb0: 7065 7263 656e 7469 6c65 5f64 6966 6665  percentile_diffe
+00002ec0: 7265 6e63 652e 706e 670a 2020 2020 2020  rence.png.      
+00002ed0: 2020 2020 203a 7769 6474 683a 2036 3030       :width: 600
+00002ee0: 0a20 2020 2020 2020 2020 2020 3a61 6c69  .           :ali
+00002ef0: 676e 3a20 6365 6e74 6572 0a0a 2020 2020  gn: center..    
+00002f00: 2020 2020 3a70 6172 616d 6574 6572 206e      :parameter n
+00002f10: 702e 6e64 6172 7261 7920 6461 7461 3a20  p.ndarray data: 
+00002f20: 3144 2061 7272 6179 206f 6620 7265 7072  1D array of repr
+00002f30: 6573 656e 7469 6e67 2074 696d 652d 7365  esenting time-se
+00002f40: 7269 6573 2e0a 2020 2020 2020 2020 3a70  ries..        :p
+00002f50: 6172 616d 6574 6572 2069 6e74 2075 7070  arameter int upp
+00002f60: 6572 5f70 6374 3a20 5570 7065 722d 626f  er_pct: Upper-bo
+00002f70: 756e 6461 7279 2070 6572 6365 6e74 696c  undary percentil
+00002f80: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
+00002f90: 6d65 7465 7220 696e 7420 6c6f 7765 725f  meter int lower_
+00002fa0: 7063 743a 204c 6f77 6572 2d62 6f75 6e64  pct: Lower-bound
+00002fb0: 6172 7920 7065 7263 656e 7469 6c65 2e0a  ary percentile..
+00002fc0: 2020 2020 2020 2020 3a72 6574 7572 6e73          :returns
+00002fd0: 2066 6c6f 6174 3a20 5468 6520 6469 6666   float: The diff
+00002fe0: 6572 656e 6365 2062 6574 7765 656e 2074  erence between t
+00002ff0: 6865 2060 6075 7070 6572 6060 2061 6e64  he ``upper`` and
+00003000: 2060 606c 6f77 6572 6060 2070 6572 6365   ``lower`` perce
+00003010: 6e74 696c 6573 206f 6620 7468 6520 6461  ntiles of the da
+00003020: 7461 2061 7320 6120 7065 7263 656e 7461  ta as a percenta
+00003030: 6765 206f 6620 7468 6520 6d65 6469 616e  ge of the median
+00003040: 2076 616c 7565 2e0a 0a20 2020 2020 2020   value...       
+00003050: 203a 6578 616d 706c 6573 3a0a 2020 2020   :examples:.    
+00003060: 2020 2020 3e3e 3e20 6461 7461 203d 206e      >>> data = n
+00003070: 702e 6172 7261 7928 5b33 2e39 2c20 372e  p.array([3.9, 7.
+00003080: 352c 2020 342e 322c 2036 2e32 2c20 372e  5,  4.2, 6.2, 7.
+00003090: 352c 2033 2e39 2c20 362e 322c 2036 2e35  5, 3.9, 6.2, 6.5
+000030a0: 2c20 372e 322c 2039 2e35 5d29 2e61 7374  , 7.2, 9.5]).ast
+000030b0: 7970 6528 6e70 2e66 6c6f 6174 3332 290a  ype(np.float32).
+000030c0: 2020 2020 2020 2020 3e3e 3e20 5469 6d65          >>> Time
+000030d0: 7365 7269 6573 4665 6174 7572 654d 6978  seriesFeatureMix
+000030e0: 696e 2829 2e70 6572 6365 6e74 696c 655f  in().percentile_
+000030f0: 6469 6666 6572 656e 6365 2864 6174 613d  difference(data=
+00003100: 6461 7461 2c20 7570 7065 725f 7063 743d  data, upper_pct=
+00003110: 3935 2c20 6c6f 7765 725f 7063 743d 3529  95, lower_pct=5)
+00003120: 0a20 2020 2020 2020 203e 3e3e 2030 2e37  .        >>> 0.7
+00003130: 3430 3135 3734 3736 3431 3235 3137 370a  401574764125177.
+00003140: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00003150: 2020 2020 2075 7070 6572 5f76 616c 2c20       upper_val, 
+00003160: 6c6f 7765 725f 7661 6c20 3d20 6e70 2e70  lower_val = np.p
+00003170: 6572 6365 6e74 696c 6528 6461 7461 2c20  ercentile(data, 
+00003180: 7570 7065 725f 7063 7429 2c20 6e70 2e70  upper_pct), np.p
+00003190: 6572 6365 6e74 696c 6528 0a20 2020 2020  ercentile(.     
+000031a0: 2020 2020 2020 2064 6174 612c 206c 6f77         data, low
+000031b0: 6572 5f70 6374 0a20 2020 2020 2020 2029  er_pct.        )
+000031c0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000031d0: 6e70 2e61 6273 2875 7070 6572 5f76 616c  np.abs(upper_val
+000031e0: 202d 206c 6f77 6572 5f76 616c 2920 2f20   - lower_val) / 
+000031f0: 6e70 2e6d 6564 6961 6e28 6461 7461 290a  np.median(data).
+00003200: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
+00003210: 6f64 0a20 2020 2040 6e6a 6974 2822 2866  od.    @njit("(f
+00003220: 6c6f 6174 3332 5b3a 5d2c 2069 6e74 3634  loat32[:], int64
+00003230: 2c20 696e 7436 342c 2066 6c6f 6174 3634  , int64, float64
+00003240: 5b3a 5d2c 2069 6e74 3634 2c20 2922 2c20  [:], int64, )", 
+00003250: 6361 6368 653d 5472 7565 2c20 6661 7374  cache=True, fast
+00003260: 6d61 7468 3d54 7275 6529 0a20 2020 2064  math=True).    d
+00003270: 6566 2073 6c69 6469 6e67 5f70 6572 6365  ef sliding_perce
+00003280: 6e74 696c 655f 6469 6666 6572 656e 6365  ntile_difference
+00003290: 280a 2020 2020 2020 2020 6461 7461 3a20  (.        data: 
+000032a0: 6e70 2e6e 6461 7272 6179 2c0a 2020 2020  np.ndarray,.    
+000032b0: 2020 2020 7570 7065 725f 7063 743a 2069      upper_pct: i
+000032c0: 6e74 2c0a 2020 2020 2020 2020 6c6f 7765  nt,.        lowe
+000032d0: 725f 7063 743a 2069 6e74 2c0a 2020 2020  r_pct: int,.    
+000032e0: 2020 2020 7769 6e64 6f77 5f73 697a 6573      window_sizes
+000032f0: 3a20 6e70 2e6e 6461 7272 6179 2c0a 2020  : np.ndarray,.  
+00003300: 2020 2020 2020 6670 733a 2069 6e74 2c0a        fps: int,.
+00003310: 2020 2020 2920 2d3e 206e 702e 6e64 6172      ) -> np.ndar
+00003320: 7261 793a 0a20 2020 2020 2020 2022 2222  ray:.        """
+00003330: 0a20 2020 2020 2020 204a 6974 7465 6420  .        Jitted 
+00003340: 636f 6d70 7574 6573 2074 6865 2064 6966  computes the dif
+00003350: 6665 7265 6e63 6520 6265 7477 6565 6e20  ference between 
+00003360: 7468 6520 7570 7065 7220 616e 6420 6c6f  the upper and lo
+00003370: 7765 7220 7065 7263 656e 7469 6c65 7320  wer percentiles 
+00003380: 7769 7468 696e 2061 2073 6c69 6469 6e67  within a sliding
+00003390: 2077 696e 646f 7720 666f 7220 6561 6368   window for each
+000033a0: 2070 6f73 6974 696f 6e0a 2020 2020 2020   position.      
+000033b0: 2020 696e 2074 6865 2074 696d 6520 7365    in the time se
+000033c0: 7269 6573 2075 7369 6e67 2076 6172 696f  ries using vario
+000033d0: 7573 2077 696e 646f 7720 7369 7a65 732e  us window sizes.
+000033e0: 2049 7420 7265 7475 726e 7320 6120 3244   It returns a 2D
+000033f0: 2061 7272 6179 2077 6865 7265 2065 6163   array where eac
+00003400: 6820 726f 7720 636f 7272 6573 706f 6e64  h row correspond
+00003410: 7320 746f 2061 2070 6f73 6974 696f 6e20  s to a position 
+00003420: 696e 2074 6865 2074 696d 6520 7365 7269  in the time seri
+00003430: 6573 2c0a 2020 2020 2020 2020 616e 6420  es,.        and 
+00003440: 6561 6368 2063 6f6c 756d 6e20 636f 7272  each column corr
+00003450: 6573 706f 6e64 7320 746f 2061 2064 6966  esponds to a dif
+00003460: 6665 7265 6e74 2077 696e 646f 7720 7369  ferent window si
+00003470: 7a65 2e20 5468 6520 7265 7375 6c74 7320  ze. The results 
+00003480: 6172 6520 6361 6c63 756c 6174 6564 2061  are calculated a
+00003490: 7320 7468 6520 6162 736f 6c75 7465 2064  s the absolute d
+000034a0: 6966 6665 7265 6e63 6520 6265 7477 6565  ifference betwee
+000034b0: 6e0a 2020 2020 2020 2020 7570 7065 7220  n.        upper 
+000034c0: 616e 6420 6c6f 7765 7220 7065 7263 656e  and lower percen
+000034d0: 7469 6c65 7320 6469 7669 6465 6420 6279  tiles divided by
+000034e0: 2074 6865 206d 6564 6961 6e20 6f66 2074   the median of t
+000034f0: 6865 2077 696e 646f 772e 0a0a 2020 2020  he window...    
+00003500: 2020 2020 3a70 6172 616d 206e 702e 6e64      :param np.nd
+00003510: 6172 7261 7920 6461 7461 3a20 5468 6520  array data: The 
+00003520: 696e 7075 7420 7469 6d65 2073 6572 6965  input time serie
+00003530: 7320 6461 7461 2e0a 2020 2020 2020 2020  s data..        
+00003540: 3a70 6172 616d 2069 6e74 2075 7070 6572  :param int upper
+00003550: 5f70 6374 3a20 5468 6520 7570 7065 7220  _pct: The upper 
+00003560: 7065 7263 656e 7469 6c65 2076 616c 7565  percentile value
+00003570: 2066 6f72 2074 6865 2077 696e 646f 7720   for the window 
+00003580: 2865 2e67 2e2c 2039 3520 666f 7220 7468  (e.g., 95 for th
+00003590: 6520 3935 7468 2070 6572 6365 6e74 696c  e 95th percentil
+000035a0: 6529 2e0a 2020 2020 2020 2020 3a70 6172  e)..        :par
+000035b0: 616d 2069 6e74 206c 6f77 6572 5f70 6374  am int lower_pct
+000035c0: 3a20 5468 6520 6c6f 7765 7220 7065 7263  : The lower perc
+000035d0: 656e 7469 6c65 2076 616c 7565 2066 6f72  entile value for
+000035e0: 2074 6865 2077 696e 646f 7720 2865 2e67   the window (e.g
+000035f0: 2e2c 2035 2066 6f72 2074 6865 2035 7468  ., 5 for the 5th
+00003600: 2070 6572 6365 6e74 696c 6529 2e0a 2020   percentile)..  
+00003610: 2020 2020 2020 3a70 6172 616d 206e 702e        :param np.
+00003620: 6e64 6172 7261 7920 7769 6e64 6f77 5f73  ndarray window_s
+00003630: 697a 6573 3a20 416e 2061 7272 6179 206f  izes: An array o
+00003640: 6620 7769 6e64 6f77 2073 697a 6573 2028  f window sizes (
+00003650: 696e 2073 6563 6f6e 6473 2920 746f 2075  in seconds) to u
+00003660: 7365 2066 6f72 2074 6865 2073 6c69 6469  se for the slidi
+00003670: 6e67 2063 616c 6375 6c61 7469 6f6e 2e0a  ng calculation..
+00003680: 2020 2020 2020 2020 3a70 6172 616d 2069          :param i
+00003690: 6e74 2073 616d 706c 655f 7261 7465 3a20  nt sample_rate: 
+000036a0: 5468 6520 7361 6d70 6c69 6e67 2072 6174  The sampling rat
+000036b0: 6520 2873 616d 706c 6573 2070 6572 2073  e (samples per s
+000036c0: 6563 6f6e 6429 206f 6620 7468 6520 7469  econd) of the ti
+000036d0: 6d65 2073 6572 6965 7320 6461 7461 2e0a  me series data..
+000036e0: 2020 2020 2020 2020 3a72 6574 7572 6e20          :return 
+000036f0: 6e70 2e6e 6461 7272 6179 3a20 4120 3244  np.ndarray: A 2D
+00003700: 2061 7272 6179 2063 6f6e 7461 696e 696e   array containin
+00003710: 6720 7468 6520 6469 6666 6572 656e 6365  g the difference
+00003720: 2062 6574 7765 656e 2075 7070 6572 2061   between upper a
+00003730: 6e64 206c 6f77 6572 2070 6572 6365 6e74  nd lower percent
+00003740: 696c 6573 2066 6f72 2065 6163 6820 7769  iles for each wi
+00003750: 6e64 6f77 2073 697a 652e 0a0a 2020 2020  ndow size...    
+00003760: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00003770: 7265 7375 6c74 7320 3d20 6e70 2e66 756c  results = np.ful
+00003780: 6c28 2864 6174 612e 7368 6170 655b 305d  l((data.shape[0]
+00003790: 2c20 7769 6e64 6f77 5f73 697a 6573 2e73  , window_sizes.s
+000037a0: 6861 7065 5b30 5d29 2c20 2d31 2e30 290a  hape[0]), -1.0).
+000037b0: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+000037c0: 2070 7261 6e67 6528 7769 6e64 6f77 5f73   prange(window_s
+000037d0: 697a 6573 2e73 6861 7065 5b30 5d29 3a0a  izes.shape[0]):.
+000037e0: 2020 2020 2020 2020 2020 2020 7769 6e64              wind
+000037f0: 6f77 5f73 697a 6520 3d20 696e 7428 7769  ow_size = int(wi
+00003800: 6e64 6f77 5f73 697a 6573 5b69 5d20 2a20  ndow_sizes[i] * 
+00003810: 6670 7329 0a20 2020 2020 2020 2020 2020  fps).           
+00003820: 2066 6f72 206c 2c20 7220 696e 207a 6970   for l, r in zip
+00003830: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00003840: 2020 7072 616e 6765 2830 2c20 6461 7461    prange(0, data
+00003850: 2e73 6861 7065 5b30 5d20 2b20 3129 2c20  .shape[0] + 1), 
+00003860: 7072 616e 6765 2877 696e 646f 775f 7369  prange(window_si
+00003870: 7a65 2c20 6461 7461 2e73 6861 7065 5b30  ze, data.shape[0
+00003880: 5d20 2b20 3129 0a20 2020 2020 2020 2020  ] + 1).         
+00003890: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+000038a0: 2020 2020 2020 7361 6d70 6c65 203d 2064        sample = d
+000038b0: 6174 615b 6c3a 725d 0a20 2020 2020 2020  ata[l:r].       
+000038c0: 2020 2020 2020 2020 2075 7070 6572 5f76           upper_v
+000038d0: 616c 2c20 6c6f 7765 725f 7661 6c20 3d20  al, lower_val = 
+000038e0: 6e70 2e70 6572 6365 6e74 696c 6528 7361  np.percentile(sa
+000038f0: 6d70 6c65 2c20 7570 7065 725f 7063 7429  mple, upper_pct)
+00003900: 2c20 6e70 2e70 6572 6365 6e74 696c 6528  , np.percentile(
+00003910: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003920: 2020 2020 2073 616d 706c 652c 206c 6f77       sample, low
+00003930: 6572 5f70 6374 0a20 2020 2020 2020 2020  er_pct.         
+00003940: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00003950: 2020 2020 2020 2020 206d 6564 6961 6e20           median 
+00003960: 3d20 6e70 2e6d 6564 6961 6e28 7361 6d70  = np.median(samp
+00003970: 6c65 290a 2020 2020 2020 2020 2020 2020  le).            
+00003980: 2020 2020 6966 206d 6564 6961 6e20 213d      if median !=
+00003990: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+000039a0: 2020 2020 2020 2020 7265 7375 6c74 735b          results[
+000039b0: 7220 2d20 312c 2069 5d20 3d20 6e70 2e61  r - 1, i] = np.a
+000039c0: 6273 2875 7070 6572 5f76 616c 202d 206c  bs(upper_val - l
+000039d0: 6f77 6572 5f76 616c 2920 2f20 6d65 6469  ower_val) / medi
+000039e0: 616e 0a20 2020 2020 2020 2020 2020 2020  an.             
+000039f0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00003a00: 2020 2020 2020 2020 2020 2020 2072 6573               res
+00003a10: 756c 7473 5b72 202d 2031 2c20 695d 203d  ults[r - 1, i] =
+00003a20: 202d 312e 300a 0a20 2020 2020 2020 2072   -1.0..        r
+00003a30: 6574 7572 6e20 7265 7375 6c74 732e 6173  eturn results.as
+00003a40: 7479 7065 286e 702e 666c 6f61 7433 3229  type(np.float32)
+00003a50: 0a0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
+00003a60: 686f 640a 2020 2020 406e 6a69 7428 2228  hod.    @njit("(
+00003a70: 666c 6f61 7436 345b 3a5d 2c20 666c 6f61  float64[:], floa
+00003a80: 7436 342c 2922 290a 2020 2020 6465 6620  t64,)").    def 
+00003a90: 7065 7263 656e 745f 6265 796f 6e64 5f6e  percent_beyond_n
+00003aa0: 5f73 7464 2864 6174 613a 206e 702e 6e64  _std(data: np.nd
+00003ab0: 6172 7261 792c 206e 3a20 666c 6f61 7429  array, n: float)
+00003ac0: 202d 3e20 666c 6f61 743a 0a20 2020 2020   -> float:.     
+00003ad0: 2020 2022 2222 0a20 2020 2020 2020 204a     """.        J
+00003ae0: 6974 7465 6420 636f 6d70 7574 6520 6f66  itted compute of
+00003af0: 2074 6865 2072 6174 696f 206f 6620 7661   the ratio of va
+00003b00: 6c75 6573 2069 6e20 7469 6d65 2d73 6572  lues in time-ser
+00003b10: 6965 7320 6d6f 7265 2074 6861 6e20 4e20  ies more than N 
+00003b20: 7374 616e 6461 7264 2064 6576 6961 7469  standard deviati
+00003b30: 6f6e 7320 6672 6f6d 2074 6865 206d 6561  ons from the mea
+00003b40: 6e20 6f66 2074 6865 2074 696d 652d 7365  n of the time-se
+00003b50: 7269 6573 2e0a 0a20 2020 2020 2020 203a  ries...        :
+00003b60: 7061 7261 6d65 7465 7220 6e70 2e6e 6461  parameter np.nda
+00003b70: 7272 6179 2064 6174 613a 2031 4420 6172  rray data: 1D ar
+00003b80: 7261 7920 7265 7072 6573 656e 7469 6e67  ray representing
+00003b90: 2074 696d 652d 7365 7269 6573 2e0a 2020   time-series..  
+00003ba0: 2020 2020 2020 3a70 6172 616d 6574 6572        :parameter
+00003bb0: 2066 6c6f 6174 206e 3a20 5374 616e 6461   float n: Standa
+00003bc0: 7264 2064 6576 6961 7469 6f6e 2063 7574  rd deviation cut
+00003bd0: 2d6f 6666 2e0a 2020 2020 2020 2020 3a72  -off..        :r
+00003be0: 6574 7572 6e73 2066 6c6f 6174 3a20 5261  eturns float: Ra
+00003bf0: 7469 6f20 6f66 2076 616c 7565 7320 696e  tio of values in
+00003c00: 2060 6064 6174 6160 6020 7468 6174 2066   ``data`` that f
+00003c10: 616c 6c20 6d6f 7265 2074 6861 6e20 6060  all more than ``
+00003c20: 6e60 6020 7374 616e 6461 7264 2064 6576  n`` standard dev
+00003c30: 6961 7469 6f6e 7320 6672 6f6d 206d 6561  iations from mea
+00003c40: 6e20 6f66 2060 6064 6174 6160 602e 0a0a  n of ``data``...
+00003c50: 2020 2020 2020 2020 2e2e 206e 6f74 653a          .. note:
+00003c60: 3a0a 2020 2020 2020 2020 2020 2041 6461  :.           Ada
+00003c70: 7074 6564 2066 726f 6d20 6063 6573 6975  pted from `cesiu
+00003c80: 6d20 3c68 7474 7073 3a2f 2f67 6974 6875  m <https://githu
+00003c90: 622e 636f 6d2f 6365 7369 756d 2d6d 6c2f  b.com/cesium-ml/
+00003ca0: 6365 7369 756d 3e60 5f2e 0a0a 2020 2020  cesium>`_...    
+00003cb0: 2020 2020 2020 204f 6464 6574 6974 793a         Oddetity:
+00003cc0: 206d 6561 6e20 6361 6c63 756c 6174 696f   mean calculatio
+00003cd0: 6e20 6973 2069 6e63 6f72 7265 6374 2069  n is incorrect i
+00003ce0: 6620 7061 7373 696e 6720 666c 6f61 7433  f passing float3
+00003cf0: 3220 6461 7461 2062 7574 2063 6f72 7265  2 data but corre
+00003d00: 6374 2069 6620 7061 7373 696e 6720 666c  ct if passing fl
+00003d10: 6f61 7436 342e 0a0a 2020 2020 2020 2020  oat64...        
+00003d20: 2e2e 2069 6d61 6765 3a3a 205f 7374 6174  .. image:: _stat
+00003d30: 6963 2f69 6d67 2f70 6572 6365 6e74 5f62  ic/img/percent_b
+00003d40: 6579 6f6e 645f 6e5f 7374 642e 706e 670a  eyond_n_std.png.
+00003d50: 2020 2020 2020 2020 2020 203a 7769 6474             :widt
+00003d60: 683a 2036 3030 0a20 2020 2020 2020 2020  h: 600.         
+00003d70: 2020 3a61 6c69 676e 3a20 6365 6e74 6572    :align: center
+00003d80: 0a0a 2020 2020 2020 2020 3a65 7861 6d70  ..        :examp
+00003d90: 6c65 733a 0a20 2020 2020 2020 203e 3e3e  les:.        >>>
+00003da0: 2064 6174 6120 3d20 6e70 2e61 7272 6179   data = np.array
+00003db0: 285b 332e 392c 2037 2e35 2c20 2034 2e32  ([3.9, 7.5,  4.2
+00003dc0: 2c20 362e 322c 2037 2e35 2c20 332e 392c  , 6.2, 7.5, 3.9,
+00003dd0: 2036 2e32 2c20 362e 352c 2037 2e32 2c20   6.2, 6.5, 7.2, 
+00003de0: 392e 355d 292e 6173 7479 7065 286e 702e  9.5]).astype(np.
+00003df0: 666c 6f61 7433 3229 0a20 2020 2020 2020  float32).       
+00003e00: 203e 3e3e 2054 696d 6573 6572 6965 7346   >>> TimeseriesF
+00003e10: 6561 7475 7265 4d69 7869 6e28 292e 7065  eatureMixin().pe
+00003e20: 7263 656e 745f 6265 796f 6e64 5f6e 5f73  rcent_beyond_n_s
+00003e30: 7464 2864 6174 613d 6461 7461 2c20 6e3d  td(data=data, n=
+00003e40: 3129 0a20 2020 2020 2020 203e 3e3e 2030  1).        >>> 0
+00003e50: 2e31 0a0a 2020 2020 2020 2020 2222 220a  .1..        """.
+00003e60: 2020 2020 2020 2020 6d20 3d20 6e70 2e6d          m = np.m
+00003e70: 6561 6e28 6461 7461 290a 2020 2020 2020  ean(data).      
+00003e80: 2020 7374 6420 3d20 6e70 2e73 7464 2864    std = np.std(d
+00003e90: 6174 6129 0a20 2020 2020 2020 2074 6172  ata).        tar
+00003ea0: 6765 7420 3d20 6d20 2b20 2873 7464 202a  get = m + (std *
+00003eb0: 206e 290a 2020 2020 2020 2020 7265 7475   n).        retu
+00003ec0: 726e 206e 702e 6172 6777 6865 7265 2864  rn np.argwhere(d
+00003ed0: 6174 6120 3e20 7461 7267 6574 292e 7368  ata > target).sh
+00003ee0: 6170 655b 305d 202f 2064 6174 612e 7368  ape[0] / data.sh
+00003ef0: 6170 655b 305d 0a0a 2020 2020 4073 7461  ape[0]..    @sta
+00003f00: 7469 636d 6574 686f 640a 2020 2020 406e  ticmethod.    @n
+00003f10: 6a69 7428 2228 666c 6f61 7436 345b 3a5d  jit("(float64[:]
+00003f20: 2c20 666c 6f61 7436 342c 2066 6c6f 6174  , float64, float
+00003f30: 3634 5b3a 5d2c 2069 6e74 3634 2c29 222c  64[:], int64,)",
+00003f40: 2063 6163 6865 3d54 7275 652c 2066 6173   cache=True, fas
+00003f50: 746d 6174 683d 5472 7565 290a 2020 2020  tmath=True).    
+00003f60: 6465 6620 736c 6964 696e 675f 7065 7263  def sliding_perc
+00003f70: 656e 745f 6265 796f 6e64 5f6e 5f73 7464  ent_beyond_n_std
+00003f80: 280a 2020 2020 2020 2020 6461 7461 3a20  (.        data: 
+00003f90: 6e70 2e6e 6461 7272 6179 2c20 6e3a 2066  np.ndarray, n: f
+00003fa0: 6c6f 6174 2c20 7769 6e64 6f77 5f73 697a  loat, window_siz
+00003fb0: 6573 3a20 6e70 2e6e 6461 7272 6179 2c20  es: np.ndarray, 
+00003fc0: 7361 6d70 6c65 5f72 6174 653a 2069 6e74  sample_rate: int
+00003fd0: 0a20 2020 2029 202d 3e20 6e70 2e6e 6461  .    ) -> np.nda
+00003fe0: 7272 6179 3a0a 2020 2020 2020 2020 2222  rray:.        ""
+00003ff0: 220a 2020 2020 2020 2020 436f 6d70 7574  ".        Comput
+00004000: 6564 2074 6865 2070 6572 6365 6e74 6167  ed the percentag
+00004010: 6520 6f66 2064 6174 6120 706f 696e 7473  e of data points
+00004020: 2074 6861 7420 6578 6365 6564 2027 6e27   that exceed 'n'
+00004030: 2073 7461 6e64 6172 6420 6465 7669 6174   standard deviat
+00004040: 696f 6e73 2066 726f 6d20 7468 6520 6d65  ions from the me
+00004050: 616e 2066 6f72 2065 6163 6820 706f 7369  an for each posi
+00004060: 7469 6f6e 2069 6e0a 2020 2020 2020 2020  tion in.        
+00004070: 7468 6520 7469 6d65 2073 6572 6965 7320  the time series 
+00004080: 7573 696e 6720 7661 7269 6f75 7320 7769  using various wi
+00004090: 6e64 6f77 2073 697a 6573 2e20 4974 2072  ndow sizes. It r
+000040a0: 6574 7572 6e73 2061 2032 4420 6172 7261  eturns a 2D arra
+000040b0: 7920 7768 6572 6520 6561 6368 2072 6f77  y where each row
+000040c0: 2063 6f72 7265 7370 6f6e 6473 2074 6f20   corresponds to 
+000040d0: 6120 706f 7369 7469 6f6e 2069 6e20 7468  a position in th
+000040e0: 6520 7469 6d65 2073 6572 6965 732c 0a20  e time series,. 
+000040f0: 2020 2020 2020 2061 6e64 2065 6163 6820         and each 
+00004100: 636f 6c75 6d6e 2063 6f72 7265 7370 6f6e  column correspon
+00004110: 6473 2074 6f20 6120 6469 6666 6572 656e  ds to a differen
+00004120: 7420 7769 6e64 6f77 2073 697a 652e 2054  t window size. T
+00004130: 6865 2072 6573 756c 7473 2061 7265 2067  he results are g
+00004140: 6976 656e 2061 7320 6120 7065 7263 656e  iven as a percen
+00004150: 7461 6765 206f 6620 6461 7461 2070 6f69  tage of data poi
+00004160: 6e74 7320 6265 796f 6e64 2074 6865 2074  nts beyond the t
+00004170: 6872 6573 686f 6c64 2e0a 0a20 2020 2020  hreshold...     
+00004180: 2020 203a 7061 7261 6d20 6e70 2e6e 6461     :param np.nda
+00004190: 7272 6179 2064 6174 613a 2054 6865 2069  rray data: The i
+000041a0: 6e70 7574 2074 696d 6520 7365 7269 6573  nput time series
+000041b0: 2064 6174 612e 0a20 2020 2020 2020 203a   data..        :
+000041c0: 7061 7261 6d20 666c 6f61 7420 6e3a 2054  param float n: T
+000041d0: 6865 206e 756d 6265 7220 6f66 2073 7461  he number of sta
+000041e0: 6e64 6172 6420 6465 7669 6174 696f 6e73  ndard deviations
+000041f0: 2074 6f20 6465 7465 726d 696e 6520 7468   to determine th
+00004200: 6520 7468 7265 7368 6f6c 642e 0a20 2020  e threshold..   
+00004210: 2020 2020 203a 7061 7261 6d20 6e70 2e6e       :param np.n
+00004220: 6461 7272 6179 2077 696e 646f 775f 7369  darray window_si
+00004230: 7a65 733a 2041 6e20 6172 7261 7920 6f66  zes: An array of
+00004240: 2077 696e 646f 7720 7369 7a65 7320 2869   window sizes (i
+00004250: 6e20 7365 636f 6e64 7329 2074 6f20 7573  n seconds) to us
+00004260: 6520 666f 7220 7468 6520 736c 6964 696e  e for the slidin
+00004270: 6720 6361 6c63 756c 6174 696f 6e2e 0a20  g calculation.. 
+00004280: 2020 2020 2020 203a 7061 7261 6d20 696e         :param in
+00004290: 7420 7361 6d70 6c65 5f72 6174 653a 2054  t sample_rate: T
+000042a0: 6865 2073 616d 706c 696e 6720 7261 7465  he sampling rate
+000042b0: 2028 7361 6d70 6c65 7320 7065 7220 7365   (samples per se
+000042c0: 636f 6e64 2920 6f66 2074 6865 2074 696d  cond) of the tim
+000042d0: 6520 7365 7269 6573 2064 6174 612e 0a20  e series data.. 
+000042e0: 2020 2020 2020 203a 7265 7475 726e 206e         :return n
+000042f0: 702e 6e64 6172 7261 793a 2041 2032 4420  p.ndarray: A 2D 
+00004300: 6172 7261 7920 636f 6e74 6169 6e69 6e67  array containing
+00004310: 2074 6865 2070 6572 6365 6e74 6167 6520   the percentage 
+00004320: 6f66 2064 6174 6120 706f 696e 7473 2062  of data points b
+00004330: 6579 6f6e 6420 7468 6520 7370 6563 6966  eyond the specif
+00004340: 6965 6420 276e 2720 7374 616e 6461 7264  ied 'n' standard
+00004350: 2064 6576 6961 7469 6f6e 7320 666f 7220   deviations for 
+00004360: 6561 6368 2077 696e 646f 7720 7369 7a65  each window size
+00004370: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
+00004380: 2020 2020 2020 2072 6573 756c 7473 203d         results =
+00004390: 206e 702e 6675 6c6c 2828 6461 7461 2e73   np.full((data.s
+000043a0: 6861 7065 5b30 5d2c 2077 696e 646f 775f  hape[0], window_
+000043b0: 7369 7a65 732e 7368 6170 655b 305d 292c  sizes.shape[0]),
+000043c0: 202d 312e 3029 0a20 2020 2020 2020 2074   -1.0).        t
+000043d0: 6172 6765 7420 3d20 286e 702e 7374 6428  arget = (np.std(
+000043e0: 6461 7461 2920 2a20 6e29 202b 206e 702e  data) * n) + np.
+000043f0: 6d65 616e 2864 6174 6129 0a20 2020 2020  mean(data).     
+00004400: 2020 2066 6f72 2069 2069 6e20 7072 616e     for i in pran
+00004410: 6765 2877 696e 646f 775f 7369 7a65 732e  ge(window_sizes.
+00004420: 7368 6170 655b 305d 293a 0a20 2020 2020  shape[0]):.     
+00004430: 2020 2020 2020 2077 696e 646f 775f 7369         window_si
+00004440: 7a65 203d 2069 6e74 2877 696e 646f 775f  ze = int(window_
+00004450: 7369 7a65 735b 695d 202a 2073 616d 706c  sizes[i] * sampl
+00004460: 655f 7261 7465 290a 2020 2020 2020 2020  e_rate).        
+00004470: 2020 2020 666f 7220 6c2c 2072 2069 6e20      for l, r in 
+00004480: 7a69 7028 0a20 2020 2020 2020 2020 2020  zip(.           
+00004490: 2020 2020 2070 7261 6e67 6528 302c 2064       prange(0, d
+000044a0: 6174 612e 7368 6170 655b 305d 202b 2031  ata.shape[0] + 1
+000044b0: 292c 2070 7261 6e67 6528 7769 6e64 6f77  ), prange(window
+000044c0: 5f73 697a 652c 2064 6174 612e 7368 6170  _size, data.shap
+000044d0: 655b 305d 202b 2031 290a 2020 2020 2020  e[0] + 1).      
+000044e0: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+000044f0: 2020 2020 2020 2020 2073 616d 706c 6520           sample 
+00004500: 3d20 6461 7461 5b6c 3a72 5d0a 2020 2020  = data[l:r].    
+00004510: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+00004520: 6c74 735b 7220 2d20 312c 2069 5d20 3d20  lts[r - 1, i] = 
+00004530: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00004540: 2020 2020 2020 6e70 2e61 7267 7768 6572        np.argwher
+00004550: 6528 6e70 2e61 6273 2873 616d 706c 6529  e(np.abs(sample)
+00004560: 203e 2074 6172 6765 7429 2e73 6861 7065   > target).shape
+00004570: 5b30 5d20 2f20 7361 6d70 6c65 2e73 6861  [0] / sample.sha
+00004580: 7065 5b30 5d0a 2020 2020 2020 2020 2020  pe[0].          
+00004590: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+000045a0: 2072 6574 7572 6e20 7265 7375 6c74 732e   return results.
+000045b0: 6173 7479 7065 286e 702e 666c 6f61 7433  astype(np.float3
+000045c0: 3229 0a0a 2020 2020 4073 7461 7469 636d  2)..    @staticm
+000045d0: 6574 686f 640a 2020 2020 406e 6a69 7428  ethod.    @njit(
+000045e0: 0a20 2020 2020 2020 205b 0a20 2020 2020  .        [.     
+000045f0: 2020 2020 2020 2028 666c 6f61 7433 325b         (float32[
+00004600: 3a5d 2c20 666c 6f61 7436 345b 3a5d 2c20  :], float64[:], 
+00004610: 696e 7436 3429 2c0a 2020 2020 2020 2020  int64),.        
+00004620: 2020 2020 2869 6e74 3634 5b3a 5d2c 2066      (int64[:], f
+00004630: 6c6f 6174 3634 5b3a 5d2c 2069 6e74 3634  loat64[:], int64
+00004640: 292c 0a20 2020 2020 2020 205d 0a20 2020  ),.        ].   
+00004650: 2029 0a20 2020 2064 6566 2073 6c69 6469   ).    def slidi
+00004660: 6e67 5f75 6e69 7175 6528 783a 206e 702e  ng_unique(x: np.
+00004670: 6e64 6172 7261 792c 2074 696d 655f 7769  ndarray, time_wi
+00004680: 6e64 6f77 733a 206e 702e 6e64 6172 7261  ndows: np.ndarra
+00004690: 792c 2066 7073 3a20 696e 7429 3a0a 2020  y, fps: int):.  
+000046a0: 2020 2020 2020 7265 7375 6c74 7320 3d20        results = 
+000046b0: 6e70 2e66 756c 6c28 2878 2e73 6861 7065  np.full((x.shape
+000046c0: 5b30 5d2c 2074 696d 655f 7769 6e64 6f77  [0], time_window
+000046d0: 732e 7368 6170 655b 305d 292c 202d 3129  s.shape[0]), -1)
+000046e0: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
+000046f0: 6e20 7072 616e 6765 2874 696d 655f 7769  n prange(time_wi
+00004700: 6e64 6f77 732e 7368 6170 655b 305d 293a  ndows.shape[0]):
+00004710: 0a20 2020 2020 2020 2020 2020 2077 696e  .            win
+00004720: 646f 775f 7369 7a65 203d 2069 6e74 2874  dow_size = int(t
+00004730: 696d 655f 7769 6e64 6f77 735b 695d 202a  ime_windows[i] *
+00004740: 2066 7073 290a 2020 2020 2020 2020 2020   fps).          
+00004750: 2020 666f 7220 6c2c 2072 2069 6e20 7a69    for l, r in zi
+00004760: 7028 0a20 2020 2020 2020 2020 2020 2020  p(.             
+00004770: 2020 2072 616e 6765 2830 2c20 782e 7368     range(0, x.sh
+00004780: 6170 655b 305d 202b 2031 292c 2072 616e  ape[0] + 1), ran
+00004790: 6765 2877 696e 646f 775f 7369 7a65 2c20  ge(window_size, 
+000047a0: 782e 7368 6170 655b 305d 202b 2031 290a  x.shape[0] + 1).
+000047b0: 2020 2020 2020 2020 2020 2020 293a 0a20              ):. 
+000047c0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000047d0: 616d 706c 6520 3d20 785b 6c3a 725d 0a20  ample = x[l:r]. 
+000047e0: 2020 2020 2020 2020 2020 2020 2020 2075                 u
+000047f0: 6e69 7175 655f 636e 7420 3d20 6e70 2e75  nique_cnt = np.u
+00004800: 6e69 7175 6528 7361 6d70 6c65 290a 2020  nique(sample).  
+00004810: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00004820: 7375 6c74 735b 7220 2d20 312c 2069 5d20  sults[r - 1, i] 
+00004830: 3d20 756e 6971 7565 5f63 6e74 2e73 6861  = unique_cnt.sha
+00004840: 7065 5b30 5d0a 2020 2020 2020 2020 7265  pe[0].        re
+00004850: 7475 726e 2072 6573 756c 7473 0a0a 2020  turn results..  
+00004860: 2020 4073 7461 7469 636d 6574 686f 640a    @staticmethod.
+00004870: 2020 2020 406e 6a69 7428 2228 666c 6f61      @njit("(floa
+00004880: 7433 325b 3a5d 2c20 696e 7436 342c 2069  t32[:], int64, i
+00004890: 6e74 3634 2c20 2922 2c20 6661 7374 6d61  nt64, )", fastma
+000048a0: 7468 3d54 7275 6529 0a20 2020 2064 6566  th=True).    def
+000048b0: 2070 6572 6365 6e74 5f69 6e5f 7065 7263   percent_in_perc
+000048c0: 656e 7469 6c65 5f77 696e 646f 7728 6461  entile_window(da
+000048d0: 7461 3a20 6e70 2e6e 6461 7272 6179 2c20  ta: np.ndarray, 
+000048e0: 7570 7065 725f 7063 743a 2069 6e74 2c20  upper_pct: int, 
+000048f0: 6c6f 7765 725f 7063 743a 2069 6e74 293a  lower_pct: int):
+00004900: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00004910: 2020 2020 204a 6974 7465 6420 636f 6d70       Jitted comp
+00004920: 7574 6520 6f66 2074 6865 2072 6174 696f  ute of the ratio
+00004930: 206f 6620 7661 6c75 6573 2069 6e20 7469   of values in ti
+00004940: 6d65 2d73 6572 6965 7320 7468 6174 2066  me-series that f
+00004950: 616c 6c20 6265 7477 6565 6e20 7468 6520  all between the 
+00004960: 6060 7570 7065 7260 6020 616e 6420 6060  ``upper`` and ``
+00004970: 6c6f 7765 7260 6020 7065 7263 656e 7469  lower`` percenti
+00004980: 6c65 2e0a 0a20 2020 2020 2020 203a 7061  le...        :pa
+00004990: 7261 6d65 7465 7220 6e70 2e6e 6461 7272  rameter np.ndarr
+000049a0: 6179 2064 6174 613a 2031 4420 6172 7261  ay data: 1D arra
+000049b0: 7920 6f66 2072 6570 7265 7365 6e74 696e  y of representin
+000049c0: 6720 7469 6d65 2d73 6572 6965 732e 0a20  g time-series.. 
+000049d0: 2020 2020 2020 203a 7061 7261 6d65 7465         :paramete
+000049e0: 7220 696e 7420 7570 7065 725f 7063 743a  r int upper_pct:
+000049f0: 2055 7070 6572 2d62 6f75 6e64 6172 7920   Upper-boundary 
+00004a00: 7065 7263 656e 7469 6c65 2e0a 2020 2020  percentile..    
+00004a10: 2020 2020 3a70 6172 616d 6574 6572 2069      :parameter i
+00004a20: 6e74 206c 6f77 6572 5f70 6374 3a20 4c6f  nt lower_pct: Lo
+00004a30: 7765 722d 626f 756e 6461 7279 2070 6572  wer-boundary per
+00004a40: 6365 6e74 696c 652e 0a20 2020 2020 2020  centile..       
+00004a50: 203a 7265 7475 726e 7320 666c 6f61 743a   :returns float:
+00004a60: 2052 6174 696f 206f 6620 7661 6c75 6573   Ratio of values
+00004a70: 2069 6e20 6060 6461 7461 6060 2074 6861   in ``data`` tha
+00004a80: 7420 6661 6c6c 2077 6974 6869 6e20 6060  t fall within ``
+00004a90: 7570 7065 725f 7063 7460 6020 616e 6420  upper_pct`` and 
+00004aa0: 6060 6c6f 7765 725f 7063 7460 6020 7065  ``lower_pct`` pe
+00004ab0: 7263 656e 7469 6c65 732e 0a0a 2020 2020  rcentiles...    
+00004ac0: 2020 2020 2e2e 206e 6f74 653a 3a0a 2020      .. note::.  
+00004ad0: 2020 2020 2020 2020 2041 6461 7074 6564           Adapted
+00004ae0: 2066 726f 6d20 6063 6573 6975 6d20 3c68   from `cesium <h
+00004af0: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+00004b00: 6d2f 6365 7369 756d 2d6d 6c2f 6365 7369  m/cesium-ml/cesi
+00004b10: 756d 3e60 5f2e 0a0a 2020 2020 2020 2020  um>`_...        
+00004b20: 2e2e 2069 6d61 6765 3a3a 205f 7374 6174  .. image:: _stat
+00004b30: 6963 2f69 6d67 2f70 6572 6365 6e74 5f69  ic/img/percent_i
+00004b40: 6e5f 7065 7263 656e 7469 6c65 5f77 696e  n_percentile_win
+00004b50: 646f 772e 706e 670a 2020 2020 2020 2020  dow.png.        
+00004b60: 2020 203a 7769 6474 683a 2036 3030 0a20     :width: 600. 
+00004b70: 2020 2020 2020 2020 2020 3a61 6c69 676e            :align
+00004b80: 3a20 6365 6e74 6572 0a0a 2020 2020 2020  : center..      
+00004b90: 2020 3a65 7861 6d70 6c65 3a0a 2020 2020    :example:.    
+00004ba0: 2020 2020 3e3e 3e20 6461 7461 203d 206e      >>> data = n
+00004bb0: 702e 6172 7261 7928 5b33 2e39 2c20 372e  p.array([3.9, 7.
+00004bc0: 352c 2020 342e 322c 2036 2e32 2c20 372e  5,  4.2, 6.2, 7.
+00004bd0: 352c 2033 2e39 2c20 362e 322c 2036 2e35  5, 3.9, 6.2, 6.5
+00004be0: 2c20 372e 322c 2039 2e35 5d29 2e61 7374  , 7.2, 9.5]).ast
+00004bf0: 7970 6528 6e70 2e66 6c6f 6174 3332 290a  ype(np.float32).
+00004c00: 2020 2020 2020 2020 3e3e 3e20 5469 6d65          >>> Time
+00004c10: 7365 7269 6573 4665 6174 7572 654d 6978  seriesFeatureMix
+00004c20: 696e 2829 2e70 6572 6365 6e74 5f69 6e5f  in().percent_in_
+00004c30: 7065 7263 656e 7469 6c65 5f77 696e 646f  percentile_windo
+00004c40: 7728 6461 7461 2c20 7570 7065 725f 7063  w(data, upper_pc
+00004c50: 743d 3730 2c20 6c6f 7765 725f 7063 743d  t=70, lower_pct=
+00004c60: 3330 290a 2020 2020 2020 2020 3e3e 3e20  30).        >>> 
+00004c70: 302e 340a 2020 2020 2020 2020 2222 220a  0.4.        """.
+00004c80: 0a20 2020 2020 2020 2075 7070 6572 5f76  .        upper_v
+00004c90: 616c 2c20 6c6f 7765 725f 7661 6c20 3d20  al, lower_val = 
+00004ca0: 6e70 2e70 6572 6365 6e74 696c 6528 6461  np.percentile(da
+00004cb0: 7461 2c20 7570 7065 725f 7063 7429 2c20  ta, upper_pct), 
+00004cc0: 6e70 2e70 6572 6365 6e74 696c 6528 0a20  np.percentile(. 
+00004cd0: 2020 2020 2020 2020 2020 2064 6174 612c             data,
+00004ce0: 206c 6f77 6572 5f70 6374 0a20 2020 2020   lower_pct.     
+00004cf0: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
+00004d00: 7572 6e20 280a 2020 2020 2020 2020 2020  urn (.          
+00004d10: 2020 6e70 2e61 7267 7768 6572 6528 2864    np.argwhere((d
+00004d20: 6174 6120 3c3d 2075 7070 6572 5f76 616c  ata <= upper_val
+00004d30: 2920 2620 2864 6174 6120 3e3d 206c 6f77  ) & (data >= low
+00004d40: 6572 5f76 616c 2929 2e66 6c61 7474 656e  er_val)).flatten
+00004d50: 2829 2e73 6861 7065 5b30 5d0a 2020 2020  ().shape[0].    
+00004d60: 2020 2020 2020 2020 2f20 6461 7461 2e73          / data.s
+00004d70: 6861 7065 5b30 5d0a 2020 2020 2020 2020  hape[0].        
+00004d80: 290a 0a20 2020 2040 7374 6174 6963 6d65  )..    @staticme
+00004d90: 7468 6f64 0a20 2020 2040 6e6a 6974 2822  thod.    @njit("
+00004da0: 2866 6c6f 6174 3332 5b3a 5d2c 2069 6e74  (float32[:], int
+00004db0: 3634 2c20 696e 7436 342c 2066 6c6f 6174  64, int64, float
+00004dc0: 3634 5b3a 5d2c 2069 6e74 3634 2922 2c20  64[:], int64)", 
+00004dd0: 6361 6368 653d 5472 7565 2c20 6661 7374  cache=True, fast
+00004de0: 6d61 7468 3d54 7275 6529 0a20 2020 2064  math=True).    d
+00004df0: 6566 2073 6c69 6469 6e67 5f70 6572 6365  ef sliding_perce
+00004e00: 6e74 5f69 6e5f 7065 7263 656e 7469 6c65  nt_in_percentile
+00004e10: 5f77 696e 646f 7728 0a20 2020 2020 2020  _window(.       
+00004e20: 2064 6174 613a 206e 702e 6e64 6172 7261   data: np.ndarra
+00004e30: 792c 0a20 2020 2020 2020 2075 7070 6572  y,.        upper
+00004e40: 5f70 6374 3a20 696e 742c 0a20 2020 2020  _pct: int,.     
+00004e50: 2020 206c 6f77 6572 5f70 6374 3a20 696e     lower_pct: in
+00004e60: 742c 0a20 2020 2020 2020 2077 696e 646f  t,.        windo
+00004e70: 775f 7369 7a65 733a 206e 702e 6e64 6172  w_sizes: np.ndar
+00004e80: 7261 792c 0a20 2020 2020 2020 2073 616d  ray,.        sam
+00004e90: 706c 655f 7261 7465 3a20 696e 742c 0a20  ple_rate: int,. 
+00004ea0: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
+00004eb0: 220a 2020 2020 2020 2020 4a69 7474 6564  ".        Jitted
+00004ec0: 2063 6f6d 7075 7465 206f 6620 7468 6520   compute of the 
+00004ed0: 7065 7263 656e 7461 6765 206f 6620 6461  percentage of da
+00004ee0: 7461 2070 6f69 6e74 7320 6661 6c6c 696e  ta points fallin
+00004ef0: 6720 7769 7468 696e 2061 2070 6572 6365  g within a perce
+00004f00: 6e74 696c 6520 7769 6e64 6f77 2069 6e20  ntile window in 
+00004f10: 6120 736c 6964 696e 6720 6d61 6e6e 6572  a sliding manner
+00004f20: 2e0a 0a20 2020 2020 2020 2054 6865 2066  ...        The f
+00004f30: 756e 6374 696f 6e20 636f 6d70 7574 6573  unction computes
+00004f40: 2074 6865 2070 6572 6365 6e74 6167 6520   the percentage 
+00004f50: 6f66 2064 6174 6120 706f 696e 7473 2077  of data points w
+00004f60: 6974 6869 6e20 7468 6520 7370 6563 6966  ithin the specif
+00004f70: 6965 6420 7065 7263 656e 7469 6c65 2077  ied percentile w
+00004f80: 696e 646f 7720 666f 7220 6561 6368 2070  indow for each p
+00004f90: 6f73 6974 696f 6e20 696e 2074 6865 2074  osition in the t
+00004fa0: 696d 6520 7365 7269 6573 0a20 2020 2020  ime series.     
+00004fb0: 2020 2075 7369 6e67 2076 6172 696f 7573     using various
+00004fc0: 2077 696e 646f 7720 7369 7a65 732e 2049   window sizes. I
+00004fd0: 7420 7265 7475 726e 7320 6120 3244 2061  t returns a 2D a
+00004fe0: 7272 6179 2077 6865 7265 2065 6163 6820  rray where each 
+00004ff0: 726f 7720 636f 7272 6573 706f 6e64 7320  row corresponds 
+00005000: 746f 2061 2070 6f73 6974 696f 6e20 696e  to a position in
+00005010: 2074 6865 2074 696d 6520 7365 7269 6573   the time series
+00005020: 2c20 616e 6420 6561 6368 2063 6f6c 756d  , and each colum
+00005030: 6e0a 2020 2020 2020 2020 636f 7272 6573  n.        corres
+00005040: 706f 6e64 7320 746f 2061 2064 6966 6665  ponds to a diffe
+00005050: 7265 6e74 2077 696e 646f 7720 7369 7a65  rent window size
+00005060: 2e20 5468 6520 7265 7375 6c74 7320 6172  . The results ar
+00005070: 6520 6769 7665 6e20 6173 2061 2070 6572  e given as a per
+00005080: 6365 6e74 6167 6520 6f66 2064 6174 6120  centage of data 
+00005090: 706f 696e 7473 2077 6974 6869 6e20 7468  points within th
+000050a0: 6520 7065 7263 656e 7469 6c65 2077 696e  e percentile win
+000050b0: 646f 772e 0a0a 2020 2020 2020 2020 3a70  dow...        :p
+000050c0: 6172 616d 206e 702e 6e64 6172 7261 7920  aram np.ndarray 
+000050d0: 6461 7461 3a20 5468 6520 696e 7075 7420  data: The input 
+000050e0: 7469 6d65 2073 6572 6965 7320 6461 7461  time series data
+000050f0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00005100: 2069 6e74 2075 7070 6572 5f70 6374 3a20   int upper_pct: 
+00005110: 5468 6520 7570 7065 7220 7065 7263 656e  The upper percen
+00005120: 7469 6c65 2076 616c 7565 2066 6f72 2074  tile value for t
+00005130: 6865 2077 696e 646f 7720 2865 2e67 2e2c  he window (e.g.,
+00005140: 2039 3520 666f 7220 7468 6520 3935 7468   95 for the 95th
+00005150: 2070 6572 6365 6e74 696c 6529 2e0a 2020   percentile)..  
+00005160: 2020 2020 2020 3a70 6172 616d 2069 6e74        :param int
+00005170: 206c 6f77 6572 5f70 6374 3a20 5468 6520   lower_pct: The 
+00005180: 6c6f 7765 7220 7065 7263 656e 7469 6c65  lower percentile
+00005190: 2076 616c 7565 2066 6f72 2074 6865 2077   value for the w
+000051a0: 696e 646f 7720 2865 2e67 2e2c 2035 2066  indow (e.g., 5 f
+000051b0: 6f72 2074 6865 2035 7468 2070 6572 6365  or the 5th perce
+000051c0: 6e74 696c 6529 2e0a 2020 2020 2020 2020  ntile)..        
+000051d0: 3a70 6172 616d 206e 702e 6e64 6172 7261  :param np.ndarra
+000051e0: 7920 7769 6e64 6f77 5f73 697a 6573 3a20  y window_sizes: 
+000051f0: 416e 2061 7272 6179 206f 6620 7769 6e64  An array of wind
+00005200: 6f77 2073 697a 6573 2028 696e 2073 6563  ow sizes (in sec
+00005210: 6f6e 6473 2920 746f 2075 7365 2066 6f72  onds) to use for
+00005220: 2074 6865 2073 6c69 6469 6e67 2063 616c   the sliding cal
+00005230: 6375 6c61 7469 6f6e 2e0a 2020 2020 2020  culation..      
+00005240: 2020 3a70 6172 616d 2069 6e74 2073 616d    :param int sam
+00005250: 706c 655f 7261 7465 3a20 5468 6520 7361  ple_rate: The sa
+00005260: 6d70 6c69 6e67 2072 6174 6520 2873 616d  mpling rate (sam
+00005270: 706c 6573 2070 6572 2073 6563 6f6e 6429  ples per second)
+00005280: 206f 6620 7468 6520 7469 6d65 2073 6572   of the time ser
+00005290: 6965 7320 6461 7461 2e0a 2020 2020 2020  ies data..      
+000052a0: 2020 3a72 6574 7572 6e20 6e70 2e6e 6461    :return np.nda
+000052b0: 7272 6179 3a20 4120 3244 2061 7272 6179  rray: A 2D array
+000052c0: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
+000052d0: 7065 7263 656e 7461 6765 206f 6620 6461  percentage of da
+000052e0: 7461 2070 6f69 6e74 7320 7769 7468 696e  ta points within
+000052f0: 2074 6865 2070 6572 6365 6e74 696c 6520   the percentile 
+00005300: 7769 6e64 6f77 2066 6f72 2065 6163 6820  window for each 
+00005310: 7769 6e64 6f77 2073 697a 652e 0a0a 2020  window size...  
+00005320: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00005330: 2020 7265 7375 6c74 7320 3d20 6e70 2e66    results = np.f
+00005340: 756c 6c28 2864 6174 612e 7368 6170 655b  ull((data.shape[
+00005350: 305d 2c20 7769 6e64 6f77 5f73 697a 6573  0], window_sizes
+00005360: 2e73 6861 7065 5b30 5d29 2c20 2d31 2e30  .shape[0]), -1.0
+00005370: 290a 2020 2020 2020 2020 7570 7065 725f  ).        upper_
+00005380: 7661 6c2c 206c 6f77 6572 5f76 616c 203d  val, lower_val =
+00005390: 206e 702e 7065 7263 656e 7469 6c65 2864   np.percentile(d
+000053a0: 6174 612c 2075 7070 6572 5f70 6374 292c  ata, upper_pct),
+000053b0: 206e 702e 7065 7263 656e 7469 6c65 280a   np.percentile(.
+000053c0: 2020 2020 2020 2020 2020 2020 6461 7461              data
+000053d0: 2c20 6c6f 7765 725f 7063 740a 2020 2020  , lower_pct.    
+000053e0: 2020 2020 290a 2020 2020 2020 2020 666f      ).        fo
+000053f0: 7220 6920 696e 2070 7261 6e67 6528 7769  r i in prange(wi
+00005400: 6e64 6f77 5f73 697a 6573 2e73 6861 7065  ndow_sizes.shape
+00005410: 5b30 5d29 3a0a 2020 2020 2020 2020 2020  [0]):.          
+00005420: 2020 7769 6e64 6f77 5f73 697a 6520 3d20    window_size = 
+00005430: 696e 7428 7769 6e64 6f77 5f73 697a 6573  int(window_sizes
+00005440: 5b69 5d20 2a20 7361 6d70 6c65 5f72 6174  [i] * sample_rat
+00005450: 6529 0a20 2020 2020 2020 2020 2020 2066  e).            f
+00005460: 6f72 206c 2c20 7220 696e 207a 6970 280a  or l, r in zip(.
+00005470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005480: 7072 616e 6765 2830 2c20 6461 7461 2e73  prange(0, data.s
+00005490: 6861 7065 5b30 5d20 2b20 3129 2c20 7072  hape[0] + 1), pr
+000054a0: 616e 6765 2877 696e 646f 775f 7369 7a65  ange(window_size
+000054b0: 2c20 6461 7461 2e73 6861 7065 5b30 5d20  , data.shape[0] 
+000054c0: 2b20 3129 0a20 2020 2020 2020 2020 2020  + 1).           
+000054d0: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
+000054e0: 2020 2020 7361 6d70 6c65 203d 2064 6174      sample = dat
+000054f0: 615b 6c3a 725d 0a20 2020 2020 2020 2020  a[l:r].         
+00005500: 2020 2020 2020 2072 6573 756c 7473 5b72         results[r
+00005510: 202d 2031 2c20 695d 203d 2028 0a20 2020   - 1, i] = (.   
+00005520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005530: 206e 702e 6172 6777 6865 7265 2828 7361   np.argwhere((sa
+00005540: 6d70 6c65 203c 3d20 7570 7065 725f 7661  mple <= upper_va
+00005550: 6c29 2026 2028 7361 6d70 6c65 203e 3d20  l) & (sample >= 
+00005560: 6c6f 7765 725f 7661 6c29 290a 2020 2020  lower_val)).    
+00005570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005580: 2e66 6c61 7474 656e 2829 0a20 2020 2020  .flatten().     
+00005590: 2020 2020 2020 2020 2020 2020 2020 202e                 .
+000055a0: 7368 6170 655b 305d 0a20 2020 2020 2020  shape[0].       
+000055b0: 2020 2020 2020 2020 2020 2020 202f 2073               / s
+000055c0: 616d 706c 652e 7368 6170 655b 305d 0a20  ample.shape[0]. 
+000055d0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+000055e0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+000055f0: 2072 6573 756c 7473 2e61 7374 7970 6528   results.astype(
+00005600: 6e70 2e66 6c6f 6174 3332 290a 0a20 2020  np.float32)..   
+00005610: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
+00005620: 2020 2040 6e6a 6974 2822 2866 6c6f 6174     @njit("(float
+00005630: 3332 5b3a 5d2c 2922 2c20 6661 7374 6d61  32[:],)", fastma
+00005640: 7468 3d54 7275 652c 2063 6163 6865 3d54  th=True, cache=T
+00005650: 7275 6529 0a20 2020 2064 6566 2070 6574  rue).    def pet
+00005660: 726f 7369 616e 5f66 7261 6374 616c 5f64  rosian_fractal_d
+00005670: 696d 656e 7369 6f6e 2864 6174 613a 206e  imension(data: n
+00005680: 702e 6e64 6172 7261 7929 202d 3e20 666c  p.ndarray) -> fl
+00005690: 6f61 743a 0a20 2020 2020 2020 2022 2222  oat:.        """
+000056a0: 0a20 2020 2020 2020 2043 616c 6375 6c61  .        Calcula
+000056b0: 7465 2074 6865 2050 6574 726f 7369 616e  te the Petrosian
+000056c0: 2046 7261 6374 616c 2044 696d 656e 7369   Fractal Dimensi
+000056d0: 6f6e 2028 5046 4429 206f 6620 6120 6769  on (PFD) of a gi
+000056e0: 7665 6e20 7469 6d65 2073 6572 6965 7320  ven time series 
+000056f0: 6461 7461 2e20 5468 6520 5046 4420 6973  data. The PFD is
+00005700: 2061 206d 6561 7375 7265 206f 6620 7468   a measure of th
+00005710: 650a 2020 2020 2020 2020 6972 7265 6775  e.        irregu
+00005720: 6c61 7269 7479 206f 7220 7365 6c66 2d73  larity or self-s
+00005730: 696d 696c 6172 6974 7920 6f66 2061 2074  imilarity of a t
+00005740: 696d 6520 7365 7269 6573 2e20 4c61 7267  ime series. Larg
+00005750: 6572 2076 616c 7565 7320 696e 6469 6361  er values indica
+00005760: 7465 2068 6967 6865 7220 636f 6d70 6c65  te higher comple
+00005770: 7869 7479 2e20 4c6f 7765 7220 7661 6c75  xity. Lower valu
+00005780: 6573 2069 6e64 6963 6174 6520 6c6f 7765  es indicate lowe
+00005790: 7220 636f 6d70 6c65 7869 7479 2e0a 0a20  r complexity... 
+000057a0: 2020 2020 2020 202e 2e20 6e6f 7465 3a3a         .. note::
+000057b0: 0a20 2020 2020 2020 2020 2020 5468 6520  .           The 
+000057c0: 5046 4420 6973 2063 6f6d 7075 7465 6420  PFD is computed 
+000057d0: 6261 7365 6420 6f6e 2074 6865 206e 756d  based on the num
+000057e0: 6265 7220 6f66 2073 6967 6e20 6368 616e  ber of sign chan
+000057f0: 6765 7320 696e 2074 6865 2066 6972 7374  ges in the first
+00005800: 2064 6572 6976 6174 6976 6520 6f66 2074   derivative of t
+00005810: 6865 2074 696d 6520 7365 7269 6573 2e20  he time series. 
+00005820: 4966 2074 6865 2069 6e70 7574 2064 6174  If the input dat
+00005830: 6120 6973 2065 6d70 7479 206f 7220 6e6f  a is empty or no
+00005840: 2073 6967 6e20 6368 616e 6765 7320 6172   sign changes ar
+00005850: 6520 666f 756e 642c 2074 6865 2050 4644  e found, the PFD
+00005860: 2069 7320 7265 7475 726e 6564 2061 7320   is returned as 
+00005870: 2d31 2e30 2e20 4164 6170 7465 6420 6672  -1.0. Adapted fr
+00005880: 6f6d 2060 6565 676c 6962 203c 6874 7470  om `eeglib <http
+00005890: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f58  s://github.com/X
+000058a0: 6975 6c31 3039 2f65 6567 6c69 622f 3e60  iul109/eeglib/>`
+000058b0: 5f2e 0a0a 2020 2020 2020 2020 2e2e 206d  _...        .. m
+000058c0: 6174 683a 3a0a 2020 2020 2020 2020 2020  ath::.          
+000058d0: 2050 4644 203d 205c 5c66 7261 637b 5c5c   PFD = \\frac{\\
+000058e0: 6c6f 675f 7b31 307d 284e 297d 7b5c 5c6c  log_{10}(N)}{\\l
+000058f0: 6f67 5f7b 3130 7d28 4e29 202b 205c 5c6c  og_{10}(N) + \\l
+00005900: 6f67 5f7b 3130 7d5c 5c6c 6566 7428 5c5c  og_{10}\\left(\\
+00005910: 6672 6163 7b4e 7d7b 4e20 2b20 302e 3420  frac{N}{N + 0.4 
+00005920: 5c5c 6364 6f74 207a 437d 5c5c 7269 6768  \\cdot zC}\\righ
+00005930: 7429 7d0a 0a20 2020 2020 2020 203a 7061  t)}..        :pa
+00005940: 7261 6d65 7465 7220 6e70 2e6e 6461 7272  rameter np.ndarr
+00005950: 6179 2064 6174 613a 2041 2031 2d64 696d  ay data: A 1-dim
+00005960: 656e 7369 6f6e 616c 206e 756d 7079 2061  ensional numpy a
+00005970: 7272 6179 2063 6f6e 7461 696e 696e 6720  rray containing 
+00005980: 7468 6520 7469 6d65 2073 6572 6965 7320  the time series 
+00005990: 6461 7461 2e0a 2020 2020 2020 2020 3a72  data..        :r
+000059a0: 6574 7572 6e73 2066 6c6f 6174 3a20 5468  eturns float: Th
+000059b0: 6520 5065 7472 6f73 6961 6e20 4672 6163  e Petrosian Frac
+000059c0: 7461 6c20 4469 6d65 6e73 696f 6e20 6f66  tal Dimension of
+000059d0: 2074 6865 2069 6e70 7574 2074 696d 6520   the input time 
+000059e0: 7365 7269 6573 2e0a 0a20 2020 2020 2020  series...       
+000059f0: 203a 6578 616d 706c 6573 3a0a 2020 2020   :examples:.    
+00005a00: 2020 2020 3e3e 3e20 7420 3d20 6e70 2e6c      >>> t = np.l
+00005a10: 696e 7370 6163 6528 302c 2035 302c 2069  inspace(0, 50, i
+00005a20: 6e74 2834 3431 3030 202a 2032 2e30 292c  nt(44100 * 2.0),
+00005a30: 2065 6e64 706f 696e 743d 4661 6c73 6529   endpoint=False)
+00005a40: 0a20 2020 2020 2020 203e 3e3e 2073 696e  .        >>> sin
+00005a50: 655f 7761 7665 203d 2031 2e30 202a 206e  e_wave = 1.0 * n
+00005a60: 702e 7369 6e28 3220 2a20 6e70 2e70 6920  p.sin(2 * np.pi 
+00005a70: 2a20 312e 3020 2a20 7429 2e61 7374 7970  * 1.0 * t).astyp
+00005a80: 6528 6e70 2e66 6c6f 6174 3332 290a 2020  e(np.float32).  
+00005a90: 2020 2020 2020 3e3e 3e20 5469 6d65 7365        >>> Timese
+00005aa0: 7269 6573 4665 6174 7572 654d 6978 696e  riesFeatureMixin
+00005ab0: 2829 2e70 6574 726f 7369 616e 5f66 7261  ().petrosian_fra
+00005ac0: 6374 616c 5f64 696d 656e 7369 6f6e 2864  ctal_dimension(d
+00005ad0: 6174 613d 7369 6e65 5f77 6176 6529 0a20  ata=sine_wave). 
+00005ae0: 2020 2020 2020 203e 3e3e 2031 2e30 3030         >>> 1.000
+00005af0: 3033 3938 3138 3730 3232 3731 390a 2020  0398187022719.  
+00005b00: 2020 2020 2020 3e3e 3e20 6e70 2e72 616e        >>> np.ran
+00005b10: 646f 6d2e 7368 7566 666c 6528 7369 6e65  dom.shuffle(sine
+00005b20: 5f77 6176 6529 0a20 2020 2020 2020 203e  _wave).        >
+00005b30: 3e3e 2054 696d 6573 6572 6965 7346 6561  >> TimeseriesFea
+00005b40: 7475 7265 4d69 7869 6e28 292e 7065 7472  tureMixin().petr
+00005b50: 6f73 6961 6e5f 6672 6163 7461 6c5f 6469  osian_fractal_di
+00005b60: 6d65 6e73 696f 6e28 6461 7461 3d73 696e  mension(data=sin
+00005b70: 655f 7761 7665 290a 2020 2020 2020 2020  e_wave).        
+00005b80: 3e3e 3e20 312e 3032 3131 3632 3533 3438  >>> 1.0211625348
+00005b90: 3734 3332 3138 0a20 2020 2020 2020 2022  743218.        "
+00005ba0: 2222 0a0a 2020 2020 2020 2020 6461 7461  ""..        data
+00005bb0: 203d 2028 6461 7461 202d 206e 702e 6d69   = (data - np.mi
+00005bc0: 6e28 6461 7461 2929 202f 2028 6e70 2e6d  n(data)) / (np.m
+00005bd0: 6178 2864 6174 6129 202d 206e 702e 6d69  ax(data) - np.mi
+00005be0: 6e28 6461 7461 2929 0a20 2020 2020 2020  n(data)).       
+00005bf0: 2064 6572 6976 6174 6976 6520 3d20 6461   derivative = da
+00005c00: 7461 5b31 3a5d 202d 2064 6174 615b 3a2d  ta[1:] - data[:-
+00005c10: 315d 0a20 2020 2020 2020 2069 6620 6465  1].        if de
+00005c20: 7269 7661 7469 7665 2e73 6861 7065 5b30  rivative.shape[0
+00005c30: 5d20 3d3d 2030 3a0a 2020 2020 2020 2020  ] == 0:.        
+00005c40: 2020 2020 7265 7475 726e 202d 312e 300a      return -1.0.
+00005c50: 2020 2020 2020 2020 7a43 2c20 6c61 7374          zC, last
+00005c60: 5f76 616c 203d 2030 2c20 2d31 0a20 2020  _val = 0, -1.   
+00005c70: 2020 2020 2069 6620 6465 7269 7661 7469       if derivati
+00005c80: 7665 5b30 5d20 3e20 302e 303a 0a20 2020  ve[0] > 0.0:.   
+00005c90: 2020 2020 2020 2020 206c 6173 745f 7661           last_va
+00005ca0: 6c20 3d20 310a 2020 2020 2020 2020 666f  l = 1.        fo
+00005cb0: 7220 6920 696e 2070 7261 6e67 6528 312c  r i in prange(1,
+00005cc0: 2064 6572 6976 6174 6976 652e 7368 6170   derivative.shap
+00005cd0: 655b 305d 293a 0a20 2020 2020 2020 2020  e[0]):.         
+00005ce0: 2020 2063 7572 7265 6e74 5f76 616c 203d     current_val =
+00005cf0: 202d 310a 2020 2020 2020 2020 2020 2020   -1.            
+00005d00: 6966 2064 6572 6976 6174 6976 655b 695d  if derivative[i]
+00005d10: 203e 2030 2e30 3a0a 2020 2020 2020 2020   > 0.0:.        
+00005d20: 2020 2020 2020 2020 6375 7272 656e 745f          current_
+00005d30: 7661 6c20 3d20 310a 2020 2020 2020 2020  val = 1.        
+00005d40: 2020 2020 6966 206c 6173 745f 7661 6c20      if last_val 
+00005d50: 213d 2063 7572 7265 6e74 5f76 616c 3a0a  != current_val:.
+00005d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005d70: 7a43 202b 3d20 310a 2020 2020 2020 2020  zC += 1.        
+00005d80: 2020 2020 6c61 7374 5f76 616c 203d 2063      last_val = c
+00005d90: 7572 7265 6e74 5f76 616c 0a20 2020 2020  urrent_val.     
+00005da0: 2020 2069 6620 7a43 203d 3d20 303a 0a20     if zC == 0:. 
+00005db0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00005dc0: 6e20 2d31 2e30 0a0a 2020 2020 2020 2020  n -1.0..        
+00005dd0: 7265 7475 726e 206e 702e 6c6f 6731 3028  return np.log10(
+00005de0: 6461 7461 2e73 6861 7065 5b30 5d29 202f  data.shape[0]) /
+00005df0: 2028 0a20 2020 2020 2020 2020 2020 206e   (.            n
+00005e00: 702e 6c6f 6731 3028 6461 7461 2e73 6861  p.log10(data.sha
+00005e10: 7065 5b30 5d29 0a20 2020 2020 2020 2020  pe[0]).         
+00005e20: 2020 202b 206e 702e 6c6f 6731 3028 6461     + np.log10(da
+00005e30: 7461 2e73 6861 7065 5b30 5d20 2f20 2864  ta.shape[0] / (d
+00005e40: 6174 612e 7368 6170 655b 305d 202b 2030  ata.shape[0] + 0
+00005e50: 2e34 202a 207a 4329 290a 2020 2020 2020  .4 * zC)).      
+00005e60: 2020 290a 0a20 2020 2040 7374 6174 6963    )..    @static
+00005e70: 6d65 7468 6f64 0a20 2020 2040 6e6a 6974  method.    @njit
+00005e80: 2822 2866 6c6f 6174 3332 5b3a 5d2c 2066  ("(float32[:], f
+00005e90: 6c6f 6174 3634 5b3a 5d2c 2069 6e74 3634  loat64[:], int64
+00005ea0: 2922 2c20 6661 7374 6d61 7468 3d54 7275  )", fastmath=Tru
+00005eb0: 652c 2063 6163 6865 3d54 7275 6529 0a20  e, cache=True). 
+00005ec0: 2020 2064 6566 2073 6c69 6469 6e67 5f70     def sliding_p
+00005ed0: 6574 726f 7369 616e 5f66 7261 6374 616c  etrosian_fractal
+00005ee0: 5f64 696d 656e 7369 6f6e 280a 2020 2020  _dimension(.    
+00005ef0: 2020 2020 6461 7461 3a20 6e70 2e6e 6461      data: np.nda
+00005f00: 7272 6179 2c20 7769 6e64 6f77 5f73 697a  rray, window_siz
+00005f10: 6573 3a20 6e70 2e6e 6461 7272 6179 2c20  es: np.ndarray, 
+00005f20: 7361 6d70 6c65 5f72 6174 653a 2069 6e74  sample_rate: int
+00005f30: 0a20 2020 2029 202d 3e20 6e70 2e6e 6461  .    ) -> np.nda
+00005f40: 7272 6179 3a0a 2020 2020 2020 2020 2222  rray:.        ""
+00005f50: 220a 2020 2020 2020 2020 4a69 7474 6564  ".        Jitted
+00005f60: 2063 6f6d 7075 7465 206f 6620 5065 7472   compute of Petr
+00005f70: 6f73 6961 6e20 4672 6163 7461 6c20 4469  osian Fractal Di
+00005f80: 6d65 6e73 696f 6e20 6f76 6572 2073 6c69  mension over sli
+00005f90: 6469 6e67 2077 696e 646f 7773 2069 6e20  ding windows in 
+00005fa0: 6120 6461 7461 2061 7272 6179 2e0a 0a20  a data array... 
+00005fb0: 2020 2020 2020 2054 6869 7320 6d65 7468         This meth
+00005fc0: 6f64 2063 6f6d 7075 7465 7320 7468 6520  od computes the 
+00005fd0: 5065 7472 6f73 6961 6e20 4672 6163 7461  Petrosian Fracta
+00005fe0: 6c20 4469 6d65 6e73 696f 6e20 666f 7220  l Dimension for 
+00005ff0: 736c 6964 696e 6720 7769 6e64 6f77 7320  sliding windows 
+00006000: 6f66 2076 6172 7969 6e67 2073 697a 6573  of varying sizes
+00006010: 2061 7070 6c69 6564 0a20 2020 2020 2020   applied.       
+00006020: 2074 6f20 7468 6520 696e 7075 7420 6461   to the input da
+00006030: 7461 2061 7272 6179 2e20 5468 6520 5065  ta array. The Pe
+00006040: 7472 6f73 6961 6e20 4672 6163 7461 6c20  trosian Fractal 
+00006050: 4469 6d65 6e73 696f 6e20 6973 2061 206d  Dimension is a m
+00006060: 6561 7375 7265 206f 6620 7369 676e 616c  easure of signal
+00006070: 2063 6f6d 706c 6578 6974 792e 0a0a 2020   complexity...  
+00006080: 2020 2020 2020 3a70 6172 616d 206e 702e        :param np.
+00006090: 6e64 6172 7261 7920 6461 7461 3a20 496e  ndarray data: In
+000060a0: 7075 7420 6461 7461 2061 7272 6179 2e0a  put data array..
+000060b0: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
+000060c0: 702e 6e64 6172 7261 7920 7769 6e64 6f77  p.ndarray window
+000060d0: 5f73 697a 6573 3a20 4172 7261 7920 6f66  _sizes: Array of
+000060e0: 2077 696e 646f 7720 7369 7a65 7320 2869   window sizes (i
+000060f0: 6e20 7365 636f 6e64 7329 2e0a 2020 2020  n seconds)..    
+00006100: 2020 2020 3a70 6172 616d 2069 6e74 2073      :param int s
+00006110: 616d 706c 655f 7261 7465 3a20 5361 6d70  ample_rate: Samp
+00006120: 6c69 6e67 2072 6174 6520 6f66 2074 6865  ling rate of the
+00006130: 2064 6174 6120 696e 2073 616d 706c 6573   data in samples
+00006140: 2070 6572 2073 6563 6f6e 642e 0a20 2020   per second..   
+00006150: 2020 2020 203a 7265 7475 726e 206e 702e       :return np.
+00006160: 6e64 6172 7261 793a 2041 6e20 6172 7261  ndarray: An arra
+00006170: 7920 636f 6e74 6169 6e69 6e67 2050 6574  y containing Pet
+00006180: 726f 7369 616e 2046 7261 6374 616c 2044  rosian Fractal D
+00006190: 696d 656e 7369 6f6e 2076 616c 7565 7320  imension values 
+000061a0: 666f 7220 6561 6368 2077 696e 646f 7720  for each window 
+000061b0: 7369 7a65 2061 6e64 2064 6174 610a 2020  size and data.  
+000061c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000061d0: 2020 2020 2020 2020 2020 706f 696e 742e            point.
+000061e0: 2054 6865 2073 6861 7065 206f 6620 7468   The shape of th
+000061f0: 6520 7265 7375 6c74 2061 7272 6179 2069  e result array i
+00006200: 7320 2864 6174 612e 7368 6170 655b 305d  s (data.shape[0]
+00006210: 2c20 7769 6e64 6f77 5f73 697a 6573 2e73  , window_sizes.s
+00006220: 6861 7065 5b30 5d29 2e0a 0a20 2020 2020  hape[0])...     
+00006230: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+00006240: 7265 7375 6c74 7320 3d20 6e70 2e66 756c  results = np.ful
+00006250: 6c28 2864 6174 612e 7368 6170 655b 305d  l((data.shape[0]
+00006260: 2c20 7769 6e64 6f77 5f73 697a 6573 2e73  , window_sizes.s
+00006270: 6861 7065 5b30 5d29 2c20 2d31 2e30 290a  hape[0]), -1.0).
+00006280: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+00006290: 2070 7261 6e67 6528 7769 6e64 6f77 5f73   prange(window_s
+000062a0: 697a 6573 2e73 6861 7065 5b30 5d29 3a0a  izes.shape[0]):.
+000062b0: 2020 2020 2020 2020 2020 2020 7769 6e64              wind
+000062c0: 6f77 5f73 697a 6520 3d20 696e 7428 7769  ow_size = int(wi
+000062d0: 6e64 6f77 5f73 697a 6573 5b69 5d20 2a20  ndow_sizes[i] * 
+000062e0: 7361 6d70 6c65 5f72 6174 6529 0a20 2020  sample_rate).   
+000062f0: 2020 2020 2020 2020 2066 6f72 206c 2c20           for l, 
+00006300: 7220 696e 207a 6970 280a 2020 2020 2020  r in zip(.      
+00006310: 2020 2020 2020 2020 2020 7072 616e 6765            prange
+00006320: 2830 2c20 6461 7461 2e73 6861 7065 5b30  (0, data.shape[0
+00006330: 5d20 2b20 3129 2c20 7072 616e 6765 2877  ] + 1), prange(w
+00006340: 696e 646f 775f 7369 7a65 2c20 6461 7461  indow_size, data
+00006350: 2e73 6861 7065 5b30 5d20 2b20 3129 0a20  .shape[0] + 1). 
+00006360: 2020 2020 2020 2020 2020 2029 3a0a 2020             ):.  
+00006370: 2020 2020 2020 2020 2020 2020 2020 7361                sa
+00006380: 6d70 6c65 203d 2028 6461 7461 5b6c 3a72  mple = (data[l:r
+00006390: 5d20 2d20 6e70 2e6d 696e 2864 6174 615b  ] - np.min(data[
+000063a0: 6c3a 725d 2929 202f 2028 0a20 2020 2020  l:r])) / (.     
+000063b0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+000063c0: 702e 6d61 7828 6461 7461 5b6c 3a72 5d29  p.max(data[l:r])
+000063d0: 202d 206e 702e 6d69 6e28 6461 7461 5b6c   - np.min(data[l
+000063e0: 3a72 5d29 0a20 2020 2020 2020 2020 2020  :r]).           
+000063f0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00006400: 2020 2020 2020 2064 6572 6976 6174 6976         derivativ
+00006410: 6520 3d20 7361 6d70 6c65 5b31 3a5d 202d  e = sample[1:] -
+00006420: 2073 616d 706c 655b 3a2d 315d 0a20 2020   sample[:-1].   
+00006430: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00006440: 6465 7269 7661 7469 7665 2e73 6861 7065  derivative.shape
+00006450: 5b30 5d20 3d3d 2030 3a0a 2020 2020 2020  [0] == 0:.      
+00006460: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00006470: 7375 6c74 735b 7220 2d20 312c 2069 5d20  sults[r - 1, i] 
+00006480: 3d20 2d31 2e30 0a20 2020 2020 2020 2020  = -1.0.         
+00006490: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000064a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000064b0: 207a 432c 206c 6173 745f 7661 6c20 3d20   zC, last_val = 
+000064c0: 302c 202d 310a 2020 2020 2020 2020 2020  0, -1.          
+000064d0: 2020 2020 2020 2020 2020 6966 2064 6572            if der
+000064e0: 6976 6174 6976 655b 305d 203e 2030 2e30  ivative[0] > 0.0
+000064f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00006500: 2020 2020 2020 2020 2020 6c61 7374 5f76            last_v
+00006510: 616c 203d 2031 0a20 2020 2020 2020 2020  al = 1.         
+00006520: 2020 2020 2020 2020 2020 2066 6f72 206a             for j
+00006530: 2069 6e20 7072 616e 6765 2831 2c20 6465   in prange(1, de
+00006540: 7269 7661 7469 7665 2e73 6861 7065 5b30  rivative.shape[0
+00006550: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
+00006560: 2020 2020 2020 2020 2020 2020 6375 7272              curr
+00006570: 656e 745f 7661 6c20 3d20 2d31 0a20 2020  ent_val = -1.   
+00006580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006590: 2020 2020 2069 6620 6465 7269 7661 7469       if derivati
+000065a0: 7665 5b6a 5d20 3e20 302e 303a 0a20 2020  ve[j] > 0.0:.   
+000065b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000065c0: 2020 2020 2020 2020 2063 7572 7265 6e74           current
+000065d0: 5f76 616c 203d 2031 0a20 2020 2020 2020  _val = 1.       
+000065e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000065f0: 2069 6620 6c61 7374 5f76 616c 2021 3d20   if last_val != 
+00006600: 6375 7272 656e 745f 7661 6c3a 0a20 2020  current_val:.   
+00006610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006620: 2020 2020 2020 2020 207a 4320 2b3d 2031           zC += 1
+00006630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006640: 2020 2020 2020 2020 206c 6173 745f 7661           last_va
+00006650: 6c20 3d20 6375 7272 656e 745f 7661 6c0a  l = current_val.
+00006660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006670: 2020 2020 6966 207a 4320 3d3d 2030 3a0a      if zC == 0:.
+00006680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006690: 2020 2020 2020 2020 7265 7375 6c74 735b          results[
+000066a0: 7220 2d20 312c 2069 5d20 3d20 2d31 2e30  r - 1, i] = -1.0
+000066b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000066c0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+000066d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000066e0: 2020 2072 6573 756c 7473 5b72 202d 2031     results[r - 1
+000066f0: 2c20 695d 203d 206e 702e 6c6f 6731 3028  , i] = np.log10(
+00006700: 7361 6d70 6c65 2e73 6861 7065 5b30 5d29  sample.shape[0])
+00006710: 202f 2028 0a20 2020 2020 2020 2020 2020   / (.           
+00006720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006730: 206e 702e 6c6f 6731 3028 7361 6d70 6c65   np.log10(sample
+00006740: 2e73 6861 7065 5b30 5d29 0a20 2020 2020  .shape[0]).     
+00006750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006760: 2020 2020 2020 202b 206e 702e 6c6f 6731         + np.log1
+00006770: 3028 7361 6d70 6c65 2e73 6861 7065 5b30  0(sample.shape[0
+00006780: 5d20 2f20 2873 616d 706c 652e 7368 6170  ] / (sample.shap
+00006790: 655b 305d 202b 2030 2e34 202a 207a 4329  e[0] + 0.4 * zC)
+000067a0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000067b0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+000067c0: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
+000067d0: 6c74 732e 6173 7479 7065 286e 702e 666c  lts.astype(np.fl
+000067e0: 6f61 7433 3229 0a0a 2020 2020 4073 7461  oat32)..    @sta
+000067f0: 7469 636d 6574 686f 640a 2020 2020 406e  ticmethod.    @n
+00006800: 6a69 7428 2228 666c 6f61 7433 325b 3a5d  jit("(float32[:]
+00006810: 2c20 696e 7436 3429 2229 0a20 2020 2064  , int64)").    d
+00006820: 6566 2068 6967 7563 6869 5f66 7261 6374  ef higuchi_fract
+00006830: 616c 5f64 696d 656e 7369 6f6e 2864 6174  al_dimension(dat
+00006840: 613a 206e 702e 6e64 6172 7261 792c 206b  a: np.ndarray, k
+00006850: 6d61 783a 2069 6e74 203d 2031 3029 3a0a  max: int = 10):.
+00006860: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00006870: 2020 2020 4a69 7474 6564 2063 6f6d 7075      Jitted compu
+00006880: 7465 206f 6620 7468 6520 4869 6775 6368  te of the Higuch
+00006890: 6920 4672 6163 7461 6c20 4469 6d65 6e73  i Fractal Dimens
+000068a0: 696f 6e20 6f66 2061 2067 6976 656e 2074  ion of a given t
+000068b0: 696d 6520 7365 7269 6573 2064 6174 612e  ime series data.
+000068c0: 2054 6865 2048 6967 7563 6869 2046 7261   The Higuchi Fra
+000068d0: 6374 616c 2044 696d 656e 7369 6f6e 2070  ctal Dimension p
+000068e0: 726f 7669 6465 7320 6120 6d65 6173 7572  rovides a measur
+000068f0: 6520 6f66 2074 6865 2066 7261 6374 616c  e of the fractal
+00006900: 0a20 2020 2020 2020 2063 6f6d 706c 6578  .        complex
+00006910: 6974 7920 6f66 2061 2074 696d 6520 7365  ity of a time se
+00006920: 7269 6573 2e0a 0a20 2020 2020 2020 2054  ries...        T
+00006930: 6865 206d 6178 696d 756d 2076 616c 7565  he maximum value
+00006940: 206f 6620 6b20 7573 6564 2069 6e20 7468   of k used in th
+00006950: 6520 6361 6c63 756c 6174 696f 6e2e 2049  e calculation. I
+00006960: 6e63 7265 6173 696e 6720 6b6d 6178 2063  ncreasing kmax c
+00006970: 6f6e 7369 6465 7273 206c 6f6e 6765 7220  onsiders longer 
+00006980: 7365 7175 656e 6365 730a 2020 2020 2020  sequences.      
+00006990: 2020 2020 2020 6f66 2064 6174 612c 2070        of data, p
+000069a0: 726f 7669 6469 6e67 2061 206d 6f72 6520  roviding a more 
+000069b0: 6465 7461 696c 6564 2061 6e61 6c79 7369  detailed analysi
+000069c0: 7320 6f66 2066 7261 6374 616c 2063 6f6d  s of fractal com
+000069d0: 706c 6578 6974 792e 2044 6566 6175 6c74  plexity. Default
+000069e0: 2069 7320 3130 2e0a 0a20 2020 2020 2020   is 10...       
+000069f0: 203a 7061 7261 6d65 7465 7220 6e70 2e6e   :parameter np.n
+00006a00: 6461 7272 6179 2064 6174 613a 2041 2031  darray data: A 1
+00006a10: 2d64 696d 656e 7369 6f6e 616c 206e 756d  -dimensional num
+00006a20: 7079 2061 7272 6179 2063 6f6e 7461 696e  py array contain
+00006a30: 696e 6720 7468 6520 7469 6d65 2073 6572  ing the time ser
+00006a40: 6965 7320 6461 7461 2e0a 2020 2020 2020  ies data..      
+00006a50: 2020 3a70 6172 616d 6574 6572 2069 6e74    :parameter int
+00006a60: 206b 6d61 783a 2054 6865 206d 6178 696d   kmax: The maxim
+00006a70: 756d 2076 616c 7565 206f 6620 6b20 7573  um value of k us
+00006a80: 6564 2069 6e20 7468 6520 6361 6c63 756c  ed in the calcul
+00006a90: 6174 696f 6e2e 2049 6e63 7265 6173 696e  ation. Increasin
+00006aa0: 6720 6b6d 6178 2063 6f6e 7369 6465 7273  g kmax considers
+00006ab0: 206c 6f6e 6765 7220 7365 7175 656e 6365   longer sequence
+00006ac0: 7320 6f66 2064 6174 612c 2070 726f 7669  s of data, provi
+00006ad0: 6469 6e67 2061 206d 6f72 6520 6465 7461  ding a more deta
+00006ae0: 696c 6564 2061 6e61 6c79 7369 7320 6f66  iled analysis of
+00006af0: 2066 7261 6374 616c 2063 6f6d 706c 6578   fractal complex
+00006b00: 6974 792e 2044 6566 6175 6c74 2069 7320  ity. Default is 
+00006b10: 3130 2e0a 2020 2020 2020 2020 3a72 6574  10..        :ret
+00006b20: 7572 6e73 2066 6c6f 6174 3a20 5468 6520  urns float: The 
+00006b30: 4869 6775 6368 6920 4672 6163 7461 6c20  Higuchi Fractal 
+00006b40: 4469 6d65 6e73 696f 6e20 6f66 2074 6865  Dimension of the
+00006b50: 2069 6e70 7574 2074 696d 6520 7365 7269   input time seri
+00006b60: 6573 2e0a 0a20 2020 2020 2020 202e 2e20  es...        .. 
+00006b70: 6e6f 7465 3a3a 0a20 2020 2020 2020 2020  note::.         
+00006b80: 2020 2d20 4164 6170 7465 6420 6672 6f6d    - Adapted from
+00006b90: 2060 6565 676c 6962 203c 6874 7470 733a   `eeglib <https:
+00006ba0: 2f2f 6769 7468 7562 2e63 6f6d 2f58 6975  //github.com/Xiu
+00006bb0: 6c31 3039 2f65 6567 6c69 622f 3e60 5f2e  l109/eeglib/>`_.
+00006bc0: 0a0a 2020 2020 2020 2020 2e2e 206d 6174  ..        .. mat
+00006bd0: 683a 3a0a 2020 2020 2020 2020 2020 2048  h::.           H
+00006be0: 4644 203d 205c 5c66 7261 637b 5c5c 6c6f  FD = \\frac{\\lo
+00006bf0: 6728 4e29 7d7b 5c5c 6c6f 6728 4e29 202b  g(N)}{\\log(N) +
+00006c00: 205c 5c6c 6f67 5c5c 6c65 6674 285c 5c66   \\log\\left(\\f
+00006c10: 7261 637b 4e7d 7b4e 202b 2030 2e34 205c  rac{N}{N + 0.4 \
+00006c20: 5c63 646f 7420 7a43 7d5c 5c72 6967 6874  \cdot zC}\\right
+00006c30: 297d 0a0a 2020 2020 2020 2020 3a65 7861  )}..        :exa
+00006c40: 6d70 6c65 3a0a 2020 2020 2020 2020 3e3e  mple:.        >>
+00006c50: 3e20 7420 3d20 6e70 2e6c 696e 7370 6163  > t = np.linspac
+00006c60: 6528 302c 2035 302c 2069 6e74 2834 3431  e(0, 50, int(441
+00006c70: 3030 202a 2032 2e30 292c 2065 6e64 706f  00 * 2.0), endpo
+00006c80: 696e 743d 4661 6c73 6529 0a20 2020 2020  int=False).     
+00006c90: 2020 203e 3e3e 2073 696e 655f 7761 7665     >>> sine_wave
+00006ca0: 203d 2031 2e30 202a 206e 702e 7369 6e28   = 1.0 * np.sin(
+00006cb0: 3220 2a20 6e70 2e70 6920 2a20 312e 3020  2 * np.pi * 1.0 
+00006cc0: 2a20 7429 2e61 7374 7970 6528 6e70 2e66  * t).astype(np.f
+00006cd0: 6c6f 6174 3332 290a 2020 2020 2020 2020  loat32).        
+00006ce0: 3e3e 3e20 7369 6e65 5f77 6176 6520 3d20  >>> sine_wave = 
+00006cf0: 2873 696e 655f 7761 7665 202d 206e 702e  (sine_wave - np.
+00006d00: 6d69 6e28 7369 6e65 5f77 6176 6529 2920  min(sine_wave)) 
+00006d10: 2f20 286e 702e 6d61 7828 7369 6e65 5f77  / (np.max(sine_w
+00006d20: 6176 6529 202d 206e 702e 6d69 6e28 7369  ave) - np.min(si
+00006d30: 6e65 5f77 6176 6529 290a 2020 2020 2020  ne_wave)).      
+00006d40: 2020 3e3e 3e20 5469 6d65 7365 7269 6573    >>> Timeseries
+00006d50: 4665 6174 7572 654d 6978 696e 2829 2e68  FeatureMixin().h
+00006d60: 6967 7563 6869 5f66 7261 6374 616c 5f64  iguchi_fractal_d
+00006d70: 696d 656e 7369 6f6e 2864 6174 613d 6461  imension(data=da
+00006d80: 7461 2c20 6b6d 6178 3d31 3029 0a20 2020  ta, kmax=10).   
+00006d90: 2020 2020 203e 3e3e 2031 2e30 3030 3135       >>> 1.00015
+00006da0: 3036 3830 3534 3139 3932 320a 2020 2020  06805419922.    
+00006db0: 2020 2020 3e3e 3e20 6e70 2e72 616e 646f      >>> np.rando
+00006dc0: 6d2e 7368 7566 666c 6528 7369 6e65 5f77  m.shuffle(sine_w
+00006dd0: 6176 6529 0a20 2020 2020 2020 203e 3e3e  ave).        >>>
+00006de0: 2054 696d 6573 6572 6965 7346 6561 7475   TimeseriesFeatu
+00006df0: 7265 4d69 7869 6e28 292e 6869 6775 6368  reMixin().higuch
+00006e00: 695f 6672 6163 7461 6c5f 6469 6d65 6e73  i_fractal_dimens
+00006e10: 696f 6e28 6461 7461 3d64 6174 612c 206b  ion(data=data, k
+00006e20: 6d61 783d 3130 290a 2020 2020 2020 2020  max=10).        
+00006e30: 3e3e 3e20 312e 3939 3936 3430 3232 3633  >>> 1.9996402263
+00006e40: 3634 3133 3537 0a20 2020 2020 2020 2022  641357.        "
+00006e50: 2222 0a0a 2020 2020 2020 2020 4c2c 204e  ""..        L, N
+00006e60: 203d 206e 702e 7a65 726f 7328 6b6d 6178   = np.zeros(kmax
+00006e70: 202d 2031 292c 206c 656e 2864 6174 6129   - 1), len(data)
+00006e80: 0a20 2020 2020 2020 2078 203d 206e 702e  .        x = np.
+00006e90: 6873 7461 636b 280a 2020 2020 2020 2020  hstack(.        
+00006ea0: 2020 2020 280a 2020 2020 2020 2020 2020      (.          
+00006eb0: 2020 2020 2020 2d6e 702e 6c6f 6728 6e70        -np.log(np
+00006ec0: 2e61 7261 6e67 6528 322c 206b 6d61 7820  .arange(2, kmax 
+00006ed0: 2b20 3129 292e 7265 7368 6170 6528 2d31  + 1)).reshape(-1
+00006ee0: 2c20 3129 2e61 7374 7970 6528 6e70 2e66  , 1).astype(np.f
+00006ef0: 6c6f 6174 3332 292c 0a20 2020 2020 2020  loat32),.       
+00006f00: 2020 2020 2020 2020 206e 702e 6f6e 6573           np.ones
+00006f10: 286b 6d61 7820 2d20 3129 2e72 6573 6861  (kmax - 1).resha
+00006f20: 7065 282d 312c 2031 292e 6173 7479 7065  pe(-1, 1).astype
+00006f30: 286e 702e 666c 6f61 7433 3229 2c0a 2020  (np.float32),.  
+00006f40: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00006f50: 2020 2020 290a 2020 2020 2020 2020 666f      ).        fo
+00006f60: 7220 6b20 696e 2070 7261 6e67 6528 322c  r k in prange(2,
+00006f70: 206b 6d61 7820 2b20 3129 3a0a 2020 2020   kmax + 1):.    
+00006f80: 2020 2020 2020 2020 4c6b 203d 206e 702e          Lk = np.
+00006f90: 7a65 726f 7328 6b29 0a20 2020 2020 2020  zeros(k).       
+00006fa0: 2020 2020 2066 6f72 206d 2069 6e20 7261       for m in ra
+00006fb0: 6e67 6528 302c 206b 293a 0a20 2020 2020  nge(0, k):.     
+00006fc0: 2020 2020 2020 2020 2020 204c 6d6b 203d             Lmk =
+00006fd0: 2030 0a20 2020 2020 2020 2020 2020 2020   0.             
+00006fe0: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+00006ff0: 6528 312c 2028 4e20 2d20 6d29 202f 2f20  e(1, (N - m) // 
+00007000: 6b29 3a0a 2020 2020 2020 2020 2020 2020  k):.            
+00007010: 2020 2020 2020 2020 4c6d 6b20 2b3d 2061          Lmk += a
+00007020: 6273 2864 6174 615b 6d20 2b20 6920 2a20  bs(data[m + i * 
+00007030: 6b5d 202d 2064 6174 615b 6d20 2b20 6920  k] - data[m + i 
+00007040: 2a20 6b20 2d20 6b5d 290a 2020 2020 2020  * k - k]).      
+00007050: 2020 2020 2020 2020 2020 6465 6e6f 6d69            denomi
+00007060: 6e61 746f 7220 3d20 2828 4e20 2d20 6d29  nator = ((N - m)
+00007070: 202f 2f20 6b29 202a 206b 202a 206b 0a20   // k) * k * k. 
+00007080: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00007090: 6620 6465 6e6f 6d69 6e61 746f 7220 3d3d  f denominator ==
+000070a0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+000070b0: 2020 2020 2020 2020 7265 7475 726e 202d          return -
+000070c0: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
+000070d0: 2020 4c6b 5b6d 5d20 3d20 4c6d 6b20 2a20    Lk[m] = Lmk * 
+000070e0: 284e 202d 2031 2920 2f20 2828 284e 202d  (N - 1) / (((N -
+000070f0: 206d 2920 2f2f 206b 2920 2a20 6b20 2a20   m) // k) * k * 
+00007100: 6b29 0a20 2020 2020 2020 2020 2020 204c  k).            L
+00007110: 6175 7820 3d20 6e70 2e6d 6561 6e28 4c6b  aux = np.mean(Lk
+00007120: 290a 2020 2020 2020 2020 2020 2020 4c61  ).            La
+00007130: 7578 203d 2030 2e30 3120 2f20 6b20 6966  ux = 0.01 / k if
+00007140: 204c 6175 7820 3d3d 2030 2065 6c73 6520   Laux == 0 else 
+00007150: 4c61 7578 0a20 2020 2020 2020 2020 2020  Laux.           
+00007160: 204c 5b6b 202d 2032 5d20 3d20 6e70 2e6c   L[k - 2] = np.l
+00007170: 6f67 284c 6175 7829 0a0a 2020 2020 2020  og(Laux)..      
+00007180: 2020 7265 7475 726e 206e 702e 6c69 6e61    return np.lina
+00007190: 6c67 2e6c 7374 7371 2878 2c20 4c2e 6173  lg.lstsq(x, L.as
+000071a0: 7479 7065 286e 702e 666c 6f61 7433 3229  type(np.float32)
+000071b0: 295b 305d 5b30 5d0a 0a20 2020 2040 7374  )[0][0]..    @st
+000071c0: 6174 6963 6d65 7468 6f64 0a20 2020 2040  aticmethod.    @
+000071d0: 6e6a 6974 2822 2866 6c6f 6174 3332 5b3a  njit("(float32[:
+000071e0: 5d2c 2069 6e74 3634 2c20 696e 7436 342c  ], int64, int64,
+000071f0: 2922 2c20 6661 7374 6d61 7468 3d54 7275  )", fastmath=Tru
+00007200: 6529 0a20 2020 2064 6566 2070 6572 6d75  e).    def permu
+00007210: 7461 7469 6f6e 5f65 6e74 726f 7079 2864  tation_entropy(d
+00007220: 6174 613a 206e 702e 6e64 6172 7261 792c  ata: np.ndarray,
+00007230: 2064 696d 656e 7369 6f6e 3a20 696e 742c   dimension: int,
+00007240: 2064 656c 6179 3a20 696e 7429 202d 3e20   delay: int) -> 
+00007250: 666c 6f61 743a 0a20 2020 2020 2020 2022  float:.        "
+00007260: 2222 0a20 2020 2020 2020 2043 616c 6375  "".        Calcu
+00007270: 6c61 7465 2074 6865 2070 6572 6d75 7461  late the permuta
+00007280: 7469 6f6e 2065 6e74 726f 7079 206f 6620  tion entropy of 
+00007290: 6120 7469 6d65 2073 6572 6965 732e 0a0a  a time series...
+000072a0: 2020 2020 2020 2020 5065 726d 7574 6174          Permutat
+000072b0: 696f 6e20 656e 7472 6f70 7920 6973 2061  ion entropy is a
+000072c0: 206d 6561 7375 7265 206f 6620 7468 6520   measure of the 
+000072d0: 636f 6d70 6c65 7869 7479 206f 6620 6120  complexity of a 
+000072e0: 7469 6d65 2073 6572 6965 7320 6461 7461  time series data
+000072f0: 2062 7920 7175 616e 7469 6679 696e 670a   by quantifying.
+00007300: 2020 2020 2020 2020 7468 6520 6972 7265          the irre
+00007310: 6775 6c61 7269 7479 2061 6e64 2075 6e70  gularity and unp
+00007320: 7265 6469 6374 6162 696c 6974 7920 6f66  redictability of
+00007330: 2069 7473 206f 7264 6572 2070 6174 7465   its order patte
+00007340: 726e 732e 2049 7420 6973 2063 6f6d 7075  rns. It is compu
+00007350: 7465 6420 6261 7365 6420 6f6e 2074 6865  ted based on the
+00007360: 0a20 2020 2020 2020 2066 7265 7175 656e  .        frequen
+00007370: 6379 206f 6620 756e 6971 7565 206f 7264  cy of unique ord
+00007380: 6572 2070 6174 7465 726e 7320 6f66 2061  er patterns of a
+00007390: 2067 6976 656e 2064 696d 656e 7369 6f6e   given dimension
+000073a0: 2069 6e20 7468 6520 7469 6d65 2073 6572   in the time ser
+000073b0: 6965 7320 6461 7461 2e0a 0a20 2020 2020  ies data...     
+000073c0: 2020 2054 6865 2070 6572 6d75 7461 7469     The permutati
+000073d0: 6f6e 2065 6e74 726f 7079 2028 5045 2920  on entropy (PE) 
+000073e0: 6973 2063 616c 6375 6c61 7465 6420 7573  is calculated us
+000073f0: 696e 6720 7468 6520 666f 6c6c 6f77 696e  ing the followin
+00007400: 6720 666f 726d 756c 613a 0a0a 2020 2020  g formula:..    
+00007410: 2020 2020 2e2e 206d 6174 683a 3a0a 2020      .. math::.  
+00007420: 2020 2020 2020 2020 2020 5045 203d 202d            PE = -
+00007430: 205c 5c73 756d 2870 5f69 205c 5c6c 6f67   \\sum(p_i \\log
+00007440: 2870 5f69 2929 0a0a 2020 2020 2020 2020  (p_i))..        
+00007450: 7768 6572 653a 0a20 2020 2020 2020 202d  where:.        -
+00007460: 2050 4520 6973 2074 6865 2070 6572 6d75   PE is the permu
+00007470: 7461 7469 6f6e 2065 6e74 726f 7079 2e0a  tation entropy..
+00007480: 2020 2020 2020 2020 2d20 705f 6920 6973          - p_i is
+00007490: 2074 6865 2070 726f 6261 6269 6c69 7479   the probability
+000074a0: 206f 6620 6561 6368 2075 6e69 7175 6520   of each unique 
+000074b0: 6f72 6465 7220 7061 7474 6572 6e2e 0a0a  order pattern...
+000074c0: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
+000074d0: 756d 7079 2e6e 6461 7272 6179 2064 6174  umpy.ndarray dat
+000074e0: 613a 2054 6865 2074 696d 6520 7365 7269  a: The time seri
+000074f0: 6573 2064 6174 6120 666f 7220 7768 6963  es data for whic
+00007500: 6820 7065 726d 7574 6174 696f 6e20 656e  h permutation en
+00007510: 7472 6f70 7920 6973 2063 616c 6375 6c61  tropy is calcula
+00007520: 7465 642e 0a20 2020 2020 2020 203a 7061  ted..        :pa
+00007530: 7261 6d20 696e 7420 6469 6d65 6e73 696f  ram int dimensio
+00007540: 6e3a 2049 7420 7370 6563 6966 6965 7320  n: It specifies 
+00007550: 7468 6520 6c65 6e67 7468 206f 6620 7468  the length of th
+00007560: 6520 6f72 6465 7220 7061 7474 6572 6e73  e order patterns
+00007570: 2074 6f20 6265 2063 6f6e 7369 6465 7265   to be considere
+00007580: 642e 0a20 2020 2020 2020 203a 7061 7261  d..        :para
+00007590: 6d20 696e 7420 6465 6c61 793a 2054 696d  m int delay: Tim
+000075a0: 6520 6465 6c61 7920 6265 7477 6565 6e20  e delay between 
+000075b0: 656c 656d 656e 7473 2069 6e20 616e 206f  elements in an o
+000075c0: 7264 6572 2070 6174 7465 726e 2e0a 2020  rder pattern..  
+000075d0: 2020 2020 2020 3a72 6574 7572 6e20 666c        :return fl
+000075e0: 6f61 743a 2054 6865 2070 6572 6d75 7461  oat: The permuta
+000075f0: 7469 6f6e 2065 6e74 726f 7079 206f 6620  tion entropy of 
+00007600: 7468 6520 7469 6d65 2073 6572 6965 732c  the time series,
+00007610: 2069 6e64 6963 6174 696e 6720 6974 7320   indicating its 
+00007620: 636f 6d70 6c65 7869 7479 2061 6e64 2070  complexity and p
+00007630: 7265 6469 6374 6162 696c 6974 792e 2041  redictability. A
+00007640: 2068 6967 6865 7220 7065 726d 7574 6174   higher permutat
+00007650: 696f 6e20 656e 7472 6f70 7920 7661 6c75  ion entropy valu
+00007660: 6520 696e 6469 6361 7465 7320 6869 6768  e indicates high
+00007670: 6572 2063 6f6d 706c 6578 6974 7920 616e  er complexity an
+00007680: 6420 756e 7072 6564 6963 7461 6269 6c69  d unpredictabili
+00007690: 7479 2069 6e20 7468 6520 7469 6d65 2073  ty in the time s
+000076a0: 6572 6965 732e 0a0a 2020 2020 2020 2020  eries...        
+000076b0: 3a65 7861 6d70 6c65 3a0a 2020 2020 2020  :example:.      
+000076c0: 2020 3e3e 3e20 7420 3d20 6e70 2e6c 696e    >>> t = np.lin
+000076d0: 7370 6163 6528 302c 2035 302c 2069 6e74  space(0, 50, int
+000076e0: 2834 3431 3030 202a 2032 2e30 292c 2065  (44100 * 2.0), e
+000076f0: 6e64 706f 696e 743d 4661 6c73 6529 0a20  ndpoint=False). 
+00007700: 2020 2020 2020 203e 3e3e 2073 696e 655f         >>> sine_
+00007710: 7761 7665 203d 2031 2e30 202a 206e 702e  wave = 1.0 * np.
+00007720: 7369 6e28 3220 2a20 6e70 2e70 6920 2a20  sin(2 * np.pi * 
+00007730: 312e 3020 2a20 7429 2e61 7374 7970 6528  1.0 * t).astype(
+00007740: 6e70 2e66 6c6f 6174 3332 290a 2020 2020  np.float32).    
+00007750: 2020 2020 3e3e 3e20 5469 6d65 7365 7269      >>> Timeseri
+00007760: 6573 4665 6174 7572 654d 6978 696e 2829  esFeatureMixin()
+00007770: 2e70 6572 6d75 7461 7469 6f6e 5f65 6e74  .permutation_ent
+00007780: 726f 7079 2864 6174 613d 7369 6e65 5f77  ropy(data=sine_w
+00007790: 6176 652c 2064 696d 656e 7369 6f6e 3d33  ave, dimension=3
+000077a0: 2c20 6465 6c61 793d 3129 0a20 2020 2020  , delay=1).     
+000077b0: 2020 203e 3e3e 2030 2e37 3031 3937 3030     >>> 0.7019700
+000077c0: 3538 3636 3634 3037 0a20 2020 2020 2020  58666407.       
+000077d0: 203e 3e3e 206e 702e 7261 6e64 6f6d 2e73   >>> np.random.s
+000077e0: 6875 6666 6c65 2873 696e 655f 7761 7665  huffle(sine_wave
+000077f0: 290a 2020 2020 2020 2020 3e3e 3e20 5469  ).        >>> Ti
+00007800: 6d65 7365 7269 6573 4665 6174 7572 654d  meseriesFeatureM
+00007810: 6978 696e 2829 2e70 6572 6d75 7461 7469  ixin().permutati
+00007820: 6f6e 5f65 6e74 726f 7079 2864 6174 613d  on_entropy(data=
+00007830: 7369 6e65 5f77 6176 652c 2064 696d 656e  sine_wave, dimen
+00007840: 7369 6f6e 3d33 2c20 6465 6c61 793d 3129  sion=3, delay=1)
+00007850: 0a20 2020 2020 2020 203e 3e3e 2031 2e37  .        >>> 1.7
+00007860: 3931 3732 3434 3939 3334 3630 340a 2020  9172449934604.  
+00007870: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+00007880: 2020 206e 2c20 7065 726d 7574 6174 696f     n, permutatio
+00007890: 6e73 2c20 636f 756e 7473 203d 206c 656e  ns, counts = len
+000078a0: 2864 6174 6129 2c20 4c69 7374 2829 2c20  (data), List(), 
+000078b0: 4c69 7374 2829 0a20 2020 2020 2020 2066  List().        f
+000078c0: 6f72 2069 2069 6e20 7072 616e 6765 286e  or i in prange(n
+000078d0: 202d 2028 6469 6d65 6e73 696f 6e20 2d20   - (dimension - 
+000078e0: 3129 202a 2064 656c 6179 293a 0a20 2020  1) * delay):.   
+000078f0: 2020 2020 2020 2020 2069 6e64 6963 6573           indices
+00007900: 203d 206e 702e 6172 616e 6765 2869 2c20   = np.arange(i, 
+00007910: 6920 2b20 6469 6d65 6e73 696f 6e20 2a20  i + dimension * 
+00007920: 6465 6c61 792c 2064 656c 6179 290a 2020  delay, delay).  
+00007930: 2020 2020 2020 2020 2020 7065 726d 7574            permut
+00007940: 6174 696f 6e20 3d20 4c69 7374 286e 702e  ation = List(np.
+00007950: 6172 6773 6f72 7428 6461 7461 5b69 6e64  argsort(data[ind
+00007960: 6963 6573 5d29 290a 2020 2020 2020 2020  ices])).        
+00007970: 2020 2020 6973 5f75 6e69 7175 6520 3d20      is_unique = 
+00007980: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
+00007990: 2066 6f72 206a 2069 6e20 7261 6e67 6528   for j in range(
+000079a0: 6c65 6e28 7065 726d 7574 6174 696f 6e73  len(permutations
+000079b0: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
+000079c0: 2020 2020 7020 3d20 7065 726d 7574 6174      p = permutat
+000079d0: 696f 6e73 5b6a 5d0a 2020 2020 2020 2020  ions[j].        
+000079e0: 2020 2020 2020 2020 6966 206c 656e 2870          if len(p
+000079f0: 2920 3d3d 206c 656e 2870 6572 6d75 7461  ) == len(permuta
+00007a00: 7469 6f6e 293a 0a20 2020 2020 2020 2020  tion):.         
+00007a10: 2020 2020 2020 2020 2020 2069 735f 6571             is_eq
+00007a20: 7561 6c20 3d20 5472 7565 0a20 2020 2020  ual = True.     
+00007a30: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00007a40: 6f72 206b 2069 6e20 7261 6e67 6528 6c65  or k in range(le
+00007a50: 6e28 7029 293a 0a20 2020 2020 2020 2020  n(p)):.         
+00007a60: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00007a70: 6620 705b 6b5d 2021 3d20 7065 726d 7574  f p[k] != permut
+00007a80: 6174 696f 6e5b 6b5d 3a0a 2020 2020 2020  ation[k]:.      
+00007a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007aa0: 2020 2020 2020 6973 5f65 7175 616c 203d        is_equal =
+00007ab0: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
+00007ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007ad0: 2020 2062 7265 616b 0a20 2020 2020 2020     break.       
+00007ae0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00007af0: 6973 5f65 7175 616c 3a0a 2020 2020 2020  is_equal:.      
+00007b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007b10: 2020 6973 5f75 6e69 7175 6520 3d20 4661    is_unique = Fa
+00007b20: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
+00007b30: 2020 2020 2020 2020 2020 2020 636f 756e              coun
+00007b40: 7473 5b6a 5d20 2b3d 2031 0a20 2020 2020  ts[j] += 1.     
+00007b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007b60: 2020 2062 7265 616b 0a20 2020 2020 2020     break.       
+00007b70: 2020 2020 2069 6620 6973 5f75 6e69 7175       if is_uniqu
+00007b80: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00007b90: 2020 2070 6572 6d75 7461 7469 6f6e 732e     permutations.
+00007ba0: 6170 7065 6e64 2870 6572 6d75 7461 7469  append(permutati
+00007bb0: 6f6e 290a 2020 2020 2020 2020 2020 2020  on).            
+00007bc0: 2020 2020 636f 756e 7473 2e61 7070 656e      counts.appen
+00007bd0: 6428 3129 0a0a 2020 2020 2020 2020 746f  d(1)..        to
+00007be0: 7461 6c5f 7065 726d 7574 6174 696f 6e73  tal_permutations
+00007bf0: 203d 206c 656e 2870 6572 6d75 7461 7469   = len(permutati
+00007c00: 6f6e 7329 0a20 2020 2020 2020 2070 726f  ons).        pro
+00007c10: 6273 203d 206e 702e 656d 7074 7928 746f  bs = np.empty(to
+00007c20: 7461 6c5f 7065 726d 7574 6174 696f 6e73  tal_permutations
+00007c30: 2c20 6474 7970 653d 7479 7065 732e 666c  , dtype=types.fl
+00007c40: 6f61 7436 3429 0a20 2020 2020 2020 2066  oat64).        f
+00007c50: 6f72 2069 2069 6e20 7072 616e 6765 2874  or i in prange(t
+00007c60: 6f74 616c 5f70 6572 6d75 7461 7469 6f6e  otal_permutation
+00007c70: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+00007c80: 7072 6f62 735b 695d 203d 2063 6f75 6e74  probs[i] = count
+00007c90: 735b 695d 202f 2028 6e20 2d20 2864 696d  s[i] / (n - (dim
+00007ca0: 656e 7369 6f6e 202d 2031 2920 2a20 6465  ension - 1) * de
+00007cb0: 6c61 7929 0a0a 2020 2020 2020 2020 7265  lay)..        re
+00007cc0: 7475 726e 202d 6e70 2e73 756d 2870 726f  turn -np.sum(pro
+00007cd0: 6273 202a 206e 702e 6c6f 6728 7072 6f62  bs * np.log(prob
+00007ce0: 7329 290a 0a20 2020 2040 7374 6174 6963  s))..    @static
+00007cf0: 6d65 7468 6f64 0a20 2020 2040 6e6a 6974  method.    @njit
+00007d00: 2822 2866 6c6f 6174 3332 5b3a 5d2c 2922  ("(float32[:],)"
+00007d10: 2c20 6661 7374 6d61 7468 3d54 7275 6529  , fastmath=True)
+00007d20: 0a20 2020 2064 6566 206c 696e 655f 6c65  .    def line_le
+00007d30: 6e67 7468 2864 6174 613a 206e 702e 6e64  ngth(data: np.nd
+00007d40: 6172 7261 7929 202d 3e20 666c 6f61 743a  array) -> float:
+00007d50: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00007d60: 2020 2020 2043 616c 6375 6c61 7465 2074       Calculate t
+00007d70: 6865 206c 696e 6520 6c65 6e67 7468 206f  he line length o
+00007d80: 6620 6120 3144 2061 7272 6179 2e0a 0a20  f a 1D array... 
+00007d90: 2020 2020 2020 204c 696e 6520 6c65 6e67         Line leng
+00007da0: 7468 2069 7320 6120 6d65 6173 7572 6520  th is a measure 
+00007db0: 6f66 2073 6967 6e61 6c20 636f 6d70 6c65  of signal comple
+00007dc0: 7869 7479 2061 6e64 2069 7320 636f 6d70  xity and is comp
+00007dd0: 7574 6564 2062 7920 7375 6d6d 696e 6720  uted by summing 
+00007de0: 7468 6520 6162 736f 6c75 7465 0a20 2020  the absolute.   
+00007df0: 2020 2020 2064 6966 6665 7265 6e63 6573       differences
+00007e00: 2062 6574 7765 656e 2063 6f6e 7365 6375   between consecu
+00007e10: 7469 7665 2065 6c65 6d65 6e74 7320 6f66  tive elements of
+00007e20: 2074 6865 2069 6e70 7574 2061 7272 6179   the input array
+00007e30: 2e20 5573 6564 2069 6e20 4545 470a 2020  . Used in EEG.  
+00007e40: 2020 2020 2020 616e 616c 7973 6973 2061        analysis a
+00007e50: 6e64 206f 7468 6572 2073 6967 6e61 6c20  nd other signal 
+00007e60: 7072 6f63 6573 7369 6e67 2061 7070 6c69  processing appli
+00007e70: 6361 7469 6f6e 7320 746f 2071 7561 6e74  cations to quant
+00007e80: 6966 7920 7661 7269 6174 696f 6e73 2069  ify variations i
+00007e90: 6e20 7468 6520 7369 676e 616c 2e0a 0a20  n the signal... 
+00007ea0: 2020 2020 2020 203a 7061 7261 6d20 6e75         :param nu
+00007eb0: 6d70 792e 6e64 6172 7261 7920 6461 7461  mpy.ndarray data
+00007ec0: 3a20 5468 6520 3144 2061 7272 6179 2066  : The 1D array f
+00007ed0: 6f72 2077 6869 6368 2074 6865 206c 696e  or which the lin
+00007ee0: 6520 6c65 6e67 7468 2069 7320 746f 2062  e length is to b
+00007ef0: 6520 6361 6c63 756c 6174 6564 2e0a 2020  e calculated..  
+00007f00: 2020 2020 2020 3a72 6574 7572 6e20 666c        :return fl
+00007f10: 6f61 743a 2054 6865 206c 696e 6520 6c65  oat: The line le
+00007f20: 6e67 7468 206f 6620 7468 6520 696e 7075  ngth of the inpu
+00007f30: 7420 6172 7261 792c 2069 6e64 6963 6174  t array, indicat
+00007f40: 696e 6720 6974 7320 636f 6d70 6c65 7869  ing its complexi
+00007f50: 7479 2e0a 0a20 2020 2020 2020 202e 2e20  ty...        .. 
+00007f60: 6d61 7468 3a3a 0a0a 2020 2020 2020 2020  math::..        
+00007f70: 2020 2020 4c4c 203d 205c 7375 6d5f 7b69      LL = \sum_{i
+00007f80: 3d31 7d5e 7b4e 2d31 7d20 7c78 5b69 5d20  =1}^{N-1} |x[i] 
+00007f90: 2d20 785b 692d 315d 7c0a 0a20 2020 2020  - x[i-1]|..     
+00007fa0: 2020 2077 6865 7265 3a0a 2020 2020 2020     where:.      
+00007fb0: 2020 2d20 4c4c 2069 7320 7468 6520 6c69    - LL is the li
+00007fc0: 6e65 206c 656e 6774 682e 0a20 2020 2020  ne length..     
+00007fd0: 2020 202d 204e 2069 7320 7468 6520 6e75     - N is the nu
+00007fe0: 6d62 6572 206f 6620 656c 656d 656e 7473  mber of elements
+00007ff0: 2069 6e20 7468 6520 696e 7075 7420 6461   in the input da
+00008000: 7461 2061 7272 6179 2e0a 2020 2020 2020  ta array..      
+00008010: 2020 2d20 785b 695d 2072 6570 7265 7365    - x[i] represe
+00008020: 6e74 7320 7468 6520 7661 6c75 6520 6f66  nts the value of
+00008030: 2074 6865 2064 6174 6120 6174 2069 6e64   the data at ind
+00008040: 6578 2069 2e0a 0a0a 2020 2020 2020 2020  ex i....        
+00008050: 2e2e 2069 6d61 6765 3a3a 205f 7374 6174  .. image:: _stat
+00008060: 6963 2f69 6d67 2f6c 696e 655f 6c65 6e67  ic/img/line_leng
+00008070: 7468 2e70 6e67 0a20 2020 2020 2020 2020  th.png.         
+00008080: 2020 3a77 6964 7468 3a20 3630 300a 2020    :width: 600.  
+00008090: 2020 2020 2020 2020 203a 616c 6967 6e3a           :align:
+000080a0: 2063 656e 7465 720a 0a20 2020 2020 2020   center..       
+000080b0: 203a 6578 616d 706c 653a 0a20 2020 2020   :example:.     
+000080c0: 2020 203e 3e3e 2064 6174 6120 3d20 6e70     >>> data = np
+000080d0: 2e61 7272 6179 285b 312c 2034 2c20 322c  .array([1, 4, 2,
+000080e0: 2033 2c20 352c 2036 2c20 382c 2037 2c20   3, 5, 6, 8, 7, 
+000080f0: 392c 2031 305d 292e 6173 7479 7065 286e  9, 10]).astype(n
+00008100: 702e 666c 6f61 7433 3229 0a20 2020 2020  p.float32).     
+00008110: 2020 203e 3e3e 2054 696d 6573 6572 6965     >>> Timeserie
+00008120: 7346 6561 7475 7265 4d69 7869 6e28 292e  sFeatureMixin().
+00008130: 6c69 6e65 5f6c 656e 6774 6828 6461 7461  line_length(data
+00008140: 3d64 6174 6129 0a20 2020 2020 2020 203e  =data).        >
+00008150: 3e3e 2031 322e 300a 2020 2020 2020 2020  >> 12.0.        
+00008160: 2222 220a 0a20 2020 2020 2020 2064 6966  """..        dif
+00008170: 6620 3d20 6e70 2e61 6273 286e 702e 6469  f = np.abs(np.di
+00008180: 6666 2864 6174 612e 6173 7479 7065 286e  ff(data.astype(n
+00008190: 702e 666c 6f61 7436 3429 2929 0a20 2020  p.float64))).   
+000081a0: 2020 2020 2072 6574 7572 6e20 6e70 2e73       return np.s
+000081b0: 756d 2864 6966 6629 0a0a 2020 2020 4073  um(diff)..    @s
+000081c0: 7461 7469 636d 6574 686f 640a 2020 2020  taticmethod.    
+000081d0: 406e 6a69 7428 2228 666c 6f61 7433 325b  @njit("(float32[
+000081e0: 3a5d 2c20 666c 6f61 7436 345b 3a5d 2c20  :], float64[:], 
+000081f0: 696e 7436 3429 222c 2066 6173 746d 6174  int64)", fastmat
+00008200: 683d 5472 7565 290a 2020 2020 6465 6620  h=True).    def 
+00008210: 736c 6964 696e 675f 6c69 6e65 5f6c 656e  sliding_line_len
+00008220: 6774 6828 0a20 2020 2020 2020 2064 6174  gth(.        dat
+00008230: 613a 206e 702e 6e64 6172 7261 792c 2077  a: np.ndarray, w
+00008240: 696e 646f 775f 7369 7a65 733a 206e 702e  indow_sizes: np.
+00008250: 6e64 6172 7261 792c 2073 616d 706c 655f  ndarray, sample_
+00008260: 7261 7465 3a20 696e 740a 2020 2020 2920  rate: int.    ) 
+00008270: 2d3e 206e 702e 6e64 6172 7261 793a 0a20  -> np.ndarray:. 
+00008280: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00008290: 2020 204a 6974 7465 6420 636f 6d70 7574     Jitted comput
+000082a0: 6520 6f66 2020 736c 6964 696e 6720 6c69  e of  sliding li
+000082b0: 6e65 206c 656e 6774 6820 666f 7220 6120  ne length for a 
+000082c0: 6769 7665 6e20 7469 6d65 2073 6572 6965  given time serie
+000082d0: 7320 7573 696e 6720 6469 6666 6572 656e  s using differen
+000082e0: 7420 7769 6e64 6f77 2073 697a 6573 2e0a  t window sizes..
+000082f0: 0a20 2020 2020 2020 2054 6865 2066 756e  .        The fun
+00008300: 6374 696f 6e20 636f 6d70 7574 6573 206c  ction computes l
+00008310: 696e 6520 6c65 6e67 7468 2066 6f72 2074  ine length for t
+00008320: 6865 2069 6e70 7574 2064 6174 6120 7573  he input data us
+00008330: 696e 6720 7661 7269 6f75 7320 7769 6e64  ing various wind
+00008340: 6f77 2073 697a 6573 2e20 4974 2072 6574  ow sizes. It ret
+00008350: 7572 6e73 2061 2032 4420 6172 7261 7920  urns a 2D array 
+00008360: 7768 6572 6520 6561 6368 2072 6f77 0a20  where each row. 
+00008370: 2020 2020 2020 2063 6f72 7265 7370 6f6e         correspon
+00008380: 6473 2074 6f20 6120 706f 7369 7469 6f6e  ds to a position
+00008390: 2069 6e20 7468 6520 7469 6d65 2073 6572   in the time ser
+000083a0: 6965 732c 2061 6e64 2065 6163 6820 636f  ies, and each co
+000083b0: 6c75 6d6e 2063 6f72 7265 7370 6f6e 6473  lumn corresponds
+000083c0: 2074 6f20 6120 6469 6666 6572 656e 7420   to a different 
+000083d0: 7769 6e64 6f77 2073 697a 652e 2054 6865  window size. The
+000083e0: 206c 696e 6520 6c65 6e67 7468 0a20 2020   line length.   
+000083f0: 2020 2020 2069 7320 6361 6c63 756c 6174       is calculat
+00008400: 6564 2066 6f72 2065 6163 6820 7769 6e64  ed for each wind
+00008410: 6f77 2c20 616e 6420 7468 6520 7265 7375  ow, and the resu
+00008420: 6c74 7320 6172 6520 7265 7475 726e 6564  lts are returned
+00008430: 2061 7320 6120 3244 2061 7272 6179 206f   as a 2D array o
+00008440: 6620 666c 6f61 7433 3220 7661 6c75 6573  f float32 values
+00008450: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+00008460: 6d20 6e70 2e6e 6461 7272 6179 2064 6174  m np.ndarray dat
+00008470: 613a 2031 4420 6172 7261 7920 696e 7075  a: 1D array inpu
+00008480: 7420 6461 7461 2e0a 2020 2020 2020 2020  t data..        
+00008490: 3a70 6172 616d 2077 696e 646f 775f 7369  :param window_si
+000084a0: 7a65 733a 2041 6e20 6172 7261 7920 6f66  zes: An array of
+000084b0: 2077 696e 646f 7720 7369 7a65 7320 2869   window sizes (i
+000084c0: 6e20 7365 636f 6e64 7329 2074 6f20 7573  n seconds) to us
+000084d0: 6520 666f 7220 6c69 6e65 206c 656e 6774  e for line lengt
+000084e0: 6820 6361 6c63 756c 6174 696f 6e2e 0a20  h calculation.. 
+000084f0: 2020 2020 2020 203a 7061 7261 6d20 7361         :param sa
+00008500: 6d70 6c65 5f72 6174 653a 2054 6865 2073  mple_rate: The s
+00008510: 616d 706c 696e 6720 7261 7465 2028 7361  ampling rate (sa
+00008520: 6d70 6c65 7320 7065 7220 7365 636f 6e64  mples per second
+00008530: 2920 6f66 2074 6865 2074 696d 6520 7365  ) of the time se
+00008540: 7269 6573 2064 6174 612e 0a20 2020 2020  ries data..     
+00008550: 2020 203a 7265 7475 726e 206e 702e 6e64     :return np.nd
+00008560: 6172 7261 793a 2041 2032 4420 6172 7261  array: A 2D arra
+00008570: 7920 636f 6e74 6169 6e69 6e67 206c 696e  y containing lin
+00008580: 6520 6c65 6e67 7468 2076 616c 7565 7320  e length values 
+00008590: 666f 7220 6561 6368 2077 696e 646f 7720  for each window 
+000085a0: 7369 7a65 2061 7420 6561 6368 2070 6f73  size at each pos
+000085b0: 6974 696f 6e20 696e 2074 6865 2074 696d  ition in the tim
+000085c0: 6520 7365 7269 6573 2e0a 0a20 2020 2020  e series...     
+000085d0: 2020 202e 2e20 696d 6167 653a 3a20 5f73     .. image:: _s
+000085e0: 7461 7469 632f 696d 672f 736c 6964 696e  tatic/img/slidin
+000085f0: 675f 6c69 6e65 5f6c 656e 6774 682e 706e  g_line_length.pn
+00008600: 670a 2020 2020 2020 2020 2020 203a 7769  g.           :wi
+00008610: 6474 683a 2036 3030 0a20 2020 2020 2020  dth: 600.       
+00008620: 2020 2020 3a61 6c69 676e 3a20 6365 6e74      :align: cent
+00008630: 6572 0a0a 2020 2020 2020 2020 3a65 7861  er..        :exa
+00008640: 6d70 6c65 733a 0a20 2020 2020 2020 203e  mples:.        >
+00008650: 3e3e 2064 6174 6120 3d20 6e70 2e61 7272  >> data = np.arr
+00008660: 6179 285b 312c 2034 2c20 322c 2033 2c20  ay([1, 4, 2, 3, 
+00008670: 352c 2036 2c20 382c 2037 2c20 392c 2031  5, 6, 8, 7, 9, 1
+00008680: 305d 292e 6173 7479 7065 286e 702e 666c  0]).astype(np.fl
+00008690: 6f61 7433 3229 0a20 2020 2020 2020 203e  oat32).        >
+000086a0: 3e3e 2054 696d 6573 6572 6965 7346 6561  >> TimeseriesFea
+000086b0: 7475 7265 4d69 7869 6e28 292e 736c 6964  tureMixin().slid
+000086c0: 696e 675f 6c69 6e65 5f6c 656e 6774 6828  ing_line_length(
+000086d0: 6461 7461 3d64 6174 612c 2077 696e 646f  data=data, windo
+000086e0: 775f 7369 7a65 733d 6e70 2e61 7272 6179  w_sizes=np.array
+000086f0: 285b 312e 305d 292c 2073 616d 706c 655f  ([1.0]), sample_
+00008700: 7261 7465 3d32 290a 2020 2020 2020 2020  rate=2).        
+00008710: 2222 220a 0a20 2020 2020 2020 2072 6573  """..        res
+00008720: 756c 7473 203d 206e 702e 6675 6c6c 2828  ults = np.full((
+00008730: 6461 7461 2e73 6861 7065 5b30 5d2c 2077  data.shape[0], w
+00008740: 696e 646f 775f 7369 7a65 732e 7368 6170  indow_sizes.shap
+00008750: 655b 305d 292c 202d 312e 3029 0a20 2020  e[0]), -1.0).   
+00008760: 2020 2020 2066 6f72 2069 2069 6e20 7072       for i in pr
+00008770: 616e 6765 2877 696e 646f 775f 7369 7a65  ange(window_size
+00008780: 732e 7368 6170 655b 305d 293a 0a20 2020  s.shape[0]):.   
+00008790: 2020 2020 2020 2020 2077 696e 646f 775f           window_
+000087a0: 7369 7a65 203d 2069 6e74 2877 696e 646f  size = int(windo
+000087b0: 775f 7369 7a65 735b 695d 202a 2073 616d  w_sizes[i] * sam
+000087c0: 706c 655f 7261 7465 290a 2020 2020 2020  ple_rate).      
+000087d0: 2020 2020 2020 666f 7220 6c2c 2072 2069        for l, r i
+000087e0: 6e20 7a69 7028 0a20 2020 2020 2020 2020  n zip(.         
+000087f0: 2020 2020 2020 2070 7261 6e67 6528 302c         prange(0,
+00008800: 2064 6174 612e 7368 6170 655b 305d 202b   data.shape[0] +
+00008810: 2031 292c 2070 7261 6e67 6528 7769 6e64   1), prange(wind
+00008820: 6f77 5f73 697a 652c 2064 6174 612e 7368  ow_size, data.sh
+00008830: 6170 655b 305d 202b 2031 290a 2020 2020  ape[0] + 1).    
+00008840: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
+00008850: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
+00008860: 6520 3d20 6461 7461 5b6c 3a72 5d0a 2020  e = data[l:r].  
+00008870: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00008880: 7375 6c74 735b 7220 2d20 312c 2069 5d20  sults[r - 1, i] 
+00008890: 3d20 6e70 2e73 756d 286e 702e 6162 7328  = np.sum(np.abs(
+000088a0: 6e70 2e64 6966 6628 7361 6d70 6c65 2e61  np.diff(sample.a
+000088b0: 7374 7970 6528 6e70 2e66 6c6f 6174 3634  stype(np.float64
+000088c0: 2929 2929 0a20 2020 2020 2020 2072 6574  )))).        ret
+000088d0: 7572 6e20 7265 7375 6c74 732e 6173 7479  urn results.asty
+000088e0: 7065 286e 702e 666c 6f61 7433 3229 0a0a  pe(np.float32)..
+000088f0: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
+00008900: 640a 2020 2020 406e 6a69 7428 2228 666c  d.    @njit("(fl
+00008910: 6f61 7433 325b 3a5d 2c20 666c 6f61 7436  oat32[:], float6
+00008920: 345b 3a5d 2c20 696e 7436 3429 222c 2066  4[:], int64)", f
+00008930: 6173 746d 6174 683d 5472 7565 2c20 6361  astmath=True, ca
+00008940: 6368 653d 5472 7565 290a 2020 2020 6465  che=True).    de
+00008950: 6620 736c 6964 696e 675f 7661 7269 616e  f sliding_varian
+00008960: 6365 280a 2020 2020 2020 2020 6461 7461  ce(.        data
+00008970: 3a20 6e70 2e6e 6461 7272 6179 2c20 7769  : np.ndarray, wi
+00008980: 6e64 6f77 5f73 697a 6573 3a20 6e70 2e6e  ndow_sizes: np.n
+00008990: 6461 7272 6179 2c20 7361 6d70 6c65 5f72  darray, sample_r
+000089a0: 6174 653a 2069 6e74 0a20 2020 2029 202d  ate: int.    ) -
+000089b0: 3e20 6e70 2e6e 6461 7272 6179 3a0a 2020  > np.ndarray:.  
+000089c0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000089d0: 2020 4a69 7474 6564 2063 6f6d 7075 7465    Jitted compute
+000089e0: 206f 6620 7468 6520 7661 7269 616e 6365   of the variance
+000089f0: 206f 6620 6461 7461 2077 6974 6869 6e20   of data within 
+00008a00: 736c 6964 696e 6720 7769 6e64 6f77 7320  sliding windows 
+00008a10: 6f66 2076 6172 7969 6e67 2073 697a 6573  of varying sizes
+00008a20: 2061 7070 6c69 6564 2074 6f0a 2020 2020   applied to.    
+00008a30: 2020 2020 7468 6520 696e 7075 7420 6461      the input da
+00008a40: 7461 2061 7272 6179 2e20 5661 7269 616e  ta array. Varian
+00008a50: 6365 2069 7320 6120 6d65 6173 7572 6520  ce is a measure 
+00008a60: 6f66 2064 6174 6120 6469 7370 6572 7369  of data dispersi
+00008a70: 6f6e 206f 7220 7370 7265 6164 2e0a 0a20  on or spread... 
+00008a80: 2020 2020 2020 202e 2e20 696d 6167 653a         .. image:
+00008a90: 3a20 5f73 7461 7469 632f 696d 672f 736c  : _static/img/sl
+00008aa0: 6964 696e 675f 7661 7269 616e 6365 2e70  iding_variance.p
+00008ab0: 6e67 0a20 2020 2020 2020 2020 2020 3a77  ng.           :w
+00008ac0: 6964 7468 3a20 3630 300a 2020 2020 2020  idth: 600.      
+00008ad0: 2020 2020 203a 616c 6967 6e3a 2063 656e       :align: cen
+00008ae0: 7465 720a 0a20 2020 2020 2020 203a 7061  ter..        :pa
+00008af0: 7261 6d20 6461 7461 3a20 3164 2069 6e70  ram data: 1d inp
+00008b00: 7574 2064 6174 6120 6172 7261 792e 0a20  ut data array.. 
+00008b10: 2020 2020 2020 203a 7061 7261 6d20 7769         :param wi
+00008b20: 6e64 6f77 5f73 697a 6573 3a20 4172 7261  ndow_sizes: Arra
+00008b30: 7920 6f66 2077 696e 646f 7720 7369 7a65  y of window size
+00008b40: 7320 2869 6e20 7365 636f 6e64 7329 2e0a  s (in seconds)..
+00008b50: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
+00008b60: 616d 706c 655f 7261 7465 3a20 5361 6d70  ample_rate: Samp
+00008b70: 6c69 6e67 2072 6174 6520 6f66 2074 6865  ling rate of the
+00008b80: 2064 6174 6120 696e 2073 616d 706c 6573   data in samples
+00008b90: 2070 6572 2073 6563 6f6e 642e 0a20 2020   per second..   
+00008ba0: 2020 2020 203a 7265 7475 726e 3a20 5661       :return: Va
+00008bb0: 7269 616e 6365 2076 616c 7565 7320 666f  riance values fo
+00008bc0: 7220 6561 6368 2077 696e 646f 7720 7369  r each window si
+00008bd0: 7a65 2061 6e64 2064 6174 6120 706f 696e  ze and data poin
+00008be0: 742e 2054 6865 2073 6861 7065 206f 6620  t. The shape of 
+00008bf0: 7468 6520 7265 7375 6c74 2061 7272 6179  the result array
+00008c00: 2069 7320 2864 6174 612e 7368 6170 655b   is (data.shape[
+00008c10: 305d 2c20 7769 6e64 6f77 5f73 697a 6573  0], window_sizes
+00008c20: 2e73 6861 7065 5b30 5d29 2e0a 0a20 2020  .shape[0])...   
+00008c30: 2020 2020 203a 6578 616d 706c 653a 0a20       :example:. 
+00008c40: 2020 2020 2020 203e 3e3e 2064 6174 6120         >>> data 
+00008c50: 3d20 6e70 2e61 7272 6179 285b 312c 2032  = np.array([1, 2
+00008c60: 2c20 332c 2031 2c20 322c 2039 2c20 3137  , 3, 1, 2, 9, 17
+00008c70: 2c20 322c 2031 302c 2034 5d29 2e61 7374  , 2, 10, 4]).ast
+00008c80: 7970 6528 6e70 2e66 6c6f 6174 3332 290a  ype(np.float32).
+00008c90: 2020 2020 2020 2020 3e3e 3e20 5469 6d65          >>> Time
+00008ca0: 7365 7269 6573 4665 6174 7572 654d 6978  seriesFeatureMix
+00008cb0: 696e 2829 2e73 6c69 6469 6e67 5f76 6172  in().sliding_var
+00008cc0: 6961 6e63 6528 6461 7461 3d64 6174 612c  iance(data=data,
+00008cd0: 2077 696e 646f 775f 7369 7a65 733d 6e70   window_sizes=np
+00008ce0: 2e61 7272 6179 285b 302e 355d 292c 2073  .array([0.5]), s
+00008cf0: 616d 706c 655f 7261 7465 3d31 3029 0a20  ample_rate=10). 
+00008d00: 2020 2020 2020 203e 3e3e 205b 5b2d 312e         >>> [[-1.
+00008d10: 5d2c 5b2d 312e 5d2c 5b2d 312e 5d2c 5b2d  ],[-1.],[-1.],[-
+00008d20: 312e 5d2c 5b20 302e 3536 5d2c 5b20 382e  1.],[ 0.56],[ 8.
+00008d30: 3233 5d2c 5b33 352e 3834 5d2c 5b33 392e  23],[35.84],[39.
+00008d40: 3230 5d2c 5b33 342e 3135 5d2c 5b33 302e  20],[34.15],[30.
+00008d50: 3135 5d5d 290a 2020 2020 2020 2020 2222  15]]).        ""
+00008d60: 220a 0a20 2020 2020 2020 2072 6573 756c  "..        resul
+00008d70: 7473 203d 206e 702e 6675 6c6c 2828 6461  ts = np.full((da
+00008d80: 7461 2e73 6861 7065 5b30 5d2c 2077 696e  ta.shape[0], win
+00008d90: 646f 775f 7369 7a65 732e 7368 6170 655b  dow_sizes.shape[
+00008da0: 305d 292c 202d 312e 3029 0a20 2020 2020  0]), -1.0).     
+00008db0: 2020 2066 6f72 2069 2069 6e20 7072 616e     for i in pran
+00008dc0: 6765 2877 696e 646f 775f 7369 7a65 732e  ge(window_sizes.
+00008dd0: 7368 6170 655b 305d 293a 0a20 2020 2020  shape[0]):.     
+00008de0: 2020 2020 2020 2077 696e 646f 775f 7369         window_si
+00008df0: 7a65 203d 2069 6e74 2877 696e 646f 775f  ze = int(window_
+00008e00: 7369 7a65 735b 695d 202a 2073 616d 706c  sizes[i] * sampl
+00008e10: 655f 7261 7465 290a 2020 2020 2020 2020  e_rate).        
+00008e20: 2020 2020 666f 7220 6c2c 2072 2069 6e20      for l, r in 
+00008e30: 7a69 7028 0a20 2020 2020 2020 2020 2020  zip(.           
+00008e40: 2020 2020 2070 7261 6e67 6528 302c 2064       prange(0, d
+00008e50: 6174 612e 7368 6170 655b 305d 202b 2031  ata.shape[0] + 1
+00008e60: 292c 2070 7261 6e67 6528 7769 6e64 6f77  ), prange(window
+00008e70: 5f73 697a 652c 2064 6174 612e 7368 6170  _size, data.shap
+00008e80: 655b 305d 202b 2031 290a 2020 2020 2020  e[0] + 1).      
+00008e90: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+00008ea0: 2020 2020 2020 2020 2073 616d 706c 6520           sample 
+00008eb0: 3d20 6461 7461 5b6c 3a72 5d0a 2020 2020  = data[l:r].    
+00008ec0: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+00008ed0: 6c74 735b 7220 2d20 312c 2069 5d20 3d20  lts[r - 1, i] = 
+00008ee0: 6e70 2e76 6172 2873 616d 706c 6529 0a0a  np.var(sample)..
+00008ef0: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+00008f00: 6573 756c 7473 2e61 7374 7970 6528 6e70  esults.astype(np
+00008f10: 2e66 6c6f 6174 3332 290a 0a20 2020 2040  .float32)..    @
+00008f20: 7374 6174 6963 6d65 7468 6f64 0a20 2020  staticmethod.   
+00008f30: 2040 6e6a 6974 280a 2020 2020 2020 2020   @njit(.        
+00008f40: 2228 666c 6f61 7433 325b 3a5d 2c20 666c  "(float32[:], fl
+00008f50: 6f61 7436 345b 3a5d 2c20 696e 7436 342c  oat64[:], int64,
+00008f60: 2074 7970 6573 2e4c 6973 7454 7970 6528   types.ListType(
+00008f70: 7479 7065 732e 756e 6963 6f64 655f 7479  types.unicode_ty
+00008f80: 7065 2929 222c 0a20 2020 2020 2020 2066  pe))",.        f
+00008f90: 6173 746d 6174 683d 5472 7565 2c0a 2020  astmath=True,.  
+00008fa0: 2020 2020 2020 6361 6368 653d 5472 7565        cache=True
+00008fb0: 2c0a 2020 2020 290a 2020 2020 6465 6620  ,.    ).    def 
+00008fc0: 736c 6964 696e 675f 6465 7363 7269 7074  sliding_descript
+00008fd0: 6976 655f 7374 6174 6973 7469 6373 280a  ive_statistics(.
+00008fe0: 2020 2020 2020 2020 6461 7461 3a20 6e70          data: np
+00008ff0: 2e6e 6461 7272 6179 2c0a 2020 2020 2020  .ndarray,.      
+00009000: 2020 7769 6e64 6f77 5f73 697a 6573 3a20    window_sizes: 
+00009010: 6e70 2e6e 6461 7272 6179 2c0a 2020 2020  np.ndarray,.    
+00009020: 2020 2020 7361 6d70 6c65 5f72 6174 653a      sample_rate:
+00009030: 2069 6e74 2c0a 2020 2020 2020 2020 7374   int,.        st
+00009040: 6174 6973 7469 6373 3a20 4c69 7465 7261  atistics: Litera
+00009050: 6c5b 0a20 2020 2020 2020 2020 2020 2022  l[.            "
+00009060: 7661 7222 2c0a 2020 2020 2020 2020 2020  var",.          
+00009070: 2020 226d 6178 222c 0a20 2020 2020 2020    "max",.       
+00009080: 2020 2020 2022 6d69 6e22 2c0a 2020 2020       "min",.    
+00009090: 2020 2020 2020 2020 2273 7464 222c 0a20          "std",. 
+000090a0: 2020 2020 2020 2020 2020 2022 6d65 6469             "medi
+000090b0: 616e 222c 0a20 2020 2020 2020 2020 2020  an",.           
+000090c0: 2022 6d65 616e 222c 0a20 2020 2020 2020   "mean",.       
+000090d0: 2020 2020 2022 6d61 6422 2c0a 2020 2020       "mad",.    
+000090e0: 2020 2020 2020 2020 2273 756d 222c 0a20          "sum",. 
+000090f0: 2020 2020 2020 2020 2020 2022 6d61 6322             "mac"
+00009100: 2c0a 2020 2020 2020 2020 2020 2020 2272  ,.            "r
+00009110: 6d73 222c 0a20 2020 2020 2020 2020 2020  ms",.           
+00009120: 2022 6162 7365 6e65 7267 7922 2c0a 2020   "absenergy",.  
+00009130: 2020 2020 2020 5d2c 0a20 2020 2029 202d        ],.    ) -
+00009140: 3e20 6e70 2e6e 6461 7272 6179 3a0a 2020  > np.ndarray:.  
+00009150: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00009160: 2020 4a69 7474 6564 2063 6f6d 7075 7465    Jitted compute
+00009170: 206f 6620 6465 7363 7269 7074 6976 6520   of descriptive 
+00009180: 7374 6174 6973 7469 6373 206f 7665 7220  statistics over 
+00009190: 736c 6964 696e 6720 7769 6e64 6f77 7320  sliding windows 
+000091a0: 696e 2031 4420 6461 7461 2061 7272 6179  in 1D data array
+000091b0: 2e0a 0a20 2020 2020 2020 2043 6f6d 7075  ...        Compu
+000091c0: 7465 7320 7661 7269 6f75 7320 6465 7363  tes various desc
+000091d0: 7269 7074 6976 6520 7374 6174 6973 7469  riptive statisti
+000091e0: 6373 2028 652e 672e 2c20 7661 7269 616e  cs (e.g., varian
+000091f0: 6365 2c20 6d61 7869 6d75 6d2c 206d 696e  ce, maximum, min
+00009200: 696d 756d 2c20 7374 616e 6461 7264 2064  imum, standard d
+00009210: 6576 6961 7469 6f6e 2c0a 2020 2020 2020  eviation,.      
+00009220: 2020 6d65 6469 616e 2c20 6d65 616e 2c20    median, mean, 
+00009230: 6d65 6469 616e 2061 6273 6f6c 7574 6520  median absolute 
+00009240: 6465 7669 6174 696f 6e29 2066 6f72 2073  deviation) for s
+00009250: 6c69 6469 6e67 2077 696e 646f 7773 206f  liding windows o
+00009260: 6620 7661 7279 696e 6720 7369 7a65 7320  f varying sizes 
+00009270: 6170 706c 6965 6420 746f 2074 6865 2069  applied to the i
+00009280: 6e70 7574 2064 6174 6120 6172 7261 792e  nput data array.
+00009290: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000092a0: 206e 702e 6e64 6172 7261 7920 6461 7461   np.ndarray data
+000092b0: 3a20 3144 2069 6e70 7574 2064 6174 6120  : 1D input data 
+000092c0: 6172 7261 792e 0a20 2020 2020 2020 203a  array..        :
+000092d0: 7061 7261 6d20 6e70 2e6e 6461 7272 6179  param np.ndarray
+000092e0: 2077 696e 646f 775f 7369 7a65 733a 2041   window_sizes: A
+000092f0: 7272 6179 206f 6620 7769 6e64 6f77 2073  rray of window s
+00009300: 697a 6573 2028 696e 2073 6563 6f6e 6473  izes (in seconds
+00009310: 292e 0a20 2020 2020 2020 203a 7061 7261  )..        :para
+00009320: 6d20 696e 7420 7361 6d70 6c65 5f72 6174  m int sample_rat
+00009330: 653a 2053 616d 706c 696e 6720 7261 7465  e: Sampling rate
+00009340: 206f 6620 7468 6520 6461 7461 2069 6e20   of the data in 
+00009350: 7361 6d70 6c65 7320 7065 7220 7365 636f  samples per seco
+00009360: 6e64 2e0a 2020 2020 2020 2020 3a70 6172  nd..        :par
+00009370: 616d 2074 7970 6573 2e4c 6973 7454 7970  am types.ListTyp
+00009380: 6528 7479 7065 732e 756e 6963 6f64 655f  e(types.unicode_
+00009390: 7479 7065 2920 7374 6174 6973 7469 6373  type) statistics
+000093a0: 3a20 4c69 7374 206f 6620 7374 6174 6973  : List of statis
+000093b0: 7469 6373 2074 6f20 636f 6d70 7574 652e  tics to compute.
+000093c0: 204f 7074 696f 6e73 3a20 2776 6172 272c   Options: 'var',
+000093d0: 2027 6d61 7827 2c20 276d 696e 272c 2027   'max', 'min', '
+000093e0: 7374 6427 2c20 276d 6564 6961 6e27 2c20  std', 'median', 
+000093f0: 276d 6561 6e27 2c20 276d 6164 272c 2027  'mean', 'mad', '
+00009400: 7375 6d27 2c20 276d 6163 272c 2027 726d  sum', 'mac', 'rm
+00009410: 7327 2c20 2761 6273 5f65 6e65 7267 7927  s', 'abs_energy'
+00009420: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
+00009430: 6e20 6e70 2e6e 6461 7272 6179 3a20 4172  n np.ndarray: Ar
+00009440: 7261 7920 636f 6e74 6169 6e69 6e67 2074  ray containing t
+00009450: 6865 2073 656c 6563 7465 6420 6465 7363  he selected desc
+00009460: 7269 7074 6976 6520 7374 6174 6973 7469  riptive statisti
+00009470: 6373 2066 6f72 2065 6163 6820 7769 6e64  cs for each wind
+00009480: 6f77 2073 697a 652c 2064 6174 6120 706f  ow size, data po
+00009490: 696e 742c 2061 6e64 2073 7461 7469 7374  int, and statist
+000094a0: 6963 2074 7970 652e 2054 6865 2073 6861  ic type. The sha
+000094b0: 7065 206f 6620 7468 6520 7265 7375 6c74  pe of the result
+000094c0: 2061 7272 6179 2069 7320 286c 656e 2873   array is (len(s
+000094d0: 7461 7469 7374 6963 7329 2c20 6461 7461  tatistics), data
+000094e0: 2e73 6861 7065 5b30 5d2c 2077 696e 646f  .shape[0], windo
+000094f0: 775f 7369 7a65 732e 7368 6170 655b 3029  w_sizes.shape[0)
+00009500: 2e0a 0a20 2020 2020 2020 202e 2e20 6e6f  ...        .. no
+00009510: 7465 3a3a 0a20 2020 2020 2020 2020 2020  te::.           
+00009520: 2d20 5468 6520 6073 7461 7469 7374 6963  - The `statistic
+00009530: 7360 2070 6172 616d 6574 6572 2073 686f  s` parameter sho
+00009540: 756c 6420 6265 2061 206c 6973 7420 636f  uld be a list co
+00009550: 6e74 6169 6e69 6e67 206f 6e65 206f 7220  ntaining one or 
+00009560: 6d6f 7265 206f 6620 7468 6520 666f 6c6c  more of the foll
+00009570: 6f77 696e 6720 7374 6174 6973 7469 6373  owing statistics
+00009580: 3a0a 2020 2020 2020 2020 2020 2027 7661  :.           'va
+00009590: 7227 2028 7661 7269 616e 6365 292c 2027  r' (variance), '
+000095a0: 6d61 7827 2028 6d61 7869 6d75 6d29 2c20  max' (maximum), 
+000095b0: 276d 696e 2720 286d 696e 696d 756d 292c  'min' (minimum),
+000095c0: 2027 7374 6427 2028 7374 616e 6461 7264   'std' (standard
+000095d0: 2064 6576 6961 7469 6f6e 292c 2027 6d65   deviation), 'me
+000095e0: 6469 616e 2720 286d 6564 6961 6e29 2c0a  dian' (median),.
+000095f0: 2020 2020 2020 2020 2020 2027 6d65 616e             'mean
+00009600: 2720 286d 6561 6e29 2c20 276d 6164 2720  ' (mean), 'mad' 
+00009610: 286d 6564 6961 6e20 6162 736f 6c75 7465  (median absolute
+00009620: 2064 6576 6961 7469 6f6e 292c 2027 7375   deviation), 'su
+00009630: 6d27 2028 7375 6d29 2c20 276d 6163 2720  m' (sum), 'mac' 
+00009640: 286d 6561 6e20 6162 736f 6c75 7465 2063  (mean absolute c
+00009650: 6861 6e67 6529 2c0a 2020 2020 2020 2020  hange),.        
+00009660: 2020 2027 726d 7327 2028 726f 6f74 206d     'rms' (root m
+00009670: 6561 6e20 7371 7561 7265 292c 2027 6162  ean square), 'ab
+00009680: 7365 6e65 7267 7927 2028 6162 736f 6c75  senergy' (absolu
+00009690: 7465 2065 6e65 7267 7929 2e0a 2020 2020  te energy)..    
+000096a0: 2020 2020 2020 202d 2049 6620 7468 6520         - If the 
+000096b0: 7374 6174 6973 7469 6373 206c 6973 7420  statistics list 
+000096c0: 6973 205b 2776 6172 272c 2027 6d61 7827  is ['var', 'max'
+000096d0: 2c20 276d 6561 6e27 5d2c 2074 6865 0a20  , 'mean'], the. 
+000096e0: 2020 2020 2020 2020 2020 3372 6420 6469            3rd di
+000096f0: 6d65 6e73 696f 6e20 6f72 6465 7220 696e  mension order in
+00009700: 2074 6865 2072 6573 756c 7420 6172 7261   the result arra
+00009710: 7920 7769 6c6c 2062 653a 205b 7661 7269  y will be: [vari
+00009720: 616e 6365 2c20 6d61 7869 6d75 6d2c 206d  ance, maximum, m
+00009730: 6561 6e5d 0a0a 2020 2020 2020 2020 3a65  ean]..        :e
+00009740: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
+00009750: 3e3e 3e20 6461 7461 203d 206e 702e 6172  >>> data = np.ar
+00009760: 7261 7928 5b31 2c20 342c 2032 2c20 332c  ray([1, 4, 2, 3,
+00009770: 2035 2c20 362c 2038 2c20 372c 2039 2c20   5, 6, 8, 7, 9, 
+00009780: 3130 5d29 2e61 7374 7970 6528 6e70 2e66  10]).astype(np.f
+00009790: 6c6f 6174 3332 290a 2020 2020 2020 2020  loat32).        
+000097a0: 3e3e 3e20 7265 7375 6c74 7320 3d20 5469  >>> results = Ti
+000097b0: 6d65 7365 7269 6573 4665 6174 7572 654d  meseriesFeatureM
+000097c0: 6978 696e 2829 2e73 6c69 6469 6e67 5f64  ixin().sliding_d
+000097d0: 6573 6372 6970 7469 7665 5f73 7461 7469  escriptive_stati
+000097e0: 7374 6963 7328 6461 7461 3d64 6174 612c  stics(data=data,
+000097f0: 2077 696e 646f 775f 7369 7a65 733d 6e70   window_sizes=np
+00009800: 2e61 7272 6179 285b 312e 302c 2035 2e30  .array([1.0, 5.0
+00009810: 5d29 2c20 7361 6d70 6c65 5f72 6174 653d  ]), sample_rate=
+00009820: 322c 2073 7461 7469 7374 6963 733d 7479  2, statistics=ty
+00009830: 7065 642e 4c69 7374 285b 2776 6172 272c  ped.List(['var',
+00009840: 2027 6d61 7827 5d29 290a 2020 2020 2020   'max'])).      
+00009850: 2020 2222 220a 0a20 2020 2020 2020 2072    """..        r
+00009860: 6573 756c 7473 203d 206e 702e 6675 6c6c  esults = np.full
+00009870: 2828 6c65 6e28 7374 6174 6973 7469 6373  ((len(statistics
+00009880: 292c 2064 6174 612e 7368 6170 655b 305d  ), data.shape[0]
+00009890: 2c20 7769 6e64 6f77 5f73 697a 6573 2e73  , window_sizes.s
+000098a0: 6861 7065 5b30 5d29 2c20 2d31 2e30 290a  hape[0]), -1.0).
+000098b0: 2020 2020 2020 2020 666f 7220 6a20 696e          for j in
+000098c0: 2070 7261 6e67 6528 6c65 6e28 7374 6174   prange(len(stat
+000098d0: 6973 7469 6373 2929 3a0a 2020 2020 2020  istics)):.      
+000098e0: 2020 2020 2020 666f 7220 6920 696e 2070        for i in p
+000098f0: 7261 6e67 6528 7769 6e64 6f77 5f73 697a  range(window_siz
+00009900: 6573 2e73 6861 7065 5b30 5d29 3a0a 2020  es.shape[0]):.  
+00009910: 2020 2020 2020 2020 2020 2020 2020 7769                wi
+00009920: 6e64 6f77 5f73 697a 6520 3d20 696e 7428  ndow_size = int(
+00009930: 7769 6e64 6f77 5f73 697a 6573 5b69 5d20  window_sizes[i] 
+00009940: 2a20 7361 6d70 6c65 5f72 6174 6529 0a20  * sample_rate). 
+00009950: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00009960: 6f72 206c 2c20 7220 696e 207a 6970 280a  or l, r in zip(.
+00009970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009980: 2020 2020 7072 616e 6765 2830 2c20 6461      prange(0, da
+00009990: 7461 2e73 6861 7065 5b30 5d20 2b20 3129  ta.shape[0] + 1)
+000099a0: 2c20 7072 616e 6765 2877 696e 646f 775f  , prange(window_
+000099b0: 7369 7a65 2c20 6461 7461 2e73 6861 7065  size, data.shape
+000099c0: 5b30 5d20 2b20 3129 0a20 2020 2020 2020  [0] + 1).       
+000099d0: 2020 2020 2020 2020 2029 3a0a 2020 2020           ):.    
+000099e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000099f0: 7361 6d70 6c65 203d 2064 6174 615b 6c3a  sample = data[l:
+00009a00: 725d 0a20 2020 2020 2020 2020 2020 2020  r].             
+00009a10: 2020 2020 2020 2069 6620 7374 6174 6973         if statis
+00009a20: 7469 6373 5b6a 5d20 3d3d 2022 7661 7222  tics[j] == "var"
+00009a30: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00009a40: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+00009a50: 735b 6a2c 2072 202d 2031 2c20 695d 203d  s[j, r - 1, i] =
+00009a60: 206e 702e 7661 7228 7361 6d70 6c65 290a   np.var(sample).
+00009a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009a80: 2020 2020 656c 6966 2073 7461 7469 7374      elif statist
+00009a90: 6963 735b 6a5d 203d 3d20 226d 6178 223a  ics[j] == "max":
+00009aa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009ab0: 2020 2020 2020 2020 2072 6573 756c 7473           results
+00009ac0: 5b6a 2c20 7220 2d20 312c 2069 5d20 3d20  [j, r - 1, i] = 
+00009ad0: 6e70 2e6d 6178 2873 616d 706c 6529 0a20  np.max(sample). 
+00009ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009af0: 2020 2065 6c69 6620 7374 6174 6973 7469     elif statisti
+00009b00: 6373 5b6a 5d20 3d3d 2022 6d69 6e22 3a0a  cs[j] == "min":.
+00009b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009b20: 2020 2020 2020 2020 7265 7375 6c74 735b          results[
+00009b30: 6a2c 2072 202d 2031 2c20 695d 203d 206e  j, r - 1, i] = n
+00009b40: 702e 6d69 6e28 7361 6d70 6c65 290a 2020  p.min(sample).  
+00009b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009b60: 2020 656c 6966 2073 7461 7469 7374 6963    elif statistic
+00009b70: 735b 6a5d 203d 3d20 2273 7464 223a 0a20  s[j] == "std":. 
+00009b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009b90: 2020 2020 2020 2072 6573 756c 7473 5b6a         results[j
+00009ba0: 2c20 7220 2d20 312c 2069 5d20 3d20 6e70  , r - 1, i] = np
+00009bb0: 2e73 7464 2873 616d 706c 6529 0a20 2020  .std(sample).   
+00009bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009bd0: 2065 6c69 6620 7374 6174 6973 7469 6373   elif statistics
+00009be0: 5b6a 5d20 3d3d 2022 6d65 6469 616e 223a  [j] == "median":
+00009bf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009c00: 2020 2020 2020 2020 2072 6573 756c 7473           results
+00009c10: 5b6a 2c20 7220 2d20 312c 2069 5d20 3d20  [j, r - 1, i] = 
+00009c20: 6e70 2e6d 6564 6961 6e28 7361 6d70 6c65  np.median(sample
+00009c30: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00009c40: 2020 2020 2020 656c 6966 2073 7461 7469        elif stati
+00009c50: 7374 6963 735b 6a5d 203d 3d20 226d 6561  stics[j] == "mea
+00009c60: 6e22 3a0a 2020 2020 2020 2020 2020 2020  n":.            
+00009c70: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+00009c80: 6c74 735b 6a2c 2072 202d 2031 2c20 695d  lts[j, r - 1, i]
+00009c90: 203d 206e 702e 6d65 616e 2873 616d 706c   = np.mean(sampl
+00009ca0: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
+00009cb0: 2020 2020 2020 2065 6c69 6620 7374 6174         elif stat
+00009cc0: 6973 7469 6373 5b6a 5d20 3d3d 2022 6d61  istics[j] == "ma
+00009cd0: 6422 3a0a 2020 2020 2020 2020 2020 2020  d":.            
+00009ce0: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+00009cf0: 6c74 735b 6a2c 2072 202d 2031 2c20 695d  lts[j, r - 1, i]
+00009d00: 203d 206e 702e 6d65 6469 616e 280a 2020   = np.median(.  
+00009d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009d20: 2020 2020 2020 2020 2020 6e70 2e61 6273            np.abs
+00009d30: 2873 616d 706c 6520 2d20 6e70 2e6d 6564  (sample - np.med
+00009d40: 6961 6e28 7361 6d70 6c65 2929 0a20 2020  ian(sample)).   
+00009d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009d60: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00009d70: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00009d80: 7374 6174 6973 7469 6373 5b6a 5d20 3d3d  statistics[j] ==
+00009d90: 2022 7375 6d22 3a0a 2020 2020 2020 2020   "sum":.        
+00009da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009db0: 7265 7375 6c74 735b 6a2c 2072 202d 2031  results[j, r - 1
+00009dc0: 2c20 695d 203d 206e 702e 7375 6d28 7361  , i] = np.sum(sa
+00009dd0: 6d70 6c65 290a 2020 2020 2020 2020 2020  mple).          
+00009de0: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
+00009df0: 7461 7469 7374 6963 735b 6a5d 203d 3d20  tatistics[j] == 
+00009e00: 226d 6163 223a 0a20 2020 2020 2020 2020  "mac":.         
+00009e10: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00009e20: 6573 756c 7473 5b6a 2c20 7220 2d20 312c  esults[j, r - 1,
+00009e30: 2069 5d20 3d20 6e70 2e6d 6561 6e28 6e70   i] = np.mean(np
+00009e40: 2e61 6273 2873 616d 706c 655b 313a 5d20  .abs(sample[1:] 
+00009e50: 2d20 7361 6d70 6c65 5b3a 2d31 5d29 290a  - sample[:-1])).
+00009e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009e70: 2020 2020 656c 6966 2073 7461 7469 7374      elif statist
+00009e80: 6963 735b 6a5d 203d 3d20 2272 6d73 223a  ics[j] == "rms":
+00009e90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009ea0: 2020 2020 2020 2020 2072 6573 756c 7473           results
+00009eb0: 5b6a 2c20 7220 2d20 312c 2069 5d20 3d20  [j, r - 1, i] = 
+00009ec0: 6e70 2e73 7172 7428 6e70 2e6d 6561 6e28  np.sqrt(np.mean(
+00009ed0: 7361 6d70 6c65 2a2a 3229 290a 2020 2020  sample**2)).    
+00009ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009ef0: 656c 6966 2073 7461 7469 7374 6963 735b  elif statistics[
+00009f00: 6a5d 203d 3d20 2261 6273 656e 6572 6779  j] == "absenergy
+00009f10: 223a 0a20 2020 2020 2020 2020 2020 2020  ":.             
+00009f20: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+00009f30: 7473 5b6a 2c20 7220 2d20 312c 2069 5d20  ts[j, r - 1, i] 
+00009f40: 3d20 6e70 2e73 7172 7428 6e70 2e73 756d  = np.sqrt(np.sum
+00009f50: 2873 616d 706c 652a 2a32 2929 0a0a 2020  (sample**2))..  
+00009f60: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+00009f70: 756c 7473 2e61 7374 7970 6528 6e70 2e66  ults.astype(np.f
+00009f80: 6c6f 6174 3332 290a 0a20 2020 2040 7374  loat32)..    @st
+00009f90: 6174 6963 6d65 7468 6f64 0a20 2020 2064  aticmethod.    d
+00009fa0: 6566 2064 6f6d 696e 616e 745f 6672 6571  ef dominant_freq
+00009fb0: 7565 6e63 6965 7328 0a20 2020 2020 2020  uencies(.       
+00009fc0: 2064 6174 613a 206e 702e 6e64 6172 7261   data: np.ndarra
+00009fd0: 792c 0a20 2020 2020 2020 2066 7073 3a20  y,.        fps: 
+00009fe0: 666c 6f61 742c 0a20 2020 2020 2020 206b  float,.        k
+00009ff0: 3a20 696e 742c 0a20 2020 2020 2020 2077  : int,.        w
+0000a000: 696e 646f 775f 6675 6e63 7469 6f6e 3a20  indow_function: 
+0000a010: 4c69 7465 7261 6c5b 2248 616e 6e22 2c20  Literal["Hann", 
+0000a020: 2248 616d 6d69 6e67 222c 2022 426c 6163  "Hamming", "Blac
+0000a030: 6b6d 616e 225d 203d 204e 6f6e 652c 0a20  kman"] = None,. 
+0000a040: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
+0000a050: 2246 696e 6420 7468 6520 4b20 646f 6d69  "Find the K domi
+0000a060: 6e61 6e74 2066 7265 7175 656e 6369 6573  nant frequencies
+0000a070: 2077 6974 6869 6e20 6120 6665 6174 7572   within a featur
+0000a080: 6520 7665 6374 6f72 2222 220a 0a20 2020  e vector"""..   
+0000a090: 2020 2020 2069 6620 7769 6e64 6f77 5f66       if window_f
+0000a0a0: 756e 6374 696f 6e20 3d3d 2022 4861 6e6e  unction == "Hann
+0000a0b0: 223a 0a20 2020 2020 2020 2020 2020 2064  ":.            d
+0000a0c0: 6174 6120 3d20 6461 7461 202a 206e 702e  ata = data * np.
+0000a0d0: 6861 6e6e 696e 6728 6c65 6e28 6461 7461  hanning(len(data
+0000a0e0: 2929 0a20 2020 2020 2020 2065 6c69 6620  )).        elif 
+0000a0f0: 7769 6e64 6f77 5f66 756e 6374 696f 6e20  window_function 
+0000a100: 3d3d 2022 4861 6d6d 696e 6722 3a0a 2020  == "Hamming":.  
+0000a110: 2020 2020 2020 2020 2020 6461 7461 203d            data =
+0000a120: 2064 6174 6120 2a20 6e70 2e68 616d 6d69   data * np.hammi
+0000a130: 6e67 286c 656e 2864 6174 6129 290a 2020  ng(len(data)).  
+0000a140: 2020 2020 2020 656c 6966 2077 696e 646f        elif windo
+0000a150: 775f 6675 6e63 7469 6f6e 203d 3d20 2242  w_function == "B
+0000a160: 6c61 636b 6d61 6e22 3a0a 2020 2020 2020  lackman":.      
+0000a170: 2020 2020 2020 6461 7461 203d 2064 6174        data = dat
+0000a180: 6120 2a20 6e70 2e62 6c61 636b 6d61 6e28  a * np.blackman(
+0000a190: 6c65 6e28 6461 7461 2929 0a20 2020 2020  len(data)).     
+0000a1a0: 2020 2066 6674 5f72 6573 756c 7420 3d20     fft_result = 
+0000a1b0: 6e70 2e66 6674 2e66 6674 2864 6174 6129  np.fft.fft(data)
+0000a1c0: 0a20 2020 2020 2020 2066 7265 7175 656e  .        frequen
+0000a1d0: 6369 6573 203d 206e 702e 6666 742e 6666  cies = np.fft.ff
+0000a1e0: 7466 7265 7128 6461 7461 2e73 6861 7065  tfreq(data.shape
+0000a1f0: 5b30 5d2c 2031 202f 2066 7073 290a 2020  [0], 1 / fps).  
+0000a200: 2020 2020 2020 6d61 676e 6974 7564 6520        magnitude 
+0000a210: 3d20 6e70 2e61 6273 2866 6674 5f72 6573  = np.abs(fft_res
+0000a220: 756c 7429 0a0a 2020 2020 2020 2020 7265  ult)..        re
+0000a230: 7475 726e 2066 7265 7175 656e 6369 6573  turn frequencies
+0000a240: 5b6e 702e 6172 6773 6f72 7428 6d61 676e  [np.argsort(magn
+0000a250: 6974 7564 6529 5b2d 286b 202b 2031 2920  itude)[-(k + 1) 
+0000a260: 3a20 2d31 5d5d 0a0a 2020 2020 4073 7461  : -1]]..    @sta
+0000a270: 7469 636d 6574 686f 640a 2020 2020 406e  ticmethod.    @n
+0000a280: 6a69 7428 0a20 2020 2020 2020 205b 0a20  jit(.        [. 
+0000a290: 2020 2020 2020 2020 2020 2028 666c 6f61             (floa
+0000a2a0: 7433 325b 3a5d 2c20 666c 6f61 7436 342c  t32[:], float64,
+0000a2b0: 2062 6f6f 6c65 616e 292c 0a20 2020 2020   boolean),.     
+0000a2c0: 2020 2020 2020 2028 666c 6f61 7433 325b         (float32[
+0000a2d0: 3a5d 2c20 666c 6f61 7436 342c 2074 7970  :], float64, typ
+0000a2e0: 6573 2e6d 6973 632e 4f6d 6974 7465 6428  es.misc.Omitted(
+0000a2f0: 5472 7565 2929 2c0a 2020 2020 2020 2020  True)),.        
+0000a300: 5d0a 2020 2020 290a 2020 2020 6465 6620  ].    ).    def 
+0000a310: 6c6f 6e67 6573 745f 7374 7269 6b65 2864  longest_strike(d
+0000a320: 6174 613a 206e 702e 6e64 6172 7261 792c  ata: np.ndarray,
+0000a330: 2074 6872 6573 686f 6c64 3a20 666c 6f61   threshold: floa
+0000a340: 742c 2061 626f 7665 3a20 626f 6f6c 203d  t, above: bool =
+0000a350: 2054 7275 6529 202d 3e20 696e 743a 0a20   True) -> int:. 
+0000a360: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0000a370: 2020 204a 6974 7465 6420 636f 6d70 7574     Jitted comput
+0000a380: 6520 6f66 2074 6865 206c 656e 6774 6820  e of the length 
+0000a390: 6f66 2074 6865 206c 6f6e 6765 7374 2063  of the longest c
+0000a3a0: 6f6e 7365 6375 7469 7665 2073 6571 7565  onsecutive seque
+0000a3b0: 6e63 6520 6f66 2076 616c 7565 7320 696e  nce of values in
+0000a3c0: 2074 6865 2069 6e70 7574 2064 6174 6120   the input data 
+0000a3d0: 7468 6174 2065 6974 6865 7220 6578 6365  that either exce
+0000a3e0: 6564 0a20 2020 2020 2020 206f 7220 6661  ed.        or fa
+0000a3f0: 6c6c 2062 656c 6f77 2061 2073 7065 6369  ll below a speci
+0000a400: 6669 6564 2074 6872 6573 686f 6c64 2e0a  fied threshold..
+0000a410: 0a20 2020 2020 2020 202e 2e20 696d 6167  .        .. imag
+0000a420: 653a 3a20 5f73 7461 7469 632f 696d 672f  e:: _static/img/
+0000a430: 6c6f 6e67 6573 745f 7374 7269 6b65 2e70  longest_strike.p
+0000a440: 6e67 0a20 2020 2020 2020 2020 2020 3a77  ng.           :w
+0000a450: 6964 7468 3a20 3730 300a 2020 2020 2020  idth: 700.      
+0000a460: 2020 2020 203a 616c 6967 6e3a 2063 656e       :align: cen
+0000a470: 7465 720a 0a20 2020 2020 2020 203a 7061  ter..        :pa
+0000a480: 7261 6d20 6e70 2e6e 6461 7272 6179 2064  ram np.ndarray d
+0000a490: 6174 613a 2054 6865 2069 6e70 7574 2031  ata: The input 1
+0000a4a0: 4420 4e75 6d50 7920 6172 7261 7920 636f  D NumPy array co
+0000a4b0: 6e74 6169 6e69 6e67 2074 6865 2076 616c  ntaining the val
+0000a4c0: 7565 7320 746f 2062 6520 616e 616c 797a  ues to be analyz
+0000a4d0: 6564 2e0a 2020 2020 2020 2020 3a70 6172  ed..        :par
+0000a4e0: 616d 2066 6c6f 6174 2074 6872 6573 686f  am float thresho
+0000a4f0: 6c64 3a20 5468 6520 7468 7265 7368 6f6c  ld: The threshol
+0000a500: 6420 7661 6c75 6520 7573 6564 2066 6f72  d value used for
+0000a510: 2074 6865 2063 6f6d 7061 7269 736f 6e2e   the comparison.
+0000a520: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0000a530: 626f 6f6c 2061 626f 7665 3a20 4966 2054  bool above: If T
+0000a540: 7275 652c 2074 6865 2066 756e 6374 696f  rue, the functio
+0000a550: 6e20 6c6f 6f6b 7320 666f 7220 7374 7269  n looks for stri
+0000a560: 6b65 7320 7768 6572 6520 7661 6c75 6573  kes where values
+0000a570: 2061 7265 2061 626f 7665 206f 7220 6571   are above or eq
+0000a580: 7561 6c20 746f 2074 6865 2074 6872 6573  ual to the thres
+0000a590: 686f 6c64 2e20 4966 2046 616c 7365 2c20  hold. If False, 
+0000a5a0: 6974 206c 6f6f 6b73 2066 6f72 2073 7472  it looks for str
+0000a5b0: 696b 6573 2077 6865 7265 2076 616c 7565  ikes where value
+0000a5c0: 7320 6172 6520 6265 6c6f 7720 6f72 2065  s are below or e
+0000a5d0: 7175 616c 2074 6f20 7468 6520 7468 7265  qual to the thre
+0000a5e0: 7368 6f6c 642e 0a20 2020 2020 2020 203a  shold..        :
+0000a5f0: 7265 7475 726e 2069 6e74 3a20 5468 6520  return int: The 
+0000a600: 6c65 6e67 7468 206f 6620 7468 6520 6c6f  length of the lo
+0000a610: 6e67 6573 7420 7374 7269 6b65 2074 6861  ngest strike tha
+0000a620: 7420 7361 7469 7366 6965 7320 7468 6520  t satisfies the 
+0000a630: 636f 6e64 6974 696f 6e2e 0a0a 2020 2020  condition...    
+0000a640: 2020 2020 3a65 7861 6d70 6c65 3a0a 2020      :example:.  
+0000a650: 2020 2020 2020 3e3e 3e20 6461 7461 203d        >>> data =
+0000a660: 206e 702e 6172 7261 7928 5b31 2c20 382c   np.array([1, 8,
+0000a670: 2032 2c20 3130 2c20 382c 2036 2c20 382c   2, 10, 8, 6, 8,
+0000a680: 2031 2c20 312c 2031 5d29 2e61 7374 7970   1, 1, 1]).astyp
+0000a690: 6528 6e70 2e66 6c6f 6174 3332 290a 2020  e(np.float32).  
+0000a6a0: 2020 2020 2020 3e3e 3e20 5469 6d65 7365        >>> Timese
+0000a6b0: 7269 6573 4665 6174 7572 654d 6978 696e  riesFeatureMixin
+0000a6c0: 2829 2e6c 6f6e 6765 7374 5f73 7472 696b  ().longest_strik
+0000a6d0: 6528 6461 7461 3d64 6174 612c 2074 6872  e(data=data, thr
+0000a6e0: 6573 686f 6c64 3d37 2c20 6162 6f76 653d  eshold=7, above=
+0000a6f0: 5472 7565 290a 2020 2020 2020 2020 3e3e  True).        >>
+0000a700: 3e20 320a 2020 2020 2020 2020 3e3e 3e20  > 2.        >>> 
+0000a710: 5469 6d65 7365 7269 6573 4665 6174 7572  TimeseriesFeatur
+0000a720: 654d 6978 696e 2829 2e6c 6f6e 6765 7374  eMixin().longest
+0000a730: 5f73 7472 696b 6528 6461 7461 3d64 6174  _strike(data=dat
+0000a740: 612c 2074 6872 6573 686f 6c64 3d37 2c20  a, threshold=7, 
+0000a750: 6162 6f76 653d 4661 6c73 6529 0a20 2020  above=False).   
+0000a760: 2020 2020 203e 3e3e 2033 0a20 2020 2020       >>> 3.     
+0000a770: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+0000a780: 7265 7375 6c74 2c20 6c2c 2072 2c20 636e  result, l, r, cn
+0000a790: 7420 3d20 2d6e 702e 696e 662c 2030 2c20  t = -np.inf, 0, 
+0000a7a0: 302c 2030 0a20 2020 2020 2020 2077 6869  0, 0.        whi
+0000a7b0: 6c65 206c 203c 2064 6174 612e 7368 6170  le l < data.shap
+0000a7c0: 655b 305d 3a0a 2020 2020 2020 2020 2020  e[0]:.          
+0000a7d0: 2020 6966 2061 626f 7665 3a0a 2020 2020    if above:.    
+0000a7e0: 2020 2020 2020 2020 2020 2020 6966 2064              if d
+0000a7f0: 6174 615b 6c5d 203e 3d20 7468 7265 7368  ata[l] >= thresh
+0000a800: 6f6c 643a 0a20 2020 2020 2020 2020 2020  old:.           
+0000a810: 2020 2020 2020 2020 2063 6e74 2c20 7220           cnt, r 
+0000a820: 3d20 636e 7420 2b20 312c 2072 202b 2031  = cnt + 1, r + 1
+0000a830: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a840: 2020 2020 2077 6869 6c65 2064 6174 615b       while data[
+0000a850: 725d 203e 3d20 7468 7265 7368 6f6c 6420  r] >= threshold 
+0000a860: 616e 6420 7220 3c20 6461 7461 2e73 6861  and r < data.sha
+0000a870: 7065 5b30 5d3a 0a20 2020 2020 2020 2020  pe[0]:.         
+0000a880: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0000a890: 6e74 2c20 7220 3d20 636e 7420 2b20 312c  nt, r = cnt + 1,
+0000a8a0: 2072 202b 2031 0a20 2020 2020 2020 2020   r + 1.         
+0000a8b0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0000a8c0: 2020 2020 2020 2020 2069 6620 6461 7461           if data
+0000a8d0: 5b6c 5d20 3c3d 2074 6872 6573 686f 6c64  [l] <= threshold
+0000a8e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000a8f0: 2020 2020 2020 636e 742c 2072 203d 2063        cnt, r = c
+0000a900: 6e74 202b 2031 2c20 7220 2b20 310a 2020  nt + 1, r + 1.  
+0000a910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a920: 2020 7768 696c 6520 6461 7461 5b72 5d20    while data[r] 
+0000a930: 3c3d 2074 6872 6573 686f 6c64 2061 6e64  <= threshold and
+0000a940: 2072 203c 2064 6174 612e 7368 6170 655b   r < data.shape[
+0000a950: 305d 3a0a 2020 2020 2020 2020 2020 2020  0]:.            
+0000a960: 2020 2020 2020 2020 2020 2020 636e 742c              cnt,
+0000a970: 2072 203d 2063 6e74 202b 2031 2c20 7220   r = cnt + 1, r 
+0000a980: 2b20 310a 0a20 2020 2020 2020 2020 2020  + 1..           
+0000a990: 206c 202b 3d20 310a 2020 2020 2020 2020   l += 1.        
+0000a9a0: 2020 2020 6966 2063 6e74 203e 2072 6573      if cnt > res
+0000a9b0: 756c 743a 0a20 2020 2020 2020 2020 2020  ult:.           
+0000a9c0: 2020 2020 2072 6573 756c 7420 3d20 636e       result = cn
+0000a9d0: 740a 2020 2020 2020 2020 2020 2020 6966  t.            if
+0000a9e0: 2064 6174 612e 7368 6170 655b 305d 202d   data.shape[0] -
+0000a9f0: 206c 203c 2072 6573 756c 743a 0a20 2020   l < result:.   
+0000aa00: 2020 2020 2020 2020 2020 2020 2062 7265               bre
+0000aa10: 616b 0a20 2020 2020 2020 2020 2020 2072  ak.            r
+0000aa20: 2c20 636e 7420 3d20 6c2c 2030 0a0a 2020  , cnt = l, 0..  
+0000aa30: 2020 2020 2020 7265 7475 726e 2069 6e74        return int
+0000aa40: 2872 6573 756c 7429 0a0a 2020 2020 4073  (result)..    @s
+0000aa50: 7461 7469 636d 6574 686f 640a 2020 2020  taticmethod.    
+0000aa60: 406e 6a69 7428 0a20 2020 2020 2020 205b  @njit(.        [
+0000aa70: 0a20 2020 2020 2020 2020 2020 2028 666c  .            (fl
+0000aa80: 6f61 7433 325b 3a5d 2c20 666c 6f61 7436  oat32[:], float6
+0000aa90: 342c 2066 6c6f 6174 3634 5b3a 5d2c 2069  4, float64[:], i
+0000aaa0: 6e74 3634 2c20 626f 6f6c 6561 6e29 2c0a  nt64, boolean),.
+0000aab0: 2020 2020 2020 2020 2020 2020 2866 6c6f              (flo
+0000aac0: 6174 3332 5b3a 5d2c 2066 6c6f 6174 3634  at32[:], float64
+0000aad0: 2c20 666c 6f61 7436 345b 3a5d 2c20 696e  , float64[:], in
+0000aae0: 7436 342c 2074 7970 6573 2e6d 6973 632e  t64, types.misc.
+0000aaf0: 4f6d 6974 7465 6428 5472 7565 2929 2c0a  Omitted(True)),.
+0000ab00: 2020 2020 2020 2020 5d0a 2020 2020 290a          ].    ).
+0000ab10: 2020 2020 6465 6620 736c 6964 696e 675f      def sliding_
+0000ab20: 6c6f 6e67 6573 745f 7374 7269 6b65 280a  longest_strike(.
+0000ab30: 2020 2020 2020 2020 6461 7461 3a20 6e70          data: np
+0000ab40: 2e6e 6461 7272 6179 2c0a 2020 2020 2020  .ndarray,.      
+0000ab50: 2020 7468 7265 7368 6f6c 643a 2066 6c6f    threshold: flo
+0000ab60: 6174 2c0a 2020 2020 2020 2020 7469 6d65  at,.        time
+0000ab70: 5f77 696e 646f 7773 3a20 6e70 2e6e 6461  _windows: np.nda
+0000ab80: 7272 6179 2c0a 2020 2020 2020 2020 7361  rray,.        sa
+0000ab90: 6d70 6c65 5f72 6174 653a 2069 6e74 2c0a  mple_rate: int,.
+0000aba0: 2020 2020 2020 2020 6162 6f76 653a 2062          above: b
+0000abb0: 6f6f 6c2c 0a20 2020 2029 202d 3e20 6e70  ool,.    ) -> np
+0000abc0: 2e6e 6461 7272 6179 3a0a 2020 2020 2020  .ndarray:.      
+0000abd0: 2020 2222 220a 2020 2020 2020 2020 4a69    """.        Ji
+0000abe0: 7474 6564 2063 6f6d 7075 7465 206f 6620  tted compute of 
+0000abf0: 7468 6520 6c65 6e67 7468 206f 6620 7468  the length of th
+0000ac00: 6520 6c6f 6e67 6573 7420 7374 7269 6b65  e longest strike
+0000ac10: 206f 6620 7661 6c75 6573 2077 6974 6869   of values withi
+0000ac20: 6e20 736c 6964 696e 6720 7469 6d65 2077  n sliding time w
+0000ac30: 696e 646f 7773 2074 6861 7420 7361 7469  indows that sati
+0000ac40: 7366 7920 6120 6769 7665 6e20 636f 6e64  sfy a given cond
+0000ac50: 6974 696f 6e2e 0a0a 2020 2020 2020 2020  ition...        
+0000ac60: 4361 6c63 756c 6174 6573 2074 6865 206c  Calculates the l
+0000ac70: 656e 6774 6820 6f66 2074 6865 206c 6f6e  ength of the lon
+0000ac80: 6765 7374 2063 6f6e 7365 6375 7469 7665  gest consecutive
+0000ac90: 2073 6571 7565 6e63 6520 6f66 2076 616c   sequence of val
+0000aca0: 7565 7320 696e 2061 2031 4420 4e75 6d50  ues in a 1D NumP
+0000acb0: 7920 6172 7261 792c 2077 6865 7265 2065  y array, where e
+0000acc0: 6163 680a 2020 2020 2020 2020 7365 7175  ach.        sequ
+0000acd0: 656e 6365 2069 7320 6465 7465 726d 696e  ence is determin
+0000ace0: 6564 2062 7920 6120 736c 6964 696e 6720  ed by a sliding 
+0000acf0: 7469 6d65 2077 696e 646f 772e 2054 6865  time window. The
+0000ad00: 2063 6f6e 6469 7469 6f6e 2069 7320 7370   condition is sp
+0000ad10: 6563 6966 6965 6420 6279 2061 2074 6872  ecified by a thr
+0000ad20: 6573 686f 6c64 2c20 616e 640a 2020 2020  eshold, and.    
+0000ad30: 2020 2020 796f 7520 6361 6e20 6368 6f6f      you can choo
+0000ad40: 7365 2077 6865 7468 6572 2074 6f20 6c6f  se whether to lo
+0000ad50: 6f6b 2066 6f72 2076 616c 7565 7320 6162  ok for values ab
+0000ad60: 6f76 6520 6f72 2062 656c 6f77 2074 6865  ove or below the
+0000ad70: 2074 6872 6573 686f 6c64 2e0a 0a20 2020   threshold...   
+0000ad80: 2020 2020 202e 2e20 696d 6167 653a 3a20       .. image:: 
+0000ad90: 5f73 7461 7469 632f 696d 672f 736c 6964  _static/img/slid
+0000ada0: 696e 675f 6c6f 6e67 6573 745f 7374 7269  ing_longest_stri
+0000adb0: 6b65 2e70 6e67 0a20 2020 2020 2020 2020  ke.png.         
+0000adc0: 2020 3a77 6964 7468 3a20 3730 300a 2020    :width: 700.  
+0000add0: 2020 2020 2020 2020 203a 616c 6967 6e3a           :align:
+0000ade0: 2063 656e 7465 720a 0a20 2020 2020 2020   center..       
+0000adf0: 203a 7061 7261 6d20 6e70 2e6e 6461 7272   :param np.ndarr
+0000ae00: 6179 2064 6174 613a 2054 6865 2069 6e70  ay data: The inp
+0000ae10: 7574 2031 4420 4e75 6d50 7920 6172 7261  ut 1D NumPy arra
+0000ae20: 7920 636f 6e74 6169 6e69 6e67 2074 6865  y containing the
+0000ae30: 2076 616c 7565 7320 746f 2062 6520 616e   values to be an
+0000ae40: 616c 797a 6564 2e0a 2020 2020 2020 2020  alyzed..        
+0000ae50: 3a70 6172 616d 2066 6c6f 6174 2074 6872  :param float thr
+0000ae60: 6573 686f 6c64 3a20 5468 6520 7468 7265  eshold: The thre
+0000ae70: 7368 6f6c 6420 7661 6c75 6520 7573 6564  shold value used
+0000ae80: 2066 6f72 2074 6865 2063 6f6d 7061 7269   for the compari
+0000ae90: 736f 6e2e 0a20 2020 2020 2020 203a 7061  son..        :pa
+0000aea0: 7261 6d20 6e70 2e6e 6461 7272 6179 2074  ram np.ndarray t
+0000aeb0: 696d 655f 7769 6e64 6f77 733a 2041 6e20  ime_windows: An 
+0000aec0: 6172 7261 7920 636f 6e74 6169 6e69 6e67  array containing
+0000aed0: 2074 6865 2074 696d 6520 7769 6e64 6f77   the time window
+0000aee0: 2073 697a 6573 2069 6e20 7365 636f 6e64   sizes in second
+0000aef0: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
+0000af00: 6d20 696e 7420 7361 6d70 6c65 5f72 6174  m int sample_rat
+0000af10: 653a 2054 6865 2073 616d 706c 6520 7261  e: The sample ra
+0000af20: 7465 2069 6e20 7361 6d70 6c65 7320 7065  te in samples pe
+0000af30: 7220 7365 636f 6e64 2e0a 2020 2020 2020  r second..      
+0000af40: 2020 3a70 6172 616d 2062 6f6f 6c20 6162    :param bool ab
+0000af50: 6f76 653a 2049 6620 5472 7565 2c20 7468  ove: If True, th
+0000af60: 6520 6675 6e63 7469 6f6e 206c 6f6f 6b73  e function looks
+0000af70: 2066 6f72 2073 7472 696b 6573 2077 6865   for strikes whe
+0000af80: 7265 2076 616c 7565 7320 6172 6520 6162  re values are ab
+0000af90: 6f76 6520 6f72 2065 7175 616c 2074 6f20  ove or equal to 
+0000afa0: 7468 6520 7468 7265 7368 6f6c 642e 2049  the threshold. I
+0000afb0: 6620 4661 6c73 652c 2069 7420 6c6f 6f6b  f False, it look
+0000afc0: 7320 666f 7220 7374 7269 6b65 7320 7768  s for strikes wh
+0000afd0: 6572 6520 7661 6c75 6573 2061 7265 2062  ere values are b
+0000afe0: 656c 6f77 206f 7220 6571 7561 6c20 746f  elow or equal to
+0000aff0: 2074 6865 2074 6872 6573 686f 6c64 2e0a   the threshold..
+0000b000: 2020 2020 2020 2020 3a72 6574 7572 6e20          :return 
+0000b010: 6e70 2e6e 6461 7272 6179 3a20 4120 3244  np.ndarray: A 2D
+0000b020: 204e 756d 5079 2061 7272 6179 2077 6974   NumPy array wit
+0000b030: 6820 6469 6d65 6e73 696f 6e73 2028 6461  h dimensions (da
+0000b040: 7461 2e73 6861 7065 5b30 5d2c 2074 696d  ta.shape[0], tim
+0000b050: 655f 7769 6e64 6f77 732e 7368 6170 655b  e_windows.shape[
+0000b060: 305d 292e 2045 6163 6820 656c 656d 656e  0]). Each elemen
+0000b070: 7420 696e 2074 6865 2061 7272 6179 2072  t in the array r
+0000b080: 6570 7265 7365 6e74 7320 7468 6520 6c65  epresents the le
+0000b090: 6e67 7468 206f 6620 7468 6520 6c6f 6e67  ngth of the long
+0000b0a0: 6573 7420 7374 7269 6b65 2074 6861 7420  est strike that 
+0000b0b0: 7361 7469 7366 6965 7320 7468 6520 636f  satisfies the co
+0000b0c0: 6e64 6974 696f 6e20 666f 7220 7468 650a  ndition for the.
+0000b0d0: 2020 2020 2020 2020 636f 7272 6573 706f          correspo
+0000b0e0: 6e64 696e 6720 7469 6d65 2077 696e 646f  nding time windo
+0000b0f0: 772e 0a0a 2020 2020 2020 2020 3a65 7861  w...        :exa
+0000b100: 6d70 6c65 3a0a 2020 2020 2020 2020 3e3e  mple:.        >>
+0000b110: 3e20 6461 7461 203d 206e 702e 6172 7261  > data = np.arra
+0000b120: 7928 5b31 2c20 382c 2032 2c20 3130 2c20  y([1, 8, 2, 10, 
+0000b130: 382c 2036 2c20 382c 2031 2c20 312c 2031  8, 6, 8, 1, 1, 1
+0000b140: 5d29 2e61 7374 7970 6528 6e70 2e66 6c6f  ]).astype(np.flo
+0000b150: 6174 3332 290a 2020 2020 2020 2020 3e3e  at32).        >>
+0000b160: 3e20 5469 6d65 7365 7269 6573 4665 6174  > TimeseriesFeat
+0000b170: 7572 654d 6978 696e 2829 2e73 6c69 6469  ureMixin().slidi
+0000b180: 6e67 5f6c 6f6e 6765 7374 5f73 7472 696b  ng_longest_strik
+0000b190: 6528 6461 7461 3d64 6174 612c 2074 6872  e(data=data, thr
+0000b1a0: 6573 686f 6c64 3d37 2c20 6162 6f76 653d  eshold=7, above=
+0000b1b0: 5472 7565 2c20 7469 6d65 5f77 696e 646f  True, time_windo
+0000b1c0: 7773 3d6e 702e 6172 7261 7928 5b31 2e30  ws=np.array([1.0
+0000b1d0: 5d29 2c20 7361 6d70 6c65 5f72 6174 653d  ]), sample_rate=
+0000b1e0: 3229 0a20 2020 2020 2020 203e 3e3e 205b  2).        >>> [
+0000b1f0: 5b2d 312e 5d5b 2031 2e5d 5b20 312e 5d5b  [-1.][ 1.][ 1.][
+0000b200: 2031 2e5d 5b20 322e 5d5b 2031 2e5d 5b20   1.][ 2.][ 1.][ 
+0000b210: 312e 5d5b 2031 2e5d 5b20 302e 5d5b 2030  1.][ 1.][ 0.][ 0
+0000b220: 2e5d 5d0a 2020 2020 2020 2020 3e3e 3e20  .]].        >>> 
+0000b230: 5469 6d65 7365 7269 6573 4665 6174 7572  TimeseriesFeatur
+0000b240: 654d 6978 696e 2829 2e73 6c69 6469 6e67  eMixin().sliding
+0000b250: 5f6c 6f6e 6765 7374 5f73 7472 696b 6528  _longest_strike(
+0000b260: 6461 7461 3d64 6174 612c 2074 6872 6573  data=data, thres
+0000b270: 686f 6c64 3d37 2c20 6162 6f76 653d 5472  hold=7, above=Tr
+0000b280: 7565 2c20 7469 6d65 5f77 696e 646f 7773  ue, time_windows
+0000b290: 3d6e 702e 6172 7261 7928 5b31 2e30 5d29  =np.array([1.0])
+0000b2a0: 2c20 7361 6d70 6c65 5f72 6174 653d 3229  , sample_rate=2)
+0000b2b0: 0a20 2020 2020 2020 203e 3e3e 205b 5b2d  .        >>> [[-
+0000b2c0: 312e 5d5b 2031 2e5d 5b20 312e 5d5b 2031  1.][ 1.][ 1.][ 1
+0000b2d0: 2e5d 5b20 302e 5d5b 2031 2e5d 5b20 312e  .][ 0.][ 1.][ 1.
+0000b2e0: 5d5b 2031 2e5d 5b20 322e 5d5b 2032 2e5d  ][ 1.][ 2.][ 2.]
+0000b2f0: 5d0a 2020 2020 2020 2020 2222 220a 0a20  ].        """.. 
+0000b300: 2020 2020 2020 2072 6573 756c 7473 203d         results =
+0000b310: 206e 702e 6675 6c6c 2828 6461 7461 2e73   np.full((data.s
+0000b320: 6861 7065 5b30 5d2c 2074 696d 655f 7769  hape[0], time_wi
+0000b330: 6e64 6f77 732e 7368 6170 655b 305d 292c  ndows.shape[0]),
+0000b340: 202d 312e 3029 0a0a 2020 2020 2020 2020   -1.0)..        
+0000b350: 666f 7220 6920 696e 2070 7261 6e67 6528  for i in prange(
+0000b360: 7469 6d65 5f77 696e 646f 7773 2e73 6861  time_windows.sha
+0000b370: 7065 5b30 5d29 3a0a 2020 2020 2020 2020  pe[0]):.        
+0000b380: 2020 2020 7769 6e64 6f77 5f73 697a 6520      window_size 
+0000b390: 3d20 696e 7428 7469 6d65 5f77 696e 646f  = int(time_windo
+0000b3a0: 7773 5b69 5d20 2a20 7361 6d70 6c65 5f72  ws[i] * sample_r
+0000b3b0: 6174 6529 0a20 2020 2020 2020 2020 2020  ate).           
+0000b3c0: 2066 6f72 206c 312c 2072 3120 696e 207a   for l1, r1 in z
+0000b3d0: 6970 280a 2020 2020 2020 2020 2020 2020  ip(.            
+0000b3e0: 2020 2020 7072 616e 6765 2830 2c20 6461      prange(0, da
+0000b3f0: 7461 2e73 6861 7065 5b30 5d20 2b20 3129  ta.shape[0] + 1)
+0000b400: 2c20 7072 616e 6765 2877 696e 646f 775f  , prange(window_
+0000b410: 7369 7a65 2c20 6461 7461 2e73 6861 7065  size, data.shape
+0000b420: 5b30 5d20 2b20 3129 0a20 2020 2020 2020  [0] + 1).       
+0000b430: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
+0000b440: 2020 2020 2020 2020 7361 6d70 6c65 203d          sample =
+0000b450: 2064 6174 615b 6c31 3a72 315d 0a20 2020   data[l1:r1].   
+0000b460: 2020 2020 2020 2020 2020 2020 2072 6573               res
+0000b470: 756c 742c 206c 2c20 722c 2063 6e74 203d  ult, l, r, cnt =
+0000b480: 202d 6e70 2e69 6e66 2c20 302c 2030 2c20   -np.inf, 0, 0, 
+0000b490: 300a 0a20 2020 2020 2020 2020 2020 2020  0..             
+0000b4a0: 2020 2077 6869 6c65 206c 203c 2073 616d     while l < sam
+0000b4b0: 706c 652e 7368 6170 655b 305d 3a0a 2020  ple.shape[0]:.  
+0000b4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b4d0: 2020 6966 2061 626f 7665 3a0a 2020 2020    if above:.    
+0000b4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b4f0: 2020 2020 6966 2073 616d 706c 655b 6c5d      if sample[l]
+0000b500: 203e 3d20 7468 7265 7368 6f6c 643a 0a20   >= threshold:. 
+0000b510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b520: 2020 2020 2020 2020 2020 2063 6e74 2c20             cnt, 
+0000b530: 7220 3d20 636e 7420 2b20 312c 2072 202b  r = cnt + 1, r +
+0000b540: 2031 0a20 2020 2020 2020 2020 2020 2020   1.             
+0000b550: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+0000b560: 6869 6c65 2073 616d 706c 655b 725d 203e  hile sample[r] >
+0000b570: 3d20 7468 7265 7368 6f6c 6420 616e 6420  = threshold and 
+0000b580: 7220 3c20 7361 6d70 6c65 2e73 6861 7065  r < sample.shape
+0000b590: 5b30 5d3a 0a20 2020 2020 2020 2020 2020  [0]:.           
+0000b5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b5b0: 2020 2020 2063 6e74 2c20 7220 3d20 636e       cnt, r = cn
+0000b5c0: 7420 2b20 312c 2072 202b 2031 0a20 2020  t + 1, r + 1.   
+0000b5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b5e0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0000b5f0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000b600: 6620 7361 6d70 6c65 5b6c 5d20 3c3d 2074  f sample[l] <= t
+0000b610: 6872 6573 686f 6c64 3a0a 2020 2020 2020  hreshold:.      
+0000b620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b630: 2020 2020 2020 636e 742c 2072 203d 2063        cnt, r = c
+0000b640: 6e74 202b 2031 2c20 7220 2b20 310a 2020  nt + 1, r + 1.  
+0000b650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b660: 2020 2020 2020 2020 2020 7768 696c 6520            while 
+0000b670: 7361 6d70 6c65 5b72 5d20 3c3d 2074 6872  sample[r] <= thr
+0000b680: 6573 686f 6c64 2061 6e64 2072 203c 2073  eshold and r < s
+0000b690: 616d 706c 652e 7368 6170 655b 305d 3a0a  ample.shape[0]:.
+0000b6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b6c0: 636e 742c 2072 203d 2063 6e74 202b 2031  cnt, r = cnt + 1
+0000b6d0: 2c20 7220 2b20 310a 0a20 2020 2020 2020  , r + 1..       
+0000b6e0: 2020 2020 2020 2020 2020 2020 206c 202b               l +
+0000b6f0: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
+0000b700: 2020 2020 2020 2020 6966 2063 6e74 203e          if cnt >
+0000b710: 2072 6573 756c 743a 0a20 2020 2020 2020   result:.       
+0000b720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b730: 2072 6573 756c 7420 3d20 636e 740a 2020   result = cnt.  
+0000b740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b750: 2020 6966 2064 6174 612e 7368 6170 655b    if data.shape[
+0000b760: 305d 202d 206c 203c 2072 6573 756c 743a  0] - l < result:
+0000b770: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b780: 2020 2020 2020 2020 2072 6573 756c 7473           results
+0000b790: 5b72 202d 2031 2c20 695d 203d 2072 6573  [r - 1, i] = res
+0000b7a0: 756c 740a 2020 2020 2020 2020 2020 2020  ult.            
+0000b7b0: 2020 2020 2020 2020 2020 2020 6272 6561              brea
+0000b7c0: 6b0a 2020 2020 2020 2020 2020 2020 2020  k.              
+0000b7d0: 2020 2020 2020 722c 2063 6e74 203d 206c        r, cnt = l
+0000b7e0: 2c20 300a 0a20 2020 2020 2020 2020 2020  , 0..           
+0000b7f0: 2020 2020 2072 6573 756c 7473 5b72 3120       results[r1 
+0000b800: 2d20 312c 2069 5d20 3d20 7265 7375 6c74  - 1, i] = result
+0000b810: 0a0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+0000b820: 7475 726e 2072 6573 756c 7473 0a0a 2020  turn results..  
+0000b830: 2020 4073 7461 7469 636d 6574 686f 640a    @staticmethod.
+0000b840: 2020 2020 406e 6a69 7428 0a20 2020 2020      @njit(.     
+0000b850: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
+0000b860: 2028 666c 6f61 7433 325b 3a5d 2c20 666c   (float32[:], fl
+0000b870: 6f61 7436 342c 2069 6e74 3634 2c20 626f  oat64, int64, bo
+0000b880: 6f6c 6561 6e29 2c0a 2020 2020 2020 2020  olean),.        
+0000b890: 2020 2020 2866 6c6f 6174 3332 5b3a 5d2c      (float32[:],
+0000b8a0: 2066 6c6f 6174 3634 2c20 696e 7436 342c   float64, int64,
+0000b8b0: 2074 7970 6573 2e6d 6973 632e 4f6d 6974   types.misc.Omit
+0000b8c0: 7465 6428 5472 7565 2929 2c0a 2020 2020  ted(True)),.    
+0000b8d0: 2020 2020 5d0a 2020 2020 290a 2020 2020      ].    ).    
+0000b8e0: 6465 6620 7469 6d65 5f73 696e 6365 5f70  def time_since_p
+0000b8f0: 7265 7669 6f75 735f 7468 7265 7368 6f6c  revious_threshol
+0000b900: 6428 0a20 2020 2020 2020 2064 6174 613a  d(.        data:
+0000b910: 206e 702e 6e64 6172 7261 792c 2074 6872   np.ndarray, thr
+0000b920: 6573 686f 6c64 3a20 666c 6f61 742c 2066  eshold: float, f
+0000b930: 7073 3a20 696e 742c 2061 626f 7665 3a20  ps: int, above: 
+0000b940: 626f 6f6c 0a20 2020 2029 202d 3e20 6e70  bool.    ) -> np
+0000b950: 2e6e 6461 7272 6179 3a0a 2020 2020 2020  .ndarray:.      
+0000b960: 2020 2222 220a 2020 2020 2020 2020 4a69    """.        Ji
+0000b970: 7474 6564 2063 6f6d 7075 7465 206f 6620  tted compute of 
+0000b980: 7468 6520 7469 6d65 2028 696e 2073 6563  the time (in sec
+0000b990: 6f6e 6473 2920 7468 6174 2068 6173 2065  onds) that has e
+0000b9a0: 6c61 7073 6564 2073 696e 6365 2074 6865  lapsed since the
+0000b9b0: 206c 6173 7420 6f63 6375 7272 656e 6365   last occurrence
+0000b9c0: 206f 6620 6120 7661 6c75 6520 6162 6f76   of a value abov
+0000b9d0: 6520 286f 7220 6265 6c6f 7729 0a20 2020  e (or below).   
+0000b9e0: 2020 2020 2061 2073 7065 6369 6669 6564       a specified
+0000b9f0: 2074 6872 6573 686f 6c64 2069 6e20 6120   threshold in a 
+0000ba00: 7469 6d65 2073 6572 6965 732e 2054 6865  time series. The
+0000ba10: 2074 696d 6520 7365 7269 6573 2069 7320   time series is 
+0000ba20: 6173 7375 6d65 6420 746f 2068 6176 6520  assumed to have 
+0000ba30: 6120 636f 6e73 7461 6e74 2073 616d 706c  a constant sampl
+0000ba40: 6520 7261 7465 2e0a 0a20 2020 2020 2020  e rate...       
+0000ba50: 202e 2e20 696d 6167 653a 3a20 5f73 7461   .. image:: _sta
+0000ba60: 7469 632f 696d 672f 7469 6d65 5f73 696e  tic/img/time_sin
+0000ba70: 6365 5f70 7265 7669 6f75 735f 7468 7265  ce_previous_thre
+0000ba80: 7368 6f6c 642e 706e 670a 2020 2020 2020  shold.png.      
+0000ba90: 2020 2020 203a 7769 6474 683a 2036 3030       :width: 600
+0000baa0: 0a20 2020 2020 2020 2020 2020 3a61 6c69  .           :ali
+0000bab0: 676e 3a20 6365 6e74 6572 0a0a 0a0a 2020  gn: center....  
+0000bac0: 2020 2020 2020 3a70 6172 616d 206e 702e        :param np.
+0000bad0: 6e64 6172 7261 7920 6461 7461 3a20 5468  ndarray data: Th
+0000bae0: 6520 696e 7075 7420 3144 2061 7272 6179  e input 1D array
+0000baf0: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
+0000bb00: 7469 6d65 2073 6572 6965 7320 6461 7461  time series data
+0000bb10: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0000bb20: 2069 6e74 2074 6872 6573 686f 6c64 3a20   int threshold: 
+0000bb30: 5468 6520 7468 7265 7368 6f6c 6420 7661  The threshold va
+0000bb40: 6c75 6520 7573 6564 2066 6f72 2074 6865  lue used for the
+0000bb50: 2063 6f6d 7061 7269 736f 6e2e 0a20 2020   comparison..   
+0000bb60: 2020 2020 203a 7061 7261 6d20 696e 7420       :param int 
+0000bb70: 6670 733a 2054 6865 2073 616d 706c 6520  fps: The sample 
+0000bb80: 7261 7465 206f 6620 7468 6520 7469 6d65  rate of the time
+0000bb90: 2073 6572 6965 7320 696e 2073 616d 706c   series in sampl
+0000bba0: 6573 2070 6572 2073 6563 6f6e 642e 0a20  es per second.. 
+0000bbb0: 2020 2020 2020 203a 7061 7261 6d20 626f         :param bo
+0000bbc0: 6f6c 2061 626f 7665 3a20 4966 2054 7275  ol above: If Tru
+0000bbd0: 652c 2074 6865 2066 756e 6374 696f 6e20  e, the function 
+0000bbe0: 6c6f 6f6b 7320 666f 7220 7661 6c75 6573  looks for values
+0000bbf0: 2061 626f 7665 206f 7220 6571 7561 6c20   above or equal 
+0000bc00: 746f 2074 6865 2074 6872 6573 686f 6c64  to the threshold
+0000bc10: 2e20 4966 2046 616c 7365 2c20 6974 206c  . If False, it l
+0000bc20: 6f6f 6b73 2066 6f72 2076 616c 7565 7320  ooks for values 
+0000bc30: 6265 6c6f 7720 6f72 2065 7175 616c 2074  below or equal t
+0000bc40: 6f20 7468 6520 7468 7265 7368 6f6c 642e  o the threshold.
+0000bc50: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+0000bc60: 206e 702e 6e64 6172 7261 793a 2041 2031   np.ndarray: A 1
+0000bc70: 4420 6172 7261 7920 6f66 2074 6865 2073  D array of the s
+0000bc80: 616d 6520 6c65 6e67 7468 2061 7320 7468  ame length as th
+0000bc90: 6520 696e 7075 7420 6461 7461 2e20 4561  e input data. Ea
+0000bca0: 6368 2065 6c65 6d65 6e74 2072 6570 7265  ch element repre
+0000bcb0: 7365 6e74 7320 7468 6520 7469 6d65 2065  sents the time e
+0000bcc0: 6c61 7073 6564 2028 696e 2073 6563 6f6e  lapsed (in secon
+0000bcd0: 6473 2920 7369 6e63 6520 7468 6520 6c61  ds) since the la
+0000bce0: 7374 206f 6363 7572 7265 6e63 6520 6f66  st occurrence of
+0000bcf0: 2074 6865 2074 6872 6573 686f 6c64 2076   the threshold v
+0000bd00: 616c 7565 2e20 4966 206e 6f20 7468 7265  alue. If no thre
+0000bd10: 7368 6f6c 6420 7661 6c75 6520 6973 2066  shold value is f
+0000bd20: 6f75 6e64 2062 6566 6f72 6520 7468 6520  ound before the 
+0000bd30: 6375 7272 656e 7420 6461 7461 2070 6f69  current data poi
+0000bd40: 6e74 2c20 7468 6520 636f 7272 6573 706f  nt, the correspo
+0000bd50: 6e64 696e 6720 7265 7375 6c74 2069 7320  nding result is 
+0000bd60: 7365 7420 746f 202d 312e 302e 0a0a 2020  set to -1.0...  
+0000bd70: 2020 2020 2020 3a65 7861 6d70 6c65 733a        :examples:
+0000bd80: 0a20 2020 2020 2020 203e 3e3e 2064 6174  .        >>> dat
+0000bd90: 6120 3d20 6e70 2e61 7272 6179 285b 312c  a = np.array([1,
+0000bda0: 2038 2c20 322c 2031 302c 2038 2c20 362c   8, 2, 10, 8, 6,
+0000bdb0: 2038 2c20 312c 2031 2c20 315d 292e 6173   8, 1, 1, 1]).as
+0000bdc0: 7479 7065 286e 702e 666c 6f61 7433 3229  type(np.float32)
+0000bdd0: 0a20 2020 2020 2020 203e 3e3e 2054 696d  .        >>> Tim
+0000bde0: 6573 6572 6965 7346 6561 7475 7265 4d69  eseriesFeatureMi
+0000bdf0: 7869 6e28 292e 7469 6d65 5f73 696e 6365  xin().time_since
+0000be00: 5f70 7265 7669 6f75 735f 7468 7265 7368  _previous_thresh
+0000be10: 6f6c 6428 6461 7461 3d64 6174 612c 2074  old(data=data, t
+0000be20: 6872 6573 686f 6c64 3d37 2e30 2c20 6162  hreshold=7.0, ab
+0000be30: 6f76 653d 5472 7565 2c20 7361 6d70 6c65  ove=True, sample
+0000be40: 5f72 6174 653d 322e 3029 0a20 2020 2020  _rate=2.0).     
+0000be50: 2020 203e 3e3e 205b 2d31 2e20 2c20 2030     >>> [-1. ,  0
+0000be60: 2e20 2c20 2030 2e35 2c20 2030 2e20 2c20  . ,  0.5,  0. , 
+0000be70: 2030 2e20 2c20 2030 2e35 2c20 2030 2e20   0. ,  0.5,  0. 
+0000be80: 2c20 2030 2e35 2c20 2031 2e20 2c20 2031  ,  0.5,  1. ,  1
+0000be90: 2e35 5d0a 2020 2020 2020 2020 3e3e 3e20  .5].        >>> 
+0000bea0: 5469 6d65 7365 7269 6573 4665 6174 7572  TimeseriesFeatur
+0000beb0: 654d 6978 696e 2829 2e74 696d 655f 7369  eMixin().time_si
+0000bec0: 6e63 655f 7072 6576 696f 7573 5f74 6872  nce_previous_thr
+0000bed0: 6573 686f 6c64 2864 6174 613d 6461 7461  eshold(data=data
+0000bee0: 2c20 7468 7265 7368 6f6c 643d 372e 302c  , threshold=7.0,
+0000bef0: 2061 626f 7665 3d46 616c 7365 2c20 7361   above=False, sa
+0000bf00: 6d70 6c65 5f72 6174 653d 322e 3029 0a20  mple_rate=2.0). 
+0000bf10: 2020 2020 2020 203e 3e3e 205b 302e 202c         >>> [0. ,
+0000bf20: 2030 2e35 2c20 302e 202c 2030 2e35 2c20   0.5, 0. , 0.5, 
+0000bf30: 312e 202c 2030 2e20 2c20 302e 352c 2030  1. , 0. , 0.5, 0
+0000bf40: 2e20 2c20 302e 202c 2030 2e20 5d0a 2020  . , 0. , 0. ].  
+0000bf50: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+0000bf60: 2020 2072 6573 756c 7473 203d 206e 702e     results = np.
+0000bf70: 6675 6c6c 2828 6461 7461 2e73 6861 7065  full((data.shape
+0000bf80: 5b30 5d29 2c20 2d31 2e30 290a 2020 2020  [0]), -1.0).    
+0000bf90: 2020 2020 6966 2061 626f 7665 3a0a 2020      if above:.  
+0000bfa0: 2020 2020 2020 2020 2020 6372 6974 6572            criter
+0000bfb0: 696f 6e5f 6964 7820 3d20 6e70 2e61 7267  ion_idx = np.arg
+0000bfc0: 7768 6572 6528 6461 7461 203e 2074 6872  where(data > thr
+0000bfd0: 6573 686f 6c64 292e 666c 6174 7465 6e28  eshold).flatten(
+0000bfe0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+0000bff0: 2020 2020 2020 2020 2020 2020 6372 6974              crit
+0000c000: 6572 696f 6e5f 6964 7820 3d20 6e70 2e61  erion_idx = np.a
+0000c010: 7267 7768 6572 6528 6461 7461 203c 2074  rgwhere(data < t
+0000c020: 6872 6573 686f 6c64 292e 666c 6174 7465  hreshold).flatte
+0000c030: 6e28 290a 0a20 2020 2020 2020 2066 6f72  n()..        for
+0000c040: 2069 2069 6e20 7072 616e 6765 2864 6174   i in prange(dat
+0000c050: 612e 7368 6170 655b 305d 293a 0a20 2020  a.shape[0]):.   
+0000c060: 2020 2020 2020 2020 2069 6620 6162 6f76           if abov
+0000c070: 6520 616e 6420 2864 6174 615b 695d 203e  e and (data[i] >
+0000c080: 2074 6872 6573 686f 6c64 293a 0a20 2020   threshold):.   
+0000c090: 2020 2020 2020 2020 2020 2020 2072 6573               res
+0000c0a0: 756c 7473 5b69 5d20 3d20 302e 300a 2020  ults[i] = 0.0.  
+0000c0b0: 2020 2020 2020 2020 2020 656c 6966 206e            elif n
+0000c0c0: 6f74 2061 626f 7665 2061 6e64 2028 6461  ot above and (da
+0000c0d0: 7461 5b69 5d20 3c20 7468 7265 7368 6f6c  ta[i] < threshol
+0000c0e0: 6429 3a0a 2020 2020 2020 2020 2020 2020  d):.            
+0000c0f0: 2020 2020 7265 7375 6c74 735b 695d 203d      results[i] =
+0000c100: 2030 2e30 0a20 2020 2020 2020 2020 2020   0.0.           
+0000c110: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0000c120: 2020 2020 2020 2078 203d 2063 7269 7465         x = crite
+0000c130: 7269 6f6e 5f69 6478 5b6e 702e 6172 6777  rion_idx[np.argw
+0000c140: 6865 7265 2863 7269 7465 7269 6f6e 5f69  here(criterion_i
+0000c150: 6478 203c 2069 292e 666c 6174 7465 6e28  dx < i).flatten(
+0000c160: 295d 0a20 2020 2020 2020 2020 2020 2020  )].             
+0000c170: 2020 2069 6620 6c65 6e28 7829 203e 2030     if len(x) > 0
+0000c180: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000c190: 2020 2020 2020 7265 7375 6c74 735b 695d        results[i]
+0000c1a0: 203d 2028 6920 2d20 785b 2d31 5d29 202f   = (i - x[-1]) /
+0000c1b0: 2066 7073 0a0a 2020 2020 2020 2020 7265   fps..        re
+0000c1c0: 7475 726e 2072 6573 756c 7473 0a0a 2020  turn results..  
+0000c1d0: 2020 4073 7461 7469 636d 6574 686f 640a    @staticmethod.
+0000c1e0: 2020 2020 406e 6a69 7428 0a20 2020 2020      @njit(.     
+0000c1f0: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
+0000c200: 2028 666c 6f61 7433 325b 3a5d 2c20 666c   (float32[:], fl
+0000c210: 6f61 7436 342c 2069 6e74 3634 2c20 626f  oat64, int64, bo
+0000c220: 6f6c 6561 6e29 2c0a 2020 2020 2020 2020  olean),.        
+0000c230: 2020 2020 2866 6c6f 6174 3332 5b3a 5d2c      (float32[:],
+0000c240: 2066 6c6f 6174 3634 2c20 696e 7436 342c   float64, int64,
+0000c250: 2074 7970 6573 2e6d 6973 632e 4f6d 6974   types.misc.Omit
+0000c260: 7465 6428 5472 7565 2929 2c0a 2020 2020  ted(True)),.    
+0000c270: 2020 2020 5d0a 2020 2020 290a 2020 2020      ].    ).    
+0000c280: 6465 6620 7469 6d65 5f73 696e 6365 5f70  def time_since_p
+0000c290: 7265 7669 6f75 735f 7461 7267 6574 5f76  revious_target_v
+0000c2a0: 616c 7565 280a 2020 2020 2020 2020 6461  alue(.        da
+0000c2b0: 7461 3a20 6e70 2e6e 6461 7272 6179 2c20  ta: np.ndarray, 
+0000c2c0: 7661 6c75 653a 2066 6c6f 6174 2c20 6670  value: float, fp
+0000c2d0: 733a 2069 6e74 2c20 696e 7665 7273 653a  s: int, inverse:
+0000c2e0: 2062 6f6f 6c20 3d20 4661 6c73 650a 2020   bool = False.  
+0000c2f0: 2020 2920 2d3e 206e 702e 6e64 6172 7261    ) -> np.ndarra
+0000c300: 793a 0a20 2020 2020 2020 2022 2222 0a20  y:.        """. 
+0000c310: 2020 2020 2020 2043 616c 6375 6c61 7465         Calculate
+0000c320: 2074 6865 2074 696d 6520 6475 7261 7469   the time durati
+0000c330: 6f6e 2028 696e 2073 6563 6f6e 6473 2920  on (in seconds) 
+0000c340: 7369 6e63 6520 7468 6520 7072 6576 696f  since the previo
+0000c350: 7573 206f 6363 7572 7265 6e63 6520 6f66  us occurrence of
+0000c360: 2061 2073 7065 6369 6669 6320 7661 6c75   a specific valu
+0000c370: 6520 696e 2061 2064 6174 6120 6172 7261  e in a data arra
+0000c380: 792e 0a0a 2020 2020 2020 2020 4361 6c63  y...        Calc
+0000c390: 756c 6174 6573 2074 6865 2074 696d 6520  ulates the time 
+0000c3a0: 6475 7261 7469 6f6e 2c20 696e 2073 6563  duration, in sec
+0000c3b0: 6f6e 6473 2c20 6265 7477 6565 6e20 6561  onds, between ea
+0000c3c0: 6368 2064 6174 6120 706f 696e 7420 616e  ch data point an
+0000c3d0: 6420 7468 6520 7072 6576 696f 7573 206f  d the previous o
+0000c3e0: 6363 7572 7265 6e63 650a 2020 2020 2020  ccurrence.      
+0000c3f0: 2020 6f66 2061 2073 7065 6369 6669 6320    of a specific 
+0000c400: 7661 6c75 6520 7769 7468 696e 2074 6865  value within the
+0000c410: 2064 6174 6120 6172 7261 792e 0a0a 2020   data array...  
+0000c420: 2020 2020 2020 2e2e 2069 6d61 6765 3a3a        .. image::
+0000c430: 205f 7374 6174 6963 2f69 6d67 2f74 696d   _static/img/tim
+0000c440: 655f 7369 6e63 655f 7072 6576 696f 7573  e_since_previous
+0000c450: 5f74 6172 6765 745f 7661 6c75 652e 706e  _target_value.pn
+0000c460: 670a 2020 2020 2020 2020 2020 203a 7769  g.           :wi
+0000c470: 6474 683a 2037 3030 0a20 2020 2020 2020  dth: 700.       
+0000c480: 2020 2020 3a61 6c69 676e 3a20 6365 6e74      :align: cent
+0000c490: 6572 0a0a 2020 2020 2020 2020 3a70 6172  er..        :par
+0000c4a0: 616d 206e 702e 6e64 6172 7261 7920 6461  am np.ndarray da
+0000c4b0: 7461 3a20 5468 6520 696e 7075 7420 3144  ta: The input 1D
+0000c4c0: 2061 7272 6179 2063 6f6e 7461 696e 696e   array containin
+0000c4d0: 6720 7468 6520 7469 6d65 2073 6572 6965  g the time serie
+0000c4e0: 7320 6461 7461 2e0a 2020 2020 2020 2020  s data..        
+0000c4f0: 3a70 6172 616d 2066 6c6f 6174 2076 616c  :param float val
+0000c500: 7565 3a20 5468 6520 7370 6563 6966 6963  ue: The specific
+0000c510: 2076 616c 7565 2074 6f20 7365 6172 6368   value to search
+0000c520: 2066 6f72 2069 6e20 7468 6520 6461 7461   for in the data
+0000c530: 2061 7272 6179 2e0a 2020 2020 2020 2020   array..        
+0000c540: 3a70 6172 616d 2069 6e74 2073 616d 706c  :param int sampl
+0000c550: 655f 7261 7465 3a20 5468 6520 7361 6d70  e_rate: The samp
+0000c560: 6c69 6e67 2072 6174 6520 7768 6963 6820  ling rate which 
+0000c570: 6461 7461 2070 6f69 6e74 7320 7765 7265  data points were
+0000c580: 2063 6f6c 6c65 6374 6564 2e20 4974 2069   collected. It i
+0000c590: 7320 7573 6564 2074 6f20 6361 6c63 756c  s used to calcul
+0000c5a0: 6174 6520 7468 6520 7469 6d65 2064 7572  ate the time dur
+0000c5b0: 6174 696f 6e20 696e 2073 6563 6f6e 6473  ation in seconds
+0000c5c0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0000c5d0: 2062 6f6f 6c20 696e 7665 7273 653a 2049   bool inverse: I
+0000c5e0: 6620 5472 7565 2c20 7468 6520 6675 6e63  f True, the func
+0000c5f0: 7469 6f6e 2063 616c 6375 6c61 7465 7320  tion calculates 
+0000c600: 7468 6520 7469 6d65 2073 696e 6365 2074  the time since t
+0000c610: 6865 2070 7265 7669 6f75 7320 7661 6c75  he previous valu
+0000c620: 6520 7468 6174 2069 7320 4e4f 5420 6571  e that is NOT eq
+0000c630: 7561 6c20 746f 2074 6865 2073 7065 6369  ual to the speci
+0000c640: 6669 6564 2027 7661 6c75 6527 2e20 4966  fied 'value'. If
+0000c650: 2046 616c 7365 2c20 6974 2063 616c 6375   False, it calcu
+0000c660: 6c61 7465 7320 7468 6520 7469 6d65 2073  lates the time s
+0000c670: 696e 6365 2074 6865 2070 7265 7669 6f75  ince the previou
+0000c680: 7320 6f63 6375 7272 656e 6365 206f 6620  s occurrence of 
+0000c690: 7468 6520 7370 6563 6966 6965 6420 2776  the specified 'v
+0000c6a0: 616c 7565 272e 0a20 2020 2020 2020 203a  alue'..        :
+0000c6b0: 7265 7475 726e 7320 6e70 2e6e 6461 7272  returns np.ndarr
+0000c6c0: 6179 3a20 4120 3144 204e 756d 5079 2061  ay: A 1D NumPy a
+0000c6d0: 7272 6179 2063 6f6e 7461 696e 696e 6720  rray containing 
+0000c6e0: 7468 6520 7469 6d65 2064 7572 6174 696f  the time duratio
+0000c6f0: 6e20 2869 6e20 7365 636f 6e64 7329 2073  n (in seconds) s
+0000c700: 696e 6365 2074 6865 2070 7265 7669 6f75  ince the previou
+0000c710: 7320 6f63 6375 7272 656e 6365 206f 6620  s occurrence of 
+0000c720: 7468 6520 7370 6563 6966 6965 6420 2776  the specified 'v
+0000c730: 616c 7565 2720 666f 7220 6561 6368 2064  alue' for each d
+0000c740: 6174 6120 706f 696e 742e 0a0a 2020 2020  ata point...    
+0000c750: 2020 2020 3a65 7861 6d70 6c65 3a0a 2020      :example:.  
+0000c760: 2020 2020 2020 3e3e 3e20 6461 7461 203d        >>> data =
+0000c770: 206e 702e 6172 7261 7928 5b38 2c20 382c   np.array([8, 8,
+0000c780: 2032 2c20 3130 2c20 382c 2036 2c20 382c   2, 10, 8, 6, 8,
+0000c790: 2031 2c20 312c 2031 5d29 2e61 7374 7970   1, 1, 1]).astyp
+0000c7a0: 6528 6e70 2e66 6c6f 6174 3332 290a 2020  e(np.float32).  
+0000c7b0: 2020 2020 2020 3e3e 3e20 5469 6d65 7365        >>> Timese
+0000c7c0: 7269 6573 4665 6174 7572 654d 6978 696e  riesFeatureMixin
+0000c7d0: 2829 2e74 696d 655f 7369 6e63 655f 7072  ().time_since_pr
+0000c7e0: 6576 696f 7573 5f74 6172 6765 745f 7661  evious_target_va
+0000c7f0: 6c75 6528 6461 7461 3d64 6174 612c 2076  lue(data=data, v
+0000c800: 616c 7565 3d38 2e30 2c20 696e 7665 7273  alue=8.0, invers
+0000c810: 653d 4661 6c73 652c 2073 616d 706c 655f  e=False, sample_
+0000c820: 7261 7465 3d32 2e30 290a 2020 2020 2020  rate=2.0).      
+0000c830: 2020 3e3e 3e20 5b30 2e20 2c20 302e 202c    >>> [0. , 0. ,
+0000c840: 2030 2e35 2c20 312e 202c 2030 2e20 2c20   0.5, 1. , 0. , 
+0000c850: 302e 352c 2030 2e20 2c20 302e 352c 2031  0.5, 0. , 0.5, 1
+0000c860: 2e20 2c20 312e 355d 290a 2020 2020 2020  . , 1.5]).      
+0000c870: 2020 3e3e 3e20 5469 6d65 7365 7269 6573    >>> Timeseries
+0000c880: 4665 6174 7572 654d 6978 696e 2829 2e74  FeatureMixin().t
+0000c890: 696d 655f 7369 6e63 655f 7072 6576 696f  ime_since_previo
+0000c8a0: 7573 5f74 6172 6765 745f 7661 6c75 6528  us_target_value(
+0000c8b0: 6461 7461 3d64 6174 612c 2076 616c 7565  data=data, value
+0000c8c0: 3d38 2e30 2c20 696e 7665 7273 653d 5472  =8.0, inverse=Tr
+0000c8d0: 7565 2c20 7361 6d70 6c65 5f72 6174 653d  ue, sample_rate=
+0000c8e0: 322e 3029 0a20 2020 2020 2020 203e 3e3e  2.0).        >>>
+0000c8f0: 205b 2d31 2e20 2c20 2d31 2e20 2c20 2030   [-1. , -1. ,  0
+0000c900: 2e20 2c20 2030 2e20 2c20 2030 2e35 2c20  . ,  0. ,  0.5, 
+0000c910: 2030 2e20 2c20 2030 2e35 2c20 2030 2e20   0. ,  0.5,  0. 
+0000c920: 2c20 2030 2e20 2c20 2030 2e20 5d0a 2020  ,  0. ,  0. ].  
+0000c930: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+0000c940: 2020 2072 6573 756c 7473 203d 206e 702e     results = np.
+0000c950: 6675 6c6c 2828 6461 7461 2e73 6861 7065  full((data.shape
+0000c960: 5b30 5d29 2c20 2d31 2e30 290a 2020 2020  [0]), -1.0).    
+0000c970: 2020 2020 6966 206e 6f74 2069 6e76 6572      if not inver
+0000c980: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0000c990: 6372 6974 6572 696f 6e5f 6964 7820 3d20  criterion_idx = 
+0000c9a0: 6e70 2e61 7267 7768 6572 6528 6461 7461  np.argwhere(data
+0000c9b0: 203d 3d20 7661 6c75 6529 2e66 6c61 7474   == value).flatt
+0000c9c0: 656e 2829 0a20 2020 2020 2020 2065 6c73  en().        els
+0000c9d0: 653a 0a20 2020 2020 2020 2020 2020 2063  e:.            c
+0000c9e0: 7269 7465 7269 6f6e 5f69 6478 203d 206e  riterion_idx = n
+0000c9f0: 702e 6172 6777 6865 7265 2864 6174 6120  p.argwhere(data 
+0000ca00: 213d 2076 616c 7565 292e 666c 6174 7465  != value).flatte
+0000ca10: 6e28 290a 2020 2020 2020 2020 6966 2063  n().        if c
+0000ca20: 7269 7465 7269 6f6e 5f69 6478 2e73 6861  riterion_idx.sha
+0000ca30: 7065 5b30 5d20 3d3d 2030 3a0a 2020 2020  pe[0] == 0:.    
+0000ca40: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+0000ca50: 702e 6675 6c6c 2828 6461 7461 2e73 6861  p.full((data.sha
+0000ca60: 7065 5b30 5d29 2c20 2d31 2e30 290a 2020  pe[0]), -1.0).  
+0000ca70: 2020 2020 2020 666f 7220 6920 696e 2070        for i in p
+0000ca80: 7261 6e67 6528 6461 7461 2e73 6861 7065  range(data.shape
+0000ca90: 5b30 5d29 3a0a 2020 2020 2020 2020 2020  [0]):.          
+0000caa0: 2020 6966 206e 6f74 2069 6e76 6572 7365    if not inverse
+0000cab0: 2061 6e64 2028 6461 7461 5b69 5d20 3d3d   and (data[i] ==
+0000cac0: 2076 616c 7565 293a 0a20 2020 2020 2020   value):.       
+0000cad0: 2020 2020 2020 2020 2072 6573 756c 7473           results
+0000cae0: 5b69 5d20 3d20 300a 2020 2020 2020 2020  [i] = 0.        
+0000caf0: 2020 2020 656c 6966 2069 6e76 6572 7365      elif inverse
+0000cb00: 2061 6e64 2028 6461 7461 5b69 5d20 213d   and (data[i] !=
+0000cb10: 2076 616c 7565 293a 0a20 2020 2020 2020   value):.       
+0000cb20: 2020 2020 2020 2020 2072 6573 756c 7473           results
+0000cb30: 5b69 5d20 3d20 300a 2020 2020 2020 2020  [i] = 0.        
+0000cb40: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0000cb50: 2020 2020 2020 2020 2020 7820 3d20 6372            x = cr
+0000cb60: 6974 6572 696f 6e5f 6964 785b 6e70 2e61  iterion_idx[np.a
+0000cb70: 7267 7768 6572 6528 6372 6974 6572 696f  rgwhere(criterio
+0000cb80: 6e5f 6964 7820 3c20 6929 2e66 6c61 7474  n_idx < i).flatt
+0000cb90: 656e 2829 5d0a 2020 2020 2020 2020 2020  en()].          
+0000cba0: 2020 2020 2020 6966 206c 656e 2878 2920        if len(x) 
+0000cbb0: 3e20 303a 0a20 2020 2020 2020 2020 2020  > 0:.           
+0000cbc0: 2020 2020 2020 2020 2072 6573 756c 7473           results
+0000cbd0: 5b69 5d20 3d20 2869 202d 2078 5b2d 315d  [i] = (i - x[-1]
+0000cbe0: 2920 2f20 6670 730a 2020 2020 2020 2020  ) / fps.        
+0000cbf0: 7265 7475 726e 2072 6573 756c 7473 0a0a  return results..
+0000cc00: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
+0000cc10: 640a 2020 2020 406e 6a69 7428 2228 666c  d.    @njit("(fl
+0000cc20: 6f61 7433 325b 3a5d 2c29 2229 0a20 2020  oat32[:],)").   
+0000cc30: 2064 6566 2062 656e 666f 7264 5f63 6f72   def benford_cor
+0000cc40: 7265 6c61 7469 6f6e 2864 6174 613a 206e  relation(data: n
+0000cc50: 702e 6e64 6172 7261 7929 202d 3e20 666c  p.ndarray) -> fl
+0000cc60: 6f61 743a 0a20 2020 2020 2020 2022 2222  oat:.        """
+0000cc70: 0a20 2020 2020 2020 204a 6974 7465 6420  .        Jitted 
+0000cc80: 636f 6d70 7574 6520 6f66 2074 6865 2063  compute of the c
+0000cc90: 6f72 7265 6c61 7469 6f6e 2062 6574 7765  orrelation betwe
+0000cca0: 656e 2074 6865 2042 656e 666f 7264 2773  en the Benford's
+0000ccb0: 204c 6177 2064 6973 7472 6962 7574 696f   Law distributio
+0000ccc0: 6e20 616e 6420 7468 6520 6669 7273 742d  n and the first-
+0000ccd0: 6469 6769 7420 6469 7374 7269 6275 7469  digit distributi
+0000cce0: 6f6e 206f 6620 6769 7665 6e20 6461 7461  on of given data
+0000ccf0: 2e0a 0a20 2020 2020 2020 2042 656e 666f  ...        Benfo
+0000cd00: 7264 2773 204c 6177 2064 6573 6372 6962  rd's Law describ
+0000cd10: 6573 2074 6865 2065 7870 6563 7465 6420  es the expected 
+0000cd20: 6469 7374 7269 6275 7469 6f6e 206f 6620  distribution of 
+0000cd30: 6c65 6164 696e 6720 2866 6972 7374 2920  leading (first) 
+0000cd40: 6469 6769 7473 2069 6e20 6d61 6e79 2072  digits in many r
+0000cd50: 6561 6c2d 6c69 6665 2064 6174 6173 6574  eal-life dataset
+0000cd60: 732e 2054 6869 7320 6675 6e63 7469 6f6e  s. This function
+0000cd70: 0a20 2020 2020 2020 2063 616c 6375 6c61  .        calcula
+0000cd80: 7465 7320 7468 6520 636f 7272 656c 6174  tes the correlat
+0000cd90: 696f 6e20 6265 7477 6565 6e20 7468 6520  ion between the 
+0000cda0: 6578 7065 6374 6564 2042 656e 666f 7264  expected Benford
+0000cdb0: 2773 204c 6177 2064 6973 7472 6962 7574  's Law distribut
+0000cdc0: 696f 6e20 616e 6420 7468 6520 6163 7475  ion and the actu
+0000cdd0: 616c 2064 6973 7472 6962 7574 696f 6e20  al distribution 
+0000cde0: 6f66 2074 6865 0a20 2020 2020 2020 2066  of the.        f
+0000cdf0: 6972 7374 2064 6967 6974 7320 696e 2074  irst digits in t
+0000ce00: 6865 2070 726f 7669 6465 6420 6461 7461  he provided data
+0000ce10: 2e0a 0a20 2020 2020 2020 202e 2e20 696d  ...        .. im
+0000ce20: 6167 653a 3a20 5f73 7461 7469 632f 696d  age:: _static/im
+0000ce30: 672f 6265 6e66 6f72 645f 636f 7272 656c  g/benford_correl
+0000ce40: 6174 696f 6e2e 706e 670a 2020 2020 2020  ation.png.      
+0000ce50: 2020 2020 203a 7769 6474 683a 2036 3030       :width: 600
+0000ce60: 0a20 2020 2020 2020 2020 2020 3a61 6c69  .           :ali
+0000ce70: 676e 3a20 6365 6e74 6572 0a0a 2020 2020  gn: center..    
+0000ce80: 2020 2020 2e2e 206e 6f74 653a 3a0a 2020      .. note::.  
+0000ce90: 2020 2020 2020 2020 2041 6461 7074 6564           Adapted
+0000cea0: 2066 726f 6d20 6074 7366 7265 7368 203c   from `tsfresh <
+0000ceb0: 6874 7470 733a 2f2f 7473 6672 6573 682e  https://tsfresh.
+0000cec0: 7265 6164 7468 6564 6f63 732e 696f 2f65  readthedocs.io/e
+0000ced0: 6e2f 6c61 7465 7374 2f5f 6d6f 6475 6c65  n/latest/_module
+0000cee0: 732f 7473 6672 6573 682f 6665 6174 7572  s/tsfresh/featur
+0000cef0: 655f 6578 7472 6163 7469 6f6e 2f66 6561  e_extraction/fea
+0000cf00: 7475 7265 5f63 616c 6375 6c61 746f 7273  ture_calculators
+0000cf10: 2e68 746d 6c23 6265 6e66 6f72 645f 636f  .html#benford_co
+0000cf20: 7272 656c 6174 696f 6e3e 605f 2e0a 0a20  rrelation>`_... 
+0000cf30: 2020 2020 2020 2020 2020 5468 6520 7265            The re
+0000cf40: 7475 726e 6564 2063 6f72 7265 6c61 7469  turned correlati
+0000cf50: 6f6e 2076 616c 7565 7320 6172 6520 6361  on values are ca
+0000cf60: 6c63 756c 6174 6564 2075 7369 6e67 2050  lculated using P
+0000cf70: 6561 7273 6f6e 2773 2063 6f72 7265 6c61  earson's correla
+0000cf80: 7469 6f6e 2063 6f65 6666 6963 6965 6e74  tion coefficient
+0000cf90: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+0000cfa0: 6d20 6e70 2e6e 6461 7272 6179 2064 6174  m np.ndarray dat
+0000cfb0: 613a 2054 6865 2069 6e70 7574 2031 4420  a: The input 1D 
+0000cfc0: 6172 7261 7920 636f 6e74 6169 6e69 6e67  array containing
+0000cfd0: 2074 6865 2074 696d 6520 7365 7269 6573   the time series
+0000cfe0: 2064 6174 612e 0a20 2020 2020 2020 203a   data..        :
+0000cff0: 7265 7475 726e 2066 6c6f 6174 3a20 5468  return float: Th
+0000d000: 6520 636f 7272 656c 6174 696f 6e20 636f  e correlation co
+0000d010: 6566 6669 6369 656e 7420 6265 7477 6565  efficient betwee
+0000d020: 6e20 7468 6520 4265 6e66 6f72 6427 7320  n the Benford's 
+0000d030: 4c61 7720 6469 7374 7269 6275 7469 6f6e  Law distribution
+0000d040: 2061 6e64 2074 6865 2066 6972 7374 2d64   and the first-d
+0000d050: 6967 6974 2064 6973 7472 6962 7574 696f  igit distributio
+0000d060: 6e20 696e 2074 6865 2069 6e70 7574 2064  n in the input d
+0000d070: 6174 612e 2041 2068 6967 6865 7220 636f  ata. A higher co
+0000d080: 7272 656c 6174 696f 6e20 7661 6c75 6520  rrelation value 
+0000d090: 7375 6767 6573 7473 2074 6861 7420 7468  suggests that th
+0000d0a0: 6520 6461 7461 2066 6f6c 6c6f 7773 2074  e data follows t
+0000d0b0: 6865 2065 7870 6563 7465 6420 6469 7374  he expected dist
+0000d0c0: 7269 6275 7469 6f6e 206d 6f72 6520 636c  ribution more cl
+0000d0d0: 6f73 656c 792e 0a0a 2020 2020 2020 2020  osely...        
+0000d0e0: 3a65 7861 6d70 6c65 733a 0a20 2020 2020  :examples:.     
+0000d0f0: 2020 203e 3e3e 2064 6174 6120 3d20 6e70     >>> data = np
+0000d100: 2e61 7272 6179 285b 312c 2038 2c20 322c  .array([1, 8, 2,
+0000d110: 2031 302c 2038 2c20 362c 2038 2c20 312c   10, 8, 6, 8, 1,
+0000d120: 2031 2c20 315d 292e 6173 7479 7065 286e   1, 1]).astype(n
+0000d130: 702e 666c 6f61 7433 3229 0a20 2020 2020  p.float32).     
+0000d140: 2020 203e 3e3e 2054 696d 6573 6572 6965     >>> Timeserie
+0000d150: 7346 6561 7475 7265 4d69 7869 6e28 292e  sFeatureMixin().
+0000d160: 6265 6e66 6f72 645f 636f 7272 656c 6174  benford_correlat
+0000d170: 696f 6e28 6461 7461 3d64 6174 6129 0a20  ion(data=data). 
+0000d180: 2020 2020 2020 203e 3e3e 2030 2e36 3739         >>> 0.679
+0000d190: 3735 3030 3337 3438 3331 3738 360a 2020  7500374831786.  
+0000d1a0: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+0000d1b0: 2020 2064 6174 6120 3d20 6e70 2e61 6273     data = np.abs
+0000d1c0: 2864 6174 6129 0a20 2020 2020 2020 2062  (data).        b
+0000d1d0: 656e 666f 7264 5f64 6973 7472 6962 7574  enford_distribut
+0000d1e0: 696f 6e20 3d20 6e70 2e61 7272 6179 285b  ion = np.array([
+0000d1f0: 6e70 2e6c 6f67 3130 2831 202b 2031 202f  np.log10(1 + 1 /
+0000d200: 206e 2920 666f 7220 6e20 696e 2072 616e   n) for n in ran
+0000d210: 6765 2831 2c20 3130 295d 290a 2020 2020  ge(1, 10)]).    
+0000d220: 2020 2020 6669 7273 745f 7661 6c73 2c20      first_vals, 
+0000d230: 6469 6769 745f 7261 7469 6f20 3d20 6e70  digit_ratio = np
+0000d240: 2e66 756c 6c28 2864 6174 612e 7368 6170  .full((data.shap
+0000d250: 655b 305d 292c 206e 702e 6e61 6e29 2c20  e[0]), np.nan), 
+0000d260: 6e70 2e66 756c 6c28 392c 206e 702e 6e61  np.full(9, np.na
+0000d270: 6e29 0a20 2020 2020 2020 2066 6f72 2069  n).        for i
+0000d280: 2069 6e20 7072 616e 6765 2864 6174 612e   in prange(data.
+0000d290: 7368 6170 655b 305d 293a 0a20 2020 2020  shape[0]):.     
+0000d2a0: 2020 2020 2020 2066 6972 7374 5f76 616c         first_val
+0000d2b0: 735b 695d 203d 2064 6174 615b 695d 202f  s[i] = data[i] /
+0000d2c0: 2f20 3130 202a 2a20 2869 6e74 286e 702e  / 10 ** (int(np.
+0000d2d0: 6c6f 6731 3028 6461 7461 5b69 5d29 2920  log10(data[i])) 
+0000d2e0: 2d20 3120 2b20 3129 0a0a 2020 2020 2020  - 1 + 1)..      
+0000d2f0: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
+0000d300: 2831 2c20 3130 293a 0a20 2020 2020 2020  (1, 10):.       
+0000d310: 2020 2020 2064 6967 6974 5f72 6174 696f       digit_ratio
+0000d320: 5b69 202d 2031 5d20 3d20 6e70 2e61 7267  [i - 1] = np.arg
+0000d330: 7768 6572 6528 6669 7273 745f 7661 6c73  where(first_vals
+0000d340: 203d 3d20 6929 2e73 6861 7065 5b30 5d20   == i).shape[0] 
+0000d350: 2f20 6461 7461 2e73 6861 7065 5b30 5d0a  / data.shape[0].
+0000d360: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000d370: 6e70 2e63 6f72 7263 6f65 6628 6265 6e66  np.corrcoef(benf
+0000d380: 6f72 645f 6469 7374 7269 6275 7469 6f6e  ord_distribution
+0000d390: 2c20 6469 6769 745f 7261 7469 6f29 5b30  , digit_ratio)[0
+0000d3a0: 2c20 315d 0a0a 2020 2020 4073 7461 7469  , 1]..    @stati
+0000d3b0: 636d 6574 686f 640a 2020 2020 406e 6a69  cmethod.    @nji
+0000d3c0: 7428 2228 666c 6f61 7433 325b 3a5d 2c20  t("(float32[:], 
+0000d3d0: 666c 6f61 7436 345b 3a5d 2c20 696e 7436  float64[:], int6
+0000d3e0: 3429 2229 0a20 2020 2064 6566 2073 6c69  4)").    def sli
+0000d3f0: 6469 6e67 5f62 656e 666f 7264 5f63 6f72  ding_benford_cor
+0000d400: 7265 6c61 7469 6f6e 280a 2020 2020 2020  relation(.      
+0000d410: 2020 6461 7461 3a20 6e70 2e6e 6461 7272    data: np.ndarr
+0000d420: 6179 2c20 7469 6d65 5f77 696e 646f 7773  ay, time_windows
+0000d430: 3a20 6e70 2e6e 6461 7272 6179 2c20 7361  : np.ndarray, sa
+0000d440: 6d70 6c65 5f72 6174 653a 2069 6e74 0a20  mple_rate: int. 
+0000d450: 2020 2029 202d 3e20 6e70 2e6e 6461 7272     ) -> np.ndarr
+0000d460: 6179 3a0a 2020 2020 2020 2020 2222 220a  ay:.        """.
+0000d470: 2020 2020 2020 2020 4361 6c63 756c 6174          Calculat
+0000d480: 6520 7468 6520 736c 6964 696e 6720 4265  e the sliding Be
+0000d490: 6e66 6f72 6427 7320 4c61 7720 636f 7272  nford's Law corr
+0000d4a0: 656c 6174 696f 6e20 636f 6566 6669 6369  elation coeffici
+0000d4b0: 656e 7420 666f 7220 6120 6769 7665 6e20  ent for a given 
+0000d4c0: 6461 7461 7365 7420 7769 7468 696e 0a20  dataset within. 
+0000d4d0: 2020 2020 2020 2073 7065 6369 6669 6564         specified
+0000d4e0: 2074 696d 6520 7769 6e64 6f77 732e 0a0a   time windows...
+0000d4f0: 2020 2020 2020 2020 4265 6e66 6f72 6427          Benford'
+0000d500: 7320 4c61 7720 6973 2061 2073 7461 7469  s Law is a stati
+0000d510: 7374 6963 616c 2070 6865 6e6f 6d65 6e6f  stical phenomeno
+0000d520: 6e20 7768 6572 6520 7468 6520 6c65 6164  n where the lead
+0000d530: 696e 6720 6469 6769 7473 206f 6620 6d61  ing digits of ma
+0000d540: 6e79 2064 6174 6173 6574 7320 666f 6c6c  ny datasets foll
+0000d550: 6f77 2061 0a20 2020 2020 2020 2073 7065  ow a.        spe
+0000d560: 6369 6669 6320 6469 7374 7269 6275 7469  cific distributi
+0000d570: 6f6e 2070 6174 7465 726e 2e20 5468 6973  on pattern. This
+0000d580: 2066 756e 6374 696f 6e20 6361 6c63 756c   function calcul
+0000d590: 6174 6573 2074 6865 2063 6f72 7265 6c61  ates the correla
+0000d5a0: 7469 6f6e 2062 6574 7765 656e 2074 6865  tion between the
+0000d5b0: 206f 6273 6572 7665 640a 2020 2020 2020   observed.      
+0000d5c0: 2020 6469 7374 7269 6275 7469 6f6e 206f    distribution o
+0000d5d0: 6620 6c65 6164 696e 6720 6469 6769 7473  f leading digits
+0000d5e0: 2069 6e20 6120 6461 7461 7365 7420 616e   in a dataset an
+0000d5f0: 6420 7468 6520 6964 6561 6c20 4265 6e66  d the ideal Benf
+0000d600: 6f72 6427 7320 4c61 7720 6469 7374 7269  ord's Law distri
+0000d610: 6275 7469 6f6e 2e0a 0a20 2020 2020 2020  bution...       
+0000d620: 202e 2e20 6e6f 7465 3a3a 0a20 2020 2020   .. note::.     
+0000d630: 2020 2020 2020 4164 6170 7465 6420 6672        Adapted fr
+0000d640: 6f6d 2060 7473 6672 6573 6820 3c68 7474  om `tsfresh <htt
+0000d650: 7073 3a2f 2f74 7366 7265 7368 2e72 6561  ps://tsfresh.rea
+0000d660: 6474 6865 646f 6373 2e69 6f2f 656e 2f6c  dthedocs.io/en/l
+0000d670: 6174 6573 742f 5f6d 6f64 756c 6573 2f74  atest/_modules/t
+0000d680: 7366 7265 7368 2f66 6561 7475 7265 5f65  sfresh/feature_e
+0000d690: 7874 7261 6374 696f 6e2f 6665 6174 7572  xtraction/featur
+0000d6a0: 655f 6361 6c63 756c 6174 6f72 732e 6874  e_calculators.ht
+0000d6b0: 6d6c 2362 656e 666f 7264 5f63 6f72 7265  ml#benford_corre
+0000d6c0: 6c61 7469 6f6e 3e60 5f2e 0a0a 2020 2020  lation>`_...    
+0000d6d0: 2020 2020 2020 2054 6865 2072 6574 7572         The retur
+0000d6e0: 6e65 6420 636f 7272 656c 6174 696f 6e20  ned correlation 
+0000d6f0: 7661 6c75 6573 2061 7265 2063 616c 6375  values are calcu
+0000d700: 6c61 7465 6420 7573 696e 6720 5065 6172  lated using Pear
+0000d710: 736f 6e27 7320 636f 7272 656c 6174 696f  son's correlatio
+0000d720: 6e20 636f 6566 6669 6369 656e 742e 0a0a  n coefficient...
+0000d730: 2020 2020 2020 2020 5468 6520 636f 7272          The corr
+0000d740: 656c 6174 696f 6e20 636f 6566 6669 6369  elation coeffici
+0000d750: 656e 7420 6973 2063 616c 6375 6c61 7465  ent is calculate
+0000d760: 6420 6265 7477 6565 6e20 7468 6520 6f62  d between the ob
+0000d770: 7365 7276 6564 206c 6561 6469 6e67 2064  served leading d
+0000d780: 6967 6974 2064 6973 7472 6962 7574 696f  igit distributio
+0000d790: 6e20 616e 640a 2020 2020 2020 2020 7468  n and.        th
+0000d7a0: 6520 6964 6561 6c20 4265 6e66 6f72 6427  e ideal Benford'
+0000d7b0: 7320 4c61 7720 6469 7374 7269 6275 7469  s Law distributi
+0000d7c0: 6f6e 2e0a 0a20 2020 2020 2020 202e 2e20  on...        .. 
+0000d7d0: 6d61 7468 3a3a 0a0a 2020 2020 2020 2020  math::..        
+0000d7e0: 2020 2020 5028 6429 203d 205c 5c6c 6f67      P(d) = \\log
+0000d7f0: 5f7b 3130 7d5c 5c6c 6566 7428 3120 2b20  _{10}\\left(1 + 
+0000d800: 5c5c 6672 6163 7b31 7d7b 647d 5c5c 7269  \\frac{1}{d}\\ri
+0000d810: 6768 7429 205c 5c71 7561 6420 5c5c 7465  ght) \\quad \\te
+0000d820: 7874 7b66 6f72 207d 2064 205c 5c69 6e20  xt{for } d \\in 
+0000d830: 5c7b 312c 2032 2c20 5c5c 6c64 6f74 732c  \{1, 2, \\ldots,
+0000d840: 2039 5c7d 0a0a 2020 2020 2020 2020 3a70   9\}..        :p
+0000d850: 6172 616d 206e 702e 6e64 6172 7261 7920  aram np.ndarray 
+0000d860: 6461 7461 3a20 5468 6520 696e 7075 7420  data: The input 
+0000d870: 3144 2061 7272 6179 2063 6f6e 7461 696e  1D array contain
+0000d880: 696e 6720 7468 6520 7469 6d65 2073 6572  ing the time ser
+0000d890: 6965 7320 6461 7461 2e0a 2020 2020 2020  ies data..      
+0000d8a0: 2020 3a70 6172 616d 206e 702e 6e64 6172    :param np.ndar
+0000d8b0: 7261 7920 7469 6d65 5f77 696e 646f 7773  ray time_windows
+0000d8c0: 3a20 4120 3144 2061 7272 6179 2063 6f6e  : A 1D array con
+0000d8d0: 7461 696e 696e 6720 7468 6520 7469 6d65  taining the time
+0000d8e0: 2077 696e 646f 7773 2028 696e 2073 6563   windows (in sec
+0000d8f0: 6f6e 6473 2920 666f 7220 7768 6963 6820  onds) for which 
+0000d900: 7468 6520 636f 7272 656c 6174 696f 6e20  the correlation 
+0000d910: 7769 6c6c 2062 6520 6361 6c63 756c 6174  will be calculat
+0000d920: 6564 2061 7420 6469 6666 6572 656e 7420  ed at different 
+0000d930: 706f 696e 7473 2069 6e20 7468 6520 6461  points in the da
+0000d940: 7461 7365 742e 0a20 2020 2020 2020 203a  taset..        :
+0000d950: 7061 7261 6d20 696e 7420 7361 6d70 6c65  param int sample
+0000d960: 5f72 6174 653a 2054 6865 2073 616d 706c  _rate: The sampl
+0000d970: 6520 7261 7465 2c20 696e 6469 6361 7469  e rate, indicati
+0000d980: 6e67 2068 6f77 206d 616e 7920 6461 7461  ng how many data
+0000d990: 2070 6f69 6e74 7320 6172 6520 636f 6c6c   points are coll
+0000d9a0: 6563 7465 6420 7065 7220 7365 636f 6e64  ected per second
+0000d9b0: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
+0000d9c0: 6e20 6e70 2e6e 6461 7272 6179 3a20 3244  n np.ndarray: 2D
+0000d9d0: 2061 7272 6179 2063 6f6e 7461 696e 696e   array containin
+0000d9e0: 6720 7468 6520 636f 7272 656c 6174 696f  g the correlatio
+0000d9f0: 6e20 636f 6566 6669 6369 656e 7420 7661  n coefficient va
+0000da00: 6c75 6573 2066 6f72 2065 6163 6820 7469  lues for each ti
+0000da10: 6d65 2077 696e 646f 772e 2057 6974 6820  me window. With 
+0000da20: 7469 6d65 2077 696e 646f 7720 6c65 6e74  time window lent
+0000da30: 6873 2072 6570 7265 7365 6e74 6564 2062  hs represented b
+0000da40: 7920 6469 6666 6572 656e 7420 636f 6c75  y different colu
+0000da50: 6d6e 732e 0a0a 2020 2020 2020 2020 3a65  mns...        :e
+0000da60: 7861 6d70 6c65 733a 0a20 2020 2020 2020  xamples:.       
+0000da70: 203e 3e3e 2064 6174 6120 3d20 6e70 2e61   >>> data = np.a
+0000da80: 7272 6179 285b 312c 2038 2c20 322c 2031  rray([1, 8, 2, 1
+0000da90: 302c 2038 2c20 362c 2038 2c20 312c 2031  0, 8, 6, 8, 1, 1
+0000daa0: 2c20 315d 292e 6173 7479 7065 286e 702e  , 1]).astype(np.
+0000dab0: 666c 6f61 7433 3229 0a20 2020 2020 2020  float32).       
+0000dac0: 203e 3e3e 2054 696d 6573 6572 6965 7346   >>> TimeseriesF
+0000dad0: 6561 7475 7265 4d69 7869 6e2e 736c 6964  eatureMixin.slid
+0000dae0: 696e 675f 6265 6e66 6f72 645f 636f 7272  ing_benford_corr
+0000daf0: 656c 6174 696f 6e28 6461 7461 3d64 6174  elation(data=dat
+0000db00: 612c 2074 696d 655f 7769 6e64 6f77 733d  a, time_windows=
+0000db10: 6e70 2e61 7272 6179 285b 312e 305d 292c  np.array([1.0]),
+0000db20: 2073 616d 706c 655f 7261 7465 3d32 290a   sample_rate=2).
+0000db30: 2020 2020 2020 2020 3e3e 3e20 5b5b 2030          >>> [[ 0
+0000db40: 2e5d 5b30 2e34 3437 5d5b 302e 3031 375d  .][0.447][0.017]
+0000db50: 5b30 2e38 3737 5d5b 302e 3434 375d 5b30  [0.877][0.447][0
+0000db60: 2e33 3538 5d5b 302e 3335 385d 5b30 2e34  .358][0.358][0.4
+0000db70: 3437 5d5b 302e 3836 345d 5b30 2e38 3634  47][0.864][0.864
+0000db80: 5d5d 0a20 2020 2020 2020 2022 2222 0a0a  ]].        """..
+0000db90: 2020 2020 2020 2020 6461 7461 203d 206e          data = n
+0000dba0: 702e 6162 7328 6461 7461 290a 2020 2020  p.abs(data).    
+0000dbb0: 2020 2020 6265 6e66 6f72 645f 6469 7374      benford_dist
+0000dbc0: 7269 6275 7469 6f6e 203d 206e 702e 6172  ribution = np.ar
+0000dbd0: 7261 7928 5b6e 702e 6c6f 6731 3028 3120  ray([np.log10(1 
+0000dbe0: 2b20 3120 2f20 6e29 2066 6f72 206e 2069  + 1 / n) for n i
+0000dbf0: 6e20 7261 6e67 6528 312c 2031 3029 5d29  n range(1, 10)])
+0000dc00: 0a20 2020 2020 2020 2072 6573 756c 7473  .        results
+0000dc10: 203d 206e 702e 6675 6c6c 2828 6461 7461   = np.full((data
+0000dc20: 2e73 6861 7065 5b30 5d2c 2074 696d 655f  .shape[0], time_
+0000dc30: 7769 6e64 6f77 732e 7368 6170 655b 305d  windows.shape[0]
+0000dc40: 292c 2030 2e30 290a 2020 2020 2020 2020  ), 0.0).        
+0000dc50: 666f 7220 6920 696e 2070 7261 6e67 6528  for i in prange(
+0000dc60: 7469 6d65 5f77 696e 646f 7773 2e73 6861  time_windows.sha
+0000dc70: 7065 5b30 5d29 3a0a 2020 2020 2020 2020  pe[0]):.        
+0000dc80: 2020 2020 7769 6e64 6f77 5f73 697a 6520      window_size 
+0000dc90: 3d20 696e 7428 7469 6d65 5f77 696e 646f  = int(time_windo
+0000dca0: 7773 5b69 5d20 2a20 7361 6d70 6c65 5f72  ws[i] * sample_r
+0000dcb0: 6174 6529 0a20 2020 2020 2020 2020 2020  ate).           
+0000dcc0: 2066 6f72 206c 2c20 7220 696e 207a 6970   for l, r in zip
+0000dcd0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000dce0: 2020 7072 616e 6765 2830 2c20 6461 7461    prange(0, data
+0000dcf0: 2e73 6861 7065 5b30 5d20 2b20 3129 2c20  .shape[0] + 1), 
+0000dd00: 7072 616e 6765 2877 696e 646f 775f 7369  prange(window_si
+0000dd10: 7a65 2c20 6461 7461 2e73 6861 7065 5b30  ze, data.shape[0
+0000dd20: 5d20 2b20 3129 0a20 2020 2020 2020 2020  ] + 1).         
+0000dd30: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+0000dd40: 2020 2020 2020 6669 7273 745f 7661 6c73        first_vals
+0000dd50: 2c20 6469 6769 745f 7261 7469 6f20 3d20  , digit_ratio = 
+0000dd60: 6e70 2e66 756c 6c28 2864 6174 612e 7368  np.full((data.sh
+0000dd70: 6170 655b 305d 292c 206e 702e 6e61 6e29  ape[0]), np.nan)
+0000dd80: 2c20 6e70 2e66 756c 6c28 0a20 2020 2020  , np.full(.     
+0000dd90: 2020 2020 2020 2020 2020 2020 2020 2039                 9
+0000dda0: 2c20 6e70 2e6e 616e 0a20 2020 2020 2020  , np.nan.       
+0000ddb0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0000ddc0: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
+0000ddd0: 6520 3d20 6461 7461 5b6c 3a72 5d0a 2020  e = data[l:r].  
+0000dde0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0000ddf0: 7220 6b20 696e 2072 616e 6765 2873 616d  r k in range(sam
+0000de00: 706c 652e 7368 6170 655b 305d 293a 0a20  ple.shape[0]):. 
+0000de10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000de20: 2020 2066 6972 7374 5f76 616c 735b 6b5d     first_vals[k]
+0000de30: 203d 2073 616d 706c 655b 6b5d 202f 2f20   = sample[k] // 
+0000de40: 3130 202a 2a20 280a 2020 2020 2020 2020  10 ** (.        
+0000de50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000de60: 696e 7428 6e70 2e6c 6f67 3130 2873 616d  int(np.log10(sam
+0000de70: 706c 655b 6b5d 2929 202d 2031 202b 2031  ple[k])) - 1 + 1
+0000de80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000de90: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+0000dea0: 2020 2020 2020 2066 6f72 206b 2069 6e20         for k in 
+0000deb0: 7261 6e67 6528 312c 2031 3029 3a0a 2020  range(1, 10):.  
+0000dec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ded0: 2020 6469 6769 745f 7261 7469 6f5b 6b20    digit_ratio[k 
+0000dee0: 2d20 315d 203d 2028 0a20 2020 2020 2020  - 1] = (.       
+0000def0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000df00: 206e 702e 6172 6777 6865 7265 2866 6972   np.argwhere(fir
+0000df10: 7374 5f76 616c 7320 3d3d 206b 292e 7368  st_vals == k).sh
+0000df20: 6170 655b 305d 202f 2073 616d 706c 652e  ape[0] / sample.
+0000df30: 7368 6170 655b 305d 0a20 2020 2020 2020  shape[0].       
+0000df40: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+0000df50: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0000df60: 6573 756c 7473 5b72 202d 2031 2c20 695d  esults[r - 1, i]
+0000df70: 203d 206e 702e 636f 7272 636f 6566 2862   = np.corrcoef(b
+0000df80: 656e 666f 7264 5f64 6973 7472 6962 7574  enford_distribut
+0000df90: 696f 6e2c 2064 6967 6974 5f72 6174 696f  ion, digit_ratio
+0000dfa0: 295b 302c 2031 5d0a 0a20 2020 2020 2020  )[0, 1]..       
+0000dfb0: 2072 6574 7572 6e20 7265 7375 6c74 732e   return results.
+0000dfc0: 6173 7479 7065 286e 702e 666c 6f61 7433  astype(np.float3
+0000dfd0: 3229 0a0a 2020 2020 4073 7461 7469 636d  2)..    @staticm
+0000dfe0: 6574 686f 640a 2020 2020 406e 6a69 7428  ethod.    @njit(
+0000dff0: 2228 666c 6f61 7433 325b 3a5d 2c20 666c  "(float32[:], fl
+0000e000: 6f61 7436 342c 2066 6c6f 6174 3634 2c20  oat64, float64, 
+0000e010: 666c 6f61 7436 342c 2066 6c6f 6174 3634  float64, float64
+0000e020: 2c20 666c 6f61 7436 3429 222c 2066 6173  , float64)", fas
+0000e030: 746d 6174 683d 5472 7565 290a 2020 2020  tmath=True).    
+0000e040: 6465 6620 7370 696b 655f 6669 6e64 6572  def spike_finder
+0000e050: 280a 2020 2020 2020 2020 6461 7461 3a20  (.        data: 
+0000e060: 6e70 2e6e 6461 7272 6179 2c0a 2020 2020  np.ndarray,.    
+0000e070: 2020 2020 7361 6d70 6c65 5f72 6174 653a      sample_rate:
+0000e080: 2069 6e74 2c0a 2020 2020 2020 2020 6261   int,.        ba
+0000e090: 7365 6c69 6e65 3a20 666c 6f61 742c 0a20  seline: float,. 
+0000e0a0: 2020 2020 2020 206d 696e 5f73 7069 6b65         min_spike
+0000e0b0: 5f61 6d70 6c69 7475 6465 3a20 666c 6f61  _amplitude: floa
+0000e0c0: 742c 0a20 2020 2020 2020 206d 696e 5f66  t,.        min_f
+0000e0d0: 7768 6d3a 2066 6c6f 6174 203d 202d 6e70  whm: float = -np
+0000e0e0: 2e69 6e66 2c0a 2020 2020 2020 2020 6d69  .inf,.        mi
+0000e0f0: 6e5f 6861 6c66 5f77 6964 7468 3a20 666c  n_half_width: fl
+0000e100: 6f61 7420 3d20 2d6e 702e 696e 662c 0a20  oat = -np.inf,. 
+0000e110: 2020 2029 202d 3e20 666c 6f61 743a 0a20     ) -> float:. 
+0000e120: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0000e130: 2020 2049 6465 6e74 6966 7920 616e 6420     Identify and 
+0000e140: 6368 6172 6163 7465 7269 7a65 2073 7069  characterize spi
+0000e150: 6b65 7320 696e 2061 2067 6976 656e 2074  kes in a given t
+0000e160: 696d 652d 7365 7269 6573 2064 6174 6120  ime-series data 
+0000e170: 7365 7175 656e 6365 2e20 5468 6973 206d  sequence. This m
+0000e180: 6574 686f 6420 6964 656e 7469 6669 6573  ethod identifies
+0000e190: 2073 7069 6b65 7320 696e 2074 6865 2069   spikes in the i
+0000e1a0: 6e70 7574 2064 6174 6120 6261 7365 6420  nput data based 
+0000e1b0: 6f6e 2074 6865 2073 7065 6369 6669 6564  on the specified
+0000e1c0: 2063 7269 7465 7269 6120 616e 6420 6368   criteria and ch
+0000e1d0: 6172 6163 7465 7269 7a65 730a 2020 2020  aracterizes.    
+0000e1e0: 2020 2020 6561 6368 2064 6574 6563 7465      each detecte
+0000e1f0: 6420 7370 696b 6520 6279 2063 6f6d 7075  d spike by compu
+0000e200: 7469 6e67 2069 7473 2061 6d70 6c69 7475  ting its amplitu
+0000e210: 6465 2c20 6675 6c6c 2d77 6964 7468 2061  de, full-width a
+0000e220: 7420 6861 6c66 206d 6178 696d 756d 2028  t half maximum (
+0000e230: 4657 484d 292c 2061 6e64 2068 616c 662d  FWHM), and half-
+0000e240: 7769 6474 682e 0a0a 2020 2020 2020 2020  width...        
+0000e250: 3a70 6172 616d 206e 702e 6e64 6172 7261  :param np.ndarra
+0000e260: 7920 6461 7461 3a20 4120 3144 2061 7272  y data: A 1D arr
+0000e270: 6179 2063 6f6e 7461 696e 696e 6720 7468  ay containing th
+0000e280: 6520 696e 7075 7420 6461 7461 2073 6571  e input data seq
+0000e290: 7565 6e63 6520 746f 2061 6e61 6c79 7a65  uence to analyze
+0000e2a0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0000e2b0: 2069 6e74 2073 616d 706c 655f 7261 7465   int sample_rate
+0000e2c0: 3a20 5468 6520 7361 6d70 6c65 2072 6174  : The sample rat
+0000e2d0: 652c 2069 6e64 6963 6174 696e 6720 686f  e, indicating ho
+0000e2e0: 7720 6d61 6e79 2064 6174 6120 706f 696e  w many data poin
+0000e2f0: 7473 2061 7265 2063 6f6c 6c65 6374 6564  ts are collected
+0000e300: 2070 6572 2073 6563 6f6e 642e 0a20 2020   per second..   
+0000e310: 2020 2020 203a 7061 7261 6d20 666c 6f61       :param floa
+0000e320: 7420 6261 7365 6c69 6e65 3a20 5468 6520  t baseline: The 
+0000e330: 6261 7365 6c69 6e65 2076 616c 7565 2075  baseline value u
+0000e340: 7365 6420 746f 2069 6465 6e74 6966 7920  sed to identify 
+0000e350: 7370 696b 6573 2e20 416e 7920 6461 7461  spikes. Any data
+0000e360: 2070 6f69 6e74 2061 626f 7665 2028 6261   point above (ba
+0000e370: 7365 6c69 6e65 202b 206d 696e 5f73 7069  seline + min_spi
+0000e380: 6b65 5f61 6d70 6c69 7475 6465 2920 6973  ke_amplitude) is
+0000e390: 2063 6f6e 7369 6465 7265 6420 7061 7274   considered part
+0000e3a0: 206f 6620 6120 7370 696b 652e 0a20 2020   of a spike..   
+0000e3b0: 2020 2020 203a 7061 7261 6d20 666c 6f61       :param floa
+0000e3c0: 7420 6d69 6e5f 7370 696b 655f 616d 706c  t min_spike_ampl
+0000e3d0: 6974 7564 653a 2054 6865 206d 696e 696d  itude: The minim
+0000e3e0: 756d 2061 6d70 6c69 7475 6465 2028 6162  um amplitude (ab
+0000e3f0: 6f76 6520 6261 7365 6c69 6e65 2920 7265  ove baseline) re
+0000e400: 7175 6972 6564 2066 6f72 2061 2073 7069  quired for a spi
+0000e410: 6b65 2074 6f20 6265 2063 6f6e 7369 6465  ke to be conside
+0000e420: 7265 642e 0a20 2020 2020 2020 203a 7061  red..        :pa
+0000e430: 7261 6d20 4f70 7469 6f6e 616c 5b66 6c6f  ram Optional[flo
+0000e440: 6174 5d20 6d69 6e5f 6677 686d 3a20 5468  at] min_fwhm: Th
+0000e450: 6520 6d69 6e69 6d75 6d20 6675 6c6c 2d77  e minimum full-w
+0000e460: 6964 7468 2061 7420 6861 6c66 206d 6178  idth at half max
+0000e470: 696d 756d 2028 4657 484d 2920 666f 7220  imum (FWHM) for 
+0000e480: 6120 7370 696b 6520 746f 2062 6520 696e  a spike to be in
+0000e490: 636c 7564 6564 2e20 4966 206e 6f74 2073  cluded. If not s
+0000e4a0: 7065 6369 6669 6564 2c20 6974 2064 6566  pecified, it def
+0000e4b0: 6175 6c74 7320 746f 206e 6567 6174 6976  aults to negativ
+0000e4c0: 6520 696e 6669 6e69 7479 2c20 6d65 616e  e infinity, mean
+0000e4d0: 696e 6720 6974 2069 7320 6e6f 7420 636f  ing it is not co
+0000e4e0: 6e73 6964 6572 6564 2066 6f72 2066 696c  nsidered for fil
+0000e4f0: 7465 7269 6e67 2e0a 2020 2020 2020 2020  tering..        
+0000e500: 3a70 6172 616d 204f 7074 696f 6e61 6c5b  :param Optional[
+0000e510: 666c 6f61 745d 206d 696e 5f68 616c 665f  float] min_half_
+0000e520: 7769 6474 683a 2054 6865 206d 696e 696d  width: The minim
+0000e530: 756d 2068 616c 662d 7769 6474 6820 7265  um half-width re
+0000e540: 7175 6972 6564 2066 6f72 2061 2073 7069  quired for a spi
+0000e550: 6b65 2074 6f20 6265 2069 6e63 6c75 6465  ke to be include
+0000e560: 642e 2049 6620 6e6f 7420 7370 6563 6966  d. If not specif
+0000e570: 6965 642c 2069 7420 6465 6661 756c 7473  ied, it defaults
+0000e580: 2074 6f20 6e65 6761 7469 7665 2069 6e66   to negative inf
+0000e590: 696e 6974 792c 206d 6561 6e69 6e67 2069  inity, meaning i
+0000e5a0: 7420 6973 206e 6f74 2063 6f6e 7369 6465  t is not conside
+0000e5b0: 7265 6420 666f 7220 6669 6c74 6572 696e  red for filterin
+0000e5c0: 672e 0a20 2020 2020 2020 203a 7265 7475  g..        :retu
+0000e5d0: 726e 2074 7570 6c65 3a20 4120 7475 706c  rn tuple: A tupl
+0000e5e0: 6520 636f 6e74 6169 6e69 6e67 2074 6872  e containing thr
+0000e5f0: 6565 2065 6c65 6d65 6e74 733a 0a20 2020  ee elements:.   
+0000e600: 2020 2020 2020 2020 202d 2073 7069 6b65           - spike
+0000e610: 5f69 6478 2028 4c69 7374 5b6e 702e 6e64  _idx (List[np.nd
+0000e620: 6172 7261 795d 293a 2041 206c 6973 7420  array]): A list 
+0000e630: 6f66 2031 4420 6172 7261 7973 2c20 6561  of 1D arrays, ea
+0000e640: 6368 2072 6570 7265 7365 6e74 696e 6720  ch representing 
+0000e650: 7468 6520 696e 6469 6365 7320 6f66 2074  the indices of t
+0000e660: 6865 2064 6174 6120 706f 696e 7473 2062  he data points b
+0000e670: 656c 6f6e 6769 6e67 2074 6f20 6120 6465  elonging to a de
+0000e680: 7465 6374 6564 2073 7069 6b65 2e0a 2020  tected spike..  
+0000e690: 2020 2020 2020 2020 2020 2d20 7370 696b            - spik
+0000e6a0: 655f 7661 6c73 2028 4c69 7374 5b6e 702e  e_vals (List[np.
+0000e6b0: 6e64 6172 7261 795d 293a 2041 206c 6973  ndarray]): A lis
+0000e6c0: 7420 6f66 2031 4420 6172 7261 7973 2c20  t of 1D arrays, 
+0000e6d0: 6561 6368 2063 6f6e 7461 696e 696e 6720  each containing 
+0000e6e0: 7468 6520 7661 6c75 6573 206f 6620 7468  the values of th
+0000e6f0: 6520 6461 7461 2070 6f69 6e74 7320 7769  e data points wi
+0000e700: 7468 696e 2061 2064 6574 6563 7465 6420  thin a detected 
+0000e710: 7370 696b 652e 0a20 2020 2020 2020 2020  spike..         
+0000e720: 2020 202d 2073 7069 6b65 5f64 6963 7420     - spike_dict 
+0000e730: 2844 6963 745b 696e 742c 2044 6963 745b  (Dict[int, Dict[
+0000e740: 7374 722c 2066 6c6f 6174 5d5d 293a 2041  str, float]]): A
+0000e750: 2064 6963 7469 6f6e 6172 7920 7768 6572   dictionary wher
+0000e760: 6520 7468 6520 6b65 7973 2061 7265 2073  e the keys are s
+0000e770: 7069 6b65 2069 6e64 6963 6573 2c20 616e  pike indices, an
+0000e780: 6420 7468 6520 7661 6c75 6573 2061 7265  d the values are
+0000e790: 2064 6963 7469 6f6e 6172 6965 7320 636f   dictionaries co
+0000e7a0: 6e74 6169 6e69 6e67 2073 7069 6b65 2063  ntaining spike c
+0000e7b0: 6861 7261 6374 6572 6973 7469 6373 2069  haracteristics i
+0000e7c0: 6e63 6c75 6469 6e67 2027 616d 706c 6974  ncluding 'amplit
+0000e7d0: 7564 6527 2028 7370 696b 6520 616d 706c  ude' (spike ampl
+0000e7e0: 6974 7564 6529 2c20 2766 7768 6d27 2028  itude), 'fwhm' (
+0000e7f0: 4657 484d 292c 2061 6e64 2027 6861 6c66  FWHM), and 'half
+0000e800: 5f77 6964 7468 2720 2868 616c 662d 7769  _width' (half-wi
+0000e810: 6474 6829 2e0a 0a20 2020 2020 2020 202e  dth)...        .
+0000e820: 2e20 6e6f 7465 3a3a 0a20 2020 2020 2020  . note::.       
+0000e830: 2020 2020 2d20 5468 6520 6675 6e63 7469      - The functi
+0000e840: 6f6e 2075 7365 7320 7468 6520 4e75 6d62  on uses the Numb
+0000e850: 6120 4a49 5420 284a 7573 742d 496e 2d54  a JIT (Just-In-T
+0000e860: 696d 6529 2063 6f6d 7069 6c61 7469 6f6e  ime) compilation
+0000e870: 2066 6f72 206f 7074 696d 697a 6564 2070   for optimized p
+0000e880: 6572 666f 726d 616e 6365 2e20 5769 7468  erformance. With
+0000e890: 6f75 7420 6661 7374 6d61 7468 3d54 7275  out fastmath=Tru
+0000e8a0: 6520 7468 6572 6520 6973 206e 6f20 7275  e there is no ru
+0000e8b0: 6e74 696d 6520 696d 7072 6f76 656d 656e  ntime improvemen
+0000e8c0: 7420 6f76 6572 2073 7461 6e64 6172 6420  t over standard 
+0000e8d0: 6e75 6d70 792e 0a0a 2020 2020 2020 2020  numpy...        
+0000e8e0: 3a65 7861 6d70 6c65 3a0a 2020 2020 2020  :example:.      
+0000e8f0: 2020 3e3e 3e20 6461 7461 203d 206e 702e    >>> data = np.
+0000e900: 6172 7261 7928 5b30 2e31 2c20 302e 312c  array([0.1, 0.1,
+0000e910: 2030 2e33 2c20 302e 312c 2031 302c 2031   0.3, 0.1, 10, 1
+0000e920: 302c 2038 2c20 302e 312c 2030 2e31 2c20  0, 8, 0.1, 0.1, 
+0000e930: 302e 312c 2031 302c 2031 302c 2038 2c20  0.1, 10, 10, 8, 
+0000e940: 3939 2c20 302e 312c 2039 392c 2039 392c  99, 0.1, 99, 99,
+0000e950: 2030 2e31 5d29 2e61 7374 7970 6528 6e70   0.1]).astype(np
+0000e960: 2e66 6c6f 6174 3332 290a 2020 2020 2020  .float32).      
+0000e970: 2020 3e3e 3e20 7370 696b 655f 6964 782c    >>> spike_idx,
+0000e980: 2073 7069 6b65 5f76 616c 732c 2073 7069   spike_vals, spi
+0000e990: 6b65 5f73 7461 7473 203d 2054 696d 6573  ke_stats = Times
+0000e9a0: 6572 6965 7346 6561 7475 7265 4d69 7869  eriesFeatureMixi
+0000e9b0: 6e28 292e 7370 696b 655f 6669 6e64 6572  n().spike_finder
+0000e9c0: 2864 6174 613d 6461 7461 2c20 6261 7365  (data=data, base
+0000e9d0: 6c69 6e65 3d31 2c20 6d69 6e5f 7370 696b  line=1, min_spik
+0000e9e0: 655f 616d 706c 6974 7564 653d 352c 2073  e_amplitude=5, s
+0000e9f0: 616d 706c 655f 7261 7465 3d32 2c20 6d69  ample_rate=2, mi
+0000ea00: 6e5f 6677 686d 3d2d 6e70 2e69 6e66 2c20  n_fwhm=-np.inf, 
+0000ea10: 6d69 6e5f 6861 6c66 5f77 6964 7468 3d30  min_half_width=0
+0000ea20: 2e30 3030 3229 0a20 2020 2020 2020 2022  .0002).        "
+0000ea30: 2222 0a0a 2020 2020 2020 2020 7370 696b  ""..        spik
+0000ea40: 655f 6964 7873 203d 206e 702e 6172 6777  e_idxs = np.argw
+0000ea50: 6865 7265 2864 6174 6120 3e3d 2062 6173  here(data >= bas
+0000ea60: 656c 696e 6520 2b20 6d69 6e5f 7370 696b  eline + min_spik
+0000ea70: 655f 616d 706c 6974 7564 6529 2e66 6c61  e_amplitude).fla
+0000ea80: 7474 656e 2829 0a20 2020 2020 2020 2073  tten().        s
+0000ea90: 7069 6b65 5f69 6478 203d 206e 702e 7370  pike_idx = np.sp
+0000eaa0: 6c69 7428 0a20 2020 2020 2020 2020 2020  lit(.           
+0000eab0: 2073 7069 6b65 5f69 6478 732c 206e 702e   spike_idxs, np.
+0000eac0: 6172 6777 6865 7265 2873 7069 6b65 5f69  argwhere(spike_i
+0000ead0: 6478 735b 313a 5d20 2d20 7370 696b 655f  dxs[1:] - spike_
+0000eae0: 6964 7873 5b3a 2d31 5d20 213d 2031 292e  idxs[:-1] != 1).
+0000eaf0: 666c 6174 7465 6e28 2920 2b20 310a 2020  flatten() + 1.  
+0000eb00: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0000eb10: 7370 696b 655f 6469 6374 203d 2044 6963  spike_dict = Dic
+0000eb20: 742e 656d 7074 7928 0a20 2020 2020 2020  t.empty(.       
+0000eb30: 2020 2020 206b 6579 5f74 7970 653d 7479       key_type=ty
+0000eb40: 7065 732e 696e 7436 342c 0a20 2020 2020  pes.int64,.     
+0000eb50: 2020 2020 2020 2076 616c 7565 5f74 7970         value_typ
+0000eb60: 653d 4469 6374 2e65 6d70 7479 280a 2020  e=Dict.empty(.  
+0000eb70: 2020 2020 2020 2020 2020 2020 2020 6b65                ke
+0000eb80: 795f 7479 7065 3d74 7970 6573 2e75 6e69  y_type=types.uni
+0000eb90: 636f 6465 5f74 7970 652c 2076 616c 7565  code_type, value
+0000eba0: 5f74 7970 653d 7479 7065 732e 666c 6f61  _type=types.floa
+0000ebb0: 7436 340a 2020 2020 2020 2020 2020 2020  t64.            
+0000ebc0: 292c 0a20 2020 2020 2020 2029 0a20 2020  ),.        ).   
+0000ebd0: 2020 2020 2073 7069 6b65 5f76 616c 7320       spike_vals 
+0000ebe0: 3d20 5b5d 0a20 2020 2020 2020 2066 6f72  = [].        for
+0000ebf0: 2069 2069 6e20 7072 616e 6765 286c 656e   i in prange(len
+0000ec00: 2873 7069 6b65 5f69 6478 2929 3a0a 2020  (spike_idx)):.  
+0000ec10: 2020 2020 2020 2020 2020 7370 696b 655f            spike_
+0000ec20: 6461 7461 203d 2064 6174 615b 7370 696b  data = data[spik
+0000ec30: 655f 6964 785b 695d 5d0a 2020 2020 2020  e_idx[i]].      
+0000ec40: 2020 2020 2020 7370 696b 655f 616d 706c        spike_ampl
+0000ec50: 6974 7564 6520 3d20 6e70 2e6d 6178 2873  itude = np.max(s
+0000ec60: 7069 6b65 5f64 6174 6129 202d 2062 6173  pike_data) - bas
+0000ec70: 656c 696e 650a 2020 2020 2020 2020 2020  eline.          
+0000ec80: 2020 6861 6c66 5f77 6964 7468 5f69 6478    half_width_idx
+0000ec90: 203d 206e 702e 6172 6777 6865 7265 2873   = np.argwhere(s
+0000eca0: 7069 6b65 5f64 6174 6120 3e20 7370 696b  pike_data > spik
+0000ecb0: 655f 616d 706c 6974 7564 6520 2f20 3229  e_amplitude / 2)
+0000ecc0: 2e66 6c61 7474 656e 2829 0a20 2020 2020  .flatten().     
+0000ecd0: 2020 2020 2020 2073 7069 6b65 5f64 6963         spike_dic
+0000ece0: 745b 695d 203d 207b 0a20 2020 2020 2020  t[i] = {.       
+0000ecf0: 2020 2020 2020 2020 2022 616d 706c 6974           "amplit
+0000ed00: 7564 6522 3a20 6e70 2e6d 6178 2873 7069  ude": np.max(spi
+0000ed10: 6b65 5f64 6174 6129 202d 2062 6173 656c  ke_data) - basel
+0000ed20: 696e 652c 0a20 2020 2020 2020 2020 2020  ine,.           
+0000ed30: 2020 2020 2022 6677 686d 223a 2028 6861       "fwhm": (ha
+0000ed40: 6c66 5f77 6964 7468 5f69 6478 5b2d 315d  lf_width_idx[-1]
+0000ed50: 202d 2068 616c 665f 7769 6474 685f 6964   - half_width_id
+0000ed60: 785b 305d 2920 2f20 7361 6d70 6c65 5f72  x[0]) / sample_r
+0000ed70: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
+0000ed80: 2020 2020 2022 6861 6c66 5f77 6964 7468       "half_width
+0000ed90: 223a 2068 616c 665f 7769 6474 685f 6964  ": half_width_id
+0000eda0: 782e 7368 6170 655b 305d 202f 2073 616d  x.shape[0] / sam
+0000edb0: 706c 655f 7261 7465 2c0a 2020 2020 2020  ple_rate,.      
+0000edc0: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+0000edd0: 2020 2020 7370 696b 655f 7661 6c73 2e61      spike_vals.a
+0000ede0: 7070 656e 6428 7370 696b 655f 6461 7461  ppend(spike_data
+0000edf0: 290a 0a20 2020 2020 2020 2072 656d 6f76  )..        remov
+0000ee00: 655f 6964 7820 3d20 5b5d 0a20 2020 2020  e_idx = [].     
+0000ee10: 2020 2066 6f72 206b 2c20 7620 696e 2073     for k, v in s
+0000ee20: 7069 6b65 5f64 6963 742e 6974 656d 7328  pike_dict.items(
+0000ee30: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
+0000ee40: 6620 2876 5b22 6677 686d 225d 203c 206d  f (v["fwhm"] < m
+0000ee50: 696e 5f66 7768 6d29 206f 7220 2876 5b22  in_fwhm) or (v["
+0000ee60: 6861 6c66 5f77 6964 7468 225d 203c 206d  half_width"] < m
+0000ee70: 696e 5f68 616c 665f 7769 6474 6829 3a0a  in_half_width):.
+0000ee80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ee90: 7265 6d6f 7665 5f69 6478 2e61 7070 656e  remove_idx.appen
+0000eea0: 6428 6b29 0a20 2020 2020 2020 2066 6f72  d(k).        for
+0000eeb0: 2069 6478 2069 6e20 7265 6d6f 7665 5f69   idx in remove_i
+0000eec0: 6478 3a0a 2020 2020 2020 2020 2020 2020  dx:.            
+0000eed0: 7370 696b 655f 6469 6374 2e70 6f70 2869  spike_dict.pop(i
+0000eee0: 6478 290a 2020 2020 2020 2020 7370 696b  dx).        spik
+0000eef0: 655f 6964 7820 3d20 5b69 2066 6f72 206a  e_idx = [i for j
+0000ef00: 2c20 6920 696e 2065 6e75 6d65 7261 7465  , i in enumerate
+0000ef10: 2873 7069 6b65 5f69 6478 2920 6966 206a  (spike_idx) if j
+0000ef20: 206e 6f74 2069 6e20 7265 6d6f 7665 5f69   not in remove_i
+0000ef30: 6478 5d0a 2020 2020 2020 2020 7370 696b  dx].        spik
+0000ef40: 655f 7661 6c73 203d 205b 6920 666f 7220  e_vals = [i for 
+0000ef50: 6a2c 2069 2069 6e20 656e 756d 6572 6174  j, i in enumerat
+0000ef60: 6528 7370 696b 655f 7661 6c73 2920 6966  e(spike_vals) if
+0000ef70: 206a 206e 6f74 2069 6e20 7265 6d6f 7665   j not in remove
+0000ef80: 5f69 6478 5d0a 0a20 2020 2020 2020 2072  _idx]..        r
+0000ef90: 6574 7572 6e20 7370 696b 655f 6964 782c  eturn spike_idx,
+0000efa0: 2073 7069 6b65 5f76 616c 732c 2073 7069   spike_vals, spi
+0000efb0: 6b65 5f64 6963 740a 0a20 2020 2023 2040  ke_dict..    # @
+0000efc0: 6e6a 6974 2822 2866 6c6f 6174 3332 5b3a  njit("(float32[:
+0000efd0: 5d2c 2074 7970 6573 2e4c 6973 7428 7479  ], types.List(ty
+0000efe0: 7065 732e 4172 7261 7928 7479 7065 732e  pes.Array(types.
+0000eff0: 696e 7436 342c 2031 2c20 2743 2729 292c  int64, 1, 'C')),
+0000f000: 2069 6e74 3634 2c20 666c 6f61 7436 342c   int64, float64,
+0000f010: 2066 6c6f 6174 3634 2922 2c20 6661 7374   float64)", fast
+0000f020: 6d61 7468 3d54 7275 6529 0a20 2020 2040  math=True).    @
+0000f030: 7374 6174 6963 6d65 7468 6f64 0a20 2020  staticmethod.   
+0000f040: 2040 6a69 7428 6e6f 7079 7468 6f6e 3d54   @jit(nopython=T
+0000f050: 7275 652c 2066 6173 746d 6174 683d 5472  rue, fastmath=Tr
+0000f060: 7565 290a 2020 2020 6465 6620 7370 696b  ue).    def spik
+0000f070: 655f 7472 6169 6e5f 6669 6e64 6572 280a  e_train_finder(.
+0000f080: 2020 2020 2020 2020 6461 7461 3a20 6e70          data: np
+0000f090: 2e6e 6461 7272 6179 2c0a 2020 2020 2020  .ndarray,.      
+0000f0a0: 2020 7370 696b 655f 6964 783a 206c 6973    spike_idx: lis
+0000f0b0: 742c 0a20 2020 2020 2020 2073 616d 706c  t,.        sampl
+0000f0c0: 655f 7261 7465 3a20 666c 6f61 742c 0a20  e_rate: float,. 
+0000f0d0: 2020 2020 2020 206d 696e 5f73 7069 6b65         min_spike
+0000f0e0: 5f74 7261 696e 5f6c 656e 6774 683a 2066  _train_length: f
+0000f0f0: 6c6f 6174 203d 206e 702e 696e 662c 0a20  loat = np.inf,. 
+0000f100: 2020 2020 2020 206d 6178 5f73 7069 6b65         max_spike
+0000f110: 5f74 7261 696e 5f73 6570 6172 6174 696f  _train_separatio
+0000f120: 6e3a 2066 6c6f 6174 203d 206e 702e 696e  n: float = np.in
+0000f130: 662c 0a20 2020 2029 3a0a 2020 2020 2020  f,.    ):.      
+0000f140: 2020 2222 220a 2020 2020 2020 2020 4964    """.        Id
+0000f150: 656e 7469 6679 2061 6e64 2061 6e61 6c79  entify and analy
+0000f160: 7a65 2073 7069 6b65 2074 7261 696e 7320  ze spike trains 
+0000f170: 6672 6f6d 2061 206c 6973 7420 6f66 2073  from a list of s
+0000f180: 7069 6b65 2069 6e64 6963 6573 2e0a 0a20  pike indices... 
+0000f190: 2020 2020 2020 2054 6869 7320 6675 6e63         This func
+0000f1a0: 7469 6f6e 2074 616b 6573 2073 7069 6b65  tion takes spike
+0000f1b0: 2069 6e64 6963 6573 2061 6e64 2061 6464   indices and add
+0000f1c0: 6974 696f 6e61 6c20 696e 666f 726d 6174  itional informat
+0000f1d0: 696f 6e2c 2073 7563 6820 6173 2074 6865  ion, such as the
+0000f1e0: 2064 6174 612c 2073 616d 706c 6520 7261   data, sample ra
+0000f1f0: 7465 2c0a 2020 2020 2020 2020 6d69 6e69  te,.        mini
+0000f200: 6d75 6d20 7370 696b 6520 7472 6169 6e20  mum spike train 
+0000f210: 6c65 6e67 7468 2c20 616e 6420 6d61 7869  length, and maxi
+0000f220: 6d75 6d20 7370 696b 6520 7472 6169 6e20  mum spike train 
+0000f230: 7365 7061 7261 7469 6f6e 2c20 746f 2069  separation, to i
+0000f240: 6465 6e74 6966 7920 616e 6420 616e 616c  dentify and anal
+0000f250: 797a 650a 2020 2020 2020 2020 7370 696b  yze.        spik
+0000f260: 6520 7472 6169 6e73 2069 6e20 7468 6520  e trains in the 
+0000f270: 6461 7461 2e0a 0a20 2020 2020 2020 202e  data...        .
+0000f280: 2e20 6e6f 7465 3a3a 0a20 2020 2020 2020  . note::.       
+0000f290: 2020 2020 2d20 5468 6520 6675 6e63 7469      - The functi
+0000f2a0: 6f6e 206d 6179 2072 6574 7572 6e20 616e  on may return an
+0000f2b0: 2065 6d70 7479 2064 6963 7469 6f6e 6172   empty dictionar
+0000f2c0: 7920 6966 206e 6f20 7370 696b 6520 7472  y if no spike tr
+0000f2d0: 6169 6e73 206d 6565 7420 7468 6520 6372  ains meet the cr
+0000f2e0: 6974 6572 6961 2e0a 2020 2020 2020 2020  iteria..        
+0000f2f0: 2020 202d 2041 2072 6571 7569 7265 6420     - A required 
+0000f300: 696e 7075 7420 6973 2060 6073 7069 6b65  input is ``spike
+0000f310: 5f69 6478 6060 2c20 7768 6963 6820 6973  _idx``, which is
+0000f320: 2072 6574 7572 6e65 6420 6279 203a 6675   returned by :fu
+0000f330: 6e63 3a60 7e74 696d 6573 6572 6965 735f  nc:`~timeseries_
+0000f340: 6665 6174 7572 6573 5f6d 6978 696e 2e54  features_mixin.T
+0000f350: 696d 6573 6572 6965 7346 6561 7475 7265  imeseriesFeature
+0000f360: 4d69 7869 6e2e 7370 696b 655f 6669 6e64  Mixin.spike_find
+0000f370: 6572 602e 0a0a 0a20 2020 2020 2020 203a  er`....        :
+0000f380: 7061 7261 6d20 6e70 2e6e 6461 7272 6179  param np.ndarray
+0000f390: 2064 6174 613a 2054 6865 2064 6174 6120   data: The data 
+0000f3a0: 6672 6f6d 2077 6869 6368 2073 7069 6b65  from which spike
+0000f3b0: 2074 7261 696e 7320 6172 6520 6578 7472   trains are extr
+0000f3c0: 6163 7465 642e 0a20 2020 2020 2020 203a  acted..        :
+0000f3d0: 7061 7261 6d20 7479 7065 732e 4c69 7374  param types.List
+0000f3e0: 2874 7970 6573 2e41 7272 6179 2874 7970  (types.Array(typ
+0000f3f0: 6573 2e69 6e74 3634 2c20 312c 2027 4327  es.int64, 1, 'C'
+0000f400: 2929 2064 6174 613a 2041 206c 6973 7420  )) data: A list 
+0000f410: 6f66 2073 7069 6b65 2069 6e64 6963 6573  of spike indices
+0000f420: 2c20 7479 7069 6361 6c6c 7920 6173 2069  , typically as i
+0000f430: 6e74 6567 6572 2074 696d 6573 7461 6d70  nteger timestamp
+0000f440: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
+0000f450: 6d20 666c 6f61 7420 7361 6d70 6c65 5f72  m float sample_r
+0000f460: 6174 653a 2054 6865 2073 616d 706c 6520  ate: The sample 
+0000f470: 7261 7465 206f 6620 7468 6520 6461 7461  rate of the data
+0000f480: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0000f490: 204f 7074 696f 6e61 6c5b 666c 6f61 745d   Optional[float]
+0000f4a0: 206d 696e 5f73 7069 6b65 5f74 7261 696e   min_spike_train
+0000f4b0: 5f6c 656e 6774 683a 2054 6865 206d 696e  _length: The min
+0000f4c0: 696d 756d 206c 656e 6774 6820 6120 7370  imum length a sp
+0000f4d0: 696b 6520 7472 6169 6e20 6d75 7374 2068  ike train must h
+0000f4e0: 6176 6520 746f 2062 6520 636f 6e73 6964  ave to be consid
+0000f4f0: 6572 6564 2e20 4465 6661 756c 7420 6973  ered. Default is
+0000f500: 2073 6574 2074 6f20 706f 7369 7469 7665   set to positive
+0000f510: 2069 6e66 696e 6974 792c 206d 6561 6e69   infinity, meani
+0000f520: 6e67 206e 6f20 6d69 6e69 6d75 6d20 6c65  ng no minimum le
+0000f530: 6e67 7468 2069 7320 656e 666f 7263 6564  ngth is enforced
+0000f540: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0000f550: 204f 7074 696f 6e61 6c5b 666c 6f61 745d   Optional[float]
+0000f560: 206d 6178 5f73 7069 6b65 5f74 7261 696e   max_spike_train
+0000f570: 5f73 6570 6172 6174 696f 6e3a 2054 6865  _separation: The
+0000f580: 206d 6178 696d 756d 2061 6c6c 6f77 6162   maximum allowab
+0000f590: 6c65 2073 6570 6172 6174 696f 6e20 6265  le separation be
+0000f5a0: 7477 6565 6e20 7370 696b 6573 2069 6e20  tween spikes in 
+0000f5b0: 7468 6520 7361 6d65 2074 7261 696e 2e20  the same train. 
+0000f5c0: 4465 6661 756c 7420 6973 2073 6574 2074  Default is set t
+0000f5d0: 6f20 706f 7369 7469 7665 2069 6e66 696e  o positive infin
+0000f5e0: 6974 792c 206d 6561 6e69 6e67 206e 6f20  ity, meaning no 
+0000f5f0: 6d61 7869 6d75 6d20 7365 7061 7261 7469  maximum separati
+0000f600: 6f6e 2069 7320 656e 666f 7263 6564 2e0a  on is enforced..
+0000f610: 2020 2020 2020 2020 3a72 6574 7572 6e20          :return 
+0000f620: 4469 6374 5479 7065 5b69 6e74 3634 2c44  DictType[int64,D
+0000f630: 6963 7454 7970 655b 756e 6963 6f64 655f  ictType[unicode_
+0000f640: 7479 7065 2c66 6c6f 6174 3634 5d5d 3a20  type,float64]]: 
+0000f650: 4120 6469 6374 696f 6e61 7279 2063 6f6e  A dictionary con
+0000f660: 7461 696e 696e 6720 696e 666f 726d 6174  taining informat
+0000f670: 696f 6e20 6162 6f75 7420 6964 656e 7469  ion about identi
+0000f680: 6669 6564 2073 7069 6b65 2074 7261 696e  fied spike train
+0000f690: 732e 0a0a 2020 2020 2020 2020 4561 6368  s...        Each
+0000f6a0: 2065 6e74 7279 2069 6e20 7468 6520 7265   entry in the re
+0000f6b0: 7475 726e 6564 2064 6963 7469 6f6e 6172  turned dictionar
+0000f6c0: 7920 6973 2069 6e64 6578 6564 2062 7920  y is indexed by 
+0000f6d0: 616e 2069 6e74 6567 6572 2c20 616e 6420  an integer, and 
+0000f6e0: 636f 6e74 6169 6e73 2074 6865 2066 6f6c  contains the fol
+0000f6f0: 6c6f 7769 6e67 2069 6e66 6f72 6d61 7469  lowing informati
+0000f700: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
+0000f710: 2d20 2774 7261 696e 5f73 7461 7274 5f74  - 'train_start_t
+0000f720: 696d 6527 3a20 5374 6172 7420 7469 6d65  ime': Start time
+0000f730: 206f 6620 7468 6520 7370 696b 6520 7472   of the spike tr
+0000f740: 6169 6e20 696e 2073 6563 6f6e 6473 2e0a  ain in seconds..
+0000f750: 2020 2020 2020 2020 2020 2020 2d20 2774              - 't
+0000f760: 7261 696e 5f65 6e64 5f74 696d 6527 3a20  rain_end_time': 
+0000f770: 456e 6420 7469 6d65 206f 6620 7468 6520  End time of the 
+0000f780: 7370 696b 6520 7472 6169 6e20 696e 2073  spike train in s
+0000f790: 6563 6f6e 6473 2e0a 2020 2020 2020 2020  econds..        
+0000f7a0: 2020 2020 2d20 2774 7261 696e 5f73 7461      - 'train_sta
+0000f7b0: 7274 5f6f 6273 273a 2053 7461 7274 2074  rt_obs': Start t
+0000f7c0: 696d 6520 696e 6465 7820 696e 206f 6273  ime index in obs
+0000f7d0: 6572 7661 7469 6f6e 732e 0a20 2020 2020  ervations..     
+0000f7e0: 2020 2020 2020 202d 2027 7472 6169 6e5f         - 'train_
+0000f7f0: 656e 645f 6f62 7327 3a20 456e 6420 7469  end_obs': End ti
+0000f800: 6d65 2069 6e64 6578 2069 6e20 6f62 7365  me index in obse
+0000f810: 7276 6174 696f 6e73 2e0a 2020 2020 2020  rvations..      
+0000f820: 2020 2020 2020 2d20 2773 7069 6b65 5f63        - 'spike_c
+0000f830: 6e74 273a 204e 756d 6265 7220 6f66 2073  nt': Number of s
+0000f840: 7069 6b65 7320 696e 2074 6865 2073 7069  pikes in the spi
+0000f850: 6b65 2074 7261 696e 2e0a 2020 2020 2020  ke train..      
+0000f860: 2020 2020 2020 2d20 2774 7261 696e 5f6c        - 'train_l
+0000f870: 656e 6774 685f 6f62 735f 636e 7427 3a20  ength_obs_cnt': 
+0000f880: 4c65 6e67 7468 206f 6620 7468 6520 7370  Length of the sp
+0000f890: 696b 6520 7472 6169 6e20 696e 206f 6273  ike train in obs
+0000f8a0: 6572 7661 7469 6f6e 732e 0a20 2020 2020  ervations..     
+0000f8b0: 2020 2020 2020 202d 2027 7472 6169 6e5f         - 'train_
+0000f8c0: 6c65 6e67 7468 5f6f 6273 5f73 273a 204c  length_obs_s': L
+0000f8d0: 656e 6774 6820 6f66 2074 6865 2073 7069  ength of the spi
+0000f8e0: 6b65 2074 7261 696e 2069 6e20 7365 636f  ke train in seco
+0000f8f0: 6e64 732e 0a20 2020 2020 2020 2020 2020  nds..           
+0000f900: 202d 2027 7472 6169 6e5f 7370 696b 655f   - 'train_spike_
+0000f910: 6d65 616e 5f6c 656e 6774 6873 5f73 273a  mean_lengths_s':
+0000f920: 204d 6561 6e20 6c65 6e67 7468 206f 6620   Mean length of 
+0000f930: 696e 6469 7669 6475 616c 2073 7069 6b65  individual spike
+0000f940: 7320 696e 2073 6563 6f6e 6473 2e0a 2020  s in seconds..  
+0000f950: 2020 2020 2020 2020 2020 2d20 2774 7261            - 'tra
+0000f960: 696e 5f73 7069 6b65 5f73 7464 5f6c 656e  in_spike_std_len
+0000f970: 6774 685f 6f62 7327 3a20 5374 616e 6461  gth_obs': Standa
+0000f980: 7264 2064 6576 6961 7469 6f6e 206f 6620  rd deviation of 
+0000f990: 7370 696b 6520 6c65 6e67 7468 7320 696e  spike lengths in
+0000f9a0: 206f 6273 6572 7661 7469 6f6e 732e 0a20   observations.. 
+0000f9b0: 2020 2020 2020 2020 2020 202d 2027 7472             - 'tr
+0000f9c0: 6169 6e5f 7370 696b 655f 7374 645f 6c65  ain_spike_std_le
+0000f9d0: 6e67 7468 5f73 273a 2053 7461 6e64 6172  ngth_s': Standar
+0000f9e0: 6420 6465 7669 6174 696f 6e20 6f66 2073  d deviation of s
+0000f9f0: 7069 6b65 206c 656e 6774 6873 2069 6e20  pike lengths in 
+0000fa00: 7365 636f 6e64 732e 0a20 2020 2020 2020  seconds..       
+0000fa10: 2020 2020 202d 2027 7472 6169 6e5f 7370       - 'train_sp
+0000fa20: 696b 655f 6d61 785f 6c65 6e67 7468 5f6f  ike_max_length_o
+0000fa30: 6273 273a 204d 6178 696d 756d 2073 7069  bs': Maximum spi
+0000fa40: 6b65 206c 656e 6774 6820 696e 206f 6273  ke length in obs
+0000fa50: 6572 7661 7469 6f6e 732e 0a20 2020 2020  ervations..     
+0000fa60: 2020 2020 2020 202d 2027 7472 6169 6e5f         - 'train_
+0000fa70: 7370 696b 655f 6d61 785f 6c65 6e67 7468  spike_max_length
+0000fa80: 5f73 273a 204d 6178 696d 756d 2073 7069  _s': Maximum spi
+0000fa90: 6b65 206c 656e 6774 6820 696e 2073 6563  ke length in sec
+0000faa0: 6f6e 6473 2e0a 2020 2020 2020 2020 2020  onds..          
+0000fab0: 2020 2d20 2774 7261 696e 5f73 7069 6b65    - 'train_spike
+0000fac0: 5f6d 696e 5f6c 656e 6774 685f 6f62 7327  _min_length_obs'
+0000fad0: 3a20 4d69 6e69 6d75 6d20 7370 696b 6520  : Minimum spike 
+0000fae0: 6c65 6e67 7468 2069 6e20 6f62 7365 7276  length in observ
+0000faf0: 6174 696f 6e73 2e0a 2020 2020 2020 2020  ations..        
+0000fb00: 2020 2020 2d20 2774 7261 696e 5f73 7069      - 'train_spi
+0000fb10: 6b65 5f6d 696e 5f6c 656e 6774 685f 7327  ke_min_length_s'
+0000fb20: 3a20 4d69 6e69 6d75 6d20 7370 696b 6520  : Minimum spike 
+0000fb30: 6c65 6e67 7468 2069 6e20 7365 636f 6e64  length in second
+0000fb40: 732e 0a20 2020 2020 2020 2020 2020 202d  s..            -
+0000fb50: 2027 7472 6169 6e5f 6d65 616e 5f61 6d70   'train_mean_amp
+0000fb60: 6c69 7475 6465 273a 204d 6561 6e20 616d  litude': Mean am
+0000fb70: 706c 6974 7564 6520 6f66 2074 6865 2073  plitude of the s
+0000fb80: 7069 6b65 2074 7261 696e 2e0a 2020 2020  pike train..    
+0000fb90: 2020 2020 2020 2020 2d20 2774 7261 696e          - 'train
+0000fba0: 5f73 7464 5f61 6d70 6c69 7475 6465 273a  _std_amplitude':
+0000fbb0: 2053 7461 6e64 6172 6420 6465 7669 6174   Standard deviat
+0000fbc0: 696f 6e20 6f66 2073 7069 6b65 2061 6d70  ion of spike amp
+0000fbd0: 6c69 7475 6465 732e 0a20 2020 2020 2020  litudes..       
+0000fbe0: 2020 2020 202d 2027 7472 6169 6e5f 6d69       - 'train_mi
+0000fbf0: 6e5f 616d 706c 6974 7564 6527 3a20 4d69  n_amplitude': Mi
+0000fc00: 6e69 6d75 6d20 7370 696b 6520 616d 706c  nimum spike ampl
+0000fc10: 6974 7564 652e 0a20 2020 2020 2020 2020  itude..         
+0000fc20: 2020 202d 2027 7472 6169 6e5f 6d61 785f     - 'train_max_
+0000fc30: 616d 706c 6974 7564 6527 3a20 4d61 7869  amplitude': Maxi
+0000fc40: 6d75 6d20 7370 696b 6520 616d 706c 6974  mum spike amplit
+0000fc50: 7564 652e 0a0a 2020 2020 2020 2020 3a65  ude...        :e
+0000fc60: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
+0000fc70: 3e3e 3e20 6461 7461 203d 206e 702e 6172  >>> data = np.ar
+0000fc80: 7261 7928 5b30 2e31 2c20 302e 312c 2030  ray([0.1, 0.1, 0
+0000fc90: 2e33 2c20 302e 312c 2031 302c 2031 302c  .3, 0.1, 10, 10,
+0000fca0: 2038 2c20 302e 312c 2030 2e31 2c20 302e   8, 0.1, 0.1, 0.
+0000fcb0: 312c 2031 302c 2031 302c 2038 2c20 3939  1, 10, 10, 8, 99
+0000fcc0: 2c20 302e 312c 2039 392c 2039 392c 2030  , 0.1, 99, 99, 0
+0000fcd0: 2e31 5d29 2e61 7374 7970 6528 6e70 2e66  .1]).astype(np.f
+0000fce0: 6c6f 6174 3332 290a 2020 2020 2020 2020  loat32).        
+0000fcf0: 3e3e 3e20 7370 696b 655f 6964 782c 205f  >>> spike_idx, _
+0000fd00: 2c20 5f20 3d20 5469 6d65 7365 7269 6573  , _ = Timeseries
+0000fd10: 4665 6174 7572 654d 6978 696e 2829 2e73  FeatureMixin().s
+0000fd20: 7069 6b65 5f66 696e 6465 7228 6461 7461  pike_finder(data
+0000fd30: 3d64 6174 612c 2062 6173 656c 696e 653d  =data, baseline=
+0000fd40: 302e 332c 206d 696e 5f73 7069 6b65 5f61  0.3, min_spike_a
+0000fd50: 6d70 6c69 7475 6465 3d30 2e32 2c20 7361  mplitude=0.2, sa
+0000fd60: 6d70 6c65 5f72 6174 653d 322c 206d 696e  mple_rate=2, min
+0000fd70: 5f66 7768 6d3d 2d6e 702e 696e 662c 206d  _fwhm=-np.inf, m
+0000fd80: 696e 5f68 616c 665f 7769 6474 683d 2d6e  in_half_width=-n
+0000fd90: 702e 696e 6629 0a20 2020 2020 2020 203e  p.inf).        >
+0000fda0: 3e3e 2072 6573 756c 7473 203d 2054 696d  >> results = Tim
+0000fdb0: 6573 6572 6965 7346 6561 7475 7265 4d69  eseriesFeatureMi
+0000fdc0: 7869 6e28 292e 7370 696b 655f 7472 6169  xin().spike_trai
+0000fdd0: 6e5f 6669 6e64 6572 2864 6174 613d 6461  n_finder(data=da
+0000fde0: 7461 2c20 7370 696b 655f 6964 783d 7479  ta, spike_idx=ty
+0000fdf0: 7065 642e 4c69 7374 2873 7069 6b65 5f69  ped.List(spike_i
+0000fe00: 6478 292c 2073 616d 706c 655f 7261 7465  dx), sample_rate
+0000fe10: 3d32 2e30 2c20 6d69 6e5f 7370 696b 655f  =2.0, min_spike_
+0000fe20: 7472 6169 6e5f 6c65 6e67 7468 3d32 2e30  train_length=2.0
+0000fe30: 2c20 6d61 785f 7370 696b 655f 7472 6169  , max_spike_trai
+0000fe40: 6e5f 7365 7061 7261 7469 6f6e 3d32 2e30  n_separation=2.0
+0000fe50: 290a 2020 2020 2020 2020 2222 220a 0a20  ).        """.. 
+0000fe60: 2020 2020 2020 2028 0a20 2020 2020 2020         (.       
+0000fe70: 2020 2020 206c 2c0a 2020 2020 2020 2020       l,.        
+0000fe80: 2020 2020 722c 0a20 2020 2020 2020 2029      r,.        )
+0000fe90: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+0000fea0: 2030 2c0a 2020 2020 2020 2020 2020 2020   0,.            
+0000feb0: 312c 0a20 2020 2020 2020 2029 0a20 2020  1,.        ).   
+0000fec0: 2020 2020 2074 7261 696e 5f64 6174 615f       train_data_
+0000fed0: 6964 7820 3d20 5b5d 0a20 2020 2020 2020  idx = [].       
+0000fee0: 2074 7261 696e 5f73 7069 6b65 735f 6964   train_spikes_id
+0000fef0: 7820 3d20 5b5d 0a20 2020 2020 2020 206d  x = [].        m
+0000ff00: 6178 5f73 7069 6b65 5f74 7261 696e 5f73  ax_spike_train_s
+0000ff10: 6570 6172 6174 696f 6e20 3d20 696e 7428  eparation = int(
+0000ff20: 6d61 785f 7370 696b 655f 7472 6169 6e5f  max_spike_train_
+0000ff30: 7365 7061 7261 7469 6f6e 202a 2073 616d  separation * sam
+0000ff40: 706c 655f 7261 7465 290a 2020 2020 2020  ple_rate).      
+0000ff50: 2020 6d69 6e5f 7370 696b 655f 7472 6169    min_spike_trai
+0000ff60: 6e5f 6c65 6e67 7468 203d 2069 6e74 286d  n_length = int(m
+0000ff70: 696e 5f73 7069 6b65 5f74 7261 696e 5f6c  in_spike_train_l
+0000ff80: 656e 6774 6820 2a20 7361 6d70 6c65 5f72  ength * sample_r
+0000ff90: 6174 6529 0a20 2020 2020 2020 2077 6869  ate).        whi
+0000ffa0: 6c65 206c 203c 206c 656e 2873 7069 6b65  le l < len(spike
+0000ffb0: 5f69 6478 293a 0a20 2020 2020 2020 2020  _idx):.         
+0000ffc0: 2020 2063 7572 7265 6e74 5f74 7261 696e     current_train
+0000ffd0: 2c20 6375 7272 656e 745f 7370 696b 655f  , current_spike_
+0000ffe0: 6964 7820 3d20 7370 696b 655f 6964 785b  idx = spike_idx[
+0000fff0: 6c5d 2c20 5b6c 5d0a 2020 2020 2020 2020  l], [l].        
+00010000: 2020 2020 7768 696c 6520 7220 3c20 6c65      while r < le
+00010010: 6e28 7370 696b 655f 6964 7829 2061 6e64  n(spike_idx) and
+00010020: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+00010030: 2020 2028 7370 696b 655f 6964 785b 725d     (spike_idx[r]
+00010040: 5b30 5d20 2d20 6375 7272 656e 745f 7472  [0] - current_tr
+00010050: 6169 6e5b 2d31 5d29 203c 3d20 6d61 785f  ain[-1]) <= max_
+00010060: 7370 696b 655f 7472 6169 6e5f 7365 7061  spike_train_sepa
+00010070: 7261 7469 6f6e 0a20 2020 2020 2020 2020  ration.         
+00010080: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+00010090: 2020 2020 2020 6375 7272 656e 745f 7472        current_tr
+000100a0: 6169 6e20 3d20 6e70 2e68 7374 6163 6b28  ain = np.hstack(
+000100b0: 2863 7572 7265 6e74 5f74 7261 696e 2c20  (current_train, 
+000100c0: 7370 696b 655f 6964 785b 725d 2929 0a20  spike_idx[r])). 
+000100d0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+000100e0: 7572 7265 6e74 5f73 7069 6b65 5f69 6478  urrent_spike_idx
+000100f0: 2e61 7070 656e 6428 7229 0a20 2020 2020  .append(r).     
+00010100: 2020 2020 2020 2020 2020 2072 202b 3d20             r += 
+00010110: 310a 2020 2020 2020 2020 2020 2020 6c2c  1.            l,
+00010120: 2072 203d 2072 2c20 7220 2b20 310a 2020   r = r, r + 1.  
+00010130: 2020 2020 2020 2020 2020 7472 6169 6e5f            train_
+00010140: 6461 7461 5f69 6478 2e61 7070 656e 6428  data_idx.append(
+00010150: 6375 7272 656e 745f 7472 6169 6e29 0a20  current_train). 
+00010160: 2020 2020 2020 2020 2020 2074 7261 696e             train
+00010170: 5f73 7069 6b65 735f 6964 782e 6170 7065  _spikes_idx.appe
+00010180: 6e64 2863 7572 7265 6e74 5f73 7069 6b65  nd(current_spike
+00010190: 5f69 6478 290a 0a20 2020 2020 2020 2073  _idx)..        s
+000101a0: 7069 6b65 5f64 6963 7420 3d20 4469 6374  pike_dict = Dict
+000101b0: 2e65 6d70 7479 280a 2020 2020 2020 2020  .empty(.        
+000101c0: 2020 2020 6b65 795f 7479 7065 3d74 7970      key_type=typ
+000101d0: 6573 2e69 6e74 3634 2c0a 2020 2020 2020  es.int64,.      
+000101e0: 2020 2020 2020 7661 6c75 655f 7479 7065        value_type
+000101f0: 3d44 6963 742e 656d 7074 7928 0a20 2020  =Dict.empty(.   
+00010200: 2020 2020 2020 2020 2020 2020 206b 6579               key
+00010210: 5f74 7970 653d 7479 7065 732e 756e 6963  _type=types.unic
+00010220: 6f64 655f 7479 7065 2c20 7661 6c75 655f  ode_type, value_
+00010230: 7479 7065 3d74 7970 6573 2e66 6c6f 6174  type=types.float
+00010240: 3634 0a20 2020 2020 2020 2020 2020 2029  64.            )
+00010250: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+00010260: 2020 2020 666f 7220 6920 696e 2070 7261      for i in pra
+00010270: 6e67 6528 6c65 6e28 7472 6169 6e5f 6461  nge(len(train_da
+00010280: 7461 5f69 6478 2929 3a0a 2020 2020 2020  ta_idx)):.      
+00010290: 2020 2020 2020 6966 2074 7261 696e 5f64        if train_d
+000102a0: 6174 615f 6964 785b 695d 2e73 6861 7065  ata_idx[i].shape
+000102b0: 5b30 5d20 3e3d 206d 696e 5f73 7069 6b65  [0] >= min_spike
+000102c0: 5f74 7261 696e 5f6c 656e 6774 683a 0a20  _train_length:. 
+000102d0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000102e0: 7069 6b65 5f74 7261 696e 5f61 6d70 7320  pike_train_amps 
+000102f0: 3d20 6461 7461 5b74 7261 696e 5f64 6174  = data[train_dat
+00010300: 615f 6964 785b 695d 5d0a 2020 2020 2020  a_idx[i]].      
+00010310: 2020 2020 2020 2020 2020 7370 696b 655f            spike_
+00010320: 7472 6169 6e5f 6964 7820 3d20 5b0a 2020  train_idx = [.  
+00010330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010340: 2020 6b20 666f 7220 6a2c 206b 2069 6e20    k for j, k in 
+00010350: 656e 756d 6572 6174 6528 7370 696b 655f  enumerate(spike_
+00010360: 6964 7829 2069 6620 6a20 696e 2074 7261  idx) if j in tra
+00010370: 696e 5f73 7069 6b65 735f 6964 785b 695d  in_spikes_idx[i]
+00010380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010390: 205d 0a20 2020 2020 2020 2020 2020 2020   ].             
+000103a0: 2020 2074 7261 696e 5f73 7069 6b65 5f6c     train_spike_l
+000103b0: 656e 6774 6873 203d 206e 702e 6172 7261  engths = np.arra
+000103c0: 7928 285b 6c65 6e28 6a29 2066 6f72 206a  y(([len(j) for j
+000103d0: 2069 6e20 7370 696b 655f 7472 6169 6e5f   in spike_train_
+000103e0: 6964 785d 2929 0a20 2020 2020 2020 2020  idx])).         
+000103f0: 2020 2020 2020 2073 7069 6b65 5f64 6963         spike_dic
+00010400: 745b 696e 7428 6929 5d20 3d20 7b0a 2020  t[int(i)] = {.  
 00010410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010420: 2020 2020 2a20 7361 6d70 6c65 5f72 6174      * sample_rat
-00010430: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-00010440: 2020 2020 2020 2022 7472 6169 6e5f 7370         "train_sp
-00010450: 696b 655f 6d61 785f 6c65 6e67 7468 5f6f  ike_max_length_o
-00010460: 6273 223a 206e 702e 6d61 7828 7472 6169  bs": np.max(trai
-00010470: 6e5f 7370 696b 655f 6c65 6e67 7468 7329  n_spike_lengths)
-00010480: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00010490: 2020 2020 2020 2274 7261 696e 5f73 7069        "train_spi
-000104a0: 6b65 5f6d 6178 5f6c 656e 6774 685f 7322  ke_max_length_s"
-000104b0: 3a20 6e70 2e6d 6178 2874 7261 696e 5f73  : np.max(train_s
-000104c0: 7069 6b65 5f6c 656e 6774 6873 290a 2020  pike_lengths).  
-000104d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000104e0: 2020 2a20 7361 6d70 6c65 5f72 6174 652c    * sample_rate,
-000104f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010500: 2020 2020 2022 7472 6169 6e5f 7370 696b       "train_spik
-00010510: 655f 6d69 6e5f 6c65 6e67 7468 5f6f 6273  e_min_length_obs
-00010520: 223a 206e 702e 6d69 6e28 7472 6169 6e5f  ": np.min(train_
-00010530: 7370 696b 655f 6c65 6e67 7468 7329 2c0a  spike_lengths),.
-00010540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010550: 2020 2020 2274 7261 696e 5f73 7069 6b65      "train_spike
-00010560: 5f6d 696e 5f6c 656e 6774 685f 7322 3a20  _min_length_s": 
-00010570: 6e70 2e6d 696e 2874 7261 696e 5f73 7069  np.min(train_spi
-00010580: 6b65 5f6c 656e 6774 6873 290a 2020 2020  ke_lengths).    
-00010590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000105a0: 2a20 7361 6d70 6c65 5f72 6174 652c 0a20  * sample_rate,. 
-000105b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000105c0: 2020 2022 7472 6169 6e5f 6d65 616e 5f61     "train_mean_a
-000105d0: 6d70 6c69 7475 6465 223a 206e 702e 6d65  mplitude": np.me
-000105e0: 616e 2873 7069 6b65 5f74 7261 696e 5f61  an(spike_train_a
-000105f0: 6d70 7329 2c0a 2020 2020 2020 2020 2020  mps),.          
-00010600: 2020 2020 2020 2020 2020 2274 7261 696e            "train
-00010610: 5f73 7464 5f61 6d70 6c69 7475 6465 223a  _std_amplitude":
-00010620: 206e 702e 7374 6428 7370 696b 655f 7472   np.std(spike_tr
-00010630: 6169 6e5f 616d 7073 292c 0a20 2020 2020  ain_amps),.     
-00010640: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00010650: 7472 6169 6e5f 6d69 6e5f 616d 706c 6974  train_min_amplit
-00010660: 7564 6522 3a20 6e70 2e6d 696e 2873 7069  ude": np.min(spi
-00010670: 6b65 5f74 7261 696e 5f61 6d70 7329 2c0a  ke_train_amps),.
-00010680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010690: 2020 2020 2274 7261 696e 5f6d 6178 5f61      "train_max_a
-000106a0: 6d70 6c69 7475 6465 223a 206e 702e 6d61  mplitude": np.ma
-000106b0: 7828 7370 696b 655f 7472 6169 6e5f 616d  x(spike_train_am
-000106c0: 7073 292c 0a20 2020 2020 2020 2020 2020  ps),.           
-000106d0: 2020 2020 207d 0a0a 2020 2020 2020 2020       }..        
-000106e0: 7265 7475 726e 2073 7069 6b65 5f64 6963  return spike_dic
-000106f0: 740a 0a20 2020 2040 7374 6174 6963 6d65  t..    @staticme
-00010700: 7468 6f64 0a20 2020 2064 6566 205f 6164  thod.    def _ad
-00010710: 665f 6578 6563 7574 6f72 2864 6174 613a  f_executor(data:
-00010720: 206e 702e 6e64 6172 7261 7929 202d 3e20   np.ndarray) -> 
-00010730: 7475 706c 653a 0a20 2020 2020 2020 2022  tuple:.        "
-00010740: 2222 0a20 2020 2020 2020 2048 656c 7065  "".        Helpe
-00010750: 7220 6675 6e63 7469 6f6e 2074 6f20 6578  r function to ex
-00010760: 6563 7574 6520 4175 676d 656e 7465 6420  ecute Augmented 
-00010770: 4469 636b 6579 2d46 756c 6c65 7220 2841  Dickey-Fuller (A
-00010780: 4446 2920 7465 7374 206f 6e20 6120 6461  DF) test on a da
-00010790: 7461 2073 6567 6d65 6e74 2e0a 2020 2020  ta segment..    
-000107a0: 2020 2020 4361 6c6c 6564 2062 7920 3a6d      Called by :m
-000107b0: 6574 683a 6074 696d 6573 6572 6965 735f  eth:`timeseries_
-000107c0: 6665 6174 7572 6573 5f6d 6978 696e 2e54  features_mixin.T
-000107d0: 696d 6573 6572 6965 7346 6561 7475 7265  imeseriesFeature
-000107e0: 4d69 7869 6e2e 736c 6964 696e 675f 7374  Mixin.sliding_st
-000107f0: 6174 696f 6e61 7279 5f74 6573 745f 7465  ationary_test_te
-00010800: 7374 602e 0a20 2020 2020 2020 2022 2222  st`..        """
-00010810: 0a0a 2020 2020 2020 2020 6164 6675 6c6c  ..        adfull
-00010820: 6572 5f72 6573 756c 7473 203d 2061 6466  er_results = adf
-00010830: 756c 6c65 7228 6461 7461 290a 2020 2020  uller(data).    
-00010840: 2020 2020 7265 7475 726e 2061 6466 756c      return adful
-00010850: 6c65 725f 7265 7375 6c74 735b 305d 2c20  ler_results[0], 
-00010860: 6164 6675 6c6c 6572 5f72 6573 756c 7473  adfuller_results
-00010870: 5b31 5d0a 0a20 2020 2040 7374 6174 6963  [1]..    @static
-00010880: 6d65 7468 6f64 0a20 2020 2064 6566 205f  method.    def _
-00010890: 6b70 7373 5f65 7865 6375 746f 7228 6461  kpss_executor(da
-000108a0: 7461 3a20 6e70 2e6e 6461 7272 6179 2920  ta: np.ndarray) 
-000108b0: 2d3e 2074 7570 6c65 3a0a 2020 2020 2020  -> tuple:.      
-000108c0: 2020 2222 220a 2020 2020 2020 2020 4865    """.        He
-000108d0: 6c70 6572 2066 756e 6374 696f 6e20 746f  lper function to
-000108e0: 2065 7865 6375 7465 204b 7769 6174 6b6f   execute Kwiatko
-000108f0: 7773 6b69 e280 9350 6869 6c6c 6970 73e2  wski...Phillips.
-00010900: 8093 5363 686d 6964 74e2 8093 5368 696e  ..Schmidt...Shin
-00010910: 2028 4b50 5353 2920 7465 7374 206f 6e20   (KPSS) test on 
-00010920: 6120 6461 7461 2073 6567 6d65 6e74 2e0a  a data segment..
-00010930: 2020 2020 2020 2020 4361 6c6c 6564 2062          Called b
-00010940: 7920 3a6d 6574 683a 6074 696d 6573 6572  y :meth:`timeser
-00010950: 6965 735f 6665 6174 7572 6573 5f6d 6978  ies_features_mix
-00010960: 696e 2e54 696d 6573 6572 6965 7346 6561  in.TimeseriesFea
-00010970: 7475 7265 4d69 7869 6e2e 736c 6964 696e  tureMixin.slidin
-00010980: 675f 7374 6174 696f 6e61 7279 5f74 6573  g_stationary_tes
-00010990: 745f 7465 7374 602e 0a20 2020 2020 2020  t_test`..       
-000109a0: 2022 2222 0a0a 2020 2020 2020 2020 6b70   """..        kp
-000109b0: 7373 5f72 6573 756c 7473 203d 206b 7073  ss_results = kps
-000109c0: 7328 6461 7461 290a 2020 2020 2020 2020  s(data).        
-000109d0: 7265 7475 726e 206b 7073 735f 7265 7375  return kpss_resu
-000109e0: 6c74 735b 305d 2c20 6b70 7373 5f72 6573  lts[0], kpss_res
-000109f0: 756c 7473 5b31 5d0a 0a20 2020 2040 7374  ults[1]..    @st
-00010a00: 6174 6963 6d65 7468 6f64 0a20 2020 2064  aticmethod.    d
-00010a10: 6566 205f 7a69 766f 7461 6e64 7265 7773  ef _zivotandrews
-00010a20: 5f65 7865 6375 746f 7228 6461 7461 3a20  _executor(data: 
-00010a30: 6e70 2e6e 6461 7272 6179 2920 2d3e 2074  np.ndarray) -> t
-00010a40: 7570 6c65 3a0a 2020 2020 2020 2020 2222  uple:.        ""
-00010a50: 220a 2020 2020 2020 2020 4865 6c70 6572  ".        Helper
-00010a60: 2066 756e 6374 696f 6e20 746f 2065 7865   function to exe
-00010a70: 6375 7465 205a 6976 6f74 2d41 6e64 7265  cute Zivot-Andre
-00010a80: 7773 2073 7472 7563 7475 7261 6c2d 6272  ws structural-br
-00010a90: 6561 6b20 756e 6974 2d72 6f6f 7420 7465  eak unit-root te
-00010aa0: 7374 206f 6e20 6120 6461 7461 2073 6567  st on a data seg
-00010ab0: 6d65 6e74 2e0a 2020 2020 2020 2020 4361  ment..        Ca
-00010ac0: 6c6c 6564 2062 7920 3a6d 6574 683a 6074  lled by :meth:`t
-00010ad0: 696d 6573 6572 6965 735f 6665 6174 7572  imeseries_featur
-00010ae0: 6573 5f6d 6978 696e 2e54 696d 6573 6572  es_mixin.Timeser
-00010af0: 6965 7346 6561 7475 7265 4d69 7869 6e2e  iesFeatureMixin.
-00010b00: 736c 6964 696e 675f 7374 6174 696f 6e61  sliding_stationa
-00010b10: 7279 5f74 6573 745f 7465 7374 602e 0a20  ry_test_test`.. 
-00010b20: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00010b30: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-00010b40: 2020 2020 7a61 5f72 6573 756c 7473 203d      za_results =
-00010b50: 207a 6976 6f74 5f61 6e64 7265 7773 2864   zivot_andrews(d
-00010b60: 6174 6129 0a20 2020 2020 2020 2020 2020  ata).           
-00010b70: 2072 6574 7572 6e20 7a61 5f72 6573 756c   return za_resul
-00010b80: 7473 5b30 5d2c 207a 615f 7265 7375 6c74  ts[0], za_result
-00010b90: 735b 315d 0a20 2020 2020 2020 2065 7863  s[1].        exc
-00010ba0: 6570 7420 286e 702e 6c69 6e61 6c67 2e4c  ept (np.linalg.L
-00010bb0: 696e 416c 6745 7272 6f72 2c20 5661 6c75  inAlgError, Valu
-00010bc0: 6545 7272 6f72 293a 0a20 2020 2020 2020  eError):.       
-00010bd0: 2020 2020 2072 6574 7572 6e20 302c 2030       return 0, 0
-00010be0: 0a0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
-00010bf0: 686f 640a 2020 2020 6465 6620 736c 6964  hod.    def slid
-00010c00: 696e 675f 7374 6174 696f 6e61 7279 280a  ing_stationary(.
-00010c10: 2020 2020 2020 2020 6461 7461 3a20 6e70          data: np
-00010c20: 2e6e 6461 7272 6179 2c0a 2020 2020 2020  .ndarray,.      
-00010c30: 2020 7469 6d65 5f77 696e 646f 7773 3a20    time_windows: 
-00010c40: 6e70 2e6e 6461 7272 6179 2c0a 2020 2020  np.ndarray,.    
-00010c50: 2020 2020 7361 6d70 6c65 5f72 6174 653a      sample_rate:
-00010c60: 2069 6e74 2c0a 2020 2020 2020 2020 7465   int,.        te
-00010c70: 7374 3a20 4c69 7465 7261 6c5b 2241 4446  st: Literal["ADF
-00010c80: 222c 2022 4b50 5353 222c 2022 5a41 225d  ", "KPSS", "ZA"]
-00010c90: 203d 2022 6164 6622 2c0a 2020 2020 2920   = "adf",.    ) 
-00010ca0: 2d3e 2028 6e70 2e6e 6461 7272 6179 2c20  -> (np.ndarray, 
-00010cb0: 6e70 2e6e 6461 7272 6179 293a 0a20 2020  np.ndarray):.   
-00010cc0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00010cd0: 2050 6572 666f 726d 2074 6865 2041 7567   Perform the Aug
-00010ce0: 6d65 6e74 6564 2044 6963 6b65 792d 4675  mented Dickey-Fu
-00010cf0: 6c6c 6572 2028 4144 4629 2c20 4b77 6961  ller (ADF), Kwia
-00010d00: 746b 6f77 736b 692d 5068 696c 6c69 7073  tkowski-Phillips
-00010d10: 2d53 6368 6d69 6474 2d53 6869 6e20 284b  -Schmidt-Shin (K
-00010d20: 5053 5329 2c20 6f72 205a 6976 6f74 2d41  PSS), or Zivot-A
-00010d30: 6e64 7265 7773 2074 6573 7420 6f6e 2073  ndrews test on s
-00010d40: 6c69 6469 6e67 2077 696e 646f 7773 206f  liding windows o
-00010d50: 6620 7469 6d65 2073 6572 6965 7320 6461  f time series da
-00010d60: 7461 2e0a 2020 2020 2020 2020 5061 7261  ta..        Para
-00010d70: 6c6c 656c 2070 726f 6365 7373 696e 6720  llel processing 
-00010d80: 7573 696e 6720 616c 6c20 6176 6169 6c61  using all availa
-00010d90: 626c 6520 636f 7265 7320 6973 2075 7365  ble cores is use
-00010da0: 6420 746f 2061 6363 656c 6572 6174 6520  d to accelerate 
-00010db0: 636f 6d70 7574 6174 696f 6e2e 0a0a 2020  computation...  
-00010dc0: 2020 2020 2020 2e2e 206e 6f74 653a 3a0a        .. note::.
-00010dd0: 2020 2020 2020 2020 2020 202d 2041 4446             - ADF
-00010de0: 3a20 4120 6869 6768 2070 2d76 616c 7565  : A high p-value
-00010df0: 2073 7567 6765 7374 7320 6e6f 6e2d 7374   suggests non-st
-00010e00: 6174 696f 6e61 7269 7479 2c20 7768 696c  ationarity, whil
-00010e10: 6520 6120 6c6f 7720 702d 7661 6c75 6520  e a low p-value 
-00010e20: 696e 6469 6361 7465 7320 7374 6174 696f  indicates statio
-00010e30: 6e61 7269 7479 2e0a 2020 2020 2020 2020  narity..        
-00010e40: 2020 202d 204b 5053 533a 2041 2068 6967     - KPSS: A hig
-00010e50: 6820 702d 7661 6c75 6520 7375 6767 6573  h p-value sugges
-00010e60: 7473 2073 7461 7469 6f6e 6172 6974 792c  ts stationarity,
-00010e70: 2077 6869 6c65 2061 206c 6f77 2070 2d76   while a low p-v
-00010e80: 616c 7565 2069 6e64 6963 6174 6573 206e  alue indicates n
-00010e90: 6f6e 2d73 7461 7469 6f6e 6172 6974 792e  on-stationarity.
-00010ea0: 0a20 2020 2020 2020 2020 2020 2d20 5a41  .           - ZA
-00010eb0: 3a20 4120 6869 6768 2070 2d76 616c 7565  : A high p-value
-00010ec0: 2073 7567 6765 7374 7320 6e6f 6e2d 7374   suggests non-st
-00010ed0: 6174 696f 6e61 7269 7479 2c20 7768 696c  ationarity, whil
-00010ee0: 6520 6120 6c6f 7720 702d 7661 6c75 6520  e a low p-value 
-00010ef0: 696e 6469 6361 7465 7320 7374 6174 696f  indicates statio
-00010f00: 6e61 7269 7479 2e0a 0a20 2020 2020 2020  narity...       
-00010f10: 203a 7061 7261 6d20 6e70 2e6e 6461 7272   :param np.ndarr
-00010f20: 6179 2064 6174 613a 2031 2d44 204e 756d  ay data: 1-D Num
-00010f30: 5079 2061 7272 6179 2063 6f6e 7461 696e  Py array contain
-00010f40: 696e 6720 7468 6520 7469 6d65 2073 6572  ing the time ser
-00010f50: 6965 7320 6461 7461 2074 6f20 6265 2074  ies data to be t
-00010f60: 6573 7465 642e 0a20 2020 2020 2020 203a  ested..        :
-00010f70: 7061 7261 6d20 6e70 2e6e 6461 7272 6179  param np.ndarray
-00010f80: 2074 696d 655f 7769 6e64 6f77 733a 2041   time_windows: A
-00010f90: 2031 2d44 204e 756d 5079 2061 7272 6179   1-D NumPy array
-00010fa0: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
-00010fb0: 7469 6d65 2077 696e 646f 7720 7369 7a65  time window size
-00010fc0: 7320 696e 2073 6563 6f6e 6473 2e0a 2020  s in seconds..  
-00010fd0: 2020 2020 2020 3a70 6172 616d 206e 702e        :param np.
-00010fe0: 6e64 6172 7261 7920 7361 6d70 6c65 5f72  ndarray sample_r
-00010ff0: 6174 653a 2054 6865 2073 616d 706c 6520  ate: The sample 
-00011000: 7261 7465 206f 6620 7468 6520 7469 6d65  rate of the time
-00011010: 2073 6572 6965 7320 6461 7461 2028 7361   series data (sa
-00011020: 6d70 6c65 7320 7065 7220 7365 636f 6e64  mples per second
-00011030: 292e 0a20 2020 2020 2020 203a 7061 7261  )..        :para
-00011040: 6d20 4c69 7465 7261 6c20 7465 7374 3a20  m Literal test: 
-00011050: 5465 7374 2074 6f20 7065 7266 726f 6d3a  Test to perfrom:
-00011060: 204f 7074 696f 6e73 3a20 2741 4446 2720   Options: 'ADF' 
-00011070: 2841 7567 6d65 6e74 6564 2044 6963 6b65  (Augmented Dicke
-00011080: 792d 4675 6c6c 6572 292c 2027 4b50 5353  y-Fuller), 'KPSS
-00011090: 2720 284b 7769 6174 6b6f 7773 6b69 2d50  ' (Kwiatkowski-P
-000110a0: 6869 6c6c 6970 732d 5363 686d 6964 742d  hillips-Schmidt-
-000110b0: 5368 696e 292c 2027 5a41 2720 285a 6976  Shin), 'ZA' (Ziv
-000110c0: 6f74 2d41 6e64 7265 7773 292e 0a20 2020  ot-Andrews)..   
-000110d0: 2020 2020 203a 7265 7475 726e 2028 6e70       :return (np
-000110e0: 2e6e 6461 7272 6179 2c20 6e70 2e6e 6461  .ndarray, np.nda
-000110f0: 7272 6179 293a 2041 2074 7570 6c65 206f  rray): A tuple o
-00011100: 6620 7477 6f20 322d 4420 4e75 6d50 7920  f two 2-D NumPy 
-00011110: 6172 7261 7973 2063 6f6e 7461 696e 696e  arrays containin
-00011120: 6720 7465 7374 2073 7461 7469 7374 6963  g test statistic
-00011130: 7320 616e 6420 702d 7661 6c75 6573 2e20  s and p-values. 
-00011140: 2d20 5468 6520 6669 7273 7420 6172 7261  - The first arra
-00011150: 7920 2873 7461 7429 2063 6f6e 7461 696e  y (stat) contain
-00011160: 7320 7468 6520 4144 4620 7465 7374 2073  s the ADF test s
-00011170: 7461 7469 7374 6963 732e 202d 2054 6865  tatistics. - The
-00011180: 2073 6563 6f6e 6420 6172 7261 7920 2870   second array (p
-00011190: 5f76 616c 7329 2063 6f6e 7461 696e 7320  _vals) contains 
-000111a0: 7468 6520 636f 7272 6573 706f 6e64 696e  the correspondin
-000111b0: 6720 702d 7661 6c75 6573 0a0a 2020 2020  g p-values..    
-000111c0: 2020 2020 3a65 7861 6d70 6c65 3a0a 2020      :example:.  
-000111d0: 2020 2020 2020 3e3e 3e20 6461 7461 203d        >>> data =
-000111e0: 206e 702e 6172 7261 7928 5b31 2c20 322c   np.array([1, 2,
-000111f0: 2033 2c20 342c 2035 2c20 362c 2037 2c20   3, 4, 5, 6, 7, 
-00011200: 382c 2039 2c20 3130 5d29 0a20 2020 2020  8, 9, 10]).     
-00011210: 2020 203e 3e3e 2054 696d 6573 6572 6965     >>> Timeserie
-00011220: 7346 6561 7475 7265 4d69 7869 6e28 292e  sFeatureMixin().
-00011230: 736c 6964 696e 675f 7374 6174 696f 6e61  sliding_stationa
-00011240: 7279 2864 6174 613d 6461 7461 2c20 7469  ry(data=data, ti
-00011250: 6d65 5f77 696e 646f 7773 3d6e 702e 6172  me_windows=np.ar
-00011260: 7261 7928 5b32 2e30 5d29 2c20 7465 7374  ray([2.0]), test
-00011270: 3d27 4b50 5353 272c 2073 616d 706c 655f  ='KPSS', sample_
-00011280: 7261 7465 3d32 290a 2020 2020 2020 2020  rate=2).        
-00011290: 2222 220a 0a20 2020 2020 2020 2073 7461  """..        sta
-000112a0: 7420 3d20 6e70 2e66 756c 6c28 2864 6174  t = np.full((dat
-000112b0: 612e 7368 6170 655b 305d 2c20 7469 6d65  a.shape[0], time
-000112c0: 5f77 696e 646f 7773 2e73 6861 7065 5b30  _windows.shape[0
-000112d0: 5d29 2c20 2d31 2e30 290a 2020 2020 2020  ]), -1.0).      
-000112e0: 2020 705f 7661 6c73 203d 206e 702e 6675    p_vals = np.fu
-000112f0: 6c6c 2828 6461 7461 2e73 6861 7065 5b30  ll((data.shape[0
-00011300: 5d2c 2074 696d 655f 7769 6e64 6f77 732e  ], time_windows.
-00011310: 7368 6170 655b 305d 292c 202d 312e 3029  shape[0]), -1.0)
-00011320: 0a20 2020 2020 2020 2069 6620 7465 7374  .        if test
-00011330: 203d 3d20 2241 4446 223a 0a20 2020 2020   == "ADF":.     
-00011340: 2020 2020 2020 2074 6573 745f 6675 6e63         test_func
-00011350: 203d 2054 696d 6573 6572 6965 7346 6561   = TimeseriesFea
-00011360: 7475 7265 4d69 7869 6e28 292e 5f61 6466  tureMixin()._adf
-00011370: 5f65 7865 6375 746f 720a 2020 2020 2020  _executor.      
-00011380: 2020 656c 6966 2074 6573 7420 3d3d 2022    elif test == "
-00011390: 4b50 5353 223a 0a20 2020 2020 2020 2020  KPSS":.         
-000113a0: 2020 2074 6573 745f 6675 6e63 203d 2054     test_func = T
-000113b0: 696d 6573 6572 6965 7346 6561 7475 7265  imeseriesFeature
-000113c0: 4d69 7869 6e28 292e 5f6b 7073 735f 6578  Mixin()._kpss_ex
-000113d0: 6563 7574 6f72 0a20 2020 2020 2020 2065  ecutor.        e
-000113e0: 6c69 6620 7465 7374 203d 3d20 225a 4122  lif test == "ZA"
-000113f0: 3a0a 2020 2020 2020 2020 2020 2020 7465  :.            te
-00011400: 7374 5f66 756e 6320 3d20 5469 6d65 7365  st_func = Timese
-00011410: 7269 6573 4665 6174 7572 654d 6978 696e  riesFeatureMixin
-00011420: 2829 2e5f 7a69 766f 7461 6e64 7265 7773  ()._zivotandrews
-00011430: 5f65 7865 6375 746f 720a 2020 2020 2020  _executor.      
-00011440: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00011450: 2020 2020 7479 7065 5f68 696e 7473 203d      type_hints =
-00011460: 2067 6574 5f74 7970 655f 6869 6e74 7328   get_type_hints(
-00011470: 5469 6d65 7365 7269 6573 4665 6174 7572  TimeseriesFeatur
-00011480: 654d 6978 696e 2829 2e73 6c69 6469 6e67  eMixin().sliding
-00011490: 5f73 7461 7469 6f6e 6172 7929 0a20 2020  _stationary).   
-000114a0: 2020 2020 2020 2020 2072 6169 7365 2049           raise I
-000114b0: 6e76 616c 6964 496e 7075 7445 7272 6f72  nvalidInputError
-000114c0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000114d0: 2020 6d73 673d 6627 5465 7374 207b 7465    msg=f'Test {te
-000114e0: 7374 7d20 6e6f 7420 7265 636f 676e 697a  st} not recogniz
-000114f0: 6564 2e20 4f70 7469 6f6e 733a 207b 7479  ed. Options: {ty
-00011500: 7065 5f68 696e 7473 5b22 7465 7374 225d  pe_hints["test"]
-00011510: 7d27 0a20 2020 2020 2020 2020 2020 2029  }'.            )
-00011520: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
-00011530: 6e20 7261 6e67 6528 7469 6d65 5f77 696e  n range(time_win
-00011540: 646f 7773 2e73 6861 7065 5b30 5d29 3a0a  dows.shape[0]):.
-00011550: 2020 2020 2020 2020 2020 2020 7769 6e64              wind
-00011560: 6f77 5f73 697a 6520 3d20 696e 7428 7469  ow_size = int(ti
-00011570: 6d65 5f77 696e 646f 7773 5b69 5d20 2a20  me_windows[i] * 
-00011580: 7361 6d70 6c65 5f72 6174 6529 0a20 2020  sample_rate).   
-00011590: 2020 2020 2020 2020 2073 7472 6964 6564           strided
-000115a0: 5f64 6174 6120 3d20 6173 5f73 7472 6964  _data = as_strid
-000115b0: 6564 280a 2020 2020 2020 2020 2020 2020  ed(.            
-000115c0: 2020 2020 6461 7461 2c0a 2020 2020 2020      data,.      
-000115d0: 2020 2020 2020 2020 2020 7368 6170 653d            shape=
-000115e0: 2864 6174 612e 7368 6170 655b 305d 202d  (data.shape[0] -
-000115f0: 2077 696e 646f 775f 7369 7a65 202b 2031   window_size + 1
-00011600: 2c20 7769 6e64 6f77 5f73 697a 6529 2c0a  , window_size),.
-00011610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011620: 7374 7269 6465 733d 2864 6174 612e 7374  strides=(data.st
-00011630: 7269 6465 735b 305d 202a 2031 2c20 6461  rides[0] * 1, da
-00011640: 7461 2e73 7472 6964 6573 5b30 5d29 2c0a  ta.strides[0]),.
-00011650: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00011660: 2020 2020 2020 2020 2020 7769 7468 206d            with m
-00011670: 756c 7469 7072 6f63 6573 7369 6e67 2e50  ultiprocessing.P
-00011680: 6f6f 6c28 6669 6e64 5f63 6f72 655f 636e  ool(find_core_cn
-00011690: 7428 295b 305d 2c20 6d61 7874 6173 6b73  t()[0], maxtasks
-000116a0: 7065 7263 6869 6c64 3d31 3029 2061 7320  perchild=10) as 
-000116b0: 706f 6f6c 3a0a 2020 2020 2020 2020 2020  pool:.          
-000116c0: 2020 2020 2020 666f 7220 636e 742c 2072        for cnt, r
-000116d0: 6573 756c 7420 696e 2065 6e75 6d65 7261  esult in enumera
-000116e0: 7465 280a 2020 2020 2020 2020 2020 2020  te(.            
-000116f0: 2020 2020 2020 2020 706f 6f6c 2e69 6d61          pool.ima
-00011700: 7028 7465 7374 5f66 756e 632c 2073 7472  p(test_func, str
-00011710: 6964 6564 5f64 6174 612c 2063 6875 6e6b  ided_data, chunk
-00011720: 7369 7a65 3d31 290a 2020 2020 2020 2020  size=1).        
-00011730: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
-00011740: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00011750: 7461 745b 636e 7420 2b20 7769 6e64 6f77  tat[cnt + window
-00011760: 5f73 697a 6520 2d20 312c 2069 5d20 3d20  _size - 1, i] = 
-00011770: 7265 7375 6c74 5b30 5d0a 2020 2020 2020  result[0].      
-00011780: 2020 2020 2020 2020 2020 2020 2020 705f                p_
-00011790: 7661 6c73 5b63 6e74 202b 2077 696e 646f  vals[cnt + windo
-000117a0: 775f 7369 7a65 202d 2031 2c20 695d 203d  w_size - 1, i] =
-000117b0: 2072 6573 756c 745b 315d 0a0a 2020 2020   result[1]..    
-000117c0: 2020 2020 7265 7475 726e 2073 7461 742c      return stat,
-000117d0: 2070 5f76 616c 730a 0a20 2020 2040 7374   p_vals..    @st
-000117e0: 6174 6963 6d65 7468 6f64 0a20 2020 2040  aticmethod.    @
-000117f0: 6e6a 6974 280a 2020 2020 2020 2020 5b0a  njit(.        [.
-00011800: 2020 2020 2020 2020 2020 2020 2228 666c              "(fl
-00011810: 6f61 7433 325b 3a5d 2c20 666c 6f61 7436  oat32[:], float6
-00011820: 342c 2069 6e74 3634 2c20 666c 6f61 7436  4, int64, float6
-00011830: 342c 2074 7970 6573 2e75 6e69 636f 6465  4, types.unicode
-00011840: 5f74 7970 6529 222c 0a20 2020 2020 2020  _type)",.       
-00011850: 2020 2020 2027 2866 6c6f 6174 3332 5b3a       '(float32[:
-00011860: 5d2c 2066 6c6f 6174 3634 2c20 696e 7436  ], float64, int6
-00011870: 342c 2066 6c6f 6174 3634 2c20 7479 7065  4, float64, type
-00011880: 732e 6d69 7363 2e4f 6d69 7474 6564 2822  s.misc.Omitted("
-00011890: 6d6d 2229 2927 2c0a 2020 2020 2020 2020  mm"))',.        
-000118a0: 2020 2020 2228 666c 6f61 7433 325b 3a5d      "(float32[:]
-000118b0: 2c20 666c 6f61 7436 342c 2069 6e74 3634  , float64, int64
-000118c0: 2c20 7479 7065 732e 6d69 7363 2e4f 6d69  , types.misc.Omi
-000118d0: 7474 6564 2831 292c 2074 7970 6573 2e75  tted(1), types.u
-000118e0: 6e69 636f 6465 5f74 7970 6529 222c 0a20  nicode_type)",. 
-000118f0: 2020 2020 2020 2020 2020 2027 2866 6c6f             '(flo
-00011900: 6174 3332 5b3a 5d2c 2066 6c6f 6174 3634  at32[:], float64
-00011910: 2c20 696e 7436 342c 2074 7970 6573 2e6d  , int64, types.m
-00011920: 6973 632e 4f6d 6974 7465 6428 3129 2c20  isc.Omitted(1), 
-00011930: 7479 7065 732e 6d69 7363 2e4f 6d69 7474  types.misc.Omitt
-00011940: 6564 2822 6d6d 2229 2927 2c0a 2020 2020  ed("mm"))',.    
-00011950: 2020 2020 5d0a 2020 2020 290a 2020 2020      ].    ).    
-00011960: 6465 6620 6163 6365 6c65 7261 7469 6f6e  def acceleration
-00011970: 280a 2020 2020 2020 2020 6461 7461 3a20  (.        data: 
-00011980: 6e70 2e6e 6461 7272 6179 2c0a 2020 2020  np.ndarray,.    
-00011990: 2020 2020 7069 7865 6c73 5f70 6572 5f6d      pixels_per_m
-000119a0: 6d3a 2066 6c6f 6174 2c0a 2020 2020 2020  m: float,.      
-000119b0: 2020 6670 733a 2069 6e74 2c0a 2020 2020    fps: int,.    
-000119c0: 2020 2020 7469 6d65 5f77 696e 646f 773a      time_window:
-000119d0: 2066 6c6f 6174 203d 2031 2c0a 2020 2020   float = 1,.    
-000119e0: 2020 2020 756e 6974 3a20 4c69 7465 7261      unit: Litera
-000119f0: 6c5b 226d 6d22 2c20 2263 6d22 2c20 2264  l["mm", "cm", "d
-00011a00: 6d22 2c20 226d 225d 203d 2022 6d6d 222c  m", "m"] = "mm",
-00011a10: 0a20 2020 2029 202d 3e20 6e70 2e6e 6461  .    ) -> np.nda
-00011a20: 7272 6179 3a0a 2020 2020 2020 2020 2222  rray:.        ""
-00011a30: 220a 2020 2020 2020 2020 436f 6d70 7574  ".        Comput
-00011a40: 6520 6163 6365 6c65 7261 7469 6f6e 2e0a  e acceleration..
-00011a50: 0a20 2020 2020 2020 2043 6f6d 7075 7465  .        Compute
-00011a60: 7320 6163 6365 6c65 7261 7469 6f6e 2066  s acceleration f
-00011a70: 726f 6d20 6120 7365 7175 656e 6365 206f  rom a sequence o
-00011a80: 6620 626f 6479 2d70 6172 7420 636f 6f72  f body-part coor
-00011a90: 6469 6e61 7465 7320 6f76 6572 2074 696d  dinates over tim
-00011aa0: 652e 2049 7420 6361 6c63 756c 6174 6573  e. It calculates
-00011ab0: 2074 6865 2064 6966 6665 7265 6e63 6520   the difference 
-00011ac0: 696e 2076 656c 6f63 6974 7920 6265 7477  in velocity betw
-00011ad0: 6565 6e20 636f 6e73 6563 7574 6976 6520  een consecutive 
-00011ae0: 6672 616d 6573 2061 6e64 2070 726f 7669  frames and provi
-00011af0: 6465 7320 616e 2061 7272 6179 206f 6620  des an array of 
-00011b00: 6163 6365 6c65 7261 7469 6f6e 732e 0a0a  accelerations...
-00011b10: 2020 2020 2020 2020 5468 6520 636f 6d70          The comp
-00011b20: 7574 6174 696f 6e20 6973 2062 6173 6564  utation is based
-00011b30: 206f 6e20 7468 6520 666f 726d 756c 613a   on the formula:
-00011b40: 0a0a 2020 2020 2020 2020 2e2e 206d 6174  ..        .. mat
-00011b50: 683a 3a0a 0a20 2020 2020 2020 2020 2020  h::..           
-00011b60: 5c5c 7465 7874 7b7b 4163 6365 6c65 7261  \\text{{Accelera
-00011b70: 7469 6f6e 7d7d 2874 2920 3d20 5c5c 6672  tion}}(t) = \\fr
-00011b80: 6163 7b7b 5c5c 7465 7874 7b7b 4e6f 726d  ac{{\\text{{Norm
-00011b90: 7d7d 285c 5c74 6578 747b 7b53 6869 6674  }}(\\text{{Shift
-00011ba0: 7d7d 285c 5c74 6578 747b 7b64 6174 617d  }}(\\text{{data}
-00011bb0: 7d5b 745d 2c20 742c 2074 2d31 2920 2d20  }[t], t, t-1) - 
-00011bc0: 5c5c 7465 7874 7b7b 6461 7461 7d7d 5b74  \\text{{data}}[t
-00011bd0: 5d29 7d7d 7b7b 5c5c 7465 7874 7b7b 7069  ])}}{{\\text{{pi
-00011be0: 7865 6c73 5c5c 5f70 6572 5c5c 5f6d 6d7d  xels\\_per\\_mm}
-00011bf0: 7d7d 7d0a 0a20 2020 2020 2020 2077 6865  }}}..        whe
-00011c00: 7265 203a 6d61 7468 3a60 5c5c 7465 7874  re :math:`\\text
-00011c10: 7b7b 4e6f 726d 7d7d 6020 6361 6c63 756c  {{Norm}}` calcul
-00011c20: 6174 6573 2074 6865 2045 7563 6c69 6465  ates the Euclide
-00011c30: 616e 206e 6f72 6d2c 203a 6d61 7468 3a60  an norm, :math:`
-00011c40: 5c5c 7465 7874 7b7b 5368 6966 747d 7d28  \\text{{Shift}}(
-00011c50: 5c5c 7465 7874 7b7b 6172 7261 797d 7d2c  \\text{{array}},
-00011c60: 2074 2c20 742d 3129 6020 7368 6966 7473   t, t-1)` shifts
-00011c70: 2074 6865 2061 7272 6179 2062 7920 3a6d   the array by :m
-00011c80: 6174 683a 6074 2d31 6020 6672 616d 6573  ath:`t-1` frames
-00011c90: 2c20 616e 6420 3a6d 6174 683a 605c 5c74  , and :math:`\\t
-00011ca0: 6578 747b 7b70 6978 656c 735c 5c5f 7065  ext{{pixels\\_pe
-00011cb0: 725c 5c5f 6d6d 7d7d 6020 6973 2074 6865  r\\_mm}}` is the
-00011cc0: 2063 6f6e 7665 7273 696f 6e20 6661 6374   conversion fact
-00011cd0: 6f72 2066 726f 6d20 7069 7865 6c73 2074  or from pixels t
-00011ce0: 6f20 6d69 6c6c 696d 6574 6572 732e 0a0a  o millimeters...
-00011cf0: 2020 2020 2020 2020 2e2e 206e 6f74 653a          .. note:
-00011d00: 3a0a 2020 2020 2020 2020 2020 2042 7920  :.           By 
-00011d10: 6465 6661 756c 742c 2061 6363 656c 6572  default, acceler
-00011d20: 6174 696f 6e20 6973 2063 616c 6375 6c61  ation is calcula
-00011d30: 7465 6420 6173 2063 6861 6e67 6520 696e  ted as change in
-00011d40: 2076 656c 6f63 6974 7920 6174 206d 696c   velocity at mil
-00011d50: 6c69 6d65 7465 7273 2f73 2e20 546f 2063  limeters/s. To c
-00011d60: 6861 6e67 6520 7468 6520 6465 6e6f 6d69  hange the denomi
-00011d70: 7461 746f 722c 206d 6f64 6966 7920 7468  tator, modify th
-00011d80: 6520 6060 7469 6d65 5f77 696e 646f 7760  e ``time_window`
-00011d90: 6020 6172 6775 6d65 6e74 2e20 546f 2063  ` argument. To c
-00011da0: 6861 6e67 6520 7468 6520 6e6f 6d69 6e61  hange the nomina
-00011db0: 746f 722c 206d 6f64 6966 7920 7468 6520  tor, modify the 
-00011dc0: 6060 756e 6974 6060 2061 7267 756d 656e  ``unit`` argumen
-00011dd0: 7420 2861 6363 6570 7465 6420 6060 6d6d  t (accepted ``mm
-00011de0: 6060 2c20 636d 6060 2c20 6060 646d 6060  ``, cm``, ``dm``
-00011df0: 2c20 6060 6d6d 6060 290a 0a20 2020 2020  , ``mm``)..     
-00011e00: 2020 202e 2e20 696d 6167 653a 3a20 5f73     .. image:: _s
-00011e10: 7461 7469 632f 696d 672f 6163 6365 6c65  tatic/img/accele
-00011e20: 7261 7469 6f6e 2e70 6e67 0a20 2020 2020  ration.png.     
-00011e30: 2020 2020 2020 3a77 6964 7468 3a20 3730        :width: 70
-00011e40: 300a 2020 2020 2020 2020 2020 203a 616c  0.           :al
-00011e50: 6967 6e3a 2063 656e 7465 720a 0a20 2020  ign: center..   
-00011e60: 2020 2020 203a 7061 7261 6d20 6e70 2e6e       :param np.n
-00011e70: 6461 7272 6179 2064 6174 613a 2031 4420  darray data: 1D 
-00011e80: 6172 7261 7920 6f66 2066 7261 6d65 7769  array of framewi
-00011e90: 7365 2065 7563 6c69 6465 616e 2064 6973  se euclidean dis
-00011ea0: 7461 6e63 6573 2e0a 2020 2020 2020 2020  tances..        
-00011eb0: 3a70 6172 616d 2066 6c6f 6174 2070 6978  :param float pix
-00011ec0: 656c 735f 7065 725f 6d6d 3a20 5069 7865  els_per_mm: Pixe
-00011ed0: 6c73 2070 6572 206d 696c 6c69 6d65 7465  ls per millimete
-00011ee0: 7220 6f66 2074 6865 2072 6563 6f72 6465  r of the recorde
-00011ef0: 6420 7669 6465 6f2e 0a20 2020 2020 2020  d video..       
-00011f00: 203a 7061 7261 6d20 696e 7420 6670 733a   :param int fps:
-00011f10: 2046 7261 6d65 7320 7065 7220 7365 636f   Frames per seco
-00011f20: 6e64 2028 4650 5329 206f 6620 7468 6520  nd (FPS) of the 
-00011f30: 7265 636f 7264 6564 2076 6964 656f 2e0a  recorded video..
-00011f40: 2020 2020 2020 2020 3a70 6172 616d 2066          :param f
-00011f50: 6c6f 6174 2074 696d 655f 7769 6e64 6f77  loat time_window
-00011f60: 3a20 526f 6c6c 696e 6720 7469 6d65 2077  : Rolling time w
-00011f70: 696e 646f 7720 696e 2073 6563 6f6e 6473  indow in seconds
-00011f80: 2e20 4465 6661 756c 7420 6973 2031 2e30  . Default is 1.0
-00011f90: 2072 6570 7265 7365 6e74 696e 6720 3120   representing 1 
-00011fa0: 7365 636f 6e64 2e0a 2020 2020 2020 2020  second..        
-00011fb0: 3a70 6172 616d 204c 6974 6572 616c 5b27  :param Literal['
-00011fc0: 6d6d 272c 2027 636d 272c 2027 646d 272c  mm', 'cm', 'dm',
-00011fd0: 2027 6d27 5d20 756e 6974 3a20 2049 6620   'm'] unit:  If 
-00011fe0: 6163 6365 6c65 7261 7469 6f6e 2073 686f  acceleration sho
-00011ff0: 756c 6420 6265 2070 7265 7365 6e74 6564  uld be presented
-00012000: 2061 7320 6d69 6c6c 696d 6574 6572 2c20   as millimeter, 
-00012010: 6365 6e74 696d 6574 6572 732c 2064 6563  centimeters, dec
-00012020: 696d 6574 6572 2c20 6f72 206d 6574 6572  imeter, or meter
-00012030: 2e20 4465 6661 756c 7420 6d69 6c6c 696d  . Default millim
-00012040: 6574 6572 732e 0a20 2020 2020 2020 203a  eters..        :
-00012050: 7265 7475 726e 3a20 4172 7261 7920 6f66  return: Array of
-00012060: 2061 6363 656c 6572 6174 696f 6e73 2063   accelerations c
-00012070: 6f72 7265 7370 6f6e 6469 6e67 2074 6f20  orresponding to 
-00012080: 6561 6368 2066 7261 6d65 2e0a 0a20 2020  each frame...   
-00012090: 2020 2020 203a 6578 616d 706c 653a 0a20       :example:. 
-000120a0: 2020 2020 2020 203e 3e3e 2064 6174 6120         >>> data 
-000120b0: 3d20 6e70 2e61 7272 6179 285b 312c 2032  = np.array([1, 2
-000120c0: 2c20 332c 2034 2c20 352c 2035 2c20 352c  , 3, 4, 5, 5, 5,
-000120d0: 2035 2c20 352c 2036 5d29 2e61 7374 7970   5, 5, 6]).astyp
-000120e0: 6528 6e70 2e66 6c6f 6174 3332 290a 2020  e(np.float32).  
-000120f0: 2020 2020 2020 3e3e 3e20 5469 6d65 7365        >>> Timese
-00012100: 7269 6573 4665 6174 7572 654d 6978 696e  riesFeatureMixin
-00012110: 2829 2e61 6363 656c 6572 6174 696f 6e28  ().acceleration(
-00012120: 6461 7461 3d64 6174 612c 2070 6978 656c  data=data, pixel
-00012130: 735f 7065 725f 6d6d 3d31 2e30 2c20 6670  s_per_mm=1.0, fp
-00012140: 733d 322c 2074 696d 655f 7769 6e64 6f77  s=2, time_window
-00012150: 3d31 2e30 290a 2020 2020 2020 2020 3e3e  =1.0).        >>
-00012160: 3e20 5b20 302e 2c20 2030 2e2c 2020 302e  > [ 0.,  0.,  0.
-00012170: 2c20 2030 2e2c 202d 312e 2c20 2d31 2e2c  ,  0., -1., -1.,
-00012180: 2020 302e 2c20 2030 2e2c 2020 312e 2c20    0.,  0.,  1., 
-00012190: 2031 2e5d 0a20 2020 2020 2020 2022 2222   1.].        """
-000121a0: 0a0a 2020 2020 2020 2020 7265 7375 6c74  ..        result
-000121b0: 732c 2076 656c 6f63 6974 7920 3d20 6e70  s, velocity = np
-000121c0: 2e66 756c 6c28 2864 6174 612e 7368 6170  .full((data.shap
-000121d0: 655b 305d 292c 2030 2e30 292c 206e 702e  e[0]), 0.0), np.
-000121e0: 6675 6c6c 2828 6461 7461 2e73 6861 7065  full((data.shape
-000121f0: 5b30 5d29 2c20 302e 3029 0a20 2020 2020  [0]), 0.0).     
-00012200: 2020 2073 697a 652c 2070 7620 3d20 696e     size, pv = in
-00012210: 7428 7469 6d65 5f77 696e 646f 7720 2a20  t(time_window * 
-00012220: 6670 7329 2c20 4e6f 6e65 0a20 2020 2020  fps), None.     
-00012230: 2020 2064 6174 615f 7370 6c69 7420 3d20     data_split = 
-00012240: 6e70 2e73 706c 6974 2864 6174 612c 206c  np.split(data, l
-00012250: 6973 7428 7261 6e67 6528 7369 7a65 2c20  ist(range(size, 
-00012260: 6461 7461 2e73 6861 7065 5b30 5d2c 2073  data.shape[0], s
-00012270: 697a 6529 2929 0a20 2020 2020 2020 2066  ize))).        f
-00012280: 6f72 2069 2069 6e20 7261 6e67 6528 6c65  or i in range(le
-00012290: 6e28 6461 7461 5f73 706c 6974 2929 3a0a  n(data_split)):.
-000122a0: 2020 2020 2020 2020 2020 2020 7753 203d              wS =
-000122b0: 2069 6e74 2873 697a 6520 2a20 6929 0a20   int(size * i). 
-000122c0: 2020 2020 2020 2020 2020 2077 4520 3d20             wE = 
-000122d0: 696e 7428 7753 202b 2073 697a 6529 0a20  int(wS + size). 
-000122e0: 2020 2020 2020 2020 2020 2076 203d 206e             v = n
-000122f0: 702e 6469 6666 286e 702e 6173 636f 6e74  p.diff(np.ascont
-00012300: 6967 756f 7573 6172 7261 7928 6461 7461  iguousarray(data
-00012310: 5f73 706c 6974 5b69 5d29 295b 305d 202f  _split[i]))[0] /
-00012320: 2070 6978 656c 735f 7065 725f 6d6d 0a20   pixels_per_mm. 
-00012330: 2020 2020 2020 2020 2020 2069 6620 756e             if un
-00012340: 6974 203d 3d20 2263 6d22 3a0a 2020 2020  it == "cm":.    
-00012350: 2020 2020 2020 2020 2020 2020 7620 3d20              v = 
-00012360: 7620 2f20 3130 0a20 2020 2020 2020 2020  v / 10.         
-00012370: 2020 2065 6c69 6620 756e 6974 203d 3d20     elif unit == 
-00012380: 2264 6d22 3a0a 2020 2020 2020 2020 2020  "dm":.          
-00012390: 2020 2020 2020 7620 3d20 7620 2f20 3130        v = v / 10
-000123a0: 300a 2020 2020 2020 2020 2020 2020 656c  0.            el
-000123b0: 6966 2075 6e69 7420 3d3d 2022 6d22 3a0a  if unit == "m":.
-000123c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000123d0: 7620 3d20 7620 2f20 3130 3030 0a20 2020  v = v / 1000.   
-000123e0: 2020 2020 2020 2020 2069 6620 6920 3d3d           if i ==
-000123f0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-00012400: 2020 2020 7265 7375 6c74 735b 7753 3a77      results[wS:w
-00012410: 455d 203d 2030 0a20 2020 2020 2020 2020  E] = 0.         
-00012420: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00012430: 2020 2020 2020 2020 2072 6573 756c 7473           results
-00012440: 5b77 533a 7745 5d20 3d20 7620 2d20 7076  [wS:wE] = v - pv
-00012450: 0a20 2020 2020 2020 2020 2020 2070 7620  .            pv 
-00012460: 3d20 760a 2020 2020 2020 2020 7265 7475  = v.        retu
-00012470: 726e 2072 6573 756c 7473 0a0a 2020 2020  rn results..    
-00012480: 4073 7461 7469 636d 6574 686f 640a 2020  @staticmethod.  
-00012490: 2020 6465 6620 6772 616e 6765 725f 7465    def granger_te
-000124a0: 7374 7328 0a20 2020 2020 2020 2064 6174  sts(.        dat
-000124b0: 613a 2070 642e 4461 7461 4672 616d 652c  a: pd.DataFrame,
-000124c0: 0a20 2020 2020 2020 2076 6172 6961 626c  .        variabl
-000124d0: 6573 3a20 7479 7069 6e67 2e4c 6973 745b  es: typing.List[
-000124e0: 7374 725d 2c0a 2020 2020 2020 2020 6c61  str],.        la
-000124f0: 673a 2069 6e74 2c0a 2020 2020 2020 2020  g: int,.        
-00012500: 7465 7374 3a20 4c69 7465 7261 6c5b 0a20  test: Literal[. 
-00012510: 2020 2020 2020 2020 2020 2022 7373 725f             "ssr_
-00012520: 6674 6573 7422 2c20 2273 7372 5f63 6869  ftest", "ssr_chi
-00012530: 3274 6573 7422 2c20 226c 7274 6573 7422  2test", "lrtest"
-00012540: 2c20 2270 6172 616d 735f 6674 6573 7422  , "params_ftest"
-00012550: 0a20 2020 2020 2020 205d 203d 2022 7373  .        ] = "ss
-00012560: 725f 6368 6932 7465 7374 222c 0a20 2020  r_chi2test",.   
-00012570: 2029 202d 3e20 7064 2e44 6174 6146 7261   ) -> pd.DataFra
-00012580: 6d65 3a0a 2020 2020 2020 2020 2222 220a  me:.        """.
-00012590: 2020 2020 2020 2020 5065 7266 6f72 6d20          Perform 
-000125a0: 4772 616e 6765 7220 6361 7573 616c 6974  Granger causalit
-000125b0: 7920 7465 7374 7320 6265 7477 6565 6e20  y tests between 
-000125c0: 7061 6972 7320 6f66 2076 6172 6961 626c  pairs of variabl
-000125d0: 6573 2069 6e20 6120 4461 7461 4672 616d  es in a DataFram
-000125e0: 652e 0a0a 2020 2020 2020 2020 5468 6973  e...        This
-000125f0: 2066 756e 6374 696f 6e20 636f 6d70 7574   function comput
-00012600: 6573 2047 7261 6e67 6572 2063 6175 7361  es Granger causa
-00012610: 6c69 7479 2074 6573 7473 2062 6574 7765  lity tests betwe
-00012620: 656e 2070 6169 7273 206f 6620 7661 7269  en pairs of vari
-00012630: 6162 6c65 7320 696e 2061 2044 6174 6146  ables in a DataF
-00012640: 7261 6d65 0a20 2020 2020 2020 2075 7369  rame.        usi
-00012650: 6e67 2074 6865 2073 7461 7473 6d6f 6465  ng the statsmode
-00012660: 6c73 206c 6962 7261 7279 2e20 5468 6520  ls library. The 
-00012670: 4772 616e 6765 7220 6361 7573 616c 6974  Granger causalit
-00012680: 7920 7465 7374 2061 7373 6573 7365 7320  y test assesses 
-00012690: 7768 6574 6865 7220 6f6e 6520 7469 6d65  whether one time
-000126a0: 2073 6572 6965 730a 2020 2020 2020 2020   series.        
-000126b0: 7661 7269 6162 6c65 2028 7072 6564 6963  variable (predic
-000126c0: 746f 7229 2063 616e 2070 7265 6469 6374  tor) can predict
-000126d0: 2061 6e6f 7468 6572 2074 696d 6520 7365   another time se
-000126e0: 7269 6573 2076 6172 6961 626c 6520 286f  ries variable (o
-000126f0: 7574 636f 6d65 292e 2054 6869 7320 7465  utcome). This te
-00012700: 7374 2063 616e 2068 656c 700a 2020 2020  st can help.    
-00012710: 2020 2020 6465 7465 726d 696e 6520 7468      determine th
-00012720: 6520 7072 6573 656e 6365 206f 6620 6361  e presence of ca
-00012730: 7573 616c 2072 656c 6174 696f 6e73 6869  usal relationshi
-00012740: 7073 2062 6574 7765 656e 2076 6172 6961  ps between varia
-00012750: 626c 6573 2e0a 0a20 2020 2020 2020 202e  bles...        .
-00012760: 2e20 6e6f 7465 3a3a 0a20 2020 2020 2020  . note::.       
-00012770: 2020 2020 4d6f 6469 6669 6564 2066 726f      Modified fro
-00012780: 6d20 6053 656c 7661 2050 7261 6268 616b  m `Selva Prabhak
-00012790: 6172 616e 203c 6874 7470 733a 2f2f 7777  aran <https://ww
-000127a0: 772e 6d61 6368 696e 656c 6561 726e 696e  w.machinelearnin
-000127b0: 6770 6c75 732e 636f 6d2f 7469 6d65 2d73  gplus.com/time-s
-000127c0: 6572 6965 732f 6772 616e 6765 722d 6361  eries/granger-ca
-000127d0: 7573 616c 6974 792d 7465 7374 2d69 6e2d  usality-test-in-
-000127e0: 7079 7468 6f6e 2f3e 605f 2e0a 0a20 2020  python/>`_...   
-000127f0: 2020 2020 203a 6578 616d 706c 653a 0a20       :example:. 
-00012800: 2020 2020 2020 203e 3e3e 2078 203d 206e         >>> x = n
-00012810: 702e 7261 6e64 6f6d 2e72 616e 6469 6e74  p.random.randint
-00012820: 2830 2c20 3530 2c20 2831 3030 2c20 3229  (0, 50, (100, 2)
-00012830: 290a 2020 2020 2020 2020 3e3e 3e20 6461  ).        >>> da
-00012840: 7461 203d 2070 642e 4461 7461 4672 616d  ta = pd.DataFram
-00012850: 6528 782c 2063 6f6c 756d 6e73 3d5b 2772  e(x, columns=['r
-00012860: 272c 2027 6b27 5d29 0a20 2020 2020 2020  ', 'k']).       
-00012870: 203e 3e3e 2054 696d 6573 6572 6965 7346   >>> TimeseriesF
-00012880: 6561 7475 7265 4d69 7869 6e2e 6772 616e  eatureMixin.gran
-00012890: 6765 725f 7465 7374 7328 6461 7461 3d64  ger_tests(data=d
-000128a0: 6174 612c 2076 6172 6961 626c 6573 3d5b  ata, variables=[
-000128b0: 2772 272c 2027 6b27 5d2c 206c 6167 3d34  'r', 'k'], lag=4
-000128c0: 2c20 7465 7374 3d27 7373 725f 6368 6932  , test='ssr_chi2
-000128d0: 7465 7374 2729 0a20 2020 2020 2020 203e  test').        >
-000128e0: 3e3e 2020 2020 2072 2020 2020 2020 2020  >>     r        
-000128f0: 2020 206b 0a20 2020 2020 2020 203e 3e3e     k.        >>>
-00012900: 2020 2020 2072 2020 312e 3030 3030 2020       r  1.0000  
-00012910: 302e 3433 3132 0a20 2020 2020 2020 203e  0.4312.        >
-00012920: 3e3e 2020 2020 206b 2020 302e 3331 3032  >>     k  0.3102
-00012930: 2020 312e 3030 3030 0a20 2020 2020 2020    1.0000.       
-00012940: 2022 2222 0a20 2020 2020 2020 2063 6865   """.        che
-00012950: 636b 5f69 6e73 7461 6e63 6528 0a20 2020  ck_instance(.   
-00012960: 2020 2020 2020 2020 2073 6f75 7263 653d           source=
-00012970: 5469 6d65 7365 7269 6573 4665 6174 7572  TimeseriesFeatur
-00012980: 654d 6978 696e 2e67 7261 6e67 6572 5f74  eMixin.granger_t
-00012990: 6573 7473 2e5f 5f6e 616d 655f 5f2c 0a20  ests.__name__,. 
-000129a0: 2020 2020 2020 2020 2020 2069 6e73 7461             insta
-000129b0: 6e63 653d 6461 7461 2c0a 2020 2020 2020  nce=data,.      
-000129c0: 2020 2020 2020 6163 6365 7074 6564 5f74        accepted_t
-000129d0: 7970 6573 3d28 7064 2e44 6174 6146 7261  ypes=(pd.DataFra
-000129e0: 6d65 2c29 2c0a 2020 2020 2020 2020 290a  me,),.        ).
-000129f0: 2020 2020 2020 2020 6368 6563 6b5f 7661          check_va
-00012a00: 6c69 645f 6c73 7428 0a20 2020 2020 2020  lid_lst(.       
-00012a10: 2020 2020 2064 6174 613d 7661 7269 6162       data=variab
-00012a20: 6c65 732c 0a20 2020 2020 2020 2020 2020  les,.           
-00012a30: 2073 6f75 7263 653d 5469 6d65 7365 7269   source=Timeseri
-00012a40: 6573 4665 6174 7572 654d 6978 696e 2e67  esFeatureMixin.g
-00012a50: 7261 6e67 6572 5f74 6573 7473 2e5f 5f6e  ranger_tests.__n
-00012a60: 616d 655f 5f2c 0a20 2020 2020 2020 2020  ame__,.         
-00012a70: 2020 2076 616c 6964 5f64 7479 7065 733d     valid_dtypes=
-00012a80: 2873 7472 2c29 2c0a 2020 2020 2020 2020  (str,),.        
-00012a90: 2020 2020 6d69 6e5f 6c65 6e3d 322c 0a20      min_len=2,. 
-00012aa0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00012ab0: 2063 6865 636b 5f74 6861 745f 636f 6c75   check_that_colu
-00012ac0: 6d6e 5f65 7869 7374 2864 663d 6461 7461  mn_exist(df=data
-00012ad0: 2c20 636f 6c75 6d6e 5f6e 616d 653d 7661  , column_name=va
-00012ae0: 7269 6162 6c65 732c 2066 696c 655f 6e61  riables, file_na
-00012af0: 6d65 3d22 2229 0a20 2020 2020 2020 2063  me="").        c
-00012b00: 6865 636b 5f73 7472 280a 2020 2020 2020  heck_str(.      
-00012b10: 2020 2020 2020 6e61 6d65 3d54 696d 6573        name=Times
-00012b20: 6572 6965 7346 6561 7475 7265 4d69 7869  eriesFeatureMixi
-00012b30: 6e2e 6772 616e 6765 725f 7465 7374 732e  n.granger_tests.
-00012b40: 5f5f 6e61 6d65 5f5f 2c0a 2020 2020 2020  __name__,.      
-00012b50: 2020 2020 2020 7661 6c75 653d 7465 7374        value=test
-00012b60: 2c0a 2020 2020 2020 2020 2020 2020 6f70  ,.            op
-00012b70: 7469 6f6e 733d 2822 7373 725f 6674 6573  tions=("ssr_ftes
-00012b80: 7422 2c20 2273 7372 5f63 6869 3274 6573  t", "ssr_chi2tes
-00012b90: 7422 2c20 226c 7274 6573 7422 2c20 2270  t", "lrtest", "p
-00012ba0: 6172 616d 735f 6674 6573 7422 292c 0a20  arams_ftest"),. 
-00012bb0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00012bc0: 2063 6865 636b 5f69 6e74 280a 2020 2020   check_int(.    
-00012bd0: 2020 2020 2020 2020 6e61 6d65 3d54 696d          name=Tim
-00012be0: 6573 6572 6965 7346 6561 7475 7265 4d69  eseriesFeatureMi
-00012bf0: 7869 6e2e 6772 616e 6765 725f 7465 7374  xin.granger_test
-00012c00: 732e 5f5f 6e61 6d65 5f5f 2c20 7661 6c75  s.__name__, valu
-00012c10: 653d 6c61 672c 206d 696e 5f76 616c 7565  e=lag, min_value
-00012c20: 3d31 0a20 2020 2020 2020 2029 0a20 2020  =1.        ).   
-00012c30: 2020 2020 2064 6620 3d20 7064 2e44 6174       df = pd.Dat
-00012c40: 6146 7261 6d65 280a 2020 2020 2020 2020  aFrame(.        
-00012c50: 2020 2020 6e70 2e7a 6572 6f73 2828 6c65      np.zeros((le
-00012c60: 6e28 7661 7269 6162 6c65 7329 2c20 6c65  n(variables), le
-00012c70: 6e28 7661 7269 6162 6c65 7329 2929 2c0a  n(variables))),.
-00012c80: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
-00012c90: 6d6e 733d 7661 7269 6162 6c65 732c 0a20  mns=variables,. 
-00012ca0: 2020 2020 2020 2020 2020 2069 6e64 6578             index
-00012cb0: 3d76 6172 6961 626c 6573 2c0a 2020 2020  =variables,.    
-00012cc0: 2020 2020 290a 2020 2020 2020 2020 666f      ).        fo
-00012cd0: 7220 632c 2072 2069 6e20 6974 6572 746f  r c, r in iterto
-00012ce0: 6f6c 732e 7072 6f64 7563 7428 6466 2e63  ols.product(df.c
-00012cf0: 6f6c 756d 6e73 2c20 6466 2e69 6e64 6578  olumns, df.index
-00012d00: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-00012d10: 6573 756c 7420 3d20 6772 616e 6765 7263  esult = grangerc
-00012d20: 6175 7361 6c69 7479 7465 7374 7328 6461  ausalitytests(da
-00012d30: 7461 5b5b 722c 2063 5d5d 2c20 6d61 786c  ta[[r, c]], maxl
-00012d40: 6167 3d5b 6c61 675d 2c20 7665 7262 6f73  ag=[lag], verbos
-00012d50: 653d 4661 6c73 6529 0a20 2020 2020 2020  e=False).       
-00012d60: 2020 2020 2070 5f76 616c 203d 206d 696e       p_val = min
-00012d70: 285b 726f 756e 6428 7265 7375 6c74 5b6c  ([round(result[l
-00012d80: 6167 5d5b 305d 5b74 6573 745d 5b31 5d2c  ag][0][test][1],
-00012d90: 2034 2920 666f 7220 6920 696e 2072 616e   4) for i in ran
-00012da0: 6765 2831 295d 290a 2020 2020 2020 2020  ge(1)]).        
-00012db0: 2020 2020 6466 2e6c 6f63 5b72 2c20 635d      df.loc[r, c]
-00012dc0: 203d 2070 5f76 616c 0a20 2020 2020 2020   = p_val.       
-00012dd0: 2072 6574 7572 6e20 6466 0a0a 2020 2020   return df..    
-00012de0: 4073 7461 7469 636d 6574 686f 640a 2020  @staticmethod.  
-00012df0: 2020 406e 6a69 7428 2228 696e 7433 325b    @njit("(int32[
-00012e00: 3a2c 3a5d 2c20 666c 6f61 7436 345b 3a5d  :,:], float64[:]
-00012e10: 2c20 666c 6f61 7436 342c 2066 6c6f 6174  , float64, float
-00012e20: 3634 2922 290a 2020 2020 6465 6620 736c  64)").    def sl
-00012e30: 6964 696e 675f 6469 7370 6c61 6365 6d65  iding_displaceme
-00012e40: 6e74 280a 2020 2020 2020 2020 783a 206e  nt(.        x: n
-00012e50: 702e 6e64 6172 7261 792c 2074 696d 655f  p.ndarray, time_
-00012e60: 7769 6e64 6f77 733a 206e 702e 6e64 6172  windows: np.ndar
-00012e70: 7261 792c 2066 7073 3a20 666c 6f61 742c  ray, fps: float,
-00012e80: 2070 785f 7065 725f 6d6d 3a20 666c 6f61   px_per_mm: floa
-00012e90: 740a 2020 2020 2920 2d3e 206e 702e 6e64  t.    ) -> np.nd
-00012ea0: 6172 7261 793a 0a20 2020 2020 2020 2022  array:.        "
-00012eb0: 2222 0a20 2020 2020 2020 2043 616c 6375  "".        Calcu
-00012ec0: 6c61 7465 2073 6c69 6469 6e67 2045 7563  late sliding Euc
-00012ed0: 6c69 6465 616e 2064 6973 706c 6163 656d  lidean displacem
-00012ee0: 656e 7420 6f66 2061 2062 6f64 792d 7061  ent of a body-pa
-00012ef0: 7274 2070 6f69 6e74 206f 7665 7220 7469  rt point over ti
-00012f00: 6d65 2077 696e 646f 7773 2e0a 0a20 2020  me windows...   
-00012f10: 2020 2020 202e 2e20 696d 6167 653a 3a20       .. image:: 
-00012f20: 5f73 7461 7469 632f 696d 672f 736c 6964  _static/img/slid
-00012f30: 696e 675f 6469 7370 6c61 6365 6d65 6e74  ing_displacement
-00012f40: 2e70 6e67 0a20 2020 2020 2020 2020 2020  .png.           
-00012f50: 3a77 6964 7468 3a20 3630 300a 2020 2020  :width: 600.    
-00012f60: 2020 2020 2020 203a 616c 6967 6e3a 2063         :align: c
-00012f70: 656e 7465 720a 0a20 2020 2020 2020 203a  enter..        :
-00012f80: 7061 7261 6d20 6e70 2e6e 6461 7272 6179  param np.ndarray
-00012f90: 2078 3a20 416e 2061 7272 6179 206f 6620   x: An array of 
-00012fa0: 7368 6170 6520 286e 2c20 3229 2072 6570  shape (n, 2) rep
-00012fb0: 7265 7365 6e74 696e 6720 7468 6520 7469  resenting the ti
-00012fc0: 6d65 2d73 6572 6965 7320 7365 7175 656e  me-series sequen
-00012fd0: 6365 206f 6620 3244 2070 6f69 6e74 732e  ce of 2D points.
-00012fe0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00012ff0: 6e70 2e6e 6461 7272 6179 2074 696d 655f  np.ndarray time_
-00013000: 7769 6e64 6f77 733a 2041 7272 6179 206f  windows: Array o
-00013010: 6620 7469 6d65 2077 696e 646f 7773 2028  f time windows (
-00013020: 696e 2073 6563 6f6e 6473 292e 0a20 2020  in seconds)..   
-00013030: 2020 2020 203a 7061 7261 6d20 666c 6f61       :param floa
-00013040: 7420 6670 733a 2054 6865 2073 616d 706c  t fps: The sampl
-00013050: 6520 7261 7465 2028 6672 616d 6573 2070  e rate (frames p
-00013060: 6572 2073 6563 6f6e 6429 206f 6620 7468  er second) of th
-00013070: 6520 7365 7175 656e 6365 2e0a 2020 2020  e sequence..    
-00013080: 2020 2020 3a70 6172 616d 2066 6c6f 6174      :param float
-00013090: 2070 785f 7065 725f 6d6d 3a20 5069 7865   px_per_mm: Pixe
-000130a0: 6c73 2070 6572 206d 696c 6c69 6d65 7465  ls per millimete
-000130b0: 7220 636f 6e76 6572 7369 6f6e 2066 6163  r conversion fac
-000130c0: 746f 722e 0a20 2020 2020 2020 203a 7265  tor..        :re
-000130d0: 7475 726e 206e 702e 6e64 6172 7261 793a  turn np.ndarray:
-000130e0: 2031 4420 6172 7261 7920 636f 6e74 6169   1D array contai
-000130f0: 6e69 6e67 2074 6865 2063 616c 6375 6c61  ning the calcula
-00013100: 7465 6420 6469 7370 6c61 6365 6d65 6e74  ted displacement
-00013110: 732e 0a0a 2020 2020 2020 2020 3a65 7861  s...        :exa
-00013120: 6d70 6c65 3a0a 2020 2020 2020 2020 3e3e  mple:.        >>
-00013130: 3e20 7820 3d20 6e70 2e72 616e 646f 6d2e  > x = np.random.
-00013140: 7261 6e64 696e 7428 302c 2035 302c 2028  randint(0, 50, (
-00013150: 3130 302c 2032 2929 2e61 7374 7970 6528  100, 2)).astype(
-00013160: 6e70 2e69 6e74 3332 290a 2020 2020 2020  np.int32).      
-00013170: 2020 3e3e 3e20 5469 6d65 7365 7269 6573    >>> Timeseries
-00013180: 4665 6174 7572 654d 6978 696e 2e73 6c69  FeatureMixin.sli
-00013190: 6469 6e67 5f64 6973 706c 6163 656d 656e  ding_displacemen
-000131a0: 7428 783d 782c 2074 696d 655f 7769 6e64  t(x=x, time_wind
-000131b0: 6f77 733d 6e70 2e61 7272 6179 285b 312e  ows=np.array([1.
-000131c0: 305d 292c 2066 7073 3d31 2e30 2c20 7078  0]), fps=1.0, px
-000131d0: 5f70 6572 5f6d 6d3d 312e 3029 0a20 2020  _per_mm=1.0).   
-000131e0: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-000131f0: 2020 7265 7375 6c74 7320 3d20 6e70 2e66    results = np.f
-00013200: 756c 6c28 2878 2e73 6861 7065 5b30 5d2c  ull((x.shape[0],
-00013210: 2074 696d 655f 7769 6e64 6f77 732e 7368   time_windows.sh
-00013220: 6170 655b 305d 292c 202d 312e 3029 0a20  ape[0]), -1.0). 
-00013230: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-00013240: 7261 6e67 6528 7469 6d65 5f77 696e 646f  range(time_windo
-00013250: 7773 2e73 6861 7065 5b30 5d29 3a0a 2020  ws.shape[0]):.  
-00013260: 2020 2020 2020 2020 2020 7720 3d20 696e            w = in
-00013270: 7428 7469 6d65 5f77 696e 646f 7773 5b69  t(time_windows[i
-00013280: 5d20 2a20 6670 7329 0a20 2020 2020 2020  ] * fps).       
-00013290: 2020 2020 2066 6f72 206a 2069 6e20 7261       for j in ra
-000132a0: 6e67 6528 772c 2078 2e73 6861 7065 5b30  nge(w, x.shape[0
-000132b0: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
-000132c0: 2020 2020 632c 2073 203d 2078 5b6a 5d2c      c, s = x[j],
-000132d0: 2078 5b6a 202d 2077 5d0a 2020 2020 2020   x[j - w].      
-000132e0: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-000132f0: 735b 6a2c 2069 5d20 3d20 280a 2020 2020  s[j, i] = (.    
-00013300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013310: 6e70 2e73 7172 7428 2873 5b30 5d20 2d20  np.sqrt((s[0] - 
-00013320: 635b 305d 2920 2a2a 2032 202b 2028 735b  c[0]) ** 2 + (s[
-00013330: 315d 202d 2063 5b31 5d29 202a 2a20 3229  1] - c[1]) ** 2)
-00013340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013350: 2029 202f 2070 785f 7065 725f 6d6d 0a20   ) / px_per_mm. 
-00013360: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-00013370: 7375 6c74 732e 6173 7479 7065 286e 702e  sults.astype(np.
-00013380: 666c 6f61 7433 3229 0a                   float32).
+00010420: 2020 2274 7261 696e 5f73 7461 7274 5f74    "train_start_t
+00010430: 696d 6522 3a20 666c 6f61 7428 7472 6169  ime": float(trai
+00010440: 6e5f 6461 7461 5f69 6478 5b69 5d5b 305d  n_data_idx[i][0]
+00010450: 202a 2073 616d 706c 655f 7261 7465 292c   * sample_rate),
+00010460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010470: 2020 2020 2022 7472 6169 6e5f 656e 645f       "train_end_
+00010480: 7469 6d65 223a 2074 7261 696e 5f64 6174  time": train_dat
+00010490: 615f 6964 785b 695d 5b2d 315d 202a 2073  a_idx[i][-1] * s
+000104a0: 616d 706c 655f 7261 7465 2c0a 2020 2020  ample_rate,.    
+000104b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000104c0: 2274 7261 696e 5f73 7461 7274 5f6f 6273  "train_start_obs
+000104d0: 223a 2074 7261 696e 5f64 6174 615f 6964  ": train_data_id
+000104e0: 785b 695d 5b30 5d2c 0a20 2020 2020 2020  x[i][0],.       
+000104f0: 2020 2020 2020 2020 2020 2020 2022 7472               "tr
+00010500: 6169 6e5f 656e 645f 6f62 7322 3a20 7472  ain_end_obs": tr
+00010510: 6169 6e5f 6461 7461 5f69 6478 5b69 5d5b  ain_data_idx[i][
+00010520: 2d31 5d2c 0a20 2020 2020 2020 2020 2020  -1],.           
+00010530: 2020 2020 2020 2020 2022 7370 696b 655f           "spike_
+00010540: 636e 7422 3a20 6c65 6e28 7472 6169 6e5f  cnt": len(train_
+00010550: 7370 696b 6573 5f69 6478 5b69 5d29 2c0a  spikes_idx[i]),.
+00010560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010570: 2020 2020 2274 7261 696e 5f6c 656e 6774      "train_lengt
+00010580: 685f 6f62 735f 636e 7422 3a20 6c65 6e28  h_obs_cnt": len(
+00010590: 7370 696b 655f 7472 6169 6e5f 616d 7073  spike_train_amps
+000105a0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+000105b0: 2020 2020 2020 2022 7472 6169 6e5f 6c65         "train_le
+000105c0: 6e67 7468 5f6f 6273 5f73 223a 206c 656e  ngth_obs_s": len
+000105d0: 2873 7069 6b65 5f74 7261 696e 5f61 6d70  (spike_train_amp
+000105e0: 7329 202f 2073 616d 706c 655f 7261 7465  s) / sample_rate
+000105f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00010600: 2020 2020 2020 2274 7261 696e 5f73 7069        "train_spi
+00010610: 6b65 5f6d 6561 6e5f 6c65 6e67 7468 735f  ke_mean_lengths_
+00010620: 7322 3a20 6e70 2e6d 6561 6e28 7472 6169  s": np.mean(trai
+00010630: 6e5f 7370 696b 655f 6c65 6e67 7468 7329  n_spike_lengths)
+00010640: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010650: 2020 2020 202a 2073 616d 706c 655f 7261       * sample_ra
+00010660: 7465 2c0a 2020 2020 2020 2020 2020 2020  te,.            
+00010670: 2020 2020 2020 2020 2274 7261 696e 5f73          "train_s
+00010680: 7069 6b65 5f73 7464 5f6c 656e 6774 685f  pike_std_length_
+00010690: 6f62 7322 3a20 6e70 2e6d 6561 6e28 7472  obs": np.mean(tr
+000106a0: 6169 6e5f 7370 696b 655f 6c65 6e67 7468  ain_spike_length
+000106b0: 7329 2c0a 2020 2020 2020 2020 2020 2020  s),.            
+000106c0: 2020 2020 2020 2020 2274 7261 696e 5f73          "train_s
+000106d0: 7069 6b65 5f73 7464 5f6c 656e 6774 685f  pike_std_length_
+000106e0: 7322 3a20 6e70 2e6d 6561 6e28 7472 6169  s": np.mean(trai
+000106f0: 6e5f 7370 696b 655f 6c65 6e67 7468 7329  n_spike_lengths)
+00010700: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010710: 2020 2020 202a 2073 616d 706c 655f 7261       * sample_ra
+00010720: 7465 2c0a 2020 2020 2020 2020 2020 2020  te,.            
+00010730: 2020 2020 2020 2020 2274 7261 696e 5f73          "train_s
+00010740: 7069 6b65 5f6d 6178 5f6c 656e 6774 685f  pike_max_length_
+00010750: 6f62 7322 3a20 6e70 2e6d 6178 2874 7261  obs": np.max(tra
+00010760: 696e 5f73 7069 6b65 5f6c 656e 6774 6873  in_spike_lengths
+00010770: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00010780: 2020 2020 2020 2022 7472 6169 6e5f 7370         "train_sp
+00010790: 696b 655f 6d61 785f 6c65 6e67 7468 5f73  ike_max_length_s
+000107a0: 223a 206e 702e 6d61 7828 7472 6169 6e5f  ": np.max(train_
+000107b0: 7370 696b 655f 6c65 6e67 7468 7329 0a20  spike_lengths). 
+000107c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000107d0: 2020 202a 2073 616d 706c 655f 7261 7465     * sample_rate
+000107e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000107f0: 2020 2020 2020 2274 7261 696e 5f73 7069        "train_spi
+00010800: 6b65 5f6d 696e 5f6c 656e 6774 685f 6f62  ke_min_length_ob
+00010810: 7322 3a20 6e70 2e6d 696e 2874 7261 696e  s": np.min(train
+00010820: 5f73 7069 6b65 5f6c 656e 6774 6873 292c  _spike_lengths),
+00010830: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010840: 2020 2020 2022 7472 6169 6e5f 7370 696b       "train_spik
+00010850: 655f 6d69 6e5f 6c65 6e67 7468 5f73 223a  e_min_length_s":
+00010860: 206e 702e 6d69 6e28 7472 6169 6e5f 7370   np.min(train_sp
+00010870: 696b 655f 6c65 6e67 7468 7329 0a20 2020  ike_lengths).   
+00010880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010890: 202a 2073 616d 706c 655f 7261 7465 2c0a   * sample_rate,.
+000108a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000108b0: 2020 2020 2274 7261 696e 5f6d 6561 6e5f      "train_mean_
+000108c0: 616d 706c 6974 7564 6522 3a20 6e70 2e6d  amplitude": np.m
+000108d0: 6561 6e28 7370 696b 655f 7472 6169 6e5f  ean(spike_train_
+000108e0: 616d 7073 292c 0a20 2020 2020 2020 2020  amps),.         
+000108f0: 2020 2020 2020 2020 2020 2022 7472 6169             "trai
+00010900: 6e5f 7374 645f 616d 706c 6974 7564 6522  n_std_amplitude"
+00010910: 3a20 6e70 2e73 7464 2873 7069 6b65 5f74  : np.std(spike_t
+00010920: 7261 696e 5f61 6d70 7329 2c0a 2020 2020  rain_amps),.    
+00010930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010940: 2274 7261 696e 5f6d 696e 5f61 6d70 6c69  "train_min_ampli
+00010950: 7475 6465 223a 206e 702e 6d69 6e28 7370  tude": np.min(sp
+00010960: 696b 655f 7472 6169 6e5f 616d 7073 292c  ike_train_amps),
+00010970: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010980: 2020 2020 2022 7472 6169 6e5f 6d61 785f       "train_max_
+00010990: 616d 706c 6974 7564 6522 3a20 6e70 2e6d  amplitude": np.m
+000109a0: 6178 2873 7069 6b65 5f74 7261 696e 5f61  ax(spike_train_a
+000109b0: 6d70 7329 2c0a 2020 2020 2020 2020 2020  mps),.          
+000109c0: 2020 2020 2020 7d0a 0a20 2020 2020 2020        }..       
+000109d0: 2072 6574 7572 6e20 7370 696b 655f 6469   return spike_di
+000109e0: 6374 0a0a 2020 2020 4073 7461 7469 636d  ct..    @staticm
+000109f0: 6574 686f 640a 2020 2020 6465 6620 5f61  ethod.    def _a
+00010a00: 6466 5f65 7865 6375 746f 7228 6461 7461  df_executor(data
+00010a10: 3a20 6e70 2e6e 6461 7272 6179 2920 2d3e  : np.ndarray) ->
+00010a20: 2074 7570 6c65 3a0a 2020 2020 2020 2020   tuple:.        
+00010a30: 2222 220a 2020 2020 2020 2020 4865 6c70  """.        Help
+00010a40: 6572 2066 756e 6374 696f 6e20 746f 2065  er function to e
+00010a50: 7865 6375 7465 2041 7567 6d65 6e74 6564  xecute Augmented
+00010a60: 2044 6963 6b65 792d 4675 6c6c 6572 2028   Dickey-Fuller (
+00010a70: 4144 4629 2074 6573 7420 6f6e 2061 2064  ADF) test on a d
+00010a80: 6174 6120 7365 676d 656e 742e 0a20 2020  ata segment..   
+00010a90: 2020 2020 2043 616c 6c65 6420 6279 203a       Called by :
+00010aa0: 6d65 7468 3a60 7469 6d65 7365 7269 6573  meth:`timeseries
+00010ab0: 5f66 6561 7475 7265 735f 6d69 7869 6e2e  _features_mixin.
+00010ac0: 5469 6d65 7365 7269 6573 4665 6174 7572  TimeseriesFeatur
+00010ad0: 654d 6978 696e 2e73 6c69 6469 6e67 5f73  eMixin.sliding_s
+00010ae0: 7461 7469 6f6e 6172 795f 7465 7374 5f74  tationary_test_t
+00010af0: 6573 7460 2e0a 2020 2020 2020 2020 2222  est`..        ""
+00010b00: 220a 0a20 2020 2020 2020 2061 6466 756c  "..        adful
+00010b10: 6c65 725f 7265 7375 6c74 7320 3d20 6164  ler_results = ad
+00010b20: 6675 6c6c 6572 2864 6174 6129 0a20 2020  fuller(data).   
+00010b30: 2020 2020 2072 6574 7572 6e20 6164 6675       return adfu
+00010b40: 6c6c 6572 5f72 6573 756c 7473 5b30 5d2c  ller_results[0],
+00010b50: 2061 6466 756c 6c65 725f 7265 7375 6c74   adfuller_result
+00010b60: 735b 315d 0a0a 2020 2020 4073 7461 7469  s[1]..    @stati
+00010b70: 636d 6574 686f 640a 2020 2020 6465 6620  cmethod.    def 
+00010b80: 5f6b 7073 735f 6578 6563 7574 6f72 2864  _kpss_executor(d
+00010b90: 6174 613a 206e 702e 6e64 6172 7261 7929  ata: np.ndarray)
+00010ba0: 202d 3e20 7475 706c 653a 0a20 2020 2020   -> tuple:.     
+00010bb0: 2020 2022 2222 0a20 2020 2020 2020 2048     """.        H
+00010bc0: 656c 7065 7220 6675 6e63 7469 6f6e 2074  elper function t
+00010bd0: 6f20 6578 6563 7574 6520 4b77 6961 746b  o execute Kwiatk
+00010be0: 6f77 736b 69e2 8093 5068 696c 6c69 7073  owski...Phillips
+00010bf0: e280 9353 6368 6d69 6474 e280 9353 6869  ...Schmidt...Shi
+00010c00: 6e20 284b 5053 5329 2074 6573 7420 6f6e  n (KPSS) test on
+00010c10: 2061 2064 6174 6120 7365 676d 656e 742e   a data segment.
+00010c20: 0a20 2020 2020 2020 2043 616c 6c65 6420  .        Called 
+00010c30: 6279 203a 6d65 7468 3a60 7469 6d65 7365  by :meth:`timese
+00010c40: 7269 6573 5f66 6561 7475 7265 735f 6d69  ries_features_mi
+00010c50: 7869 6e2e 5469 6d65 7365 7269 6573 4665  xin.TimeseriesFe
+00010c60: 6174 7572 654d 6978 696e 2e73 6c69 6469  atureMixin.slidi
+00010c70: 6e67 5f73 7461 7469 6f6e 6172 795f 7465  ng_stationary_te
+00010c80: 7374 5f74 6573 7460 2e0a 2020 2020 2020  st_test`..      
+00010c90: 2020 2222 220a 0a20 2020 2020 2020 206b    """..        k
+00010ca0: 7073 735f 7265 7375 6c74 7320 3d20 6b70  pss_results = kp
+00010cb0: 7373 2864 6174 6129 0a20 2020 2020 2020  ss(data).       
+00010cc0: 2072 6574 7572 6e20 6b70 7373 5f72 6573   return kpss_res
+00010cd0: 756c 7473 5b30 5d2c 206b 7073 735f 7265  ults[0], kpss_re
+00010ce0: 7375 6c74 735b 315d 0a0a 2020 2020 4073  sults[1]..    @s
+00010cf0: 7461 7469 636d 6574 686f 640a 2020 2020  taticmethod.    
+00010d00: 6465 6620 5f7a 6976 6f74 616e 6472 6577  def _zivotandrew
+00010d10: 735f 6578 6563 7574 6f72 2864 6174 613a  s_executor(data:
+00010d20: 206e 702e 6e64 6172 7261 7929 202d 3e20   np.ndarray) -> 
+00010d30: 7475 706c 653a 0a20 2020 2020 2020 2022  tuple:.        "
+00010d40: 2222 0a20 2020 2020 2020 2048 656c 7065  "".        Helpe
+00010d50: 7220 6675 6e63 7469 6f6e 2074 6f20 6578  r function to ex
+00010d60: 6563 7574 6520 5a69 766f 742d 416e 6472  ecute Zivot-Andr
+00010d70: 6577 7320 7374 7275 6374 7572 616c 2d62  ews structural-b
+00010d80: 7265 616b 2075 6e69 742d 726f 6f74 2074  reak unit-root t
+00010d90: 6573 7420 6f6e 2061 2064 6174 6120 7365  est on a data se
+00010da0: 676d 656e 742e 0a20 2020 2020 2020 2043  gment..        C
+00010db0: 616c 6c65 6420 6279 203a 6d65 7468 3a60  alled by :meth:`
+00010dc0: 7469 6d65 7365 7269 6573 5f66 6561 7475  timeseries_featu
+00010dd0: 7265 735f 6d69 7869 6e2e 5469 6d65 7365  res_mixin.Timese
+00010de0: 7269 6573 4665 6174 7572 654d 6978 696e  riesFeatureMixin
+00010df0: 2e73 6c69 6469 6e67 5f73 7461 7469 6f6e  .sliding_station
+00010e00: 6172 795f 7465 7374 5f74 6573 7460 2e0a  ary_test_test`..
+00010e10: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00010e20: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+00010e30: 2020 2020 207a 615f 7265 7375 6c74 7320       za_results 
+00010e40: 3d20 7a69 766f 745f 616e 6472 6577 7328  = zivot_andrews(
+00010e50: 6461 7461 290a 2020 2020 2020 2020 2020  data).          
+00010e60: 2020 7265 7475 726e 207a 615f 7265 7375    return za_resu
+00010e70: 6c74 735b 305d 2c20 7a61 5f72 6573 756c  lts[0], za_resul
+00010e80: 7473 5b31 5d0a 2020 2020 2020 2020 6578  ts[1].        ex
+00010e90: 6365 7074 2028 6e70 2e6c 696e 616c 672e  cept (np.linalg.
+00010ea0: 4c69 6e41 6c67 4572 726f 722c 2056 616c  LinAlgError, Val
+00010eb0: 7565 4572 726f 7229 3a0a 2020 2020 2020  ueError):.      
+00010ec0: 2020 2020 2020 7265 7475 726e 2030 2c20        return 0, 
+00010ed0: 300a 0a20 2020 2040 7374 6174 6963 6d65  0..    @staticme
+00010ee0: 7468 6f64 0a20 2020 2064 6566 2073 6c69  thod.    def sli
+00010ef0: 6469 6e67 5f73 7461 7469 6f6e 6172 7928  ding_stationary(
+00010f00: 0a20 2020 2020 2020 2064 6174 613a 206e  .        data: n
+00010f10: 702e 6e64 6172 7261 792c 0a20 2020 2020  p.ndarray,.     
+00010f20: 2020 2074 696d 655f 7769 6e64 6f77 733a     time_windows:
+00010f30: 206e 702e 6e64 6172 7261 792c 0a20 2020   np.ndarray,.   
+00010f40: 2020 2020 2073 616d 706c 655f 7261 7465       sample_rate
+00010f50: 3a20 696e 742c 0a20 2020 2020 2020 2074  : int,.        t
+00010f60: 6573 743a 204c 6974 6572 616c 5b22 4144  est: Literal["AD
+00010f70: 4622 2c20 224b 5053 5322 2c20 225a 4122  F", "KPSS", "ZA"
+00010f80: 5d20 3d20 2261 6466 222c 0a20 2020 2029  ] = "adf",.    )
+00010f90: 202d 3e20 286e 702e 6e64 6172 7261 792c   -> (np.ndarray,
+00010fa0: 206e 702e 6e64 6172 7261 7929 3a0a 2020   np.ndarray):.  
+00010fb0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00010fc0: 2020 5065 7266 6f72 6d20 7468 6520 4175    Perform the Au
+00010fd0: 676d 656e 7465 6420 4469 636b 6579 2d46  gmented Dickey-F
+00010fe0: 756c 6c65 7220 2841 4446 292c 204b 7769  uller (ADF), Kwi
+00010ff0: 6174 6b6f 7773 6b69 2d50 6869 6c6c 6970  atkowski-Phillip
+00011000: 732d 5363 686d 6964 742d 5368 696e 2028  s-Schmidt-Shin (
+00011010: 4b50 5353 292c 206f 7220 5a69 766f 742d  KPSS), or Zivot-
+00011020: 416e 6472 6577 7320 7465 7374 206f 6e20  Andrews test on 
+00011030: 736c 6964 696e 6720 7769 6e64 6f77 7320  sliding windows 
+00011040: 6f66 2074 696d 6520 7365 7269 6573 2064  of time series d
+00011050: 6174 612e 0a20 2020 2020 2020 2050 6172  ata..        Par
+00011060: 616c 6c65 6c20 7072 6f63 6573 7369 6e67  allel processing
+00011070: 2075 7369 6e67 2061 6c6c 2061 7661 696c   using all avail
+00011080: 6162 6c65 2063 6f72 6573 2069 7320 7573  able cores is us
+00011090: 6564 2074 6f20 6163 6365 6c65 7261 7465  ed to accelerate
+000110a0: 2063 6f6d 7075 7461 7469 6f6e 2e0a 0a20   computation... 
+000110b0: 2020 2020 2020 202e 2e20 6e6f 7465 3a3a         .. note::
+000110c0: 0a20 2020 2020 2020 2020 2020 2d20 4144  .           - AD
+000110d0: 463a 2041 2068 6967 6820 702d 7661 6c75  F: A high p-valu
+000110e0: 6520 7375 6767 6573 7473 206e 6f6e 2d73  e suggests non-s
+000110f0: 7461 7469 6f6e 6172 6974 792c 2077 6869  tationarity, whi
+00011100: 6c65 2061 206c 6f77 2070 2d76 616c 7565  le a low p-value
+00011110: 2069 6e64 6963 6174 6573 2073 7461 7469   indicates stati
+00011120: 6f6e 6172 6974 792e 0a20 2020 2020 2020  onarity..       
+00011130: 2020 2020 2d20 4b50 5353 3a20 4120 6869      - KPSS: A hi
+00011140: 6768 2070 2d76 616c 7565 2073 7567 6765  gh p-value sugge
+00011150: 7374 7320 7374 6174 696f 6e61 7269 7479  sts stationarity
+00011160: 2c20 7768 696c 6520 6120 6c6f 7720 702d  , while a low p-
+00011170: 7661 6c75 6520 696e 6469 6361 7465 7320  value indicates 
+00011180: 6e6f 6e2d 7374 6174 696f 6e61 7269 7479  non-stationarity
+00011190: 2e0a 2020 2020 2020 2020 2020 202d 205a  ..           - Z
+000111a0: 413a 2041 2068 6967 6820 702d 7661 6c75  A: A high p-valu
+000111b0: 6520 7375 6767 6573 7473 206e 6f6e 2d73  e suggests non-s
+000111c0: 7461 7469 6f6e 6172 6974 792c 2077 6869  tationarity, whi
+000111d0: 6c65 2061 206c 6f77 2070 2d76 616c 7565  le a low p-value
+000111e0: 2069 6e64 6963 6174 6573 2073 7461 7469   indicates stati
+000111f0: 6f6e 6172 6974 792e 0a0a 2020 2020 2020  onarity...      
+00011200: 2020 3a70 6172 616d 206e 702e 6e64 6172    :param np.ndar
+00011210: 7261 7920 6461 7461 3a20 312d 4420 4e75  ray data: 1-D Nu
+00011220: 6d50 7920 6172 7261 7920 636f 6e74 6169  mPy array contai
+00011230: 6e69 6e67 2074 6865 2074 696d 6520 7365  ning the time se
+00011240: 7269 6573 2064 6174 6120 746f 2062 6520  ries data to be 
+00011250: 7465 7374 6564 2e0a 2020 2020 2020 2020  tested..        
+00011260: 3a70 6172 616d 206e 702e 6e64 6172 7261  :param np.ndarra
+00011270: 7920 7469 6d65 5f77 696e 646f 7773 3a20  y time_windows: 
+00011280: 4120 312d 4420 4e75 6d50 7920 6172 7261  A 1-D NumPy arra
+00011290: 7920 636f 6e74 6169 6e69 6e67 2074 6865  y containing the
+000112a0: 2074 696d 6520 7769 6e64 6f77 2073 697a   time window siz
+000112b0: 6573 2069 6e20 7365 636f 6e64 732e 0a20  es in seconds.. 
+000112c0: 2020 2020 2020 203a 7061 7261 6d20 6e70         :param np
+000112d0: 2e6e 6461 7272 6179 2073 616d 706c 655f  .ndarray sample_
+000112e0: 7261 7465 3a20 5468 6520 7361 6d70 6c65  rate: The sample
+000112f0: 2072 6174 6520 6f66 2074 6865 2074 696d   rate of the tim
+00011300: 6520 7365 7269 6573 2064 6174 6120 2873  e series data (s
+00011310: 616d 706c 6573 2070 6572 2073 6563 6f6e  amples per secon
+00011320: 6429 2e0a 2020 2020 2020 2020 3a70 6172  d)..        :par
+00011330: 616d 204c 6974 6572 616c 2074 6573 743a  am Literal test:
+00011340: 2054 6573 7420 746f 2070 6572 6672 6f6d   Test to perfrom
+00011350: 3a20 4f70 7469 6f6e 733a 2027 4144 4627  : Options: 'ADF'
+00011360: 2028 4175 676d 656e 7465 6420 4469 636b   (Augmented Dick
+00011370: 6579 2d46 756c 6c65 7229 2c20 274b 5053  ey-Fuller), 'KPS
+00011380: 5327 2028 4b77 6961 746b 6f77 736b 692d  S' (Kwiatkowski-
+00011390: 5068 696c 6c69 7073 2d53 6368 6d69 6474  Phillips-Schmidt
+000113a0: 2d53 6869 6e29 2c20 275a 4127 2028 5a69  -Shin), 'ZA' (Zi
+000113b0: 766f 742d 416e 6472 6577 7329 2e0a 2020  vot-Andrews)..  
+000113c0: 2020 2020 2020 3a72 6574 7572 6e20 286e        :return (n
+000113d0: 702e 6e64 6172 7261 792c 206e 702e 6e64  p.ndarray, np.nd
+000113e0: 6172 7261 7929 3a20 4120 7475 706c 6520  array): A tuple 
+000113f0: 6f66 2074 776f 2032 2d44 204e 756d 5079  of two 2-D NumPy
+00011400: 2061 7272 6179 7320 636f 6e74 6169 6e69   arrays containi
+00011410: 6e67 2074 6573 7420 7374 6174 6973 7469  ng test statisti
+00011420: 6373 2061 6e64 2070 2d76 616c 7565 732e  cs and p-values.
+00011430: 202d 2054 6865 2066 6972 7374 2061 7272   - The first arr
+00011440: 6179 2028 7374 6174 2920 636f 6e74 6169  ay (stat) contai
+00011450: 6e73 2074 6865 2041 4446 2074 6573 7420  ns the ADF test 
+00011460: 7374 6174 6973 7469 6373 2e20 2d20 5468  statistics. - Th
+00011470: 6520 7365 636f 6e64 2061 7272 6179 2028  e second array (
+00011480: 705f 7661 6c73 2920 636f 6e74 6169 6e73  p_vals) contains
+00011490: 2074 6865 2063 6f72 7265 7370 6f6e 6469   the correspondi
+000114a0: 6e67 2070 2d76 616c 7565 730a 0a20 2020  ng p-values..   
+000114b0: 2020 2020 203a 6578 616d 706c 653a 0a20       :example:. 
+000114c0: 2020 2020 2020 203e 3e3e 2064 6174 6120         >>> data 
+000114d0: 3d20 6e70 2e61 7272 6179 285b 312c 2032  = np.array([1, 2
+000114e0: 2c20 332c 2034 2c20 352c 2036 2c20 372c  , 3, 4, 5, 6, 7,
+000114f0: 2038 2c20 392c 2031 305d 290a 2020 2020   8, 9, 10]).    
+00011500: 2020 2020 3e3e 3e20 5469 6d65 7365 7269      >>> Timeseri
+00011510: 6573 4665 6174 7572 654d 6978 696e 2829  esFeatureMixin()
+00011520: 2e73 6c69 6469 6e67 5f73 7461 7469 6f6e  .sliding_station
+00011530: 6172 7928 6461 7461 3d64 6174 612c 2074  ary(data=data, t
+00011540: 696d 655f 7769 6e64 6f77 733d 6e70 2e61  ime_windows=np.a
+00011550: 7272 6179 285b 322e 305d 292c 2074 6573  rray([2.0]), tes
+00011560: 743d 274b 5053 5327 2c20 7361 6d70 6c65  t='KPSS', sample
+00011570: 5f72 6174 653d 3229 0a20 2020 2020 2020  _rate=2).       
+00011580: 2022 2222 0a0a 2020 2020 2020 2020 7374   """..        st
+00011590: 6174 203d 206e 702e 6675 6c6c 2828 6461  at = np.full((da
+000115a0: 7461 2e73 6861 7065 5b30 5d2c 2074 696d  ta.shape[0], tim
+000115b0: 655f 7769 6e64 6f77 732e 7368 6170 655b  e_windows.shape[
+000115c0: 305d 292c 202d 312e 3029 0a20 2020 2020  0]), -1.0).     
+000115d0: 2020 2070 5f76 616c 7320 3d20 6e70 2e66     p_vals = np.f
+000115e0: 756c 6c28 2864 6174 612e 7368 6170 655b  ull((data.shape[
+000115f0: 305d 2c20 7469 6d65 5f77 696e 646f 7773  0], time_windows
+00011600: 2e73 6861 7065 5b30 5d29 2c20 2d31 2e30  .shape[0]), -1.0
+00011610: 290a 2020 2020 2020 2020 6966 2074 6573  ).        if tes
+00011620: 7420 3d3d 2022 4144 4622 3a0a 2020 2020  t == "ADF":.    
+00011630: 2020 2020 2020 2020 7465 7374 5f66 756e          test_fun
+00011640: 6320 3d20 5469 6d65 7365 7269 6573 4665  c = TimeseriesFe
+00011650: 6174 7572 654d 6978 696e 2829 2e5f 6164  atureMixin()._ad
+00011660: 665f 6578 6563 7574 6f72 0a20 2020 2020  f_executor.     
+00011670: 2020 2065 6c69 6620 7465 7374 203d 3d20     elif test == 
+00011680: 224b 5053 5322 3a0a 2020 2020 2020 2020  "KPSS":.        
+00011690: 2020 2020 7465 7374 5f66 756e 6320 3d20      test_func = 
+000116a0: 5469 6d65 7365 7269 6573 4665 6174 7572  TimeseriesFeatur
+000116b0: 654d 6978 696e 2829 2e5f 6b70 7373 5f65  eMixin()._kpss_e
+000116c0: 7865 6375 746f 720a 2020 2020 2020 2020  xecutor.        
+000116d0: 656c 6966 2074 6573 7420 3d3d 2022 5a41  elif test == "ZA
+000116e0: 223a 0a20 2020 2020 2020 2020 2020 2074  ":.            t
+000116f0: 6573 745f 6675 6e63 203d 2054 696d 6573  est_func = Times
+00011700: 6572 6965 7346 6561 7475 7265 4d69 7869  eriesFeatureMixi
+00011710: 6e28 292e 5f7a 6976 6f74 616e 6472 6577  n()._zivotandrew
+00011720: 735f 6578 6563 7574 6f72 0a20 2020 2020  s_executor.     
+00011730: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00011740: 2020 2020 2074 7970 655f 6869 6e74 7320       type_hints 
+00011750: 3d20 6765 745f 7479 7065 5f68 696e 7473  = get_type_hints
+00011760: 2854 696d 6573 6572 6965 7346 6561 7475  (TimeseriesFeatu
+00011770: 7265 4d69 7869 6e28 292e 736c 6964 696e  reMixin().slidin
+00011780: 675f 7374 6174 696f 6e61 7279 290a 2020  g_stationary).  
+00011790: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+000117a0: 496e 7661 6c69 6449 6e70 7574 4572 726f  InvalidInputErro
+000117b0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+000117c0: 2020 206d 7367 3d66 2754 6573 7420 7b74     msg=f'Test {t
+000117d0: 6573 747d 206e 6f74 2072 6563 6f67 6e69  est} not recogni
+000117e0: 7a65 642e 204f 7074 696f 6e73 3a20 7b74  zed. Options: {t
+000117f0: 7970 655f 6869 6e74 735b 2274 6573 7422  ype_hints["test"
+00011800: 5d7d 270a 2020 2020 2020 2020 2020 2020  ]}'.            
+00011810: 290a 2020 2020 2020 2020 666f 7220 6920  ).        for i 
+00011820: 696e 2072 616e 6765 2874 696d 655f 7769  in range(time_wi
+00011830: 6e64 6f77 732e 7368 6170 655b 305d 293a  ndows.shape[0]):
+00011840: 0a20 2020 2020 2020 2020 2020 2077 696e  .            win
+00011850: 646f 775f 7369 7a65 203d 2069 6e74 2874  dow_size = int(t
+00011860: 696d 655f 7769 6e64 6f77 735b 695d 202a  ime_windows[i] *
+00011870: 2073 616d 706c 655f 7261 7465 290a 2020   sample_rate).  
+00011880: 2020 2020 2020 2020 2020 7374 7269 6465            stride
+00011890: 645f 6461 7461 203d 2061 735f 7374 7269  d_data = as_stri
+000118a0: 6465 6428 0a20 2020 2020 2020 2020 2020  ded(.           
+000118b0: 2020 2020 2064 6174 612c 0a20 2020 2020       data,.     
+000118c0: 2020 2020 2020 2020 2020 2073 6861 7065             shape
+000118d0: 3d28 6461 7461 2e73 6861 7065 5b30 5d20  =(data.shape[0] 
+000118e0: 2d20 7769 6e64 6f77 5f73 697a 6520 2b20  - window_size + 
+000118f0: 312c 2077 696e 646f 775f 7369 7a65 292c  1, window_size),
+00011900: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011910: 2073 7472 6964 6573 3d28 6461 7461 2e73   strides=(data.s
+00011920: 7472 6964 6573 5b30 5d20 2a20 312c 2064  trides[0] * 1, d
+00011930: 6174 612e 7374 7269 6465 735b 305d 292c  ata.strides[0]),
+00011940: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00011950: 2020 2020 2020 2020 2020 2077 6974 6820             with 
+00011960: 6d75 6c74 6970 726f 6365 7373 696e 672e  multiprocessing.
+00011970: 506f 6f6c 2866 696e 645f 636f 7265 5f63  Pool(find_core_c
+00011980: 6e74 2829 5b30 5d2c 206d 6178 7461 736b  nt()[0], maxtask
+00011990: 7370 6572 6368 696c 643d 3130 2920 6173  sperchild=10) as
+000119a0: 2070 6f6f 6c3a 0a20 2020 2020 2020 2020   pool:.         
+000119b0: 2020 2020 2020 2066 6f72 2063 6e74 2c20         for cnt, 
+000119c0: 7265 7375 6c74 2069 6e20 656e 756d 6572  result in enumer
+000119d0: 6174 6528 0a20 2020 2020 2020 2020 2020  ate(.           
+000119e0: 2020 2020 2020 2020 2070 6f6f 6c2e 696d           pool.im
+000119f0: 6170 2874 6573 745f 6675 6e63 2c20 7374  ap(test_func, st
+00011a00: 7269 6465 645f 6461 7461 2c20 6368 756e  rided_data, chun
+00011a10: 6b73 697a 653d 3129 0a20 2020 2020 2020  ksize=1).       
+00011a20: 2020 2020 2020 2020 2029 3a0a 2020 2020           ):.    
+00011a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011a40: 7374 6174 5b63 6e74 202b 2077 696e 646f  stat[cnt + windo
+00011a50: 775f 7369 7a65 202d 2031 2c20 695d 203d  w_size - 1, i] =
+00011a60: 2072 6573 756c 745b 305d 0a20 2020 2020   result[0].     
+00011a70: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00011a80: 5f76 616c 735b 636e 7420 2b20 7769 6e64  _vals[cnt + wind
+00011a90: 6f77 5f73 697a 6520 2d20 312c 2069 5d20  ow_size - 1, i] 
+00011aa0: 3d20 7265 7375 6c74 5b31 5d0a 0a20 2020  = result[1]..   
+00011ab0: 2020 2020 2072 6574 7572 6e20 7374 6174       return stat
+00011ac0: 2c20 705f 7661 6c73 0a0a 2020 2020 4073  , p_vals..    @s
+00011ad0: 7461 7469 636d 6574 686f 640a 2020 2020  taticmethod.    
+00011ae0: 406e 6a69 7428 0a20 2020 2020 2020 205b  @njit(.        [
+00011af0: 0a20 2020 2020 2020 2020 2020 2022 2866  .            "(f
+00011b00: 6c6f 6174 3332 5b3a 5d2c 2066 6c6f 6174  loat32[:], float
+00011b10: 3634 2c20 696e 7436 342c 2066 6c6f 6174  64, int64, float
+00011b20: 3634 2c20 7479 7065 732e 756e 6963 6f64  64, types.unicod
+00011b30: 655f 7479 7065 2922 2c0a 2020 2020 2020  e_type)",.      
+00011b40: 2020 2020 2020 2728 666c 6f61 7433 325b        '(float32[
+00011b50: 3a5d 2c20 666c 6f61 7436 342c 2069 6e74  :], float64, int
+00011b60: 3634 2c20 666c 6f61 7436 342c 2074 7970  64, float64, typ
+00011b70: 6573 2e6d 6973 632e 4f6d 6974 7465 6428  es.misc.Omitted(
+00011b80: 226d 6d22 2929 272c 0a20 2020 2020 2020  "mm"))',.       
+00011b90: 2020 2020 2022 2866 6c6f 6174 3332 5b3a       "(float32[:
+00011ba0: 5d2c 2066 6c6f 6174 3634 2c20 696e 7436  ], float64, int6
+00011bb0: 342c 2074 7970 6573 2e6d 6973 632e 4f6d  4, types.misc.Om
+00011bc0: 6974 7465 6428 3129 2c20 7479 7065 732e  itted(1), types.
+00011bd0: 756e 6963 6f64 655f 7479 7065 2922 2c0a  unicode_type)",.
+00011be0: 2020 2020 2020 2020 2020 2020 2728 666c              '(fl
+00011bf0: 6f61 7433 325b 3a5d 2c20 666c 6f61 7436  oat32[:], float6
+00011c00: 342c 2069 6e74 3634 2c20 7479 7065 732e  4, int64, types.
+00011c10: 6d69 7363 2e4f 6d69 7474 6564 2831 292c  misc.Omitted(1),
+00011c20: 2074 7970 6573 2e6d 6973 632e 4f6d 6974   types.misc.Omit
+00011c30: 7465 6428 226d 6d22 2929 272c 0a20 2020  ted("mm"))',.   
+00011c40: 2020 2020 205d 0a20 2020 2029 0a20 2020       ].    ).   
+00011c50: 2064 6566 2061 6363 656c 6572 6174 696f   def acceleratio
+00011c60: 6e28 0a20 2020 2020 2020 2064 6174 613a  n(.        data:
+00011c70: 206e 702e 6e64 6172 7261 792c 0a20 2020   np.ndarray,.   
+00011c80: 2020 2020 2070 6978 656c 735f 7065 725f       pixels_per_
+00011c90: 6d6d 3a20 666c 6f61 742c 0a20 2020 2020  mm: float,.     
+00011ca0: 2020 2066 7073 3a20 696e 742c 0a20 2020     fps: int,.   
+00011cb0: 2020 2020 2074 696d 655f 7769 6e64 6f77       time_window
+00011cc0: 3a20 666c 6f61 7420 3d20 312c 0a20 2020  : float = 1,.   
+00011cd0: 2020 2020 2075 6e69 743a 204c 6974 6572       unit: Liter
+00011ce0: 616c 5b22 6d6d 222c 2022 636d 222c 2022  al["mm", "cm", "
+00011cf0: 646d 222c 2022 6d22 5d20 3d20 226d 6d22  dm", "m"] = "mm"
+00011d00: 2c0a 2020 2020 2920 2d3e 206e 702e 6e64  ,.    ) -> np.nd
+00011d10: 6172 7261 793a 0a20 2020 2020 2020 2022  array:.        "
+00011d20: 2222 0a20 2020 2020 2020 2043 6f6d 7075  "".        Compu
+00011d30: 7465 2061 6363 656c 6572 6174 696f 6e2e  te acceleration.
+00011d40: 0a0a 2020 2020 2020 2020 436f 6d70 7574  ..        Comput
+00011d50: 6573 2061 6363 656c 6572 6174 696f 6e20  es acceleration 
+00011d60: 6672 6f6d 2061 2073 6571 7565 6e63 6520  from a sequence 
+00011d70: 6f66 2062 6f64 792d 7061 7274 2063 6f6f  of body-part coo
+00011d80: 7264 696e 6174 6573 206f 7665 7220 7469  rdinates over ti
+00011d90: 6d65 2e20 4974 2063 616c 6375 6c61 7465  me. It calculate
+00011da0: 7320 7468 6520 6469 6666 6572 656e 6365  s the difference
+00011db0: 2069 6e20 7665 6c6f 6369 7479 2062 6574   in velocity bet
+00011dc0: 7765 656e 2063 6f6e 7365 6375 7469 7665  ween consecutive
+00011dd0: 2066 7261 6d65 7320 616e 6420 7072 6f76   frames and prov
+00011de0: 6964 6573 2061 6e20 6172 7261 7920 6f66  ides an array of
+00011df0: 2061 6363 656c 6572 6174 696f 6e73 2e0a   accelerations..
+00011e00: 0a20 2020 2020 2020 2054 6865 2063 6f6d  .        The com
+00011e10: 7075 7461 7469 6f6e 2069 7320 6261 7365  putation is base
+00011e20: 6420 6f6e 2074 6865 2066 6f72 6d75 6c61  d on the formula
+00011e30: 3a0a 0a20 2020 2020 2020 202e 2e20 6d61  :..        .. ma
+00011e40: 7468 3a3a 0a0a 2020 2020 2020 2020 2020  th::..          
+00011e50: 205c 5c74 6578 747b 7b41 6363 656c 6572   \\text{{Acceler
+00011e60: 6174 696f 6e7d 7d28 7429 203d 205c 5c66  ation}}(t) = \\f
+00011e70: 7261 637b 7b5c 5c74 6578 747b 7b4e 6f72  rac{{\\text{{Nor
+00011e80: 6d7d 7d28 5c5c 7465 7874 7b7b 5368 6966  m}}(\\text{{Shif
+00011e90: 747d 7d28 5c5c 7465 7874 7b7b 6461 7461  t}}(\\text{{data
+00011ea0: 7d7d 5b74 5d2c 2074 2c20 742d 3129 202d  }}[t], t, t-1) -
+00011eb0: 205c 5c74 6578 747b 7b64 6174 617d 7d5b   \\text{{data}}[
+00011ec0: 745d 297d 7d7b 7b5c 5c74 6578 747b 7b70  t])}}{{\\text{{p
+00011ed0: 6978 656c 735c 5c5f 7065 725c 5c5f 6d6d  ixels\\_per\\_mm
+00011ee0: 7d7d 7d7d 0a0a 2020 2020 2020 2020 7768  }}}}..        wh
+00011ef0: 6572 6520 3a6d 6174 683a 605c 5c74 6578  ere :math:`\\tex
+00011f00: 747b 7b4e 6f72 6d7d 7d60 2063 616c 6375  t{{Norm}}` calcu
+00011f10: 6c61 7465 7320 7468 6520 4575 636c 6964  lates the Euclid
+00011f20: 6561 6e20 6e6f 726d 2c20 3a6d 6174 683a  ean norm, :math:
+00011f30: 605c 5c74 6578 747b 7b53 6869 6674 7d7d  `\\text{{Shift}}
+00011f40: 285c 5c74 6578 747b 7b61 7272 6179 7d7d  (\\text{{array}}
+00011f50: 2c20 742c 2074 2d31 2960 2073 6869 6674  , t, t-1)` shift
+00011f60: 7320 7468 6520 6172 7261 7920 6279 203a  s the array by :
+00011f70: 6d61 7468 3a60 742d 3160 2066 7261 6d65  math:`t-1` frame
+00011f80: 732c 2061 6e64 203a 6d61 7468 3a60 5c5c  s, and :math:`\\
+00011f90: 7465 7874 7b7b 7069 7865 6c73 5c5c 5f70  text{{pixels\\_p
+00011fa0: 6572 5c5c 5f6d 6d7d 7d60 2069 7320 7468  er\\_mm}}` is th
+00011fb0: 6520 636f 6e76 6572 7369 6f6e 2066 6163  e conversion fac
+00011fc0: 746f 7220 6672 6f6d 2070 6978 656c 7320  tor from pixels 
+00011fd0: 746f 206d 696c 6c69 6d65 7465 7273 2e0a  to millimeters..
+00011fe0: 0a20 2020 2020 2020 202e 2e20 6e6f 7465  .        .. note
+00011ff0: 3a3a 0a20 2020 2020 2020 2020 2020 4279  ::.           By
+00012000: 2064 6566 6175 6c74 2c20 6163 6365 6c65   default, accele
+00012010: 7261 7469 6f6e 2069 7320 6361 6c63 756c  ration is calcul
+00012020: 6174 6564 2061 7320 6368 616e 6765 2069  ated as change i
+00012030: 6e20 7665 6c6f 6369 7479 2061 7420 6d69  n velocity at mi
+00012040: 6c6c 696d 6574 6572 732f 732e 2054 6f20  llimeters/s. To 
+00012050: 6368 616e 6765 2074 6865 2064 656e 6f6d  change the denom
+00012060: 6974 6174 6f72 2c20 6d6f 6469 6679 2074  itator, modify t
+00012070: 6865 2060 6074 696d 655f 7769 6e64 6f77  he ``time_window
+00012080: 6060 2061 7267 756d 656e 742e 2054 6f20  `` argument. To 
+00012090: 6368 616e 6765 2074 6865 206e 6f6d 696e  change the nomin
+000120a0: 6174 6f72 2c20 6d6f 6469 6679 2074 6865  ator, modify the
+000120b0: 2060 6075 6e69 7460 6020 6172 6775 6d65   ``unit`` argume
+000120c0: 6e74 2028 6163 6365 7074 6564 2060 606d  nt (accepted ``m
+000120d0: 6d60 602c 2063 6d60 602c 2060 6064 6d60  m``, cm``, ``dm`
+000120e0: 602c 2060 606d 6d60 6029 0a0a 2020 2020  `, ``mm``)..    
+000120f0: 2020 2020 2e2e 2069 6d61 6765 3a3a 205f      .. image:: _
+00012100: 7374 6174 6963 2f69 6d67 2f61 6363 656c  static/img/accel
+00012110: 6572 6174 696f 6e2e 706e 670a 2020 2020  eration.png.    
+00012120: 2020 2020 2020 203a 7769 6474 683a 2037         :width: 7
+00012130: 3030 0a20 2020 2020 2020 2020 2020 3a61  00.           :a
+00012140: 6c69 676e 3a20 6365 6e74 6572 0a0a 2020  lign: center..  
+00012150: 2020 2020 2020 3a70 6172 616d 206e 702e        :param np.
+00012160: 6e64 6172 7261 7920 6461 7461 3a20 3144  ndarray data: 1D
+00012170: 2061 7272 6179 206f 6620 6672 616d 6577   array of framew
+00012180: 6973 6520 6575 636c 6964 6561 6e20 6469  ise euclidean di
+00012190: 7374 616e 6365 732e 0a20 2020 2020 2020  stances..       
+000121a0: 203a 7061 7261 6d20 666c 6f61 7420 7069   :param float pi
+000121b0: 7865 6c73 5f70 6572 5f6d 6d3a 2050 6978  xels_per_mm: Pix
+000121c0: 656c 7320 7065 7220 6d69 6c6c 696d 6574  els per millimet
+000121d0: 6572 206f 6620 7468 6520 7265 636f 7264  er of the record
+000121e0: 6564 2076 6964 656f 2e0a 2020 2020 2020  ed video..      
+000121f0: 2020 3a70 6172 616d 2069 6e74 2066 7073    :param int fps
+00012200: 3a20 4672 616d 6573 2070 6572 2073 6563  : Frames per sec
+00012210: 6f6e 6420 2846 5053 2920 6f66 2074 6865  ond (FPS) of the
+00012220: 2072 6563 6f72 6465 6420 7669 6465 6f2e   recorded video.
+00012230: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00012240: 666c 6f61 7420 7469 6d65 5f77 696e 646f  float time_windo
+00012250: 773a 2052 6f6c 6c69 6e67 2074 696d 6520  w: Rolling time 
+00012260: 7769 6e64 6f77 2069 6e20 7365 636f 6e64  window in second
+00012270: 732e 2044 6566 6175 6c74 2069 7320 312e  s. Default is 1.
+00012280: 3020 7265 7072 6573 656e 7469 6e67 2031  0 representing 1
+00012290: 2073 6563 6f6e 642e 0a20 2020 2020 2020   second..       
+000122a0: 203a 7061 7261 6d20 4c69 7465 7261 6c5b   :param Literal[
+000122b0: 276d 6d27 2c20 2763 6d27 2c20 2764 6d27  'mm', 'cm', 'dm'
+000122c0: 2c20 276d 275d 2075 6e69 743a 2020 4966  , 'm'] unit:  If
+000122d0: 2061 6363 656c 6572 6174 696f 6e20 7368   acceleration sh
+000122e0: 6f75 6c64 2062 6520 7072 6573 656e 7465  ould be presente
+000122f0: 6420 6173 206d 696c 6c69 6d65 7465 722c  d as millimeter,
+00012300: 2063 656e 7469 6d65 7465 7273 2c20 6465   centimeters, de
+00012310: 6369 6d65 7465 722c 206f 7220 6d65 7465  cimeter, or mete
+00012320: 722e 2044 6566 6175 6c74 206d 696c 6c69  r. Default milli
+00012330: 6d65 7465 7273 2e0a 2020 2020 2020 2020  meters..        
+00012340: 3a72 6574 7572 6e3a 2041 7272 6179 206f  :return: Array o
+00012350: 6620 6163 6365 6c65 7261 7469 6f6e 7320  f accelerations 
+00012360: 636f 7272 6573 706f 6e64 696e 6720 746f  corresponding to
+00012370: 2065 6163 6820 6672 616d 652e 0a0a 2020   each frame...  
+00012380: 2020 2020 2020 3a65 7861 6d70 6c65 3a0a        :example:.
+00012390: 2020 2020 2020 2020 3e3e 3e20 6461 7461          >>> data
+000123a0: 203d 206e 702e 6172 7261 7928 5b31 2c20   = np.array([1, 
+000123b0: 322c 2033 2c20 342c 2035 2c20 352c 2035  2, 3, 4, 5, 5, 5
+000123c0: 2c20 352c 2035 2c20 365d 292e 6173 7479  , 5, 5, 6]).asty
+000123d0: 7065 286e 702e 666c 6f61 7433 3229 0a20  pe(np.float32). 
+000123e0: 2020 2020 2020 203e 3e3e 2054 696d 6573         >>> Times
+000123f0: 6572 6965 7346 6561 7475 7265 4d69 7869  eriesFeatureMixi
+00012400: 6e28 292e 6163 6365 6c65 7261 7469 6f6e  n().acceleration
+00012410: 2864 6174 613d 6461 7461 2c20 7069 7865  (data=data, pixe
+00012420: 6c73 5f70 6572 5f6d 6d3d 312e 302c 2066  ls_per_mm=1.0, f
+00012430: 7073 3d32 2c20 7469 6d65 5f77 696e 646f  ps=2, time_windo
+00012440: 773d 312e 3029 0a20 2020 2020 2020 203e  w=1.0).        >
+00012450: 3e3e 205b 2030 2e2c 2020 302e 2c20 2030  >> [ 0.,  0.,  0
+00012460: 2e2c 2020 302e 2c20 2d31 2e2c 202d 312e  .,  0., -1., -1.
+00012470: 2c20 2030 2e2c 2020 302e 2c20 2031 2e2c  ,  0.,  0.,  1.,
+00012480: 2020 312e 5d0a 2020 2020 2020 2020 2222    1.].        ""
+00012490: 220a 0a20 2020 2020 2020 2072 6573 756c  "..        resul
+000124a0: 7473 2c20 7665 6c6f 6369 7479 203d 206e  ts, velocity = n
+000124b0: 702e 6675 6c6c 2828 6461 7461 2e73 6861  p.full((data.sha
+000124c0: 7065 5b30 5d29 2c20 302e 3029 2c20 6e70  pe[0]), 0.0), np
+000124d0: 2e66 756c 6c28 2864 6174 612e 7368 6170  .full((data.shap
+000124e0: 655b 305d 292c 2030 2e30 290a 2020 2020  e[0]), 0.0).    
+000124f0: 2020 2020 7369 7a65 2c20 7076 203d 2069      size, pv = i
+00012500: 6e74 2874 696d 655f 7769 6e64 6f77 202a  nt(time_window *
+00012510: 2066 7073 292c 204e 6f6e 650a 2020 2020   fps), None.    
+00012520: 2020 2020 6461 7461 5f73 706c 6974 203d      data_split =
+00012530: 206e 702e 7370 6c69 7428 6461 7461 2c20   np.split(data, 
+00012540: 6c69 7374 2872 616e 6765 2873 697a 652c  list(range(size,
+00012550: 2064 6174 612e 7368 6170 655b 305d 2c20   data.shape[0], 
+00012560: 7369 7a65 2929 290a 2020 2020 2020 2020  size))).        
+00012570: 666f 7220 6920 696e 2072 616e 6765 286c  for i in range(l
+00012580: 656e 2864 6174 615f 7370 6c69 7429 293a  en(data_split)):
+00012590: 0a20 2020 2020 2020 2020 2020 2077 5320  .            wS 
+000125a0: 3d20 696e 7428 7369 7a65 202a 2069 290a  = int(size * i).
+000125b0: 2020 2020 2020 2020 2020 2020 7745 203d              wE =
+000125c0: 2069 6e74 2877 5320 2b20 7369 7a65 290a   int(wS + size).
+000125d0: 2020 2020 2020 2020 2020 2020 7620 3d20              v = 
+000125e0: 6e70 2e64 6966 6628 6e70 2e61 7363 6f6e  np.diff(np.ascon
+000125f0: 7469 6775 6f75 7361 7272 6179 2864 6174  tiguousarray(dat
+00012600: 615f 7370 6c69 745b 695d 2929 5b30 5d20  a_split[i]))[0] 
+00012610: 2f20 7069 7865 6c73 5f70 6572 5f6d 6d0a  / pixels_per_mm.
+00012620: 2020 2020 2020 2020 2020 2020 6966 2075              if u
+00012630: 6e69 7420 3d3d 2022 636d 223a 0a20 2020  nit == "cm":.   
+00012640: 2020 2020 2020 2020 2020 2020 2076 203d               v =
+00012650: 2076 202f 2031 300a 2020 2020 2020 2020   v / 10.        
+00012660: 2020 2020 656c 6966 2075 6e69 7420 3d3d      elif unit ==
+00012670: 2022 646d 223a 0a20 2020 2020 2020 2020   "dm":.         
+00012680: 2020 2020 2020 2076 203d 2076 202f 2031         v = v / 1
+00012690: 3030 0a20 2020 2020 2020 2020 2020 2065  00.            e
+000126a0: 6c69 6620 756e 6974 203d 3d20 226d 223a  lif unit == "m":
+000126b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000126c0: 2076 203d 2076 202f 2031 3030 300a 2020   v = v / 1000.  
+000126d0: 2020 2020 2020 2020 2020 6966 2069 203d            if i =
+000126e0: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
+000126f0: 2020 2020 2072 6573 756c 7473 5b77 533a       results[wS:
+00012700: 7745 5d20 3d20 300a 2020 2020 2020 2020  wE] = 0.        
+00012710: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00012720: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+00012730: 735b 7753 3a77 455d 203d 2076 202d 2070  s[wS:wE] = v - p
+00012740: 760a 2020 2020 2020 2020 2020 2020 7076  v.            pv
+00012750: 203d 2076 0a20 2020 2020 2020 2072 6574   = v.        ret
+00012760: 7572 6e20 7265 7375 6c74 730a 0a20 2020  urn results..   
+00012770: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
+00012780: 2020 2064 6566 2067 7261 6e67 6572 5f74     def granger_t
+00012790: 6573 7473 280a 2020 2020 2020 2020 6461  ests(.        da
+000127a0: 7461 3a20 7064 2e44 6174 6146 7261 6d65  ta: pd.DataFrame
+000127b0: 2c0a 2020 2020 2020 2020 7661 7269 6162  ,.        variab
+000127c0: 6c65 733a 2074 7970 696e 672e 4c69 7374  les: typing.List
+000127d0: 5b73 7472 5d2c 0a20 2020 2020 2020 206c  [str],.        l
+000127e0: 6167 3a20 696e 742c 0a20 2020 2020 2020  ag: int,.       
+000127f0: 2074 6573 743a 204c 6974 6572 616c 5b0a   test: Literal[.
+00012800: 2020 2020 2020 2020 2020 2020 2273 7372              "ssr
+00012810: 5f66 7465 7374 222c 2022 7373 725f 6368  _ftest", "ssr_ch
+00012820: 6932 7465 7374 222c 2022 6c72 7465 7374  i2test", "lrtest
+00012830: 222c 2022 7061 7261 6d73 5f66 7465 7374  ", "params_ftest
+00012840: 220a 2020 2020 2020 2020 5d20 3d20 2273  ".        ] = "s
+00012850: 7372 5f63 6869 3274 6573 7422 2c0a 2020  sr_chi2test",.  
+00012860: 2020 2920 2d3e 2070 642e 4461 7461 4672    ) -> pd.DataFr
+00012870: 616d 653a 0a20 2020 2020 2020 2022 2222  ame:.        """
+00012880: 0a20 2020 2020 2020 2050 6572 666f 726d  .        Perform
+00012890: 2047 7261 6e67 6572 2063 6175 7361 6c69   Granger causali
+000128a0: 7479 2074 6573 7473 2062 6574 7765 656e  ty tests between
+000128b0: 2070 6169 7273 206f 6620 7661 7269 6162   pairs of variab
+000128c0: 6c65 7320 696e 2061 2044 6174 6146 7261  les in a DataFra
+000128d0: 6d65 2e0a 0a20 2020 2020 2020 2054 6869  me...        Thi
+000128e0: 7320 6675 6e63 7469 6f6e 2063 6f6d 7075  s function compu
+000128f0: 7465 7320 4772 616e 6765 7220 6361 7573  tes Granger caus
+00012900: 616c 6974 7920 7465 7374 7320 6265 7477  ality tests betw
+00012910: 6565 6e20 7061 6972 7320 6f66 2076 6172  een pairs of var
+00012920: 6961 626c 6573 2069 6e20 6120 4461 7461  iables in a Data
+00012930: 4672 616d 650a 2020 2020 2020 2020 7573  Frame.        us
+00012940: 696e 6720 7468 6520 7374 6174 736d 6f64  ing the statsmod
+00012950: 656c 7320 6c69 6272 6172 792e 2054 6865  els library. The
+00012960: 2047 7261 6e67 6572 2063 6175 7361 6c69   Granger causali
+00012970: 7479 2074 6573 7420 6173 7365 7373 6573  ty test assesses
+00012980: 2077 6865 7468 6572 206f 6e65 2074 696d   whether one tim
+00012990: 6520 7365 7269 6573 0a20 2020 2020 2020  e series.       
+000129a0: 2076 6172 6961 626c 6520 2870 7265 6469   variable (predi
+000129b0: 6374 6f72 2920 6361 6e20 7072 6564 6963  ctor) can predic
+000129c0: 7420 616e 6f74 6865 7220 7469 6d65 2073  t another time s
+000129d0: 6572 6965 7320 7661 7269 6162 6c65 2028  eries variable (
+000129e0: 6f75 7463 6f6d 6529 2e20 5468 6973 2074  outcome). This t
+000129f0: 6573 7420 6361 6e20 6865 6c70 0a20 2020  est can help.   
+00012a00: 2020 2020 2064 6574 6572 6d69 6e65 2074       determine t
+00012a10: 6865 2070 7265 7365 6e63 6520 6f66 2063  he presence of c
+00012a20: 6175 7361 6c20 7265 6c61 7469 6f6e 7368  ausal relationsh
+00012a30: 6970 7320 6265 7477 6565 6e20 7661 7269  ips between vari
+00012a40: 6162 6c65 732e 0a0a 2020 2020 2020 2020  ables...        
+00012a50: 2e2e 206e 6f74 653a 3a0a 2020 2020 2020  .. note::.      
+00012a60: 2020 2020 204d 6f64 6966 6965 6420 6672       Modified fr
+00012a70: 6f6d 2060 5365 6c76 6120 5072 6162 6861  om `Selva Prabha
+00012a80: 6b61 7261 6e20 3c68 7474 7073 3a2f 2f77  karan <https://w
+00012a90: 7777 2e6d 6163 6869 6e65 6c65 6172 6e69  ww.machinelearni
+00012aa0: 6e67 706c 7573 2e63 6f6d 2f74 696d 652d  ngplus.com/time-
+00012ab0: 7365 7269 6573 2f67 7261 6e67 6572 2d63  series/granger-c
+00012ac0: 6175 7361 6c69 7479 2d74 6573 742d 696e  ausality-test-in
+00012ad0: 2d70 7974 686f 6e2f 3e60 5f2e 0a0a 2020  -python/>`_...  
+00012ae0: 2020 2020 2020 3a65 7861 6d70 6c65 3a0a        :example:.
+00012af0: 2020 2020 2020 2020 3e3e 3e20 7820 3d20          >>> x = 
+00012b00: 6e70 2e72 616e 646f 6d2e 7261 6e64 696e  np.random.randin
+00012b10: 7428 302c 2035 302c 2028 3130 302c 2032  t(0, 50, (100, 2
+00012b20: 2929 0a20 2020 2020 2020 203e 3e3e 2064  )).        >>> d
+00012b30: 6174 6120 3d20 7064 2e44 6174 6146 7261  ata = pd.DataFra
+00012b40: 6d65 2878 2c20 636f 6c75 6d6e 733d 5b27  me(x, columns=['
+00012b50: 7227 2c20 276b 275d 290a 2020 2020 2020  r', 'k']).      
+00012b60: 2020 3e3e 3e20 5469 6d65 7365 7269 6573    >>> Timeseries
+00012b70: 4665 6174 7572 654d 6978 696e 2e67 7261  FeatureMixin.gra
+00012b80: 6e67 6572 5f74 6573 7473 2864 6174 613d  nger_tests(data=
+00012b90: 6461 7461 2c20 7661 7269 6162 6c65 733d  data, variables=
+00012ba0: 5b27 7227 2c20 276b 275d 2c20 6c61 673d  ['r', 'k'], lag=
+00012bb0: 342c 2074 6573 743d 2773 7372 5f63 6869  4, test='ssr_chi
+00012bc0: 3274 6573 7427 290a 2020 2020 2020 2020  2test').        
+00012bd0: 3e3e 3e20 2020 2020 7220 2020 2020 2020  >>>     r       
+00012be0: 2020 2020 6b0a 2020 2020 2020 2020 3e3e      k.        >>
+00012bf0: 3e20 2020 2020 7220 2031 2e30 3030 3020  >     r  1.0000 
+00012c00: 2030 2e34 3331 320a 2020 2020 2020 2020   0.4312.        
+00012c10: 3e3e 3e20 2020 2020 6b20 2030 2e33 3130  >>>     k  0.310
+00012c20: 3220 2031 2e30 3030 300a 2020 2020 2020  2  1.0000.      
+00012c30: 2020 2222 220a 2020 2020 2020 2020 6368    """.        ch
+00012c40: 6563 6b5f 696e 7374 616e 6365 280a 2020  eck_instance(.  
+00012c50: 2020 2020 2020 2020 2020 736f 7572 6365            source
+00012c60: 3d54 696d 6573 6572 6965 7346 6561 7475  =TimeseriesFeatu
+00012c70: 7265 4d69 7869 6e2e 6772 616e 6765 725f  reMixin.granger_
+00012c80: 7465 7374 732e 5f5f 6e61 6d65 5f5f 2c0a  tests.__name__,.
+00012c90: 2020 2020 2020 2020 2020 2020 696e 7374              inst
+00012ca0: 616e 6365 3d64 6174 612c 0a20 2020 2020  ance=data,.     
+00012cb0: 2020 2020 2020 2061 6363 6570 7465 645f         accepted_
+00012cc0: 7479 7065 733d 2870 642e 4461 7461 4672  types=(pd.DataFr
+00012cd0: 616d 652c 292c 0a20 2020 2020 2020 2029  ame,),.        )
+00012ce0: 0a20 2020 2020 2020 2063 6865 636b 5f76  .        check_v
+00012cf0: 616c 6964 5f6c 7374 280a 2020 2020 2020  alid_lst(.      
+00012d00: 2020 2020 2020 6461 7461 3d76 6172 6961        data=varia
+00012d10: 626c 6573 2c0a 2020 2020 2020 2020 2020  bles,.          
+00012d20: 2020 736f 7572 6365 3d54 696d 6573 6572    source=Timeser
+00012d30: 6965 7346 6561 7475 7265 4d69 7869 6e2e  iesFeatureMixin.
+00012d40: 6772 616e 6765 725f 7465 7374 732e 5f5f  granger_tests.__
+00012d50: 6e61 6d65 5f5f 2c0a 2020 2020 2020 2020  name__,.        
+00012d60: 2020 2020 7661 6c69 645f 6474 7970 6573      valid_dtypes
+00012d70: 3d28 7374 722c 292c 0a20 2020 2020 2020  =(str,),.       
+00012d80: 2020 2020 206d 696e 5f6c 656e 3d32 2c0a       min_len=2,.
+00012d90: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00012da0: 2020 6368 6563 6b5f 7468 6174 5f63 6f6c    check_that_col
+00012db0: 756d 6e5f 6578 6973 7428 6466 3d64 6174  umn_exist(df=dat
+00012dc0: 612c 2063 6f6c 756d 6e5f 6e61 6d65 3d76  a, column_name=v
+00012dd0: 6172 6961 626c 6573 2c20 6669 6c65 5f6e  ariables, file_n
+00012de0: 616d 653d 2222 290a 2020 2020 2020 2020  ame="").        
+00012df0: 6368 6563 6b5f 7374 7228 0a20 2020 2020  check_str(.     
+00012e00: 2020 2020 2020 206e 616d 653d 5469 6d65         name=Time
+00012e10: 7365 7269 6573 4665 6174 7572 654d 6978  seriesFeatureMix
+00012e20: 696e 2e67 7261 6e67 6572 5f74 6573 7473  in.granger_tests
+00012e30: 2e5f 5f6e 616d 655f 5f2c 0a20 2020 2020  .__name__,.     
+00012e40: 2020 2020 2020 2076 616c 7565 3d74 6573         value=tes
+00012e50: 742c 0a20 2020 2020 2020 2020 2020 206f  t,.            o
+00012e60: 7074 696f 6e73 3d28 2273 7372 5f66 7465  ptions=("ssr_fte
+00012e70: 7374 222c 2022 7373 725f 6368 6932 7465  st", "ssr_chi2te
+00012e80: 7374 222c 2022 6c72 7465 7374 222c 2022  st", "lrtest", "
+00012e90: 7061 7261 6d73 5f66 7465 7374 2229 2c0a  params_ftest"),.
+00012ea0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00012eb0: 2020 6368 6563 6b5f 696e 7428 0a20 2020    check_int(.   
+00012ec0: 2020 2020 2020 2020 206e 616d 653d 5469           name=Ti
+00012ed0: 6d65 7365 7269 6573 4665 6174 7572 654d  meseriesFeatureM
+00012ee0: 6978 696e 2e67 7261 6e67 6572 5f74 6573  ixin.granger_tes
+00012ef0: 7473 2e5f 5f6e 616d 655f 5f2c 2076 616c  ts.__name__, val
+00012f00: 7565 3d6c 6167 2c20 6d69 6e5f 7661 6c75  ue=lag, min_valu
+00012f10: 653d 310a 2020 2020 2020 2020 290a 2020  e=1.        ).  
+00012f20: 2020 2020 2020 6466 203d 2070 642e 4461        df = pd.Da
+00012f30: 7461 4672 616d 6528 0a20 2020 2020 2020  taFrame(.       
+00012f40: 2020 2020 206e 702e 7a65 726f 7328 286c       np.zeros((l
+00012f50: 656e 2876 6172 6961 626c 6573 292c 206c  en(variables), l
+00012f60: 656e 2876 6172 6961 626c 6573 2929 292c  en(variables))),
+00012f70: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
+00012f80: 756d 6e73 3d76 6172 6961 626c 6573 2c0a  umns=variables,.
+00012f90: 2020 2020 2020 2020 2020 2020 696e 6465              inde
+00012fa0: 783d 7661 7269 6162 6c65 732c 0a20 2020  x=variables,.   
+00012fb0: 2020 2020 2029 0a20 2020 2020 2020 2066       ).        f
+00012fc0: 6f72 2063 2c20 7220 696e 2069 7465 7274  or c, r in itert
+00012fd0: 6f6f 6c73 2e70 726f 6475 6374 2864 662e  ools.product(df.
+00012fe0: 636f 6c75 6d6e 732c 2064 662e 696e 6465  columns, df.inde
+00012ff0: 7829 3a0a 2020 2020 2020 2020 2020 2020  x):.            
+00013000: 7265 7375 6c74 203d 2067 7261 6e67 6572  result = granger
+00013010: 6361 7573 616c 6974 7974 6573 7473 2864  causalitytests(d
+00013020: 6174 615b 5b72 2c20 635d 5d2c 206d 6178  ata[[r, c]], max
+00013030: 6c61 673d 5b6c 6167 5d2c 2076 6572 626f  lag=[lag], verbo
+00013040: 7365 3d46 616c 7365 290a 2020 2020 2020  se=False).      
+00013050: 2020 2020 2020 705f 7661 6c20 3d20 6d69        p_val = mi
+00013060: 6e28 5b72 6f75 6e64 2872 6573 756c 745b  n([round(result[
+00013070: 6c61 675d 5b30 5d5b 7465 7374 5d5b 315d  lag][0][test][1]
+00013080: 2c20 3429 2066 6f72 2069 2069 6e20 7261  , 4) for i in ra
+00013090: 6e67 6528 3129 5d29 0a20 2020 2020 2020  nge(1)]).       
+000130a0: 2020 2020 2064 662e 6c6f 635b 722c 2063       df.loc[r, c
+000130b0: 5d20 3d20 705f 7661 6c0a 2020 2020 2020  ] = p_val.      
+000130c0: 2020 7265 7475 726e 2064 660a 0a20 2020    return df..   
+000130d0: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
+000130e0: 2020 2040 6e6a 6974 2822 2869 6e74 3332     @njit("(int32
+000130f0: 5b3a 2c3a 5d2c 2066 6c6f 6174 3634 5b3a  [:,:], float64[:
+00013100: 5d2c 2066 6c6f 6174 3634 2c20 666c 6f61  ], float64, floa
+00013110: 7436 3429 2229 0a20 2020 2064 6566 2073  t64)").    def s
+00013120: 6c69 6469 6e67 5f64 6973 706c 6163 656d  liding_displacem
+00013130: 656e 7428 0a20 2020 2020 2020 2078 3a20  ent(.        x: 
+00013140: 6e70 2e6e 6461 7272 6179 2c20 7469 6d65  np.ndarray, time
+00013150: 5f77 696e 646f 7773 3a20 6e70 2e6e 6461  _windows: np.nda
+00013160: 7272 6179 2c20 6670 733a 2066 6c6f 6174  rray, fps: float
+00013170: 2c20 7078 5f70 6572 5f6d 6d3a 2066 6c6f  , px_per_mm: flo
+00013180: 6174 0a20 2020 2029 202d 3e20 6e70 2e6e  at.    ) -> np.n
+00013190: 6461 7272 6179 3a0a 2020 2020 2020 2020  darray:.        
+000131a0: 2222 220a 2020 2020 2020 2020 4361 6c63  """.        Calc
+000131b0: 756c 6174 6520 736c 6964 696e 6720 4575  ulate sliding Eu
+000131c0: 636c 6964 6561 6e20 6469 7370 6c61 6365  clidean displace
+000131d0: 6d65 6e74 206f 6620 6120 626f 6479 2d70  ment of a body-p
+000131e0: 6172 7420 706f 696e 7420 6f76 6572 2074  art point over t
+000131f0: 696d 6520 7769 6e64 6f77 732e 0a0a 2020  ime windows...  
+00013200: 2020 2020 2020 2e2e 2069 6d61 6765 3a3a        .. image::
+00013210: 205f 7374 6174 6963 2f69 6d67 2f73 6c69   _static/img/sli
+00013220: 6469 6e67 5f64 6973 706c 6163 656d 656e  ding_displacemen
+00013230: 742e 706e 670a 2020 2020 2020 2020 2020  t.png.          
+00013240: 203a 7769 6474 683a 2036 3030 0a20 2020   :width: 600.   
+00013250: 2020 2020 2020 2020 3a61 6c69 676e 3a20          :align: 
+00013260: 6365 6e74 6572 0a0a 2020 2020 2020 2020  center..        
+00013270: 3a70 6172 616d 206e 702e 6e64 6172 7261  :param np.ndarra
+00013280: 7920 783a 2041 6e20 6172 7261 7920 6f66  y x: An array of
+00013290: 2073 6861 7065 2028 6e2c 2032 2920 7265   shape (n, 2) re
+000132a0: 7072 6573 656e 7469 6e67 2074 6865 2074  presenting the t
+000132b0: 696d 652d 7365 7269 6573 2073 6571 7565  ime-series seque
+000132c0: 6e63 6520 6f66 2032 4420 706f 696e 7473  nce of 2D points
+000132d0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000132e0: 206e 702e 6e64 6172 7261 7920 7469 6d65   np.ndarray time
+000132f0: 5f77 696e 646f 7773 3a20 4172 7261 7920  _windows: Array 
+00013300: 6f66 2074 696d 6520 7769 6e64 6f77 7320  of time windows 
+00013310: 2869 6e20 7365 636f 6e64 7329 2e0a 2020  (in seconds)..  
+00013320: 2020 2020 2020 3a70 6172 616d 2066 6c6f        :param flo
+00013330: 6174 2066 7073 3a20 5468 6520 7361 6d70  at fps: The samp
+00013340: 6c65 2072 6174 6520 2866 7261 6d65 7320  le rate (frames 
+00013350: 7065 7220 7365 636f 6e64 2920 6f66 2074  per second) of t
+00013360: 6865 2073 6571 7565 6e63 652e 0a20 2020  he sequence..   
+00013370: 2020 2020 203a 7061 7261 6d20 666c 6f61       :param floa
+00013380: 7420 7078 5f70 6572 5f6d 6d3a 2050 6978  t px_per_mm: Pix
+00013390: 656c 7320 7065 7220 6d69 6c6c 696d 6574  els per millimet
+000133a0: 6572 2063 6f6e 7665 7273 696f 6e20 6661  er conversion fa
+000133b0: 6374 6f72 2e0a 2020 2020 2020 2020 3a72  ctor..        :r
+000133c0: 6574 7572 6e20 6e70 2e6e 6461 7272 6179  eturn np.ndarray
+000133d0: 3a20 3144 2061 7272 6179 2063 6f6e 7461  : 1D array conta
+000133e0: 696e 696e 6720 7468 6520 6361 6c63 756c  ining the calcul
+000133f0: 6174 6564 2064 6973 706c 6163 656d 656e  ated displacemen
+00013400: 7473 2e0a 0a20 2020 2020 2020 203a 6578  ts...        :ex
+00013410: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
+00013420: 3e3e 2078 203d 206e 702e 7261 6e64 6f6d  >> x = np.random
+00013430: 2e72 616e 6469 6e74 2830 2c20 3530 2c20  .randint(0, 50, 
+00013440: 2831 3030 2c20 3229 292e 6173 7479 7065  (100, 2)).astype
+00013450: 286e 702e 696e 7433 3229 0a20 2020 2020  (np.int32).     
+00013460: 2020 203e 3e3e 2054 696d 6573 6572 6965     >>> Timeserie
+00013470: 7346 6561 7475 7265 4d69 7869 6e2e 736c  sFeatureMixin.sl
+00013480: 6964 696e 675f 6469 7370 6c61 6365 6d65  iding_displaceme
+00013490: 6e74 2878 3d78 2c20 7469 6d65 5f77 696e  nt(x=x, time_win
+000134a0: 646f 7773 3d6e 702e 6172 7261 7928 5b31  dows=np.array([1
+000134b0: 2e30 5d29 2c20 6670 733d 312e 302c 2070  .0]), fps=1.0, p
+000134c0: 785f 7065 725f 6d6d 3d31 2e30 290a 2020  x_per_mm=1.0).  
+000134d0: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+000134e0: 2020 2072 6573 756c 7473 203d 206e 702e     results = np.
+000134f0: 6675 6c6c 2828 782e 7368 6170 655b 305d  full((x.shape[0]
+00013500: 2c20 7469 6d65 5f77 696e 646f 7773 2e73  , time_windows.s
+00013510: 6861 7065 5b30 5d29 2c20 2d31 2e30 290a  hape[0]), -1.0).
+00013520: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+00013530: 2072 616e 6765 2874 696d 655f 7769 6e64   range(time_wind
+00013540: 6f77 732e 7368 6170 655b 305d 293a 0a20  ows.shape[0]):. 
+00013550: 2020 2020 2020 2020 2020 2077 203d 2069             w = i
+00013560: 6e74 2874 696d 655f 7769 6e64 6f77 735b  nt(time_windows[
+00013570: 695d 202a 2066 7073 290a 2020 2020 2020  i] * fps).      
+00013580: 2020 2020 2020 666f 7220 6a20 696e 2072        for j in r
+00013590: 616e 6765 2877 2c20 782e 7368 6170 655b  ange(w, x.shape[
+000135a0: 305d 293a 0a20 2020 2020 2020 2020 2020  0]):.           
+000135b0: 2020 2020 2063 2c20 7320 3d20 785b 6a5d       c, s = x[j]
+000135c0: 2c20 785b 6a20 2d20 775d 0a20 2020 2020  , x[j - w].     
+000135d0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+000135e0: 7473 5b6a 2c20 695d 203d 2028 0a20 2020  ts[j, i] = (.   
+000135f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013600: 206e 702e 7371 7274 2828 735b 305d 202d   np.sqrt((s[0] -
+00013610: 2063 5b30 5d29 202a 2a20 3220 2b20 2873   c[0]) ** 2 + (s
+00013620: 5b31 5d20 2d20 635b 315d 2920 2a2a 2032  [1] - c[1]) ** 2
+00013630: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00013640: 2020 2920 2f20 7078 5f70 6572 5f6d 6d0a    ) / px_per_mm.
+00013650: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+00013660: 6573 756c 7473 2e61 7374 7970 6528 6e70  esults.astype(np
+00013670: 2e66 6c6f 6174 3332 290a 0a20 2020 2040  .float32)..    @
+00013680: 7374 6174 6963 6d65 7468 6f64 0a20 2020  staticmethod.   
+00013690: 2040 6e6a 6974 2822 2866 6c6f 6174 3634   @njit("(float64
+000136a0: 5b3a 5d2c 2066 6c6f 6174 3634 5b3a 5d2c  [:], float64[:],
+000136b0: 2066 6c6f 6174 3634 5b3a 5d2c 2066 6c6f   float64[:], flo
+000136c0: 6174 3634 2c20 626f 6f6c 6561 6e2c 2066  at64, boolean, f
+000136d0: 6c6f 6174 3634 2922 290a 2020 2020 6465  loat64)").    de
+000136e0: 6620 736c 6964 696e 675f 7477 6f5f 7369  f sliding_two_si
+000136f0: 676e 616c 5f63 726f 7373 636f 7272 656c  gnal_crosscorrel
+00013700: 6174 696f 6e28 0a20 2020 2020 2020 2078  ation(.        x
+00013710: 3a20 6e70 2e6e 6461 7272 6179 2c0a 2020  : np.ndarray,.  
+00013720: 2020 2020 2020 793a 206e 702e 6e64 6172        y: np.ndar
+00013730: 7261 792c 0a20 2020 2020 2020 2077 696e  ray,.        win
+00013740: 646f 7773 3a20 6e70 2e6e 6461 7272 6179  dows: np.ndarray
+00013750: 2c0a 2020 2020 2020 2020 7361 6d70 6c65  ,.        sample
+00013760: 5f72 6174 653a 2066 6c6f 6174 2c0a 2020  _rate: float,.  
+00013770: 2020 2020 2020 6e6f 726d 616c 697a 653a        normalize:
+00013780: 2062 6f6f 6c2c 0a20 2020 2020 2020 206c   bool,.        l
+00013790: 6167 3a20 666c 6f61 742c 0a20 2020 2029  ag: float,.    )
+000137a0: 202d 3e20 6e70 2e6e 6461 7272 6179 3a0a   -> np.ndarray:.
+000137b0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000137c0: 2020 2020 4361 6c63 756c 6174 6520 736c      Calculate sl
+000137d0: 6964 696e 6720 286c 6167 6765 6429 2063  iding (lagged) c
+000137e0: 726f 7373 2d63 6f72 7265 6c61 7469 6f6e  ross-correlation
+000137f0: 2062 6574 7765 656e 2074 776f 2073 6967   between two sig
+00013800: 6e61 6c73 2c20 652e 672e 2c20 7468 6520  nals, e.g., the 
+00013810: 6d6f 7665 6d65 6e74 2061 6e64 2076 656c  movement and vel
+00013820: 6f63 6974 7920 6f66 2074 776f 2061 6e69  ocity of two ani
+00013830: 6d61 6c73 2e0a 0a20 2020 2020 2020 202e  mals...        .
+00013840: 2e20 6e6f 7465 3a3a 0a20 2020 2020 2020  . note::.       
+00013850: 2020 2020 2049 6620 6e6f 206c 6167 206e       If no lag n
+00013860: 6565 6465 642c 2070 6173 7320 6c61 6720  eeded, pass lag 
+00013870: 302e 302e 0a0a 2020 2020 2020 2020 3a70  0.0...        :p
+00013880: 6172 616d 206e 702e 6e64 6172 7261 7920  aram np.ndarray 
+00013890: 783a 2054 6865 2066 6972 7374 2069 6e70  x: The first inp
+000138a0: 7574 2073 6967 6e61 6c2e 0a20 2020 2020  ut signal..     
+000138b0: 2020 203a 7061 7261 6d20 6e70 2e6e 6461     :param np.nda
+000138c0: 7272 6179 2079 3a20 5468 6520 7365 636f  rray y: The seco
+000138d0: 6e64 2069 6e70 7574 2073 6967 6e61 6c2e  nd input signal.
+000138e0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+000138f0: 6e70 2e6e 6461 7272 6179 2077 696e 646f  np.ndarray windo
+00013900: 7773 3a20 4172 7261 7920 6f66 2077 696e  ws: Array of win
+00013910: 646f 7720 6c65 6e67 7468 7320 696e 2073  dow lengths in s
+00013920: 6563 6f6e 6473 2e0a 2020 2020 2020 2020  econds..        
+00013930: 3a70 6172 616d 2066 6c6f 6174 2073 616d  :param float sam
+00013940: 706c 655f 7261 7465 3a20 5361 6d70 6c69  ple_rate: Sampli
+00013950: 6e67 2072 6174 6520 6f66 2074 6865 2073  ng rate of the s
+00013960: 6967 6e61 6c73 2028 696e 2048 7a20 6f72  ignals (in Hz or
+00013970: 2046 5053 292e 0a20 2020 2020 2020 203a   FPS)..        :
+00013980: 7061 7261 6d20 626f 6f6c 206e 6f72 6d61  param bool norma
+00013990: 6c69 7a65 3a20 4966 2054 7275 652c 206e  lize: If True, n
+000139a0: 6f72 6d61 6c69 7a65 2074 6865 2073 6967  ormalize the sig
+000139b0: 6e61 6c73 2062 6566 6f72 6520 636f 6d70  nals before comp
+000139c0: 7574 696e 6720 7468 6520 636f 7272 656c  uting the correl
+000139d0: 6174 696f 6e2e 0a20 2020 2020 2020 203a  ation..        :
+000139e0: 7061 7261 6d20 666c 6f61 7420 6c61 673a  param float lag:
+000139f0: 2054 696d 6520 6c61 6720 6265 7477 6565   Time lag betwee
+00013a00: 6e20 7468 6520 7369 676e 616c 7320 696e  n the signals in
+00013a10: 2073 6563 6f6e 6473 2e0a 0a20 2020 2020   seconds...     
+00013a20: 2020 203a 7265 7475 726e 3a20 3244 2061     :return: 2D a
+00013a30: 7272 6179 206f 6620 736c 6964 696e 6720  rray of sliding 
+00013a40: 6372 6f73 732d 636f 7272 656c 6174 696f  cross-correlatio
+00013a50: 6e20 7661 6c75 6573 2e20 4561 6368 2072  n values. Each r
+00013a60: 6f77 2063 6f72 7265 7370 6f6e 6473 2074  ow corresponds t
+00013a70: 6f20 6120 7469 6d65 2069 6e64 6578 2c20  o a time index, 
+00013a80: 616e 6420 6561 6368 2063 6f6c 756d 6e20  and each column 
+00013a90: 636f 7272 6573 706f 6e64 7320 746f 2061  corresponds to a
+00013aa0: 2077 696e 646f 7720 7369 7a65 2073 7065   window size spe
+00013ab0: 6369 6669 6564 2069 6e20 7468 6520 6077  cified in the `w
+00013ac0: 696e 646f 7773 6020 7061 7261 6d65 7465  indows` paramete
+00013ad0: 722e 0a0a 2020 2020 2020 2020 3a65 7861  r...        :exa
+00013ae0: 6d70 6c65 3a0a 2020 2020 2020 2020 3e3e  mple:.        >>
+00013af0: 3e20 7820 3d20 6e70 2e72 616e 646f 6d2e  > x = np.random.
+00013b00: 7261 6e64 696e 7428 302c 2031 302c 2073  randint(0, 10, s
+00013b10: 697a 653d 2832 302c 2929 0a20 2020 2020  ize=(20,)).     
+00013b20: 2020 203e 3e3e 2079 203d 206e 702e 7261     >>> y = np.ra
+00013b30: 6e64 6f6d 2e72 616e 6469 6e74 2830 2c20  ndom.randint(0, 
+00013b40: 3130 2c20 7369 7a65 3d28 3230 2c29 290a  10, size=(20,)).
+00013b50: 2020 2020 2020 2020 3e3e 3e20 5469 6d65          >>> Time
+00013b60: 7365 7269 6573 4665 6174 7572 654d 6978  seriesFeatureMix
+00013b70: 696e 2e73 6c69 6469 6e67 5f74 776f 5f73  in.sliding_two_s
+00013b80: 6967 6e61 6c5f 6372 6f73 7363 6f72 7265  ignal_crosscorre
+00013b90: 6c61 7469 6f6e 2878 3d78 2c20 793d 792c  lation(x=x, y=y,
+00013ba0: 2077 696e 646f 7773 3d6e 702e 6172 7261   windows=np.arra
+00013bb0: 7928 5b31 2e30 2c20 312e 325d 292c 2073  y([1.0, 1.2]), s
+00013bc0: 616d 706c 655f 7261 7465 3d31 302c 206e  ample_rate=10, n
+00013bd0: 6f72 6d61 6c69 7a65 3d54 7275 652c 206c  ormalize=True, l
+00013be0: 6167 3d30 2e30 290a 2020 2020 2020 2020  ag=0.0).        
+00013bf0: 2222 220a 0a20 2020 2020 2020 2072 6573  """..        res
+00013c00: 756c 7473 203d 206e 702e 6675 6c6c 2828  ults = np.full((
+00013c10: 782e 7368 6170 655b 305d 2c20 7769 6e64  x.shape[0], wind
+00013c20: 6f77 732e 7368 6170 655b 305d 292c 2030  ows.shape[0]), 0
+00013c30: 2e30 290a 2020 2020 2020 2020 6c61 6720  .0).        lag 
+00013c40: 3d20 696e 7428 7361 6d70 6c65 5f72 6174  = int(sample_rat
+00013c50: 6520 2a20 6c61 6729 0a20 2020 2020 2020  e * lag).       
+00013c60: 2066 6f72 2069 2069 6e20 7072 616e 6765   for i in prange
+00013c70: 2877 696e 646f 7773 2e73 6861 7065 5b30  (windows.shape[0
+00013c80: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
+00013c90: 575f 7320 3d20 696e 7428 7769 6e64 6f77  W_s = int(window
+00013ca0: 735b 695d 202a 2073 616d 706c 655f 7261  s[i] * sample_ra
+00013cb0: 7465 290a 2020 2020 2020 2020 2020 2020  te).            
+00013cc0: 666f 7220 636e 742c 2028 6c31 2c20 7231  for cnt, (l1, r1
+00013cd0: 2920 696e 2065 6e75 6d65 7261 7465 280a  ) in enumerate(.
+00013ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013cf0: 7a69 7028 7261 6e67 6528 302c 2078 2e73  zip(range(0, x.s
+00013d00: 6861 7065 5b30 5d20 2b20 3129 2c20 7261  hape[0] + 1), ra
+00013d10: 6e67 6528 575f 732c 2078 2e73 6861 7065  nge(W_s, x.shape
+00013d20: 5b30 5d20 2b20 3129 290a 2020 2020 2020  [0] + 1)).      
+00013d30: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+00013d40: 2020 2020 2020 2020 206c 3220 3d20 6c31           l2 = l1
+00013d50: 202d 206c 6167 0a20 2020 2020 2020 2020   - lag.         
+00013d60: 2020 2020 2020 2069 6620 6c32 203c 2030         if l2 < 0
+00013d70: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00013d80: 2020 2020 2020 6c32 203d 2030 0a20 2020        l2 = 0.   
+00013d90: 2020 2020 2020 2020 2020 2020 2072 3220               r2 
+00013da0: 3d20 7231 202d 206c 6167 0a20 2020 2020  = r1 - lag.     
+00013db0: 2020 2020 2020 2020 2020 2069 6620 7232             if r2
+00013dc0: 202d 206c 3220 3c20 575f 733a 0a20 2020   - l2 < W_s:.   
+00013dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013de0: 2072 3220 3d20 6c32 202b 2057 5f73 0a20   r2 = l2 + W_s. 
+00013df0: 2020 2020 2020 2020 2020 2020 2020 2058                 X
+00013e00: 5f77 203d 2078 5b6c 313a 7231 5d0a 2020  _w = x[l1:r1].  
+00013e10: 2020 2020 2020 2020 2020 2020 2020 595f                Y_
+00013e20: 7720 3d20 795b 6c32 3a72 325d 0a20 2020  w = y[l2:r2].   
+00013e30: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00013e40: 6e6f 726d 616c 697a 653a 0a20 2020 2020  normalize:.     
+00013e50: 2020 2020 2020 2020 2020 2020 2020 2058                 X
+00013e60: 5f77 203d 2028 585f 7720 2d20 6e70 2e6d  _w = (X_w - np.m
+00013e70: 6561 6e28 585f 7729 2920 2f20 286e 702e  ean(X_w)) / (np.
+00013e80: 7374 6428 585f 7729 202a 2058 5f77 2e73  std(X_w) * X_w.s
+00013e90: 6861 7065 5b30 5d29 0a20 2020 2020 2020  hape[0]).       
+00013ea0: 2020 2020 2020 2020 2020 2020 2059 5f77               Y_w
+00013eb0: 203d 2028 595f 7720 2d20 6e70 2e6d 6561   = (Y_w - np.mea
+00013ec0: 6e28 595f 7729 2920 2f20 6e70 2e73 7464  n(Y_w)) / np.std
+00013ed0: 2859 5f77 290a 2020 2020 2020 2020 2020  (Y_w).          
+00013ee0: 2020 2020 2020 7620 3d20 6e70 2e63 6f72        v = np.cor
+00013ef0: 7265 6c61 7465 2861 3d58 5f77 2c20 763d  relate(a=X_w, v=
+00013f00: 595f 7729 5b30 5d0a 2020 2020 2020 2020  Y_w)[0].        
+00013f10: 2020 2020 2020 2020 6966 206e 702e 6973          if np.is
+00013f20: 6e61 6e28 7629 3a0a 2020 2020 2020 2020  nan(v):.        
+00013f30: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+00013f40: 6c74 735b 7231 202d 2031 2c20 695d 203d  lts[r1 - 1, i] =
+00013f50: 2030 2e30 0a20 2020 2020 2020 2020 2020   0.0.           
+00013f60: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00013f70: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00013f80: 6573 756c 7473 5b69 6e74 2872 3120 2d20  esults[int(r1 - 
+00013f90: 3129 2c20 695d 203d 2076 0a20 2020 2020  1), i] = v.     
+00013fa0: 2020 2072 6574 7572 6e20 7265 7375 6c74     return result
+00013fb0: 732e 6173 7479 7065 286e 702e 666c 6f61  s.astype(np.floa
+00013fc0: 7433 3229 0a0a 2020 2020 4073 7461 7469  t32)..    @stati
+00013fd0: 636d 6574 686f 640a 2020 2020 6465 6620  cmethod.    def 
+00013fe0: 736c 6964 696e 675f 7063 745f 696e 5f74  sliding_pct_in_t
+00013ff0: 6f70 5f6e 280a 2020 2020 2020 2020 783a  op_n(.        x:
+00014000: 206e 702e 6e64 6172 7261 792c 2077 696e   np.ndarray, win
+00014010: 646f 7773 3a20 6e70 2e6e 6461 7272 6179  dows: np.ndarray
+00014020: 2c20 6e3a 2069 6e74 2c20 6670 733a 2066  , n: int, fps: f
+00014030: 6c6f 6174 0a20 2020 2029 202d 3e20 6e70  loat.    ) -> np
+00014040: 2e6e 6461 7272 6179 3a0a 2020 2020 2020  .ndarray:.      
+00014050: 2020 2222 220a 2020 2020 2020 2020 436f    """.        Co
+00014060: 6d70 7574 6520 7468 6520 7065 7263 656e  mpute the percen
+00014070: 7461 6765 206f 6620 656c 656d 656e 7473  tage of elements
+00014080: 2069 6e20 7468 6520 746f 7020 276e 2720   in the top 'n' 
+00014090: 6672 6571 7565 6e63 6965 7320 696e 2073  frequencies in s
+000140a0: 6c69 6469 6e67 2077 696e 646f 7773 206f  liding windows o
+000140b0: 6620 7468 6520 696e 7075 7420 6172 7261  f the input arra
+000140c0: 792e 0a0a 2020 2020 2020 2020 2e2e 206e  y...        .. n
+000140d0: 6f74 653a 3a0a 2020 2020 2020 2020 2020  ote::.          
+000140e0: 546f 2063 6f6d 7075 7465 2070 6572 6365  To compute perce
+000140f0: 6e74 6167 6520 6f66 2065 6c65 6d65 6e74  ntage of element
+00014100: 7320 696e 2074 6865 2074 6f70 2027 6e27  s in the top 'n'
+00014110: 2066 7265 7175 656e 6369 6573 2069 6e20   frequencies in 
+00014120: 656e 7469 7265 2061 7272 6179 2c20 7573  entire array, us
+00014130: 6520 6060 7369 6d62 612e 6d69 7869 6e73  e ``simba.mixins
+00014140: 2e73 7461 7469 7374 6963 735f 6d69 7869  .statistics_mixi
+00014150: 6e2e 5374 6174 6973 7469 6373 2e70 6374  n.Statistics.pct
+00014160: 5f69 6e5f 746f 705f 6e60 602e 0a0a 2020  _in_top_n``...  
+00014170: 2020 2020 2020 3a70 6172 616d 206e 702e        :param np.
+00014180: 6e64 6172 7261 7920 783a 2049 6e70 7574  ndarray x: Input
+00014190: 2031 4420 6172 7261 792e 0a20 2020 2020   1D array..     
+000141a0: 2020 203a 7061 7261 6d20 6e70 2e6e 6461     :param np.nda
+000141b0: 7272 6179 2077 696e 646f 7773 3a20 4172  rray windows: Ar
+000141c0: 7261 7920 6f66 2077 696e 646f 7720 7369  ray of window si
+000141d0: 7a65 7320 696e 2073 6563 6f6e 6473 2e0a  zes in seconds..
+000141e0: 2020 2020 2020 2020 3a70 6172 616d 2069          :param i
+000141f0: 6e74 206e 3a20 4e75 6d62 6572 206f 6620  nt n: Number of 
+00014200: 746f 7020 6672 6571 7565 6e63 6965 732e  top frequencies.
+00014210: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00014220: 666c 6f61 7420 6670 733a 2053 616d 706c  float fps: Sampl
+00014230: 696e 6720 6672 6571 7565 6e63 7920 666f  ing frequency fo
+00014240: 7220 7469 6d65 2063 6f6e 7665 7372 696f  r time convesrio
+00014250: 6e2e 0a20 2020 2020 2020 203a 7265 7475  n..        :retu
+00014260: 726e 206e 702e 6e64 6172 7261 793a 2032  rn np.ndarray: 2
+00014270: 4420 6172 7261 7920 6f66 2063 6f6d 7075  D array of compu
+00014280: 7465 6420 7065 7263 656e 7461 6765 7320  ted percentages 
+00014290: 6f66 2065 6c65 6d65 6e74 7320 696e 2074  of elements in t
+000142a0: 6865 2074 6f70 2027 6e27 2066 7265 7175  he top 'n' frequ
+000142b0: 656e 6369 6573 2066 6f72 2065 6163 6820  encies for each 
+000142c0: 736c 6964 696e 6720 7769 6e64 6f77 2e0a  sliding window..
+000142d0: 0a20 2020 2020 2020 203a 6578 616d 706c  .        :exampl
+000142e0: 653a 0a20 2020 2020 2020 203e 3e3e 2078  e:.        >>> x
+000142f0: 203d 206e 702e 7261 6e64 6f6d 2e72 616e   = np.random.ran
+00014300: 6469 6e74 2830 2c20 3130 2c20 2831 3030  dint(0, 10, (100
+00014310: 3030 302c 2929 0a20 2020 2020 2020 203e  000,)).        >
+00014320: 3e3e 2072 6573 756c 7473 203d 2054 696d  >> results = Tim
+00014330: 6573 6572 6965 7346 6561 7475 7265 4d69  eseriesFeatureMi
+00014340: 7869 6e2e 736c 6964 696e 675f 7063 745f  xin.sliding_pct_
+00014350: 696e 5f74 6f70 5f6e 2878 3d78 2c20 7769  in_top_n(x=x, wi
+00014360: 6e64 6f77 733d 6e70 2e61 7272 6179 285b  ndows=np.array([
+00014370: 312e 305d 292c 206e 3d34 2c20 6670 733d  1.0]), n=4, fps=
+00014380: 3130 290a 2020 2020 2020 2020 2222 220a  10).        """.
+00014390: 0a20 2020 2020 2020 2063 6865 636b 5f76  .        check_v
+000143a0: 616c 6964 5f61 7272 6179 280a 2020 2020  alid_array(.    
+000143b0: 2020 2020 2020 2020 6461 7461 3d78 2c0a          data=x,.
+000143c0: 2020 2020 2020 2020 2020 2020 736f 7572              sour
+000143d0: 6365 3d66 227b 5469 6d65 7365 7269 6573  ce=f"{Timeseries
+000143e0: 4665 6174 7572 654d 6978 696e 2e73 6c69  FeatureMixin.sli
+000143f0: 6469 6e67 5f70 6374 5f69 6e5f 746f 705f  ding_pct_in_top_
+00014400: 6e2e 5f5f 6e61 6d65 5f5f 7d20 7822 2c0a  n.__name__} x",.
+00014410: 2020 2020 2020 2020 2020 2020 6163 6365              acce
+00014420: 7074 6564 5f6e 6469 6d73 3d28 312c 292c  pted_ndims=(1,),
+00014430: 0a20 2020 2020 2020 2020 2020 2061 6363  .            acc
+00014440: 6570 7465 645f 6474 7970 6573 3d28 6e70  epted_dtypes=(np
+00014450: 2e66 6c6f 6174 3332 2c20 6e70 2e66 6c6f  .float32, np.flo
+00014460: 6174 3634 2c20 6e70 2e69 6e74 3634 2c20  at64, np.int64, 
+00014470: 6e70 2e69 6e74 3332 2c20 696e 742c 2066  np.int32, int, f
+00014480: 6c6f 6174 292c 0a20 2020 2020 2020 2029  loat),.        )
+00014490: 0a20 2020 2020 2020 2063 6865 636b 5f76  .        check_v
+000144a0: 616c 6964 5f61 7272 6179 280a 2020 2020  alid_array(.    
+000144b0: 2020 2020 2020 2020 6461 7461 3d77 696e          data=win
+000144c0: 646f 7773 2c0a 2020 2020 2020 2020 2020  dows,.          
+000144d0: 2020 736f 7572 6365 3d66 227b 5469 6d65    source=f"{Time
+000144e0: 7365 7269 6573 4665 6174 7572 654d 6978  seriesFeatureMix
+000144f0: 696e 2e73 6c69 6469 6e67 5f70 6374 5f69  in.sliding_pct_i
+00014500: 6e5f 746f 705f 6e2e 5f5f 6e61 6d65 5f5f  n_top_n.__name__
+00014510: 7d20 7769 6e64 6f77 7322 2c0a 2020 2020  } windows",.    
+00014520: 2020 2020 2020 2020 6163 6365 7074 6564          accepted
+00014530: 5f6e 6469 6d73 3d28 312c 292c 0a20 2020  _ndims=(1,),.   
+00014540: 2020 2020 2020 2020 2061 6363 6570 7465           accepte
+00014550: 645f 6474 7970 6573 3d28 6e70 2e66 6c6f  d_dtypes=(np.flo
+00014560: 6174 3332 2c20 6e70 2e66 6c6f 6174 3634  at32, np.float64
+00014570: 2c20 6e70 2e69 6e74 3634 2c20 6e70 2e69  , np.int64, np.i
+00014580: 6e74 3332 2c20 696e 742c 2066 6c6f 6174  nt32, int, float
+00014590: 292c 0a20 2020 2020 2020 2029 0a20 2020  ),.        ).   
+000145a0: 2020 2020 2063 6865 636b 5f69 6e74 280a       check_int(.
+000145b0: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+000145c0: 3d66 227b 5469 6d65 7365 7269 6573 4665  =f"{TimeseriesFe
+000145d0: 6174 7572 654d 6978 696e 2e73 6c69 6469  atureMixin.slidi
+000145e0: 6e67 5f70 6374 5f69 6e5f 746f 705f 6e2e  ng_pct_in_top_n.
+000145f0: 5f5f 6e61 6d65 5f5f 7d20 6e22 2c0a 2020  __name__} n",.  
+00014600: 2020 2020 2020 2020 2020 7661 6c75 653d            value=
+00014610: 6e2c 0a20 2020 2020 2020 2020 2020 206d  n,.            m
+00014620: 696e 5f76 616c 7565 3d31 2c0a 2020 2020  in_value=1,.    
+00014630: 2020 2020 290a 2020 2020 2020 2020 6368      ).        ch
+00014640: 6563 6b5f 666c 6f61 7428 0a20 2020 2020  eck_float(.     
+00014650: 2020 2020 2020 206e 616d 653d 6622 7b54         name=f"{T
+00014660: 696d 6573 6572 6965 7346 6561 7475 7265  imeseriesFeature
+00014670: 4d69 7869 6e2e 736c 6964 696e 675f 7063  Mixin.sliding_pc
+00014680: 745f 696e 5f74 6f70 5f6e 2e5f 5f6e 616d  t_in_top_n.__nam
+00014690: 655f 5f7d 2066 7073 222c 0a20 2020 2020  e__} fps",.     
+000146a0: 2020 2020 2020 2076 616c 7565 3d6e 2c0a         value=n,.
+000146b0: 2020 2020 2020 2020 2020 2020 6d69 6e5f              min_
+000146c0: 7661 6c75 653d 3130 652d 362c 0a20 2020  value=10e-6,.   
+000146d0: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
+000146e0: 6573 756c 7473 203d 206e 702e 6675 6c6c  esults = np.full
+000146f0: 2828 782e 7368 6170 655b 305d 2c20 7769  ((x.shape[0], wi
+00014700: 6e64 6f77 732e 7368 6170 655b 305d 292c  ndows.shape[0]),
+00014710: 202d 312e 3029 0a20 2020 2020 2020 2066   -1.0).        f
+00014720: 6f72 2069 2069 6e20 7261 6e67 6528 7769  or i in range(wi
+00014730: 6e64 6f77 732e 7368 6170 655b 305d 293a  ndows.shape[0]):
+00014740: 0a20 2020 2020 2020 2020 2020 2057 5f73  .            W_s
+00014750: 203d 2069 6e74 2877 696e 646f 7773 5b69   = int(windows[i
+00014760: 5d20 2a20 6670 7329 0a20 2020 2020 2020  ] * fps).       
+00014770: 2020 2020 2066 6f72 2063 6e74 2c20 286c       for cnt, (l
+00014780: 2c20 7229 2069 6e20 656e 756d 6572 6174  , r) in enumerat
+00014790: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+000147a0: 2020 207a 6970 2872 616e 6765 2830 2c20     zip(range(0, 
+000147b0: 782e 7368 6170 655b 305d 202b 2031 292c  x.shape[0] + 1),
+000147c0: 2072 616e 6765 2857 5f73 2c20 782e 7368   range(W_s, x.sh
+000147d0: 6170 655b 305d 202b 2031 2929 0a20 2020  ape[0] + 1)).   
+000147e0: 2020 2020 2020 2020 2029 3a0a 2020 2020           ):.    
+000147f0: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
+00014800: 6c65 203d 2078 5b6c 3a72 5d0a 2020 2020  le = x[l:r].    
+00014810: 2020 2020 2020 2020 2020 2020 636e 7473              cnts
+00014820: 203d 206e 702e 736f 7274 286e 702e 756e   = np.sort(np.un
+00014830: 6971 7565 2873 616d 706c 652c 2072 6574  ique(sample, ret
+00014840: 7572 6e5f 636f 756e 7473 3d54 7275 6529  urn_counts=True)
+00014850: 5b31 5d29 5b2d 6e3a 5d0a 2020 2020 2020  [1])[-n:].      
+00014860: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+00014870: 735b 696e 7428 7220 2d20 3129 2c20 695d  s[int(r - 1), i]
+00014880: 203d 206e 702e 7375 6d28 636e 7473 2920   = np.sum(cnts) 
+00014890: 2f20 7361 6d70 6c65 2e73 6861 7065 5b30  / sample.shape[0
+000148a0: 5d0a 2020 2020 2020 2020 7265 7475 726e  ].        return
+000148b0: 2072 6573 756c 7473 0a                    results.
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/mixins/.DS_Store` & `Simba-UW-tf-dev-1.89.5/simba/mixins/.DS_Store`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/mixins/pop_up_mixin.py` & `Simba-UW-tf-dev-1.89.5/simba/mixins/pop_up_mixin.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/mixins/config_reader.py` & `Simba-UW-tf-dev-1.89.5/simba/mixins/config_reader.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/mixins/circular_statistics.py` & `Simba-UW-tf-dev-1.89.5/simba/mixins/circular_statistics.py`

 * *Files 0% similar despite different names*

```diff
@@ -586,18 +586,20 @@
                 m1 = np.arctan2(
                     np.mean(np.sin(data_1_window)), np.mean(np.cos(data_1_window))
                 )
                 m2 = np.arctan2(
                     np.mean(np.sin(data_2_window)), np.mean(np.cos(data_2_window))
                 )
                 sin_1, sin_2 = np.sin(data_1_window - m1), np.sin(data_2_window - m2)
-                c = np.sum(sin_1 * sin_2) / np.sqrt(
-                    np.sum(sin_1 * sin_1) * np.sum(sin_2 * sin_2)
-                )
-                results[j - 1][i] = np.abs(c)
+                denominator = np.sqrt(np.sum(sin_1 * sin_1) * np.sum(sin_2 * sin_2))
+                numerator = np.sum(sin_1 * sin_2)
+                if denominator == 0:
+                    results[j - 1][i] = 0.0
+                else:
+                    results[j - 1][i] = np.abs(numerator / denominator)
 
         return results.astype(np.float32)
 
     @staticmethod
     @njit("(float32[:], float64[:], int64)")
     def sliding_angular_diff(
         data: np.ndarray, time_windows: np.ndarray, fps: float
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/mixins/network_mixin.py` & `Simba-UW-tf-dev-1.89.5/simba/mixins/network_mixin.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/mixins/pose_importer_mixin.py` & `Simba-UW-tf-dev-1.89.5/simba/mixins/pose_importer_mixin.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/mixins/video_processing_mixin.py` & `Simba-UW-tf-dev-1.89.5/simba/mixins/video_processing_mixin.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/mixins/feature_extraction_supplement_mixin.py` & `Simba-UW-tf-dev-1.89.5/simba/mixins/feature_extraction_supplement_mixin.py`

 * *Files 1% similar despite different names*

```diff
@@ -19,15 +19,15 @@
 from simba.mixins.config_reader import ConfigReader
 from simba.mixins.feature_extraction_mixin import FeatureExtractionMixin
 from simba.mixins.timeseries_features_mixin import TimeseriesFeatureMixin
 from simba.utils.checks import (check_float, check_if_dir_exists,
                                 check_if_filepath_list_is_empty,
                                 check_instance, check_str,
                                 check_that_column_exist, check_valid_array,
-                                check_valid_lst)
+                                check_valid_dataframe, check_valid_lst)
 from simba.utils.data import detect_bouts
 from simba.utils.errors import CountError, InvalidInputError
 from simba.utils.printing import SimbaTimer, stdout_success
 from simba.utils.read_write import get_fn_ext, read_df
 
 
 class FeatureExtractionSupplemental(FeatureExtractionMixin):
@@ -634,29 +634,28 @@
 
         For every onset of behavior C, count the proportions of behavior T onsets in the time-window preceding the onset
         of behavior C vs the proportion of behavior T onsets in the time-window proceeding the onset of behavior C.
 
         A value closer to 1.0 indicates that behavior T always precede behavior C. A value closer to 0.0 indicates that behavior T follows behavior C. A value of -1.0 indicates
         that behavior T never precede nor proceed behavior C.
 
+
+        .. seealso::
+           :class:`simba.data_processorsfsttc_calculator.FSTTCCalculator`
+
         :example:
-        >>> df = read_df(file_path='/Users/simon/Desktop/envs/simba/troubleshooting/two_black_animals_14bp/project_folder/csv/targets_inserted/Together_1.csv', file_type='csv')
+        >>> df = pd.DataFrame(np.random.randint(0, 2, (100, 2)), columns=['Attack', 'Sniffing'])
         >>> FeatureExtractionSupplemental.sequential_lag_analysis(data=df, criterion='Attack', target='Sniffing', fps=5, time_window=2.0)
 
         References
         ----------
         .. [1] Casarrubea et al., Structural analyses in the study of behavior: From rodents to non-human primates, `Frontiers in Psychology`,
                2022.
         """
 
-        check_instance(
-            source=FeatureExtractionSupplemental.sequential_lag_analysis.__name__,
-            instance=data,
-            accepted_types=(pd.DataFrame),
-        )
         check_str(
             name=f"{FeatureExtractionSupplemental.sequential_lag_analysis.__name__} criterion",
             value=criterion,
         )
         check_str(
             name=f"{FeatureExtractionSupplemental.sequential_lag_analysis.__name__} target",
             value=target,
@@ -665,21 +664,23 @@
             name=f"{FeatureExtractionSupplemental.sequential_lag_analysis.__name__} fps",
             value=fps,
             min_value=1.0,
         )
         check_float(
             name=f"{FeatureExtractionSupplemental.sequential_lag_analysis.__name__} time-window",
             value=time_window,
-            min_value=0.01,
+            min_value=10e-6,
         )
-        check_that_column_exist(
+        check_valid_dataframe(
             df=data,
-            column_name=[criterion, target],
-            file_name=FeatureExtractionSupplemental.sequential_lag_analysis.__name__,
+            source=f"{FeatureExtractionSupplemental.sequential_lag_analysis.__name__} data",
+            valid_dtypes=(np.float32, np.float64, np.int64, np.int32, float, int),
+            required_fields=[criterion, target],
         )
+
         bouts = detect_bouts(data_df=data, target_lst=[criterion, target], fps=fps)
         if len(bouts) == 0:
             raise CountError(
                 msg=f"No events of behaviors {criterion} and {target} detected in data.",
                 source=FeatureExtractionSupplemental.sequential_lag_analysis,
             )
         criterion_starts = bouts["Start_frame"][bouts["Event"] == criterion].values
@@ -761,7 +762,13 @@
         for i in range(0, x.shape[0], int(fps)):
             w = x[i : (i + int(fps))]
             v.append((np.sum(w) / pixels_per_mm) * (1 / (w.shape[0] / int(fps))))
         if centimeters:
             v = [vi / 10 for vi in v]
             movement = movement / 10
         return movement, np.mean(v)
+
+
+# df = read_df(file_path='/Users/simon/Desktop/envs/simba/troubleshooting/two_black_animals_14bp/project_folder/csv/targets_inserted/Together_1.csv', file_type='csv')
+#
+# df = pd.DataFrame(np.random.randint(0, 2, (100, 2)), columns=['Attack', 'Sniffing'])
+# FeatureExtractionSupplemental.sequential_lag_analysis(data=df, criterion='Attack', target='Sniffing', fps=5, time_window=2.0)
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/mixins/statistics_mixin.py` & `Simba-UW-tf-dev-1.89.5/simba/mixins/statistics_mixin.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,17 +1,17 @@
 00000000: 5f5f 6175 7468 6f72 5f5f 203d 2022 5369  __author__ = "Si
 00000010: 6d6f 6e20 4e69 6c73 736f 6e22 0a0a 6672  mon Nilsson"..fr
 00000020: 6f6d 2069 7465 7274 6f6f 6c73 2069 6d70  om itertools imp
 00000030: 6f72 7420 636f 6d62 696e 6174 696f 6e73  ort combinations
 00000040: 2c20 7065 726d 7574 6174 696f 6e73 0a66  , permutations.f
 00000050: 726f 6d20 7479 7069 6e67 2069 6d70 6f72  rom typing impor
-00000060: 7420 4f70 7469 6f6e 616c 2c20 5475 706c  t Optional, Tupl
-00000070: 652c 2055 6e69 6f6e 2c20 4c69 7374 0a69  e, Union, List.i
-00000080: 6d70 6f72 7420 7061 6e64 6173 2061 7320  mport pandas as 
-00000090: 7064 0a0a 6672 6f6d 2073 6b6c 6561 726e  pd..from sklearn
+00000060: 7420 4c69 7374 2c20 4f70 7469 6f6e 616c  t List, Optional
+00000070: 2c20 5475 706c 652c 2055 6e69 6f6e 0a0a  , Tuple, Union..
+00000080: 696d 706f 7274 2070 616e 6461 7320 6173  import pandas as
+00000090: 2070 640a 6672 6f6d 2073 6b6c 6561 726e   pd.from sklearn
 000000a0: 2e6d 6574 7269 6373 2069 6d70 6f72 7420  .metrics import 
 000000b0: 2861 646a 7573 7465 645f 6d75 7475 616c  (adjusted_mutual
 000000c0: 5f69 6e66 6f5f 7363 6f72 652c 2061 646a  _info_score, adj
 000000d0: 7573 7465 645f 7261 6e64 5f73 636f 7265  usted_rand_score
 000000e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
 000000f0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
 00000100: 6f77 6c6b 6573 5f6d 616c 6c6f 7773 5f73  owlkes_mallows_s
@@ -2935,6007 +2935,6384 @@
 0000b760: 706c 655f 322e 7368 6170 655b 305d 0a20  ple_2.shape[0]. 
 0000b770: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
 0000b780: 2068 3320 3d20 3320 2a20 2864 6174 612e   h3 = 3 * (data.
 0000b790: 7368 6170 655b 305d 202b 2031 290a 2020  shape[0] + 1).  
 0000b7a0: 2020 2020 2020 7265 7475 726e 2068 3120        return h1 
 0000b7b0: 2a20 6832 202d 2068 330a 0a20 2020 2040  * h2 - h3..    @
 0000b7c0: 7374 6174 6963 6d65 7468 6f64 0a20 2020  staticmethod.   
-0000b7d0: 2040 6e6a 6974 2822 2866 6c6f 6174 3634   @njit("(float64
-0000b7e0: 5b3a 5d2c 2066 6c6f 6174 3634 5b3a 5d29  [:], float64[:])
-0000b7f0: 222c 2063 6163 6865 3d54 7275 6529 0a20  ", cache=True). 
-0000b800: 2020 2064 6566 206d 616e 6e5f 7768 6974     def mann_whit
-0000b810: 6e65 7928 7361 6d70 6c65 5f31 3a20 6e70  ney(sample_1: np
-0000b820: 2e6e 6461 7272 6179 2c20 7361 6d70 6c65  .ndarray, sample
-0000b830: 5f32 3a20 6e70 2e6e 6461 7272 6179 2920  _2: np.ndarray) 
-0000b840: 2d3e 2066 6c6f 6174 3a0a 2020 2020 2020  -> float:.      
-0000b850: 2020 2222 220a 2020 2020 2020 2020 4a69    """.        Ji
-0000b860: 7474 6564 2063 6f6d 7075 7465 206f 6620  tted compute of 
-0000b870: 4d61 6e6e 2d57 6869 746e 6579 2055 2062  Mann-Whitney U b
-0000b880: 6574 7765 656e 2074 776f 2064 6973 7472  etween two distr
-0000b890: 6962 7574 696f 6e73 2e0a 0a20 2020 2020  ibutions...     
-0000b8a0: 2020 203a 7061 7261 6d65 7465 7220 6e64     :parameter nd
-0000b8b0: 6172 7261 7920 7361 6d70 6c65 5f31 3a20  array sample_1: 
-0000b8c0: 4669 7273 7420 3164 2061 7272 6179 2072  First 1d array r
-0000b8d0: 6570 7265 7365 6e74 696e 6720 6665 6174  epresenting feat
-0000b8e0: 7572 6520 7661 6c75 6573 2e0a 2020 2020  ure values..    
-0000b8f0: 2020 2020 3a70 6172 616d 6574 6572 206e      :parameter n
-0000b900: 6461 7272 6179 2073 616d 706c 655f 323a  darray sample_2:
-0000b910: 2053 6563 6f6e 6420 3164 2061 7272 6179   Second 1d array
-0000b920: 2072 6570 7265 7365 6e74 696e 6720 6665   representing fe
-0000b930: 6174 7572 6520 7661 6c75 6573 2e0a 2020  ature values..  
-0000b940: 2020 2020 2020 3a72 6574 7572 6e73 2066        :returns f
-0000b950: 6c6f 6174 3a20 4d61 6e6e 2d57 6869 746e  loat: Mann-Whitn
-0000b960: 6579 2055 2e0a 0a20 2020 2020 2020 203a  ey U...        :
-0000b970: 7265 6665 7265 6e63 6573 3a0a 2020 2020  references:.    
-0000b980: 2020 2020 2020 2020 604d 6f64 6966 6965          `Modifie
-0000b990: 6420 6672 6f6d 204a 616d 6573 2057 6562  d from James Web
-0000b9a0: 6265 7220 6769 7374 206f 6e20 4769 7448  ber gist on GitH
-0000b9b0: 7562 203c 6874 7470 733a 2f2f 6769 7374  ub <https://gist
-0000b9c0: 2e67 6974 6875 622e 636f 6d2f 6a61 6d65  .github.com/jame
-0000b9d0: 7374 7765 6262 6572 2f33 3861 6232 3664  stwebber/38ab26d
-0000b9e0: 3238 3166 3937 6665 6238 3139 3662 3364  281f97feb8196b3d
-0000b9f0: 3933 6564 6565 6237 623e 605f 5f2e 0a0a  93edeeb7b>`__...
-0000ba00: 2020 2020 2020 2020 3a65 7861 6d70 6c65          :example
-0000ba10: 3a0a 2020 2020 2020 2020 3e3e 3e20 7361  :.        >>> sa
-0000ba20: 6d70 6c65 5f31 203d 206e 702e 6172 7261  mple_1 = np.arra
-0000ba30: 7928 5b31 2c20 312c 2033 2c20 342c 2035  y([1, 1, 3, 4, 5
-0000ba40: 5d29 0a20 2020 2020 2020 203e 3e3e 2073  ]).        >>> s
-0000ba50: 616d 706c 655f 3220 3d20 6e70 2e61 7272  ample_2 = np.arr
-0000ba60: 6179 285b 362c 2037 2c20 382c 2039 2c20  ay([6, 7, 8, 9, 
-0000ba70: 3130 5d29 0a20 2020 2020 2020 203e 3e3e  10]).        >>>
-0000ba80: 2072 6573 756c 7473 203d 2053 7461 7469   results = Stati
-0000ba90: 7374 6963 7328 292e 6d61 6e6e 5f77 6869  stics().mann_whi
-0000baa0: 746e 6579 2873 616d 706c 655f 313d 7361  tney(sample_1=sa
-0000bab0: 6d70 6c65 5f31 2c20 7361 6d70 6c65 5f32  mple_1, sample_2
-0000bac0: 3d73 616d 706c 655f 3229 0a20 2020 2020  =sample_2).     
-0000bad0: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
-0000bae0: 6e31 2c20 6e32 203d 2073 616d 706c 655f  n1, n2 = sample_
-0000baf0: 312e 7368 6170 655b 305d 2c20 7361 6d70  1.shape[0], samp
-0000bb00: 6c65 5f32 2e73 6861 7065 5b30 5d0a 2020  le_2.shape[0].  
-0000bb10: 2020 2020 2020 7261 6e6b 6564 203d 2066        ranked = f
-0000bb20: 6173 745f 6d65 616e 5f72 616e 6b28 6e70  ast_mean_rank(np
-0000bb30: 2e63 6f6e 6361 7465 6e61 7465 2828 7361  .concatenate((sa
-0000bb40: 6d70 6c65 5f31 2c20 7361 6d70 6c65 5f32  mple_1, sample_2
-0000bb50: 2929 290a 2020 2020 2020 2020 7531 203d  ))).        u1 =
-0000bb60: 206e 3120 2a20 6e32 202b 2028 6e31 202a   n1 * n2 + (n1 *
-0000bb70: 2028 6e31 202b 2031 2929 202f 2032 2e30   (n1 + 1)) / 2.0
-0000bb80: 202d 206e 702e 7375 6d28 7261 6e6b 6564   - np.sum(ranked
-0000bb90: 5b3a 6e31 5d2c 2061 7869 733d 3029 0a20  [:n1], axis=0). 
-0000bba0: 2020 2020 2020 2075 3220 3d20 6e31 202a         u2 = n1 *
-0000bbb0: 206e 3220 2d20 7531 0a20 2020 2020 2020   n2 - u1.       
-0000bbc0: 2072 6574 7572 6e20 6d69 6e28 7531 2c20   return min(u1, 
-0000bbd0: 7532 290a 0a20 2020 2040 7374 6174 6963  u2)..    @static
-0000bbe0: 6d65 7468 6f64 0a20 2020 2040 6a69 7428  method.    @jit(
-0000bbf0: 6e6f 7079 7468 6f6e 3d54 7275 652c 2063  nopython=True, c
-0000bc00: 6163 6865 3d54 7275 6529 0a20 2020 2064  ache=True).    d
-0000bc10: 6566 206c 6576 656e 6573 280a 2020 2020  ef levenes(.    
-0000bc20: 2020 2020 7361 6d70 6c65 5f31 3a20 6e70      sample_1: np
-0000bc30: 2e6e 6461 7272 6179 2c0a 2020 2020 2020  .ndarray,.      
-0000bc40: 2020 7361 6d70 6c65 5f32 3a20 6e70 2e6e    sample_2: np.n
-0000bc50: 6461 7272 6179 2c0a 2020 2020 2020 2020  darray,.        
-0000bc60: 6372 6974 6963 616c 5f76 616c 7565 733a  critical_values:
-0000bc70: 204f 7074 696f 6e61 6c5b 6e70 2e6e 6461   Optional[np.nda
-0000bc80: 7272 6179 5d20 3d20 4e6f 6e65 2c0a 2020  rray] = None,.  
-0000bc90: 2020 2920 2d3e 2028 666c 6f61 742c 2055    ) -> (float, U
-0000bca0: 6e69 6f6e 5b62 6f6f 6c2c 204e 6f6e 655d  nion[bool, None]
-0000bcb0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-0000bcc0: 2020 2020 2020 204a 6974 7465 6420 636f         Jitted co
-0000bcd0: 6d70 7574 6520 6f66 2074 776f 2d73 616d  mpute of two-sam
-0000bce0: 706c 6520 4c65 7665 6e27 7320 572e 0a0a  ple Leven's W...
-0000bcf0: 2020 2020 2020 2020 3a70 6172 616d 6574          :paramet
-0000bd00: 6572 206e 6461 7272 6179 2073 616d 706c  er ndarray sampl
-0000bd10: 655f 313a 2046 6972 7374 2031 6420 6172  e_1: First 1d ar
-0000bd20: 7261 7920 7265 7072 6573 656e 7469 6e67  ray representing
-0000bd30: 2066 6561 7475 7265 2076 616c 7565 732e   feature values.
-0000bd40: 0a20 2020 2020 2020 203a 7061 7261 6d65  .        :parame
-0000bd50: 7465 7220 6e64 6172 7261 7920 7361 6d70  ter ndarray samp
-0000bd60: 6c65 5f32 3a20 5365 636f 6e64 2031 6420  le_2: Second 1d 
-0000bd70: 6172 7261 7920 7265 7072 6573 656e 7469  array representi
-0000bd80: 6e67 2066 6561 7475 7265 2076 616c 7565  ng feature value
-0000bd90: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
-0000bda0: 6d65 7465 7220 6e64 6172 7261 7920 6372  meter ndarray cr
-0000bdb0: 6974 6963 616c 5f76 616c 7565 733a 2032  itical_values: 2
-0000bdc0: 4420 6172 7261 7920 7769 7468 2077 6865  D array with whe
-0000bdd0: 7265 2066 6972 7374 2063 6f6c 756d 6e20  re first column 
-0000bde0: 7265 7072 6573 656e 7420 6466 6e20 6669  represent dfn fi
-0000bdf0: 7273 7420 726f 7720 6466 6420 7769 7468  rst row dfd with
-0000be00: 2076 616c 7565 7320 7265 7072 6573 656e   values represen
-0000be10: 7420 6372 6974 6963 616c 2076 616c 7565  t critical value
-0000be20: 732e 0a20 2020 2020 2020 2020 2020 2020  s..             
-0000be30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000be40: 2020 2020 2020 2020 2020 2020 2020 2043                 C
-0000be50: 616e 2062 6520 666f 756e 6420 696e 2060  an be found in `
-0000be60: 6073 696d 6261 2e61 7373 6574 732e 6372  `simba.assets.cr
-0000be70: 6974 6963 616c 5f76 616c 7565 735f 3035  itical_values_05
-0000be80: 2e70 6963 6b6c 6560 600a 0a20 2020 2020  .pickle``..     
-0000be90: 2020 203a 7265 7475 726e 7320 666c 6f61     :returns floa
-0000bea0: 743a 204c 6576 656e 2773 2057 2e0a 0a20  t: Leven's W... 
-0000beb0: 2020 2020 2020 203a 6578 616d 706c 6573         :examples
-0000bec0: 3a0a 2020 2020 2020 2020 3e3e 3e20 7361  :.        >>> sa
-0000bed0: 6d70 6c65 5f31 203d 206e 702e 6172 7261  mple_1 = np.arra
-0000bee0: 7928 6c69 7374 2872 616e 6765 2830 2c20  y(list(range(0, 
-0000bef0: 3530 2929 290a 2020 2020 2020 2020 3e3e  50))).        >>
-0000bf00: 3e20 7361 6d70 6c65 5f32 203d 206e 702e  > sample_2 = np.
-0000bf10: 6172 7261 7928 6c69 7374 2872 616e 6765  array(list(range
-0000bf20: 2832 352c 2031 3030 2929 290a 2020 2020  (25, 100))).    
-0000bf30: 2020 2020 3e3e 3e20 5374 6174 6973 7469      >>> Statisti
-0000bf40: 6373 2829 2e6c 6576 656e 6573 2873 616d  cs().levenes(sam
-0000bf50: 706c 655f 313d 7361 6d70 6c65 5f31 2c20  ple_1=sample_1, 
-0000bf60: 7361 6d70 6c65 5f32 3d73 616d 706c 655f  sample_2=sample_
-0000bf70: 3229 0a20 2020 2020 2020 203e 3e3e 2031  2).        >>> 1
-0000bf80: 322e 3633 3930 3931 3038 3930 3332 3534  2.63909108903254
-0000bf90: 0a20 2020 2020 2020 203e 3e3e 2063 7269  .        >>> cri
-0000bfa0: 7469 6361 6c5f 7661 6c75 6573 203d 2070  tical_values = p
-0000bfb0: 6963 6b6c 652e 6c6f 6164 286f 7065 6e28  ickle.load(open(
-0000bfc0: 2273 696d 6261 2f61 7373 6574 732f 6c6f  "simba/assets/lo
-0000bfd0: 6f6b 7570 732f 6372 6974 6963 616c 5f76  okups/critical_v
-0000bfe0: 616c 7565 735f 352e 7069 636b 6c65 222c  alues_5.pickle",
-0000bff0: 2272 6222 2929 5b27 6627 5d5b 276f 6e65  "rb"))['f']['one
-0000c000: 5f74 6169 6c27 5d2e 7661 6c75 6573 0a20  _tail'].values. 
-0000c010: 2020 2020 2020 203e 3e3e 2053 7461 7469         >>> Stati
-0000c020: 7374 6963 7328 292e 6c65 7665 6e65 7328  stics().levenes(
-0000c030: 7361 6d70 6c65 5f31 3d73 616d 706c 655f  sample_1=sample_
-0000c040: 312c 2073 616d 706c 655f 323d 7361 6d70  1, sample_2=samp
-0000c050: 6c65 5f32 2c20 6372 6974 6963 616c 5f76  le_2, critical_v
-0000c060: 616c 7565 733d 6372 6974 6963 616c 5f76  alues=critical_v
-0000c070: 616c 7565 7329 0a20 2020 2020 2020 203e  alues).        >
-0000c080: 3e3e 2028 3132 2e36 3339 3039 3130 3839  >> (12.639091089
-0000c090: 3033 3235 342c 2054 7275 6529 0a20 2020  03254, True).   
-0000c0a0: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-0000c0b0: 2020 7369 676e 6966 6963 616e 6365 5f62    significance_b
-0000c0c0: 6f6f 6c20 3d20 4e6f 6e65 0a20 2020 2020  ool = None.     
-0000c0d0: 2020 204e 695f 782c 204e 695f 7920 3d20     Ni_x, Ni_y = 
-0000c0e0: 6c65 6e28 7361 6d70 6c65 5f31 292c 206c  len(sample_1), l
-0000c0f0: 656e 2873 616d 706c 655f 3229 0a20 2020  en(sample_2).   
-0000c100: 2020 2020 2059 6369 5f78 2c20 5963 695f       Yci_x, Yci_
-0000c110: 7920 3d20 6e70 2e6d 6564 6961 6e28 7361  y = np.median(sa
-0000c120: 6d70 6c65 5f31 292c 206e 702e 6d65 6469  mple_1), np.medi
-0000c130: 616e 2873 616d 706c 655f 3229 0a20 2020  an(sample_2).   
-0000c140: 2020 2020 204e 746f 7420 3d20 4e69 5f78       Ntot = Ni_x
-0000c150: 202b 204e 695f 790a 2020 2020 2020 2020   + Ni_y.        
-0000c160: 5a69 6a5f 782c 205a 696a 5f79 203d 206e  Zij_x, Zij_y = n
-0000c170: 702e 6162 7328 7361 6d70 6c65 5f31 202d  p.abs(sample_1 -
-0000c180: 2059 6369 5f78 292e 6173 7479 7065 286e   Yci_x).astype(n
-0000c190: 702e 666c 6f61 7433 3229 2c20 6e70 2e61  p.float32), np.a
-0000c1a0: 6273 280a 2020 2020 2020 2020 2020 2020  bs(.            
-0000c1b0: 7361 6d70 6c65 5f32 202d 2059 6369 5f79  sample_2 - Yci_y
-0000c1c0: 0a20 2020 2020 2020 2029 2e61 7374 7970  .        ).astyp
-0000c1d0: 6528 6e70 2e66 6c6f 6174 3332 290a 2020  e(np.float32).  
-0000c1e0: 2020 2020 2020 5a62 6172 695f 782c 205a        Zbari_x, Z
-0000c1f0: 6261 7269 5f79 203d 206e 702e 6d65 616e  bari_y = np.mean
-0000c200: 285a 696a 5f78 292c 206e 702e 6d65 616e  (Zij_x), np.mean
-0000c210: 285a 696a 5f79 290a 2020 2020 2020 2020  (Zij_y).        
-0000c220: 5a62 6172 203d 2028 285a 6261 7269 5f78  Zbar = ((Zbari_x
-0000c230: 202a 204e 695f 7829 202b 2028 5a62 6172   * Ni_x) + (Zbar
-0000c240: 695f 7920 2a20 4e69 5f79 2929 202f 204e  i_y * Ni_y)) / N
-0000c250: 746f 740a 2020 2020 2020 2020 6e75 6d65  tot.        nume
-0000c260: 7220 3d20 284e 746f 7420 2d20 3229 202a  r = (Ntot - 2) *
-0000c270: 206e 702e 7375 6d28 0a20 2020 2020 2020   np.sum(.       
-0000c280: 2020 2020 206e 702e 6172 7261 7928 5b4e       np.array([N
-0000c290: 695f 782c 204e 695f 795d 2920 2a20 286e  i_x, Ni_y]) * (n
-0000c2a0: 702e 6172 7261 7928 5b5a 6261 7269 5f78  p.array([Zbari_x
-0000c2b0: 2c20 5a62 6172 695f 795d 2920 2d20 5a62  , Zbari_y]) - Zb
-0000c2c0: 6172 2920 2a2a 2032 0a20 2020 2020 2020  ar) ** 2.       
-0000c2d0: 2029 0a20 2020 2020 2020 2064 7661 7220   ).        dvar 
-0000c2e0: 3d20 6e70 2e73 756d 2828 5a69 6a5f 7820  = np.sum((Zij_x 
-0000c2f0: 2d20 5a62 6172 695f 7829 202a 2a20 3229  - Zbari_x) ** 2)
-0000c300: 202b 206e 702e 7375 6d28 285a 696a 5f79   + np.sum((Zij_y
-0000c310: 202d 205a 6261 7269 5f79 2920 2a2a 2032   - Zbari_y) ** 2
-0000c320: 290a 2020 2020 2020 2020 6465 6e6f 6d20  ).        denom 
-0000c330: 3d20 2832 202d 2031 2e30 2920 2a20 6476  = (2 - 1.0) * dv
-0000c340: 6172 0a20 2020 2020 2020 206c 5f73 7461  ar.        l_sta
-0000c350: 7469 7374 6963 203d 206e 756d 6572 202f  tistic = numer /
-0000c360: 2064 656e 6f6d 0a0a 2020 2020 2020 2020   denom..        
-0000c370: 6966 2063 7269 7469 6361 6c5f 7661 6c75  if critical_valu
-0000c380: 6573 2069 7320 6e6f 7420 4e6f 6e65 3a0a  es is not None:.
-0000c390: 2020 2020 2020 2020 2020 2020 6466 6e2c              dfn,
-0000c3a0: 2064 6664 203d 2031 2c20 284e 695f 7820   dfd = 1, (Ni_x 
-0000c3b0: 2b20 4e69 5f79 2920 2d20 320a 2020 2020  + Ni_y) - 2.    
-0000c3c0: 2020 2020 2020 2020 6964 7820 3d20 286e          idx = (n
-0000c3d0: 702e 6162 7328 6372 6974 6963 616c 5f76  p.abs(critical_v
-0000c3e0: 616c 7565 735b 305d 5b31 3a5d 202d 2064  alues[0][1:] - d
-0000c3f0: 6664 2929 2e61 7267 6d69 6e28 2920 2b20  fd)).argmin() + 
-0000c400: 310a 2020 2020 2020 2020 2020 2020 6372  1.            cr
-0000c410: 6974 6963 616c 5f76 616c 7565 7320 3d20  itical_values = 
-0000c420: 6372 6974 6963 616c 5f76 616c 7565 735b  critical_values[
-0000c430: 313a 2c20 6e70 2e61 7272 6179 285b 302c  1:, np.array([0,
-0000c440: 2069 6478 5d29 5d0a 2020 2020 2020 2020   idx])].        
-0000c450: 2020 2020 6372 6974 6963 616c 5f76 616c      critical_val
-0000c460: 7565 203d 206e 702e 696e 7465 7270 280a  ue = np.interp(.
-0000c470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c480: 6466 642c 2063 7269 7469 6361 6c5f 7661  dfd, critical_va
-0000c490: 6c75 6573 5b3a 2c20 305d 2c20 6372 6974  lues[:, 0], crit
-0000c4a0: 6963 616c 5f76 616c 7565 735b 3a2c 2031  ical_values[:, 1
-0000c4b0: 5d0a 2020 2020 2020 2020 2020 2020 290a  ].            ).
-0000c4c0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-0000c4d0: 5f73 7461 7469 7374 6963 203e 3d20 6372  _statistic >= cr
-0000c4e0: 6974 6963 616c 5f76 616c 7565 3a0a 2020  itical_value:.  
-0000c4f0: 2020 2020 2020 2020 2020 2020 2020 7369                si
-0000c500: 676e 6966 6963 616e 6365 5f62 6f6f 6c20  gnificance_bool 
-0000c510: 3d20 5472 7565 0a20 2020 2020 2020 2020  = True.         
-0000c520: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0000c530: 2020 2020 2020 2020 2073 6967 6e69 6669           signifi
-0000c540: 6361 6e63 655f 626f 6f6c 203d 2046 616c  cance_bool = Fal
-0000c550: 7365 0a0a 2020 2020 2020 2020 7265 7475  se..        retu
-0000c560: 726e 2028 6c5f 7374 6174 6973 7469 632c  rn (l_statistic,
-0000c570: 2073 6967 6e69 6669 6361 6e63 655f 626f   significance_bo
-0000c580: 6f6c 290a 0a20 2020 2040 7374 6174 6963  ol)..    @static
-0000c590: 6d65 7468 6f64 0a20 2020 2040 6e6a 6974  method.    @njit
-0000c5a0: 2822 2866 6c6f 6174 3634 5b3a 5d2c 2066  ("(float64[:], f
-0000c5b0: 6c6f 6174 3634 5b3a 5d2c 2066 6c6f 6174  loat64[:], float
-0000c5c0: 3634 2922 2c20 6361 6368 653d 5472 7565  64)", cache=True
-0000c5d0: 290a 2020 2020 6465 6620 726f 6c6c 696e  ).    def rollin
-0000c5e0: 675f 6c65 7665 6e65 7328 0a20 2020 2020  g_levenes(.     
-0000c5f0: 2020 2064 6174 613a 206e 702e 6e64 6172     data: np.ndar
-0000c600: 7261 792c 2074 696d 655f 7769 6e64 6f77  ray, time_window
-0000c610: 733a 206e 702e 6e64 6172 7261 792c 2066  s: np.ndarray, f
-0000c620: 7073 3a20 666c 6f61 740a 2020 2020 2920  ps: float.    ) 
-0000c630: 2d3e 2066 6c6f 6174 3a0a 2020 2020 2020  -> float:.      
-0000c640: 2020 2222 220a 2020 2020 2020 2020 4a69    """.        Ji
-0000c650: 7474 6564 2063 6f6d 7075 7465 206f 6620  tted compute of 
-0000c660: 726f 6c6c 696e 6720 4c65 7665 6e65 2773  rolling Levene's
-0000c670: 2057 2063 6f6d 7061 7269 6e67 2074 6865   W comparing the
-0000c680: 2063 7572 7265 6e74 2074 696d 652d 7769   current time-wi
-0000c690: 6e64 6f77 206f 6620 7369 7a65 204e 2074  ndow of size N t
-0000c6a0: 6f20 7468 6520 7072 6563 6564 696e 6720  o the preceding 
-0000c6b0: 7769 6e64 6f77 206f 6620 7369 7a65 204e  window of size N
-0000c6c0: 2e0a 0a20 2020 2020 2020 202e 2e20 6e6f  ...        .. no
-0000c6d0: 7465 3a3a 0a20 2020 2020 2020 2020 2020  te::.           
-0000c6e0: 4669 7273 7420 7469 6d65 2062 696e 2028  First time bin (
-0000c6f0: 7768 6572 6520 6861 7320 6e6f 2070 7265  where has no pre
-0000c700: 6365 6469 6e67 2074 696d 6520 6269 6e29  ceding time bin)
-0000c710: 2077 696c 6c20 6861 7665 2066 696c 6c20   will have fill 
-0000c720: 7661 6c75 6520 6060 3060 600a 0a20 2020  value ``0``..   
-0000c730: 2020 2020 203a 7061 7261 6d65 7465 7220       :parameter 
-0000c740: 6e64 6172 7261 7920 7361 6d70 6c65 5f31  ndarray sample_1
-0000c750: 3a20 4669 7273 7420 3164 2061 7272 6179  : First 1d array
-0000c760: 2072 6570 7265 7365 6e74 696e 6720 6665   representing fe
-0000c770: 6174 7572 6520 7661 6c75 6573 2e0a 2020  ature values..  
-0000c780: 2020 2020 2020 3a70 6172 616d 6574 6572        :parameter
-0000c790: 206e 6461 7272 6179 2073 616d 706c 655f   ndarray sample_
-0000c7a0: 323a 2053 6563 6f6e 6420 3164 2061 7272  2: Second 1d arr
-0000c7b0: 6179 2072 6570 7265 7365 6e74 696e 6720  ay representing 
-0000c7c0: 6665 6174 7572 6520 7661 6c75 6573 2e0a  feature values..
-0000c7d0: 2020 2020 2020 2020 3a72 6574 7572 6e73          :returns
-0000c7e0: 206e 702e 6e64 6172 7261 793a 204c 6576   np.ndarray: Lev
-0000c7f0: 656e 6527 7320 5720 6461 7461 206f 6620  ene's W data of 
-0000c800: 7369 7a65 206c 656e 2864 6174 6129 2078  size len(data) x
-0000c810: 206c 656e 2874 696d 655f 7769 6e64 6f77   len(time_window
-0000c820: 7329 2e0a 0a20 2020 2020 2020 203a 6578  s)...        :ex
-0000c830: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
-0000c840: 3e3e 2064 6174 6120 3d20 6e70 2e72 616e  >> data = np.ran
-0000c850: 646f 6d2e 7261 6e64 696e 7428 302c 2035  dom.randint(0, 5
-0000c860: 302c 2028 3130 3029 292e 6173 7479 7065  0, (100)).astype
-0000c870: 286e 702e 666c 6f61 7436 3429 0a20 2020  (np.float64).   
-0000c880: 2020 2020 203e 3e3e 2053 7461 7469 7374       >>> Statist
-0000c890: 6963 7328 292e 726f 6c6c 696e 675f 6c65  ics().rolling_le
-0000c8a0: 7665 6e65 7328 6461 7461 3d64 6174 612c  venes(data=data,
-0000c8b0: 2074 696d 655f 7769 6e64 6f77 733d 6e70   time_windows=np
-0000c8c0: 2e61 7272 6179 285b 315d 292e 6173 7479  .array([1]).asty
-0000c8d0: 7065 286e 702e 666c 6f61 7436 3429 2c20  pe(np.float64), 
-0000c8e0: 6670 733d 352e 3029 0a20 2020 2020 2020  fps=5.0).       
-0000c8f0: 2022 2222 0a0a 2020 2020 2020 2020 7265   """..        re
-0000c900: 7375 6c74 7320 3d20 6e70 2e66 756c 6c28  sults = np.full(
-0000c910: 2864 6174 612e 7368 6170 655b 305d 2c20  (data.shape[0], 
-0000c920: 7469 6d65 5f77 696e 646f 7773 2e73 6861  time_windows.sha
-0000c930: 7065 5b30 5d29 2c20 302e 3029 0a20 2020  pe[0]), 0.0).   
-0000c940: 2020 2020 2066 6f72 2069 2069 6e20 7072       for i in pr
-0000c950: 616e 6765 2874 696d 655f 7769 6e64 6f77  ange(time_window
-0000c960: 732e 7368 6170 655b 305d 293a 0a20 2020  s.shape[0]):.   
-0000c970: 2020 2020 2020 2020 2077 696e 646f 775f           window_
-0000c980: 7369 7a65 203d 2069 6e74 2874 696d 655f  size = int(time_
-0000c990: 7769 6e64 6f77 735b 695d 202a 2066 7073  windows[i] * fps
-0000c9a0: 290a 2020 2020 2020 2020 2020 2020 6461  ).            da
-0000c9b0: 7461 5f73 706c 6974 203d 206e 702e 7370  ta_split = np.sp
-0000c9c0: 6c69 7428 0a20 2020 2020 2020 2020 2020  lit(.           
-0000c9d0: 2020 2020 2064 6174 612c 206c 6973 7428       data, list(
-0000c9e0: 7261 6e67 6528 7769 6e64 6f77 5f73 697a  range(window_siz
-0000c9f0: 652c 2064 6174 612e 7368 6170 655b 305d  e, data.shape[0]
-0000ca00: 2c20 7769 6e64 6f77 5f73 697a 6529 290a  , window_size)).
-0000ca10: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0000ca20: 2020 2020 2020 2020 2020 666f 7220 6a20            for j 
-0000ca30: 696e 2070 7261 6e67 6528 312c 206c 656e  in prange(1, len
-0000ca40: 2864 6174 615f 7370 6c69 7429 293a 0a20  (data_split)):. 
-0000ca50: 2020 2020 2020 2020 2020 2020 2020 2077                 w
-0000ca60: 696e 646f 775f 7374 6172 7420 3d20 696e  indow_start = in
-0000ca70: 7428 7769 6e64 6f77 5f73 697a 6520 2a20  t(window_size * 
-0000ca80: 6a29 0a20 2020 2020 2020 2020 2020 2020  j).             
-0000ca90: 2020 2077 696e 646f 775f 656e 6420 3d20     window_end = 
-0000caa0: 696e 7428 7769 6e64 6f77 5f73 7461 7274  int(window_start
-0000cab0: 202b 2077 696e 646f 775f 7369 7a65 290a   + window_size).
-0000cac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cad0: 7361 6d70 6c65 5f31 2c20 7361 6d70 6c65  sample_1, sample
-0000cae0: 5f32 203d 2064 6174 615f 7370 6c69 745b  _2 = data_split[
-0000caf0: 6a20 2d20 315d 2e61 7374 7970 6528 6e70  j - 1].astype(np
-0000cb00: 2e66 6c6f 6174 3332 292c 2064 6174 615f  .float32), data_
-0000cb10: 7370 6c69 745b 0a20 2020 2020 2020 2020  split[.         
-0000cb20: 2020 2020 2020 2020 2020 206a 0a20 2020             j.   
-0000cb30: 2020 2020 2020 2020 2020 2020 205d 2e61               ].a
-0000cb40: 7374 7970 6528 6e70 2e66 6c6f 6174 3332  stype(np.float32
-0000cb50: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0000cb60: 2020 4e69 5f78 2c20 4e69 5f79 203d 206c    Ni_x, Ni_y = l
-0000cb70: 656e 2873 616d 706c 655f 3129 2c20 6c65  en(sample_1), le
-0000cb80: 6e28 7361 6d70 6c65 5f32 290a 2020 2020  n(sample_2).    
-0000cb90: 2020 2020 2020 2020 2020 2020 5963 695f              Yci_
-0000cba0: 782c 2059 6369 5f79 203d 206e 702e 6d65  x, Yci_y = np.me
-0000cbb0: 6469 616e 2873 616d 706c 655f 3129 2c20  dian(sample_1), 
-0000cbc0: 6e70 2e6d 6564 6961 6e28 7361 6d70 6c65  np.median(sample
-0000cbd0: 5f32 290a 2020 2020 2020 2020 2020 2020  _2).            
-0000cbe0: 2020 2020 4e74 6f74 203d 204e 695f 7820      Ntot = Ni_x 
-0000cbf0: 2b20 4e69 5f79 0a20 2020 2020 2020 2020  + Ni_y.         
-0000cc00: 2020 2020 2020 205a 696a 5f78 2c20 5a69         Zij_x, Zi
-0000cc10: 6a5f 7920 3d20 6e70 2e61 6273 2873 616d  j_y = np.abs(sam
-0000cc20: 706c 655f 3120 2d20 5963 695f 7829 2e61  ple_1 - Yci_x).a
-0000cc30: 7374 7970 6528 6e70 2e66 6c6f 6174 3332  stype(np.float32
-0000cc40: 292c 206e 702e 6162 7328 0a20 2020 2020  ), np.abs(.     
-0000cc50: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0000cc60: 616d 706c 655f 3220 2d20 5963 695f 790a  ample_2 - Yci_y.
-0000cc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cc80: 292e 6173 7479 7065 286e 702e 666c 6f61  ).astype(np.floa
-0000cc90: 7433 3229 0a20 2020 2020 2020 2020 2020  t32).           
-0000cca0: 2020 2020 205a 6261 7269 5f78 2c20 5a62       Zbari_x, Zb
-0000ccb0: 6172 695f 7920 3d20 6e70 2e6d 6561 6e28  ari_y = np.mean(
-0000ccc0: 5a69 6a5f 7829 2c20 6e70 2e6d 6561 6e28  Zij_x), np.mean(
-0000ccd0: 5a69 6a5f 7929 0a20 2020 2020 2020 2020  Zij_y).         
-0000cce0: 2020 2020 2020 205a 6261 7220 3d20 2828         Zbar = ((
-0000ccf0: 5a62 6172 695f 7820 2a20 4e69 5f78 2920  Zbari_x * Ni_x) 
-0000cd00: 2b20 285a 6261 7269 5f79 202a 204e 695f  + (Zbari_y * Ni_
-0000cd10: 7929 2920 2f20 4e74 6f74 0a20 2020 2020  y)) / Ntot.     
-0000cd20: 2020 2020 2020 2020 2020 206e 756d 6572             numer
-0000cd30: 203d 2028 4e74 6f74 202d 2032 2920 2a20   = (Ntot - 2) * 
-0000cd40: 6e70 2e73 756d 280a 2020 2020 2020 2020  np.sum(.        
-0000cd50: 2020 2020 2020 2020 2020 2020 6e70 2e61              np.a
-0000cd60: 7272 6179 285b 4e69 5f78 2c20 4e69 5f79  rray([Ni_x, Ni_y
-0000cd70: 5d29 202a 2028 6e70 2e61 7272 6179 285b  ]) * (np.array([
-0000cd80: 5a62 6172 695f 782c 205a 6261 7269 5f79  Zbari_x, Zbari_y
-0000cd90: 5d29 202d 205a 6261 7229 202a 2a20 320a  ]) - Zbar) ** 2.
-0000cda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cdb0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0000cdc0: 2020 6476 6172 203d 206e 702e 7375 6d28    dvar = np.sum(
-0000cdd0: 285a 696a 5f78 202d 205a 6261 7269 5f78  (Zij_x - Zbari_x
-0000cde0: 2920 2a2a 2032 2920 2b20 6e70 2e73 756d  ) ** 2) + np.sum
-0000cdf0: 2828 5a69 6a5f 7920 2d20 5a62 6172 695f  ((Zij_y - Zbari_
-0000ce00: 7929 202a 2a20 3229 0a20 2020 2020 2020  y) ** 2).       
-0000ce10: 2020 2020 2020 2020 2064 656e 6f6d 203d           denom =
-0000ce20: 2028 3220 2d20 312e 3029 202a 2064 7661   (2 - 1.0) * dva
-0000ce30: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
-0000ce40: 2020 7720 3d20 6e75 6d65 7220 2f20 6465    w = numer / de
-0000ce50: 6e6f 6d0a 2020 2020 2020 2020 2020 2020  nom.            
-0000ce60: 2020 2020 7265 7375 6c74 735b 7769 6e64      results[wind
-0000ce70: 6f77 5f73 7461 7274 3a77 696e 646f 775f  ow_start:window_
-0000ce80: 656e 642c 2069 5d20 3d20 770a 2020 2020  end, i] = w.    
-0000ce90: 2020 2020 7265 7475 726e 2072 6573 756c      return resul
-0000cea0: 7473 0a0a 2020 2020 4073 7461 7469 636d  ts..    @staticm
-0000ceb0: 6574 686f 640a 2020 2020 406a 6974 286e  ethod.    @jit(n
-0000cec0: 6f70 7974 686f 6e3d 5472 7565 2c20 6361  opython=True, ca
-0000ced0: 6368 653d 5472 7565 290a 2020 2020 6465  che=True).    de
-0000cee0: 6620 6272 756e 6e65 725f 6d75 6e7a 656c  f brunner_munzel
-0000cef0: 2873 616d 706c 655f 313a 206e 702e 6e64  (sample_1: np.nd
-0000cf00: 6172 7261 792c 2073 616d 706c 655f 323a  array, sample_2:
-0000cf10: 206e 702e 6e64 6172 7261 7929 202d 3e20   np.ndarray) -> 
-0000cf20: 666c 6f61 743a 0a20 2020 2020 2020 2022  float:.        "
-0000cf30: 2222 0a20 2020 2020 2020 204a 6974 7465  "".        Jitte
-0000cf40: 6420 636f 6d70 7574 6520 6f66 2042 7275  d compute of Bru
-0000cf50: 6e6e 6572 2d4d 756e 7a65 6c20 5720 6265  nner-Munzel W be
-0000cf60: 7477 6565 6e20 7477 6f20 6469 7374 7269  tween two distri
-0000cf70: 6275 7469 6f6e 732e 0a0a 2020 2020 2020  butions...      
-0000cf80: 2020 3a70 6172 616d 6574 6572 206e 6461    :parameter nda
-0000cf90: 7272 6179 2073 616d 706c 655f 313a 2046  rray sample_1: F
-0000cfa0: 6972 7374 2031 6420 6172 7261 7920 7265  irst 1d array re
-0000cfb0: 7072 6573 656e 7469 6e67 2066 6561 7475  presenting featu
-0000cfc0: 7265 2076 616c 7565 732e 0a20 2020 2020  re values..     
-0000cfd0: 2020 203a 7061 7261 6d65 7465 7220 6e64     :parameter nd
-0000cfe0: 6172 7261 7920 7361 6d70 6c65 5f32 3a20  array sample_2: 
-0000cff0: 5365 636f 6e64 2031 6420 6172 7261 7920  Second 1d array 
-0000d000: 7265 7072 6573 656e 7469 6e67 2066 6561  representing fea
-0000d010: 7475 7265 2076 616c 7565 732e 0a20 2020  ture values..   
-0000d020: 2020 2020 203a 7265 7475 726e 7320 666c       :returns fl
-0000d030: 6f61 743a 2042 7275 6e6e 6572 2d4d 756e  oat: Brunner-Mun
-0000d040: 7a65 6c20 572e 0a0a 2020 2020 2020 2020  zel W...        
-0000d050: 2e2e 206e 6f74 653a 3a0a 2020 2020 2020  .. note::.      
-0000d060: 2020 2020 204d 6f64 6966 6965 6420 6672       Modified fr
-0000d070: 6f6d 2060 6073 6369 7079 2e73 7461 7473  om ``scipy.stats
-0000d080: 2e62 7275 6e6e 6572 6d75 6e7a 656c 6060  .brunnermunzel``
-0000d090: 2e0a 0a20 2020 2020 2020 203a 6578 616d  ...        :exam
-0000d0a0: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
-0000d0b0: 2073 616d 706c 655f 312c 2073 616d 706c   sample_1, sampl
-0000d0c0: 655f 3220 3d20 6e70 2e72 616e 646f 6d2e  e_2 = np.random.
-0000d0d0: 6e6f 726d 616c 286c 6f63 3d31 302c 2073  normal(loc=10, s
-0000d0e0: 6361 6c65 3d32 2c20 7369 7a65 3d31 3029  cale=2, size=10)
-0000d0f0: 2c20 6e70 2e72 616e 646f 6d2e 6e6f 726d  , np.random.norm
-0000d100: 616c 286c 6f63 3d32 302c 2073 6361 6c65  al(loc=20, scale
-0000d110: 3d32 2c20 7369 7a65 3d31 3029 0a20 2020  =2, size=10).   
-0000d120: 2020 2020 203e 3e3e 2053 7461 7469 7374       >>> Statist
-0000d130: 6963 7328 292e 6272 756e 6e65 725f 6d75  ics().brunner_mu
-0000d140: 6e7a 656c 2873 616d 706c 655f 313d 7361  nzel(sample_1=sa
-0000d150: 6d70 6c65 5f31 2c20 7361 6d70 6c65 5f32  mple_1, sample_2
-0000d160: 3d73 616d 706c 655f 3229 0a20 2020 2020  =sample_2).     
-0000d170: 2020 203e 3e3e 2030 2e35 3735 3134 3038     >>> 0.5751408
-0000d180: 3136 3134 3337 3136 350a 2020 2020 2020  161437165.      
-0000d190: 2020 2222 220a 2020 2020 2020 2020 6e78    """.        nx
-0000d1a0: 2c20 6e79 203d 206c 656e 2873 616d 706c  , ny = len(sampl
-0000d1b0: 655f 3129 2c20 6c65 6e28 7361 6d70 6c65  e_1), len(sample
-0000d1c0: 5f32 290a 2020 2020 2020 2020 7261 6e6b  _2).        rank
-0000d1d0: 6320 3d20 6661 7374 5f6d 6561 6e5f 7261  c = fast_mean_ra
-0000d1e0: 6e6b 286e 702e 636f 6e63 6174 656e 6174  nk(np.concatenat
-0000d1f0: 6528 2873 616d 706c 655f 312c 2073 616d  e((sample_1, sam
-0000d200: 706c 655f 3229 2929 0a20 2020 2020 2020  ple_2))).       
-0000d210: 2072 616e 6b63 782c 2072 616e 6b63 7920   rankcx, rankcy 
-0000d220: 3d20 7261 6e6b 635b 303a 6e78 5d2c 2072  = rankc[0:nx], r
-0000d230: 616e 6b63 5b6e 7820 3a20 6e78 202b 206e  ankc[nx : nx + n
-0000d240: 795d 0a20 2020 2020 2020 2072 616e 6b63  y].        rankc
-0000d250: 785f 6d65 616e 2c20 7261 6e6b 6379 5f6d  x_mean, rankcy_m
-0000d260: 6561 6e20 3d20 6e70 2e6d 6561 6e28 7261  ean = np.mean(ra
-0000d270: 6e6b 6378 292c 206e 702e 6d65 616e 2872  nkcx), np.mean(r
-0000d280: 616e 6b63 7929 0a20 2020 2020 2020 2072  ankcy).        r
-0000d290: 616e 6b78 2c20 7261 6e6b 7920 3d20 6661  ankx, ranky = fa
-0000d2a0: 7374 5f6d 6561 6e5f 7261 6e6b 2873 616d  st_mean_rank(sam
-0000d2b0: 706c 655f 3129 2c20 6661 7374 5f6d 6561  ple_1), fast_mea
-0000d2c0: 6e5f 7261 6e6b 2873 616d 706c 655f 3229  n_rank(sample_2)
-0000d2d0: 0a20 2020 2020 2020 2072 616e 6b78 5f6d  .        rankx_m
-0000d2e0: 6561 6e2c 2072 616e 6b79 5f6d 6561 6e20  ean, ranky_mean 
-0000d2f0: 3d20 6e70 2e6d 6561 6e28 7261 6e6b 7829  = np.mean(rankx)
-0000d300: 2c20 6e70 2e6d 6561 6e28 7261 6e6b 7929  , np.mean(ranky)
-0000d310: 0a20 2020 2020 2020 2053 7820 3d20 6e70  .        Sx = np
-0000d320: 2e73 756d 286e 702e 706f 7765 7228 7261  .sum(np.power(ra
-0000d330: 6e6b 6378 202d 2072 616e 6b78 202d 2072  nkcx - rankx - r
-0000d340: 616e 6b63 785f 6d65 616e 202b 2072 616e  ankcx_mean + ran
-0000d350: 6b78 5f6d 6561 6e2c 2032 2e30 2929 202f  kx_mean, 2.0)) /
-0000d360: 206e 7820 2d20 310a 2020 2020 2020 2020   nx - 1.        
-0000d370: 5379 203d 206e 702e 7375 6d28 6e70 2e70  Sy = np.sum(np.p
-0000d380: 6f77 6572 2872 616e 6b63 7920 2d20 7261  ower(rankcy - ra
-0000d390: 6e6b 7920 2d20 7261 6e6b 6379 5f6d 6561  nky - rankcy_mea
-0000d3a0: 6e20 2b20 7261 6e6b 795f 6d65 616e 2c20  n + ranky_mean, 
-0000d3b0: 322e 3029 2920 2f20 6e79 202d 2031 0a20  2.0)) / ny - 1. 
-0000d3c0: 2020 2020 2020 2077 6266 6e20 3d20 6e78         wbfn = nx
-0000d3d0: 202a 206e 7920 2a20 2872 616e 6b63 795f   * ny * (rankcy_
-0000d3e0: 6d65 616e 202d 2072 616e 6b63 785f 6d65  mean - rankcx_me
-0000d3f0: 616e 290a 2020 2020 2020 2020 7762 666e  an).        wbfn
-0000d400: 202f 3d20 286e 7820 2b20 6e79 2920 2a20   /= (nx + ny) * 
-0000d410: 6e70 2e73 7172 7428 6e78 202a 2053 7820  np.sqrt(nx * Sx 
-0000d420: 2b20 6e79 202a 2053 7929 0a20 2020 2020  + ny * Sy).     
-0000d430: 2020 2072 6574 7572 6e20 2d77 6266 6e0a     return -wbfn.
-0000d440: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
-0000d450: 6f64 0a20 2020 2040 6e6a 6974 2822 2866  od.    @njit("(f
-0000d460: 6c6f 6174 3332 5b3a 5d2c 2066 6c6f 6174  loat32[:], float
-0000d470: 3634 5b3a 5d2c 2066 6c6f 6174 3634 2922  64[:], float64)"
-0000d480: 2c20 6361 6368 653d 5472 7565 290a 2020  , cache=True).  
-0000d490: 2020 6465 6620 726f 6c6c 696e 675f 6261    def rolling_ba
-0000d4a0: 726c 6574 7473 5f74 6573 7428 0a20 2020  rletts_test(.   
-0000d4b0: 2020 2020 2064 6174 613a 206e 702e 6e64       data: np.nd
-0000d4c0: 6172 7261 792c 2074 696d 655f 7769 6e64  array, time_wind
-0000d4d0: 6f77 733a 206e 702e 6e64 6172 7261 792c  ows: np.ndarray,
-0000d4e0: 2066 7073 3a20 666c 6f61 740a 2020 2020   fps: float.    
-0000d4f0: 2920 2d3e 2066 6c6f 6174 3a0a 0a20 2020  ) -> float:..   
-0000d500: 2020 2020 2072 6573 756c 7473 203d 206e       results = n
-0000d510: 702e 6675 6c6c 2828 6461 7461 2e73 6861  p.full((data.sha
-0000d520: 7065 5b30 5d2c 2074 696d 655f 7769 6e64  pe[0], time_wind
-0000d530: 6f77 732e 7368 6170 655b 305d 292c 2030  ows.shape[0]), 0
-0000d540: 2e30 290a 2020 2020 2020 2020 666f 7220  .0).        for 
-0000d550: 6920 696e 2070 7261 6e67 6528 7469 6d65  i in prange(time
-0000d560: 5f77 696e 646f 7773 2e73 6861 7065 5b30  _windows.shape[0
-0000d570: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
-0000d580: 7769 6e64 6f77 5f73 697a 6520 3d20 696e  window_size = in
-0000d590: 7428 7469 6d65 5f77 696e 646f 7773 5b69  t(time_windows[i
-0000d5a0: 5d20 2a20 6670 7329 0a20 2020 2020 2020  ] * fps).       
-0000d5b0: 2020 2020 2064 6174 615f 7370 6c69 7420       data_split 
-0000d5c0: 3d20 6e70 2e73 706c 6974 280a 2020 2020  = np.split(.    
-0000d5d0: 2020 2020 2020 2020 2020 2020 6461 7461              data
-0000d5e0: 2c20 6c69 7374 2872 616e 6765 2877 696e  , list(range(win
-0000d5f0: 646f 775f 7369 7a65 2c20 6461 7461 2e73  dow_size, data.s
-0000d600: 6861 7065 5b30 5d2c 2077 696e 646f 775f  hape[0], window_
-0000d610: 7369 7a65 2929 0a20 2020 2020 2020 2020  size)).         
-0000d620: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0000d630: 2066 6f72 206a 2069 6e20 7072 616e 6765   for j in prange
-0000d640: 2831 2c20 6c65 6e28 6461 7461 5f73 706c  (1, len(data_spl
-0000d650: 6974 2929 3a0a 2020 2020 2020 2020 2020  it)):.          
-0000d660: 2020 2020 2020 7769 6e64 6f77 5f73 7461        window_sta
-0000d670: 7274 203d 2069 6e74 2877 696e 646f 775f  rt = int(window_
-0000d680: 7369 7a65 202a 206a 290a 2020 2020 2020  size * j).      
-0000d690: 2020 2020 2020 2020 2020 7769 6e64 6f77            window
-0000d6a0: 5f65 6e64 203d 2069 6e74 2877 696e 646f  _end = int(windo
-0000d6b0: 775f 7374 6172 7420 2b20 7769 6e64 6f77  w_start + window
-0000d6c0: 5f73 697a 6529 0a20 2020 2020 2020 2020  _size).         
-0000d6d0: 2020 2020 2020 2073 616d 706c 655f 312c         sample_1,
-0000d6e0: 2073 616d 706c 655f 3220 3d20 6461 7461   sample_2 = data
-0000d6f0: 5f73 706c 6974 5b6a 202d 2031 5d2e 6173  _split[j - 1].as
-0000d700: 7479 7065 286e 702e 666c 6f61 7433 3229  type(np.float32)
-0000d710: 2c20 6461 7461 5f73 706c 6974 5b0a 2020  , data_split[.  
-0000d720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d730: 2020 6a0a 2020 2020 2020 2020 2020 2020    j.            
-0000d740: 2020 2020 5d2e 6173 7479 7065 286e 702e      ].astype(np.
-0000d750: 666c 6f61 7433 3229 0a20 2020 2020 2020  float32).       
-0000d760: 2020 2020 2020 2020 206e 5f31 203d 206c           n_1 = l
-0000d770: 656e 2873 616d 706c 655f 3129 0a20 2020  en(sample_1).   
-0000d780: 2020 2020 2020 2020 2020 2020 206e 5f32               n_2
-0000d790: 203d 206c 656e 2873 616d 706c 655f 3229   = len(sample_2)
-0000d7a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d7b0: 204e 203d 206e 5f31 202b 206e 5f32 0a20   N = n_1 + n_2. 
-0000d7c0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0000d7d0: 6561 6e5f 7661 7269 616e 6365 5f31 203d  ean_variance_1 =
-0000d7e0: 206e 702e 7375 6d28 2873 616d 706c 655f   np.sum((sample_
-0000d7f0: 3120 2d20 6e70 2e6d 6561 6e28 7361 6d70  1 - np.mean(samp
-0000d800: 6c65 5f31 2929 202a 2a20 3229 202f 2028  le_1)) ** 2) / (
-0000d810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d820: 2020 2020 206e 5f31 202d 2031 0a20 2020       n_1 - 1.   
-0000d830: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-0000d840: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0000d850: 6561 6e5f 7661 7269 616e 6365 5f32 203d  ean_variance_2 =
-0000d860: 206e 702e 7375 6d28 2873 616d 706c 655f   np.sum((sample_
-0000d870: 3220 2d20 6e70 2e6d 6561 6e28 7361 6d70  2 - np.mean(samp
-0000d880: 6c65 5f32 2929 202a 2a20 3229 202f 2028  le_2)) ** 2) / (
-0000d890: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d8a0: 2020 2020 206e 5f32 202d 2031 0a20 2020       n_2 - 1.   
-0000d8b0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-0000d8c0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0000d8d0: 756d 6572 6174 6f72 203d 2028 4e20 2d20  umerator = (N - 
-0000d8e0: 3229 202a 2028 0a20 2020 2020 2020 2020  2) * (.         
-0000d8f0: 2020 2020 2020 2020 2020 206e 702e 6c6f             np.lo
-0000d900: 6728 6d65 616e 5f76 6172 6961 6e63 655f  g(mean_variance_
-0000d910: 3129 202b 206e 702e 6c6f 6728 6d65 616e  1) + np.log(mean
-0000d920: 5f76 6172 6961 6e63 655f 3229 0a20 2020  _variance_2).   
-0000d930: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-0000d940: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0000d950: 656e 6f6d 696e 6174 6f72 203d 2031 202f  enominator = 1 /
-0000d960: 2028 6e5f 3120 2d20 3129 202b 2031 202f   (n_1 - 1) + 1 /
-0000d970: 2028 6e5f 3220 2d20 3129 0a20 2020 2020   (n_2 - 1).     
-0000d980: 2020 2020 2020 2020 2020 2075 203d 206e             u = n
-0000d990: 756d 6572 6174 6f72 202f 2064 656e 6f6d  umerator / denom
-0000d9a0: 696e 6174 6f72 0a20 2020 2020 2020 2020  inator.         
-0000d9b0: 2020 2020 2020 2072 6573 756c 7473 5b77         results[w
-0000d9c0: 696e 646f 775f 7374 6172 743a 7769 6e64  indow_start:wind
-0000d9d0: 6f77 5f65 6e64 2c20 695d 203d 2075 0a0a  ow_end, i] = u..
-0000d9e0: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-0000d9f0: 6573 756c 7473 0a0a 2020 2020 4073 7461  esults..    @sta
-0000da00: 7469 636d 6574 686f 640a 2020 2020 406e  ticmethod.    @n
-0000da10: 6a69 7428 2228 666c 6f61 7433 325b 3a5d  jit("(float32[:]
-0000da20: 2c20 666c 6f61 7433 325b 3a5d 2922 290a  , float32[:])").
-0000da30: 2020 2020 6465 6620 7065 6172 736f 6e73      def pearsons
-0000da40: 5f72 2873 616d 706c 655f 313a 206e 702e  _r(sample_1: np.
-0000da50: 6e64 6172 7261 792c 2073 616d 706c 655f  ndarray, sample_
-0000da60: 323a 206e 702e 6e64 6172 7261 7929 202d  2: np.ndarray) -
-0000da70: 3e20 666c 6f61 743a 0a20 2020 2020 2020  > float:.       
-0000da80: 2022 2222 0a20 2020 2020 2020 2043 616c   """.        Cal
-0000da90: 6375 6c61 7465 2074 6865 2050 6561 7273  culate the Pears
-0000daa0: 6f6e 2063 6f72 7265 6c61 7469 6f6e 2063  on correlation c
-0000dab0: 6f65 6666 6963 6965 6e74 2028 5065 6172  oefficient (Pear
-0000dac0: 736f 6e27 7320 7229 2062 6574 7765 656e  son's r) between
-0000dad0: 2074 776f 206e 756d 6572 6963 2073 616d   two numeric sam
-0000dae0: 706c 6573 2e0a 0a20 2020 2020 2020 2050  ples...        P
-0000daf0: 6561 7273 6f6e 2773 2072 2069 7320 6120  earson's r is a 
-0000db00: 6d65 6173 7572 6520 6f66 2074 6865 206c  measure of the l
-0000db10: 696e 6561 7220 636f 7272 656c 6174 696f  inear correlatio
-0000db20: 6e20 6265 7477 6565 6e20 7477 6f20 7365  n between two se
-0000db30: 7473 206f 6620 6461 7461 2070 6f69 6e74  ts of data point
-0000db40: 732e 2049 7420 7175 616e 7469 6669 6573  s. It quantifies
-0000db50: 2074 6865 2073 7472 656e 6774 6820 616e   the strength an
-0000db60: 640a 2020 2020 2020 2020 6469 7265 6374  d.        direct
-0000db70: 696f 6e20 6f66 2074 6865 206c 696e 6561  ion of the linea
-0000db80: 7220 7265 6c61 7469 6f6e 7368 6970 2062  r relationship b
-0000db90: 6574 7765 656e 2074 6865 2074 776f 2076  etween the two v
-0000dba0: 6172 6961 626c 6573 2e20 5468 6520 636f  ariables. The co
-0000dbb0: 6566 6669 6369 656e 7420 7661 7269 6573  efficient varies
-0000dbc0: 2062 6574 7765 656e 202d 3120 616e 6420   between -1 and 
-0000dbd0: 312c 2077 6974 680a 2020 2020 2020 2020  1, with.        
-0000dbe0: 2d31 2069 6e64 6963 6174 696e 6720 6120  -1 indicating a 
-0000dbf0: 7065 7266 6563 7420 6e65 6761 7469 7665  perfect negative
-0000dc00: 206c 696e 6561 7220 7265 6c61 7469 6f6e   linear relation
-0000dc10: 7368 6970 2c20 3120 696e 6469 6361 7469  ship, 1 indicati
-0000dc20: 6e67 2061 2070 6572 6665 6374 2070 6f73  ng a perfect pos
-0000dc30: 6974 6976 6520 6c69 6e65 6172 2072 656c  itive linear rel
-0000dc40: 6174 696f 6e73 6869 702c 2061 6e64 2030  ationship, and 0
-0000dc50: 0a20 2020 2020 2020 2069 6e64 6963 6174  .        indicat
-0000dc60: 696e 6720 6e6f 206c 696e 6561 7220 7265  ing no linear re
-0000dc70: 6c61 7469 6f6e 7368 6970 2e0a 0a20 2020  lationship...   
-0000dc80: 2020 2020 203a 6578 616d 706c 653a 0a20       :example:. 
-0000dc90: 2020 2020 2020 203e 3e3e 2073 616d 706c         >>> sampl
-0000dca0: 655f 3120 3d20 6e70 2e61 7272 6179 285b  e_1 = np.array([
-0000dcb0: 372c 2032 2c20 392c 2034 2c20 352c 2036  7, 2, 9, 4, 5, 6
-0000dcc0: 2c20 372c 2038 2c20 395d 292e 6173 7479  , 7, 8, 9]).asty
-0000dcd0: 7065 286e 702e 666c 6f61 7433 3229 0a20  pe(np.float32). 
-0000dce0: 2020 2020 2020 203e 3e3e 2073 616d 706c         >>> sampl
-0000dcf0: 655f 3220 3d20 6e70 2e61 7272 6179 285b  e_2 = np.array([
-0000dd00: 312e 352c 2032 2e35 2c20 332e 352c 2034  1.5, 2.5, 3.5, 4
-0000dd10: 2e35 2c20 352e 352c 2036 2e35 2c20 372e  .5, 5.5, 6.5, 7.
-0000dd20: 352c 2038 2e35 2c20 392e 355d 292e 6173  5, 8.5, 9.5]).as
-0000dd30: 7479 7065 286e 702e 666c 6f61 7433 3229  type(np.float32)
-0000dd40: 0a20 2020 2020 2020 203e 3e3e 2053 7461  .        >>> Sta
-0000dd50: 7469 7374 6963 7328 292e 7065 6172 736f  tistics().pearso
-0000dd60: 6e73 5f72 2873 616d 706c 655f 313d 7361  ns_r(sample_1=sa
-0000dd70: 6d70 6c65 5f31 2c20 7361 6d70 6c65 5f32  mple_1, sample_2
-0000dd80: 3d73 616d 706c 655f 3229 0a20 2020 2020  =sample_2).     
-0000dd90: 2020 203e 3e3e 2030 2e34 370a 2020 2020     >>> 0.47.    
-0000dda0: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-0000ddb0: 206d 312c 206d 3220 3d20 6e70 2e6d 6561   m1, m2 = np.mea
-0000ddc0: 6e28 7361 6d70 6c65 5f31 292c 206e 702e  n(sample_1), np.
-0000ddd0: 6d65 616e 2873 616d 706c 655f 3229 0a20  mean(sample_2). 
-0000dde0: 2020 2020 2020 206e 756d 6572 6174 6f72         numerator
-0000ddf0: 203d 206e 702e 7375 6d28 2873 616d 706c   = np.sum((sampl
-0000de00: 655f 3120 2d20 6d31 2920 2a20 2873 616d  e_1 - m1) * (sam
-0000de10: 706c 655f 3220 2d20 6d32 2929 0a20 2020  ple_2 - m2)).   
-0000de20: 2020 2020 2064 656e 6f6d 696e 6174 6f72       denominator
-0000de30: 203d 206e 702e 7371 7274 280a 2020 2020   = np.sqrt(.    
-0000de40: 2020 2020 2020 2020 6e70 2e73 756d 2828          np.sum((
-0000de50: 7361 6d70 6c65 5f31 202d 206d 3129 202a  sample_1 - m1) *
-0000de60: 2a20 3229 202a 206e 702e 7375 6d28 2873  * 2) * np.sum((s
-0000de70: 616d 706c 655f 3220 2d20 6d32 2920 2a2a  ample_2 - m2) **
-0000de80: 2032 290a 2020 2020 2020 2020 290a 2020   2).        ).  
-0000de90: 2020 2020 2020 7220 3d20 6e75 6d65 7261        r = numera
-0000dea0: 746f 7220 2f20 6465 6e6f 6d69 6e61 746f  tor / denominato
-0000deb0: 720a 2020 2020 2020 2020 7265 7475 726e  r.        return
-0000dec0: 2072 0a0a 2020 2020 4073 7461 7469 636d   r..    @staticm
-0000ded0: 6574 686f 640a 2020 2020 406e 6a69 7428  ethod.    @njit(
-0000dee0: 2228 666c 6f61 7433 325b 3a5d 2c20 666c  "(float32[:], fl
-0000def0: 6f61 7433 325b 3a5d 2922 290a 2020 2020  oat32[:])").    
-0000df00: 6465 6620 7370 6561 726d 616e 5f72 616e  def spearman_ran
-0000df10: 6b5f 636f 7272 656c 6174 696f 6e28 7361  k_correlation(sa
-0000df20: 6d70 6c65 5f31 3a20 6e70 2e6e 6461 7272  mple_1: np.ndarr
-0000df30: 6179 2c20 7361 6d70 6c65 5f32 3a20 6e70  ay, sample_2: np
-0000df40: 2e6e 6461 7272 6179 2920 2d3e 2066 6c6f  .ndarray) -> flo
-0000df50: 6174 3a0a 2020 2020 2020 2020 2222 220a  at:.        """.
-0000df60: 2020 2020 2020 2020 3a65 7861 6d70 6c65          :example
-0000df70: 3a0a 2020 2020 2020 2020 3e3e 3e20 7361  :.        >>> sa
-0000df80: 6d70 6c65 5f31 203d 206e 702e 6172 7261  mple_1 = np.arra
-0000df90: 7928 5b37 2c20 322c 2039 2c20 342c 2035  y([7, 2, 9, 4, 5
-0000dfa0: 2c20 362c 2037 2c20 382c 2039 5d29 2e61  , 6, 7, 8, 9]).a
-0000dfb0: 7374 7970 6528 6e70 2e66 6c6f 6174 3332  stype(np.float32
-0000dfc0: 290a 2020 2020 2020 2020 3e3e 3e20 7361  ).        >>> sa
-0000dfd0: 6d70 6c65 5f32 203d 206e 702e 6172 7261  mple_2 = np.arra
-0000dfe0: 7928 5b31 2e35 2c20 322e 352c 2033 2e35  y([1.5, 2.5, 3.5
-0000dff0: 2c20 342e 352c 2035 2e35 2c20 362e 352c  , 4.5, 5.5, 6.5,
-0000e000: 2037 2e35 2c20 382e 352c 2039 2e35 5d29   7.5, 8.5, 9.5])
-0000e010: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
-0000e020: 3332 290a 2020 2020 2020 2020 3e3e 3e20  32).        >>> 
-0000e030: 5374 6174 6973 7469 6373 2829 2e73 7065  Statistics().spe
-0000e040: 6172 6d61 6e5f 7261 6e6b 5f63 6f72 7265  arman_rank_corre
-0000e050: 6c61 7469 6f6e 2873 616d 706c 655f 313d  lation(sample_1=
-0000e060: 7361 6d70 6c65 5f31 2c20 7361 6d70 6c65  sample_1, sample
-0000e070: 5f32 3d73 616d 706c 655f 3229 0a20 2020  _2=sample_2).   
-0000e080: 2020 2020 203e 3e3e 2030 2e30 3030 3339       >>> 0.00039
-0000e090: 3739 3230 3630 3835 3230 3530 3738 0a20  79206085205078. 
-0000e0a0: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-0000e0b0: 2020 2020 7261 6e6b 5f78 2c20 7261 6e6b      rank_x, rank
-0000e0c0: 5f79 203d 206e 702e 6172 6773 6f72 7428  _y = np.argsort(
-0000e0d0: 6e70 2e61 7267 736f 7274 2873 616d 706c  np.argsort(sampl
-0000e0e0: 655f 3129 292c 206e 702e 6172 6773 6f72  e_1)), np.argsor
-0000e0f0: 7428 0a20 2020 2020 2020 2020 2020 206e  t(.            n
-0000e100: 702e 6172 6773 6f72 7428 7361 6d70 6c65  p.argsort(sample
-0000e110: 5f32 290a 2020 2020 2020 2020 290a 2020  _2).        ).  
-0000e120: 2020 2020 2020 645f 7371 7561 7265 6420        d_squared 
-0000e130: 3d20 6e70 2e73 756d 2828 7261 6e6b 5f78  = np.sum((rank_x
-0000e140: 202d 2072 616e 6b5f 7929 202a 2a20 3229   - rank_y) ** 2)
-0000e150: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000e160: 3120 2d20 2836 202a 2064 5f73 7175 6172  1 - (6 * d_squar
-0000e170: 6564 2920 2f20 286c 656e 2873 616d 706c  ed) / (len(sampl
-0000e180: 655f 3129 202a 2028 6c65 6e28 7361 6d70  e_1) * (len(samp
-0000e190: 6c65 5f32 2920 2a2a 2032 202d 2031 2929  le_2) ** 2 - 1))
-0000e1a0: 0a0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
-0000e1b0: 686f 640a 2020 2020 406e 6a69 7428 2228  hod.    @njit("(
-0000e1c0: 666c 6f61 7433 325b 3a5d 2c20 666c 6f61  float32[:], floa
-0000e1d0: 7433 325b 3a5d 2c20 666c 6f61 7436 345b  t32[:], float64[
-0000e1e0: 3a5d 2c20 696e 7436 3429 2229 0a20 2020  :], int64)").   
-0000e1f0: 2064 6566 2073 6c69 6469 6e67 5f70 6561   def sliding_pea
-0000e200: 7273 6f6e 735f 7228 0a20 2020 2020 2020  rsons_r(.       
-0000e210: 2073 616d 706c 655f 313a 206e 702e 6e64   sample_1: np.nd
-0000e220: 6172 7261 792c 2073 616d 706c 655f 323a  array, sample_2:
-0000e230: 206e 702e 6e64 6172 7261 792c 2074 696d   np.ndarray, tim
-0000e240: 655f 7769 6e64 6f77 733a 206e 702e 6e64  e_windows: np.nd
-0000e250: 6172 7261 792c 2066 7073 3a20 696e 740a  array, fps: int.
-0000e260: 2020 2020 2920 2d3e 206e 702e 6e64 6172      ) -> np.ndar
-0000e270: 7261 793a 0a20 2020 2020 2020 2022 2222  ray:.        """
-0000e280: 0a20 2020 2020 2020 2047 6976 656e 2074  .        Given t
-0000e290: 776f 2031 4420 6172 7261 7973 206f 6620  wo 1D arrays of 
-0000e2a0: 7369 7a65 204e 2c20 6372 6561 7465 2073  size N, create s
-0000e2b0: 6c69 6469 6e67 2077 696e 646f 7720 6f66  liding window of
-0000e2c0: 2073 697a 6520 7469 6d65 5f77 696e 646f   size time_windo
-0000e2d0: 7773 5b69 5d20 2a20 6670 7320 616e 6420  ws[i] * fps and 
-0000e2e0: 7265 7475 726e 2050 6561 7273 6f6e 2773  return Pearson's
-0000e2f0: 2052 0a20 2020 2020 2020 2062 6574 7765   R.        betwe
-0000e300: 656e 2074 6865 2076 616c 7565 7320 696e  en the values in
-0000e310: 2074 6865 2074 776f 2031 4420 6172 7261   the two 1D arra
-0000e320: 7973 2069 6e20 6561 6368 2077 696e 646f  ys in each windo
-0000e330: 772e 2041 6464 7265 7373 2022 7768 6174  w. Address "what
-0000e340: 2069 7320 7468 6520 636f 7272 656c 6174   is the correlat
-0000e350: 696f 6e20 6265 7477 6565 6e20 4665 6174  ion between Feat
-0000e360: 7572 6520 3120 616e 640a 2020 2020 2020  ure 1 and.      
-0000e370: 2020 4665 6174 7572 6520 3220 696e 2074    Feature 2 in t
-0000e380: 6865 2063 7572 7265 6e74 2058 2e58 2073  he current X.X s
-0000e390: 6563 6f6e 6473 206f 6620 7468 6520 7669  econds of the vi
-0000e3a0: 6465 6f22 2e0a 0a20 2020 2020 2020 202e  deo"...        .
-0000e3b0: 2e20 696d 6167 653a 3a20 5f73 7461 7469  . image:: _stati
-0000e3c0: 632f 696d 672f 736c 6964 696e 675f 7065  c/img/sliding_pe
-0000e3d0: 6172 736f 6e73 2e70 6e67 0a20 2020 2020  arsons.png.     
-0000e3e0: 2020 2020 2020 3a77 6964 7468 3a20 3630        :width: 60
-0000e3f0: 300a 2020 2020 2020 2020 2020 203a 616c  0.           :al
-0000e400: 6967 6e3a 2063 656e 7465 720a 0a20 2020  ign: center..   
-0000e410: 2020 2020 203a 7061 7261 6d65 7465 7220       :parameter 
-0000e420: 6e64 6172 7261 7920 7361 6d70 6c65 5f31  ndarray sample_1
-0000e430: 3a20 4669 7273 7420 3144 2061 7272 6179  : First 1D array
-0000e440: 2077 6974 6820 6665 6174 7572 6520 7661   with feature va
-0000e450: 6c75 6573 2e0a 2020 2020 2020 2020 3a70  lues..        :p
-0000e460: 6172 616d 6574 6572 206e 6461 7272 6179  arameter ndarray
-0000e470: 2073 616d 706c 655f 313a 2053 6563 6f6e   sample_1: Secon
-0000e480: 6420 3144 2061 7272 6179 2077 6974 6820  d 1D array with 
-0000e490: 6665 6174 7572 6520 7661 6c75 6573 2e0a  feature values..
-0000e4a0: 2020 2020 2020 2020 3a70 6172 616d 6574          :paramet
-0000e4b0: 6572 2066 6c6f 6174 2074 696d 655f 7769  er float time_wi
-0000e4c0: 6e64 6f77 733a 2054 6865 206c 656e 6774  ndows: The lengt
-0000e4d0: 6820 6f66 2074 6865 2073 6c69 6469 6e67  h of the sliding
-0000e4e0: 2077 696e 646f 7720 696e 2073 6563 6f6e   window in secon
-0000e4f0: 6473 2e0a 2020 2020 2020 2020 3a70 6172  ds..        :par
-0000e500: 616d 6574 6572 2069 6e74 2066 7073 3a20  ameter int fps: 
-0000e510: 5468 6520 6670 7320 6f66 2074 6865 2072  The fps of the r
-0000e520: 6563 6f72 6465 6420 7669 6465 6f2e 0a20  ecorded video.. 
-0000e530: 2020 2020 2020 203a 7265 7475 726e 7320         :returns 
-0000e540: 6e70 2e6e 6461 7272 6179 3a20 3264 2061  np.ndarray: 2d a
-0000e550: 7272 6179 206f 6620 5065 6172 736f 6e73  rray of Pearsons
-0000e560: 2052 206f 6620 7369 7a65 206c 656e 2873   R of size len(s
-0000e570: 616d 706c 655f 3129 2078 206c 656e 2874  ample_1) x len(t
-0000e580: 696d 655f 7769 6e64 6f77 7329 2e20 4e6f  ime_windows). No
-0000e590: 7465 2c20 6966 2073 6c69 6469 6e67 2077  te, if sliding w
-0000e5a0: 696e 646f 7720 6973 2031 3020 6672 616d  indow is 10 fram
-0000e5b0: 6573 2c20 7468 6520 6669 7273 7420 3920  es, the first 9 
-0000e5c0: 656e 7472 6965 7320 7769 6c6c 2062 6520  entries will be 
-0000e5d0: 6669 6c6c 6564 2077 6974 6820 302e 0a0a  filled with 0...
-0000e5e0: 2020 2020 2020 2020 3a65 7861 6d70 6c65          :example
-0000e5f0: 3a0a 2020 2020 2020 2020 3e3e 3e20 7361  :.        >>> sa
-0000e600: 6d70 6c65 5f31 203d 206e 702e 7261 6e64  mple_1 = np.rand
-0000e610: 6f6d 2e72 616e 6469 6e74 2830 2c20 3530  om.randint(0, 50
-0000e620: 2c20 2831 3029 292e 6173 7479 7065 286e  , (10)).astype(n
-0000e630: 702e 666c 6f61 7433 3229 0a20 2020 2020  p.float32).     
-0000e640: 2020 203e 3e3e 2073 616d 706c 655f 3220     >>> sample_2 
-0000e650: 3d20 6e70 2e72 616e 646f 6d2e 7261 6e64  = np.random.rand
-0000e660: 696e 7428 302c 2035 302c 2028 3130 2929  int(0, 50, (10))
-0000e670: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
-0000e680: 3332 290a 2020 2020 2020 2020 3e3e 3e20  32).        >>> 
-0000e690: 5374 6174 6973 7469 6373 2829 2e73 6c69  Statistics().sli
-0000e6a0: 6469 6e67 5f70 6561 7273 6f6e 735f 7228  ding_pearsons_r(
-0000e6b0: 7361 6d70 6c65 5f31 3d73 616d 706c 655f  sample_1=sample_
-0000e6c0: 312c 2073 616d 706c 655f 323d 7361 6d70  1, sample_2=samp
-0000e6d0: 6c65 5f32 2c20 7469 6d65 5f77 696e 646f  le_2, time_windo
-0000e6e0: 7773 3d6e 702e 6172 7261 7928 5b30 2e35  ws=np.array([0.5
-0000e6f0: 5d29 2c20 6670 733d 3130 290a 2020 2020  ]), fps=10).    
-0000e700: 2020 2020 3e3e 3e20 5b5b 2d31 2e5d 5b2d      >>> [[-1.][-
-0000e710: 312e 5d5b 2d31 2e5d 5b2d 312e 5d5b 302e  1.][-1.][-1.][0.
-0000e720: 3232 375d 5b2d 302e 3331 395d 5b2d 302e  227][-0.319][-0.
-0000e730: 3139 365d 5b30 2e34 3734 5d5b 2d30 2e30  196][0.474][-0.0
-0000e740: 3631 5d5b 302e 3731 335d 5d0a 2020 2020  61][0.713]].    
-0000e750: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-0000e760: 2072 6573 756c 7473 203d 206e 702e 6675   results = np.fu
-0000e770: 6c6c 2828 7361 6d70 6c65 5f31 2e73 6861  ll((sample_1.sha
-0000e780: 7065 5b30 5d2c 2074 696d 655f 7769 6e64  pe[0], time_wind
-0000e790: 6f77 732e 7368 6170 655b 305d 292c 2030  ows.shape[0]), 0
-0000e7a0: 2e30 290a 2020 2020 2020 2020 666f 7220  .0).        for 
-0000e7b0: 6920 696e 2070 7261 6e67 6528 7469 6d65  i in prange(time
-0000e7c0: 5f77 696e 646f 7773 2e73 6861 7065 5b30  _windows.shape[0
-0000e7d0: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
-0000e7e0: 7769 6e64 6f77 5f73 697a 6520 3d20 696e  window_size = in
-0000e7f0: 7428 7469 6d65 5f77 696e 646f 7773 5b69  t(time_windows[i
-0000e800: 5d20 2a20 6670 7329 0a20 2020 2020 2020  ] * fps).       
-0000e810: 2020 2020 2066 6f72 206c 6566 742c 2072       for left, r
-0000e820: 6967 6874 2069 6e20 7a69 7028 0a20 2020  ight in zip(.   
-0000e830: 2020 2020 2020 2020 2020 2020 2070 7261               pra
-0000e840: 6e67 6528 302c 2073 616d 706c 655f 312e  nge(0, sample_1.
-0000e850: 7368 6170 655b 305d 202b 2031 292c 0a20  shape[0] + 1),. 
-0000e860: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0000e870: 7261 6e67 6528 7769 6e64 6f77 5f73 697a  range(window_siz
-0000e880: 652c 2073 616d 706c 655f 312e 7368 6170  e, sample_1.shap
-0000e890: 655b 305d 202b 2031 292c 0a20 2020 2020  e[0] + 1),.     
-0000e8a0: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
-0000e8b0: 2020 2020 2020 2020 2020 7331 2c20 7332            s1, s2
-0000e8c0: 203d 2073 616d 706c 655f 315b 6c65 6674   = sample_1[left
-0000e8d0: 3a72 6967 6874 5d2c 2073 616d 706c 655f  :right], sample_
-0000e8e0: 325b 6c65 6674 3a72 6967 6874 5d0a 2020  2[left:right].  
-0000e8f0: 2020 2020 2020 2020 2020 2020 2020 6d31                m1
-0000e900: 2c20 6d32 203d 206e 702e 6d65 616e 2873  , m2 = np.mean(s
-0000e910: 3129 2c20 6e70 2e6d 6561 6e28 7332 290a  1), np.mean(s2).
-0000e920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e930: 6e75 6d65 7261 746f 7220 3d20 6e70 2e73  numerator = np.s
-0000e940: 756d 2828 7331 202d 206d 3129 202a 2028  um((s1 - m1) * (
-0000e950: 7332 202d 206d 3229 290a 2020 2020 2020  s2 - m2)).      
-0000e960: 2020 2020 2020 2020 2020 6465 6e6f 6d69            denomi
-0000e970: 6e61 746f 7220 3d20 6e70 2e73 7172 7428  nator = np.sqrt(
-0000e980: 6e70 2e73 756d 2828 7331 202d 206d 3129  np.sum((s1 - m1)
-0000e990: 202a 2a20 3229 202a 206e 702e 7375 6d28   ** 2) * np.sum(
-0000e9a0: 2873 3220 2d20 6d32 2920 2a2a 2032 2929  (s2 - m2) ** 2))
-0000e9b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e9c0: 2069 6620 6465 6e6f 6d69 6e61 746f 7220   if denominator 
-0000e9d0: 213d 2030 3a0a 2020 2020 2020 2020 2020  != 0:.          
-0000e9e0: 2020 2020 2020 2020 2020 7220 3d20 6e75            r = nu
-0000e9f0: 6d65 7261 746f 7220 2f20 6465 6e6f 6d69  merator / denomi
-0000ea00: 6e61 746f 720a 2020 2020 2020 2020 2020  nator.          
-0000ea10: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-0000ea20: 735b 7269 6768 7420 2d20 312c 2069 5d20  s[right - 1, i] 
-0000ea30: 3d20 720a 2020 2020 2020 2020 2020 2020  = r.            
-0000ea40: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0000ea50: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0000ea60: 7375 6c74 735b 7269 6768 7420 2d20 312c  sults[right - 1,
-0000ea70: 2069 5d20 3d20 2d31 2e30 0a0a 2020 2020   i] = -1.0..    
-0000ea80: 2020 2020 7265 7475 726e 2072 6573 756c      return resul
-0000ea90: 7473 0a0a 2020 2020 4073 7461 7469 636d  ts..    @staticm
-0000eaa0: 6574 686f 640a 2020 2020 406e 6a69 7428  ethod.    @njit(
-0000eab0: 0a20 2020 2020 2020 205b 0a20 2020 2020  .        [.     
-0000eac0: 2020 2020 2020 2022 2866 6c6f 6174 3332         "(float32
-0000ead0: 5b3a 5d2c 2066 6c6f 6174 3332 5b3a 5d2c  [:], float32[:],
-0000eae0: 2066 6c6f 6174 3634 5b3a 2c3a 5d2c 2074   float64[:,:], t
-0000eaf0: 7970 6573 2e75 6e69 636f 6465 5f74 7970  ypes.unicode_typ
-0000eb00: 6529 222c 0a20 2020 2020 2020 2020 2020  e)",.           
-0000eb10: 2027 2866 6c6f 6174 3332 5b3a 5d2c 2066   '(float32[:], f
-0000eb20: 6c6f 6174 3332 5b3a 5d2c 2066 6c6f 6174  loat32[:], float
-0000eb30: 3634 5b3a 2c3a 5d2c 2074 7970 6573 2e6d  64[:,:], types.m
-0000eb40: 6973 632e 4f6d 6974 7465 6428 2267 6f6f  isc.Omitted("goo
-0000eb50: 646e 6573 735f 6f66 5f66 6974 2229 2927  dness_of_fit"))'
-0000eb60: 2c0a 2020 2020 2020 2020 2020 2020 2228  ,.            "(
-0000eb70: 666c 6f61 7433 325b 3a5d 2c20 666c 6f61  float32[:], floa
-0000eb80: 7433 325b 3a5d 2c20 7479 7065 732e 6d69  t32[:], types.mi
-0000eb90: 7363 2e4f 6d69 7474 6564 284e 6f6e 6529  sc.Omitted(None)
-0000eba0: 2c20 7479 7065 732e 756e 6963 6f64 655f  , types.unicode_
-0000ebb0: 7479 7065 2922 2c0a 2020 2020 2020 2020  type)",.        
-0000ebc0: 2020 2020 2728 666c 6f61 7433 325b 3a5d      '(float32[:]
-0000ebd0: 2c20 666c 6f61 7433 325b 3a5d 2c20 7479  , float32[:], ty
-0000ebe0: 7065 732e 6d69 7363 2e4f 6d69 7474 6564  pes.misc.Omitted
-0000ebf0: 284e 6f6e 6529 2c20 7479 7065 732e 6d69  (None), types.mi
-0000ec00: 7363 2e4f 6d69 7474 6564 2822 676f 6f64  sc.Omitted("good
-0000ec10: 6e65 7373 5f6f 665f 6669 7422 2929 272c  ness_of_fit"))',
-0000ec20: 0a20 2020 2020 2020 205d 0a20 2020 2029  .        ].    )
-0000ec30: 0a20 2020 2064 6566 2063 6869 5f73 7175  .    def chi_squ
-0000ec40: 6172 6528 0a20 2020 2020 2020 2073 616d  are(.        sam
-0000ec50: 706c 655f 313a 206e 702e 6e64 6172 7261  ple_1: np.ndarra
-0000ec60: 792c 0a20 2020 2020 2020 2073 616d 706c  y,.        sampl
-0000ec70: 655f 323a 206e 702e 6e64 6172 7261 792c  e_2: np.ndarray,
-0000ec80: 0a20 2020 2020 2020 2063 7269 7469 6361  .        critica
-0000ec90: 6c5f 7661 6c75 6573 3a20 4f70 7469 6f6e  l_values: Option
-0000eca0: 616c 5b6e 702e 6e64 6172 7261 795d 203d  al[np.ndarray] =
-0000ecb0: 204e 6f6e 652c 0a20 2020 2020 2020 2074   None,.        t
-0000ecc0: 7970 653a 204f 7074 696f 6e61 6c5b 4c69  ype: Optional[Li
-0000ecd0: 7465 7261 6c5b 2267 6f6f 646e 6573 735f  teral["goodness_
-0000ece0: 6f66 5f66 6974 222c 2022 696e 6465 7065  of_fit", "indepe
-0000ecf0: 6e64 656e 6365 225d 5d20 3d20 2267 6f6f  ndence"]] = "goo
-0000ed00: 646e 6573 735f 6f66 5f66 6974 222c 0a20  dness_of_fit",. 
-0000ed10: 2020 2029 202d 3e20 5475 706c 655b 666c     ) -> Tuple[fl
-0000ed20: 6f61 742c 2055 6e69 6f6e 5b62 6f6f 6c2c  oat, Union[bool,
-0000ed30: 204e 6f6e 655d 5d3a 0a20 2020 2020 2020   None]]:.       
-0000ed40: 2022 2222 0a20 2020 2020 2020 204a 6974   """.        Jit
-0000ed50: 7465 6420 636f 6d70 7574 6520 6f66 2063  ted compute of c
-0000ed60: 6869 2073 7175 6172 6520 6265 7477 6565  hi square betwee
-0000ed70: 6e20 7477 6f20 6361 7465 676f 7269 6361  n two categorica
-0000ed80: 6c20 6469 7374 7269 6275 7469 6f6e 732e  l distributions.
-0000ed90: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0000eda0: 6574 6572 206e 6461 7272 6179 2073 616d  eter ndarray sam
-0000edb0: 706c 655f 313a 2046 6972 7374 2031 6420  ple_1: First 1d 
-0000edc0: 6172 7261 7920 7265 7072 6573 656e 7469  array representi
-0000edd0: 6e67 2066 6561 7475 7265 2076 616c 7565  ng feature value
-0000ede0: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
-0000edf0: 6d65 7465 7220 6e64 6172 7261 7920 7361  meter ndarray sa
-0000ee00: 6d70 6c65 5f32 3a20 5365 636f 6e64 2031  mple_2: Second 1
-0000ee10: 6420 6172 7261 7920 7265 7072 6573 656e  d array represen
-0000ee20: 7469 6e67 2066 6561 7475 7265 2076 616c  ting feature val
-0000ee30: 7565 732e 0a20 2020 2020 2020 203a 7061  ues..        :pa
-0000ee40: 7261 6d65 7465 7220 6e64 6172 7261 7920  rameter ndarray 
-0000ee50: 6372 6974 6963 616c 5f76 616c 7565 733a  critical_values:
-0000ee60: 2032 4420 6172 7261 7920 7769 7468 2077   2D array with w
-0000ee70: 6865 7265 2069 6e64 6578 6573 2072 6570  here indexes rep
-0000ee80: 7265 7365 6e74 2064 6567 7265 6573 206f  resent degrees o
-0000ee90: 6620 6672 6565 646f 6d20 616e 6420 7661  f freedom and va
-0000eea0: 6c75 6573 0a20 2020 2020 2020 2020 2020  lues.           
-0000eeb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eed0: 2072 6570 7265 7365 6e74 2063 7269 7469   represent criti
-0000eee0: 6361 6c20 7661 6c75 6573 2e20 4361 6e20  cal values. Can 
-0000eef0: 6265 2066 6f75 6e64 2069 6e20 6060 7369  be found in ``si
-0000ef00: 6d62 612e 6173 7365 7473 2e63 7269 7469  mba.assets.criti
-0000ef10: 6361 6c5f 7661 6c75 6573 5f30 352e 7069  cal_values_05.pi
-0000ef20: 636b 6c65 6060 0a0a 2020 2020 2020 2020  ckle``..        
-0000ef30: 2e2e 206e 6f74 653a 3a0a 2020 2020 2020  .. note::.      
-0000ef40: 2020 2020 2052 6571 7569 7265 7320 7361       Requires sa
-0000ef50: 6d70 6c65 5f31 2061 6e64 2073 616d 706c  mple_1 and sampl
-0000ef60: 655f 3220 6861 7320 746f 2062 6520 6e75  e_2 has to be nu
-0000ef70: 6d65 7269 632e 2069 6620 776f 726b 696e  meric. if workin
-0000ef80: 6720 7769 7468 2073 7472 696e 6773 2c20  g with strings, 
-0000ef90: 636f 6e76 6572 7420 746f 0a20 2020 2020  convert to.     
-0000efa0: 2020 2020 2020 6e75 6d65 7269 6320 6361        numeric ca
-0000efb0: 7465 676f 7279 2076 616c 7565 7320 6265  tegory values be
-0000efc0: 666f 7265 2075 7369 6e67 2063 6869 5f73  fore using chi_s
-0000efd0: 7175 6172 652e 0a0a 2020 2020 2020 2020  quare...        
-0000efe0: 2e2e 2077 6172 6e69 6e67 3a0a 2020 2020  .. warning:.    
-0000eff0: 2020 2020 2020 204e 6f6e 2d6f 7665 726c         Non-overl
-0000f000: 6170 7069 6e67 2076 616c 7565 7320 2869  apping values (i
-0000f010: 2e65 2e2c 2063 6174 6567 6f72 6965 7320  .e., categories 
-0000f020: 6578 6973 7420 696e 2073 616d 706c 655f  exist in sample_
-0000f030: 3120 7468 6174 2064 6f65 7320 6e6f 7420  1 that does not 
-0000f040: 6578 6973 7420 696e 2073 616d 706c 6532  exist in sample2
-0000f050: 2920 6f72 2073 6d61 6c6c 2076 616c 7565  ) or small value
-0000f060: 7320 6d61 7920 6361 7573 6520 696e 666c  s may cause infl
-0000f070: 6174 6564 2063 6869 2073 7175 6172 6520  ated chi square 
-0000f080: 7661 6c75 6573 2e0a 2020 2020 2020 2020  values..        
-0000f090: 2020 2049 6620 736d 616c 6c20 636f 6e74     If small cont
-0000f0a0: 696e 6765 6e63 7920 7461 626c 6520 736d  ingency table sm
-0000f0b0: 616c 6c20 7661 6c75 6573 2c20 636f 6e73  all values, cons
-0000f0c0: 6964 6572 2054 4f44 4f20 4669 7368 6572  ider TODO Fisher
-0000f0d0: 2773 2065 7861 6374 2074 6573 740a 0a20  's exact test.. 
-0000f0e0: 2020 2020 2020 203a 6578 616d 706c 653a         :example:
-0000f0f0: 0a20 2020 2020 2020 203e 3e3e 2073 616d  .        >>> sam
-0000f100: 706c 655f 3120 3d20 6e70 2e61 7272 6179  ple_1 = np.array
-0000f110: 285b 312c 2031 2c20 322c 2032 2c20 332c  ([1, 1, 2, 2, 3,
-0000f120: 2033 2c20 342c 2034 2c20 352c 2035 2c20   3, 4, 4, 5, 5, 
-0000f130: 355d 292e 6173 7479 7065 286e 702e 666c  5]).astype(np.fl
-0000f140: 6f61 7433 3229 0a20 2020 2020 2020 203e  oat32).        >
-0000f150: 3e3e 2073 616d 706c 655f 3220 3d20 6e70  >> sample_2 = np
-0000f160: 2e61 7272 6179 285b 312c 2032 2c20 332c  .array([1, 2, 3,
-0000f170: 2034 2c20 352c 2036 2c20 372c 2038 2c20   4, 5, 6, 7, 8, 
-0000f180: 392c 2031 305d 292e 6173 7479 7065 286e  9, 10]).astype(n
-0000f190: 702e 666c 6f61 7433 3229 0a20 2020 2020  p.float32).     
-0000f1a0: 2020 203e 3e3e 2063 7269 7469 6361 6c5f     >>> critical_
-0000f1b0: 7661 6c75 6573 203d 2070 6963 6b6c 652e  values = pickle.
-0000f1c0: 6c6f 6164 286f 7065 6e28 2273 696d 6261  load(open("simba
-0000f1d0: 2f61 7373 6574 732f 6c6f 6f6b 7570 732f  /assets/lookups/
-0000f1e0: 6372 6974 6963 616c 5f76 616c 7565 735f  critical_values_
-0000f1f0: 352e 7069 636b 6c65 222c 2022 7262 2229  5.pickle", "rb")
-0000f200: 295b 2763 6869 5f73 7175 6172 6527 5d5b  )['chi_square'][
-0000f210: 276f 6e65 5f74 6169 6c27 5d2e 7661 6c75  'one_tail'].valu
-0000f220: 6573 0a20 2020 2020 2020 203e 3e3e 2063  es.        >>> c
-0000f230: 6869 5f73 7175 6172 6528 7361 6d70 6c65  hi_square(sample
-0000f240: 5f31 3d73 616d 706c 655f 322c 2073 616d  _1=sample_2, sam
-0000f250: 706c 655f 323d 7361 6d70 6c65 5f31 2c20  ple_2=sample_1, 
-0000f260: 6372 6974 6963 616c 5f76 616c 7565 733d  critical_values=
-0000f270: 6372 6974 6963 616c 5f76 616c 7565 732c  critical_values,
-0000f280: 2074 7970 653d 2767 6f6f 646e 6573 735f   type='goodness_
-0000f290: 6f66 5f66 6974 2729 0a20 2020 2020 2020  of_fit').       
-0000f2a0: 203e 3e3e 2028 382e 3333 332c 2046 616c   >>> (8.333, Fal
-0000f2b0: 7365 290a 2020 2020 2020 2020 3e3e 3e0a  se).        >>>.
-0000f2c0: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
-0000f2d0: 2020 2020 2063 6869 5f73 7175 6172 652c       chi_square,
-0000f2e0: 2073 6967 6e69 6669 6361 6e63 655f 626f   significance_bo
-0000f2f0: 6f6c 203d 2030 2e30 2c20 4e6f 6e65 0a20  ol = 0.0, None. 
-0000f300: 2020 2020 2020 2075 6e69 7175 655f 6361         unique_ca
-0000f310: 7465 676f 7269 6573 203d 206e 702e 756e  tegories = np.un
-0000f320: 6971 7565 286e 702e 636f 6e63 6174 656e  ique(np.concaten
-0000f330: 6174 6528 2873 616d 706c 655f 312c 2073  ate((sample_1, s
-0000f340: 616d 706c 655f 3229 2929 0a20 2020 2020  ample_2))).     
-0000f350: 2020 2073 616d 706c 655f 315f 636f 756e     sample_1_coun
-0000f360: 7473 203d 206e 702e 7a65 726f 7328 6c65  ts = np.zeros(le
-0000f370: 6e28 756e 6971 7565 5f63 6174 6567 6f72  n(unique_categor
-0000f380: 6965 7329 2c20 6474 7970 653d 6e70 2e69  ies), dtype=np.i
-0000f390: 6e74 3634 290a 2020 2020 2020 2020 7361  nt64).        sa
-0000f3a0: 6d70 6c65 5f32 5f63 6f75 6e74 7320 3d20  mple_2_counts = 
-0000f3b0: 6e70 2e7a 6572 6f73 286c 656e 2875 6e69  np.zeros(len(uni
-0000f3c0: 7175 655f 6361 7465 676f 7269 6573 292c  que_categories),
-0000f3d0: 2064 7479 7065 3d6e 702e 696e 7436 3429   dtype=np.int64)
-0000f3e0: 0a0a 2020 2020 2020 2020 666f 7220 6920  ..        for i 
-0000f3f0: 696e 2070 7261 6e67 6528 6c65 6e28 756e  in prange(len(un
-0000f400: 6971 7565 5f63 6174 6567 6f72 6965 7329  ique_categories)
-0000f410: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
-0000f420: 616d 706c 655f 315f 636f 756e 7473 5b69  ample_1_counts[i
-0000f430: 5d2c 2073 616d 706c 655f 325f 636f 756e  ], sample_2_coun
-0000f440: 7473 5b69 5d20 3d20 6e70 2e73 756d 280a  ts[i] = np.sum(.
-0000f450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f460: 7361 6d70 6c65 5f31 203d 3d20 756e 6971  sample_1 == uniq
-0000f470: 7565 5f63 6174 6567 6f72 6965 735b 695d  ue_categories[i]
-0000f480: 0a20 2020 2020 2020 2020 2020 2029 2c20  .            ), 
-0000f490: 6e70 2e73 756d 2873 616d 706c 655f 3220  np.sum(sample_2 
-0000f4a0: 3d3d 2075 6e69 7175 655f 6361 7465 676f  == unique_catego
-0000f4b0: 7269 6573 5b69 5d29 0a0a 2020 2020 2020  ries[i])..      
-0000f4c0: 2020 666f 7220 6920 696e 2070 7261 6e67    for i in prang
-0000f4d0: 6528 6c65 6e28 756e 6971 7565 5f63 6174  e(len(unique_cat
-0000f4e0: 6567 6f72 6965 7329 293a 0a20 2020 2020  egories)):.     
-0000f4f0: 2020 2020 2020 2063 6f75 6e74 5f31 2c20         count_1, 
-0000f500: 636f 756e 745f 3220 3d20 7361 6d70 6c65  count_2 = sample
-0000f510: 5f31 5f63 6f75 6e74 735b 695d 2c20 7361  _1_counts[i], sa
-0000f520: 6d70 6c65 5f32 5f63 6f75 6e74 735b 695d  mple_2_counts[i]
-0000f530: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000f540: 636f 756e 745f 3220 3e20 303a 0a20 2020  count_2 > 0:.   
-0000f550: 2020 2020 2020 2020 2020 2020 2063 6869               chi
-0000f560: 5f73 7175 6172 6520 2b3d 2028 2863 6f75  _square += ((cou
-0000f570: 6e74 5f31 202d 2063 6f75 6e74 5f32 2920  nt_1 - count_2) 
-0000f580: 2a2a 2032 2920 2f20 636f 756e 745f 320a  ** 2) / count_2.
-0000f590: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0000f5a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000f5b0: 2020 6368 695f 7371 7561 7265 202b 3d20    chi_square += 
-0000f5c0: 2828 636f 756e 745f 3120 2d20 636f 756e  ((count_1 - coun
-0000f5d0: 745f 3229 202a 2a20 3229 202f 2028 636f  t_2) ** 2) / (co
-0000f5e0: 756e 745f 3220 2b20 3129 0a0a 2020 2020  unt_2 + 1)..    
-0000f5f0: 2020 2020 6966 2063 7269 7469 6361 6c5f      if critical_
-0000f600: 7661 6c75 6573 2069 7320 6e6f 7420 4e6f  values is not No
-0000f610: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-0000f620: 6966 2074 7970 6520 3d3d 2022 676f 6f64  if type == "good
-0000f630: 6e65 7373 5f6f 665f 6669 7422 3a0a 2020  ness_of_fit":.  
-0000f640: 2020 2020 2020 2020 2020 2020 2020 6466                df
-0000f650: 203d 2075 6e69 7175 655f 6361 7465 676f   = unique_catego
-0000f660: 7269 6573 2e73 6861 7065 5b30 5d20 2d20  ries.shape[0] - 
-0000f670: 310a 2020 2020 2020 2020 2020 2020 656c  1.            el
-0000f680: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0000f690: 2020 2020 6466 203d 2028 6c65 6e28 7361      df = (len(sa
-0000f6a0: 6d70 6c65 5f31 5f63 6f75 6e74 7329 202d  mple_1_counts) -
-0000f6b0: 2031 2920 2a20 286c 656e 2873 616d 706c   1) * (len(sampl
-0000f6c0: 655f 325f 636f 756e 7473 2920 2d20 3129  e_2_counts) - 1)
-0000f6d0: 0a0a 2020 2020 2020 2020 2020 2020 6372  ..            cr
-0000f6e0: 6974 6963 616c 5f76 616c 7565 203d 206e  itical_value = n
-0000f6f0: 702e 696e 7465 7270 2864 662c 2063 7269  p.interp(df, cri
-0000f700: 7469 6361 6c5f 7661 6c75 6573 5b3a 2c20  tical_values[:, 
-0000f710: 305d 2c20 6372 6974 6963 616c 5f76 616c  0], critical_val
-0000f720: 7565 735b 3a2c 2031 5d29 0a20 2020 2020  ues[:, 1]).     
-0000f730: 2020 2020 2020 2069 6620 6368 695f 7371         if chi_sq
-0000f740: 7561 7265 203e 3d20 6372 6974 6963 616c  uare >= critical
-0000f750: 5f76 616c 7565 3a0a 2020 2020 2020 2020  _value:.        
-0000f760: 2020 2020 2020 2020 7369 676e 6966 6963          signific
-0000f770: 616e 6365 5f62 6f6f 6c20 3d20 5472 7565  ance_bool = True
-0000f780: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-0000f790: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0000f7a0: 2020 2073 6967 6e69 6669 6361 6e63 655f     significance_
-0000f7b0: 626f 6f6c 203d 2046 616c 7365 0a0a 2020  bool = False..  
-0000f7c0: 2020 2020 2020 7265 7475 726e 2063 6869        return chi
-0000f7d0: 5f73 7175 6172 652c 2073 6967 6e69 6669  _square, signifi
-0000f7e0: 6361 6e63 655f 626f 6f6c 0a0a 2020 2020  cance_bool..    
-0000f7f0: 4073 7461 7469 636d 6574 686f 640a 2020  @staticmethod.  
-0000f800: 2020 406e 6a69 7428 2228 666c 6f61 7433    @njit("(float3
-0000f810: 325b 3a5d 2c20 666c 6f61 7433 322c 2066  2[:], float32, f
-0000f820: 6c6f 6174 3332 2c20 666c 6f61 7433 325b  loat32, float32[
-0000f830: 3a2c 3a5d 2c20 666c 6f61 7433 3229 2229  :,:], float32)")
-0000f840: 0a20 2020 2064 6566 2073 6c69 6469 6e67  .    def sliding
-0000f850: 5f69 6e64 6570 656e 6465 6e74 5f73 616d  _independent_sam
-0000f860: 706c 6573 5f74 280a 2020 2020 2020 2020  ples_t(.        
-0000f870: 6461 7461 3a20 6e70 2e6e 6461 7272 6179  data: np.ndarray
-0000f880: 2c0a 2020 2020 2020 2020 7469 6d65 5f77  ,.        time_w
-0000f890: 696e 646f 773a 2066 6c6f 6174 2c0a 2020  indow: float,.  
-0000f8a0: 2020 2020 2020 736c 6964 655f 7469 6d65        slide_time
-0000f8b0: 3a20 666c 6f61 742c 0a20 2020 2020 2020  : float,.       
-0000f8c0: 2063 7269 7469 6361 6c5f 7661 6c75 6573   critical_values
-0000f8d0: 3a20 6e70 2e6e 6461 7272 6179 2c0a 2020  : np.ndarray,.  
-0000f8e0: 2020 2020 2020 6670 733a 2066 6c6f 6174        fps: float
-0000f8f0: 2c0a 2020 2020 2920 2d3e 206e 702e 6e64  ,.    ) -> np.nd
-0000f900: 6172 7261 793a 0a20 2020 2020 2020 2022  array:.        "
-0000f910: 2222 0a20 2020 2020 2020 204a 6974 7465  "".        Jitte
-0000f920: 6420 636f 6d70 7574 6520 6f66 2073 6c69  d compute of sli
-0000f930: 6469 6e67 2069 6e64 6570 656e 6465 6e74  ding independent
-0000f940: 2073 616d 706c 6520 742d 7465 7374 2e20   sample t-test. 
-0000f950: 436f 6d70 6172 6573 2074 6865 2066 6561  Compares the fea
-0000f960: 7475 7265 2076 616c 7565 7320 696e 2063  ture values in c
-0000f970: 7572 7265 6e74 2074 696d 652d 7769 6e64  urrent time-wind
-0000f980: 6f77 0a20 2020 2020 2020 2074 6f20 7072  ow.        to pr
-0000f990: 696f 7220 7469 6d65 2d77 696e 646f 7773  ior time-windows
-0000f9a0: 2074 6f20 6669 6e64 2074 6865 206c 656e   to find the len
-0000f9b0: 6774 6820 696e 2074 696d 6520 746f 2074  gth in time to t
-0000f9c0: 6865 206d 6f73 7420 7265 6365 6e74 2074  he most recent t
-0000f9d0: 696d 652d 7769 6e64 6f77 2077 6865 7265  ime-window where
-0000f9e0: 2061 2073 6967 6e69 6669 6361 6e74 6c79   a significantly
-0000f9f0: 2064 6966 6665 7265 6e74 0a20 2020 2020   different.     
-0000fa00: 2020 2066 6561 7475 7265 2076 616c 7565     feature value
-0000fa10: 2064 6973 7472 6962 7574 696f 6e20 6973   distribution is
-0000fa20: 2064 6574 6563 7465 642e 0a0a 2020 2020   detected...    
-0000fa30: 2020 2020 2e2e 2069 6d61 6765 3a3a 205f      .. image:: _
-0000fa40: 7374 6174 6963 2f69 6d67 2f73 6c69 6469  static/img/slidi
-0000fa50: 6e67 5f73 7461 7469 7374 6963 732e 706e  ng_statistics.pn
-0000fa60: 670a 2020 2020 2020 2020 2020 203a 7769  g.           :wi
-0000fa70: 6474 683a 2031 3530 300a 2020 2020 2020  dth: 1500.      
-0000fa80: 2020 2020 203a 616c 6967 6e3a 2063 656e       :align: cen
-0000fa90: 7465 720a 0a20 2020 2020 2020 203a 7061  ter..        :pa
-0000faa0: 7261 6d65 7465 7220 6e64 6172 7261 7920  rameter ndarray 
-0000fab0: 6461 7461 3a20 3144 2061 7272 6179 2077  data: 1D array w
-0000fac0: 6974 6820 6665 6174 7572 6520 7661 6c75  ith feature valu
-0000fad0: 6573 2e0a 2020 2020 2020 2020 3a70 6172  es..        :par
-0000fae0: 616d 6574 6572 2066 6c6f 6174 2074 696d  ameter float tim
-0000faf0: 655f 7769 6e64 6f77 3a20 5468 6520 7369  e_window: The si
-0000fb00: 7a65 7320 6f66 2074 6865 2074 776f 2066  zes of the two f
-0000fb10: 6561 7475 7265 2076 616c 7565 2077 696e  eature value win
-0000fb20: 646f 7773 2062 6569 6e67 2063 6f6d 7061  dows being compa
-0000fb30: 7265 6420 696e 2073 6563 6f6e 6473 2e0a  red in seconds..
-0000fb40: 2020 2020 2020 2020 3a70 6172 616d 6574          :paramet
-0000fb50: 6572 2066 6c6f 6174 2073 6c69 6465 5f74  er float slide_t
-0000fb60: 696d 653a 2054 6865 2073 6c69 6465 2073  ime: The slide s
-0000fb70: 697a 6520 6f66 2074 6865 2073 6563 6f6e  ize of the secon
-0000fb80: 6420 7769 6e64 6f77 2e0a 2020 2020 2020  d window..      
-0000fb90: 2020 3a70 6172 616d 6574 6572 206e 6461    :parameter nda
-0000fba0: 7272 6179 2063 7269 7469 6361 6c5f 7661  rray critical_va
-0000fbb0: 6c75 6573 3a20 3244 2061 7272 6179 2077  lues: 2D array w
-0000fbc0: 6974 6820 7768 6572 6520 696e 6465 7865  ith where indexe
-0000fbd0: 7320 7265 7072 6573 656e 7420 6465 6772  s represent degr
-0000fbe0: 6565 7320 6f66 2066 7265 6564 6f6d 2061  ees of freedom a
-0000fbf0: 6e64 2076 616c 7565 730a 2020 2020 2020  nd values.      
-0000fc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fc20: 2020 2020 2020 7265 7072 6573 656e 7420        represent 
-0000fc30: 6372 6974 6963 616c 2054 2076 616c 7565  critical T value
-0000fc40: 732e 2043 616e 2062 6520 666f 756e 6420  s. Can be found 
-0000fc50: 696e 2060 6073 696d 6261 2e61 7373 6574  in ``simba.asset
-0000fc60: 732e 6372 6974 6963 616c 5f76 616c 7565  s.critical_value
-0000fc70: 735f 3035 2e70 6963 6b6c 6560 602e 0a20  s_05.pickle``.. 
-0000fc80: 2020 2020 2020 203a 7061 7261 6d65 7465         :paramete
-0000fc90: 7220 696e 7420 6670 733a 2054 6865 2066  r int fps: The f
-0000fca0: 7073 206f 6620 7468 6520 7265 636f 7264  ps of the record
-0000fcb0: 6564 2076 6964 656f 2e0a 2020 2020 2020  ed video..      
-0000fcc0: 2020 3a72 6574 7572 6e73 206e 702e 6e64    :returns np.nd
-0000fcd0: 6172 7261 793a 2031 4420 6172 7261 7920  array: 1D array 
-0000fce0: 6f66 2073 697a 6520 6c65 6e28 6461 7461  of size len(data
-0000fcf0: 2920 7769 7468 2076 616c 7565 7320 7265  ) with values re
-0000fd00: 7072 6573 656e 7469 6e67 2074 696d 6520  presenting time 
-0000fd10: 746f 206d 6f73 7420 7265 6365 6e74 2073  to most recent s
-0000fd20: 6967 6e69 6669 6361 6e74 6c79 2064 6966  ignificantly dif
-0000fd30: 6665 7265 6e74 2066 6561 7475 7265 2064  ferent feature d
-0000fd40: 6973 7472 6962 7574 696f 6e2e 0a0a 2020  istribution...  
-0000fd50: 2020 2020 2020 3a65 7861 6d70 6c65 3a0a        :example:.
-0000fd60: 2020 2020 2020 2020 3e3e 3e20 6461 7461          >>> data
-0000fd70: 203d 206e 702e 7261 6e64 6f6d 2e72 616e   = np.random.ran
-0000fd80: 6469 6e74 2830 2c20 3530 2c20 2831 3029  dint(0, 50, (10)
-0000fd90: 292e 6173 7479 7065 286e 702e 666c 6f61  ).astype(np.floa
-0000fda0: 7433 3229 0a20 2020 2020 2020 203e 3e3e  t32).        >>>
-0000fdb0: 2063 7269 7469 6361 6c5f 7661 6c75 6573   critical_values
-0000fdc0: 203d 2070 6963 6b6c 652e 6c6f 6164 286f   = pickle.load(o
-0000fdd0: 7065 6e28 2273 696d 6261 2f61 7373 6574  pen("simba/asset
-0000fde0: 732f 6c6f 6f6b 7570 732f 6372 6974 6963  s/lookups/critic
-0000fdf0: 616c 5f76 616c 7565 735f 3035 2e70 6963  al_values_05.pic
-0000fe00: 6b6c 6522 2c20 2272 6222 2929 5b27 696e  kle", "rb"))['in
-0000fe10: 6465 7065 6e64 656e 745f 745f 7465 7374  dependent_t_test
-0000fe20: 275d 5b27 6f6e 655f 7461 696c 275d 2e76  ']['one_tail'].v
-0000fe30: 616c 7565 732e 6173 7479 7065 286e 702e  alues.astype(np.
-0000fe40: 666c 6f61 7433 3229 0a20 2020 2020 2020  float32).       
-0000fe50: 203e 3e3e 2072 6573 756c 7473 203d 2053   >>> results = S
-0000fe60: 7461 7469 7374 6963 7328 292e 736c 6964  tatistics().slid
-0000fe70: 696e 675f 696e 6465 7065 6e64 656e 745f  ing_independent_
-0000fe80: 7361 6d70 6c65 735f 7428 6461 7461 3d64  samples_t(data=d
-0000fe90: 6174 612c 2074 696d 655f 7769 6e64 6f77  ata, time_window
-0000fea0: 3d30 2e35 2c20 6670 733d 352e 302c 2063  =0.5, fps=5.0, c
-0000feb0: 7269 7469 6361 6c5f 7661 6c75 6573 3d63  ritical_values=c
-0000fec0: 7269 7469 6361 6c5f 7661 6c75 6573 2c20  ritical_values, 
-0000fed0: 736c 6964 655f 7469 6d65 3d30 2e33 3029  slide_time=0.30)
-0000fee0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-0000fef0: 2020 2020 2020 7265 7375 6c74 7320 3d20        results = 
-0000ff00: 6e70 2e66 756c 6c28 2864 6174 612e 7368  np.full((data.sh
-0000ff10: 6170 655b 305d 292c 2030 2e30 290a 2020  ape[0]), 0.0).  
-0000ff20: 2020 2020 2020 7769 6e64 6f77 5f73 697a        window_siz
-0000ff30: 652c 2073 6c69 6465 5f73 697a 6520 3d20  e, slide_size = 
-0000ff40: 696e 7428 7469 6d65 5f77 696e 646f 7720  int(time_window 
-0000ff50: 2a20 6670 7329 2c20 696e 7428 736c 6964  * fps), int(slid
-0000ff60: 655f 7469 6d65 202a 2066 7073 290a 2020  e_time * fps).  
-0000ff70: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-0000ff80: 616e 6765 2831 2c20 6461 7461 2e73 6861  ange(1, data.sha
-0000ff90: 7065 5b30 5d29 3a0a 2020 2020 2020 2020  pe[0]):.        
-0000ffa0: 2020 2020 7361 6d70 6c65 5f31 5f6c 6566      sample_1_lef
-0000ffb0: 742c 2073 616d 706c 655f 315f 7269 6768  t, sample_1_righ
-0000ffc0: 7420 3d20 692c 2069 202b 2077 696e 646f  t = i, i + windo
-0000ffd0: 775f 7369 7a65 0a20 2020 2020 2020 2020  w_size.         
-0000ffe0: 2020 2073 616d 706c 655f 325f 6c65 6674     sample_2_left
-0000fff0: 2c20 7361 6d70 6c65 5f32 5f72 6967 6874  , sample_2_right
-00010000: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-00010010: 2020 2020 2073 616d 706c 655f 315f 6c65       sample_1_le
-00010020: 6674 202d 2073 6c69 6465 5f73 697a 652c  ft - slide_size,
-00010030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010040: 2073 616d 706c 655f 315f 7269 6768 7420   sample_1_right 
-00010050: 2d20 736c 6964 655f 7369 7a65 2c0a 2020  - slide_size,.  
-00010060: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00010070: 2020 2020 2020 2020 7361 6d70 6c65 5f31          sample_1
-00010080: 203d 2064 6174 615b 7361 6d70 6c65 5f31   = data[sample_1
-00010090: 5f6c 6566 743a 7361 6d70 6c65 5f31 5f72  _left:sample_1_r
-000100a0: 6967 6874 5d0a 2020 2020 2020 2020 2020  ight].          
-000100b0: 2020 646f 662c 2073 7465 7073 5f74 616b    dof, steps_tak
-000100c0: 656e 203d 2028 7361 6d70 6c65 5f31 2e73  en = (sample_1.s
-000100d0: 6861 7065 5b30 5d20 2b20 7361 6d70 6c65  hape[0] + sample
-000100e0: 5f31 2e73 6861 7065 5b30 5d29 202d 2032  _1.shape[0]) - 2
-000100f0: 2c20 310a 2020 2020 2020 2020 2020 2020  , 1.            
-00010100: 7768 696c 6520 7361 6d70 6c65 5f32 5f6c  while sample_2_l
-00010110: 6566 7420 3e3d 2030 3a0a 2020 2020 2020  eft >= 0:.      
-00010120: 2020 2020 2020 2020 2020 7361 6d70 6c65            sample
-00010130: 5f32 203d 2064 6174 615b 7361 6d70 6c65  _2 = data[sample
-00010140: 5f32 5f6c 6566 743a 7361 6d70 6c65 5f32  _2_left:sample_2
-00010150: 5f72 6967 6874 5d0a 2020 2020 2020 2020  _right].        
-00010160: 2020 2020 2020 2020 745f 7374 6174 6973          t_statis
-00010170: 7469 6320 3d20 286e 702e 6d65 616e 2873  tic = (np.mean(s
-00010180: 616d 706c 655f 3129 202d 206e 702e 6d65  ample_1) - np.me
-00010190: 616e 2873 616d 706c 655f 3229 2920 2f20  an(sample_2)) / 
-000101a0: 6e70 2e73 7172 7428 0a20 2020 2020 2020  np.sqrt(.       
-000101b0: 2020 2020 2020 2020 2020 2020 2028 6e70               (np
-000101c0: 2e73 7464 2873 616d 706c 655f 3129 202f  .std(sample_1) /
-000101d0: 2073 616d 706c 655f 312e 7368 6170 655b   sample_1.shape[
-000101e0: 305d 290a 2020 2020 2020 2020 2020 2020  0]).            
-000101f0: 2020 2020 2020 2020 2b20 286e 702e 7374          + (np.st
-00010200: 6428 7361 6d70 6c65 5f32 2920 2f20 7361  d(sample_2) / sa
-00010210: 6d70 6c65 5f31 2e73 6861 7065 5b30 5d29  mple_1.shape[0])
-00010220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010230: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-00010240: 2020 2063 7269 7469 6361 6c5f 7661 6c20     critical_val 
-00010250: 3d20 6372 6974 6963 616c 5f76 616c 7565  = critical_value
-00010260: 735b 646f 6620 2d20 315d 5b31 5d0a 2020  s[dof - 1][1].  
-00010270: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00010280: 2074 5f73 7461 7469 7374 6963 203e 3d20   t_statistic >= 
-00010290: 6372 6974 6963 616c 5f76 616c 3a0a 2020  critical_val:.  
-000102a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000102b0: 2020 6272 6561 6b0a 2020 2020 2020 2020    break.        
-000102c0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-000102d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000102e0: 2020 7361 6d70 6c65 5f32 5f6c 6566 7420    sample_2_left 
-000102f0: 2d3d 2031 0a20 2020 2020 2020 2020 2020  -= 1.           
-00010300: 2020 2020 2020 2020 2073 616d 706c 655f           sample_
-00010310: 325f 7269 6768 7420 2d3d 2031 0a20 2020  2_right -= 1.   
-00010320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010330: 2073 7465 7073 5f74 616b 656e 202b 3d20   steps_taken += 
-00010340: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
-00010350: 2020 6966 2073 616d 706c 655f 325f 6c65    if sample_2_le
-00010360: 6674 203c 2030 3a0a 2020 2020 2020 2020  ft < 0:.        
-00010370: 2020 2020 2020 2020 2020 2020 7374 6570              step
-00010380: 735f 7461 6b65 6e20 3d20 2d31 0a20 2020  s_taken = -1.   
-00010390: 2020 2020 2020 2020 2069 6620 7374 6570           if step
-000103a0: 735f 7461 6b65 6e20 3d3d 202d 313a 0a20  s_taken == -1:. 
-000103b0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000103c0: 6573 756c 7473 5b69 202b 2077 696e 646f  esults[i + windo
-000103d0: 775f 7369 7a65 5d20 3d20 2d31 0a20 2020  w_size] = -1.   
-000103e0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-000103f0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00010400: 6573 756c 7473 5b69 202b 2077 696e 646f  esults[i + windo
-00010410: 775f 7369 7a65 5d20 3d20 7374 6570 735f  w_size] = steps_
-00010420: 7461 6b65 6e20 2a20 736c 6964 655f 7469  taken * slide_ti
-00010430: 6d65 0a0a 2020 2020 2020 2020 7265 7475  me..        retu
-00010440: 726e 2072 6573 756c 7473 0a0a 2020 2020  rn results..    
-00010450: 4073 7461 7469 636d 6574 686f 640a 2020  @staticmethod.  
-00010460: 2020 406e 6a69 7428 2228 666c 6f61 7433    @njit("(float3
-00010470: 325b 3a5d 2c20 666c 6f61 7436 345b 3a5d  2[:], float64[:]
-00010480: 2c20 666c 6f61 7433 3229 2229 0a20 2020  , float32)").   
-00010490: 2064 6566 2072 6f6c 6c69 6e67 5f6d 616e   def rolling_man
-000104a0: 6e5f 7768 6974 6e65 7928 6461 7461 3a20  n_whitney(data: 
-000104b0: 6e70 2e6e 6461 7272 6179 2c20 7469 6d65  np.ndarray, time
-000104c0: 5f77 696e 646f 7773 3a20 6e70 2e6e 6461  _windows: np.nda
-000104d0: 7272 6179 2c20 6670 733a 2066 6c6f 6174  rray, fps: float
-000104e0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-000104f0: 2020 2020 2020 204a 6974 7465 6420 636f         Jitted co
-00010500: 6d70 7574 6520 6f66 2072 6f6c 6c69 6e67  mpute of rolling
-00010510: 204d 616e 6e2d 5768 6974 6e65 7920 5520   Mann-Whitney U 
-00010520: 636f 6d70 6172 696e 6720 7468 6520 6375  comparing the cu
-00010530: 7272 656e 7420 7469 6d65 2d77 696e 646f  rrent time-windo
-00010540: 7720 6f66 0a20 2020 2020 2020 2073 697a  w of.        siz
-00010550: 6520 4e20 746f 2074 6865 2070 7265 6365  e N to the prece
-00010560: 6469 6e67 2077 696e 646f 7720 6f66 2073  ding window of s
-00010570: 697a 6520 4e2e 0a0a 2020 2020 2020 2020  ize N...        
-00010580: 2e2e 206e 6f74 653a 3a0a 2020 2020 2020  .. note::.      
-00010590: 2020 2020 2046 6972 7374 2074 696d 6520       First time 
-000105a0: 6269 6e20 2877 6865 7265 2068 6173 206e  bin (where has n
-000105b0: 6f20 7072 6563 6564 696e 6720 7469 6d65  o preceding time
-000105c0: 2062 696e 2920 7769 6c6c 2068 6176 6520   bin) will have 
-000105d0: 6669 6c6c 2076 616c 7565 2060 6030 6060  fill value ``0``
-000105e0: 0a0a 2020 2020 2020 2020 2020 2060 4d6f  ..           `Mo
-000105f0: 6469 6669 6564 2066 726f 6d20 4a61 6d65  dified from Jame
-00010600: 7320 5765 6262 6572 2067 6973 7420 3c68  s Webber gist <h
-00010610: 7474 7073 3a2f 2f67 6973 742e 6769 7468  ttps://gist.gith
-00010620: 7562 2e63 6f6d 2f6a 616d 6573 7477 6562  ub.com/jamestweb
-00010630: 6265 722f 3338 6162 3236 6432 3831 6639  ber/38ab26d281f9
-00010640: 3766 6562 3831 3936 6233 6439 3365 6465  7feb8196b3d93ede
-00010650: 6562 3762 3e60 5f5f 2e0a 0a20 2020 2020  eb7b>`__...     
-00010660: 2020 203a 7061 7261 6d65 7465 7220 6e64     :parameter nd
-00010670: 6172 7261 7920 7361 6d70 6c65 5f31 3a20  array sample_1: 
-00010680: 4669 7273 7420 3164 2061 7272 6179 2072  First 1d array r
-00010690: 6570 7265 7365 6e74 696e 6720 6665 6174  epresenting feat
-000106a0: 7572 6520 7661 6c75 6573 2e0a 2020 2020  ure values..    
-000106b0: 2020 2020 3a70 6172 616d 6574 6572 206e      :parameter n
-000106c0: 6461 7272 6179 2073 616d 706c 655f 323a  darray sample_2:
-000106d0: 2053 6563 6f6e 6420 3164 2061 7272 6179   Second 1d array
-000106e0: 2072 6570 7265 7365 6e74 696e 6720 6665   representing fe
-000106f0: 6174 7572 6520 7661 6c75 6573 2e0a 2020  ature values..  
-00010700: 2020 2020 2020 3a72 6574 7572 6e73 206e        :returns n
-00010710: 702e 6e64 6172 7261 793a 204d 616e 6e2d  p.ndarray: Mann-
-00010720: 5768 6974 6e65 7920 5520 6461 7461 206f  Whitney U data o
-00010730: 6620 7369 7a65 206c 656e 2864 6174 6129  f size len(data)
-00010740: 2078 206c 656e 2874 696d 655f 7769 6e64   x len(time_wind
-00010750: 6f77 7329 2e0a 0a20 2020 2020 2020 203a  ows)...        :
-00010760: 6578 616d 706c 6573 3a0a 2020 2020 2020  examples:.      
-00010770: 2020 3e3e 3e20 6461 7461 203d 206e 702e    >>> data = np.
-00010780: 7261 6e64 6f6d 2e72 616e 6469 6e74 2830  random.randint(0
-00010790: 2c20 342c 2028 3230 3029 292e 6173 7479  , 4, (200)).asty
-000107a0: 7065 286e 702e 666c 6f61 7433 3229 0a20  pe(np.float32). 
-000107b0: 2020 2020 2020 203e 3e3e 2072 6573 756c         >>> resul
-000107c0: 7473 203d 2053 7461 7469 7374 6963 7328  ts = Statistics(
-000107d0: 292e 726f 6c6c 696e 675f 6d61 6e6e 5f77  ).rolling_mann_w
-000107e0: 6869 746e 6579 2864 6174 613d 6461 7461  hitney(data=data
-000107f0: 2c20 7469 6d65 5f77 696e 646f 7773 3d6e  , time_windows=n
-00010800: 702e 6172 7261 7928 5b31 2e30 5d29 2c20  p.array([1.0]), 
-00010810: 6670 733d 3129 0a20 2020 2020 2020 2022  fps=1).        "
-00010820: 2222 0a0a 2020 2020 2020 2020 7265 7375  ""..        resu
-00010830: 6c74 7320 3d20 6e70 2e66 756c 6c28 2864  lts = np.full((d
-00010840: 6174 612e 7368 6170 655b 305d 2c20 7469  ata.shape[0], ti
-00010850: 6d65 5f77 696e 646f 7773 2e73 6861 7065  me_windows.shape
-00010860: 5b30 5d29 2c20 302e 3029 0a20 2020 2020  [0]), 0.0).     
-00010870: 2020 2066 6f72 2069 2069 6e20 7072 616e     for i in pran
-00010880: 6765 2874 696d 655f 7769 6e64 6f77 732e  ge(time_windows.
-00010890: 7368 6170 655b 305d 293a 0a20 2020 2020  shape[0]):.     
-000108a0: 2020 2020 2020 2077 696e 646f 775f 7369         window_si
-000108b0: 7a65 203d 2069 6e74 2874 696d 655f 7769  ze = int(time_wi
-000108c0: 6e64 6f77 735b 695d 202a 2066 7073 290a  ndows[i] * fps).
-000108d0: 2020 2020 2020 2020 2020 2020 6461 7461              data
-000108e0: 5f73 706c 6974 203d 206e 702e 7370 6c69  _split = np.spli
-000108f0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00010900: 2020 2064 6174 612c 206c 6973 7428 7261     data, list(ra
-00010910: 6e67 6528 7769 6e64 6f77 5f73 697a 652c  nge(window_size,
-00010920: 2064 6174 612e 7368 6170 655b 305d 2c20   data.shape[0], 
-00010930: 7769 6e64 6f77 5f73 697a 6529 290a 2020  window_size)).  
-00010940: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00010950: 2020 2020 2020 2020 666f 7220 6a20 696e          for j in
-00010960: 2070 7261 6e67 6528 312c 206c 656e 2864   prange(1, len(d
-00010970: 6174 615f 7370 6c69 7429 293a 0a20 2020  ata_split)):.   
-00010980: 2020 2020 2020 2020 2020 2020 2077 696e               win
-00010990: 646f 775f 7374 6172 7420 3d20 696e 7428  dow_start = int(
-000109a0: 7769 6e64 6f77 5f73 697a 6520 2a20 6a29  window_size * j)
-000109b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000109c0: 2077 696e 646f 775f 656e 6420 3d20 696e   window_end = in
-000109d0: 7428 7769 6e64 6f77 5f73 7461 7274 202b  t(window_start +
-000109e0: 2077 696e 646f 775f 7369 7a65 290a 2020   window_size).  
-000109f0: 2020 2020 2020 2020 2020 2020 2020 7361                sa
-00010a00: 6d70 6c65 5f31 2c20 7361 6d70 6c65 5f32  mple_1, sample_2
-00010a10: 203d 2064 6174 615f 7370 6c69 745b 6a20   = data_split[j 
-00010a20: 2d20 315d 2e61 7374 7970 6528 6e70 2e66  - 1].astype(np.f
-00010a30: 6c6f 6174 3332 292c 2064 6174 615f 7370  loat32), data_sp
-00010a40: 6c69 745b 0a20 2020 2020 2020 2020 2020  lit[.           
-00010a50: 2020 2020 2020 2020 206a 0a20 2020 2020           j.     
-00010a60: 2020 2020 2020 2020 2020 205d 2e61 7374             ].ast
-00010a70: 7970 6528 6e70 2e66 6c6f 6174 3332 290a  ype(np.float32).
-00010a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010a90: 6e31 2c20 6e32 203d 2073 616d 706c 655f  n1, n2 = sample_
-00010aa0: 312e 7368 6170 655b 305d 2c20 7361 6d70  1.shape[0], samp
-00010ab0: 6c65 5f32 2e73 6861 7065 5b30 5d0a 2020  le_2.shape[0].  
-00010ac0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00010ad0: 6e6b 6564 203d 2066 6173 745f 6d65 616e  nked = fast_mean
-00010ae0: 5f72 616e 6b28 6e70 2e63 6f6e 6361 7465  _rank(np.concate
-00010af0: 6e61 7465 2828 7361 6d70 6c65 5f31 2c20  nate((sample_1, 
-00010b00: 7361 6d70 6c65 5f32 2929 290a 2020 2020  sample_2))).    
-00010b10: 2020 2020 2020 2020 2020 2020 7531 203d              u1 =
-00010b20: 206e 3120 2a20 6e32 202b 2028 6e31 202a   n1 * n2 + (n1 *
-00010b30: 2028 6e31 202b 2031 2929 202f 2032 2e30   (n1 + 1)) / 2.0
-00010b40: 202d 206e 702e 7375 6d28 7261 6e6b 6564   - np.sum(ranked
-00010b50: 5b3a 6e31 5d2c 2061 7869 733d 3029 0a20  [:n1], axis=0). 
-00010b60: 2020 2020 2020 2020 2020 2020 2020 2075                 u
-00010b70: 3220 3d20 6e31 202a 206e 3220 2d20 7531  2 = n1 * n2 - u1
-00010b80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010b90: 2075 203d 206d 696e 2875 312c 2075 3229   u = min(u1, u2)
-00010ba0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010bb0: 2072 6573 756c 7473 5b77 696e 646f 775f   results[window_
-00010bc0: 7374 6172 743a 7769 6e64 6f77 5f65 6e64  start:window_end
-00010bd0: 2c20 695d 203d 2075 0a0a 2020 2020 2020  , i] = u..      
-00010be0: 2020 7265 7475 726e 2072 6573 756c 7473    return results
-00010bf0: 0a0a 2020 2020 6465 6620 6368 6f77 5f74  ..    def chow_t
-00010c00: 6573 7428 7365 6c66 293a 0a20 2020 2020  est(self):.     
-00010c10: 2020 2070 6173 730a 0a20 2020 2040 7374     pass..    @st
-00010c20: 6174 6963 6d65 7468 6f64 0a20 2020 2040  aticmethod.    @
-00010c30: 6e6a 6974 2822 2866 6c6f 6174 3332 5b3a  njit("(float32[:
-00010c40: 5d2c 2066 6c6f 6174 3332 5b3a 5d2c 2066  ], float32[:], f
-00010c50: 6c6f 6174 3634 5b3a 5d2c 2069 6e74 3634  loat64[:], int64
-00010c60: 2922 290a 2020 2020 6465 6620 736c 6964  )").    def slid
-00010c70: 696e 675f 7370 6561 726d 616e 5f72 616e  ing_spearman_ran
-00010c80: 6b5f 636f 7272 656c 6174 696f 6e28 0a20  k_correlation(. 
-00010c90: 2020 2020 2020 2073 616d 706c 655f 313a         sample_1:
-00010ca0: 206e 702e 6e64 6172 7261 792c 2073 616d   np.ndarray, sam
-00010cb0: 706c 655f 323a 206e 702e 6e64 6172 7261  ple_2: np.ndarra
-00010cc0: 792c 2074 696d 655f 7769 6e64 6f77 733a  y, time_windows:
-00010cd0: 206e 702e 6e64 6172 7261 792c 2066 7073   np.ndarray, fps
-00010ce0: 3a20 696e 740a 2020 2020 2920 2d3e 206e  : int.    ) -> n
-00010cf0: 702e 6e64 6172 7261 793a 0a20 2020 2020  p.ndarray:.     
-00010d00: 2020 2022 2222 0a20 2020 2020 2020 2047     """.        G
-00010d10: 6976 656e 2074 776f 2031 4420 6172 7261  iven two 1D arra
-00010d20: 7973 206f 6620 7369 7a65 204e 2c20 6372  ys of size N, cr
-00010d30: 6561 7465 2073 6c69 6469 6e67 2077 696e  eate sliding win
-00010d40: 646f 7720 6f66 2073 697a 6520 7469 6d65  dow of size time
-00010d50: 5f77 696e 646f 7773 5b69 5d20 2a20 6670  _windows[i] * fp
-00010d60: 7320 616e 6420 7265 7475 726e 2053 7065  s and return Spe
-00010d70: 6172 6d61 6e27 7320 7261 6e6b 2063 6f72  arman's rank cor
-00010d80: 7265 6c61 7469 6f6e 0a20 2020 2020 2020  relation.       
-00010d90: 2062 6574 7765 656e 2074 6865 2076 616c   between the val
-00010da0: 7565 7320 696e 2074 6865 2074 776f 2031  ues in the two 1
-00010db0: 4420 6172 7261 7973 2069 6e20 6561 6368  D arrays in each
-00010dc0: 2077 696e 646f 772e 2041 6464 7265 7373   window. Address
-00010dd0: 2022 7768 6174 2069 7320 7468 6520 636f   "what is the co
-00010de0: 7272 656c 6174 696f 6e20 6265 7477 6565  rrelation betwee
-00010df0: 6e20 4665 6174 7572 6520 3120 616e 640a  n Feature 1 and.
-00010e00: 2020 2020 2020 2020 4665 6174 7572 6520          Feature 
-00010e10: 3220 696e 2074 6865 2063 7572 7265 6e74  2 in the current
-00010e20: 2058 2e58 2073 6563 6f6e 6473 206f 6620   X.X seconds of 
-00010e30: 7468 6520 7669 6465 6f2e 0a0a 2020 2020  the video...    
-00010e40: 2020 2020 2e2e 2069 6d61 6765 3a3a 205f      .. image:: _
-00010e50: 7374 6174 6963 2f69 6d67 2f73 6c69 6469  static/img/slidi
-00010e60: 6e67 5f73 7065 6172 6d61 6e2e 706e 670a  ng_spearman.png.
-00010e70: 2020 2020 2020 2020 2020 203a 7769 6474             :widt
-00010e80: 683a 2036 3030 0a20 2020 2020 2020 2020  h: 600.         
-00010e90: 2020 3a61 6c69 676e 3a20 6365 6e74 6572    :align: center
-00010ea0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00010eb0: 6574 6572 206e 6461 7272 6179 2073 616d  eter ndarray sam
-00010ec0: 706c 655f 313a 2046 6972 7374 2031 4420  ple_1: First 1D 
-00010ed0: 6172 7261 7920 7769 7468 2066 6561 7475  array with featu
-00010ee0: 7265 2076 616c 7565 732e 0a20 2020 2020  re values..     
-00010ef0: 2020 203a 7061 7261 6d65 7465 7220 6e64     :parameter nd
-00010f00: 6172 7261 7920 7361 6d70 6c65 5f31 3a20  array sample_1: 
-00010f10: 5365 636f 6e64 2031 4420 6172 7261 7920  Second 1D array 
-00010f20: 7769 7468 2066 6561 7475 7265 2076 616c  with feature val
-00010f30: 7565 732e 0a20 2020 2020 2020 203a 7061  ues..        :pa
-00010f40: 7261 6d65 7465 7220 666c 6f61 7420 7469  rameter float ti
-00010f50: 6d65 5f77 696e 646f 7773 3a20 5468 6520  me_windows: The 
-00010f60: 6c65 6e67 7468 206f 6620 7468 6520 736c  length of the sl
-00010f70: 6964 696e 6720 7769 6e64 6f77 2069 6e20  iding window in 
-00010f80: 7365 636f 6e64 732e 0a20 2020 2020 2020  seconds..       
-00010f90: 203a 7061 7261 6d65 7465 7220 696e 7420   :parameter int 
-00010fa0: 6670 733a 2054 6865 2066 7073 206f 6620  fps: The fps of 
-00010fb0: 7468 6520 7265 636f 7264 6564 2076 6964  the recorded vid
-00010fc0: 656f 2e0a 2020 2020 2020 2020 3a72 6574  eo..        :ret
-00010fd0: 7572 6e73 206e 702e 6e64 6172 7261 793a  urns np.ndarray:
-00010fe0: 2032 6420 6172 7261 7920 6f66 2053 6f65   2d array of Soe
-00010ff0: 6172 6d61 6e27 7320 7261 6e6b 7320 6f66  arman's ranks of
-00011000: 2073 697a 6520 6c65 6e28 7361 6d70 6c65   size len(sample
-00011010: 5f31 2920 7820 6c65 6e28 7469 6d65 5f77  _1) x len(time_w
-00011020: 696e 646f 7773 292e 204e 6f74 652c 2069  indows). Note, i
-00011030: 6620 736c 6964 696e 6720 7769 6e64 6f77  f sliding window
-00011040: 2069 7320 3130 2066 7261 6d65 732c 2074   is 10 frames, t
-00011050: 6865 2066 6972 7374 2039 2065 6e74 7269  he first 9 entri
-00011060: 6573 2077 696c 6c20 6265 2066 696c 6c65  es will be fille
-00011070: 6420 7769 7468 2030 2e20 5468 6520 3130  d with 0. The 10
-00011080: 7468 2076 616c 7565 2072 6570 7265 7365  th value represe
-00011090: 6e74 7320 7468 6520 636f 7272 656c 6174  nts the correlat
-000110a0: 696f 6e20 696e 2074 6865 2066 6972 7374  ion in the first
-000110b0: 2031 3020 6672 616d 6573 2e0a 0a20 2020   10 frames...   
-000110c0: 2020 2020 203a 6578 616d 706c 653a 0a20       :example:. 
-000110d0: 2020 2020 2020 203e 3e3e 2073 616d 706c         >>> sampl
-000110e0: 655f 3120 3d20 6e70 2e61 7272 6179 285b  e_1 = np.array([
-000110f0: 392c 3130 2c31 332c 3232 2c31 352c 3138  9,10,13,22,15,18
-00011100: 2c31 352c 3139 2c33 322c 3131 5d29 2e61  ,15,19,32,11]).a
-00011110: 7374 7970 6528 6e70 2e66 6c6f 6174 3332  stype(np.float32
-00011120: 290a 2020 2020 2020 2020 3e3e 3e20 7361  ).        >>> sa
-00011130: 6d70 6c65 5f32 203d 206e 702e 6172 7261  mple_2 = np.arra
-00011140: 7928 5b31 312c 2031 322c 2031 352c 2031  y([11, 12, 15, 1
-00011150: 392c 2032 312c 2032 362c 2031 392c 2032  9, 21, 26, 19, 2
-00011160: 302c 2032 322c 2031 395d 292e 6173 7479  0, 22, 19]).asty
-00011170: 7065 286e 702e 666c 6f61 7433 3229 0a20  pe(np.float32). 
-00011180: 2020 2020 2020 203e 3e3e 2053 7461 7469         >>> Stati
-00011190: 7374 6963 7328 292e 736c 6964 696e 675f  stics().sliding_
-000111a0: 7370 6561 726d 616e 5f72 616e 6b5f 636f  spearman_rank_co
-000111b0: 7272 656c 6174 696f 6e28 7361 6d70 6c65  rrelation(sample
-000111c0: 5f31 3d73 616d 706c 655f 312c 2073 616d  _1=sample_1, sam
-000111d0: 706c 655f 323d 7361 6d70 6c65 5f32 2c20  ple_2=sample_2, 
-000111e0: 7469 6d65 5f77 696e 646f 7773 3d6e 702e  time_windows=np.
-000111f0: 6172 7261 7928 5b30 2e35 5d29 2c20 6670  array([0.5]), fp
-00011200: 733d 3130 290a 2020 2020 2020 2020 2222  s=10).        ""
-00011210: 220a 0a20 2020 2020 2020 2072 6573 756c  "..        resul
-00011220: 7473 203d 206e 702e 6675 6c6c 2828 7361  ts = np.full((sa
-00011230: 6d70 6c65 5f31 2e73 6861 7065 5b30 5d2c  mple_1.shape[0],
-00011240: 2074 696d 655f 7769 6e64 6f77 732e 7368   time_windows.sh
-00011250: 6170 655b 305d 292c 2030 2e30 290a 2020  ape[0]), 0.0).  
-00011260: 2020 2020 2020 666f 7220 6920 696e 2070        for i in p
-00011270: 7261 6e67 6528 7469 6d65 5f77 696e 646f  range(time_windo
-00011280: 7773 2e73 6861 7065 5b30 5d29 3a0a 2020  ws.shape[0]):.  
-00011290: 2020 2020 2020 2020 2020 7769 6e64 6f77            window
-000112a0: 5f73 697a 6520 3d20 696e 7428 7469 6d65  _size = int(time
-000112b0: 5f77 696e 646f 7773 5b69 5d20 2a20 6670  _windows[i] * fp
-000112c0: 7329 0a20 2020 2020 2020 2020 2020 2066  s).            f
-000112d0: 6f72 206c 6566 742c 2072 6967 6874 2069  or left, right i
-000112e0: 6e20 7a69 7028 0a20 2020 2020 2020 2020  n zip(.         
-000112f0: 2020 2020 2020 2070 7261 6e67 6528 302c         prange(0,
-00011300: 2073 616d 706c 655f 312e 7368 6170 655b   sample_1.shape[
-00011310: 305d 202b 2031 292c 0a20 2020 2020 2020  0] + 1),.       
-00011320: 2020 2020 2020 2020 2070 7261 6e67 6528           prange(
-00011330: 7769 6e64 6f77 5f73 697a 652c 2073 616d  window_size, sam
-00011340: 706c 655f 312e 7368 6170 655b 305d 202b  ple_1.shape[0] +
-00011350: 2031 292c 0a20 2020 2020 2020 2020 2020   1),.           
-00011360: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
-00011370: 2020 2020 7331 2c20 7332 203d 2073 616d      s1, s2 = sam
-00011380: 706c 655f 315b 6c65 6674 3a72 6967 6874  ple_1[left:right
-00011390: 5d2c 2073 616d 706c 655f 325b 6c65 6674  ], sample_2[left
-000113a0: 3a72 6967 6874 5d0a 2020 2020 2020 2020  :right].        
-000113b0: 2020 2020 2020 2020 7261 6e6b 5f78 2c20          rank_x, 
-000113c0: 7261 6e6b 5f79 203d 206e 702e 6172 6773  rank_y = np.args
-000113d0: 6f72 7428 6e70 2e61 7267 736f 7274 2873  ort(np.argsort(s
-000113e0: 3129 292c 206e 702e 6172 6773 6f72 7428  1)), np.argsort(
-000113f0: 6e70 2e61 7267 736f 7274 2873 3229 290a  np.argsort(s2)).
-00011400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011410: 645f 7371 7561 7265 6420 3d20 6e70 2e73  d_squared = np.s
-00011420: 756d 2828 7261 6e6b 5f78 202d 2072 616e  um((rank_x - ran
-00011430: 6b5f 7929 202a 2a20 3229 0a20 2020 2020  k_y) ** 2).     
-00011440: 2020 2020 2020 2020 2020 2073 203d 2031             s = 1
-00011450: 202d 2028 3620 2a20 645f 7371 7561 7265   - (6 * d_square
-00011460: 6429 202f 2028 6c65 6e28 7331 2920 2a20  d) / (len(s1) * 
-00011470: 286c 656e 2873 3229 202a 2a20 3220 2d20  (len(s2) ** 2 - 
-00011480: 3129 290a 2020 2020 2020 2020 2020 2020  1)).            
-00011490: 2020 2020 7265 7375 6c74 735b 7269 6768      results[righ
-000114a0: 7420 2d20 312c 2069 5d20 3d20 730a 0a20  t - 1, i] = s.. 
-000114b0: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-000114c0: 7375 6c74 730a 0a20 2020 2040 7374 6174  sults..    @stat
-000114d0: 6963 6d65 7468 6f64 0a20 2020 2040 6e6a  icmethod.    @nj
-000114e0: 6974 2822 2866 6c6f 6174 3332 5b3a 5d2c  it("(float32[:],
-000114f0: 2066 6c6f 6174 3634 2c20 666c 6f61 7436   float64, float6
-00011500: 342c 2066 6c6f 6174 3634 2922 290a 2020  4, float64)").  
-00011510: 2020 6465 6620 736c 6964 696e 675f 6175    def sliding_au
-00011520: 746f 636f 7272 656c 6174 696f 6e28 0a20  tocorrelation(. 
-00011530: 2020 2020 2020 2064 6174 613a 206e 702e         data: np.
-00011540: 6e64 6172 7261 792c 206d 6178 5f6c 6167  ndarray, max_lag
-00011550: 3a20 666c 6f61 742c 2074 696d 655f 7769  : float, time_wi
-00011560: 6e64 6f77 3a20 666c 6f61 742c 2066 7073  ndow: float, fps
-00011570: 3a20 666c 6f61 740a 2020 2020 293a 0a20  : float.    ):. 
-00011580: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00011590: 2020 204a 6974 7465 6420 636f 6d70 7574     Jitted comput
-000115a0: 6520 6f66 2073 6c69 6469 6e67 2061 7574  e of sliding aut
-000115b0: 6f2d 636f 7272 656c 6174 696f 6e73 2028  o-correlations (
-000115c0: 7468 6520 636f 7272 656c 6174 696f 6e20  the correlation 
-000115d0: 6f66 2061 2066 6561 7475 7265 2077 6974  of a feature wit
-000115e0: 6820 6974 7365 6c66 2075 7369 6e67 206c  h itself using l
-000115f0: 6167 6765 6420 7769 6e64 6f77 7329 2e0a  agged windows)..
-00011600: 0a20 2020 2020 2020 203a 6578 616d 706c  .        :exampl
-00011610: 653a 0a20 2020 2020 2020 203e 3e3e 2064  e:.        >>> d
-00011620: 6174 6120 3d20 6e70 2e61 7272 6179 285b  ata = np.array([
-00011630: 302c 312c 322c 332c 342c 2035 2c36 2c37  0,1,2,3,4, 5,6,7
-00011640: 2c38 2c31 2c31 302c 3131 2c31 322c 3133  ,8,1,10,11,12,13
-00011650: 2c31 345d 292e 6173 7479 7065 286e 702e  ,14]).astype(np.
-00011660: 666c 6f61 7433 3229 0a20 2020 2020 2020  float32).       
-00011670: 203e 3e3e 2053 7461 7469 7374 6963 7328   >>> Statistics(
-00011680: 292e 736c 6964 696e 675f 6175 746f 636f  ).sliding_autoco
-00011690: 7272 656c 6174 696f 6e28 6461 7461 3d64  rrelation(data=d
-000116a0: 6174 612c 206d 6178 5f6c 6167 3d30 2e35  ata, max_lag=0.5
-000116b0: 2c20 7469 6d65 5f77 696e 646f 773d 312e  , time_window=1.
-000116c0: 302c 2066 7073 3d31 3029 0a20 2020 2020  0, fps=10).     
-000116d0: 2020 203e 3e3e 205b 2030 2e2c 2030 2e2c     >>> [ 0., 0.,
-000116e0: 2030 2e2c 2020 302e 2c20 2030 2e2c 2030   0.,  0.,  0., 0
-000116f0: 2e2c 2030 2e2c 2020 302e 202c 2020 302e  ., 0.,  0. ,  0.
-00011700: 2c20 2d33 2e36 3836 2c20 2d32 2e30 3239  , -3.686, -2.029
-00011710: 2c20 2d31 2e33 3233 2c20 2d31 2e37 3533  , -1.323, -1.753
-00011720: 2c20 2d33 2e38 3037 2c20 2d34 2e36 3334  , -3.807, -4.634
-00011730: 5d0a 2020 2020 2020 2020 2222 220a 0a20  ].        """.. 
-00011740: 2020 2020 2020 206d 6178 5f66 726d 5f6c         max_frm_l
-00011750: 6167 2c20 7469 6d65 5f77 696e 646f 775f  ag, time_window_
-00011760: 6672 6d73 203d 2069 6e74 286d 6178 5f6c  frms = int(max_l
-00011770: 6167 202a 2066 7073 292c 2069 6e74 2874  ag * fps), int(t
-00011780: 696d 655f 7769 6e64 6f77 202a 2066 7073  ime_window * fps
-00011790: 290a 2020 2020 2020 2020 7265 7375 6c74  ).        result
-000117a0: 7320 3d20 6e70 2e66 756c 6c28 2864 6174  s = np.full((dat
-000117b0: 612e 7368 6170 655b 305d 292c 2030 2e30  a.shape[0]), 0.0
-000117c0: 290a 2020 2020 2020 2020 666f 7220 7269  ).        for ri
-000117d0: 6768 7420 696e 2070 7261 6e67 6528 7469  ght in prange(ti
-000117e0: 6d65 5f77 696e 646f 775f 6672 6d73 202d  me_window_frms -
-000117f0: 2031 2c20 6461 7461 2e73 6861 7065 5b30   1, data.shape[0
-00011800: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
-00011810: 6c65 6674 203d 2072 6967 6874 202d 2074  left = right - t
-00011820: 696d 655f 7769 6e64 6f77 5f66 726d 7320  ime_window_frms 
-00011830: 2b20 310a 2020 2020 2020 2020 2020 2020  + 1.            
-00011840: 775f 6461 7461 203d 2064 6174 615b 6c65  w_data = data[le
-00011850: 6674 203a 2072 6967 6874 202b 2031 5d0a  ft : right + 1].
-00011860: 2020 2020 2020 2020 2020 2020 636f 7272              corr
-00011870: 6366 7320 3d20 6e70 2e66 756c 6c28 286d  cfs = np.full((m
-00011880: 6178 5f66 726d 5f6c 6167 292c 206e 702e  ax_frm_lag), np.
-00011890: 6e61 6e29 0a20 2020 2020 2020 2020 2020  nan).           
-000118a0: 2063 6f72 7263 6673 5b30 5d20 3d20 310a   corrcfs[0] = 1.
-000118b0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-000118c0: 7368 6966 7420 696e 2072 616e 6765 2831  shift in range(1
-000118d0: 2c20 6d61 785f 6672 6d5f 6c61 6729 3a0a  , max_frm_lag):.
-000118e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000118f0: 636f 7272 6366 735b 7368 6966 745d 203d  corrcfs[shift] =
-00011900: 206e 702e 636f 7272 636f 6566 2877 5f64   np.corrcoef(w_d
-00011910: 6174 615b 3a2d 7368 6966 745d 2c20 775f  ata[:-shift], w_
-00011920: 6461 7461 5b73 6869 6674 3a5d 295b 305d  data[shift:])[0]
-00011930: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
-00011940: 6d61 745f 203d 206e 702e 7a65 726f 7328  mat_ = np.zeros(
-00011950: 7368 6170 653d 2863 6f72 7263 6673 2e73  shape=(corrcfs.s
-00011960: 6861 7065 5b30 5d2c 2032 2929 0a20 2020  hape[0], 2)).   
-00011970: 2020 2020 2020 2020 2063 6f6e 7374 203d           const =
-00011980: 206e 702e 6f6e 6573 5f6c 696b 6528 636f   np.ones_like(co
-00011990: 7272 6366 7329 0a20 2020 2020 2020 2020  rrcfs).         
-000119a0: 2020 206d 6174 5f5b 3a2c 2030 5d20 3d20     mat_[:, 0] = 
-000119b0: 636f 6e73 740a 2020 2020 2020 2020 2020  const.          
-000119c0: 2020 6d61 745f 5b3a 2c20 315d 203d 2063    mat_[:, 1] = c
-000119d0: 6f72 7263 6673 0a20 2020 2020 2020 2020  orrcfs.         
-000119e0: 2020 2064 6574 5f20 3d20 6e70 2e6c 696e     det_ = np.lin
-000119f0: 616c 672e 6c73 7473 7128 0a20 2020 2020  alg.lstsq(.     
-00011a00: 2020 2020 2020 2020 2020 206d 6174 5f2e             mat_.
-00011a10: 6173 7479 7065 286e 702e 666c 6f61 7433  astype(np.float3
-00011a20: 3229 2c20 6e70 2e61 7261 6e67 6528 302c  2), np.arange(0,
-00011a30: 206d 6178 5f66 726d 5f6c 6167 292e 6173   max_frm_lag).as
-00011a40: 7479 7065 286e 702e 666c 6f61 7433 3229  type(np.float32)
-00011a50: 0a20 2020 2020 2020 2020 2020 2029 5b30  .            )[0
-00011a60: 5d0a 2020 2020 2020 2020 2020 2020 7265  ].            re
-00011a70: 7375 6c74 735b 7269 6768 745d 203d 2064  sults[right] = d
-00011a80: 6574 5f5b 3a3a 2d31 5d5b 305d 0a20 2020  et_[::-1][0].   
-00011a90: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
-00011aa0: 6c74 730a 0a20 2020 2040 7374 6174 6963  lts..    @static
-00011ab0: 6d65 7468 6f64 0a20 2020 2064 6566 2073  method.    def s
-00011ac0: 6c69 6469 6e67 5f64 6f6d 696e 616e 745f  liding_dominant_
-00011ad0: 6672 6571 7565 6e63 6965 7328 0a20 2020  frequencies(.   
-00011ae0: 2020 2020 2064 6174 613a 206e 702e 6e64       data: np.nd
-00011af0: 6172 7261 792c 0a20 2020 2020 2020 2066  array,.        f
-00011b00: 7073 3a20 666c 6f61 742c 0a20 2020 2020  ps: float,.     
-00011b10: 2020 206b 3a20 696e 742c 0a20 2020 2020     k: int,.     
-00011b20: 2020 2074 696d 655f 7769 6e64 6f77 733a     time_windows:
-00011b30: 206e 702e 6e64 6172 7261 792c 0a20 2020   np.ndarray,.   
-00011b40: 2020 2020 2077 696e 646f 775f 6675 6e63       window_func
-00011b50: 7469 6f6e 3a20 4c69 7465 7261 6c5b 2248  tion: Literal["H
-00011b60: 616e 6e22 2c20 2248 616d 6d69 6e67 222c  ann", "Hamming",
-00011b70: 2022 426c 6163 6b6d 616e 225d 203d 204e   "Blackman"] = N
-00011b80: 6f6e 652c 0a20 2020 2029 3a0a 2020 2020  one,.    ):.    
-00011b90: 2020 2020 2222 2246 696e 6420 7468 6520      """Find the 
-00011ba0: 4b20 646f 6d69 6e61 6e74 2066 7265 7175  K dominant frequ
-00011bb0: 656e 6369 6573 2077 6974 6869 6e20 6120  encies within a 
-00011bc0: 6665 6174 7572 6520 7665 6374 6f72 2075  feature vector u
-00011bd0: 7369 6e67 2073 6c69 6469 6e67 2077 696e  sing sliding win
-00011be0: 646f 7773 2222 220a 0a20 2020 2020 2020  dows"""..       
-00011bf0: 2072 6573 756c 7473 203d 206e 702e 6675   results = np.fu
-00011c00: 6c6c 2828 6461 7461 2e73 6861 7065 5b30  ll((data.shape[0
-00011c10: 5d2c 2074 696d 655f 7769 6e64 6f77 732e  ], time_windows.
-00011c20: 7368 6170 655b 305d 292c 2030 2e30 290a  shape[0]), 0.0).
-00011c30: 2020 2020 2020 2020 666f 7220 7469 6d65          for time
-00011c40: 5f77 696e 646f 775f 636e 7420 696e 2072  _window_cnt in r
-00011c50: 616e 6765 2874 696d 655f 7769 6e64 6f77  ange(time_window
-00011c60: 732e 7368 6170 655b 305d 293a 0a20 2020  s.shape[0]):.   
-00011c70: 2020 2020 2020 2020 2077 696e 646f 775f           window_
-00011c80: 7369 7a65 203d 2069 6e74 2874 696d 655f  size = int(time_
-00011c90: 7769 6e64 6f77 735b 7469 6d65 5f77 696e  windows[time_win
-00011ca0: 646f 775f 636e 745d 202a 2066 7073 290a  dow_cnt] * fps).
-00011cb0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00011cc0: 6c65 6674 2c20 7269 6768 7420 696e 207a  left, right in z
-00011cd0: 6970 280a 2020 2020 2020 2020 2020 2020  ip(.            
-00011ce0: 2020 2020 7261 6e67 6528 302c 2064 6174      range(0, dat
-00011cf0: 612e 7368 6170 655b 305d 202b 2031 292c  a.shape[0] + 1),
-00011d00: 2072 616e 6765 2877 696e 646f 775f 7369   range(window_si
-00011d10: 7a65 2c20 6461 7461 2e73 6861 7065 5b30  ze, data.shape[0
-00011d20: 5d20 2b20 3129 0a20 2020 2020 2020 2020  ] + 1).         
-00011d30: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
-00011d40: 2020 2020 2020 7769 6e64 6f77 5f64 6174        window_dat
-00011d50: 6120 3d20 6461 7461 5b6c 6566 743a 7269  a = data[left:ri
-00011d60: 6768 745d 0a20 2020 2020 2020 2020 2020  ght].           
-00011d70: 2020 2020 2069 6620 7769 6e64 6f77 5f66       if window_f
-00011d80: 756e 6374 696f 6e20 3d3d 2022 4861 6e6e  unction == "Hann
-00011d90: 223a 0a20 2020 2020 2020 2020 2020 2020  ":.             
-00011da0: 2020 2020 2020 2077 696e 646f 775f 6461         window_da
-00011db0: 7461 203d 2077 696e 646f 775f 6461 7461  ta = window_data
-00011dc0: 202a 206e 702e 6861 6e6e 696e 6728 6c65   * np.hanning(le
-00011dd0: 6e28 7769 6e64 6f77 5f64 6174 6129 290a  n(window_data)).
-00011de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011df0: 656c 6966 2077 696e 646f 775f 6675 6e63  elif window_func
-00011e00: 7469 6f6e 203d 3d20 2248 616d 6d69 6e67  tion == "Hamming
-00011e10: 223a 0a20 2020 2020 2020 2020 2020 2020  ":.             
-00011e20: 2020 2020 2020 2077 696e 646f 775f 6461         window_da
-00011e30: 7461 203d 2077 696e 646f 775f 6461 7461  ta = window_data
-00011e40: 202a 206e 702e 6861 6d6d 696e 6728 6c65   * np.hamming(le
-00011e50: 6e28 7769 6e64 6f77 5f64 6174 6129 290a  n(window_data)).
-00011e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011e70: 656c 6966 2077 696e 646f 775f 6675 6e63  elif window_func
-00011e80: 7469 6f6e 203d 3d20 2242 6c61 636b 6d61  tion == "Blackma
-00011e90: 6e22 3a0a 2020 2020 2020 2020 2020 2020  n":.            
-00011ea0: 2020 2020 2020 2020 7769 6e64 6f77 5f64          window_d
-00011eb0: 6174 6120 3d20 7769 6e64 6f77 5f64 6174  ata = window_dat
-00011ec0: 6120 2a20 6e70 2e62 6c61 636b 6d61 6e28  a * np.blackman(
-00011ed0: 6c65 6e28 7769 6e64 6f77 5f64 6174 6129  len(window_data)
-00011ee0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00011ef0: 2020 6666 745f 7265 7375 6c74 203d 206e    fft_result = n
-00011f00: 702e 6666 742e 6666 7428 7769 6e64 6f77  p.fft.fft(window
-00011f10: 5f64 6174 6129 0a20 2020 2020 2020 2020  _data).         
-00011f20: 2020 2020 2020 2066 7265 7175 656e 6369         frequenci
-00011f30: 6573 203d 206e 702e 6666 742e 6666 7466  es = np.fft.fftf
-00011f40: 7265 7128 7769 6e64 6f77 5f64 6174 612e  req(window_data.
-00011f50: 7368 6170 655b 305d 2c20 3120 2f20 6670  shape[0], 1 / fp
-00011f60: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
-00011f70: 2020 206d 6167 6e69 7475 6465 203d 206e     magnitude = n
-00011f80: 702e 6162 7328 6666 745f 7265 7375 6c74  p.abs(fft_result
-00011f90: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00011fa0: 2020 746f 705f 6b5f 6672 6571 7565 6e63    top_k_frequenc
-00011fb0: 7920 3d20 6672 6571 7565 6e63 6965 735b  y = frequencies[
-00011fc0: 6e70 2e61 7267 736f 7274 286d 6167 6e69  np.argsort(magni
-00011fd0: 7475 6465 295b 2d28 6b20 2b20 3129 203a  tude)[-(k + 1) :
-00011fe0: 202d 315d 5d0a 2020 2020 2020 2020 2020   -1]].          
-00011ff0: 2020 2020 2020 7265 7375 6c74 735b 7269        results[ri
-00012000: 6768 7420 2d20 315d 5b74 696d 655f 7769  ght - 1][time_wi
-00012010: 6e64 6f77 5f63 6e74 5d20 3d20 746f 705f  ndow_cnt] = top_
-00012020: 6b5f 6672 6571 7565 6e63 795b 305d 0a20  k_frequency[0]. 
-00012030: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-00012040: 7375 6c74 730a 0a20 2020 2040 7374 6174  sults..    @stat
-00012050: 6963 6d65 7468 6f64 0a20 2020 2040 6e6a  icmethod.    @nj
-00012060: 6974 2822 2866 6c6f 6174 3332 5b3a 5d2c  it("(float32[:],
-00012070: 2066 6c6f 6174 3332 5b3a 5d29 2229 0a20   float32[:])"). 
-00012080: 2020 2064 6566 206b 656e 6461 6c6c 5f74     def kendall_t
-00012090: 6175 2873 616d 706c 655f 313a 206e 702e  au(sample_1: np.
-000120a0: 6e64 6172 7261 792c 2073 616d 706c 655f  ndarray, sample_
-000120b0: 323a 206e 702e 6e64 6172 7261 7929 202d  2: np.ndarray) -
-000120c0: 3e20 5475 706c 655b 666c 6f61 742c 2066  > Tuple[float, f
-000120d0: 6c6f 6174 5d3a 0a20 2020 2020 2020 2022  loat]:.        "
-000120e0: 2222 0a20 2020 2020 2020 204a 6974 7465  "".        Jitte
-000120f0: 6420 4b65 6e64 616c 6c20 5461 7520 2872  d Kendall Tau (r
-00012100: 616e 6b20 636f 7272 656c 6174 696f 6e20  ank correlation 
-00012110: 636f 6566 6669 6369 656e 7429 2e20 4e6f  coefficient). No
-00012120: 6e2d 7061 7261 6d65 7472 6963 206d 6574  n-parametric met
-00012130: 686f 6420 666f 7220 636f 6d70 7574 696e  hod for computin
-00012140: 6720 636f 7272 656c 6174 696f 6e0a 2020  g correlation.  
-00012150: 2020 2020 2020 6265 7477 6565 6e20 7477        between tw
-00012160: 6f20 7469 6d65 2d73 6572 6965 7320 6665  o time-series fe
-00012170: 6174 7572 6573 2e20 5265 7475 726e 7320  atures. Returns 
-00012180: 7461 7520 616e 6420 6173 736f 6369 6174  tau and associat
-00012190: 6564 207a 2d73 636f 7265 2e0a 0a20 2020  ed z-score...   
-000121a0: 2020 2020 203a 7061 7261 6d65 7465 7220       :parameter 
-000121b0: 6e64 6172 7261 7920 7361 6d70 6c65 5f31  ndarray sample_1
-000121c0: 3a20 4669 7273 7420 3144 2061 7272 6179  : First 1D array
-000121d0: 2077 6974 6820 6665 6174 7572 6520 7661   with feature va
-000121e0: 6c75 6573 2e0a 2020 2020 2020 2020 3a70  lues..        :p
-000121f0: 6172 616d 6574 6572 206e 6461 7272 6179  arameter ndarray
-00012200: 2073 616d 706c 655f 313a 2053 6563 6f6e   sample_1: Secon
-00012210: 6420 3144 2061 7272 6179 2077 6974 6820  d 1D array with 
-00012220: 6665 6174 7572 6520 7661 6c75 6573 2e0a  feature values..
-00012230: 2020 2020 2020 2020 3a72 6574 7572 6e73          :returns
-00012240: 2054 7570 6c65 5b66 6c6f 6174 2c20 666c   Tuple[float, fl
-00012250: 6f61 745d 3a20 4b65 6e64 616c 6c20 5461  oat]: Kendall Ta
-00012260: 7520 616e 6420 6173 736f 6369 6174 6564  u and associated
-00012270: 207a 2d73 636f 7265 2e0a 0a20 2020 2020   z-score...     
-00012280: 2020 203a 6578 616d 706c 6573 3a0a 2020     :examples:.  
-00012290: 2020 2020 2020 3e3e 3e20 7361 6d70 6c65        >>> sample
-000122a0: 5f31 203d 206e 702e 6172 7261 7928 5b34  _1 = np.array([4
-000122b0: 2c20 322c 2033 2c20 342c 2035 2c20 375d  , 2, 3, 4, 5, 7]
-000122c0: 292e 6173 7479 7065 286e 702e 666c 6f61  ).astype(np.floa
-000122d0: 7433 3229 0a20 2020 2020 2020 203e 3e3e  t32).        >>>
-000122e0: 2073 616d 706c 655f 3220 3d20 6e70 2e61   sample_2 = np.a
-000122f0: 7272 6179 285b 312c 2032 2c20 332c 2034  rray([1, 2, 3, 4
-00012300: 2c20 352c 2037 5d29 2e61 7374 7970 6528  , 5, 7]).astype(
-00012310: 6e70 2e66 6c6f 6174 3332 290a 2020 2020  np.float32).    
-00012320: 2020 2020 3e3e 3e20 5374 6174 6973 7469      >>> Statisti
-00012330: 6373 2829 2e6b 656e 6461 6c6c 5f74 6175  cs().kendall_tau
-00012340: 2873 616d 706c 655f 313d 7361 6d70 6c65  (sample_1=sample
-00012350: 5f31 2c20 7361 6d70 6c65 5f32 3d73 616d  _1, sample_2=sam
-00012360: 706c 655f 3229 0a20 2020 2020 2020 203e  ple_2).        >
-00012370: 3e3e 2028 302e 3733 3333 3333 3333 3333  >> (0.7333333333
-00012380: 3333 3333 3333 2c20 322e 3036 3635 3430  333333, 2.066540
-00012390: 3136 3035 3830 3939 3238 290a 0a20 2020  1605809928)..   
-000123a0: 2020 2020 2052 6566 6572 656e 6365 730a       References.
-000123b0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-000123c0: 2d2d 0a20 2020 2020 2020 202e 2e20 5b31  --.        .. [1
-000123d0: 5d20 6053 7465 7068 616e 6965 2047 6c65  ] `Stephanie Gle
-000123e0: 6e2c 2022 4b65 6e64 616c 6ce2 8099 7320  n, "Kendall...s 
-000123f0: 5461 7520 284b 656e 6461 6c6c 2052 616e  Tau (Kendall Ran
-00012400: 6b20 436f 7272 656c 6174 696f 6e20 436f  k Correlation Co
-00012410: 6566 6669 6369 656e 7429 2220 203c 6874  efficient)"  <ht
-00012420: 7470 733a 2f2f 7777 772e 7374 6174 6973  tps://www.statis
-00012430: 7469 6373 686f 7774 6f2e 636f 6d2f 6b65  ticshowto.com/ke
-00012440: 6e64 616c 6c73 2d74 6175 2f3e 605f 5f2e  ndalls-tau/>`__.
-00012450: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-00012460: 2020 2020 2020 726e 6b73 203d 206e 702e        rnks = np.
-00012470: 6172 6773 6f72 7428 7361 6d70 6c65 5f31  argsort(sample_1
-00012480: 290a 2020 2020 2020 2020 7331 5f72 6e6b  ).        s1_rnk
-00012490: 2c20 7332 5f72 6e6b 203d 2073 616d 706c  , s2_rnk = sampl
-000124a0: 655f 315b 726e 6b73 5d2c 2073 616d 706c  e_1[rnks], sampl
-000124b0: 655f 325b 726e 6b73 5d0a 2020 2020 2020  e_2[rnks].      
-000124c0: 2020 636e 6372 646e 745f 636e 7473 2c20    cncrdnt_cnts, 
-000124d0: 6473 6372 646e 745f 636e 7473 203d 206e  dscrdnt_cnts = n
-000124e0: 702e 6675 6c6c 2828 7331 5f72 6e6b 2e73  p.full((s1_rnk.s
-000124f0: 6861 7065 5b30 5d20 2d20 3129 2c20 6e70  hape[0] - 1), np
-00012500: 2e6e 616e 292c 206e 702e 6675 6c6c 280a  .nan), np.full(.
-00012510: 2020 2020 2020 2020 2020 2020 2873 315f              (s1_
-00012520: 726e 6b2e 7368 6170 655b 305d 202d 2031  rnk.shape[0] - 1
-00012530: 292c 206e 702e 6e61 6e0a 2020 2020 2020  ), np.nan.      
-00012540: 2020 290a 2020 2020 2020 2020 666f 7220    ).        for 
-00012550: 6920 696e 2072 616e 6765 2873 325f 726e  i in range(s2_rn
-00012560: 6b2e 7368 6170 655b 305d 202d 2031 293a  k.shape[0] - 1):
-00012570: 0a20 2020 2020 2020 2020 2020 2063 6e63  .            cnc
-00012580: 7264 6e74 5f63 6e74 735b 695d 203d 2028  rdnt_cnts[i] = (
-00012590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000125a0: 206e 702e 6172 6777 6865 7265 2873 325f   np.argwhere(s2_
-000125b0: 726e 6b5b 6920 2b20 3120 3a5d 203e 2073  rnk[i + 1 :] > s
-000125c0: 325f 726e 6b5b 695d 292e 666c 6174 7465  2_rnk[i]).flatte
-000125d0: 6e28 292e 7368 6170 655b 305d 0a20 2020  n().shape[0].   
-000125e0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-000125f0: 2020 2020 2020 2064 7363 7264 6e74 5f63         dscrdnt_c
-00012600: 6e74 735b 695d 203d 2028 0a20 2020 2020  nts[i] = (.     
-00012610: 2020 2020 2020 2020 2020 206e 702e 6172             np.ar
-00012620: 6777 6865 7265 2873 325f 726e 6b5b 6920  gwhere(s2_rnk[i 
-00012630: 2b20 3120 3a5d 203c 2073 325f 726e 6b5b  + 1 :] < s2_rnk[
-00012640: 695d 292e 666c 6174 7465 6e28 292e 7368  i]).flatten().sh
-00012650: 6170 655b 305d 0a20 2020 2020 2020 2020  ape[0].         
-00012660: 2020 2029 0a20 2020 2020 2020 2074 203d     ).        t =
-00012670: 2028 6e70 2e73 756d 2863 6e63 7264 6e74   (np.sum(cncrdnt
-00012680: 5f63 6e74 7329 202d 206e 702e 7375 6d28  _cnts) - np.sum(
-00012690: 6473 6372 646e 745f 636e 7473 2929 202f  dscrdnt_cnts)) /
-000126a0: 2028 0a20 2020 2020 2020 2020 2020 206e   (.            n
-000126b0: 702e 7375 6d28 636e 6372 646e 745f 636e  p.sum(cncrdnt_cn
-000126c0: 7473 2920 2b20 6e70 2e73 756d 2864 7363  ts) + np.sum(dsc
-000126d0: 7264 6e74 5f63 6e74 7329 0a20 2020 2020  rdnt_cnts).     
-000126e0: 2020 2029 0a20 2020 2020 2020 207a 203d     ).        z =
-000126f0: 2028 0a20 2020 2020 2020 2020 2020 2033   (.            3
-00012700: 0a20 2020 2020 2020 2020 2020 202a 2074  .            * t
-00012710: 0a20 2020 2020 2020 2020 2020 202a 2028  .            * (
-00012720: 6e70 2e73 7172 7428 7331 5f72 6e6b 2e73  np.sqrt(s1_rnk.s
-00012730: 6861 7065 5b30 5d20 2a20 2873 315f 726e  hape[0] * (s1_rn
-00012740: 6b2e 7368 6170 655b 305d 202d 2031 2929  k.shape[0] - 1))
-00012750: 290a 2020 2020 2020 2020 2020 2020 2f20  ).            / 
-00012760: 6e70 2e73 7172 7428 3220 2a20 2828 3220  np.sqrt(2 * ((2 
-00012770: 2a20 7331 5f72 6e6b 2e73 6861 7065 5b30  * s1_rnk.shape[0
-00012780: 5d29 202b 2035 2929 0a20 2020 2020 2020  ]) + 5)).       
-00012790: 2029 0a0a 2020 2020 2020 2020 7265 7475   )..        retu
-000127a0: 726e 2074 2c20 7a0a 0a20 2020 2040 7374  rn t, z..    @st
-000127b0: 6174 6963 6d65 7468 6f64 0a20 2020 2040  aticmethod.    @
-000127c0: 6e6a 6974 2822 2866 6c6f 6174 3332 5b3a  njit("(float32[:
-000127d0: 5d2c 2066 6c6f 6174 3332 5b3a 5d2c 2066  ], float32[:], f
-000127e0: 6c6f 6174 3634 5b3a 5d2c 2069 6e74 3634  loat64[:], int64
-000127f0: 2922 290a 2020 2020 6465 6620 736c 6964  )").    def slid
-00012800: 696e 675f 6b65 6e64 616c 6c5f 7461 7528  ing_kendall_tau(
-00012810: 0a20 2020 2020 2020 2073 616d 706c 655f  .        sample_
-00012820: 313a 206e 702e 6e64 6172 7261 792c 2073  1: np.ndarray, s
-00012830: 616d 706c 655f 323a 206e 702e 6e64 6172  ample_2: np.ndar
-00012840: 7261 792c 2074 696d 655f 7769 6e64 6f77  ray, time_window
-00012850: 733a 206e 702e 6e64 6172 7261 792c 2066  s: np.ndarray, f
-00012860: 7073 3a20 666c 6f61 740a 2020 2020 2920  ps: float.    ) 
-00012870: 2d3e 206e 702e 6e64 6172 7261 793a 0a20  -> np.ndarray:. 
-00012880: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00012890: 2020 2043 6f6d 7075 7465 2073 6c69 6469     Compute slidi
-000128a0: 6e67 204b 656e 6461 6c6c 2773 2054 6175  ng Kendall's Tau
-000128b0: 2063 6f72 7265 6c61 7469 6f6e 2063 6f65   correlation coe
-000128c0: 6666 6963 6965 6e74 2e0a 0a20 2020 2020  fficient...     
-000128d0: 2020 2043 616c 6375 6c61 7465 7320 4b65     Calculates Ke
-000128e0: 6e64 616c 6c27 7320 5461 7520 636f 7272  ndall's Tau corr
-000128f0: 656c 6174 696f 6e20 636f 6566 6669 6369  elation coeffici
-00012900: 656e 7420 6265 7477 6565 6e20 7477 6f20  ent between two 
-00012910: 7361 6d70 6c65 7320 6f76 6572 2073 6c69  samples over sli
-00012920: 6469 6e67 2074 696d 6520 7769 6e64 6f77  ding time window
-00012930: 732e 204b 656e 6461 6c6c 2773 2054 6175  s. Kendall's Tau
-00012940: 2069 7320 6120 6d65 6173 7572 6520 6f66   is a measure of
-00012950: 2063 6f72 7265 6c61 7469 6f6e 2062 6574   correlation bet
-00012960: 7765 656e 2074 776f 2072 616e 6b65 6420  ween two ranked 
-00012970: 6461 7461 7365 7473 2e0a 0a20 2020 2020  datasets...     
-00012980: 2020 2054 6865 2063 6f6d 7075 7461 7469     The computati
-00012990: 6f6e 2069 7320 6261 7365 6420 6f6e 2074  on is based on t
-000129a0: 6865 2066 6f72 6d75 6c61 3a0a 0a20 2020  he formula:..   
-000129b0: 2020 2020 202e 2e20 6d61 7468 3a3a 0a0a       .. math::..
-000129c0: 2020 2020 2020 2020 2020 205c 5c74 6175             \\tau
-000129d0: 203d 205c 5c66 7261 637b 7b5c 5c74 6578   = \\frac{{\\tex
-000129e0: 747b 7b63 6f6e 636f 7264 616e 7420 7061  t{{concordant pa
-000129f0: 6972 737d 7d20 2d20 5c5c 7465 7874 7b7b  irs}} - \\text{{
-00012a00: 6469 7363 6f72 6461 6e74 2070 6169 7273  discordant pairs
-00012a10: 7d7d 7d7d 7b7b 5c5c 7465 7874 7b7b 636f  }}}}{{\\text{{co
-00012a20: 6e63 6f72 6461 6e74 2070 6169 7273 7d7d  ncordant pairs}}
-00012a30: 202b 205c 5c74 6578 747b 7b64 6973 636f   + \\text{{disco
-00012a40: 7264 616e 7420 7061 6972 737d 7d7d 7d0a  rdant pairs}}}}.
-00012a50: 0a20 2020 2020 2020 2077 6865 7265 2063  .        where c
-00012a60: 6f6e 636f 7264 616e 7420 7061 6972 7320  oncordant pairs 
-00012a70: 6172 6520 7061 6972 7320 6f66 2065 6c65  are pairs of ele
-00012a80: 6d65 6e74 7320 7769 7468 2074 6865 2073  ments with the s
-00012a90: 616d 6520 6f72 6465 7220 696e 2062 6f74  ame order in bot
-00012aa0: 6820 7361 6d70 6c65 732c 2061 6e64 2064  h samples, and d
-00012ab0: 6973 636f 7264 616e 7420 7061 6972 7320  iscordant pairs 
-00012ac0: 6172 6520 7061 6972 7320 7769 7468 2064  are pairs with d
-00012ad0: 6966 6665 7265 6e74 206f 7264 6572 732e  ifferent orders.
-00012ae0: 0a0a 2020 2020 2020 2020 5265 6665 7265  ..        Refere
-00012af0: 6e63 6573 0a20 2020 2020 2020 202d 2d2d  nces.        ---
-00012b00: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00012b10: 2e2e 205b 315d 2060 5374 6570 6861 6e69  .. [1] `Stephani
-00012b20: 6520 476c 656e 2c20 224b 656e 6461 6c6c  e Glen, "Kendall
-00012b30: e280 9973 2054 6175 2028 4b65 6e64 616c  ...s Tau (Kendal
-00012b40: 6c20 5261 6e6b 2043 6f72 7265 6c61 7469  l Rank Correlati
-00012b50: 6f6e 2043 6f65 6666 6963 6965 6e74 2922  on Coefficient)"
-00012b60: 2020 3c68 7474 7073 3a2f 2f77 7777 2e73    <https://www.s
-00012b70: 7461 7469 7374 6963 7368 6f77 746f 2e63  tatisticshowto.c
-00012b80: 6f6d 2f6b 656e 6461 6c6c 732d 7461 752f  om/kendalls-tau/
-00012b90: 3e60 5f5f 2e0a 0a0a 2020 2020 2020 2020  >`__....        
-00012ba0: 3a70 6172 616d 206e 702e 6e64 6172 7261  :param np.ndarra
-00012bb0: 7920 7361 6d70 6c65 5f31 3a20 4669 7273  y sample_1: Firs
-00012bc0: 7420 7361 6d70 6c65 2066 6f72 2063 6f6d  t sample for com
-00012bd0: 7061 7269 736f 6e2e 0a20 2020 2020 2020  parison..       
-00012be0: 203a 7061 7261 6d20 6e70 2e6e 6461 7272   :param np.ndarr
-00012bf0: 6179 2073 616d 706c 655f 323a 2053 6563  ay sample_2: Sec
-00012c00: 6f6e 6420 7361 6d70 6c65 2066 6f72 2063  ond sample for c
-00012c10: 6f6d 7061 7269 736f 6e2e 0a20 2020 2020  omparison..     
-00012c20: 2020 203a 7061 7261 6d20 6e70 2e6e 6461     :param np.nda
-00012c30: 7272 6179 2074 696d 655f 7769 6e64 6f77  rray time_window
-00012c40: 733a 2052 6f6c 6c69 6e67 2074 696d 6520  s: Rolling time 
-00012c50: 7769 6e64 6f77 7320 696e 2073 6563 6f6e  windows in secon
-00012c60: 6473 2e0a 2020 2020 2020 2020 3a70 6172  ds..        :par
-00012c70: 616d 2066 6c6f 6174 2066 7073 3a20 4672  am float fps: Fr
-00012c80: 616d 6573 2070 6572 2073 6563 6f6e 6420  ames per second 
-00012c90: 2846 5053 2920 6f66 2074 6865 2072 6563  (FPS) of the rec
-00012ca0: 6f72 6465 6420 7669 6465 6f2e 0a20 2020  orded video..   
-00012cb0: 2020 2020 203a 7265 7475 726e 3a20 4172       :return: Ar
-00012cc0: 7261 7920 6f66 204b 656e 6461 6c6c 2773  ray of Kendall's
-00012cd0: 2054 6175 2063 6f72 7265 6c61 7469 6f6e   Tau correlation
-00012ce0: 2063 6f65 6666 6963 6965 6e74 7320 636f   coefficients co
-00012cf0: 7272 6573 706f 6e64 696e 6720 746f 2065  rresponding to e
-00012d00: 6163 6820 7469 6d65 2077 696e 646f 772e  ach time window.
-00012d10: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-00012d20: 2020 2020 2020 7265 7375 6c74 7320 3d20        results = 
-00012d30: 6e70 2e66 756c 6c28 2873 616d 706c 655f  np.full((sample_
-00012d40: 312e 7368 6170 655b 305d 2c20 7469 6d65  1.shape[0], time
-00012d50: 5f77 696e 646f 7773 2e73 6861 7065 5b30  _windows.shape[0
-00012d60: 5d29 2c20 302e 3029 0a20 2020 2020 2020  ]), 0.0).       
-00012d70: 2066 6f72 2074 696d 655f 7769 6e64 6f77   for time_window
-00012d80: 5f63 6e74 2069 6e20 7261 6e67 6528 7469  _cnt in range(ti
-00012d90: 6d65 5f77 696e 646f 7773 2e73 6861 7065  me_windows.shape
-00012da0: 5b30 5d29 3a0a 2020 2020 2020 2020 2020  [0]):.          
-00012db0: 2020 7769 6e64 6f77 5f73 697a 6520 3d20    window_size = 
-00012dc0: 696e 7428 7469 6d65 5f77 696e 646f 7773  int(time_windows
-00012dd0: 5b74 696d 655f 7769 6e64 6f77 5f63 6e74  [time_window_cnt
-00012de0: 5d20 2a20 6670 7329 0a20 2020 2020 2020  ] * fps).       
-00012df0: 2020 2020 2066 6f72 206c 6566 742c 2072       for left, r
-00012e00: 6967 6874 2069 6e20 7a69 7028 0a20 2020  ight in zip(.   
-00012e10: 2020 2020 2020 2020 2020 2020 2072 616e               ran
-00012e20: 6765 2830 2c20 7361 6d70 6c65 5f31 2e73  ge(0, sample_1.s
-00012e30: 6861 7065 5b30 5d20 2b20 3129 2c0a 2020  hape[0] + 1),.  
-00012e40: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00012e50: 6e67 6528 7769 6e64 6f77 5f73 697a 652c  nge(window_size,
-00012e60: 2073 616d 706c 655f 312e 7368 6170 655b   sample_1.shape[
-00012e70: 305d 202b 2031 292c 0a20 2020 2020 2020  0] + 1),.       
-00012e80: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
-00012e90: 2020 2020 2020 2020 736c 6963 6564 5f73          sliced_s
-00012ea0: 616d 706c 655f 312c 2073 6c69 6365 645f  ample_1, sliced_
-00012eb0: 7361 6d70 6c65 5f32 203d 2028 0a20 2020  sample_2 = (.   
-00012ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012ed0: 2073 616d 706c 655f 315b 6c65 6674 3a72   sample_1[left:r
-00012ee0: 6967 6874 5d2c 0a20 2020 2020 2020 2020  ight],.         
-00012ef0: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
-00012f00: 655f 325b 6c65 6674 3a72 6967 6874 5d2c  e_2[left:right],
-00012f10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012f20: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-00012f30: 2020 2072 6e6b 7320 3d20 6e70 2e61 7267     rnks = np.arg
-00012f40: 736f 7274 2873 6c69 6365 645f 7361 6d70  sort(sliced_samp
-00012f50: 6c65 5f31 290a 2020 2020 2020 2020 2020  le_1).          
-00012f60: 2020 2020 2020 7331 5f72 6e6b 2c20 7332        s1_rnk, s2
-00012f70: 5f72 6e6b 203d 2073 6c69 6365 645f 7361  _rnk = sliced_sa
-00012f80: 6d70 6c65 5f31 5b72 6e6b 735d 2c20 736c  mple_1[rnks], sl
-00012f90: 6963 6564 5f73 616d 706c 655f 325b 726e  iced_sample_2[rn
-00012fa0: 6b73 5d0a 2020 2020 2020 2020 2020 2020  ks].            
-00012fb0: 2020 2020 636e 6372 646e 745f 636e 7473      cncrdnt_cnts
-00012fc0: 2c20 6473 6372 646e 745f 636e 7473 203d  , dscrdnt_cnts =
-00012fd0: 206e 702e 6675 6c6c 280a 2020 2020 2020   np.full(.      
-00012fe0: 2020 2020 2020 2020 2020 2020 2020 2873                (s
-00012ff0: 315f 726e 6b2e 7368 6170 655b 305d 202d  1_rnk.shape[0] -
-00013000: 2031 292c 206e 702e 6e61 6e0a 2020 2020   1), np.nan.    
-00013010: 2020 2020 2020 2020 2020 2020 292c 206e              ), n
-00013020: 702e 6675 6c6c 2828 7331 5f72 6e6b 2e73  p.full((s1_rnk.s
-00013030: 6861 7065 5b30 5d20 2d20 3129 2c20 6e70  hape[0] - 1), np
-00013040: 2e6e 616e 290a 2020 2020 2020 2020 2020  .nan).          
-00013050: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-00013060: 616e 6765 2873 325f 726e 6b2e 7368 6170  ange(s2_rnk.shap
-00013070: 655b 305d 202d 2031 293a 0a20 2020 2020  e[0] - 1):.     
-00013080: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00013090: 6e63 7264 6e74 5f63 6e74 735b 695d 203d  ncrdnt_cnts[i] =
-000130a0: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-000130b0: 2020 2020 2020 2020 2020 206e 702e 6172             np.ar
-000130c0: 6777 6865 7265 2873 325f 726e 6b5b 6920  gwhere(s2_rnk[i 
-000130d0: 2b20 3120 3a5d 203e 2073 325f 726e 6b5b  + 1 :] > s2_rnk[
-000130e0: 695d 292e 666c 6174 7465 6e28 292e 7368  i]).flatten().sh
-000130f0: 6170 655b 305d 0a20 2020 2020 2020 2020  ape[0].         
-00013100: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00013110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013120: 2064 7363 7264 6e74 5f63 6e74 735b 695d   dscrdnt_cnts[i]
-00013130: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-00013140: 2020 2020 2020 2020 2020 2020 206e 702e               np.
-00013150: 6172 6777 6865 7265 2873 325f 726e 6b5b  argwhere(s2_rnk[
-00013160: 6920 2b20 3120 3a5d 203c 2073 325f 726e  i + 1 :] < s2_rn
-00013170: 6b5b 695d 292e 666c 6174 7465 6e28 292e  k[i]).flatten().
-00013180: 7368 6170 655b 305d 0a20 2020 2020 2020  shape[0].       
-00013190: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-000131a0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000131b0: 6573 756c 7473 5b72 6967 6874 5d5b 7469  esults[right][ti
-000131c0: 6d65 5f77 696e 646f 775f 636e 745d 203d  me_window_cnt] =
-000131d0: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-000131e0: 2020 2020 2020 206e 702e 7375 6d28 636e         np.sum(cn
-000131f0: 6372 646e 745f 636e 7473 2920 2d20 6e70  crdnt_cnts) - np
-00013200: 2e73 756d 2864 7363 7264 6e74 5f63 6e74  .sum(dscrdnt_cnt
-00013210: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
-00013220: 2020 2029 202f 2028 6e70 2e73 756d 2863     ) / (np.sum(c
-00013230: 6e63 7264 6e74 5f63 6e74 7329 202b 206e  ncrdnt_cnts) + n
-00013240: 702e 7375 6d28 6473 6372 646e 745f 636e  p.sum(dscrdnt_cn
-00013250: 7473 2929 0a0a 2020 2020 2020 2020 7265  ts))..        re
-00013260: 7475 726e 2072 6573 756c 7473 0a0a 2020  turn results..  
-00013270: 2020 4073 7461 7469 636d 6574 686f 640a    @staticmethod.
-00013280: 2020 2020 6465 6620 6669 6e64 5f63 6f6c      def find_col
-00013290: 6c69 6e65 6172 5f66 6561 7475 7265 7328  linear_features(
-000132a0: 0a20 2020 2020 2020 2064 663a 2070 642e  .        df: pd.
-000132b0: 4461 7461 4672 616d 652c 0a20 2020 2020  DataFrame,.     
-000132c0: 2020 2074 6872 6573 686f 6c64 3a20 666c     threshold: fl
-000132d0: 6f61 742c 0a20 2020 2020 2020 206d 6574  oat,.        met
-000132e0: 686f 643a 204f 7074 696f 6e61 6c5b 4c69  hod: Optional[Li
-000132f0: 7465 7261 6c5b 2270 6561 7273 6f6e 222c  teral["pearson",
-00013300: 2022 7370 6561 726d 616e 222c 2022 6b65   "spearman", "ke
-00013310: 6e64 616c 6c22 5d5d 203d 2022 7065 6172  ndall"]] = "pear
-00013320: 736f 6e22 2c0a 2020 2020 2020 2020 7665  son",.        ve
-00013330: 7262 6f73 653a 204f 7074 696f 6e61 6c5b  rbose: Optional[
-00013340: 626f 6f6c 5d20 3d20 4661 6c73 652c 0a20  bool] = False,. 
-00013350: 2020 2029 202d 3e20 4c69 7374 5b73 7472     ) -> List[str
-00013360: 5d3a 0a20 2020 2020 2020 2022 2222 0a20  ]:.        """. 
-00013370: 2020 2020 2020 2049 6465 6e74 6966 7920         Identify 
-00013380: 636f 6c6c 696e 6561 7220 6665 6174 7572  collinear featur
-00013390: 6573 2069 6e20 7468 6520 6461 7461 6672  es in the datafr
-000133a0: 616d 6520 6261 7365 6420 6f6e 2074 6865  ame based on the
-000133b0: 2073 7065 6369 6669 6564 2063 6f72 7265   specified corre
-000133c0: 6c61 7469 6f6e 206d 6574 686f 6420 616e  lation method an
-000133d0: 6420 7468 7265 7368 6f6c 642e 0a0a 2020  d threshold...  
-000133e0: 2020 2020 2020 3a70 6172 616d 2070 642e        :param pd.
-000133f0: 4461 7461 4672 616d 6520 6466 3a20 496e  DataFrame df: In
-00013400: 7075 7420 4461 7461 4672 616d 6520 636f  put DataFrame co
-00013410: 6e74 6169 6e69 6e67 2066 6561 7475 7265  ntaining feature
-00013420: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
-00013430: 6d20 666c 6f61 7420 7468 7265 7368 6f6c  m float threshol
-00013440: 643a 2054 6872 6573 686f 6c64 2076 616c  d: Threshold val
-00013450: 7565 2074 6f20 6465 7465 726d 696e 6520  ue to determine 
-00013460: 636f 6c6c 696e 6561 7269 7479 2e0a 2020  collinearity..  
-00013470: 2020 2020 2020 3a70 6172 616d 204f 7074        :param Opt
-00013480: 696f 6e61 6c5b 4c69 7465 7261 6c5b 2770  ional[Literal['p
-00013490: 6561 7273 6f6e 272c 2027 7370 6561 726d  earson', 'spearm
-000134a0: 616e 272c 2027 6b65 6e64 616c 6c27 5d5d  an', 'kendall']]
-000134b0: 206d 6574 686f 643a 204d 6574 686f 6420   method: Method 
-000134c0: 666f 7220 6361 6c63 756c 6174 696e 6720  for calculating 
-000134d0: 636f 7272 656c 6174 696f 6e2e 2044 6566  correlation. Def
-000134e0: 6175 6c74 7320 746f 2027 7065 6172 736f  aults to 'pearso
-000134f0: 6e27 2e0a 2020 2020 2020 2020 3a72 6574  n'..        :ret
-00013500: 7572 6e3a 2053 6574 206f 6620 6665 6174  urn: Set of feat
-00013510: 7572 6520 6e61 6d65 7320 6964 656e 7469  ure names identi
-00013520: 6669 6564 2061 7320 636f 6c6c 696e 6561  fied as collinea
-00013530: 722e 2052 6574 7572 6e73 206f 6e65 2066  r. Returns one f
-00013540: 6561 7475 7265 2066 6f72 2065 7665 7279  eature for every
-00013550: 2066 6561 7475 7265 2070 6169 7220 7769   feature pair wi
-00013560: 7468 2063 6f72 7265 6c61 7469 6f6e 2076  th correlation v
-00013570: 616c 7565 2061 626f 7665 2073 7065 6369  alue above speci
-00013580: 6669 6564 2074 6872 6573 686f 6c64 2e0a  fied threshold..
-00013590: 0a20 2020 2020 2020 203a 6578 616d 706c  .        :exampl
-000135a0: 653a 0a20 2020 2020 2020 203e 3e3e 2078  e:.        >>> x
-000135b0: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
-000135c0: 6e70 2e72 616e 646f 6d2e 7261 6e64 696e  np.random.randin
-000135d0: 7428 302c 2031 3030 2c20 2831 3030 2c20  t(0, 100, (100, 
-000135e0: 3130 3029 2929 0a20 2020 2020 2020 203e  100))).        >
-000135f0: 3e3e 206e 616d 6573 203d 2053 7461 7469  >> names = Stati
-00013600: 7374 6963 732e 6669 6e64 5f63 6f6c 6c69  stics.find_colli
-00013610: 6e65 6172 5f66 6561 7475 7265 7328 6466  near_features(df
-00013620: 3d78 2c20 7468 7265 7368 6f6c 643d 302e  =x, threshold=0.
-00013630: 322c 206d 6574 686f 643d 2770 6561 7273  2, method='pears
-00013640: 6f6e 272c 2076 6572 626f 7365 3d54 7275  on', verbose=Tru
-00013650: 6529 0a20 2020 2020 2020 2022 2222 0a0a  e).        """..
-00013660: 2020 2020 2020 2020 6368 6563 6b5f 7661          check_va
-00013670: 6c69 645f 6461 7461 6672 616d 6528 0a20  lid_dataframe(. 
-00013680: 2020 2020 2020 2020 2020 2064 663d 6466             df=df
-00013690: 2c0a 2020 2020 2020 2020 2020 2020 736f  ,.            so
-000136a0: 7572 6365 3d53 7461 7469 7374 6963 732e  urce=Statistics.
-000136b0: 6669 6e64 5f63 6f6c 6c69 6e65 6172 5f66  find_collinear_f
-000136c0: 6561 7475 7265 732e 5f5f 6e61 6d65 5f5f  eatures.__name__
-000136d0: 2c0a 2020 2020 2020 2020 2020 2020 7661  ,.            va
-000136e0: 6c69 645f 6474 7970 6573 3d28 666c 6f61  lid_dtypes=(floa
-000136f0: 742c 2069 6e74 2c20 6e70 2e66 6c6f 6174  t, int, np.float
-00013700: 3332 2c20 6e70 2e66 6c6f 6174 3634 2c20  32, np.float64, 
-00013710: 6e70 2e69 6e74 3332 2c20 6e70 2e69 6e74  np.int32, np.int
-00013720: 3634 292c 0a20 2020 2020 2020 2020 2020  64),.           
-00013730: 206d 696e 5f61 7869 735f 313d 312c 0a20   min_axis_1=1,. 
-00013740: 2020 2020 2020 2020 2020 206d 696e 5f61             min_a
-00013750: 7869 735f 303d 312c 0a20 2020 2020 2020  xis_0=1,.       
-00013760: 2029 0a20 2020 2020 2020 2063 6865 636b   ).        check
-00013770: 5f66 6c6f 6174 280a 2020 2020 2020 2020  _float(.        
-00013780: 2020 2020 6e61 6d65 3d53 7461 7469 7374      name=Statist
-00013790: 6963 732e 6669 6e64 5f63 6f6c 6c69 6e65  ics.find_colline
-000137a0: 6172 5f66 6561 7475 7265 732e 5f5f 6e61  ar_features.__na
-000137b0: 6d65 5f5f 2c0a 2020 2020 2020 2020 2020  me__,.          
-000137c0: 2020 7661 6c75 653d 7468 7265 7368 6f6c    value=threshol
-000137d0: 642c 0a20 2020 2020 2020 2020 2020 206d  d,.            m
-000137e0: 6178 5f76 616c 7565 3d31 2e30 2c0a 2020  ax_value=1.0,.  
-000137f0: 2020 2020 2020 2020 2020 6d69 6e5f 7661            min_va
-00013800: 6c75 653d 302e 302c 0a20 2020 2020 2020  lue=0.0,.       
-00013810: 2029 0a20 2020 2020 2020 2063 6865 636b   ).        check
-00013820: 5f73 7472 280a 2020 2020 2020 2020 2020  _str(.          
-00013830: 2020 6e61 6d65 3d53 7461 7469 7374 6963    name=Statistic
-00013840: 732e 6669 6e64 5f63 6f6c 6c69 6e65 6172  s.find_collinear
-00013850: 5f66 6561 7475 7265 732e 5f5f 6e61 6d65  _features.__name
-00013860: 5f5f 2c0a 2020 2020 2020 2020 2020 2020  __,.            
-00013870: 7661 6c75 653d 6d65 7468 6f64 2c0a 2020  value=method,.  
-00013880: 2020 2020 2020 2020 2020 6f70 7469 6f6e            option
-00013890: 733d 2822 7065 6172 736f 6e22 2c20 2273  s=("pearson", "s
-000138a0: 7065 6172 6d61 6e22 2c20 226b 656e 6461  pearman", "kenda
-000138b0: 6c6c 2229 2c0a 2020 2020 2020 2020 290a  ll"),.        ).
-000138c0: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
-000138d0: 6e61 6d65 7320 3d20 7365 7428 290a 2020  names = set().  
-000138e0: 2020 2020 2020 6665 6174 7572 655f 7061        feature_pa
-000138f0: 6972 7320 3d20 6c69 7374 2863 6f6d 6269  irs = list(combi
-00013900: 6e61 7469 6f6e 7328 6c69 7374 2864 662e  nations(list(df.
-00013910: 636f 6c75 6d6e 7329 2c20 3229 290a 0a20  columns), 2)).. 
-00013920: 2020 2020 2020 2066 6f72 2063 6e74 2c20         for cnt, 
-00013930: 6920 696e 2065 6e75 6d65 7261 7465 2866  i in enumerate(f
-00013940: 6561 7475 7265 5f70 6169 7273 293a 0a20  eature_pairs):. 
-00013950: 2020 2020 2020 2020 2020 2069 6620 7665             if ve
-00013960: 7262 6f73 653a 0a20 2020 2020 2020 2020  rbose:.         
-00013970: 2020 2020 2020 2070 7269 6e74 280a 2020         print(.  
-00013980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013990: 2020 6622 416e 616c 797a 696e 6720 6665    f"Analyzing fe
-000139a0: 6174 7572 6520 7061 6972 2063 6f6c 6c69  ature pair colli
-000139b0: 6e65 6172 6974 7920 7b63 6e74 202b 2031  nearity {cnt + 1
-000139c0: 7d2f 7b6c 656e 2866 6561 7475 7265 5f70  }/{len(feature_p
-000139d0: 6169 7273 297d 2e2e 2e22 0a20 2020 2020  airs)}...".     
-000139e0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-000139f0: 2020 2020 2020 2020 2069 6620 2869 5b30           if (i[0
-00013a00: 5d20 6e6f 7420 696e 2066 6561 7475 7265  ] not in feature
-00013a10: 5f6e 616d 6573 2920 616e 6420 2869 5b31  _names) and (i[1
-00013a20: 5d20 6e6f 7420 696e 2066 6561 7475 7265  ] not in feature
-00013a30: 5f6e 616d 6573 293a 0a20 2020 2020 2020  _names):.       
-00013a40: 2020 2020 2020 2020 2073 616d 706c 655f           sample_
-00013a50: 312c 2073 616d 706c 655f 3220 3d20 6466  1, sample_2 = df
-00013a60: 5b69 5b30 5d5d 2e76 616c 7565 732e 6173  [i[0]].values.as
-00013a70: 7479 7065 286e 702e 666c 6f61 7433 3229  type(np.float32)
-00013a80: 2c20 6466 5b0a 2020 2020 2020 2020 2020  , df[.          
-00013a90: 2020 2020 2020 2020 2020 695b 315d 0a20            i[1]. 
-00013aa0: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-00013ab0: 2e76 616c 7565 732e 6173 7479 7065 286e  .values.astype(n
-00013ac0: 702e 666c 6f61 7433 3229 0a20 2020 2020  p.float32).     
-00013ad0: 2020 2020 2020 2020 2020 2069 6620 6d65             if me
-00013ae0: 7468 6f64 203d 3d20 2270 6561 7273 6f6e  thod == "pearson
-00013af0: 223a 0a20 2020 2020 2020 2020 2020 2020  ":.             
-00013b00: 2020 2020 2020 2072 203d 2053 7461 7469         r = Stati
-00013b10: 7374 6963 732e 7065 6172 736f 6e73 5f72  stics.pearsons_r
-00013b20: 2873 616d 706c 655f 313d 7361 6d70 6c65  (sample_1=sample
-00013b30: 5f31 2c20 7361 6d70 6c65 5f32 3d73 616d  _1, sample_2=sam
-00013b40: 706c 655f 3229 0a20 2020 2020 2020 2020  ple_2).         
-00013b50: 2020 2020 2020 2065 6c69 6620 6d65 7468         elif meth
-00013b60: 6f64 203d 3d20 2273 7065 6172 6d61 6e22  od == "spearman"
-00013b70: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00013b80: 2020 2020 2020 7220 3d20 5374 6174 6973        r = Statis
-00013b90: 7469 6373 2e73 7065 6172 6d61 6e5f 7261  tics.spearman_ra
-00013ba0: 6e6b 5f63 6f72 7265 6c61 7469 6f6e 280a  nk_correlation(.
-00013bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013bc0: 2020 2020 2020 2020 7361 6d70 6c65 5f31          sample_1
-00013bd0: 3d73 616d 706c 655f 312c 2073 616d 706c  =sample_1, sampl
-00013be0: 655f 323d 7361 6d70 6c65 5f32 0a20 2020  e_2=sample_2.   
-00013bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013c00: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-00013c10: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00013c20: 2020 2020 2020 2020 2020 2020 2072 203d               r =
-00013c30: 2053 7461 7469 7374 6963 732e 6b65 6e64   Statistics.kend
-00013c40: 616c 6c5f 7461 7528 7361 6d70 6c65 5f31  all_tau(sample_1
-00013c50: 3d73 616d 706c 655f 312c 2073 616d 706c  =sample_1, sampl
-00013c60: 655f 323d 7361 6d70 6c65 5f32 295b 305d  e_2=sample_2)[0]
-00013c70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013c80: 2069 6620 6162 7328 7229 203e 2074 6872   if abs(r) > thr
-00013c90: 6573 686f 6c64 3a0a 2020 2020 2020 2020  eshold:.        
-00013ca0: 2020 2020 2020 2020 2020 2020 6665 6174              feat
-00013cb0: 7572 655f 6e61 6d65 732e 6164 6428 695b  ure_names.add(i[
-00013cc0: 305d 290a 2020 2020 2020 2020 6966 2076  0]).        if v
-00013cd0: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
-00013ce0: 2020 2020 7072 696e 7428 2243 6f6c 6c69      print("Colli
-00013cf0: 6e65 6172 2061 6e61 6c79 7369 7320 636f  near analysis co
-00013d00: 6d70 6c65 7465 2e22 290a 2020 2020 2020  mplete.").      
-00013d10: 2020 7265 7475 726e 2066 6561 7475 7265    return feature
-00013d20: 5f6e 616d 6573 0a0a 2020 2020 4073 7461  _names..    @sta
-00013d30: 7469 636d 6574 686f 640a 2020 2020 6465  ticmethod.    de
-00013d40: 6620 6c6f 6361 6c5f 6f75 746c 6965 725f  f local_outlier_
-00013d50: 6661 6374 6f72 280a 2020 2020 2020 2020  factor(.        
-00013d60: 6461 7461 3a20 6e70 2e6e 6461 7272 6179  data: np.ndarray
-00013d70: 2c0a 2020 2020 2020 2020 6b3a 2055 6e69  ,.        k: Uni
-00013d80: 6f6e 5b69 6e74 2c20 666c 6f61 745d 203d  on[int, float] =
-00013d90: 2035 2c0a 2020 2020 2020 2020 636f 6e74   5,.        cont
-00013da0: 616d 696e 6174 696f 6e3a 204f 7074 696f  amination: Optio
-00013db0: 6e61 6c5b 666c 6f61 745d 203d 2031 652d  nal[float] = 1e-
-00013dc0: 3130 2c0a 2020 2020 2020 2020 6e6f 726d  10,.        norm
-00013dd0: 616c 697a 653a 204f 7074 696f 6e61 6c5b  alize: Optional[
-00013de0: 626f 6f6c 5d20 3d20 4661 6c73 652c 0a20  bool] = False,. 
-00013df0: 2020 2029 202d 3e20 6e70 2e6e 6461 7272     ) -> np.ndarr
-00013e00: 6179 3a0a 2020 2020 2020 2020 2222 220a  ay:.        """.
-00013e10: 2020 2020 2020 2020 436f 6d70 7574 6520          Compute 
-00013e20: 7468 6520 6c6f 6361 6c20 6f75 746c 6965  the local outlie
-00013e30: 7220 6661 6374 6f72 206f 6620 6561 6368  r factor of each
-00013e40: 206f 6273 6572 7661 7469 6f6e 2e0a 0a20   observation... 
-00013e50: 2020 2020 2020 202e 2e20 6e6f 7465 3a3a         .. note::
-00013e60: 0a0a 2020 2020 2020 2020 2020 2054 6865  ..           The
-00013e70: 2066 696e 616c 204c 4f46 2073 636f 7265   final LOF score
-00013e80: 7320 6172 6520 6e65 6761 7465 642e 2054  s are negated. T
-00013e90: 6875 732c 2068 6967 6865 7220 7661 6c75  hus, higher valu
-00013ea0: 6573 2069 6e64 6963 6174 6520 6d6f 7265  es indicate more
-00013eb0: 2061 7479 7069 6361 6c20 286f 7574 6c69   atypical (outli
-00013ec0: 6572 2920 6461 7461 2070 6f69 6e74 732e  er) data points.
-00013ed0: 0a0a 2020 2020 2020 2020 2020 204d 6574  ..           Met
-00013ee0: 686f 6420 6361 6c6c 7320 6060 736b 6c65  hod calls ``skle
-00013ef0: 6172 6e2e 6e65 6967 6862 6f72 732e 4c6f  arn.neighbors.Lo
-00013f00: 6361 6c4f 7574 6c69 6572 4661 6374 6f72  calOutlierFactor
-00013f10: 6060 2064 6972 6563 746c 792e 2050 7265  `` directly. Pre
-00013f20: 7669 6f75 736c 7920 6361 6c6c 6564 2075  viously called u
-00013f30: 7369 6e67 206f 776e 2069 6d70 6c65 6d65  sing own impleme
-00013f40: 6e74 6174 696f 6e20 4a49 5427 6564 206d  ntation JIT'ed m
-00013f50: 6574 686f 642c 0a20 2020 2020 2020 2020  ethod,.         
-00013f60: 2020 6275 7420 7275 6e74 696d 6520 7761    but runtime wa
-00013f70: 7320 3378 2d69 7368 2073 6c6f 7765 7220  s 3x-ish slower 
-00013f80: 7468 616e 2060 6073 6b6c 6561 726e 2e6e  than ``sklearn.n
-00013f90: 6569 6768 626f 7273 2e4c 6f63 616c 4f75  eighbors.LocalOu
-00013fa0: 746c 6965 7246 6163 746f 7260 602e 0a0a  tlierFactor``...
-00013fb0: 2020 2020 2020 2020 3a70 6172 616d 6574          :paramet
-00013fc0: 6572 206e 6461 7272 6179 2064 6174 613a  er ndarray data:
-00013fd0: 2032 4420 6172 7261 7920 7769 7468 2066   2D array with f
-00013fe0: 6561 7475 7265 2076 616c 7565 7320 7768  eature values wh
-00013ff0: 6572 6520 726f 7773 2072 6570 7265 7365  ere rows represe
-00014000: 6e74 2066 7261 6d65 7320 616e 6420 636f  nt frames and co
-00014010: 6c75 6d6e 7320 7265 7072 6573 656e 7420  lumns represent 
-00014020: 6665 6174 7572 6573 2e0a 2020 2020 2020  features..      
-00014030: 2020 3a70 6172 616d 6574 6572 2055 6e69    :parameter Uni
-00014040: 6f6e 5b69 6e74 2c20 666c 6f61 745d 206b  on[int, float] k
-00014050: 3a20 4e75 6d62 6572 206f 6620 6e65 6967  : Number of neig
-00014060: 6862 6f72 7320 746f 2065 7661 6c75 6174  hbors to evaluat
-00014070: 6520 666f 7220 6561 6368 206f 6273 6572  e for each obser
-00014080: 7661 7469 6f6e 2e20 4966 2074 6865 2076  vation. If the v
-00014090: 616c 7565 2069 7320 6120 666c 6f61 742c  alue is a float,
-000140a0: 2074 6865 6e20 696e 7465 7270 7265 7465   then interprete
-000140b0: 6420 6173 2074 6865 2072 6174 696f 206f  d as the ratio o
-000140c0: 6620 6461 7461 2e73 6861 7065 5b30 5d2e  f data.shape[0].
-000140d0: 2049 6620 7468 6520 7661 6c75 6520 6973   If the value is
-000140e0: 2061 6e20 696e 7465 6765 722c 2074 6865   an integer, the
-000140f0: 6e20 6974 2072 6570 7265 7365 6e74 2074  n it represent t
-00014100: 6865 206e 756d 6265 7220 6f66 206e 6569  he number of nei
-00014110: 6768 626f 7572 7320 746f 2065 7661 6c75  ghbours to evalu
-00014120: 6174 652e 0a20 2020 2020 2020 203a 7061  ate..        :pa
-00014130: 7261 6d65 7465 7220 4f70 7469 6f6e 616c  rameter Optional
-00014140: 5b66 6c6f 6174 5d20 636f 6e74 616d 696e  [float] contamin
-00014150: 6174 696f 6e3a 2053 6d61 6c6c 2070 7365  ation: Small pse
-00014160: 7564 6f6e 756d 6265 7220 746f 2061 766f  udonumber to avo
-00014170: 6964 2044 6976 6973 696f 6e42 795a 6572  id DivisionByZer
-00014180: 6f20 6572 726f 722e 0a20 2020 2020 2020  o error..       
-00014190: 203a 7061 7261 6d65 7465 7220 4f70 7469   :parameter Opti
-000141a0: 6f6e 616c 5b62 6f6f 6c5d 206e 6f72 6d61  onal[bool] norma
-000141b0: 6c69 7a65 3a20 5768 6574 6865 7220 746f  lize: Whether to
-000141c0: 206e 6f72 6d61 6c69 7a65 2074 6865 204d   normalize the M
-000141d0: 6168 616c 616e 6f62 6973 2064 6973 7461  ahalanobis dista
-000141e0: 6e63 6573 2062 6574 7765 656e 2030 2061  nces between 0 a
-000141f0: 6e64 2031 2e20 4465 6661 756c 7473 2074  nd 1. Defaults t
-00014200: 6f20 4661 6c73 652e 0a20 2020 2020 2020  o False..       
-00014210: 203a 7265 7475 726e 7320 6e70 2e6e 6461   :returns np.nda
-00014220: 7272 6179 3a20 4172 7261 7920 6f66 2073  rray: Array of s
-00014230: 697a 6520 6461 7461 2e73 6861 7065 5b30  ize data.shape[0
-00014240: 5d20 7769 7468 206c 6f63 616c 206f 7574  ] with local out
-00014250: 6c69 6572 2073 636f 7265 732e 0a0a 2020  lier scores...  
-00014260: 2020 2020 2020 3a65 7861 6d70 6c65 3a0a        :example:.
-00014270: 2020 2020 2020 2020 3e3e 3e20 6461 7461          >>> data
-00014280: 203d 206e 702e 7261 6e64 6f6d 2e6e 6f72   = np.random.nor
-00014290: 6d61 6c28 6c6f 633d 3435 2c20 7363 616c  mal(loc=45, scal
-000142a0: 653d 312c 2073 697a 653d 3130 3029 2e61  e=1, size=100).a
-000142b0: 7374 7970 6528 6e70 2e66 6c6f 6174 3332  stype(np.float32
-000142c0: 290a 2020 2020 2020 2020 3e3e 3e20 666f  ).        >>> fo
-000142d0: 7220 6920 696e 2072 616e 6765 2835 293a  r i in range(5):
-000142e0: 2064 6174 6120 3d20 6e70 2e76 7374 6163   data = np.vstac
-000142f0: 6b28 5b64 6174 612c 206e 702e 7261 6e64  k([data, np.rand
-00014300: 6f6d 2e6e 6f72 6d61 6c28 6c6f 633d 3435  om.normal(loc=45
-00014310: 2c20 7363 616c 653d 312c 2073 697a 653d  , scale=1, size=
-00014320: 3130 3029 2e61 7374 7970 6528 6e70 2e66  100).astype(np.f
-00014330: 6c6f 6174 3332 295d 290a 2020 2020 2020  loat32)]).      
-00014340: 2020 3e3e 3e20 666f 7220 6920 696e 2072    >>> for i in r
-00014350: 616e 6765 2832 293a 2064 6174 6120 3d20  ange(2): data = 
-00014360: 6e70 2e76 7374 6163 6b28 5b64 6174 612c  np.vstack([data,
-00014370: 206e 702e 7261 6e64 6f6d 2e6e 6f72 6d61   np.random.norma
-00014380: 6c28 6c6f 633d 3930 2c20 7363 616c 653d  l(loc=90, scale=
-00014390: 312c 2073 697a 653d 3130 3029 2e61 7374  1, size=100).ast
-000143a0: 7970 6528 6e70 2e66 6c6f 6174 3332 295d  ype(np.float32)]
-000143b0: 290a 2020 2020 2020 2020 3e3e 3e20 5374  ).        >>> St
-000143c0: 6174 6973 7469 6373 2829 2e6c 6f63 616c  atistics().local
-000143d0: 5f6f 7574 6c69 6572 5f66 6163 746f 7228  _outlier_factor(
-000143e0: 6461 7461 3d64 6174 612c 206b 3d35 290a  data=data, k=5).
-000143f0: 2020 2020 2020 2020 3e3e 3e20 5b31 2e30          >>> [1.0
-00014400: 3034 2c20 312e 3030 372c 2030 2e39 3836  04, 1.007, 0.986
-00014410: 2c20 312e 3031 382c 2030 2e39 3836 2c20  , 1.018, 0.986, 
-00014420: 302e 3939 362c 2032 342e 3036 372c 2032  0.996, 24.067, 2
-00014430: 342e 3035 375d 0a20 2020 2020 2020 2022  4.057].        "
-00014440: 2222 0a0a 2020 2020 2020 2020 6368 6563  ""..        chec
-00014450: 6b5f 7661 6c69 645f 6172 7261 7928 0a20  k_valid_array(. 
-00014460: 2020 2020 2020 2020 2020 2073 6f75 7263             sourc
-00014470: 653d 6622 7b53 7461 7469 7374 6963 732e  e=f"{Statistics.
-00014480: 5f5f 636c 6173 735f 5f2e 5f5f 6e61 6d65  __class__.__name
-00014490: 5f5f 7d20 6c6f 6361 6c5f 6f75 746c 6965  __} local_outlie
-000144a0: 725f 6661 6374 6f72 222c 0a20 2020 2020  r_factor",.     
-000144b0: 2020 2020 2020 2064 6174 613d 6461 7461         data=data
-000144c0: 2c0a 2020 2020 2020 2020 2020 2020 6163  ,.            ac
-000144d0: 6365 7074 6564 5f73 697a 6573 3d5b 325d  cepted_sizes=[2]
-000144e0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-000144f0: 2020 2020 6966 206b 2069 7320 6e6f 7420      if k is not 
-00014500: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00014510: 2020 6368 6563 6b5f 666c 6f61 7428 6e61    check_float(na
-00014520: 6d65 3d66 227b 5374 6174 6973 7469 6373  me=f"{Statistics
-00014530: 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e 616d  .__class__.__nam
-00014540: 655f 5f7d 206b 222c 2076 616c 7565 3d6b  e__} k", value=k
-00014550: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-00014560: 2069 7369 6e73 7461 6e63 6528 6b2c 2069   isinstance(k, i
-00014570: 6e74 293a 0a20 2020 2020 2020 2020 2020  nt):.           
-00014580: 2020 2020 206b 203d 206d 696e 286b 2c20       k = min(k, 
-00014590: 6461 7461 2e73 6861 7065 5b30 5d29 0a20  data.shape[0]). 
-000145a0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-000145b0: 6973 696e 7374 616e 6365 286b 2c20 666c  isinstance(k, fl
-000145c0: 6f61 7429 3a0a 2020 2020 2020 2020 2020  oat):.          
-000145d0: 2020 2020 2020 6b20 3d20 696e 7428 6461        k = int(da
-000145e0: 7461 2e73 6861 7065 5b30 5d20 2a20 6b29  ta.shape[0] * k)
-000145f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014600: 2069 6620 6b20 3e20 6461 7461 2e73 6861   if k > data.sha
-00014610: 7065 5b30 5d3a 0a20 2020 2020 2020 2020  pe[0]:.         
-00014620: 2020 2020 2020 2020 2020 206b 203d 2064             k = d
-00014630: 6174 612e 7368 6170 655b 305d 0a0a 2020  ata.shape[0]..  
-00014640: 2020 2020 2020 6368 6563 6b5f 666c 6f61        check_floa
-00014650: 7428 0a20 2020 2020 2020 2020 2020 206e  t(.            n
-00014660: 616d 653d 6622 7b53 7461 7469 7374 6963  ame=f"{Statistic
-00014670: 732e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  s.__class__.__na
-00014680: 6d65 5f5f 7d20 636f 6e74 616d 696e 6174  me__} contaminat
-00014690: 696f 6e22 2c0a 2020 2020 2020 2020 2020  ion",.          
-000146a0: 2020 7661 6c75 653d 636f 6e74 616d 696e    value=contamin
-000146b0: 6174 696f 6e2c 0a20 2020 2020 2020 2020  ation,.         
-000146c0: 2020 206d 696e 5f76 616c 7565 3d30 2e30     min_value=0.0
-000146d0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-000146e0: 2020 2020 206c 6f66 5f6d 6f64 656c 203d       lof_model =
-000146f0: 204c 6f63 616c 4f75 746c 6965 7246 6163   LocalOutlierFac
-00014700: 746f 7228 6e5f 6e65 6967 6862 6f72 733d  tor(n_neighbors=
-00014710: 6b2c 2063 6f6e 7461 6d69 6e61 7469 6f6e  k, contamination
-00014720: 3d63 6f6e 7461 6d69 6e61 7469 6f6e 290a  =contamination).
-00014730: 2020 2020 2020 2020 5f20 3d20 6c6f 665f          _ = lof_
-00014740: 6d6f 6465 6c2e 6669 745f 7072 6564 6963  model.fit_predic
-00014750: 7428 6461 7461 290a 2020 2020 2020 2020  t(data).        
-00014760: 7920 3d20 2d6c 6f66 5f6d 6f64 656c 2e6e  y = -lof_model.n
-00014770: 6567 6174 6976 655f 6f75 746c 6965 725f  egative_outlier_
-00014780: 6661 6374 6f72 5f2e 6173 7479 7065 286e  factor_.astype(n
-00014790: 702e 666c 6f61 7433 3229 0a20 2020 2020  p.float32).     
-000147a0: 2020 2069 6620 6e6f 726d 616c 697a 653a     if normalize:
-000147b0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-000147c0: 7572 6e20 2879 202d 206e 702e 6d69 6e28  urn (y - np.min(
-000147d0: 7929 2920 2f20 286e 702e 6d61 7828 7929  y)) / (np.max(y)
-000147e0: 202d 206e 702e 6d69 6e28 7929 290a 2020   - np.min(y)).  
-000147f0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00014800: 2020 2020 2020 2020 7265 7475 726e 2079          return y
-00014810: 0a0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
-00014820: 686f 640a 2020 2020 6465 6620 656c 6c69  hod.    def elli
-00014830: 7074 6963 5f65 6e76 656c 6f70 6528 0a20  ptic_envelope(. 
-00014840: 2020 2020 2020 2064 6174 613a 206e 702e         data: np.
-00014850: 6e64 6172 7261 792c 0a20 2020 2020 2020  ndarray,.       
-00014860: 2063 6f6e 7461 6d69 6e61 7469 6f6e 3a20   contamination: 
-00014870: 4f70 7469 6f6e 616c 5b66 6c6f 6174 5d20  Optional[float] 
-00014880: 3d20 3165 2d31 2c0a 2020 2020 2020 2020  = 1e-1,.        
-00014890: 6e6f 726d 616c 697a 653a 204f 7074 696f  normalize: Optio
-000148a0: 6e61 6c5b 626f 6f6c 5d20 3d20 5472 7565  nal[bool] = True
-000148b0: 2c0a 2020 2020 2920 2d3e 206e 702e 6e64  ,.    ) -> np.nd
-000148c0: 6172 7261 793a 0a20 2020 2020 2020 2022  array:.        "
-000148d0: 2222 0a20 2020 2020 2020 2043 6f6d 7075  "".        Compu
-000148e0: 7465 2074 6865 204d 6168 616c 616e 6f62  te the Mahalanob
-000148f0: 6973 2064 6973 7461 6e63 6573 206f 6620  is distances of 
-00014900: 6561 6368 206f 6273 6572 7661 7469 6f6e  each observation
-00014910: 2069 6e20 7468 6520 696e 7075 7420 6172   in the input ar
-00014920: 7261 7920 7573 696e 6720 456c 6c69 7074  ray using Ellipt
-00014930: 6963 2045 6e76 656c 6f70 6520 6d65 7468  ic Envelope meth
-00014940: 6f64 2e0a 0a20 2020 2020 2020 202e 2e20  od...        .. 
-00014950: 696d 6167 653a 3a20 5f73 7461 7469 632f  image:: _static/
-00014960: 696d 672f 656c 6c69 7074 6963 5f65 6e76  img/elliptic_env
-00014970: 656c 6f70 652e 706e 670a 2020 2020 2020  elope.png.      
-00014980: 2020 2020 203a 7769 6474 683a 2038 3030       :width: 800
-00014990: 0a20 2020 2020 2020 2020 2020 3a61 6c69  .           :ali
-000149a0: 676e 3a20 6365 6e74 6572 0a0a 2020 2020  gn: center..    
-000149b0: 2020 2020 3a70 6172 616d 2064 6174 613a      :param data:
-000149c0: 2049 6e70 7574 2064 6174 6120 6172 7261   Input data arra
-000149d0: 7920 6f66 2073 6861 7065 2028 6e5f 7361  y of shape (n_sa
-000149e0: 6d70 6c65 732c 206e 5f66 6561 7475 7265  mples, n_feature
-000149f0: 7329 2e0a 2020 2020 2020 2020 3a70 6172  s)..        :par
-00014a00: 616d 204f 7074 696f 6e61 6c5b 666c 6f61  am Optional[floa
-00014a10: 745d 2063 6f6e 7461 6d69 6e61 7469 6f6e  t] contamination
-00014a20: 3a20 5468 6520 7072 6f70 6f72 7469 6f6e  : The proportion
-00014a30: 206f 6620 6f75 746c 6965 7273 2074 6f20   of outliers to 
-00014a40: 6265 2061 7373 756d 6564 2069 6e20 7468  be assumed in th
-00014a50: 6520 6461 7461 2e20 4465 6661 756c 7473  e data. Defaults
-00014a60: 2074 6f20 302e 312e 0a20 2020 2020 2020   to 0.1..       
-00014a70: 203a 7061 7261 6d20 4f70 7469 6f6e 616c   :param Optional
-00014a80: 5b62 6f6f 6c5d 206e 6f72 6d61 6c69 7a65  [bool] normalize
-00014a90: 3a20 5768 6574 6865 7220 746f 206e 6f72  : Whether to nor
-00014aa0: 6d61 6c69 7a65 2074 6865 204d 6168 616c  malize the Mahal
-00014ab0: 616e 6f62 6973 2064 6973 7461 6e63 6573  anobis distances
-00014ac0: 2062 6574 7765 656e 2030 2061 6e64 2031   between 0 and 1
-00014ad0: 2e20 4465 6661 756c 7473 2074 6f20 5472  . Defaults to Tr
-00014ae0: 7565 2e0a 2020 2020 2020 2020 3a72 6574  ue..        :ret
-00014af0: 7572 6e20 6e70 2e6e 6461 7272 6179 3a20  urn np.ndarray: 
-00014b00: 5468 6520 4d61 6861 6c61 6e6f 6269 7320  The Mahalanobis 
-00014b10: 6469 7374 616e 6365 7320 6f66 2065 6163  distances of eac
-00014b20: 6820 6f62 7365 7276 6174 696f 6e20 696e  h observation in
-00014b30: 2061 7272 6179 2e20 4c61 7267 6572 2076   array. Larger v
-00014b40: 616c 7565 7320 696e 6469 6361 7465 206f  alues indicate o
-00014b50: 7574 6c69 6572 732e 0a0a 2020 2020 2020  utliers...      
-00014b60: 2020 3a65 7861 6d70 6c65 3a0a 2020 2020    :example:.    
-00014b70: 2020 2020 3e3e 3e20 6461 7461 5f70 6174      >>> data_pat
-00014b80: 6820 3d20 272f 5573 6572 732f 7369 6d6f  h = '/Users/simo
-00014b90: 6e2f 4465 736b 746f 702f 656e 7673 2f4e  n/Desktop/envs/N
-00014ba0: 475f 556e 7375 7065 7276 6973 6564 2f70  G_Unsupervised/p
-00014bb0: 726f 6a65 6374 5f66 6f6c 6465 722f 636c  roject_folder/cl
-00014bc0: 7573 7465 7273 2f62 6561 7574 6966 756c  usters/beautiful
-00014bd0: 5f62 6561 7665 722e 7069 636b 6c65 270a  _beaver.pickle'.
-00014be0: 2020 2020 2020 2020 3e3e 3e20 7820 3d20          >>> x = 
-00014bf0: 7265 6164 5f70 6963 6b6c 6528 6461 7461  read_pickle(data
-00014c00: 5f70 6174 683d 6461 7461 5f70 6174 6829  _path=data_path)
-00014c10: 5b27 4452 5f4d 4f44 454c 275d 5b27 4d4f  ['DR_MODEL']['MO
-00014c20: 4445 4c27 5d2e 656d 6265 6464 696e 675f  DEL'].embedding_
-00014c30: 0a20 2020 2020 2020 203e 3e3e 2079 203d  .        >>> y =
-00014c40: 2065 6c6c 6970 7469 635f 656e 7665 6c6f   elliptic_envelo
-00014c50: 7065 2864 6174 613d 782c 2063 6f6e 7461  pe(data=x, conta
-00014c60: 6d69 6e61 7469 6f6e 3d30 2e31 290a 2020  mination=0.1).  
-00014c70: 2020 2020 2020 3e3e 3e20 6461 7461 203d        >>> data =
-00014c80: 206e 702e 6873 7461 636b 2828 782c 2079   np.hstack((x, y
-00014c90: 2e72 6573 6861 7065 282d 312c 2031 2929  .reshape(-1, 1))
-00014ca0: 290a 2020 2020 2020 2020 3e3e 3e20 696d  ).        >>> im
-00014cb0: 6720 3d20 506c 6f74 7469 6e67 4d69 7869  g = PlottingMixi
-00014cc0: 6e2e 636f 6e74 696e 756f 7573 5f73 6361  n.continuous_sca
-00014cd0: 7474 6572 2864 6174 613d 6461 7461 2c20  tter(data=data, 
-00014ce0: 636f 6c75 6d6e 733d 2827 5827 2c20 2759  columns=('X', 'Y
-00014cf0: 272c 2027 4d61 6861 6c61 6e6f 6269 7320  ', 'Mahalanobis 
-00014d00: 6469 7374 616e 6365 7327 292c 2073 697a  distances'), siz
-00014d10: 653d 3230 2c20 7061 6c65 7474 653d 276a  e=20, palette='j
-00014d20: 6574 2729 0a20 2020 2020 2020 2022 2222  et').        """
-00014d30: 0a0a 2020 2020 2020 2020 6368 6563 6b5f  ..        check_
-00014d40: 7661 6c69 645f 6172 7261 7928 0a20 2020  valid_array(.   
-00014d50: 2020 2020 2020 2020 2064 6174 613d 6461           data=da
-00014d60: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
-00014d70: 6163 6365 7074 6564 5f6e 6469 6d73 3d28  accepted_ndims=(
-00014d80: 322c 292c 0a20 2020 2020 2020 2020 2020  2,),.           
-00014d90: 2061 6363 6570 7465 645f 6474 7970 6573   accepted_dtypes
-00014da0: 3d28 6e70 2e66 6c6f 6174 3634 2c20 6e70  =(np.float64, np
-00014db0: 2e66 6c6f 6174 3332 2c20 6e70 2e69 6e74  .float32, np.int
-00014dc0: 3332 2c20 6e70 2e69 6e74 3634 2c20 666c  32, np.int64, fl
-00014dd0: 6f61 742c 2069 6e74 292c 0a20 2020 2020  oat, int),.     
-00014de0: 2020 2029 0a20 2020 2020 2020 2063 6865     ).        che
-00014df0: 636b 5f66 6c6f 6174 280a 2020 2020 2020  ck_float(.      
-00014e00: 2020 2020 2020 6e61 6d65 3d66 227b 5374        name=f"{St
-00014e10: 6174 6973 7469 6373 2e65 6c6c 6970 7469  atistics.ellipti
-00014e20: 635f 656e 7665 6c6f 7065 2e5f 5f6e 616d  c_envelope.__nam
-00014e30: 655f 5f7d 2063 6f6e 7461 6d69 6e61 7469  e__} contaminati
-00014e40: 6f6e 222c 0a20 2020 2020 2020 2020 2020  on",.           
-00014e50: 2076 616c 7565 3d63 6f6e 7461 6d69 6e61   value=contamina
-00014e60: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
-00014e70: 2020 6d69 6e5f 7661 6c75 653d 302e 302c    min_value=0.0,
-00014e80: 0a20 2020 2020 2020 2020 2020 206d 6178  .            max
-00014e90: 5f76 616c 7565 3d31 2e30 2c0a 2020 2020  _value=1.0,.    
-00014ea0: 2020 2020 290a 2020 2020 2020 2020 6d64      ).        md
-00014eb0: 6c20 3d20 456c 6c69 7074 6963 456e 7665  l = EllipticEnve
-00014ec0: 6c6f 7065 2863 6f6e 7461 6d69 6e61 7469  lope(contaminati
-00014ed0: 6f6e 3d63 6f6e 7461 6d69 6e61 7469 6f6e  on=contamination
-00014ee0: 292e 6669 7428 6461 7461 290a 2020 2020  ).fit(data).    
-00014ef0: 2020 2020 7920 3d20 2d6d 646c 2e73 636f      y = -mdl.sco
-00014f00: 7265 5f73 616d 706c 6573 2864 6174 6129  re_samples(data)
-00014f10: 0a20 2020 2020 2020 2069 6620 6e6f 726d  .        if norm
-00014f20: 616c 697a 653a 0a20 2020 2020 2020 2020  alize:.         
-00014f30: 2020 2079 203d 2028 7920 2d20 6e70 2e6d     y = (y - np.m
-00014f40: 696e 2879 2929 202f 2028 6e70 2e6d 6178  in(y)) / (np.max
-00014f50: 2879 2920 2d20 6e70 2e6d 696e 2879 2929  (y) - np.min(y))
-00014f60: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00014f70: 790a 0a20 2020 2040 7374 6174 6963 6d65  y..    @staticme
-00014f80: 7468 6f64 0a20 2020 2040 6a69 7428 6e6f  thod.    @jit(no
-00014f90: 7079 7468 6f6e 3d54 7275 6529 0a20 2020  python=True).   
-00014fa0: 2064 6566 205f 6862 6f73 5f63 6f6d 7075   def _hbos_compu
-00014fb0: 7465 280a 2020 2020 2020 2020 6461 7461  te(.        data
-00014fc0: 3a20 6e70 2e6e 6461 7272 6179 2c20 6869  : np.ndarray, hi
-00014fd0: 7374 6f67 7261 6d73 3a20 7479 7065 642e  stograms: typed.
-00014fe0: 4469 6374 2c20 6869 7374 6f67 7261 6d5f  Dict, histogram_
-00014ff0: 6564 6765 733a 2074 7970 6564 2e44 6963  edges: typed.Dic
-00015000: 740a 2020 2020 2920 2d3e 206e 702e 6e64  t.    ) -> np.nd
-00015010: 6172 7261 793a 0a20 2020 2020 2020 2022  array:.        "
-00015020: 2222 0a20 2020 2020 2020 204a 6974 7465  "".        Jitte
-00015030: 6420 6865 6c70 6572 2074 6f20 636f 6d70  d helper to comp
-00015040: 7574 6520 4869 7374 6f67 7261 6d2d 6261  ute Histogram-ba
-00015050: 7365 6420 4f75 746c 6965 7220 5363 6f72  sed Outlier Scor
-00015060: 6520 2848 424f 5329 2063 616c 6c65 6420  e (HBOS) called 
-00015070: 6279 2060 6073 696d 6261 2e6d 6978 696e  by ``simba.mixin
-00015080: 732e 7374 6174 6973 7469 6373 5f6d 6978  s.statistics_mix
-00015090: 696e 2e53 7461 7469 7374 6963 732e 6862  in.Statistics.hb
-000150a0: 6f73 6060 2e0a 0a20 2020 2020 2020 203a  os``...        :
-000150b0: 7061 7261 6d65 7465 7220 6e70 2e6e 6461  parameter np.nda
-000150c0: 7272 6179 2064 6174 613a 2032 6420 6172  rray data: 2d ar
-000150d0: 7261 7920 7769 7468 2066 7261 6d65 7320  ray with frames 
-000150e0: 7265 7072 6573 656e 7465 6420 6279 2072  represented by r
-000150f0: 6f77 7320 616e 6420 636f 6c75 6d6e 7320  ows and columns 
-00015100: 7265 7072 6573 656e 7469 6e67 2066 6561  representing fea
-00015110: 7475 7265 2076 616c 7565 732e 0a20 2020  ture values..   
-00015120: 2020 2020 203a 7061 7261 6d65 7465 7220       :parameter 
-00015130: 7479 7065 642e 4469 6374 2068 6973 746f  typed.Dict histo
-00015140: 6772 616d 733a 204e 756d 6261 2074 7970  grams: Numba typ
-00015150: 6564 2e44 6963 7420 7769 7468 2069 6e74  ed.Dict with int
-00015160: 6567 6572 206b 6579 7320 2872 6570 7265  eger keys (repre
-00015170: 7365 6e74 696e 6720 6f72 6465 7220 6f66  senting order of
-00015180: 2066 6561 7475 7265 2920 616e 6420 3164   feature) and 1d
-00015190: 2061 7272 6179 7320 6173 2076 616c 7565   arrays as value
-000151a0: 7320 7265 7072 6573 656e 7469 6e67 206f  s representing o
-000151b0: 6273 6572 7661 7469 6f6e 2062 696e 2063  bservation bin c
-000151c0: 6f75 6e74 732e 0a20 2020 2020 2020 203a  ounts..        :
-000151d0: 7061 7261 6d65 7465 723a 2074 7970 6564  parameter: typed
-000151e0: 2e44 6963 7420 6869 7374 6f67 7261 6d5f  .Dict histogram_
-000151f0: 6564 6765 733a 204e 756d 6261 2074 7970  edges: Numba typ
-00015200: 6564 2e44 6963 7420 7769 7468 2069 6e74  ed.Dict with int
-00015210: 6567 6572 206b 6579 7320 2872 6570 7265  eger keys (repre
-00015220: 7365 6e74 696e 6720 6f72 6465 7220 6f66  senting order of
-00015230: 2066 6561 7475 7265 2920 616e 6420 3164   feature) and 1d
-00015240: 2061 7272 6179 7320 6173 2076 616c 7565   arrays as value
-00015250: 7320 7265 7072 6573 656e 7469 6e67 2062  s representing b
-00015260: 696e 2065 6467 6573 2e0a 2020 2020 2020  in edges..      
-00015270: 2020 3a72 6574 7572 6e20 6e70 2e6e 6461    :return np.nda
-00015280: 7272 6179 3a20 4172 7261 7920 6f66 2073  rray: Array of s
-00015290: 697a 6520 6461 7461 2e73 6861 7065 5b30  ize data.shape[0
-000152a0: 5d20 7265 7072 6573 656e 7469 6e67 206f  ] representing o
-000152b0: 7574 6c69 6572 2073 636f 7265 732c 2077  utlier scores, w
-000152c0: 6974 6820 6869 6768 6572 2076 616c 7565  ith higher value
-000152d0: 7320 7265 7072 6573 656e 7469 6e67 2067  s representing g
-000152e0: 7265 6174 6572 206f 7574 6c69 6572 732e  reater outliers.
-000152f0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-00015300: 2020 2020 2020 7265 7375 6c74 7320 3d20        results = 
-00015310: 6e70 2e66 756c 6c28 2864 6174 612e 7368  np.full((data.sh
-00015320: 6170 655b 305d 292c 206e 702e 6e61 6e29  ape[0]), np.nan)
-00015330: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
-00015340: 6461 7461 2e61 7374 7970 6528 6e70 2e66  data.astype(np.f
-00015350: 6c6f 6174 3332 290a 2020 2020 2020 2020  loat32).        
-00015360: 666f 7220 6920 696e 2070 7261 6e67 6528  for i in prange(
-00015370: 6461 7461 2e73 6861 7065 5b30 5d29 3a0a  data.shape[0]):.
-00015380: 2020 2020 2020 2020 2020 2020 7363 6f72              scor
-00015390: 6520 3d20 302e 300a 2020 2020 2020 2020  e = 0.0.        
-000153a0: 2020 2020 666f 7220 6a20 696e 2070 7261      for j in pra
-000153b0: 6e67 6528 6461 7461 2e73 6861 7065 5b31  nge(data.shape[1
-000153c0: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
-000153d0: 2020 2020 7661 6c75 652c 2062 696e 5f69      value, bin_i
-000153e0: 6478 203d 2064 6174 615b 695d 5b6a 5d2c  dx = data[i][j],
-000153f0: 206e 702e 6e61 6e0a 2020 2020 2020 2020   np.nan.        
-00015400: 2020 2020 2020 2020 666f 7220 6b20 696e          for k in
-00015410: 206e 702e 6172 616e 6765 2868 6973 746f   np.arange(histo
-00015420: 6772 616d 5f65 6467 6573 5b6a 5d2e 7368  gram_edges[j].sh
-00015430: 6170 655b 305d 2c20 302c 202d 3129 3a0a  ape[0], 0, -1):.
-00015440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015450: 2020 2020 6269 6e5f 6d61 782c 2062 696e      bin_max, bin
-00015460: 5f6d 696e 203d 2068 6973 746f 6772 616d  _min = histogram
-00015470: 5f65 6467 6573 5b6a 5d5b 6b5d 2c20 6869  _edges[j][k], hi
-00015480: 7374 6f67 7261 6d5f 6564 6765 735b 6a5d  stogram_edges[j]
-00015490: 5b6b 202d 2031 5d0a 2020 2020 2020 2020  [k - 1].        
-000154a0: 2020 2020 2020 2020 2020 2020 6966 2028              if (
-000154b0: 7661 6c75 6520 3c3d 2062 696e 5f6d 6178  value <= bin_max
-000154c0: 2920 616e 6420 2876 616c 7565 203e 2062  ) and (value > b
-000154d0: 696e 5f6d 696e 293a 0a20 2020 2020 2020  in_min):.       
-000154e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000154f0: 2062 696e 5f69 6478 203d 206b 0a20 2020   bin_idx = k.   
-00015500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015510: 2020 2020 2063 6f6e 7469 6e75 650a 2020       continue.  
-00015520: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00015530: 206e 702e 6973 6e61 6e28 6269 6e5f 6964   np.isnan(bin_id
-00015540: 7829 3a0a 2020 2020 2020 2020 2020 2020  x):.            
-00015550: 2020 2020 2020 2020 6269 6e5f 6964 7820          bin_idx 
-00015560: 3d20 300a 2020 2020 2020 2020 2020 2020  = 0.            
-00015570: 2020 2020 7363 6f72 6520 2b3d 202d 6e70      score += -np
-00015580: 2e6c 6f67 2868 6973 746f 6772 616d 735b  .log(histograms[
-00015590: 6a5d 5b69 6e74 2862 696e 5f69 6478 2920  j][int(bin_idx) 
-000155a0: 2d20 315d 202b 2031 652d 3130 290a 2020  - 1] + 1e-10).  
-000155b0: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-000155c0: 735b 695d 203d 2073 636f 7265 0a20 2020  s[i] = score.   
-000155d0: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
-000155e0: 6c74 730a 0a20 2020 2064 6566 2068 626f  lts..    def hbo
-000155f0: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
-00015600: 0a20 2020 2020 2020 2064 6174 613a 206e  .        data: n
-00015610: 702e 6e64 6172 7261 792c 0a20 2020 2020  p.ndarray,.     
-00015620: 2020 2062 7563 6b65 745f 6d65 7468 6f64     bucket_method
-00015630: 3a20 4c69 7465 7261 6c5b 0a20 2020 2020  : Literal[.     
-00015640: 2020 2020 2020 2022 6664 222c 2022 646f         "fd", "do
-00015650: 616e 6522 2c20 2261 7574 6f22 2c20 2273  ane", "auto", "s
-00015660: 636f 7474 222c 2022 7374 6f6e 6522 2c20  cott", "stone", 
-00015670: 2272 6963 6522 2c20 2273 7475 7267 6573  "rice", "sturges
-00015680: 222c 2022 7371 7274 220a 2020 2020 2020  ", "sqrt".      
-00015690: 2020 5d20 3d20 2261 7574 6f22 2c0a 2020    ] = "auto",.  
-000156a0: 2020 2920 2d3e 206e 702e 6e64 6172 7261    ) -> np.ndarra
-000156b0: 793a 0a20 2020 2020 2020 2022 2222 0a20  y:.        """. 
-000156c0: 2020 2020 2020 204a 6974 7465 6420 636f         Jitted co
-000156d0: 6d70 7574 6520 6f66 2048 6973 746f 6772  mpute of Histogr
-000156e0: 616d 2d62 6173 6564 204f 7574 6c69 6572  am-based Outlier
-000156f0: 2053 636f 7265 7320 2848 424f 5329 2e20   Scores (HBOS). 
-00015700: 4842 4f53 2071 7561 6e74 6966 6965 7320  HBOS quantifies 
-00015710: 7468 6520 6162 6e6f 726d 616c 6974 7920  the abnormality 
-00015720: 6f66 2064 6174 6120 706f 696e 7473 2062  of data points b
-00015730: 6173 6564 206f 6e20 7468 6520 6465 6e73  ased on the dens
-00015740: 6974 6965 7320 6f66 2074 6865 6972 2066  ities of their f
-00015750: 6561 7475 7265 2076 616c 7565 730a 2020  eature values.  
-00015760: 2020 2020 2020 7769 7468 696e 2074 6865        within the
-00015770: 6972 2072 6573 7065 6374 6976 6520 6275  ir respective bu
-00015780: 636b 6574 7320 6f76 6572 2061 6c6c 2066  ckets over all f
-00015790: 6561 7475 7265 2076 616c 7565 732e 0a0a  eature values...
-000157a0: 2020 2020 2020 2020 3a70 6172 616d 6574          :paramet
-000157b0: 6572 206e 702e 6e64 6172 7261 7920 6461  er np.ndarray da
-000157c0: 7461 3a20 3264 2061 7272 6179 2077 6974  ta: 2d array wit
-000157d0: 6820 6672 616d 6573 2072 6570 7265 7365  h frames represe
-000157e0: 6e74 6564 2062 7920 726f 7773 2061 6e64  nted by rows and
-000157f0: 2063 6f6c 756d 6e73 2072 6570 7265 7365   columns represe
-00015800: 6e74 696e 6720 6665 6174 7572 6520 7661  nting feature va
-00015810: 6c75 6573 2e0a 2020 2020 2020 2020 3a70  lues..        :p
-00015820: 6172 616d 6574 6572 204c 6974 6572 616c  arameter Literal
-00015830: 2062 7563 6b65 745f 6d65 7468 6f64 3a20   bucket_method: 
-00015840: 4573 7469 6d61 746f 7220 6465 7465 726d  Estimator determ
-00015850: 696e 696e 6720 6f70 7469 6d61 6c20 6275  ining optimal bu
-00015860: 636b 6574 2063 6f75 6e74 2061 6e64 2062  cket count and b
-00015870: 7563 6b65 7420 7769 6474 682e 2044 6566  ucket width. Def
-00015880: 6175 6c74 3a20 5468 6520 6d61 7869 6d75  ault: The maximu
-00015890: 6d20 6f66 2074 6865 2053 7475 7267 6573  m of the Sturges
-000158a0: 2061 6e64 2046 7265 6564 6d61 6e2d 4469   and Freedman-Di
-000158b0: 6163 6f6e 6973 2065 7374 696d 6174 6f72  aconis estimator
-000158c0: 732e 0a20 2020 2020 2020 203a 7265 7475  s..        :retu
-000158d0: 726e 206e 702e 6e64 6172 7261 793a 2041  rn np.ndarray: A
-000158e0: 7272 6179 206f 6620 7369 7a65 2064 6174  rray of size dat
-000158f0: 612e 7368 6170 655b 305d 2072 6570 7265  a.shape[0] repre
-00015900: 7365 6e74 696e 6720 6f75 746c 6965 7220  senting outlier 
-00015910: 7363 6f72 6573 2c20 7769 7468 2068 6967  scores, with hig
-00015920: 6865 7220 7661 6c75 6573 2072 6570 7265  her values repre
-00015930: 7365 6e74 696e 6720 6772 6561 7465 7220  senting greater 
-00015940: 6f75 746c 6965 7273 2e0a 0a20 2020 2020  outliers...     
-00015950: 2020 202e 2e20 696d 6167 653a 3a20 5f73     .. image:: _s
-00015960: 7461 7469 632f 696d 672f 6862 6f73 2e70  tatic/img/hbos.p
-00015970: 6e67 0a20 2020 2020 2020 2020 2020 3a77  ng.           :w
-00015980: 6964 7468 3a20 3132 3030 0a20 2020 2020  idth: 1200.     
-00015990: 2020 2020 2020 3a61 6c69 676e 3a20 6365        :align: ce
-000159a0: 6e74 6572 0a0a 2020 2020 2020 2020 3a65  nter..        :e
-000159b0: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
-000159c0: 3e3e 3e20 7361 6d70 6c65 5f31 203d 206e  >>> sample_1 = n
-000159d0: 702e 7261 6e64 6f6d 2e72 616e 646f 6d5f  p.random.random_
-000159e0: 696e 7465 6765 7273 286c 6f77 3d31 2c20  integers(low=1, 
-000159f0: 6869 6768 3d32 2c20 7369 7a65 3d28 3130  high=2, size=(10
-00015a00: 2c20 3530 2929 2e61 7374 7970 6528 6e70  , 50)).astype(np
-00015a10: 2e66 6c6f 6174 3634 290a 2020 2020 2020  .float64).      
-00015a20: 2020 3e3e 3e20 7361 6d70 6c65 5f32 203d    >>> sample_2 =
-00015a30: 206e 702e 7261 6e64 6f6d 2e72 616e 646f   np.random.rando
-00015a40: 6d5f 696e 7465 6765 7273 286c 6f77 3d37  m_integers(low=7
-00015a50: 2c20 6869 6768 3d32 302c 2073 697a 653d  , high=20, size=
-00015a60: 2832 2c20 3530 2929 2e61 7374 7970 6528  (2, 50)).astype(
-00015a70: 6e70 2e66 6c6f 6174 3634 290a 2020 2020  np.float64).    
-00015a80: 2020 2020 3e3e 3e20 6461 7461 203d 206e      >>> data = n
-00015a90: 702e 7673 7461 636b 285b 7361 6d70 6c65  p.vstack([sample
-00015aa0: 5f31 2c20 7361 6d70 6c65 5f32 5d29 0a20  _1, sample_2]). 
-00015ab0: 2020 2020 2020 203e 3e3e 2053 7461 7469         >>> Stati
-00015ac0: 7374 6963 7328 292e 6862 6f73 2864 6174  stics().hbos(dat
-00015ad0: 613d 6461 7461 290a 2020 2020 2020 2020  a=data).        
-00015ae0: 2222 220a 0a20 2020 2020 2020 2063 6865  """..        che
-00015af0: 636b 5f76 616c 6964 5f61 7272 6179 280a  ck_valid_array(.
-00015b00: 2020 2020 2020 2020 2020 2020 6461 7461              data
-00015b10: 3d64 6174 612c 0a20 2020 2020 2020 2020  =data,.         
-00015b20: 2020 2073 6f75 7263 653d 6622 7b53 7461     source=f"{Sta
-00015b30: 7469 7374 6963 732e 5f5f 636c 6173 735f  tistics.__class_
-00015b40: 5f2e 5f5f 6e61 6d65 5f5f 7d20 6461 7461  _.__name__} data
-00015b50: 222c 0a20 2020 2020 2020 2020 2020 2061  ",.            a
-00015b60: 6363 6570 7465 645f 7369 7a65 733d 5b32  ccepted_sizes=[2
-00015b70: 5d2c 0a20 2020 2020 2020 2029 0a20 2020  ],.        ).   
-00015b80: 2020 2020 2063 6865 636b 5f73 7472 280a       check_str(.
-00015b90: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-00015ba0: 3d66 227b 5374 6174 6973 7469 6373 2e5f  =f"{Statistics._
-00015bb0: 5f63 6c61 7373 5f5f 2e5f 5f6e 616d 655f  _class__.__name_
-00015bc0: 5f7d 2062 7563 6b65 745f 6d65 7468 6f64  _} bucket_method
-00015bd0: 222c 0a20 2020 2020 2020 2020 2020 2076  ",.            v
-00015be0: 616c 7565 3d62 7563 6b65 745f 6d65 7468  alue=bucket_meth
-00015bf0: 6f64 2c0a 2020 2020 2020 2020 2020 2020  od,.            
-00015c00: 6f70 7469 6f6e 733d 4f70 7469 6f6e 732e  options=Options.
-00015c10: 4255 434b 4554 5f4d 4554 484f 4453 2e76  BUCKET_METHODS.v
-00015c20: 616c 7565 2c0a 2020 2020 2020 2020 290a  alue,.        ).
-00015c30: 2020 2020 2020 2020 6d69 6e5f 7661 6c73          min_vals
-00015c40: 2c20 6d61 785f 7661 6c73 203d 206e 702e  , max_vals = np.
-00015c50: 6d69 6e28 6461 7461 2c20 6178 6973 3d30  min(data, axis=0
-00015c60: 292c 206e 702e 6d61 7828 6461 7461 2c20  ), np.max(data, 
-00015c70: 6178 6973 3d30 290a 2020 2020 2020 2020  axis=0).        
-00015c80: 6461 7461 203d 2028 6461 7461 202d 206d  data = (data - m
-00015c90: 696e 5f76 616c 7329 202f 2028 6d61 785f  in_vals) / (max_
-00015ca0: 7661 6c73 202d 206d 696e 5f76 616c 7329  vals - min_vals)
-00015cb0: 202a 2028 3120 2d20 3029 202b 2030 0a20   * (1 - 0) + 0. 
-00015cc0: 2020 2020 2020 2068 6973 746f 6772 616d         histogram
-00015cd0: 5f65 6467 6573 203d 2074 7970 6564 2e44  _edges = typed.D
-00015ce0: 6963 742e 656d 7074 7928 0a20 2020 2020  ict.empty(.     
-00015cf0: 2020 2020 2020 206b 6579 5f74 7970 653d         key_type=
-00015d00: 7479 7065 732e 696e 7436 342c 2076 616c  types.int64, val
-00015d10: 7565 5f74 7970 653d 7479 7065 732e 666c  ue_type=types.fl
-00015d20: 6f61 7436 345b 3a5d 0a20 2020 2020 2020  oat64[:].       
-00015d30: 2029 0a20 2020 2020 2020 2068 6973 746f   ).        histo
-00015d40: 6772 616d 7320 3d20 7479 7065 642e 4469  grams = typed.Di
-00015d50: 6374 2e65 6d70 7479 286b 6579 5f74 7970  ct.empty(key_typ
-00015d60: 653d 7479 7065 732e 696e 7436 342c 2076  e=types.int64, v
-00015d70: 616c 7565 5f74 7970 653d 7479 7065 732e  alue_type=types.
-00015d80: 696e 7436 345b 3a5d 290a 2020 2020 2020  int64[:]).      
-00015d90: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
-00015da0: 2864 6174 612e 7368 6170 655b 315d 293a  (data.shape[1]):
-00015db0: 0a20 2020 2020 2020 2020 2020 2062 696e  .            bin
-00015dc0: 5f77 6964 7468 2c20 6269 6e5f 636f 756e  _width, bin_coun
-00015dd0: 7420 3d20 6275 636b 6574 5f64 6174 6128  t = bucket_data(
-00015de0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015df0: 2064 6174 613d 6461 7461 5b3a 2c20 695d   data=data[:, i]
-00015e00: 2e66 6c61 7474 656e 2829 2c20 6d65 7468  .flatten(), meth
-00015e10: 6f64 3d62 7563 6b65 745f 6d65 7468 6f64  od=bucket_method
-00015e20: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00015e30: 2020 2020 2020 2020 2020 2068 6973 746f             histo
-00015e40: 6772 616d 735b 695d 203d 2073 656c 662e  grams[i] = self.
-00015e50: 5f68 6973 745f 3164 280a 2020 2020 2020  _hist_1d(.      
-00015e60: 2020 2020 2020 2020 2020 6461 7461 3d64            data=d
-00015e70: 6174 615b 3a2c 2069 5d2e 666c 6174 7465  ata[:, i].flatte
-00015e80: 6e28 292c 0a20 2020 2020 2020 2020 2020  n(),.           
-00015e90: 2020 2020 2062 696e 5f63 6f75 6e74 3d62       bin_count=b
-00015ea0: 696e 5f63 6f75 6e74 2c0a 2020 2020 2020  in_count,.      
-00015eb0: 2020 2020 2020 2020 2020 7261 6e67 653d            range=
-00015ec0: 6e70 2e61 7272 6179 285b 302c 2069 6e74  np.array([0, int
-00015ed0: 2862 696e 5f77 6964 7468 202a 2062 696e  (bin_width * bin
-00015ee0: 5f63 6f75 6e74 295d 292c 0a20 2020 2020  _count)]),.     
-00015ef0: 2020 2020 2020 2029 2e61 7374 7970 6528         ).astype(
-00015f00: 6e70 2e69 6e74 3634 290a 2020 2020 2020  np.int64).      
-00015f10: 2020 2020 2020 6869 7374 6f67 7261 6d5f        histogram_
-00015f20: 6564 6765 735b 695d 203d 206e 702e 6172  edges[i] = np.ar
-00015f30: 616e 6765 2830 2c20 3120 2b20 6269 6e5f  ange(0, 1 + bin_
-00015f40: 7769 6474 682c 2062 696e 5f77 6964 7468  width, bin_width
-00015f50: 292e 6173 7479 7065 280a 2020 2020 2020  ).astype(.      
-00015f60: 2020 2020 2020 2020 2020 6e70 2e66 6c6f            np.flo
-00015f70: 6174 3634 0a20 2020 2020 2020 2020 2020  at64.           
-00015f80: 2029 0a20 2020 2020 2020 2072 6573 756c   ).        resul
-00015f90: 7473 203d 2073 656c 662e 5f68 626f 735f  ts = self._hbos_
-00015fa0: 636f 6d70 7574 6528 0a20 2020 2020 2020  compute(.       
-00015fb0: 2020 2020 2064 6174 613d 6461 7461 2c20       data=data, 
-00015fc0: 6869 7374 6f67 7261 6d73 3d68 6973 746f  histograms=histo
-00015fd0: 6772 616d 732c 2068 6973 746f 6772 616d  grams, histogram
-00015fe0: 5f65 6467 6573 3d68 6973 746f 6772 616d  _edges=histogram
-00015ff0: 5f65 6467 6573 0a20 2020 2020 2020 2029  _edges.        )
-00016000: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00016010: 7265 7375 6c74 732e 6173 7479 7065 286e  results.astype(n
-00016020: 702e 666c 6f61 7433 3229 0a0a 2020 2020  p.float32)..    
-00016030: 6465 6620 726f 6c6c 696e 675f 7368 6170  def rolling_shap
-00016040: 6972 6f5f 7769 6c6b 7328 0a20 2020 2020  iro_wilks(.     
-00016050: 2020 2073 656c 662c 2064 6174 613a 206e     self, data: n
-00016060: 702e 6e64 6172 7261 792c 2074 696d 655f  p.ndarray, time_
-00016070: 7769 6e64 6f77 3a20 666c 6f61 742c 2066  window: float, f
-00016080: 7073 3a20 696e 740a 2020 2020 2920 2d3e  ps: int.    ) ->
-00016090: 206e 702e 6e64 6172 7261 793a 0a20 2020   np.ndarray:.   
-000160a0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000160b0: 2043 6f6d 7075 7465 2053 6861 7069 726f   Compute Shapiro
-000160c0: 2d57 696c 6b73 206e 6f72 6d61 6c69 7479  -Wilks normality
-000160d0: 2073 7461 7469 7374 6963 7320 666f 7220   statistics for 
-000160e0: 7365 7175 656e 7469 616c 6c79 2062 696e  sequentially bin
-000160f0: 6e65 6420 7661 6c75 6573 2069 6e20 6120  ned values in a 
-00016100: 7469 6d65 2d73 6572 6965 732e 2045 2e67  time-series. E.g
-00016110: 2e2c 2063 6f6d 7075 7465 0a20 2020 2020  ., compute.     
-00016120: 2020 2074 6865 206e 6f72 6d61 6c69 7479     the normality
-00016130: 2073 7461 7469 7374 6963 7320 6f66 2060   statistics of `
-00016140: 6046 6561 7475 7265 204e 6060 2069 6e20  `Feature N`` in 
-00016150: 6561 6368 2077 696e 646f 7720 6f66 2060  each window of `
-00016160: 6074 696d 655f 7769 6e64 6f77 6060 2073  `time_window`` s
-00016170: 6563 6f6e 6473 2e0a 0a20 2020 2020 2020  econds...       
-00016180: 203a 7061 7261 6d65 7465 7220 6e64 6172   :parameter ndar
-00016190: 7261 7920 6461 7461 3a20 3144 2061 7272  ray data: 1D arr
-000161a0: 6179 206f 6620 7369 7a65 206c 656e 2866  ay of size len(f
-000161b0: 7261 6d65 7329 2072 6570 7265 7365 6e74  rames) represent
-000161c0: 696e 6720 6665 6174 7572 6520 7661 6c75  ing feature valu
-000161d0: 6573 2e0a 2020 2020 2020 2020 3a70 6172  es..        :par
-000161e0: 616d 6574 6572 2069 6e74 2074 696d 655f  ameter int time_
-000161f0: 7769 6e64 6f77 3a20 5468 6520 7369 7a65  window: The size
-00016200: 206f 6620 7468 6520 6275 636b 6574 7320   of the buckets 
-00016210: 696e 2073 6563 6f6e 6473 2e0a 2020 2020  in seconds..    
-00016220: 2020 2020 3a70 6172 616d 6574 6572 2069      :parameter i
-00016230: 6e74 2066 7073 3a20 4672 616d 652d 7261  nt fps: Frame-ra
-00016240: 7465 206f 6620 7265 636f 7264 6564 2076  te of recorded v
-00016250: 6964 656f 2e0a 2020 2020 2020 2020 3a72  ideo..        :r
-00016260: 6574 7572 6e20 6e70 2e6e 6461 7272 6179  eturn np.ndarray
-00016270: 3a20 4172 7261 7920 6f66 2073 697a 6520  : Array of size 
-00016280: 6461 7461 2e73 6861 7065 5b30 5d20 7769  data.shape[0] wi
-00016290: 7468 2053 6861 7069 726f 2d57 696c 6b73  th Shapiro-Wilks
-000162a0: 206e 6f72 6d61 6c69 7479 2073 7461 7469   normality stati
-000162b0: 7374 6963 730a 0a20 2020 2020 2020 203a  stics..        :
-000162c0: 6578 616d 706c 653a 0a20 2020 2020 2020  example:.       
-000162d0: 203e 3e3e 2064 6174 6120 3d20 6e70 2e72   >>> data = np.r
-000162e0: 616e 646f 6d2e 7261 6e64 696e 7428 6c6f  andom.randint(lo
-000162f0: 773d 302c 2068 6967 683d 3130 302c 2073  w=0, high=100, s
-00016300: 697a 653d 2832 3030 2929 2e61 7374 7970  ize=(200)).astyp
-00016310: 6528 2766 6c6f 6174 3332 2729 0a20 2020  e('float32').   
-00016320: 2020 2020 203e 3e3e 2072 6573 756c 7473       >>> results
-00016330: 203d 2073 656c 662e 726f 6c6c 696e 675f   = self.rolling_
-00016340: 7368 6170 6972 6f5f 7769 6c6b 7328 6461  shapiro_wilks(da
-00016350: 7461 3d64 6174 612c 2074 696d 655f 7769  ta=data, time_wi
-00016360: 6e64 6f77 3d31 2c20 6670 733d 3330 290a  ndow=1, fps=30).
-00016370: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
-00016380: 2020 2020 2063 6865 636b 5f76 616c 6964       check_valid
-00016390: 5f61 7272 6179 280a 2020 2020 2020 2020  _array(.        
-000163a0: 2020 2020 6461 7461 3d64 6174 612c 0a20      data=data,. 
-000163b0: 2020 2020 2020 2020 2020 2073 6f75 7263             sourc
-000163c0: 653d 6622 7b53 7461 7469 7374 6963 732e  e=f"{Statistics.
-000163d0: 5f5f 636c 6173 735f 5f2e 5f5f 6e61 6d65  __class__.__name
-000163e0: 5f5f 7d20 6461 7461 222c 0a20 2020 2020  __} data",.     
-000163f0: 2020 2020 2020 2061 6363 6570 7465 645f         accepted_
-00016400: 7369 7a65 733d 5b31 5d2c 0a20 2020 2020  sizes=[1],.     
-00016410: 2020 2029 0a20 2020 2020 2020 2063 6865     ).        che
-00016420: 636b 5f66 6c6f 6174 280a 2020 2020 2020  ck_float(.      
-00016430: 2020 2020 2020 6e61 6d65 3d66 227b 5374        name=f"{St
-00016440: 6174 6973 7469 6373 2e5f 5f63 6c61 7373  atistics.__class
-00016450: 5f5f 2e5f 5f6e 616d 655f 5f7d 2064 6174  __.__name__} dat
-00016460: 6122 2c0a 2020 2020 2020 2020 2020 2020  a",.            
-00016470: 7661 6c75 653d 7469 6d65 5f77 696e 646f  value=time_windo
-00016480: 772c 0a20 2020 2020 2020 2020 2020 206d  w,.            m
-00016490: 696e 5f76 616c 7565 3d30 2e31 2c0a 2020  in_value=0.1,.  
-000164a0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000164b0: 6368 6563 6b5f 696e 7428 0a20 2020 2020  check_int(.     
-000164c0: 2020 2020 2020 206e 616d 653d 6622 7b53         name=f"{S
-000164d0: 7461 7469 7374 6963 732e 5f5f 636c 6173  tatistics.__clas
-000164e0: 735f 5f2e 5f5f 6e61 6d65 5f5f 7d20 6461  s__.__name__} da
-000164f0: 7461 222c 2076 616c 7565 3d74 696d 655f  ta", value=time_
-00016500: 7769 6e64 6f77 2c20 6d69 6e5f 7661 6c75  window, min_valu
-00016510: 653d 310a 2020 2020 2020 2020 290a 2020  e=1.        ).  
-00016520: 2020 2020 2020 7769 6e64 6f77 5f73 697a        window_siz
-00016530: 652c 2072 6573 756c 7473 203d 2069 6e74  e, results = int
-00016540: 2874 696d 655f 7769 6e64 6f77 202a 2066  (time_window * f
-00016550: 7073 292c 206e 702e 6675 6c6c 2828 6461  ps), np.full((da
-00016560: 7461 2e73 6861 7065 5b30 5d29 2c20 2d31  ta.shape[0]), -1
-00016570: 2e30 290a 2020 2020 2020 2020 6461 7461  .0).        data
-00016580: 203d 206e 702e 7370 6c69 7428 6461 7461   = np.split(data
-00016590: 2c20 6c69 7374 2872 616e 6765 2877 696e  , list(range(win
-000165a0: 646f 775f 7369 7a65 2c20 6461 7461 2e73  dow_size, data.s
-000165b0: 6861 7065 5b30 5d2c 2077 696e 646f 775f  hape[0], window_
-000165c0: 7369 7a65 2929 290a 2020 2020 2020 2020  size))).        
-000165d0: 666f 7220 636e 742c 2069 2069 6e20 656e  for cnt, i in en
-000165e0: 756d 6572 6174 6528 7072 616e 6765 2831  umerate(prange(1
-000165f0: 2c20 6c65 6e28 6461 7461 2929 293a 0a20  , len(data))):. 
-00016600: 2020 2020 2020 2020 2020 2073 7461 7274             start
-00016610: 2c20 656e 6420 3d20 696e 7428 2863 6e74  , end = int((cnt
-00016620: 202b 2031 2920 2a20 7769 6e64 6f77 5f73   + 1) * window_s
-00016630: 697a 6529 2c20 696e 7428 0a20 2020 2020  ize), int(.     
-00016640: 2020 2020 2020 2020 2020 2028 2863 6e74             ((cnt
-00016650: 202b 2031 2920 2a20 7769 6e64 6f77 5f73   + 1) * window_s
-00016660: 697a 6529 202b 2077 696e 646f 775f 7369  ize) + window_si
-00016670: 7a65 0a20 2020 2020 2020 2020 2020 2029  ze.            )
-00016680: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-00016690: 756c 7473 5b73 7461 7274 3a65 6e64 5d20  ults[start:end] 
-000166a0: 3d20 7374 6174 732e 7368 6170 6972 6f28  = stats.shapiro(
-000166b0: 6461 7461 5b69 5d29 5b30 5d0a 2020 2020  data[i])[0].    
-000166c0: 2020 2020 7265 7475 726e 2072 6573 756c      return resul
-000166d0: 7473 0a0a 2020 2020 4073 7461 7469 636d  ts..    @staticm
-000166e0: 6574 686f 640a 2020 2020 406e 6a69 7428  ethod.    @njit(
-000166f0: 2228 666c 6f61 7433 325b 3a5d 2c20 666c  "(float32[:], fl
-00016700: 6f61 7436 345b 3a5d 2c20 696e 7436 342c  oat64[:], int64,
-00016710: 2922 290a 2020 2020 6465 6620 736c 6964  )").    def slid
-00016720: 696e 675f 7a5f 7363 6f72 6573 280a 2020  ing_z_scores(.  
-00016730: 2020 2020 2020 6461 7461 3a20 6e70 2e6e        data: np.n
-00016740: 6461 7272 6179 2c20 7469 6d65 5f77 696e  darray, time_win
-00016750: 646f 7773 3a20 6e70 2e6e 6461 7272 6179  dows: np.ndarray
-00016760: 2c20 6670 733a 2069 6e74 0a20 2020 2029  , fps: int.    )
-00016770: 202d 3e20 6e70 2e6e 6461 7272 6179 3a0a   -> np.ndarray:.
-00016780: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00016790: 2020 2020 4361 6c63 756c 6174 6520 736c      Calculate sl
-000167a0: 6964 696e 6720 5a2d 7363 6f72 6573 2066  iding Z-scores f
-000167b0: 6f72 2061 2067 6976 656e 2064 6174 6120  or a given data 
-000167c0: 6172 7261 7920 6f76 6572 2073 7065 6369  array over speci
-000167d0: 6669 6564 2074 696d 6520 7769 6e64 6f77  fied time window
-000167e0: 732e 0a0a 2020 2020 2020 2020 5468 6973  s...        This
-000167f0: 2066 756e 6374 696f 6e20 636f 6d70 7574   function comput
-00016800: 6573 2073 6c69 6469 6e67 205a 2d73 636f  es sliding Z-sco
-00016810: 7265 7320 666f 7220 6120 3144 2064 6174  res for a 1D dat
-00016820: 6120 6172 7261 7920 6f76 6572 2064 6966  a array over dif
-00016830: 6665 7265 6e74 2074 696d 6520 7769 6e64  ferent time wind
-00016840: 6f77 732e 2054 6865 2073 6c69 6469 6e67  ows. The sliding
-00016850: 205a 2d73 636f 7265 0a20 2020 2020 2020   Z-score.       
-00016860: 2069 7320 6120 6d65 6173 7572 6520 6f66   is a measure of
-00016870: 2068 6f77 206d 616e 7920 7374 616e 6461   how many standa
-00016880: 7264 2064 6576 6961 7469 6f6e 7320 6120  rd deviations a 
-00016890: 6461 7461 2070 6f69 6e74 2069 7320 6672  data point is fr
-000168a0: 6f6d 2074 6865 206d 6561 6e20 6f66 2074  om the mean of t
-000168b0: 6865 2073 7572 726f 756e 6469 6e67 2064  he surrounding d
-000168c0: 6174 6120 7769 7468 696e 0a20 2020 2020  ata within.     
-000168d0: 2020 2074 6865 2073 7065 6369 6669 6564     the specified
-000168e0: 2074 696d 6520 7769 6e64 6f77 2e20 5468   time window. Th
-000168f0: 6973 2063 616e 2062 6520 7573 6566 756c  is can be useful
-00016900: 2066 6f72 2064 6574 6563 7469 6e67 2061   for detecting a
-00016910: 6e6f 6d61 6c69 6573 206f 7220 7661 7269  nomalies or vari
-00016920: 6174 696f 6e73 2069 6e20 7469 6d65 2d73  ations in time-s
-00016930: 6572 6965 7320 6461 7461 2e0a 0a20 2020  eries data...   
-00016940: 2020 2020 203a 7061 7261 6d65 7465 7220       :parameter 
-00016950: 6e64 6172 7261 7920 6461 7461 3a20 3144  ndarray data: 1D
-00016960: 204e 756d 5079 2061 7272 6179 2063 6f6e   NumPy array con
-00016970: 7461 696e 696e 6720 7468 6520 7469 6d65  taining the time
-00016980: 2d73 6572 6965 7320 6461 7461 2e0a 2020  -series data..  
-00016990: 2020 2020 2020 3a70 6172 616d 6574 6572        :parameter
-000169a0: 206e 6461 7272 6179 2074 696d 655f 7769   ndarray time_wi
-000169b0: 6e64 6f77 733a 2031 4420 4e75 6d50 7920  ndows: 1D NumPy 
-000169c0: 6172 7261 7920 7370 6563 6966 7969 6e67  array specifying
-000169d0: 2074 6865 2074 696d 6520 7769 6e64 6f77   the time window
-000169e0: 7320 696e 2073 6563 6f6e 6473 206f 7665  s in seconds ove
-000169f0: 7220 7768 6963 6820 746f 2063 616c 6375  r which to calcu
-00016a00: 6c61 7465 2074 6865 205a 2d73 636f 7265  late the Z-score
-00016a10: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
-00016a20: 6d65 7465 7220 696e 7420 7469 6d65 5f77  meter int time_w
-00016a30: 696e 646f 7773 3a20 4672 616d 6573 2070  indows: Frames p
-00016a40: 6572 2073 6563 6f6e 642c 2075 7365 6420  er second, used 
-00016a50: 746f 2063 6f6e 7665 7274 2074 696d 6520  to convert time 
-00016a60: 7769 6e64 6f77 7320 6672 6f6d 2073 6563  windows from sec
-00016a70: 6f6e 6473 2074 6f20 7468 6520 636f 7272  onds to the corr
-00016a80: 6573 706f 6e64 696e 6720 6e75 6d62 6572  esponding number
-00016a90: 206f 6620 6461 7461 2070 6f69 6e74 732e   of data points.
-00016aa0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-00016ab0: 7320 6e70 2e6e 6461 7272 6179 3a20 4120  s np.ndarray: A 
-00016ac0: 3244 204e 756d 5079 2061 7272 6179 2063  2D NumPy array c
-00016ad0: 6f6e 7461 696e 696e 6720 7468 6520 6361  ontaining the ca
-00016ae0: 6c63 756c 6174 6564 205a 2d73 636f 7265  lculated Z-score
-00016af0: 732e 2045 6163 6820 726f 7720 636f 7272  s. Each row corr
-00016b00: 6573 706f 6e64 7320 746f 2074 6865 205a  esponds to the Z
-00016b10: 2d73 636f 7265 7320 6361 6c63 756c 6174  -scores calculat
-00016b20: 6564 2066 6f72 2061 2073 7065 6369 6669  ed for a specifi
-00016b30: 6320 7469 6d65 2077 696e 646f 772e 2054  c time window. T
-00016b40: 6865 2074 696d 6520 7769 6e64 6f77 7320  he time windows 
-00016b50: 6172 6520 7265 7072 6573 656e 7465 6420  are represented 
-00016b60: 6279 2074 6865 2063 6f6c 756d 6e73 2e0a  by the columns..
-00016b70: 0a20 2020 2020 2020 203a 6578 616d 706c  .        :exampl
-00016b80: 653a 0a20 2020 2020 2020 203e 3e3e 2064  e:.        >>> d
-00016b90: 6174 6120 3d20 6e70 2e72 616e 646f 6d2e  ata = np.random.
-00016ba0: 7261 6e64 696e 7428 302c 2031 3030 2c20  randint(0, 100, 
-00016bb0: 2831 3030 302c 2929 2e61 7374 7970 6528  (1000,)).astype(
-00016bc0: 6e70 2e66 6c6f 6174 3332 290a 2020 2020  np.float32).    
-00016bd0: 2020 2020 3e3e 3e20 7a5f 7363 6f72 6573      >>> z_scores
-00016be0: 203d 2053 7461 7469 7374 6963 7328 292e   = Statistics().
-00016bf0: 736c 6964 696e 675f 7a5f 7363 6f72 6573  sliding_z_scores
-00016c00: 2864 6174 613d 6461 7461 2c20 7469 6d65  (data=data, time
-00016c10: 5f77 696e 646f 7773 3d6e 702e 6172 7261  _windows=np.arra
-00016c20: 7928 5b31 2e30 2c20 322e 355d 292c 2066  y([1.0, 2.5]), f
-00016c30: 7073 3d31 3029 0a20 2020 2020 2020 2022  ps=10).        "
-00016c40: 2222 0a0a 2020 2020 2020 2020 7265 7375  ""..        resu
-00016c50: 6c74 7320 3d20 6e70 2e66 756c 6c28 2864  lts = np.full((d
-00016c60: 6174 612e 7368 6170 655b 305d 2c20 7469  ata.shape[0], ti
-00016c70: 6d65 5f77 696e 646f 7773 2e73 6861 7065  me_windows.shape
-00016c80: 5b30 5d29 2c20 302e 3029 0a20 2020 2020  [0]), 0.0).     
-00016c90: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
-00016ca0: 6528 7469 6d65 5f77 696e 646f 7773 2e73  e(time_windows.s
-00016cb0: 6861 7065 5b30 5d29 3a0a 2020 2020 2020  hape[0]):.      
-00016cc0: 2020 2020 2020 7769 6e64 6f77 5f73 697a        window_siz
-00016cd0: 6520 3d20 696e 7428 7469 6d65 5f77 696e  e = int(time_win
-00016ce0: 646f 7773 5b69 5d20 2a20 6670 7329 0a20  dows[i] * fps). 
-00016cf0: 2020 2020 2020 2020 2020 2066 6f72 2072             for r
-00016d00: 6967 6874 2069 6e20 7261 6e67 6528 7769  ight in range(wi
-00016d10: 6e64 6f77 5f73 697a 6520 2d20 312c 2064  ndow_size - 1, d
-00016d20: 6174 612e 7368 6170 655b 305d 293a 0a20  ata.shape[0]):. 
-00016d30: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00016d40: 6566 7420 3d20 7269 6768 7420 2d20 7769  eft = right - wi
-00016d50: 6e64 6f77 5f73 697a 6520 2b20 310a 2020  ndow_size + 1.  
-00016d60: 2020 2020 2020 2020 2020 2020 2020 7361                sa
-00016d70: 6d70 6c65 5f64 6174 6120 3d20 6461 7461  mple_data = data
-00016d80: 5b6c 6566 7420 3a20 7269 6768 7420 2b20  [left : right + 
-00016d90: 315d 0a20 2020 2020 2020 2020 2020 2020  1].             
-00016da0: 2020 206d 2c20 7320 3d20 6e70 2e6d 6561     m, s = np.mea
-00016db0: 6e28 7361 6d70 6c65 5f64 6174 6129 2c20  n(sample_data), 
-00016dc0: 6e70 2e73 7464 2873 616d 706c 655f 6461  np.std(sample_da
-00016dd0: 7461 290a 2020 2020 2020 2020 2020 2020  ta).            
-00016de0: 2020 2020 7661 6c73 203d 2028 7361 6d70      vals = (samp
-00016df0: 6c65 5f64 6174 6120 2d20 6d29 202f 2073  le_data - m) / s
-00016e00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016e10: 2072 6573 756c 7473 5b6c 6566 7420 3a20   results[left : 
-00016e20: 7269 6768 7420 2b20 312c 2069 5d20 3d20  right + 1, i] = 
-00016e30: 7661 6c73 0a20 2020 2020 2020 2072 6574  vals.        ret
-00016e40: 7572 6e20 7265 7375 6c74 730a 0a20 2020  urn results..   
-00016e50: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
-00016e60: 2020 2040 6e6a 6974 2822 2869 6e74 3634     @njit("(int64
-00016e70: 5b3a 2c20 3a5d 2c29 2229 0a20 2020 2064  [:, :],)").    d
-00016e80: 6566 2070 6869 5f63 6f65 6666 6963 6965  ef phi_coefficie
-00016e90: 6e74 2864 6174 613a 206e 702e 6e64 6172  nt(data: np.ndar
-00016ea0: 7261 7929 202d 3e20 666c 6f61 743a 0a20  ray) -> float:. 
-00016eb0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00016ec0: 2020 2043 6f6d 7075 7465 2074 6865 2070     Compute the p
-00016ed0: 6869 2063 6f65 6666 6963 6965 6e74 2066  hi coefficient f
-00016ee0: 6f72 2061 204e 7832 2061 7272 6179 206f  or a Nx2 array o
-00016ef0: 6620 6269 6e61 7279 2064 6174 612e 0a0a  f binary data...
-00016f00: 2020 2020 2020 2020 5468 6520 7068 6920          The phi 
-00016f10: 636f 6566 6669 6369 656e 7420 2861 2e6b  coefficient (a.k
-00016f20: 2e61 204d 6174 7468 6577 7320 436f 7272  .a Matthews Corr
-00016f30: 656c 6174 696f 6e20 436f 6566 6669 6369  elation Coeffici
-00016f40: 656e 7420 284d 4343 2929 2c20 6973 2061  ent (MCC)), is a
-00016f50: 206d 6561 7375 7265 206f 6620 6173 736f   measure of asso
-00016f60: 6369 6174 696f 6e20 666f 7220 6269 6e61  ciation for bina
-00016f70: 7279 2064 6174 6120 696e 2061 2032 7832  ry data in a 2x2
-00016f80: 2063 6f6e 7469 6e67 656e 6379 2074 6162   contingency tab
-00016f90: 6c65 2e20 4974 2071 7561 6e74 6966 6965  le. It quantifie
-00016fa0: 7320 7468 650a 2020 2020 2020 2020 6465  s the.        de
-00016fb0: 6772 6565 206f 6620 6173 736f 6369 6174  gree of associat
-00016fc0: 696f 6e20 6f72 2063 6f72 7265 6c61 7469  ion or correlati
-00016fd0: 6f6e 2062 6574 7765 656e 2074 776f 2062  on between two b
-00016fe0: 696e 6172 7920 7661 7269 6162 6c65 7320  inary variables 
-00016ff0: 2865 2e67 2e2c 2062 696e 6172 7920 636c  (e.g., binary cl
-00017000: 6173 7369 6669 6361 7469 6f6e 2074 6172  assification tar
-00017010: 6765 7473 292e 0a0a 2020 2020 2020 2020  gets)...        
-00017020: 5468 6520 666f 726d 756c 6120 666f 7220  The formula for 
-00017030: 7468 6520 7068 6920 636f 6566 6669 6369  the phi coeffici
-00017040: 656e 7420 6973 2064 6566 696e 6564 2061  ent is defined a
-00017050: 733a 0a0a 2020 2020 2020 2020 2e2e 206d  s:..        .. m
-00017060: 6174 683a 3a0a 2020 2020 2020 2020 2020  ath::.          
-00017070: 205c 7068 6920 3d20 5c66 7261 637b 2842   \phi = \frac{(B
-00017080: 4320 2d20 4144 297d 7b5c 7371 7274 7b28  C - AD)}{\sqrt{(
-00017090: 435f 3120 2b20 435f 3229 2852 5f31 202b  C_1 + C_2)(R_1 +
-000170a0: 2052 5f32 2928 435f 3120 2b20 525f 3129   R_2)(C_1 + R_1)
-000170b0: 2843 5f32 202b 2052 5f32 297d 7d0a 0a20  (C_2 + R_2)}}.. 
-000170c0: 2020 2020 2020 2077 6865 7265 3a0a 2020         where:.  
-000170d0: 2020 2020 2020 2d20 4243 3a20 4869 7420        - BC: Hit 
-000170e0: 7261 7465 2028 7265 706f 6e73 6520 616e  rate (reponse an
-000170f0: 6420 7472 7574 6820 6973 2062 6f74 6820  d truth is both 
-00017100: 3129 0a20 2020 2020 2020 202d 2041 443a  1).        - AD:
-00017110: 2043 6f72 7265 6374 2072 656a 6563 7469   Correct rejecti
-00017120: 6f6e 7320 2872 6573 706f 6e73 6520 616e  ons (response an
-00017130: 6420 7472 7574 6820 6172 6520 626f 7468  d truth are both
-00017140: 2030 290a 2020 2020 2020 2020 2d20 4331   0).        - C1
-00017150: 2c20 4332 3a20 436f 756e 7473 206f 6620  , C2: Counts of 
-00017160: 6f63 6375 7272 656e 6365 7320 7768 6572  occurrences wher
-00017170: 6520 7468 6520 7265 7370 6f6e 7365 2069  e the response i
-00017180: 7320 3120 616e 6420 302c 2072 6573 7065  s 1 and 0, respe
-00017190: 6374 6976 656c 792e 0a20 2020 2020 2020  ctively..       
-000171a0: 202d 2052 312c 2052 323a 2043 6f75 6e74   - R1, R2: Count
-000171b0: 7320 6f66 206f 6363 7572 7265 6e63 6573  s of occurrences
-000171c0: 2077 6865 7265 2074 6865 2074 7275 7468   where the truth
-000171d0: 2069 7320 3120 616e 6420 302c 2072 6573   is 1 and 0, res
-000171e0: 7065 6374 6976 656c 792e 0a0a 2020 2020  pectively...    
-000171f0: 2020 2020 3a70 6172 616d 206e 702e 6e64      :param np.nd
-00017200: 6172 7261 7920 6461 7461 3a20 4120 4e75  array data: A Nu
-00017210: 6d50 7920 6172 7261 7920 636f 6e74 6169  mPy array contai
-00017220: 6e69 6e67 2062 696e 6172 7920 6461 7461  ning binary data
-00017230: 206f 7267 616e 697a 6564 2069 6e20 7477   organized in tw
-00017240: 6f20 636f 6c75 6d6e 732e 2045 6163 6820  o columns. Each 
-00017250: 726f 7720 7265 7072 6573 656e 7473 2061  row represents a
-00017260: 2070 6169 7220 6f66 2062 696e 6172 7920   pair of binary 
-00017270: 7661 6c75 6573 2066 6f72 2074 776f 2076  values for two v
-00017280: 6172 6961 626c 6573 2e20 436f 6c75 6d6e  ariables. Column
-00017290: 7320 7265 7072 6573 656e 7420 7477 6f20  s represent two 
-000172a0: 6665 6174 7572 6573 206f 7220 7477 6f20  features or two 
-000172b0: 6269 6e61 7279 2063 6c61 7373 6966 6963  binary classific
-000172c0: 6174 696f 6e20 7265 7375 6c74 732e 0a20  ation results.. 
-000172d0: 2020 2020 2020 203a 7061 7261 6d20 666c         :param fl
-000172e0: 6f61 743a 2054 6865 2063 616c 6375 6c61  oat: The calcula
-000172f0: 7465 6420 7068 6920 636f 6566 6669 6369  ted phi coeffici
-00017300: 656e 742c 2061 2076 616c 7565 2062 6574  ent, a value bet
-00017310: 7765 656e 2030 2061 6e64 2031 2e20 4120  ween 0 and 1. A 
-00017320: 7661 6c75 6520 6f66 2030 2069 6e64 6963  value of 0 indic
-00017330: 6174 6573 206e 6f20 6173 736f 6369 6174  ates no associat
-00017340: 696f 6e20 6265 7477 6565 6e20 7468 6520  ion between the 
-00017350: 7661 7269 6162 6c65 732c 2077 6869 6c65  variables, while
-00017360: 2031 2069 6e64 6963 6174 6573 2061 2070   1 indicates a p
-00017370: 6572 6665 6374 2061 7373 6f63 6961 7469  erfect associati
-00017380: 6f6e 2e0a 0a20 2020 2020 2020 203a 6578  on...        :ex
-00017390: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
-000173a0: 3e3e 2064 6174 6120 3d20 6e70 2e61 7272  >> data = np.arr
-000173b0: 6179 285b 5b30 2c20 315d 2c20 5b31 2c20  ay([[0, 1], [1, 
-000173c0: 305d 2c20 5b31 2c20 305d 2c20 5b31 2c20  0], [1, 0], [1, 
-000173d0: 315d 5d29 2e61 7374 7970 6528 6e70 2e69  1]]).astype(np.i
-000173e0: 6e74 3634 290a 2020 2020 2020 2020 3e3e  nt64).        >>
-000173f0: 3e20 5374 6174 6973 7469 6373 2829 2e70  > Statistics().p
-00017400: 6869 5f63 6f65 6666 6963 6965 6e74 2864  hi_coefficient(d
-00017410: 6174 613d 6461 7461 290a 2020 2020 2020  ata=data).      
-00017420: 2020 3e3e 3e20 302e 3831 3634 3936 3538    >>> 0.81649658
-00017430: 3039 3237 3732 3631 0a20 2020 2020 2020  09277261.       
-00017440: 203e 3e3e 2064 6174 6120 3d20 6e70 2e72   >>> data = np.r
-00017450: 616e 646f 6d2e 7261 6e64 696e 7428 302c  andom.randint(0,
-00017460: 2032 2c20 2831 3030 2c20 3229 290a 2020   2, (100, 2)).  
-00017470: 2020 2020 2020 3e3e 3e20 7265 7375 6c74        >>> result
-00017480: 203d 2053 7461 7469 7374 6963 732e 7068   = Statistics.ph
-00017490: 695f 636f 6566 6669 6369 656e 7428 6461  i_coefficient(da
-000174a0: 7461 3d64 6174 6129 0a20 2020 2020 2020  ta=data).       
-000174b0: 2022 2222 0a20 2020 2020 2020 2063 6e74   """.        cnt
-000174c0: 5f30 5f30 203d 206c 656e 286e 702e 6172  _0_0 = len(np.ar
-000174d0: 6777 6865 7265 2828 6461 7461 5b3a 2c20  gwhere((data[:, 
-000174e0: 305d 203d 3d20 3029 2026 2028 6461 7461  0] == 0) & (data
-000174f0: 5b3a 2c20 315d 203d 3d20 3029 292e 666c  [:, 1] == 0)).fl
-00017500: 6174 7465 6e28 2929 0a20 2020 2020 2020  atten()).       
-00017510: 2063 6e74 5f30 5f31 203d 206c 656e 286e   cnt_0_1 = len(n
-00017520: 702e 6172 6777 6865 7265 2828 6461 7461  p.argwhere((data
-00017530: 5b3a 2c20 305d 203d 3d20 3029 2026 2028  [:, 0] == 0) & (
-00017540: 6461 7461 5b3a 2c20 315d 203d 3d20 3129  data[:, 1] == 1)
-00017550: 292e 666c 6174 7465 6e28 2929 0a20 2020  ).flatten()).   
-00017560: 2020 2020 2063 6e74 5f31 5f30 203d 206c       cnt_1_0 = l
-00017570: 656e 286e 702e 6172 6777 6865 7265 2828  en(np.argwhere((
-00017580: 6461 7461 5b3a 2c20 305d 203d 3d20 3129  data[:, 0] == 1)
-00017590: 2026 2028 6461 7461 5b3a 2c20 315d 203d   & (data[:, 1] =
-000175a0: 3d20 3029 292e 666c 6174 7465 6e28 2929  = 0)).flatten())
-000175b0: 0a20 2020 2020 2020 2063 6e74 5f31 5f31  .        cnt_1_1
-000175c0: 203d 206c 656e 286e 702e 6172 6777 6865   = len(np.argwhe
-000175d0: 7265 2828 6461 7461 5b3a 2c20 305d 203d  re((data[:, 0] =
-000175e0: 3d20 3129 2026 2028 6461 7461 5b3a 2c20  = 1) & (data[:, 
-000175f0: 315d 203d 3d20 3129 292e 666c 6174 7465  1] == 1)).flatte
-00017600: 6e28 2929 0a0a 2020 2020 2020 2020 4243  n())..        BC
-00017610: 2c20 4144 203d 2063 6e74 5f31 5f31 202a  , AD = cnt_1_1 *
-00017620: 2063 6e74 5f30 5f30 2c20 636e 745f 315f   cnt_0_0, cnt_1_
-00017630: 3020 2a20 636e 745f 305f 310a 2020 2020  0 * cnt_0_1.    
-00017640: 2020 2020 6e6f 6d69 6e61 746f 7220 3d20      nominator = 
-00017650: 4243 202d 2041 440a 2020 2020 2020 2020  BC - AD.        
-00017660: 6465 6e6f 6d69 6e61 746f 7220 3d20 6e70  denominator = np
-00017670: 2e73 7172 7428 0a20 2020 2020 2020 2020  .sqrt(.         
-00017680: 2020 2028 636e 745f 315f 3020 2b20 636e     (cnt_1_0 + cn
-00017690: 745f 315f 3129 0a20 2020 2020 2020 2020  t_1_1).         
-000176a0: 2020 202a 2028 636e 745f 305f 3020 2b20     * (cnt_0_0 + 
-000176b0: 636e 745f 305f 3129 0a20 2020 2020 2020  cnt_0_1).       
-000176c0: 2020 2020 202a 2028 636e 745f 315f 3020       * (cnt_1_0 
-000176d0: 2b20 636e 745f 305f 3029 0a20 2020 2020  + cnt_0_0).     
-000176e0: 2020 2020 2020 202a 2028 636e 745f 315f         * (cnt_1_
-000176f0: 3120 2a20 636e 745f 305f 3129 0a20 2020  1 * cnt_0_1).   
-00017700: 2020 2020 2029 0a20 2020 2020 2020 2069       ).        i
-00017710: 6620 6e6f 6d69 6e61 746f 7220 3d3d 2030  f nominator == 0
-00017720: 206f 7220 6465 6e6f 6d69 6e61 746f 7220   or denominator 
-00017730: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
-00017740: 2020 7265 7475 726e 2031 2e30 0a20 2020    return 1.0.   
-00017750: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00017760: 2020 2020 2020 2072 6574 7572 6e20 6e70         return np
-00017770: 2e61 6273 280a 2020 2020 2020 2020 2020  .abs(.          
-00017780: 2020 2020 2020 2842 4320 2d20 4144 290a        (BC - AD).
-00017790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000177a0: 2f20 6e70 2e73 7172 7428 0a20 2020 2020  / np.sqrt(.     
-000177b0: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-000177c0: 636e 745f 315f 3020 2b20 636e 745f 315f  cnt_1_0 + cnt_1_
-000177d0: 3129 0a20 2020 2020 2020 2020 2020 2020  1).             
-000177e0: 2020 2020 2020 202a 2028 636e 745f 305f         * (cnt_0_
-000177f0: 3020 2b20 636e 745f 305f 3129 0a20 2020  0 + cnt_0_1).   
-00017800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017810: 202a 2028 636e 745f 315f 3020 2b20 636e   * (cnt_1_0 + cn
-00017820: 745f 305f 3029 0a20 2020 2020 2020 2020  t_0_0).         
-00017830: 2020 2020 2020 2020 2020 202a 2028 636e             * (cn
-00017840: 745f 315f 3120 2a20 636e 745f 305f 3129  t_1_1 * cnt_0_1)
-00017850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017860: 2029 0a20 2020 2020 2020 2020 2020 2029   ).            )
-00017870: 0a0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
-00017880: 686f 640a 2020 2020 406e 6a69 7428 2228  hod.    @njit("(
-00017890: 696e 7433 325b 3a2c 203a 5d2c 2066 6c6f  int32[:, :], flo
-000178a0: 6174 3634 5b3a 5d2c 2069 6e74 3634 2922  at64[:], int64)"
-000178b0: 290a 2020 2020 6465 6620 736c 6964 696e  ).    def slidin
-000178c0: 675f 7068 695f 636f 6566 6669 6369 656e  g_phi_coefficien
-000178d0: 7428 0a20 2020 2020 2020 2064 6174 613a  t(.        data:
-000178e0: 206e 702e 6e64 6172 7261 792c 2077 696e   np.ndarray, win
-000178f0: 646f 775f 7369 7a65 733a 206e 702e 6e64  dow_sizes: np.nd
-00017900: 6172 7261 792c 2073 616d 706c 655f 7261  array, sample_ra
-00017910: 7465 3a20 696e 740a 2020 2020 2920 2d3e  te: int.    ) ->
-00017920: 206e 702e 6e64 6172 7261 793a 0a20 2020   np.ndarray:.   
-00017930: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00017940: 2043 616c 6375 6c61 7465 2073 6c69 6469   Calculate slidi
-00017950: 6e67 2070 6869 2063 6f65 6666 6963 6965  ng phi coefficie
-00017960: 6e74 7320 666f 7220 6120 3278 3220 636f  nts for a 2x2 co
-00017970: 6e74 696e 6765 6e63 7920 7461 626c 6520  ntingency table 
-00017980: 6465 7269 7665 6420 6672 6f6d 2062 696e  derived from bin
-00017990: 6172 7920 6461 7461 2e0a 0a20 2020 2020  ary data...     
-000179a0: 2020 2043 6f6d 7075 7465 7320 736c 6964     Computes slid
-000179b0: 696e 6720 7068 6920 636f 6566 6669 6369  ing phi coeffici
-000179c0: 656e 7473 2066 6f72 2061 2032 7832 2063  ents for a 2x2 c
-000179d0: 6f6e 7469 6e67 656e 6379 2074 6162 6c65  ontingency table
-000179e0: 2064 6572 6976 6564 2066 726f 6d20 6269   derived from bi
-000179f0: 6e61 7279 2064 6174 6120 6f76 6572 2064  nary data over d
-00017a00: 6966 6665 7265 6e74 0a20 2020 2020 2020  ifferent.       
-00017a10: 2074 696d 6520 7769 6e64 6f77 732e 2054   time windows. T
-00017a20: 6865 2070 6869 2063 6f65 6666 6963 6965  he phi coefficie
-00017a30: 6e74 2069 7320 6120 6d65 6173 7572 6520  nt is a measure 
-00017a40: 6f66 2061 7373 6f63 6961 7469 6f6e 2062  of association b
-00017a50: 6574 7765 656e 2074 776f 2062 696e 6172  etween two binar
-00017a60: 7920 7661 7269 6162 6c65 732c 2061 6e64  y variables, and
-00017a70: 2073 6c69 6469 6e67 2070 6869 0a20 2020   sliding phi.   
-00017a80: 2020 2020 2063 6f65 6666 6963 6965 6e74       coefficient
-00017a90: 7320 6361 6e20 7265 7665 616c 2063 6861  s can reveal cha
-00017aa0: 6e67 6573 2069 6e20 6173 736f 6369 6174  nges in associat
-00017ab0: 696f 6e20 6f76 6572 2074 696d 652e 0a0a  ion over time...
-00017ac0: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
-00017ad0: 702e 6e64 6172 7261 7920 6461 7461 3a20  p.ndarray data: 
-00017ae0: 4120 3244 204e 756d 5079 2061 7272 6179  A 2D NumPy array
-00017af0: 2063 6f6e 7461 696e 696e 6720 6269 6e61   containing bina
-00017b00: 7279 2064 6174 6120 6f72 6761 6e69 7a65  ry data organize
-00017b10: 6420 696e 2074 776f 2063 6f6c 756d 6e73  d in two columns
-00017b20: 2e20 4561 6368 2072 6f77 2072 6570 7265  . Each row repre
-00017b30: 7365 6e74 7320 6120 7061 6972 206f 6620  sents a pair of 
-00017b40: 6269 6e61 7279 2076 616c 7565 7320 666f  binary values fo
-00017b50: 7220 7477 6f20 7661 7269 6162 6c65 732e  r two variables.
-00017b60: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00017b70: 6e70 2e6e 6461 7272 6179 2077 696e 646f  np.ndarray windo
-00017b80: 775f 7369 7a65 733a 2031 4420 4e75 6d50  w_sizes: 1D NumP
-00017b90: 7920 6172 7261 7920 7370 6563 6966 7969  y array specifyi
-00017ba0: 6e67 2074 6865 2074 696d 6520 7769 6e64  ng the time wind
-00017bb0: 6f77 7320 2869 6e20 7365 636f 6e64 7329  ows (in seconds)
-00017bc0: 206f 7665 7220 7768 6963 6820 746f 2063   over which to c
-00017bd0: 616c 6375 6c61 7465 2074 6865 2073 6c69  alculate the sli
-00017be0: 6469 6e67 2070 6869 2063 6f65 6666 6963  ding phi coeffic
-00017bf0: 6965 6e74 732e 0a20 2020 2020 2020 203a  ients..        :
-00017c00: 7061 7261 6d20 696e 7420 7361 6d70 6c65  param int sample
-00017c10: 5f72 6174 653a 2054 6865 2073 616d 706c  _rate: The sampl
-00017c20: 696e 6720 7261 7465 206f 7220 7469 6d65  ing rate or time
-00017c30: 2069 6e74 6572 7661 6c20 2869 6e20 7361   interval (in sa
-00017c40: 6d70 6c65 7320 7065 7220 7365 636f 6e64  mples per second
-00017c50: 2c20 652e 672e 2c20 6670 7329 2061 7420  , e.g., fps) at 
-00017c60: 7768 6963 6820 6461 7461 2070 6f69 6e74  which data point
-00017c70: 7320 7765 7265 2063 6f6c 6c65 6374 6564  s were collected
-00017c80: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-00017c90: 6e73 206e 702e 6e64 6172 7261 793a 2041  ns np.ndarray: A
-00017ca0: 2032 4420 4e75 6d50 7920 6172 7261 7920   2D NumPy array 
-00017cb0: 636f 6e74 6169 6e69 6e67 2074 6865 2063  containing the c
-00017cc0: 616c 6375 6c61 7465 6420 736c 6964 696e  alculated slidin
-00017cd0: 6720 7068 6920 636f 6566 6669 6369 656e  g phi coefficien
-00017ce0: 7473 2e20 4561 6368 2072 6f77 2063 6f72  ts. Each row cor
-00017cf0: 7265 7370 6f6e 6473 2074 6f20 7468 6520  responds to the 
-00017d00: 7068 6920 636f 6566 6669 6369 656e 7473  phi coefficients
-00017d10: 2063 616c 6375 6c61 7465 6420 666f 7220   calculated for 
-00017d20: 6120 7370 6563 6966 6963 2074 696d 6520  a specific time 
-00017d30: 706f 696e 742c 2074 6865 2063 6f6c 756d  point, the colum
-00017d40: 6e73 2063 6f72 7265 7370 6f6e 6420 746f  ns correspond to
-00017d50: 2074 696d 652d 7769 6e64 6f77 732e 0a0a   time-windows...
-00017d60: 2020 2020 2020 2020 3a65 7861 6d70 6c65          :example
-00017d70: 3a0a 2020 2020 2020 2020 3e3e 3e20 6461  :.        >>> da
-00017d80: 7461 203d 206e 702e 7261 6e64 6f6d 2e72  ta = np.random.r
-00017d90: 616e 6469 6e74 2830 2c20 322c 2028 3230  andint(0, 2, (20
-00017da0: 302c 2032 2929 0a20 2020 2020 2020 203e  0, 2)).        >
-00017db0: 3e3e 2053 7461 7469 7374 6963 7328 292e  >> Statistics().
-00017dc0: 736c 6964 696e 675f 7068 695f 636f 6566  sliding_phi_coef
-00017dd0: 6669 6369 656e 7428 6461 7461 3d64 6174  ficient(data=dat
-00017de0: 612c 2077 696e 646f 775f 7369 7a65 733d  a, window_sizes=
-00017df0: 6e70 2e61 7272 6179 285b 312e 302c 2034  np.array([1.0, 4
-00017e00: 2e30 5d29 2c20 7361 6d70 6c65 5f72 6174  .0]), sample_rat
-00017e10: 653d 3130 290a 2020 2020 2020 2020 2222  e=10).        ""
-00017e20: 220a 0a20 2020 2020 2020 2072 6573 756c  "..        resul
-00017e30: 7473 203d 206e 702e 6675 6c6c 2828 6461  ts = np.full((da
-00017e40: 7461 2e73 6861 7065 5b30 5d2c 2077 696e  ta.shape[0], win
-00017e50: 646f 775f 7369 7a65 732e 7368 6170 655b  dow_sizes.shape[
-00017e60: 305d 292c 202d 312e 3029 0a20 2020 2020  0]), -1.0).     
-00017e70: 2020 2066 6f72 2069 2069 6e20 7072 616e     for i in pran
-00017e80: 6765 2877 696e 646f 775f 7369 7a65 732e  ge(window_sizes.
-00017e90: 7368 6170 655b 305d 293a 0a20 2020 2020  shape[0]):.     
-00017ea0: 2020 2020 2020 2077 696e 646f 775f 7369         window_si
-00017eb0: 7a65 203d 2069 6e74 2877 696e 646f 775f  ze = int(window_
-00017ec0: 7369 7a65 735b 695d 202a 2073 616d 706c  sizes[i] * sampl
-00017ed0: 655f 7261 7465 290a 2020 2020 2020 2020  e_rate).        
-00017ee0: 2020 2020 666f 7220 6c2c 2072 2069 6e20      for l, r in 
-00017ef0: 7a69 7028 0a20 2020 2020 2020 2020 2020  zip(.           
-00017f00: 2020 2020 2072 616e 6765 2830 2c20 6461       range(0, da
-00017f10: 7461 2e73 6861 7065 5b30 5d20 2b20 3129  ta.shape[0] + 1)
-00017f20: 2c20 7261 6e67 6528 7769 6e64 6f77 5f73  , range(window_s
-00017f30: 697a 652c 2064 6174 612e 7368 6170 655b  ize, data.shape[
-00017f40: 305d 202b 2031 290a 2020 2020 2020 2020  0] + 1).        
-00017f50: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
-00017f60: 2020 2020 2020 2073 616d 706c 6520 3d20         sample = 
-00017f70: 6461 7461 5b6c 3a72 2c20 3a5d 0a20 2020  data[l:r, :].   
-00017f80: 2020 2020 2020 2020 2020 2020 2063 6e74               cnt
-00017f90: 5f30 5f30 203d 206c 656e 280a 2020 2020  _0_0 = len(.    
-00017fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017fb0: 6e70 2e61 7267 7768 6572 6528 2873 616d  np.argwhere((sam
-00017fc0: 706c 655b 3a2c 2030 5d20 3d3d 2030 2920  ple[:, 0] == 0) 
-00017fd0: 2620 2873 616d 706c 655b 3a2c 2031 5d20  & (sample[:, 1] 
-00017fe0: 3d3d 2030 2929 2e66 6c61 7474 656e 2829  == 0)).flatten()
-00017ff0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018000: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-00018010: 2020 2063 6e74 5f30 5f31 203d 206c 656e     cnt_0_1 = len
-00018020: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00018030: 2020 2020 2020 6e70 2e61 7267 7768 6572        np.argwher
-00018040: 6528 2873 616d 706c 655b 3a2c 2030 5d20  e((sample[:, 0] 
-00018050: 3d3d 2030 2920 2620 2873 616d 706c 655b  == 0) & (sample[
-00018060: 3a2c 2031 5d20 3d3d 2031 2929 2e66 6c61  :, 1] == 1)).fla
-00018070: 7474 656e 2829 0a20 2020 2020 2020 2020  tten().         
-00018080: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00018090: 2020 2020 2020 2020 2063 6e74 5f31 5f30           cnt_1_0
-000180a0: 203d 206c 656e 280a 2020 2020 2020 2020   = len(.        
-000180b0: 2020 2020 2020 2020 2020 2020 6e70 2e61              np.a
-000180c0: 7267 7768 6572 6528 2873 616d 706c 655b  rgwhere((sample[
-000180d0: 3a2c 2030 5d20 3d3d 2031 2920 2620 2873  :, 0] == 1) & (s
-000180e0: 616d 706c 655b 3a2c 2031 5d20 3d3d 2030  ample[:, 1] == 0
-000180f0: 2929 2e66 6c61 7474 656e 2829 0a20 2020  )).flatten().   
-00018100: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-00018110: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00018120: 6e74 5f31 5f31 203d 206c 656e 280a 2020  nt_1_1 = len(.  
-00018130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018140: 2020 6e70 2e61 7267 7768 6572 6528 2873    np.argwhere((s
-00018150: 616d 706c 655b 3a2c 2030 5d20 3d3d 2031  ample[:, 0] == 1
-00018160: 2920 2620 2873 616d 706c 655b 3a2c 2031  ) & (sample[:, 1
-00018170: 5d20 3d3d 2031 2929 2e66 6c61 7474 656e  ] == 1)).flatten
-00018180: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
-00018190: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-000181a0: 2020 2020 2042 432c 2041 4420 3d20 636e       BC, AD = cn
-000181b0: 745f 315f 3120 2a20 636e 745f 305f 302c  t_1_1 * cnt_0_0,
-000181c0: 2063 6e74 5f31 5f30 202a 2063 6e74 5f30   cnt_1_0 * cnt_0
-000181d0: 5f31 0a20 2020 2020 2020 2020 2020 2020  _1.             
-000181e0: 2020 206e 6f6d 696e 6174 6f72 203d 2042     nominator = B
-000181f0: 4320 2d20 4144 0a20 2020 2020 2020 2020  C - AD.         
-00018200: 2020 2020 2020 2064 656e 6f6d 696e 6174         denominat
-00018210: 6f72 203d 206e 702e 7371 7274 280a 2020  or = np.sqrt(.  
-00018220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018230: 2020 2863 6e74 5f31 5f30 202b 2063 6e74    (cnt_1_0 + cnt
-00018240: 5f31 5f31 290a 2020 2020 2020 2020 2020  _1_1).          
-00018250: 2020 2020 2020 2020 2020 2a20 2863 6e74            * (cnt
-00018260: 5f30 5f30 202b 2063 6e74 5f30 5f31 290a  _0_0 + cnt_0_1).
-00018270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018280: 2020 2020 2a20 2863 6e74 5f31 5f30 202b      * (cnt_1_0 +
-00018290: 2063 6e74 5f30 5f30 290a 2020 2020 2020   cnt_0_0).      
-000182a0: 2020 2020 2020 2020 2020 2020 2020 2a20                * 
-000182b0: 2863 6e74 5f31 5f31 202a 2063 6e74 5f30  (cnt_1_1 * cnt_0
-000182c0: 5f31 290a 2020 2020 2020 2020 2020 2020  _1).            
-000182d0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-000182e0: 2020 2020 2020 6966 206e 6f6d 696e 6174        if nominat
-000182f0: 6f72 203d 3d20 3020 6f72 2064 656e 6f6d  or == 0 or denom
-00018300: 696e 6174 6f72 203d 3d20 303a 0a20 2020  inator == 0:.   
-00018310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018320: 2072 6573 756c 7473 5b72 202d 2031 2c20   results[r - 1, 
-00018330: 695d 203d 2030 2e30 0a20 2020 2020 2020  i] = 0.0.       
-00018340: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00018350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018360: 2020 2072 6573 756c 7473 5b72 202d 2031     results[r - 1
-00018370: 2c20 695d 203d 206e 702e 6162 7328 0a20  , i] = np.abs(. 
-00018380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018390: 2020 2020 2020 2028 4243 202d 2041 4429         (BC - AD)
-000183a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000183b0: 2020 2020 2020 2020 202f 206e 702e 7371           / np.sq
-000183c0: 7274 280a 2020 2020 2020 2020 2020 2020  rt(.            
-000183d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000183e0: 2863 6e74 5f31 5f30 202b 2063 6e74 5f31  (cnt_1_0 + cnt_1
-000183f0: 5f31 290a 2020 2020 2020 2020 2020 2020  _1).            
-00018400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018410: 2a20 2863 6e74 5f30 5f30 202b 2063 6e74  * (cnt_0_0 + cnt
-00018420: 5f30 5f31 290a 2020 2020 2020 2020 2020  _0_1).          
-00018430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018440: 2020 2a20 2863 6e74 5f31 5f30 202b 2063    * (cnt_1_0 + c
-00018450: 6e74 5f30 5f30 290a 2020 2020 2020 2020  nt_0_0).        
-00018460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018470: 2020 2020 2a20 2863 6e74 5f31 5f31 202a      * (cnt_1_1 *
-00018480: 2063 6e74 5f30 5f31 290a 2020 2020 2020   cnt_0_1).      
-00018490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000184a0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-000184b0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-000184c0: 2020 2072 6574 7572 6e20 7265 7375 6c74     return result
-000184d0: 732e 6173 7479 7065 286e 702e 666c 6f61  s.astype(np.floa
-000184e0: 7433 3229 0a0a 2020 2020 4073 7461 7469  t32)..    @stati
-000184f0: 636d 6574 686f 640a 2020 2020 406e 6a69  cmethod.    @nji
-00018500: 7428 2269 6e74 3634 5b3a 5d2c 2069 6e74  t("int64[:], int
-00018510: 3634 5b3a 5d2c 2229 0a20 2020 2064 6566  64[:],").    def
-00018520: 2063 6f68 656e 735f 6828 7361 6d70 6c65   cohens_h(sample
-00018530: 5f31 3a20 6e70 2e6e 6461 7272 6179 2c20  _1: np.ndarray, 
-00018540: 7361 6d70 6c65 5f32 3a20 6e70 2e6e 6461  sample_2: np.nda
-00018550: 7272 6179 2920 2d3e 2066 6c6f 6174 3a0a  rray) -> float:.
-00018560: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00018570: 2020 2020 4a69 7474 6564 2063 6f6d 7075      Jitted compu
-00018580: 7465 2043 6f68 656e 2773 2068 2065 6666  te Cohen's h eff
-00018590: 6563 7420 7369 7a65 2066 6f72 2074 776f  ect size for two
-000185a0: 2073 616d 706c 6573 206f 6620 6269 6e61   samples of bina
-000185b0: 7279 205b 302c 2031 5d20 7661 6c75 6573  ry [0, 1] values
-000185c0: 2e20 436f 6865 6e27 7320 6820 6973 2061  . Cohen's h is a
-000185d0: 206d 6561 7375 7265 206f 6620 6566 6665   measure of effe
-000185e0: 6374 2073 697a 650a 2020 2020 2020 2020  ct size.        
-000185f0: 666f 7220 636f 6d70 6172 696e 6720 7477  for comparing tw
-00018600: 6f20 696e 6465 7065 6e64 656e 7420 7361  o independent sa
-00018610: 6d70 6c65 7320 6261 7365 6420 6f6e 2074  mples based on t
-00018620: 6865 2064 6966 6665 7265 6e63 6573 2069  he differences i
-00018630: 6e20 7072 6f70 6f72 7469 6f6e 7320 6f66  n proportions of
-00018640: 2074 6865 2074 776f 2073 616d 706c 6573   the two samples
-00018650: 2e0a 0a20 2020 2020 2020 202e 2e20 6e6f  ...        .. no
-00018660: 7465 3a0a 2020 2020 2020 2020 2020 204d  te:.           M
-00018670: 6f64 6966 6965 6420 6672 6f6d 2060 4441  odified from `DA
-00018680: 4245 5354 203c 6874 7470 733a 2f2f 6769  BEST <https://gi
-00018690: 7468 7562 2e63 6f6d 2f41 4343 4c41 422f  thub.com/ACCLAB/
-000186a0: 4441 4245 5354 2d70 7974 686f 6e2f 626c  DABEST-python/bl
-000186b0: 6f62 2f66 6137 6466 3530 6432 3061 6231  ob/fa7df50d20ab1
-000186c0: 6339 6363 3638 3763 3636 6464 3862 6464  c9cc687c66dd8bdd
-000186d0: 6635 3564 3961 3964 6365 332f 6461 6265  f55d9a9dce3/dabe
-000186e0: 7374 2f5f 7374 6174 735f 746f 6f6c 732f  st/_stats_tools/
-000186f0: 6566 6673 697a 652e 7079 234c 3231 363e  effsize.py#L216>
-00018700: 605f 0a20 2020 2020 2020 2020 2020 6043  `_.           `C
-00018710: 6f68 656e 2773 2068 2077 696b 6920 3c68  ohen's h wiki <h
-00018720: 7474 7073 3a2f 2f65 6e2e 7769 6b69 7065  ttps://en.wikipe
-00018730: 6469 612e 6f72 672f 7769 6b69 2f43 6f68  dia.org/wiki/Coh
-00018740: 656e 2532 3773 5f68 3e60 5f0a 0a20 2020  en%27s_h>`_..   
-00018750: 2020 2020 202e 2e20 6d61 7468 3a3a 0a0a       .. math::..
-00018760: 2020 2020 2020 2020 2020 205c 5c74 6578             \\tex
-00018770: 747b 436f 6865 6e27 7320 687d 203d 2032  t{Cohen's h} = 2
-00018780: 205c 5c61 7263 7369 6e5c 5c6c 6566 7428   \\arcsin\\left(
-00018790: 5c5c 7371 7274 7b5c 5c66 7261 637b 5c5c  \\sqrt{\\frac{\\
-000187a0: 7375 6d7b 7361 6d70 6c65 5f31 7d7d 7b4e  sum{sample_1}}{N
-000187b0: 5f31 7d7d 5c5c 7269 6768 7429 202d 2032  _1}}\\right) - 2
-000187c0: 205c 5c61 7263 7369 6e5c 6c65 6674 285c   \\arcsin\left(\
-000187d0: 5c73 7172 747b 5c66 7261 637b 5c5c 7375  \sqrt{\frac{\\su
-000187e0: 6d7b 7361 6d70 6c65 5f32 7d7d 7b4e 5f32  m{sample_2}}{N_2
-000187f0: 7d7d 5c5c 7269 6768 7429 0a0a 2020 2020  }}\\right)..    
-00018800: 2020 2020 5768 6572 6520 4e5f 3120 616e      Where N_1 an
-00018810: 6420 4e5f 3220 6172 6520 7468 6520 7361  d N_2 are the sa
-00018820: 6d70 6c65 2073 697a 6573 206f 6620 7361  mple sizes of sa
-00018830: 6d70 6c65 5f31 2061 6e64 2073 616d 706c  mple_1 and sampl
-00018840: 655f 322c 2072 6573 7065 6374 6976 656c  e_2, respectivel
-00018850: 792e 0a0a 2020 2020 2020 2020 3a70 6172  y...        :par
-00018860: 616d 206e 702e 6e64 6172 7261 7920 7361  am np.ndarray sa
-00018870: 6d70 6c65 5f31 3a20 3144 2061 7272 6179  mple_1: 1D array
-00018880: 2077 6974 6820 6269 6e61 7279 205b 302c   with binary [0,
-00018890: 2031 5d20 7661 6c75 6573 2028 652e 672e   1] values (e.g.
-000188a0: 2c20 6669 7273 7420 636c 6173 7369 6669  , first classifi
-000188b0: 6572 2069 6e66 6572 656e 6365 2076 616c  er inference val
-000188c0: 7565 7329 2e0a 2020 2020 2020 2020 3a70  ues)..        :p
-000188d0: 6172 616d 206e 702e 6e64 6172 7261 7920  aram np.ndarray 
-000188e0: 7361 6d70 6c65 5f32 3a20 3144 2061 7272  sample_2: 1D arr
-000188f0: 6179 2077 6974 6820 6269 6e61 7279 205b  ay with binary [
-00018900: 302c 2031 5d20 7661 6c75 6573 2028 652e  0, 1] values (e.
-00018910: 672e 2c20 7365 636f 6e64 2063 6c61 7373  g., second class
-00018920: 6966 6965 7220 696e 6665 7265 6e63 6520  ifier inference 
-00018930: 7661 6c75 6573 292e 0a20 2020 2020 2020  values)..       
-00018940: 203a 7265 7475 726e 2066 6c6f 6174 3a20   :return float: 
-00018950: 436f 6865 6e27 7320 6820 6566 6665 6374  Cohen's h effect
-00018960: 2073 697a 652e 0a0a 2020 2020 2020 2020   size...        
-00018970: 3a65 7861 6d70 6c65 3a0a 2020 2020 2020  :example:.      
-00018980: 2020 3e3e 3e20 7361 6d70 6c65 5f31 203d    >>> sample_1 =
-00018990: 206e 702e 6172 7261 7928 5b31 2c20 302c   np.array([1, 0,
-000189a0: 2030 2c20 315d 290a 2020 2020 2020 2020   0, 1]).        
-000189b0: 3e3e 3e20 7361 6d70 6c65 5f32 203d 206e  >>> sample_2 = n
-000189c0: 702e 6172 7261 7928 5b31 2c20 312c 2031  p.array([1, 1, 1
-000189d0: 2c20 305d 290a 2020 2020 2020 2020 3e3e  , 0]).        >>
-000189e0: 3e20 5374 6174 6973 7469 6373 2829 2e63  > Statistics().c
-000189f0: 6f68 656e 735f 6828 7361 6d70 6c65 5f31  ohens_h(sample_1
-00018a00: 3d73 616d 706c 655f 312c 2073 616d 706c  =sample_1, sampl
-00018a10: 655f 323d 7361 6d70 6c65 5f32 290a 2020  e_2=sample_2).  
-00018a20: 2020 2020 2020 3e3e 3e20 2d30 2e35 3233        >>> -0.523
-00018a30: 3539 3837 3735 3539 3832 3938 350a 2020  5987755982985.  
-00018a40: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-00018a50: 2020 2073 616d 706c 655f 315f 7072 6f70     sample_1_prop
-00018a60: 6f72 7469 6f6e 203d 206e 702e 7375 6d28  ortion = np.sum(
-00018a70: 7361 6d70 6c65 5f31 2920 2f20 7361 6d70  sample_1) / samp
-00018a80: 6c65 5f31 2e73 6861 7065 5b30 5d0a 2020  le_1.shape[0].  
-00018a90: 2020 2020 2020 7361 6d70 6c65 5f32 5f70        sample_2_p
-00018aa0: 726f 706f 7274 696f 6e20 3d20 6e70 2e73  roportion = np.s
-00018ab0: 756d 2873 616d 706c 655f 3229 202f 2073  um(sample_2) / s
-00018ac0: 616d 706c 655f 322e 7368 6170 655b 305d  ample_2.shape[0]
-00018ad0: 0a20 2020 2020 2020 2070 6869 5f73 616d  .        phi_sam
-00018ae0: 706c 655f 3120 3d20 3220 2a20 6e70 2e61  ple_1 = 2 * np.a
-00018af0: 7263 7369 6e28 6e70 2e73 7172 7428 7361  rcsin(np.sqrt(sa
-00018b00: 6d70 6c65 5f31 5f70 726f 706f 7274 696f  mple_1_proportio
-00018b10: 6e29 290a 2020 2020 2020 2020 7068 695f  n)).        phi_
-00018b20: 7361 6d70 6c65 5f32 203d 2032 202a 206e  sample_2 = 2 * n
-00018b30: 702e 6172 6373 696e 286e 702e 7371 7274  p.arcsin(np.sqrt
-00018b40: 2873 616d 706c 655f 325f 7072 6f70 6f72  (sample_2_propor
-00018b50: 7469 6f6e 2929 0a0a 2020 2020 2020 2020  tion))..        
-00018b60: 7265 7475 726e 2070 6869 5f73 616d 706c  return phi_sampl
-00018b70: 655f 3120 2d20 7068 695f 7361 6d70 6c65  e_1 - phi_sample
-00018b80: 5f32 0a0a 2020 2020 4073 7461 7469 636d  _2..    @staticm
-00018b90: 6574 686f 640a 2020 2020 406a 6974 2822  ethod.    @jit("
-00018ba0: 2866 6c6f 6174 3332 5b3a 5d2c 2066 6c6f  (float32[:], flo
-00018bb0: 6174 3634 5b3a 5d2c 2069 6e74 3634 2c29  at64[:], int64,)
-00018bc0: 2229 0a20 2020 2064 6566 2073 6c69 6469  ").    def slidi
-00018bd0: 6e67 5f73 6b65 7728 0a20 2020 2020 2020  ng_skew(.       
-00018be0: 2064 6174 613a 206e 702e 6e64 6172 7261   data: np.ndarra
-00018bf0: 792c 2074 696d 655f 7769 6e64 6f77 733a  y, time_windows:
-00018c00: 206e 702e 6e64 6172 7261 792c 2073 616d   np.ndarray, sam
-00018c10: 706c 655f 7261 7465 3a20 696e 740a 2020  ple_rate: int.  
-00018c20: 2020 2920 2d3e 206e 702e 6e64 6172 7261    ) -> np.ndarra
-00018c30: 793a 0a20 2020 2020 2020 2022 2222 0a20  y:.        """. 
-00018c40: 2020 2020 2020 2043 6f6d 7075 7465 2074         Compute t
-00018c50: 6865 2073 6b65 776e 6573 7320 6f66 2061  he skewness of a
-00018c60: 2031 4420 6172 7261 7920 7769 7468 696e   1D array within
-00018c70: 2073 6c69 6469 6e67 2074 696d 6520 7769   sliding time wi
-00018c80: 6e64 6f77 732e 0a0a 2020 2020 2020 2020  ndows...        
-00018c90: 3a70 6172 616d 206e 702e 6e64 6172 7261  :param np.ndarra
-00018ca0: 7920 6461 7461 3a20 496e 7075 7420 6461  y data: Input da
-00018cb0: 7461 2061 7272 6179 2e0a 2020 2020 2020  ta array..      
-00018cc0: 2020 3a70 6172 616d 206e 702e 6e64 6172    :param np.ndar
-00018cd0: 7261 7920 6461 7461 3a20 3144 2061 7272  ray data: 1D arr
-00018ce0: 6179 206f 6620 7469 6d65 2077 696e 646f  ay of time windo
-00018cf0: 7720 6475 7261 7469 6f6e 7320 696e 2073  w durations in s
-00018d00: 6563 6f6e 6473 2e0a 2020 2020 2020 2020  econds..        
-00018d10: 3a70 6172 616d 206e 702e 6e64 6172 7261  :param np.ndarra
-00018d20: 7920 6461 7461 3a20 5361 6d70 6c69 6e67  y data: Sampling
-00018d30: 2072 6174 6520 6f66 2074 6865 2064 6174   rate of the dat
-00018d40: 6120 696e 2073 616d 706c 6573 2070 6572  a in samples per
-00018d50: 2073 6563 6f6e 642e 0a20 2020 2020 2020   second..       
-00018d60: 203a 7265 7475 726e 206e 702e 6e64 6172   :return np.ndar
-00018d70: 7261 793a 2032 4420 6172 7261 7920 6f66  ray: 2D array of
-00018d80: 2073 6b65 776e 6573 7360 3120 7661 6c75   skewness`1 valu
-00018d90: 6573 2077 6974 6820 726f 7773 2063 6f72  es with rows cor
-00018da0: 7265 7370 6f6e 6469 6e67 2074 6f20 6461  responding to da
-00018db0: 7461 2070 6f69 6e74 7320 616e 6420 636f  ta points and co
-00018dc0: 6c75 6d6e 7320 636f 7272 6573 706f 6e64  lumns correspond
-00018dd0: 696e 6720 746f 2074 696d 6520 7769 6e64  ing to time wind
-00018de0: 6f77 732e 0a0a 2020 2020 2020 2020 3a65  ows...        :e
-00018df0: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
-00018e00: 3e3e 3e20 6461 7461 203d 206e 702e 7261  >>> data = np.ra
-00018e10: 6e64 6f6d 2e72 616e 6469 6e74 2830 2c20  ndom.randint(0, 
-00018e20: 3130 302c 2028 3130 2c29 290a 2020 2020  100, (10,)).    
-00018e30: 2020 2020 3e3e 3e20 736b 6577 6e65 7373      >>> skewness
-00018e40: 203d 2053 7461 7469 7374 6963 7328 292e   = Statistics().
-00018e50: 736c 6964 696e 675f 736b 6577 2864 6174  sliding_skew(dat
-00018e60: 613d 6461 7461 2e61 7374 7970 6528 6e70  a=data.astype(np
-00018e70: 2e66 6c6f 6174 3332 292c 2074 696d 655f  .float32), time_
-00018e80: 7769 6e64 6f77 733d 6e70 2e61 7272 6179  windows=np.array
-00018e90: 285b 312e 302c 2032 2e30 5d29 2c20 7361  ([1.0, 2.0]), sa
-00018ea0: 6d70 6c65 5f72 6174 653d 3229 0a20 2020  mple_rate=2).   
-00018eb0: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-00018ec0: 2020 7265 7375 6c74 7320 3d20 6e70 2e66    results = np.f
-00018ed0: 756c 6c28 2864 6174 612e 7368 6170 655b  ull((data.shape[
-00018ee0: 305d 2c20 7469 6d65 5f77 696e 646f 7773  0], time_windows
-00018ef0: 2e73 6861 7065 5b30 5d29 2c20 302e 3029  .shape[0]), 0.0)
-00018f00: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
-00018f10: 6e20 7072 616e 6765 2874 696d 655f 7769  n prange(time_wi
-00018f20: 6e64 6f77 732e 7368 6170 655b 305d 293a  ndows.shape[0]):
-00018f30: 0a20 2020 2020 2020 2020 2020 2077 696e  .            win
-00018f40: 646f 775f 7369 7a65 203d 2069 6e74 2874  dow_size = int(t
-00018f50: 696d 655f 7769 6e64 6f77 735b 695d 202a  ime_windows[i] *
-00018f60: 2073 616d 706c 655f 7261 7465 290a 2020   sample_rate).  
-00018f70: 2020 2020 2020 2020 2020 666f 7220 6a20            for j 
-00018f80: 696e 2072 616e 6765 2877 696e 646f 775f  in range(window_
-00018f90: 7369 7a65 2c20 6461 7461 2e73 6861 7065  size, data.shape
-00018fa0: 5b30 5d20 2b20 3129 3a0a 2020 2020 2020  [0] + 1):.      
-00018fb0: 2020 2020 2020 2020 2020 7361 6d70 6c65            sample
-00018fc0: 203d 2064 6174 615b 6a20 2d20 7769 6e64   = data[j - wind
-00018fd0: 6f77 5f73 697a 6520 3a20 6a5d 0a20 2020  ow_size : j].   
-00018fe0: 2020 2020 2020 2020 2020 2020 206d 6561               mea
-00018ff0: 6e2c 2073 7464 203d 206e 702e 6d65 616e  n, std = np.mean
-00019000: 2873 616d 706c 6529 2c20 6e70 2e73 7464  (sample), np.std
-00019010: 2873 616d 706c 6529 0a20 2020 2020 2020  (sample).       
-00019020: 2020 2020 2020 2020 2072 6573 756c 7473           results
-00019030: 5b6a 202d 2031 5d5b 695d 203d 2028 3120  [j - 1][i] = (1 
-00019040: 2f20 7361 6d70 6c65 2e73 6861 7065 5b30  / sample.shape[0
-00019050: 5d29 202a 206e 702e 7375 6d28 0a20 2020  ]) * np.sum(.   
-00019060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019070: 2028 2864 6174 6120 2d20 6d65 616e 2920   ((data - mean) 
-00019080: 2f20 7374 6429 202a 2a20 330a 2020 2020  / std) ** 3.    
-00019090: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-000190a0: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-000190b0: 7375 6c74 730a 0a20 2020 2040 7374 6174  sults..    @stat
-000190c0: 6963 6d65 7468 6f64 0a20 2020 2040 6a69  icmethod.    @ji
-000190d0: 7428 2228 666c 6f61 7433 325b 3a5d 2c20  t("(float32[:], 
-000190e0: 666c 6f61 7436 345b 3a5d 2c20 696e 7436  float64[:], int6
-000190f0: 342c 2922 290a 2020 2020 6465 6620 736c  4,)").    def sl
-00019100: 6964 696e 675f 6b75 7274 6f73 6973 280a  iding_kurtosis(.
-00019110: 2020 2020 2020 2020 6461 7461 3a20 6e70          data: np
-00019120: 2e6e 6461 7272 6179 2c20 7469 6d65 5f77  .ndarray, time_w
-00019130: 696e 646f 7773 3a20 6e70 2e6e 6461 7272  indows: np.ndarr
-00019140: 6179 2c20 7361 6d70 6c65 5f72 6174 653a  ay, sample_rate:
-00019150: 2069 6e74 0a20 2020 2029 202d 3e20 6e70   int.    ) -> np
-00019160: 2e6e 6461 7272 6179 3a0a 2020 2020 2020  .ndarray:.      
-00019170: 2020 2222 220a 2020 2020 2020 2020 436f    """.        Co
-00019180: 6d70 7574 6520 7468 6520 6b75 7274 6f73  mpute the kurtos
-00019190: 6973 206f 6620 6120 3144 2061 7272 6179  is of a 1D array
-000191a0: 2077 6974 6869 6e20 736c 6964 696e 6720   within sliding 
-000191b0: 7469 6d65 2077 696e 646f 7773 2e0a 0a20  time windows... 
-000191c0: 2020 2020 2020 203a 7061 7261 6d20 6e70         :param np
-000191d0: 2e6e 6461 7272 6179 2064 6174 613a 2049  .ndarray data: I
-000191e0: 6e70 7574 2064 6174 6120 6172 7261 792e  nput data array.
-000191f0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00019200: 6e70 2e6e 6461 7272 6179 2074 696d 655f  np.ndarray time_
-00019210: 7769 6e64 6f77 733a 2031 4420 6172 7261  windows: 1D arra
-00019220: 7920 6f66 2074 696d 6520 7769 6e64 6f77  y of time window
-00019230: 2064 7572 6174 696f 6e73 2069 6e20 7365   durations in se
-00019240: 636f 6e64 732e 0a20 2020 2020 2020 203a  conds..        :
-00019250: 7061 7261 6d20 6e70 2e6e 6461 7272 6179  param np.ndarray
-00019260: 2073 616d 706c 655f 7261 7465 3a20 5361   sample_rate: Sa
-00019270: 6d70 6c69 6e67 2072 6174 6520 6f66 2074  mpling rate of t
-00019280: 6865 2064 6174 6120 696e 2073 616d 706c  he data in sampl
-00019290: 6573 2070 6572 2073 6563 6f6e 642e 0a20  es per second.. 
-000192a0: 2020 2020 2020 203a 7265 7475 726e 206e         :return n
-000192b0: 702e 6e64 6172 7261 793a 2032 4420 6172  p.ndarray: 2D ar
-000192c0: 7261 7920 6f66 2073 6b65 776e 6573 7360  ray of skewness`
-000192d0: 3120 7661 6c75 6573 2077 6974 6820 726f  1 values with ro
-000192e0: 7773 2063 6f72 7265 7370 6f6e 6469 6e67  ws corresponding
-000192f0: 2074 6f20 6461 7461 2070 6f69 6e74 7320   to data points 
-00019300: 616e 6420 636f 6c75 6d6e 7320 636f 7272  and columns corr
-00019310: 6573 706f 6e64 696e 6720 746f 2074 696d  esponding to tim
-00019320: 6520 7769 6e64 6f77 732e 0a0a 2020 2020  e windows...    
-00019330: 2020 2020 3a65 7861 6d70 6c65 3a0a 2020      :example:.  
-00019340: 2020 2020 2020 3e3e 3e20 6461 7461 203d        >>> data =
-00019350: 206e 702e 7261 6e64 6f6d 2e72 616e 6469   np.random.randi
-00019360: 6e74 2830 2c20 3130 302c 2028 3130 2c29  nt(0, 100, (10,)
-00019370: 290a 2020 2020 2020 2020 3e3e 3e20 6b75  ).        >>> ku
-00019380: 7274 6f73 6973 203d 2053 7461 7469 7374  rtosis = Statist
-00019390: 6963 7328 292e 736c 6964 696e 675f 6b75  ics().sliding_ku
-000193a0: 7274 6f73 6973 2864 6174 613d 6461 7461  rtosis(data=data
-000193b0: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
-000193c0: 3332 292c 2074 696d 655f 7769 6e64 6f77  32), time_window
-000193d0: 733d 6e70 2e61 7272 6179 285b 312e 302c  s=np.array([1.0,
-000193e0: 2032 2e30 5d29 2c20 7361 6d70 6c65 5f72   2.0]), sample_r
-000193f0: 6174 653d 3229 0a20 2020 2020 2020 2022  ate=2).        "
-00019400: 2222 0a20 2020 2020 2020 2072 6573 756c  "".        resul
-00019410: 7473 203d 206e 702e 6675 6c6c 2828 6461  ts = np.full((da
-00019420: 7461 2e73 6861 7065 5b30 5d2c 2074 696d  ta.shape[0], tim
-00019430: 655f 7769 6e64 6f77 732e 7368 6170 655b  e_windows.shape[
-00019440: 305d 292c 2030 2e30 290a 2020 2020 2020  0]), 0.0).      
-00019450: 2020 666f 7220 6920 696e 2070 7261 6e67    for i in prang
-00019460: 6528 7469 6d65 5f77 696e 646f 7773 2e73  e(time_windows.s
-00019470: 6861 7065 5b30 5d29 3a0a 2020 2020 2020  hape[0]):.      
-00019480: 2020 2020 2020 7769 6e64 6f77 5f73 697a        window_siz
-00019490: 6520 3d20 7469 6d65 5f77 696e 646f 7773  e = time_windows
-000194a0: 5b69 5d20 2a20 7361 6d70 6c65 5f72 6174  [i] * sample_rat
-000194b0: 650a 2020 2020 2020 2020 2020 2020 666f  e.            fo
-000194c0: 7220 6a20 696e 2072 616e 6765 2877 696e  r j in range(win
-000194d0: 646f 775f 7369 7a65 2c20 6461 7461 2e73  dow_size, data.s
-000194e0: 6861 7065 5b30 5d20 2b20 3129 3a0a 2020  hape[0] + 1):.  
-000194f0: 2020 2020 2020 2020 2020 2020 2020 7361                sa
-00019500: 6d70 6c65 203d 2064 6174 615b 6a20 2d20  mple = data[j - 
-00019510: 7769 6e64 6f77 5f73 697a 6520 3a20 6a5d  window_size : j]
-00019520: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019530: 206d 6561 6e2c 2073 7464 203d 206e 702e   mean, std = np.
-00019540: 6d65 616e 2873 616d 706c 6529 2c20 6e70  mean(sample), np
-00019550: 2e73 7464 2873 616d 706c 6529 0a20 2020  .std(sample).   
-00019560: 2020 2020 2020 2020 2020 2020 2072 6573               res
-00019570: 756c 7473 5b6a 202d 2031 5d5b 695d 203d  ults[j - 1][i] =
-00019580: 206e 702e 6d65 616e 2828 2864 6174 6120   np.mean(((data 
-00019590: 2d20 6d65 616e 2920 2f20 7374 6429 202a  - mean) / std) *
-000195a0: 2a20 3429 202d 2033 0a20 2020 2020 2020  * 4) - 3.       
-000195b0: 2072 6574 7572 6e20 7265 7375 6c74 730a   return results.
-000195c0: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
-000195d0: 6f64 0a20 2020 2040 6a69 7428 6e6f 7079  od.    @jit(nopy
-000195e0: 7468 6f6e 3d54 7275 6529 0a20 2020 2023  thon=True).    #
-000195f0: 2040 6e6a 6974 285b 2866 6c6f 6174 3332   @njit([(float32
-00019600: 5b3a 5d2c 2066 6c6f 6174 3634 2c20 696e  [:], float64, in
-00019610: 7436 342c 2062 6f6f 6c65 616e 292c 5d29  t64, boolean),])
-00019620: 0a20 2020 2064 6566 206b 6d65 616e 735f  .    def kmeans_
-00019630: 3164 280a 2020 2020 2020 2020 6461 7461  1d(.        data
-00019640: 3a20 6e70 2e6e 6461 7272 6179 2c20 6b3a  : np.ndarray, k:
-00019650: 2069 6e74 2c20 6d61 785f 6974 6572 733a   int, max_iters:
-00019660: 2069 6e74 2c20 6361 6c63 5f6d 6564 6961   int, calc_media
-00019670: 6e73 3a20 626f 6f6c 0a20 2020 2029 202d  ns: bool.    ) -
-00019680: 3e20 5475 706c 655b 6e70 2e6e 6461 7272  > Tuple[np.ndarr
-00019690: 6179 2c20 6e70 2e6e 6461 7272 6179 2c20  ay, np.ndarray, 
-000196a0: 556e 696f 6e5b 4e6f 6e65 2c20 7479 7065  Union[None, type
-000196b0: 732e 4469 6374 5479 7065 5d5d 3a0a 2020  s.DictType]]:.  
-000196c0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000196d0: 2020 5065 7266 6f72 6d20 6b2d 6d65 616e    Perform k-mean
-000196e0: 7320 636c 7573 7465 7269 6e67 206f 6e20  s clustering on 
-000196f0: 6120 312d 6469 6d65 6e73 696f 6e61 6c20  a 1-dimensional 
-00019700: 6461 7461 7365 742e 0a0a 2020 2020 2020  dataset...      
-00019710: 2020 3a70 6172 616d 6574 6572 206e 702e    :parameter np.
-00019720: 6e64 6172 7261 7920 6461 7461 3a20 3164  ndarray data: 1d
-00019730: 2061 7272 6179 2063 6f6e 7461 696e 696e   array containin
-00019740: 6720 6665 6174 7572 6520 7661 6c75 6573  g feature values
-00019750: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00019760: 6574 6572 2069 6e74 206b 3a20 4e75 6d62  eter int k: Numb
-00019770: 6572 206f 6620 636c 7573 7465 7273 2e0a  er of clusters..
-00019780: 2020 2020 2020 2020 3a70 6172 616d 6574          :paramet
-00019790: 6572 2069 6e74 206d 6178 5f69 7465 7273  er int max_iters
-000197a0: 3a20 4d61 7869 6d75 6d20 6e75 6d62 6572  : Maximum number
-000197b0: 206f 6620 6974 6572 6174 696f 6e73 2066   of iterations f
-000197c0: 6f72 2074 6865 206b 2d6d 6561 6e73 2061  or the k-means a
-000197d0: 6c67 6f72 6974 686d 2e0a 2020 2020 2020  lgorithm..      
-000197e0: 2020 3a70 6172 616d 6574 6572 2062 6f6f    :parameter boo
-000197f0: 6c20 6361 6c63 5f6d 6564 6961 6e73 3a20  l calc_medians: 
-00019800: 466c 6167 2069 6e64 6963 6174 696e 6720  Flag indicating 
-00019810: 7768 6574 6865 7220 746f 2063 616c 6375  whether to calcu
-00019820: 6c61 7465 2063 6c75 7374 6572 206d 6564  late cluster med
-00019830: 6961 6e73 2e0a 2020 2020 2020 2020 3a72  ians..        :r
-00019840: 6574 7572 6e73 2054 7570 6c65 3a20 5475  eturns Tuple: Tu
-00019850: 706c 6520 6f66 2074 6872 6565 2065 6c65  ple of three ele
-00019860: 6d65 6e74 732e 2046 696e 616c 2063 656e  ments. Final cen
-00019870: 7472 6f69 6473 206f 6620 7468 6520 636c  troids of the cl
-00019880: 7573 7465 7273 2e20 4c61 6265 6c73 2061  usters. Labels a
-00019890: 7373 6967 6e65 6420 746f 2065 6163 6820  ssigned to each 
-000198a0: 6461 7461 2070 6f69 6e74 2062 6173 6564  data point based
-000198b0: 206f 6e20 636c 7573 7465 7273 2e20 436c   on clusters. Cl
-000198c0: 7573 7465 7220 6d65 6469 616e 7320 2869  uster medians (i
-000198d0: 6620 6361 6c63 5f6d 6564 6961 6e73 2069  f calc_medians i
-000198e0: 7320 5472 7565 292c 206f 7468 6572 7769  s True), otherwi
-000198f0: 7365 204e 6f6e 652e 0a0a 2020 2020 2020  se None...      
-00019900: 2020 3a65 7861 6d70 6c65 3a0a 2020 2020    :example:.    
-00019910: 2020 2020 3e3e 3e20 6461 7461 5f31 6420      >>> data_1d 
-00019920: 3d20 6e70 2e61 7272 6179 285b 312c 2032  = np.array([1, 2
-00019930: 2c20 332c 2035 352c 2036 352c 2034 302c  , 3, 55, 65, 40,
-00019940: 2034 332c 2034 305d 292e 6173 7479 7065   43, 40]).astype
-00019950: 286e 702e 666c 6f61 7436 3429 0a20 2020  (np.float64).   
-00019960: 2020 2020 203e 3e3e 2063 656e 7472 6f69       >>> centroi
-00019970: 6473 2c20 6c61 6265 6c73 2c20 6d65 6469  ds, labels, medi
-00019980: 616e 7320 3d20 5374 6174 6973 7469 6373  ans = Statistics
-00019990: 2829 2e6b 6d65 616e 735f 3164 2864 6174  ().kmeans_1d(dat
-000199a0: 615f 3164 2c20 322c 2031 3030 302c 2054  a_1d, 2, 1000, T
-000199b0: 7275 6529 0a20 2020 2020 2020 2022 2222  rue).        """
-000199c0: 0a0a 2020 2020 2020 2020 6461 7461 203d  ..        data =
-000199d0: 206e 702e 6173 636f 6e74 6967 756f 7573   np.ascontiguous
-000199e0: 6172 7261 7928 6461 7461 290a 2020 2020  array(data).    
-000199f0: 2020 2020 5820 3d20 6461 7461 2e72 6573      X = data.res
-00019a00: 6861 7065 2828 6461 7461 2e73 6861 7065  hape((data.shape
-00019a10: 5b30 5d2c 2031 2929 0a20 2020 2020 2020  [0], 1)).       
-00019a20: 206c 6162 656c 732c 206d 6564 6961 6e73   labels, medians
-00019a30: 203d 204e 6f6e 652c 204e 6f6e 650a 2020   = None, None.  
-00019a40: 2020 2020 2020 6365 6e74 726f 6964 7320        centroids 
-00019a50: 3d20 585b 6e70 2e72 616e 646f 6d2e 6368  = X[np.random.ch
-00019a60: 6f69 6365 2864 6174 612e 7368 6170 655b  oice(data.shape[
-00019a70: 305d 2c20 6b2c 2072 6570 6c61 6365 3d46  0], k, replace=F
-00019a80: 616c 7365 295d 2e63 6f70 7928 290a 2020  alse)].copy().  
-00019a90: 2020 2020 2020 666f 7220 5f20 696e 2072        for _ in r
-00019aa0: 616e 6765 286d 6178 5f69 7465 7273 293a  ange(max_iters):
-00019ab0: 0a20 2020 2020 2020 2020 2020 206c 6162  .            lab
-00019ac0: 656c 7320 3d20 6e70 2e7a 6572 6f73 2858  els = np.zeros(X
-00019ad0: 2e73 6861 7065 5b30 5d2c 2064 7479 7065  .shape[0], dtype
-00019ae0: 3d6e 702e 696e 7436 3429 0a20 2020 2020  =np.int64).     
-00019af0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-00019b00: 7261 6e67 6528 582e 7368 6170 655b 305d  range(X.shape[0]
-00019b10: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00019b20: 2020 206d 696e 5f64 6973 7420 3d20 6e70     min_dist = np
-00019b30: 2e69 6e66 0a20 2020 2020 2020 2020 2020  .inf.           
-00019b40: 2020 2020 2066 6f72 206a 2069 6e20 7261       for j in ra
-00019b50: 6e67 6528 6b29 3a0a 2020 2020 2020 2020  nge(k):.        
-00019b60: 2020 2020 2020 2020 2020 2020 6469 7374              dist
-00019b70: 203d 206e 702e 6162 7328 585b 695d 202d   = np.abs(X[i] -
-00019b80: 2063 656e 7472 6f69 6473 5b6a 5d29 0a20   centroids[j]). 
+0000b7d0: 2064 6566 2070 6374 5f69 6e5f 746f 705f   def pct_in_top_
+0000b7e0: 6e28 783a 206e 702e 6e64 6172 7261 792c  n(x: np.ndarray,
+0000b7f0: 206e 3a20 666c 6f61 7429 202d 3e20 666c   n: float) -> fl
+0000b800: 6f61 743a 0a20 2020 2020 2020 2022 2222  oat:.        """
+0000b810: 0a20 2020 2020 2020 2043 6f6d 7075 7465  .        Compute
+0000b820: 2070 6572 6365 6e74 6167 6520 6f66 2065   percentage of e
+0000b830: 6c65 6d65 6e74 7320 696e 2074 6865 2074  lements in the t
+0000b840: 6f70 2027 6e27 2066 7265 7175 656e 6369  op 'n' frequenci
+0000b850: 6573 2069 6e20 7468 6520 696e 7075 742e  es in the input.
+0000b860: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0000b870: 2078 3a20 496e 7075 7420 6172 7261 792e   x: Input array.
+0000b880: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0000b890: 6e3a 204e 756d 6265 7220 6f66 2074 6f70  n: Number of top
+0000b8a0: 2066 7265 7175 656e 6369 6573 2e0a 2020   frequencies..  
+0000b8b0: 2020 2020 2020 3a72 6574 7572 6e3a 2050        :return: P
+0000b8c0: 6572 6365 6e74 6167 6520 6f66 2065 6c65  ercentage of ele
+0000b8d0: 6d65 6e74 7320 696e 2074 6865 2074 6f70  ments in the top
+0000b8e0: 2027 6e27 2066 7265 7175 656e 6369 6573   'n' frequencies
+0000b8f0: 2e0a 0a20 2020 2020 2020 203a 6578 616d  ...        :exam
+0000b900: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
+0000b910: 2078 203d 206e 702e 7261 6e64 6f6d 2e72   x = np.random.r
+0000b920: 616e 6469 6e74 2830 2c20 3130 2c20 2831  andint(0, 10, (1
+0000b930: 3030 2c29 290a 2020 2020 2020 2020 3e3e  00,)).        >>
+0000b940: 3e20 5374 6174 6973 7469 6373 2e70 6374  > Statistics.pct
+0000b950: 5f69 6e5f 746f 705f 6e28 783d 782c 206e  _in_top_n(x=x, n
+0000b960: 3d35 290a 2020 2020 2020 2020 2222 220a  =5).        """.
+0000b970: 0a20 2020 2020 2020 2063 6865 636b 5f76  .        check_v
+0000b980: 616c 6964 5f61 7272 6179 280a 2020 2020  alid_array(.    
+0000b990: 2020 2020 2020 2020 6461 7461 3d78 2c20          data=x, 
+0000b9a0: 6163 6365 7074 6564 5f6e 6469 6d73 3d28  accepted_ndims=(
+0000b9b0: 312c 292c 2073 6f75 7263 653d 5374 6174  1,), source=Stat
+0000b9c0: 6973 7469 6373 2e70 6374 5f69 6e5f 746f  istics.pct_in_to
+0000b9d0: 705f 6e2e 5f5f 6e61 6d65 5f5f 0a20 2020  p_n.__name__.   
+0000b9e0: 2020 2020 2029 0a20 2020 2020 2020 2063       ).        c
+0000b9f0: 6865 636b 5f69 6e74 286e 616d 653d 5374  heck_int(name=St
+0000ba00: 6174 6973 7469 6373 2e70 6374 5f69 6e5f  atistics.pct_in_
+0000ba10: 746f 705f 6e2e 5f5f 6e61 6d65 5f5f 2c20  top_n.__name__, 
+0000ba20: 7661 6c75 653d 6e2c 206d 6178 5f76 616c  value=n, max_val
+0000ba30: 7565 3d78 2e73 6861 7065 5b30 5d29 0a20  ue=x.shape[0]). 
+0000ba40: 2020 2020 2020 2063 6e74 7320 3d20 6e70         cnts = np
+0000ba50: 2e73 6f72 7428 6e70 2e75 6e69 7175 6528  .sort(np.unique(
+0000ba60: 782c 2072 6574 7572 6e5f 636f 756e 7473  x, return_counts
+0000ba70: 3d54 7275 6529 5b31 5d29 5b2d 6e3a 5d0a  =True)[1])[-n:].
+0000ba80: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+0000ba90: 702e 7375 6d28 636e 7473 2920 2f20 782e  p.sum(cnts) / x.
+0000baa0: 7368 6170 655b 305d 0a0a 2020 2020 4073  shape[0]..    @s
+0000bab0: 7461 7469 636d 6574 686f 640a 2020 2020  taticmethod.    
+0000bac0: 406e 6a69 7428 2228 666c 6f61 7436 345b  @njit("(float64[
+0000bad0: 3a5d 2c20 666c 6f61 7436 345b 3a5d 2922  :], float64[:])"
+0000bae0: 2c20 6361 6368 653d 5472 7565 290a 2020  , cache=True).  
+0000baf0: 2020 6465 6620 6d61 6e6e 5f77 6869 746e    def mann_whitn
+0000bb00: 6579 2873 616d 706c 655f 313a 206e 702e  ey(sample_1: np.
+0000bb10: 6e64 6172 7261 792c 2073 616d 706c 655f  ndarray, sample_
+0000bb20: 323a 206e 702e 6e64 6172 7261 7929 202d  2: np.ndarray) -
+0000bb30: 3e20 666c 6f61 743a 0a20 2020 2020 2020  > float:.       
+0000bb40: 2022 2222 0a20 2020 2020 2020 204a 6974   """.        Jit
+0000bb50: 7465 6420 636f 6d70 7574 6520 6f66 204d  ted compute of M
+0000bb60: 616e 6e2d 5768 6974 6e65 7920 5520 6265  ann-Whitney U be
+0000bb70: 7477 6565 6e20 7477 6f20 6469 7374 7269  tween two distri
+0000bb80: 6275 7469 6f6e 732e 0a0a 2020 2020 2020  butions...      
+0000bb90: 2020 3a70 6172 616d 6574 6572 206e 6461    :parameter nda
+0000bba0: 7272 6179 2073 616d 706c 655f 313a 2046  rray sample_1: F
+0000bbb0: 6972 7374 2031 6420 6172 7261 7920 7265  irst 1d array re
+0000bbc0: 7072 6573 656e 7469 6e67 2066 6561 7475  presenting featu
+0000bbd0: 7265 2076 616c 7565 732e 0a20 2020 2020  re values..     
+0000bbe0: 2020 203a 7061 7261 6d65 7465 7220 6e64     :parameter nd
+0000bbf0: 6172 7261 7920 7361 6d70 6c65 5f32 3a20  array sample_2: 
+0000bc00: 5365 636f 6e64 2031 6420 6172 7261 7920  Second 1d array 
+0000bc10: 7265 7072 6573 656e 7469 6e67 2066 6561  representing fea
+0000bc20: 7475 7265 2076 616c 7565 732e 0a20 2020  ture values..   
+0000bc30: 2020 2020 203a 7265 7475 726e 7320 666c       :returns fl
+0000bc40: 6f61 743a 204d 616e 6e2d 5768 6974 6e65  oat: Mann-Whitne
+0000bc50: 7920 552e 0a0a 2020 2020 2020 2020 3a72  y U...        :r
+0000bc60: 6566 6572 656e 6365 733a 0a20 2020 2020  eferences:.     
+0000bc70: 2020 2020 2020 2060 4d6f 6469 6669 6564         `Modified
+0000bc80: 2066 726f 6d20 4a61 6d65 7320 5765 6262   from James Webb
+0000bc90: 6572 2067 6973 7420 6f6e 2047 6974 4875  er gist on GitHu
+0000bca0: 6220 3c68 7474 7073 3a2f 2f67 6973 742e  b <https://gist.
+0000bcb0: 6769 7468 7562 2e63 6f6d 2f6a 616d 6573  github.com/james
+0000bcc0: 7477 6562 6265 722f 3338 6162 3236 6432  twebber/38ab26d2
+0000bcd0: 3831 6639 3766 6562 3831 3936 6233 6439  81f97feb8196b3d9
+0000bce0: 3365 6465 6562 3762 3e60 5f5f 2e0a 0a20  3edeeb7b>`__... 
+0000bcf0: 2020 2020 2020 203a 6578 616d 706c 653a         :example:
+0000bd00: 0a20 2020 2020 2020 203e 3e3e 2073 616d  .        >>> sam
+0000bd10: 706c 655f 3120 3d20 6e70 2e61 7272 6179  ple_1 = np.array
+0000bd20: 285b 312c 2031 2c20 332c 2034 2c20 355d  ([1, 1, 3, 4, 5]
+0000bd30: 290a 2020 2020 2020 2020 3e3e 3e20 7361  ).        >>> sa
+0000bd40: 6d70 6c65 5f32 203d 206e 702e 6172 7261  mple_2 = np.arra
+0000bd50: 7928 5b36 2c20 372c 2038 2c20 392c 2031  y([6, 7, 8, 9, 1
+0000bd60: 305d 290a 2020 2020 2020 2020 3e3e 3e20  0]).        >>> 
+0000bd70: 7265 7375 6c74 7320 3d20 5374 6174 6973  results = Statis
+0000bd80: 7469 6373 2829 2e6d 616e 6e5f 7768 6974  tics().mann_whit
+0000bd90: 6e65 7928 7361 6d70 6c65 5f31 3d73 616d  ney(sample_1=sam
+0000bda0: 706c 655f 312c 2073 616d 706c 655f 323d  ple_1, sample_2=
+0000bdb0: 7361 6d70 6c65 5f32 290a 2020 2020 2020  sample_2).      
+0000bdc0: 2020 2222 220a 0a20 2020 2020 2020 206e    """..        n
+0000bdd0: 312c 206e 3220 3d20 7361 6d70 6c65 5f31  1, n2 = sample_1
+0000bde0: 2e73 6861 7065 5b30 5d2c 2073 616d 706c  .shape[0], sampl
+0000bdf0: 655f 322e 7368 6170 655b 305d 0a20 2020  e_2.shape[0].   
+0000be00: 2020 2020 2072 616e 6b65 6420 3d20 6661       ranked = fa
+0000be10: 7374 5f6d 6561 6e5f 7261 6e6b 286e 702e  st_mean_rank(np.
+0000be20: 636f 6e63 6174 656e 6174 6528 2873 616d  concatenate((sam
+0000be30: 706c 655f 312c 2073 616d 706c 655f 3229  ple_1, sample_2)
+0000be40: 2929 0a20 2020 2020 2020 2075 3120 3d20  )).        u1 = 
+0000be50: 6e31 202a 206e 3220 2b20 286e 3120 2a20  n1 * n2 + (n1 * 
+0000be60: 286e 3120 2b20 3129 2920 2f20 322e 3020  (n1 + 1)) / 2.0 
+0000be70: 2d20 6e70 2e73 756d 2872 616e 6b65 645b  - np.sum(ranked[
+0000be80: 3a6e 315d 2c20 6178 6973 3d30 290a 2020  :n1], axis=0).  
+0000be90: 2020 2020 2020 7532 203d 206e 3120 2a20        u2 = n1 * 
+0000bea0: 6e32 202d 2075 310a 2020 2020 2020 2020  n2 - u1.        
+0000beb0: 7265 7475 726e 206d 696e 2875 312c 2075  return min(u1, u
+0000bec0: 3229 0a0a 2020 2020 4073 7461 7469 636d  2)..    @staticm
+0000bed0: 6574 686f 640a 2020 2020 406a 6974 286e  ethod.    @jit(n
+0000bee0: 6f70 7974 686f 6e3d 5472 7565 2c20 6361  opython=True, ca
+0000bef0: 6368 653d 5472 7565 290a 2020 2020 6465  che=True).    de
+0000bf00: 6620 6c65 7665 6e65 7328 0a20 2020 2020  f levenes(.     
+0000bf10: 2020 2073 616d 706c 655f 313a 206e 702e     sample_1: np.
+0000bf20: 6e64 6172 7261 792c 0a20 2020 2020 2020  ndarray,.       
+0000bf30: 2073 616d 706c 655f 323a 206e 702e 6e64   sample_2: np.nd
+0000bf40: 6172 7261 792c 0a20 2020 2020 2020 2063  array,.        c
+0000bf50: 7269 7469 6361 6c5f 7661 6c75 6573 3a20  ritical_values: 
+0000bf60: 4f70 7469 6f6e 616c 5b6e 702e 6e64 6172  Optional[np.ndar
+0000bf70: 7261 795d 203d 204e 6f6e 652c 0a20 2020  ray] = None,.   
+0000bf80: 2029 202d 3e20 2866 6c6f 6174 2c20 556e   ) -> (float, Un
+0000bf90: 696f 6e5b 626f 6f6c 2c20 4e6f 6e65 5d29  ion[bool, None])
+0000bfa0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0000bfb0: 2020 2020 2020 4a69 7474 6564 2063 6f6d        Jitted com
+0000bfc0: 7075 7465 206f 6620 7477 6f2d 7361 6d70  pute of two-samp
+0000bfd0: 6c65 204c 6576 656e 2773 2057 2e0a 0a20  le Leven's W... 
+0000bfe0: 2020 2020 2020 203a 7061 7261 6d65 7465         :paramete
+0000bff0: 7220 6e64 6172 7261 7920 7361 6d70 6c65  r ndarray sample
+0000c000: 5f31 3a20 4669 7273 7420 3164 2061 7272  _1: First 1d arr
+0000c010: 6179 2072 6570 7265 7365 6e74 696e 6720  ay representing 
+0000c020: 6665 6174 7572 6520 7661 6c75 6573 2e0a  feature values..
+0000c030: 2020 2020 2020 2020 3a70 6172 616d 6574          :paramet
+0000c040: 6572 206e 6461 7272 6179 2073 616d 706c  er ndarray sampl
+0000c050: 655f 323a 2053 6563 6f6e 6420 3164 2061  e_2: Second 1d a
+0000c060: 7272 6179 2072 6570 7265 7365 6e74 696e  rray representin
+0000c070: 6720 6665 6174 7572 6520 7661 6c75 6573  g feature values
+0000c080: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0000c090: 6574 6572 206e 6461 7272 6179 2063 7269  eter ndarray cri
+0000c0a0: 7469 6361 6c5f 7661 6c75 6573 3a20 3244  tical_values: 2D
+0000c0b0: 2061 7272 6179 2077 6974 6820 7768 6572   array with wher
+0000c0c0: 6520 6669 7273 7420 636f 6c75 6d6e 2072  e first column r
+0000c0d0: 6570 7265 7365 6e74 2064 666e 2066 6972  epresent dfn fir
+0000c0e0: 7374 2072 6f77 2064 6664 2077 6974 6820  st row dfd with 
+0000c0f0: 7661 6c75 6573 2072 6570 7265 7365 6e74  values represent
+0000c100: 2063 7269 7469 6361 6c20 7661 6c75 6573   critical values
+0000c110: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000c120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c130: 2020 2020 2020 2020 2020 2020 2020 4361                Ca
+0000c140: 6e20 6265 2066 6f75 6e64 2069 6e20 6060  n be found in ``
+0000c150: 7369 6d62 612e 6173 7365 7473 2e63 7269  simba.assets.cri
+0000c160: 7469 6361 6c5f 7661 6c75 6573 5f30 352e  tical_values_05.
+0000c170: 7069 636b 6c65 6060 0a0a 2020 2020 2020  pickle``..      
+0000c180: 2020 3a72 6574 7572 6e73 2066 6c6f 6174    :returns float
+0000c190: 3a20 4c65 7665 6e27 7320 572e 0a0a 2020  : Leven's W...  
+0000c1a0: 2020 2020 2020 3a65 7861 6d70 6c65 733a        :examples:
+0000c1b0: 0a20 2020 2020 2020 203e 3e3e 2073 616d  .        >>> sam
+0000c1c0: 706c 655f 3120 3d20 6e70 2e61 7272 6179  ple_1 = np.array
+0000c1d0: 286c 6973 7428 7261 6e67 6528 302c 2035  (list(range(0, 5
+0000c1e0: 3029 2929 0a20 2020 2020 2020 203e 3e3e  0))).        >>>
+0000c1f0: 2073 616d 706c 655f 3220 3d20 6e70 2e61   sample_2 = np.a
+0000c200: 7272 6179 286c 6973 7428 7261 6e67 6528  rray(list(range(
+0000c210: 3235 2c20 3130 3029 2929 0a20 2020 2020  25, 100))).     
+0000c220: 2020 203e 3e3e 2053 7461 7469 7374 6963     >>> Statistic
+0000c230: 7328 292e 6c65 7665 6e65 7328 7361 6d70  s().levenes(samp
+0000c240: 6c65 5f31 3d73 616d 706c 655f 312c 2073  le_1=sample_1, s
+0000c250: 616d 706c 655f 323d 7361 6d70 6c65 5f32  ample_2=sample_2
+0000c260: 290a 2020 2020 2020 2020 3e3e 3e20 3132  ).        >>> 12
+0000c270: 2e36 3339 3039 3130 3839 3033 3235 340a  .63909108903254.
+0000c280: 2020 2020 2020 2020 3e3e 3e20 6372 6974          >>> crit
+0000c290: 6963 616c 5f76 616c 7565 7320 3d20 7069  ical_values = pi
+0000c2a0: 636b 6c65 2e6c 6f61 6428 6f70 656e 2822  ckle.load(open("
+0000c2b0: 7369 6d62 612f 6173 7365 7473 2f6c 6f6f  simba/assets/loo
+0000c2c0: 6b75 7073 2f63 7269 7469 6361 6c5f 7661  kups/critical_va
+0000c2d0: 6c75 6573 5f35 2e70 6963 6b6c 6522 2c22  lues_5.pickle","
+0000c2e0: 7262 2229 295b 2766 275d 5b27 6f6e 655f  rb"))['f']['one_
+0000c2f0: 7461 696c 275d 2e76 616c 7565 730a 2020  tail'].values.  
+0000c300: 2020 2020 2020 3e3e 3e20 5374 6174 6973        >>> Statis
+0000c310: 7469 6373 2829 2e6c 6576 656e 6573 2873  tics().levenes(s
+0000c320: 616d 706c 655f 313d 7361 6d70 6c65 5f31  ample_1=sample_1
+0000c330: 2c20 7361 6d70 6c65 5f32 3d73 616d 706c  , sample_2=sampl
+0000c340: 655f 322c 2063 7269 7469 6361 6c5f 7661  e_2, critical_va
+0000c350: 6c75 6573 3d63 7269 7469 6361 6c5f 7661  lues=critical_va
+0000c360: 6c75 6573 290a 2020 2020 2020 2020 3e3e  lues).        >>
+0000c370: 3e20 2831 322e 3633 3930 3931 3038 3930  > (12.6390910890
+0000c380: 3332 3534 2c20 5472 7565 290a 2020 2020  3254, True).    
+0000c390: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+0000c3a0: 2073 6967 6e69 6669 6361 6e63 655f 626f   significance_bo
+0000c3b0: 6f6c 203d 204e 6f6e 650a 2020 2020 2020  ol = None.      
+0000c3c0: 2020 4e69 5f78 2c20 4e69 5f79 203d 206c    Ni_x, Ni_y = l
+0000c3d0: 656e 2873 616d 706c 655f 3129 2c20 6c65  en(sample_1), le
+0000c3e0: 6e28 7361 6d70 6c65 5f32 290a 2020 2020  n(sample_2).    
+0000c3f0: 2020 2020 5963 695f 782c 2059 6369 5f79      Yci_x, Yci_y
+0000c400: 203d 206e 702e 6d65 6469 616e 2873 616d   = np.median(sam
+0000c410: 706c 655f 3129 2c20 6e70 2e6d 6564 6961  ple_1), np.media
+0000c420: 6e28 7361 6d70 6c65 5f32 290a 2020 2020  n(sample_2).    
+0000c430: 2020 2020 4e74 6f74 203d 204e 695f 7820      Ntot = Ni_x 
+0000c440: 2b20 4e69 5f79 0a20 2020 2020 2020 205a  + Ni_y.        Z
+0000c450: 696a 5f78 2c20 5a69 6a5f 7920 3d20 6e70  ij_x, Zij_y = np
+0000c460: 2e61 6273 2873 616d 706c 655f 3120 2d20  .abs(sample_1 - 
+0000c470: 5963 695f 7829 2e61 7374 7970 6528 6e70  Yci_x).astype(np
+0000c480: 2e66 6c6f 6174 3332 292c 206e 702e 6162  .float32), np.ab
+0000c490: 7328 0a20 2020 2020 2020 2020 2020 2073  s(.            s
+0000c4a0: 616d 706c 655f 3220 2d20 5963 695f 790a  ample_2 - Yci_y.
+0000c4b0: 2020 2020 2020 2020 292e 6173 7479 7065          ).astype
+0000c4c0: 286e 702e 666c 6f61 7433 3229 0a20 2020  (np.float32).   
+0000c4d0: 2020 2020 205a 6261 7269 5f78 2c20 5a62       Zbari_x, Zb
+0000c4e0: 6172 695f 7920 3d20 6e70 2e6d 6561 6e28  ari_y = np.mean(
+0000c4f0: 5a69 6a5f 7829 2c20 6e70 2e6d 6561 6e28  Zij_x), np.mean(
+0000c500: 5a69 6a5f 7929 0a20 2020 2020 2020 205a  Zij_y).        Z
+0000c510: 6261 7220 3d20 2828 5a62 6172 695f 7820  bar = ((Zbari_x 
+0000c520: 2a20 4e69 5f78 2920 2b20 285a 6261 7269  * Ni_x) + (Zbari
+0000c530: 5f79 202a 204e 695f 7929 2920 2f20 4e74  _y * Ni_y)) / Nt
+0000c540: 6f74 0a20 2020 2020 2020 206e 756d 6572  ot.        numer
+0000c550: 203d 2028 4e74 6f74 202d 2032 2920 2a20   = (Ntot - 2) * 
+0000c560: 6e70 2e73 756d 280a 2020 2020 2020 2020  np.sum(.        
+0000c570: 2020 2020 6e70 2e61 7272 6179 285b 4e69      np.array([Ni
+0000c580: 5f78 2c20 4e69 5f79 5d29 202a 2028 6e70  _x, Ni_y]) * (np
+0000c590: 2e61 7272 6179 285b 5a62 6172 695f 782c  .array([Zbari_x,
+0000c5a0: 205a 6261 7269 5f79 5d29 202d 205a 6261   Zbari_y]) - Zba
+0000c5b0: 7229 202a 2a20 320a 2020 2020 2020 2020  r) ** 2.        
+0000c5c0: 290a 2020 2020 2020 2020 6476 6172 203d  ).        dvar =
+0000c5d0: 206e 702e 7375 6d28 285a 696a 5f78 202d   np.sum((Zij_x -
+0000c5e0: 205a 6261 7269 5f78 2920 2a2a 2032 2920   Zbari_x) ** 2) 
+0000c5f0: 2b20 6e70 2e73 756d 2828 5a69 6a5f 7920  + np.sum((Zij_y 
+0000c600: 2d20 5a62 6172 695f 7929 202a 2a20 3229  - Zbari_y) ** 2)
+0000c610: 0a20 2020 2020 2020 2064 656e 6f6d 203d  .        denom =
+0000c620: 2028 3220 2d20 312e 3029 202a 2064 7661   (2 - 1.0) * dva
+0000c630: 720a 2020 2020 2020 2020 6c5f 7374 6174  r.        l_stat
+0000c640: 6973 7469 6320 3d20 6e75 6d65 7220 2f20  istic = numer / 
+0000c650: 6465 6e6f 6d0a 0a20 2020 2020 2020 2069  denom..        i
+0000c660: 6620 6372 6974 6963 616c 5f76 616c 7565  f critical_value
+0000c670: 7320 6973 206e 6f74 204e 6f6e 653a 0a20  s is not None:. 
+0000c680: 2020 2020 2020 2020 2020 2064 666e 2c20             dfn, 
+0000c690: 6466 6420 3d20 312c 2028 4e69 5f78 202b  dfd = 1, (Ni_x +
+0000c6a0: 204e 695f 7929 202d 2032 0a20 2020 2020   Ni_y) - 2.     
+0000c6b0: 2020 2020 2020 2069 6478 203d 2028 6e70         idx = (np
+0000c6c0: 2e61 6273 2863 7269 7469 6361 6c5f 7661  .abs(critical_va
+0000c6d0: 6c75 6573 5b30 5d5b 313a 5d20 2d20 6466  lues[0][1:] - df
+0000c6e0: 6429 292e 6172 676d 696e 2829 202b 2031  d)).argmin() + 1
+0000c6f0: 0a20 2020 2020 2020 2020 2020 2063 7269  .            cri
+0000c700: 7469 6361 6c5f 7661 6c75 6573 203d 2063  tical_values = c
+0000c710: 7269 7469 6361 6c5f 7661 6c75 6573 5b31  ritical_values[1
+0000c720: 3a2c 206e 702e 6172 7261 7928 5b30 2c20  :, np.array([0, 
+0000c730: 6964 785d 295d 0a20 2020 2020 2020 2020  idx])].         
+0000c740: 2020 2063 7269 7469 6361 6c5f 7661 6c75     critical_valu
+0000c750: 6520 3d20 6e70 2e69 6e74 6572 7028 0a20  e = np.interp(. 
+0000c760: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0000c770: 6664 2c20 6372 6974 6963 616c 5f76 616c  fd, critical_val
+0000c780: 7565 735b 3a2c 2030 5d2c 2063 7269 7469  ues[:, 0], criti
+0000c790: 6361 6c5f 7661 6c75 6573 5b3a 2c20 315d  cal_values[:, 1]
+0000c7a0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0000c7b0: 2020 2020 2020 2020 2020 2069 6620 6c5f             if l_
+0000c7c0: 7374 6174 6973 7469 6320 3e3d 2063 7269  statistic >= cri
+0000c7d0: 7469 6361 6c5f 7661 6c75 653a 0a20 2020  tical_value:.   
+0000c7e0: 2020 2020 2020 2020 2020 2020 2073 6967               sig
+0000c7f0: 6e69 6669 6361 6e63 655f 626f 6f6c 203d  nificance_bool =
+0000c800: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
+0000c810: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0000c820: 2020 2020 2020 2020 7369 676e 6966 6963          signific
+0000c830: 616e 6365 5f62 6f6f 6c20 3d20 4661 6c73  ance_bool = Fals
+0000c840: 650a 0a20 2020 2020 2020 2072 6574 7572  e..        retur
+0000c850: 6e20 286c 5f73 7461 7469 7374 6963 2c20  n (l_statistic, 
+0000c860: 7369 676e 6966 6963 616e 6365 5f62 6f6f  significance_boo
+0000c870: 6c29 0a0a 2020 2020 4073 7461 7469 636d  l)..    @staticm
+0000c880: 6574 686f 640a 2020 2020 406e 6a69 7428  ethod.    @njit(
+0000c890: 2228 666c 6f61 7436 345b 3a5d 2c20 666c  "(float64[:], fl
+0000c8a0: 6f61 7436 345b 3a5d 2c20 666c 6f61 7436  oat64[:], float6
+0000c8b0: 3429 222c 2063 6163 6865 3d54 7275 6529  4)", cache=True)
+0000c8c0: 0a20 2020 2064 6566 2072 6f6c 6c69 6e67  .    def rolling
+0000c8d0: 5f6c 6576 656e 6573 280a 2020 2020 2020  _levenes(.      
+0000c8e0: 2020 6461 7461 3a20 6e70 2e6e 6461 7272    data: np.ndarr
+0000c8f0: 6179 2c20 7469 6d65 5f77 696e 646f 7773  ay, time_windows
+0000c900: 3a20 6e70 2e6e 6461 7272 6179 2c20 6670  : np.ndarray, fp
+0000c910: 733a 2066 6c6f 6174 0a20 2020 2029 202d  s: float.    ) -
+0000c920: 3e20 666c 6f61 743a 0a20 2020 2020 2020  > float:.       
+0000c930: 2022 2222 0a20 2020 2020 2020 204a 6974   """.        Jit
+0000c940: 7465 6420 636f 6d70 7574 6520 6f66 2072  ted compute of r
+0000c950: 6f6c 6c69 6e67 204c 6576 656e 6527 7320  olling Levene's 
+0000c960: 5720 636f 6d70 6172 696e 6720 7468 6520  W comparing the 
+0000c970: 6375 7272 656e 7420 7469 6d65 2d77 696e  current time-win
+0000c980: 646f 7720 6f66 2073 697a 6520 4e20 746f  dow of size N to
+0000c990: 2074 6865 2070 7265 6365 6469 6e67 2077   the preceding w
+0000c9a0: 696e 646f 7720 6f66 2073 697a 6520 4e2e  indow of size N.
+0000c9b0: 0a0a 2020 2020 2020 2020 2e2e 206e 6f74  ..        .. not
+0000c9c0: 653a 3a0a 2020 2020 2020 2020 2020 2046  e::.           F
+0000c9d0: 6972 7374 2074 696d 6520 6269 6e20 2877  irst time bin (w
+0000c9e0: 6865 7265 2068 6173 206e 6f20 7072 6563  here has no prec
+0000c9f0: 6564 696e 6720 7469 6d65 2062 696e 2920  eding time bin) 
+0000ca00: 7769 6c6c 2068 6176 6520 6669 6c6c 2076  will have fill v
+0000ca10: 616c 7565 2060 6030 6060 0a0a 2020 2020  alue ``0``..    
+0000ca20: 2020 2020 3a70 6172 616d 6574 6572 206e      :parameter n
+0000ca30: 6461 7272 6179 2073 616d 706c 655f 313a  darray sample_1:
+0000ca40: 2046 6972 7374 2031 6420 6172 7261 7920   First 1d array 
+0000ca50: 7265 7072 6573 656e 7469 6e67 2066 6561  representing fea
+0000ca60: 7475 7265 2076 616c 7565 732e 0a20 2020  ture values..   
+0000ca70: 2020 2020 203a 7061 7261 6d65 7465 7220       :parameter 
+0000ca80: 6e64 6172 7261 7920 7361 6d70 6c65 5f32  ndarray sample_2
+0000ca90: 3a20 5365 636f 6e64 2031 6420 6172 7261  : Second 1d arra
+0000caa0: 7920 7265 7072 6573 656e 7469 6e67 2066  y representing f
+0000cab0: 6561 7475 7265 2076 616c 7565 732e 0a20  eature values.. 
+0000cac0: 2020 2020 2020 203a 7265 7475 726e 7320         :returns 
+0000cad0: 6e70 2e6e 6461 7272 6179 3a20 4c65 7665  np.ndarray: Leve
+0000cae0: 6e65 2773 2057 2064 6174 6120 6f66 2073  ne's W data of s
+0000caf0: 697a 6520 6c65 6e28 6461 7461 2920 7820  ize len(data) x 
+0000cb00: 6c65 6e28 7469 6d65 5f77 696e 646f 7773  len(time_windows
+0000cb10: 292e 0a0a 2020 2020 2020 2020 3a65 7861  )...        :exa
+0000cb20: 6d70 6c65 3a0a 2020 2020 2020 2020 3e3e  mple:.        >>
+0000cb30: 3e20 6461 7461 203d 206e 702e 7261 6e64  > data = np.rand
+0000cb40: 6f6d 2e72 616e 6469 6e74 2830 2c20 3530  om.randint(0, 50
+0000cb50: 2c20 2831 3030 2929 2e61 7374 7970 6528  , (100)).astype(
+0000cb60: 6e70 2e66 6c6f 6174 3634 290a 2020 2020  np.float64).    
+0000cb70: 2020 2020 3e3e 3e20 5374 6174 6973 7469      >>> Statisti
+0000cb80: 6373 2829 2e72 6f6c 6c69 6e67 5f6c 6576  cs().rolling_lev
+0000cb90: 656e 6573 2864 6174 613d 6461 7461 2c20  enes(data=data, 
+0000cba0: 7469 6d65 5f77 696e 646f 7773 3d6e 702e  time_windows=np.
+0000cbb0: 6172 7261 7928 5b31 5d29 2e61 7374 7970  array([1]).astyp
+0000cbc0: 6528 6e70 2e66 6c6f 6174 3634 292c 2066  e(np.float64), f
+0000cbd0: 7073 3d35 2e30 290a 2020 2020 2020 2020  ps=5.0).        
+0000cbe0: 2222 220a 0a20 2020 2020 2020 2072 6573  """..        res
+0000cbf0: 756c 7473 203d 206e 702e 6675 6c6c 2828  ults = np.full((
+0000cc00: 6461 7461 2e73 6861 7065 5b30 5d2c 2074  data.shape[0], t
+0000cc10: 696d 655f 7769 6e64 6f77 732e 7368 6170  ime_windows.shap
+0000cc20: 655b 305d 292c 2030 2e30 290a 2020 2020  e[0]), 0.0).    
+0000cc30: 2020 2020 666f 7220 6920 696e 2070 7261      for i in pra
+0000cc40: 6e67 6528 7469 6d65 5f77 696e 646f 7773  nge(time_windows
+0000cc50: 2e73 6861 7065 5b30 5d29 3a0a 2020 2020  .shape[0]):.    
+0000cc60: 2020 2020 2020 2020 7769 6e64 6f77 5f73          window_s
+0000cc70: 697a 6520 3d20 696e 7428 7469 6d65 5f77  ize = int(time_w
+0000cc80: 696e 646f 7773 5b69 5d20 2a20 6670 7329  indows[i] * fps)
+0000cc90: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
+0000cca0: 615f 7370 6c69 7420 3d20 6e70 2e73 706c  a_split = np.spl
+0000ccb0: 6974 280a 2020 2020 2020 2020 2020 2020  it(.            
+0000ccc0: 2020 2020 6461 7461 2c20 6c69 7374 2872      data, list(r
+0000ccd0: 616e 6765 2877 696e 646f 775f 7369 7a65  ange(window_size
+0000cce0: 2c20 6461 7461 2e73 6861 7065 5b30 5d2c  , data.shape[0],
+0000ccf0: 2077 696e 646f 775f 7369 7a65 2929 0a20   window_size)). 
+0000cd00: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0000cd10: 2020 2020 2020 2020 2066 6f72 206a 2069           for j i
+0000cd20: 6e20 7072 616e 6765 2831 2c20 6c65 6e28  n prange(1, len(
+0000cd30: 6461 7461 5f73 706c 6974 2929 3a0a 2020  data_split)):.  
+0000cd40: 2020 2020 2020 2020 2020 2020 2020 7769                wi
+0000cd50: 6e64 6f77 5f73 7461 7274 203d 2069 6e74  ndow_start = int
+0000cd60: 2877 696e 646f 775f 7369 7a65 202a 206a  (window_size * j
+0000cd70: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0000cd80: 2020 7769 6e64 6f77 5f65 6e64 203d 2069    window_end = i
+0000cd90: 6e74 2877 696e 646f 775f 7374 6172 7420  nt(window_start 
+0000cda0: 2b20 7769 6e64 6f77 5f73 697a 6529 0a20  + window_size). 
+0000cdb0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000cdc0: 616d 706c 655f 312c 2073 616d 706c 655f  ample_1, sample_
+0000cdd0: 3220 3d20 6461 7461 5f73 706c 6974 5b6a  2 = data_split[j
+0000cde0: 202d 2031 5d2e 6173 7479 7065 286e 702e   - 1].astype(np.
+0000cdf0: 666c 6f61 7433 3229 2c20 6461 7461 5f73  float32), data_s
+0000ce00: 706c 6974 5b0a 2020 2020 2020 2020 2020  plit[.          
+0000ce10: 2020 2020 2020 2020 2020 6a0a 2020 2020            j.    
+0000ce20: 2020 2020 2020 2020 2020 2020 5d2e 6173              ].as
+0000ce30: 7479 7065 286e 702e 666c 6f61 7433 3229  type(np.float32)
+0000ce40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ce50: 204e 695f 782c 204e 695f 7920 3d20 6c65   Ni_x, Ni_y = le
+0000ce60: 6e28 7361 6d70 6c65 5f31 292c 206c 656e  n(sample_1), len
+0000ce70: 2873 616d 706c 655f 3229 0a20 2020 2020  (sample_2).     
+0000ce80: 2020 2020 2020 2020 2020 2059 6369 5f78             Yci_x
+0000ce90: 2c20 5963 695f 7920 3d20 6e70 2e6d 6564  , Yci_y = np.med
+0000cea0: 6961 6e28 7361 6d70 6c65 5f31 292c 206e  ian(sample_1), n
+0000ceb0: 702e 6d65 6469 616e 2873 616d 706c 655f  p.median(sample_
+0000cec0: 3229 0a20 2020 2020 2020 2020 2020 2020  2).             
+0000ced0: 2020 204e 746f 7420 3d20 4e69 5f78 202b     Ntot = Ni_x +
+0000cee0: 204e 695f 790a 2020 2020 2020 2020 2020   Ni_y.          
+0000cef0: 2020 2020 2020 5a69 6a5f 782c 205a 696a        Zij_x, Zij
+0000cf00: 5f79 203d 206e 702e 6162 7328 7361 6d70  _y = np.abs(samp
+0000cf10: 6c65 5f31 202d 2059 6369 5f78 292e 6173  le_1 - Yci_x).as
+0000cf20: 7479 7065 286e 702e 666c 6f61 7433 3229  type(np.float32)
+0000cf30: 2c20 6e70 2e61 6273 280a 2020 2020 2020  , np.abs(.      
+0000cf40: 2020 2020 2020 2020 2020 2020 2020 7361                sa
+0000cf50: 6d70 6c65 5f32 202d 2059 6369 5f79 0a20  mple_2 - Yci_y. 
+0000cf60: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0000cf70: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
+0000cf80: 3332 290a 2020 2020 2020 2020 2020 2020  32).            
+0000cf90: 2020 2020 5a62 6172 695f 782c 205a 6261      Zbari_x, Zba
+0000cfa0: 7269 5f79 203d 206e 702e 6d65 616e 285a  ri_y = np.mean(Z
+0000cfb0: 696a 5f78 292c 206e 702e 6d65 616e 285a  ij_x), np.mean(Z
+0000cfc0: 696a 5f79 290a 2020 2020 2020 2020 2020  ij_y).          
+0000cfd0: 2020 2020 2020 5a62 6172 203d 2028 285a        Zbar = ((Z
+0000cfe0: 6261 7269 5f78 202a 204e 695f 7829 202b  bari_x * Ni_x) +
+0000cff0: 2028 5a62 6172 695f 7920 2a20 4e69 5f79   (Zbari_y * Ni_y
+0000d000: 2929 202f 204e 746f 740a 2020 2020 2020  )) / Ntot.      
+0000d010: 2020 2020 2020 2020 2020 6e75 6d65 7220            numer 
+0000d020: 3d20 284e 746f 7420 2d20 3229 202a 206e  = (Ntot - 2) * n
+0000d030: 702e 7375 6d28 0a20 2020 2020 2020 2020  p.sum(.         
+0000d040: 2020 2020 2020 2020 2020 206e 702e 6172             np.ar
+0000d050: 7261 7928 5b4e 695f 782c 204e 695f 795d  ray([Ni_x, Ni_y]
+0000d060: 2920 2a20 286e 702e 6172 7261 7928 5b5a  ) * (np.array([Z
+0000d070: 6261 7269 5f78 2c20 5a62 6172 695f 795d  bari_x, Zbari_y]
+0000d080: 2920 2d20 5a62 6172 2920 2a2a 2032 0a20  ) - Zbar) ** 2. 
+0000d090: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0000d0a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d0b0: 2064 7661 7220 3d20 6e70 2e73 756d 2828   dvar = np.sum((
+0000d0c0: 5a69 6a5f 7820 2d20 5a62 6172 695f 7829  Zij_x - Zbari_x)
+0000d0d0: 202a 2a20 3229 202b 206e 702e 7375 6d28   ** 2) + np.sum(
+0000d0e0: 285a 696a 5f79 202d 205a 6261 7269 5f79  (Zij_y - Zbari_y
+0000d0f0: 2920 2a2a 2032 290a 2020 2020 2020 2020  ) ** 2).        
+0000d100: 2020 2020 2020 2020 6465 6e6f 6d20 3d20          denom = 
+0000d110: 2832 202d 2031 2e30 2920 2a20 6476 6172  (2 - 1.0) * dvar
+0000d120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d130: 2077 203d 206e 756d 6572 202f 2064 656e   w = numer / den
+0000d140: 6f6d 0a20 2020 2020 2020 2020 2020 2020  om.             
+0000d150: 2020 2072 6573 756c 7473 5b77 696e 646f     results[windo
+0000d160: 775f 7374 6172 743a 7769 6e64 6f77 5f65  w_start:window_e
+0000d170: 6e64 2c20 695d 203d 2077 0a20 2020 2020  nd, i] = w.     
+0000d180: 2020 2072 6574 7572 6e20 7265 7375 6c74     return result
+0000d190: 730a 0a20 2020 2040 7374 6174 6963 6d65  s..    @staticme
+0000d1a0: 7468 6f64 0a20 2020 2040 6a69 7428 6e6f  thod.    @jit(no
+0000d1b0: 7079 7468 6f6e 3d54 7275 652c 2063 6163  python=True, cac
+0000d1c0: 6865 3d54 7275 6529 0a20 2020 2064 6566  he=True).    def
+0000d1d0: 2062 7275 6e6e 6572 5f6d 756e 7a65 6c28   brunner_munzel(
+0000d1e0: 7361 6d70 6c65 5f31 3a20 6e70 2e6e 6461  sample_1: np.nda
+0000d1f0: 7272 6179 2c20 7361 6d70 6c65 5f32 3a20  rray, sample_2: 
+0000d200: 6e70 2e6e 6461 7272 6179 2920 2d3e 2066  np.ndarray) -> f
+0000d210: 6c6f 6174 3a0a 2020 2020 2020 2020 2222  loat:.        ""
+0000d220: 220a 2020 2020 2020 2020 4a69 7474 6564  ".        Jitted
+0000d230: 2063 6f6d 7075 7465 206f 6620 4272 756e   compute of Brun
+0000d240: 6e65 722d 4d75 6e7a 656c 2057 2062 6574  ner-Munzel W bet
+0000d250: 7765 656e 2074 776f 2064 6973 7472 6962  ween two distrib
+0000d260: 7574 696f 6e73 2e0a 0a20 2020 2020 2020  utions...       
+0000d270: 203a 7061 7261 6d65 7465 7220 6e64 6172   :parameter ndar
+0000d280: 7261 7920 7361 6d70 6c65 5f31 3a20 4669  ray sample_1: Fi
+0000d290: 7273 7420 3164 2061 7272 6179 2072 6570  rst 1d array rep
+0000d2a0: 7265 7365 6e74 696e 6720 6665 6174 7572  resenting featur
+0000d2b0: 6520 7661 6c75 6573 2e0a 2020 2020 2020  e values..      
+0000d2c0: 2020 3a70 6172 616d 6574 6572 206e 6461    :parameter nda
+0000d2d0: 7272 6179 2073 616d 706c 655f 323a 2053  rray sample_2: S
+0000d2e0: 6563 6f6e 6420 3164 2061 7272 6179 2072  econd 1d array r
+0000d2f0: 6570 7265 7365 6e74 696e 6720 6665 6174  epresenting feat
+0000d300: 7572 6520 7661 6c75 6573 2e0a 2020 2020  ure values..    
+0000d310: 2020 2020 3a72 6574 7572 6e73 2066 6c6f      :returns flo
+0000d320: 6174 3a20 4272 756e 6e65 722d 4d75 6e7a  at: Brunner-Munz
+0000d330: 656c 2057 2e0a 0a20 2020 2020 2020 202e  el W...        .
+0000d340: 2e20 6e6f 7465 3a3a 0a20 2020 2020 2020  . note::.       
+0000d350: 2020 2020 4d6f 6469 6669 6564 2066 726f      Modified fro
+0000d360: 6d20 6060 7363 6970 792e 7374 6174 732e  m ``scipy.stats.
+0000d370: 6272 756e 6e65 726d 756e 7a65 6c60 602e  brunnermunzel``.
+0000d380: 0a0a 2020 2020 2020 2020 3a65 7861 6d70  ..        :examp
+0000d390: 6c65 3a0a 2020 2020 2020 2020 3e3e 3e20  le:.        >>> 
+0000d3a0: 7361 6d70 6c65 5f31 2c20 7361 6d70 6c65  sample_1, sample
+0000d3b0: 5f32 203d 206e 702e 7261 6e64 6f6d 2e6e  _2 = np.random.n
+0000d3c0: 6f72 6d61 6c28 6c6f 633d 3130 2c20 7363  ormal(loc=10, sc
+0000d3d0: 616c 653d 322c 2073 697a 653d 3130 292c  ale=2, size=10),
+0000d3e0: 206e 702e 7261 6e64 6f6d 2e6e 6f72 6d61   np.random.norma
+0000d3f0: 6c28 6c6f 633d 3230 2c20 7363 616c 653d  l(loc=20, scale=
+0000d400: 322c 2073 697a 653d 3130 290a 2020 2020  2, size=10).    
+0000d410: 2020 2020 3e3e 3e20 5374 6174 6973 7469      >>> Statisti
+0000d420: 6373 2829 2e62 7275 6e6e 6572 5f6d 756e  cs().brunner_mun
+0000d430: 7a65 6c28 7361 6d70 6c65 5f31 3d73 616d  zel(sample_1=sam
+0000d440: 706c 655f 312c 2073 616d 706c 655f 323d  ple_1, sample_2=
+0000d450: 7361 6d70 6c65 5f32 290a 2020 2020 2020  sample_2).      
+0000d460: 2020 3e3e 3e20 302e 3537 3531 3430 3831    >>> 0.57514081
+0000d470: 3631 3433 3731 3635 0a20 2020 2020 2020  61437165.       
+0000d480: 2022 2222 0a20 2020 2020 2020 206e 782c   """.        nx,
+0000d490: 206e 7920 3d20 6c65 6e28 7361 6d70 6c65   ny = len(sample
+0000d4a0: 5f31 292c 206c 656e 2873 616d 706c 655f  _1), len(sample_
+0000d4b0: 3229 0a20 2020 2020 2020 2072 616e 6b63  2).        rankc
+0000d4c0: 203d 2066 6173 745f 6d65 616e 5f72 616e   = fast_mean_ran
+0000d4d0: 6b28 6e70 2e63 6f6e 6361 7465 6e61 7465  k(np.concatenate
+0000d4e0: 2828 7361 6d70 6c65 5f31 2c20 7361 6d70  ((sample_1, samp
+0000d4f0: 6c65 5f32 2929 290a 2020 2020 2020 2020  le_2))).        
+0000d500: 7261 6e6b 6378 2c20 7261 6e6b 6379 203d  rankcx, rankcy =
+0000d510: 2072 616e 6b63 5b30 3a6e 785d 2c20 7261   rankc[0:nx], ra
+0000d520: 6e6b 635b 6e78 203a 206e 7820 2b20 6e79  nkc[nx : nx + ny
+0000d530: 5d0a 2020 2020 2020 2020 7261 6e6b 6378  ].        rankcx
+0000d540: 5f6d 6561 6e2c 2072 616e 6b63 795f 6d65  _mean, rankcy_me
+0000d550: 616e 203d 206e 702e 6d65 616e 2872 616e  an = np.mean(ran
+0000d560: 6b63 7829 2c20 6e70 2e6d 6561 6e28 7261  kcx), np.mean(ra
+0000d570: 6e6b 6379 290a 2020 2020 2020 2020 7261  nkcy).        ra
+0000d580: 6e6b 782c 2072 616e 6b79 203d 2066 6173  nkx, ranky = fas
+0000d590: 745f 6d65 616e 5f72 616e 6b28 7361 6d70  t_mean_rank(samp
+0000d5a0: 6c65 5f31 292c 2066 6173 745f 6d65 616e  le_1), fast_mean
+0000d5b0: 5f72 616e 6b28 7361 6d70 6c65 5f32 290a  _rank(sample_2).
+0000d5c0: 2020 2020 2020 2020 7261 6e6b 785f 6d65          rankx_me
+0000d5d0: 616e 2c20 7261 6e6b 795f 6d65 616e 203d  an, ranky_mean =
+0000d5e0: 206e 702e 6d65 616e 2872 616e 6b78 292c   np.mean(rankx),
+0000d5f0: 206e 702e 6d65 616e 2872 616e 6b79 290a   np.mean(ranky).
+0000d600: 2020 2020 2020 2020 5378 203d 206e 702e          Sx = np.
+0000d610: 7375 6d28 6e70 2e70 6f77 6572 2872 616e  sum(np.power(ran
+0000d620: 6b63 7820 2d20 7261 6e6b 7820 2d20 7261  kcx - rankx - ra
+0000d630: 6e6b 6378 5f6d 6561 6e20 2b20 7261 6e6b  nkcx_mean + rank
+0000d640: 785f 6d65 616e 2c20 322e 3029 2920 2f20  x_mean, 2.0)) / 
+0000d650: 6e78 202d 2031 0a20 2020 2020 2020 2053  nx - 1.        S
+0000d660: 7920 3d20 6e70 2e73 756d 286e 702e 706f  y = np.sum(np.po
+0000d670: 7765 7228 7261 6e6b 6379 202d 2072 616e  wer(rankcy - ran
+0000d680: 6b79 202d 2072 616e 6b63 795f 6d65 616e  ky - rankcy_mean
+0000d690: 202b 2072 616e 6b79 5f6d 6561 6e2c 2032   + ranky_mean, 2
+0000d6a0: 2e30 2929 202f 206e 7920 2d20 310a 2020  .0)) / ny - 1.  
+0000d6b0: 2020 2020 2020 7762 666e 203d 206e 7820        wbfn = nx 
+0000d6c0: 2a20 6e79 202a 2028 7261 6e6b 6379 5f6d  * ny * (rankcy_m
+0000d6d0: 6561 6e20 2d20 7261 6e6b 6378 5f6d 6561  ean - rankcx_mea
+0000d6e0: 6e29 0a20 2020 2020 2020 2077 6266 6e20  n).        wbfn 
+0000d6f0: 2f3d 2028 6e78 202b 206e 7929 202a 206e  /= (nx + ny) * n
+0000d700: 702e 7371 7274 286e 7820 2a20 5378 202b  p.sqrt(nx * Sx +
+0000d710: 206e 7920 2a20 5379 290a 2020 2020 2020   ny * Sy).      
+0000d720: 2020 7265 7475 726e 202d 7762 666e 0a0a    return -wbfn..
+0000d730: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
+0000d740: 640a 2020 2020 406e 6a69 7428 2228 666c  d.    @njit("(fl
+0000d750: 6f61 7433 325b 3a5d 2c20 666c 6f61 7436  oat32[:], float6
+0000d760: 345b 3a5d 2c20 666c 6f61 7436 3429 222c  4[:], float64)",
+0000d770: 2063 6163 6865 3d54 7275 6529 0a20 2020   cache=True).   
+0000d780: 2064 6566 2072 6f6c 6c69 6e67 5f62 6172   def rolling_bar
+0000d790: 6c65 7474 735f 7465 7374 280a 2020 2020  letts_test(.    
+0000d7a0: 2020 2020 6461 7461 3a20 6e70 2e6e 6461      data: np.nda
+0000d7b0: 7272 6179 2c20 7469 6d65 5f77 696e 646f  rray, time_windo
+0000d7c0: 7773 3a20 6e70 2e6e 6461 7272 6179 2c20  ws: np.ndarray, 
+0000d7d0: 6670 733a 2066 6c6f 6174 0a20 2020 2029  fps: float.    )
+0000d7e0: 202d 3e20 666c 6f61 743a 0a0a 2020 2020   -> float:..    
+0000d7f0: 2020 2020 7265 7375 6c74 7320 3d20 6e70      results = np
+0000d800: 2e66 756c 6c28 2864 6174 612e 7368 6170  .full((data.shap
+0000d810: 655b 305d 2c20 7469 6d65 5f77 696e 646f  e[0], time_windo
+0000d820: 7773 2e73 6861 7065 5b30 5d29 2c20 302e  ws.shape[0]), 0.
+0000d830: 3029 0a20 2020 2020 2020 2066 6f72 2069  0).        for i
+0000d840: 2069 6e20 7072 616e 6765 2874 696d 655f   in prange(time_
+0000d850: 7769 6e64 6f77 732e 7368 6170 655b 305d  windows.shape[0]
+0000d860: 293a 0a20 2020 2020 2020 2020 2020 2077  ):.            w
+0000d870: 696e 646f 775f 7369 7a65 203d 2069 6e74  indow_size = int
+0000d880: 2874 696d 655f 7769 6e64 6f77 735b 695d  (time_windows[i]
+0000d890: 202a 2066 7073 290a 2020 2020 2020 2020   * fps).        
+0000d8a0: 2020 2020 6461 7461 5f73 706c 6974 203d      data_split =
+0000d8b0: 206e 702e 7370 6c69 7428 0a20 2020 2020   np.split(.     
+0000d8c0: 2020 2020 2020 2020 2020 2064 6174 612c             data,
+0000d8d0: 206c 6973 7428 7261 6e67 6528 7769 6e64   list(range(wind
+0000d8e0: 6f77 5f73 697a 652c 2064 6174 612e 7368  ow_size, data.sh
+0000d8f0: 6170 655b 305d 2c20 7769 6e64 6f77 5f73  ape[0], window_s
+0000d900: 697a 6529 290a 2020 2020 2020 2020 2020  ize)).          
+0000d910: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0000d920: 666f 7220 6a20 696e 2070 7261 6e67 6528  for j in prange(
+0000d930: 312c 206c 656e 2864 6174 615f 7370 6c69  1, len(data_spli
+0000d940: 7429 293a 0a20 2020 2020 2020 2020 2020  t)):.           
+0000d950: 2020 2020 2077 696e 646f 775f 7374 6172       window_star
+0000d960: 7420 3d20 696e 7428 7769 6e64 6f77 5f73  t = int(window_s
+0000d970: 697a 6520 2a20 6a29 0a20 2020 2020 2020  ize * j).       
+0000d980: 2020 2020 2020 2020 2077 696e 646f 775f           window_
+0000d990: 656e 6420 3d20 696e 7428 7769 6e64 6f77  end = int(window
+0000d9a0: 5f73 7461 7274 202b 2077 696e 646f 775f  _start + window_
+0000d9b0: 7369 7a65 290a 2020 2020 2020 2020 2020  size).          
+0000d9c0: 2020 2020 2020 7361 6d70 6c65 5f31 2c20        sample_1, 
+0000d9d0: 7361 6d70 6c65 5f32 203d 2064 6174 615f  sample_2 = data_
+0000d9e0: 7370 6c69 745b 6a20 2d20 315d 2e61 7374  split[j - 1].ast
+0000d9f0: 7970 6528 6e70 2e66 6c6f 6174 3332 292c  ype(np.float32),
+0000da00: 2064 6174 615f 7370 6c69 745b 0a20 2020   data_split[.   
+0000da10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000da20: 206a 0a20 2020 2020 2020 2020 2020 2020   j.             
+0000da30: 2020 205d 2e61 7374 7970 6528 6e70 2e66     ].astype(np.f
+0000da40: 6c6f 6174 3332 290a 2020 2020 2020 2020  loat32).        
+0000da50: 2020 2020 2020 2020 6e5f 3120 3d20 6c65          n_1 = le
+0000da60: 6e28 7361 6d70 6c65 5f31 290a 2020 2020  n(sample_1).    
+0000da70: 2020 2020 2020 2020 2020 2020 6e5f 3220              n_2 
+0000da80: 3d20 6c65 6e28 7361 6d70 6c65 5f32 290a  = len(sample_2).
+0000da90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000daa0: 4e20 3d20 6e5f 3120 2b20 6e5f 320a 2020  N = n_1 + n_2.  
+0000dab0: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+0000dac0: 616e 5f76 6172 6961 6e63 655f 3120 3d20  an_variance_1 = 
+0000dad0: 6e70 2e73 756d 2828 7361 6d70 6c65 5f31  np.sum((sample_1
+0000dae0: 202d 206e 702e 6d65 616e 2873 616d 706c   - np.mean(sampl
+0000daf0: 655f 3129 2920 2a2a 2032 2920 2f20 280a  e_1)) ** 2) / (.
+0000db00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000db10: 2020 2020 6e5f 3120 2d20 310a 2020 2020      n_1 - 1.    
+0000db20: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0000db30: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+0000db40: 616e 5f76 6172 6961 6e63 655f 3220 3d20  an_variance_2 = 
+0000db50: 6e70 2e73 756d 2828 7361 6d70 6c65 5f32  np.sum((sample_2
+0000db60: 202d 206e 702e 6d65 616e 2873 616d 706c   - np.mean(sampl
+0000db70: 655f 3229 2920 2a2a 2032 2920 2f20 280a  e_2)) ** 2) / (.
+0000db80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000db90: 2020 2020 6e5f 3220 2d20 310a 2020 2020      n_2 - 1.    
+0000dba0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0000dbb0: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
+0000dbc0: 6d65 7261 746f 7220 3d20 284e 202d 2032  merator = (N - 2
+0000dbd0: 2920 2a20 280a 2020 2020 2020 2020 2020  ) * (.          
+0000dbe0: 2020 2020 2020 2020 2020 6e70 2e6c 6f67            np.log
+0000dbf0: 286d 6561 6e5f 7661 7269 616e 6365 5f31  (mean_variance_1
+0000dc00: 2920 2b20 6e70 2e6c 6f67 286d 6561 6e5f  ) + np.log(mean_
+0000dc10: 7661 7269 616e 6365 5f32 290a 2020 2020  variance_2).    
+0000dc20: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0000dc30: 2020 2020 2020 2020 2020 2020 2020 6465                de
+0000dc40: 6e6f 6d69 6e61 746f 7220 3d20 3120 2f20  nominator = 1 / 
+0000dc50: 286e 5f31 202d 2031 2920 2b20 3120 2f20  (n_1 - 1) + 1 / 
+0000dc60: 286e 5f32 202d 2031 290a 2020 2020 2020  (n_2 - 1).      
+0000dc70: 2020 2020 2020 2020 2020 7520 3d20 6e75            u = nu
+0000dc80: 6d65 7261 746f 7220 2f20 6465 6e6f 6d69  merator / denomi
+0000dc90: 6e61 746f 720a 2020 2020 2020 2020 2020  nator.          
+0000dca0: 2020 2020 2020 7265 7375 6c74 735b 7769        results[wi
+0000dcb0: 6e64 6f77 5f73 7461 7274 3a77 696e 646f  ndow_start:windo
+0000dcc0: 775f 656e 642c 2069 5d20 3d20 750a 0a20  w_end, i] = u.. 
+0000dcd0: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+0000dce0: 7375 6c74 730a 0a20 2020 2040 7374 6174  sults..    @stat
+0000dcf0: 6963 6d65 7468 6f64 0a20 2020 2040 6e6a  icmethod.    @nj
+0000dd00: 6974 2822 2866 6c6f 6174 3332 5b3a 5d2c  it("(float32[:],
+0000dd10: 2066 6c6f 6174 3332 5b3a 5d29 2229 0a20   float32[:])"). 
+0000dd20: 2020 2064 6566 2070 6561 7273 6f6e 735f     def pearsons_
+0000dd30: 7228 7361 6d70 6c65 5f31 3a20 6e70 2e6e  r(sample_1: np.n
+0000dd40: 6461 7272 6179 2c20 7361 6d70 6c65 5f32  darray, sample_2
+0000dd50: 3a20 6e70 2e6e 6461 7272 6179 2920 2d3e  : np.ndarray) ->
+0000dd60: 2066 6c6f 6174 3a0a 2020 2020 2020 2020   float:.        
+0000dd70: 2222 220a 2020 2020 2020 2020 4361 6c63  """.        Calc
+0000dd80: 756c 6174 6520 7468 6520 5065 6172 736f  ulate the Pearso
+0000dd90: 6e20 636f 7272 656c 6174 696f 6e20 636f  n correlation co
+0000dda0: 6566 6669 6369 656e 7420 2850 6561 7273  efficient (Pears
+0000ddb0: 6f6e 2773 2072 2920 6265 7477 6565 6e20  on's r) between 
+0000ddc0: 7477 6f20 6e75 6d65 7269 6320 7361 6d70  two numeric samp
+0000ddd0: 6c65 732e 0a0a 2020 2020 2020 2020 5065  les...        Pe
+0000dde0: 6172 736f 6e27 7320 7220 6973 2061 206d  arson's r is a m
+0000ddf0: 6561 7375 7265 206f 6620 7468 6520 6c69  easure of the li
+0000de00: 6e65 6172 2063 6f72 7265 6c61 7469 6f6e  near correlation
+0000de10: 2062 6574 7765 656e 2074 776f 2073 6574   between two set
+0000de20: 7320 6f66 2064 6174 6120 706f 696e 7473  s of data points
+0000de30: 2e20 4974 2071 7561 6e74 6966 6965 7320  . It quantifies 
+0000de40: 7468 6520 7374 7265 6e67 7468 2061 6e64  the strength and
+0000de50: 0a20 2020 2020 2020 2064 6972 6563 7469  .        directi
+0000de60: 6f6e 206f 6620 7468 6520 6c69 6e65 6172  on of the linear
+0000de70: 2072 656c 6174 696f 6e73 6869 7020 6265   relationship be
+0000de80: 7477 6565 6e20 7468 6520 7477 6f20 7661  tween the two va
+0000de90: 7269 6162 6c65 732e 2054 6865 2063 6f65  riables. The coe
+0000dea0: 6666 6963 6965 6e74 2076 6172 6965 7320  fficient varies 
+0000deb0: 6265 7477 6565 6e20 2d31 2061 6e64 2031  between -1 and 1
+0000dec0: 2c20 7769 7468 0a20 2020 2020 2020 202d  , with.        -
+0000ded0: 3120 696e 6469 6361 7469 6e67 2061 2070  1 indicating a p
+0000dee0: 6572 6665 6374 206e 6567 6174 6976 6520  erfect negative 
+0000def0: 6c69 6e65 6172 2072 656c 6174 696f 6e73  linear relations
+0000df00: 6869 702c 2031 2069 6e64 6963 6174 696e  hip, 1 indicatin
+0000df10: 6720 6120 7065 7266 6563 7420 706f 7369  g a perfect posi
+0000df20: 7469 7665 206c 696e 6561 7220 7265 6c61  tive linear rela
+0000df30: 7469 6f6e 7368 6970 2c20 616e 6420 300a  tionship, and 0.
+0000df40: 2020 2020 2020 2020 696e 6469 6361 7469          indicati
+0000df50: 6e67 206e 6f20 6c69 6e65 6172 2072 656c  ng no linear rel
+0000df60: 6174 696f 6e73 6869 702e 0a0a 2020 2020  ationship...    
+0000df70: 2020 2020 3a65 7861 6d70 6c65 3a0a 2020      :example:.  
+0000df80: 2020 2020 2020 3e3e 3e20 7361 6d70 6c65        >>> sample
+0000df90: 5f31 203d 206e 702e 6172 7261 7928 5b37  _1 = np.array([7
+0000dfa0: 2c20 322c 2039 2c20 342c 2035 2c20 362c  , 2, 9, 4, 5, 6,
+0000dfb0: 2037 2c20 382c 2039 5d29 2e61 7374 7970   7, 8, 9]).astyp
+0000dfc0: 6528 6e70 2e66 6c6f 6174 3332 290a 2020  e(np.float32).  
+0000dfd0: 2020 2020 2020 3e3e 3e20 7361 6d70 6c65        >>> sample
+0000dfe0: 5f32 203d 206e 702e 6172 7261 7928 5b31  _2 = np.array([1
+0000dff0: 2e35 2c20 322e 352c 2033 2e35 2c20 342e  .5, 2.5, 3.5, 4.
+0000e000: 352c 2035 2e35 2c20 362e 352c 2037 2e35  5, 5.5, 6.5, 7.5
+0000e010: 2c20 382e 352c 2039 2e35 5d29 2e61 7374  , 8.5, 9.5]).ast
+0000e020: 7970 6528 6e70 2e66 6c6f 6174 3332 290a  ype(np.float32).
+0000e030: 2020 2020 2020 2020 3e3e 3e20 5374 6174          >>> Stat
+0000e040: 6973 7469 6373 2829 2e70 6561 7273 6f6e  istics().pearson
+0000e050: 735f 7228 7361 6d70 6c65 5f31 3d73 616d  s_r(sample_1=sam
+0000e060: 706c 655f 312c 2073 616d 706c 655f 323d  ple_1, sample_2=
+0000e070: 7361 6d70 6c65 5f32 290a 2020 2020 2020  sample_2).      
+0000e080: 2020 3e3e 3e20 302e 3437 0a20 2020 2020    >>> 0.47.     
+0000e090: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+0000e0a0: 6d31 2c20 6d32 203d 206e 702e 6d65 616e  m1, m2 = np.mean
+0000e0b0: 2873 616d 706c 655f 3129 2c20 6e70 2e6d  (sample_1), np.m
+0000e0c0: 6561 6e28 7361 6d70 6c65 5f32 290a 2020  ean(sample_2).  
+0000e0d0: 2020 2020 2020 6e75 6d65 7261 746f 7220        numerator 
+0000e0e0: 3d20 6e70 2e73 756d 2828 7361 6d70 6c65  = np.sum((sample
+0000e0f0: 5f31 202d 206d 3129 202a 2028 7361 6d70  _1 - m1) * (samp
+0000e100: 6c65 5f32 202d 206d 3229 290a 2020 2020  le_2 - m2)).    
+0000e110: 2020 2020 6465 6e6f 6d69 6e61 746f 7220      denominator 
+0000e120: 3d20 6e70 2e73 7172 7428 0a20 2020 2020  = np.sqrt(.     
+0000e130: 2020 2020 2020 206e 702e 7375 6d28 2873         np.sum((s
+0000e140: 616d 706c 655f 3120 2d20 6d31 2920 2a2a  ample_1 - m1) **
+0000e150: 2032 2920 2a20 6e70 2e73 756d 2828 7361   2) * np.sum((sa
+0000e160: 6d70 6c65 5f32 202d 206d 3229 202a 2a20  mple_2 - m2) ** 
+0000e170: 3229 0a20 2020 2020 2020 2029 0a20 2020  2).        ).   
+0000e180: 2020 2020 2072 203d 206e 756d 6572 6174       r = numerat
+0000e190: 6f72 202f 2064 656e 6f6d 696e 6174 6f72  or / denominator
+0000e1a0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000e1b0: 720a 0a20 2020 2040 7374 6174 6963 6d65  r..    @staticme
+0000e1c0: 7468 6f64 0a20 2020 2040 6e6a 6974 2822  thod.    @njit("
+0000e1d0: 2866 6c6f 6174 3332 5b3a 5d2c 2066 6c6f  (float32[:], flo
+0000e1e0: 6174 3332 5b3a 5d29 2229 0a20 2020 2064  at32[:])").    d
+0000e1f0: 6566 2073 7065 6172 6d61 6e5f 7261 6e6b  ef spearman_rank
+0000e200: 5f63 6f72 7265 6c61 7469 6f6e 2873 616d  _correlation(sam
+0000e210: 706c 655f 313a 206e 702e 6e64 6172 7261  ple_1: np.ndarra
+0000e220: 792c 2073 616d 706c 655f 323a 206e 702e  y, sample_2: np.
+0000e230: 6e64 6172 7261 7929 202d 3e20 666c 6f61  ndarray) -> floa
+0000e240: 743a 0a20 2020 2020 2020 2022 2222 0a20  t:.        """. 
+0000e250: 2020 2020 2020 203a 6578 616d 706c 653a         :example:
+0000e260: 0a20 2020 2020 2020 203e 3e3e 2073 616d  .        >>> sam
+0000e270: 706c 655f 3120 3d20 6e70 2e61 7272 6179  ple_1 = np.array
+0000e280: 285b 372c 2032 2c20 392c 2034 2c20 352c  ([7, 2, 9, 4, 5,
+0000e290: 2036 2c20 372c 2038 2c20 395d 292e 6173   6, 7, 8, 9]).as
+0000e2a0: 7479 7065 286e 702e 666c 6f61 7433 3229  type(np.float32)
+0000e2b0: 0a20 2020 2020 2020 203e 3e3e 2073 616d  .        >>> sam
+0000e2c0: 706c 655f 3220 3d20 6e70 2e61 7272 6179  ple_2 = np.array
+0000e2d0: 285b 312e 352c 2032 2e35 2c20 332e 352c  ([1.5, 2.5, 3.5,
+0000e2e0: 2034 2e35 2c20 352e 352c 2036 2e35 2c20   4.5, 5.5, 6.5, 
+0000e2f0: 372e 352c 2038 2e35 2c20 392e 355d 292e  7.5, 8.5, 9.5]).
+0000e300: 6173 7479 7065 286e 702e 666c 6f61 7433  astype(np.float3
+0000e310: 3229 0a20 2020 2020 2020 203e 3e3e 2053  2).        >>> S
+0000e320: 7461 7469 7374 6963 7328 292e 7370 6561  tatistics().spea
+0000e330: 726d 616e 5f72 616e 6b5f 636f 7272 656c  rman_rank_correl
+0000e340: 6174 696f 6e28 7361 6d70 6c65 5f31 3d73  ation(sample_1=s
+0000e350: 616d 706c 655f 312c 2073 616d 706c 655f  ample_1, sample_
+0000e360: 323d 7361 6d70 6c65 5f32 290a 2020 2020  2=sample_2).    
+0000e370: 2020 2020 3e3e 3e20 302e 3030 3033 3937      >>> 0.000397
+0000e380: 3932 3036 3038 3532 3035 3037 380a 2020  9206085205078.  
+0000e390: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+0000e3a0: 2020 2072 616e 6b5f 782c 2072 616e 6b5f     rank_x, rank_
+0000e3b0: 7920 3d20 6e70 2e61 7267 736f 7274 286e  y = np.argsort(n
+0000e3c0: 702e 6172 6773 6f72 7428 7361 6d70 6c65  p.argsort(sample
+0000e3d0: 5f31 2929 2c20 6e70 2e61 7267 736f 7274  _1)), np.argsort
+0000e3e0: 280a 2020 2020 2020 2020 2020 2020 6e70  (.            np
+0000e3f0: 2e61 7267 736f 7274 2873 616d 706c 655f  .argsort(sample_
+0000e400: 3229 0a20 2020 2020 2020 2029 0a20 2020  2).        ).   
+0000e410: 2020 2020 2064 5f73 7175 6172 6564 203d       d_squared =
+0000e420: 206e 702e 7375 6d28 2872 616e 6b5f 7820   np.sum((rank_x 
+0000e430: 2d20 7261 6e6b 5f79 2920 2a2a 2032 290a  - rank_y) ** 2).
+0000e440: 2020 2020 2020 2020 7265 7475 726e 2031          return 1
+0000e450: 202d 2028 3620 2a20 645f 7371 7561 7265   - (6 * d_square
+0000e460: 6429 202f 2028 6c65 6e28 7361 6d70 6c65  d) / (len(sample
+0000e470: 5f31 2920 2a20 286c 656e 2873 616d 706c  _1) * (len(sampl
+0000e480: 655f 3229 202a 2a20 3220 2d20 3129 290a  e_2) ** 2 - 1)).
+0000e490: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
+0000e4a0: 6f64 0a20 2020 2040 6e6a 6974 2822 2866  od.    @njit("(f
+0000e4b0: 6c6f 6174 3332 5b3a 5d2c 2066 6c6f 6174  loat32[:], float
+0000e4c0: 3332 5b3a 5d2c 2066 6c6f 6174 3634 5b3a  32[:], float64[:
+0000e4d0: 5d2c 2069 6e74 3634 2922 290a 2020 2020  ], int64)").    
+0000e4e0: 6465 6620 736c 6964 696e 675f 7065 6172  def sliding_pear
+0000e4f0: 736f 6e73 5f72 280a 2020 2020 2020 2020  sons_r(.        
+0000e500: 7361 6d70 6c65 5f31 3a20 6e70 2e6e 6461  sample_1: np.nda
+0000e510: 7272 6179 2c20 7361 6d70 6c65 5f32 3a20  rray, sample_2: 
+0000e520: 6e70 2e6e 6461 7272 6179 2c20 7469 6d65  np.ndarray, time
+0000e530: 5f77 696e 646f 7773 3a20 6e70 2e6e 6461  _windows: np.nda
+0000e540: 7272 6179 2c20 6670 733a 2069 6e74 0a20  rray, fps: int. 
+0000e550: 2020 2029 202d 3e20 6e70 2e6e 6461 7272     ) -> np.ndarr
+0000e560: 6179 3a0a 2020 2020 2020 2020 2222 220a  ay:.        """.
+0000e570: 2020 2020 2020 2020 4769 7665 6e20 7477          Given tw
+0000e580: 6f20 3144 2061 7272 6179 7320 6f66 2073  o 1D arrays of s
+0000e590: 697a 6520 4e2c 2063 7265 6174 6520 736c  ize N, create sl
+0000e5a0: 6964 696e 6720 7769 6e64 6f77 206f 6620  iding window of 
+0000e5b0: 7369 7a65 2074 696d 655f 7769 6e64 6f77  size time_window
+0000e5c0: 735b 695d 202a 2066 7073 2061 6e64 2072  s[i] * fps and r
+0000e5d0: 6574 7572 6e20 5065 6172 736f 6e27 7320  eturn Pearson's 
+0000e5e0: 520a 2020 2020 2020 2020 6265 7477 6565  R.        betwee
+0000e5f0: 6e20 7468 6520 7661 6c75 6573 2069 6e20  n the values in 
+0000e600: 7468 6520 7477 6f20 3144 2061 7272 6179  the two 1D array
+0000e610: 7320 696e 2065 6163 6820 7769 6e64 6f77  s in each window
+0000e620: 2e20 4164 6472 6573 7320 2277 6861 7420  . Address "what 
+0000e630: 6973 2074 6865 2063 6f72 7265 6c61 7469  is the correlati
+0000e640: 6f6e 2062 6574 7765 656e 2046 6561 7475  on between Featu
+0000e650: 7265 2031 2061 6e64 0a20 2020 2020 2020  re 1 and.       
+0000e660: 2046 6561 7475 7265 2032 2069 6e20 7468   Feature 2 in th
+0000e670: 6520 6375 7272 656e 7420 582e 5820 7365  e current X.X se
+0000e680: 636f 6e64 7320 6f66 2074 6865 2076 6964  conds of the vid
+0000e690: 656f 222e 0a0a 2020 2020 2020 2020 2e2e  eo"...        ..
+0000e6a0: 2069 6d61 6765 3a3a 205f 7374 6174 6963   image:: _static
+0000e6b0: 2f69 6d67 2f73 6c69 6469 6e67 5f70 6561  /img/sliding_pea
+0000e6c0: 7273 6f6e 732e 706e 670a 2020 2020 2020  rsons.png.      
+0000e6d0: 2020 2020 203a 7769 6474 683a 2036 3030       :width: 600
+0000e6e0: 0a20 2020 2020 2020 2020 2020 3a61 6c69  .           :ali
+0000e6f0: 676e 3a20 6365 6e74 6572 0a0a 2020 2020  gn: center..    
+0000e700: 2020 2020 3a70 6172 616d 6574 6572 206e      :parameter n
+0000e710: 6461 7272 6179 2073 616d 706c 655f 313a  darray sample_1:
+0000e720: 2046 6972 7374 2031 4420 6172 7261 7920   First 1D array 
+0000e730: 7769 7468 2066 6561 7475 7265 2076 616c  with feature val
+0000e740: 7565 732e 0a20 2020 2020 2020 203a 7061  ues..        :pa
+0000e750: 7261 6d65 7465 7220 6e64 6172 7261 7920  rameter ndarray 
+0000e760: 7361 6d70 6c65 5f31 3a20 5365 636f 6e64  sample_1: Second
+0000e770: 2031 4420 6172 7261 7920 7769 7468 2066   1D array with f
+0000e780: 6561 7475 7265 2076 616c 7565 732e 0a20  eature values.. 
+0000e790: 2020 2020 2020 203a 7061 7261 6d65 7465         :paramete
+0000e7a0: 7220 666c 6f61 7420 7469 6d65 5f77 696e  r float time_win
+0000e7b0: 646f 7773 3a20 5468 6520 6c65 6e67 7468  dows: The length
+0000e7c0: 206f 6620 7468 6520 736c 6964 696e 6720   of the sliding 
+0000e7d0: 7769 6e64 6f77 2069 6e20 7365 636f 6e64  window in second
+0000e7e0: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
+0000e7f0: 6d65 7465 7220 696e 7420 6670 733a 2054  meter int fps: T
+0000e800: 6865 2066 7073 206f 6620 7468 6520 7265  he fps of the re
+0000e810: 636f 7264 6564 2076 6964 656f 2e0a 2020  corded video..  
+0000e820: 2020 2020 2020 3a72 6574 7572 6e73 206e        :returns n
+0000e830: 702e 6e64 6172 7261 793a 2032 6420 6172  p.ndarray: 2d ar
+0000e840: 7261 7920 6f66 2050 6561 7273 6f6e 7320  ray of Pearsons 
+0000e850: 5220 6f66 2073 697a 6520 6c65 6e28 7361  R of size len(sa
+0000e860: 6d70 6c65 5f31 2920 7820 6c65 6e28 7469  mple_1) x len(ti
+0000e870: 6d65 5f77 696e 646f 7773 292e 204e 6f74  me_windows). Not
+0000e880: 652c 2069 6620 736c 6964 696e 6720 7769  e, if sliding wi
+0000e890: 6e64 6f77 2069 7320 3130 2066 7261 6d65  ndow is 10 frame
+0000e8a0: 732c 2074 6865 2066 6972 7374 2039 2065  s, the first 9 e
+0000e8b0: 6e74 7269 6573 2077 696c 6c20 6265 2066  ntries will be f
+0000e8c0: 696c 6c65 6420 7769 7468 2030 2e0a 0a20  illed with 0... 
+0000e8d0: 2020 2020 2020 203a 6578 616d 706c 653a         :example:
+0000e8e0: 0a20 2020 2020 2020 203e 3e3e 2073 616d  .        >>> sam
+0000e8f0: 706c 655f 3120 3d20 6e70 2e72 616e 646f  ple_1 = np.rando
+0000e900: 6d2e 7261 6e64 696e 7428 302c 2035 302c  m.randint(0, 50,
+0000e910: 2028 3130 2929 2e61 7374 7970 6528 6e70   (10)).astype(np
+0000e920: 2e66 6c6f 6174 3332 290a 2020 2020 2020  .float32).      
+0000e930: 2020 3e3e 3e20 7361 6d70 6c65 5f32 203d    >>> sample_2 =
+0000e940: 206e 702e 7261 6e64 6f6d 2e72 616e 6469   np.random.randi
+0000e950: 6e74 2830 2c20 3530 2c20 2831 3029 292e  nt(0, 50, (10)).
+0000e960: 6173 7479 7065 286e 702e 666c 6f61 7433  astype(np.float3
+0000e970: 3229 0a20 2020 2020 2020 203e 3e3e 2053  2).        >>> S
+0000e980: 7461 7469 7374 6963 7328 292e 736c 6964  tatistics().slid
+0000e990: 696e 675f 7065 6172 736f 6e73 5f72 2873  ing_pearsons_r(s
+0000e9a0: 616d 706c 655f 313d 7361 6d70 6c65 5f31  ample_1=sample_1
+0000e9b0: 2c20 7361 6d70 6c65 5f32 3d73 616d 706c  , sample_2=sampl
+0000e9c0: 655f 322c 2074 696d 655f 7769 6e64 6f77  e_2, time_window
+0000e9d0: 733d 6e70 2e61 7272 6179 285b 302e 355d  s=np.array([0.5]
+0000e9e0: 292c 2066 7073 3d31 3029 0a20 2020 2020  ), fps=10).     
+0000e9f0: 2020 203e 3e3e 205b 5b2d 312e 5d5b 2d31     >>> [[-1.][-1
+0000ea00: 2e5d 5b2d 312e 5d5b 2d31 2e5d 5b30 2e32  .][-1.][-1.][0.2
+0000ea10: 3237 5d5b 2d30 2e33 3139 5d5b 2d30 2e31  27][-0.319][-0.1
+0000ea20: 3936 5d5b 302e 3437 345d 5b2d 302e 3036  96][0.474][-0.06
+0000ea30: 315d 5b30 2e37 3133 5d5d 0a20 2020 2020  1][0.713]].     
+0000ea40: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+0000ea50: 7265 7375 6c74 7320 3d20 6e70 2e66 756c  results = np.ful
+0000ea60: 6c28 2873 616d 706c 655f 312e 7368 6170  l((sample_1.shap
+0000ea70: 655b 305d 2c20 7469 6d65 5f77 696e 646f  e[0], time_windo
+0000ea80: 7773 2e73 6861 7065 5b30 5d29 2c20 302e  ws.shape[0]), 0.
+0000ea90: 3029 0a20 2020 2020 2020 2066 6f72 2069  0).        for i
+0000eaa0: 2069 6e20 7072 616e 6765 2874 696d 655f   in prange(time_
+0000eab0: 7769 6e64 6f77 732e 7368 6170 655b 305d  windows.shape[0]
+0000eac0: 293a 0a20 2020 2020 2020 2020 2020 2077  ):.            w
+0000ead0: 696e 646f 775f 7369 7a65 203d 2069 6e74  indow_size = int
+0000eae0: 2874 696d 655f 7769 6e64 6f77 735b 695d  (time_windows[i]
+0000eaf0: 202a 2066 7073 290a 2020 2020 2020 2020   * fps).        
+0000eb00: 2020 2020 666f 7220 6c65 6674 2c20 7269      for left, ri
+0000eb10: 6768 7420 696e 207a 6970 280a 2020 2020  ght in zip(.    
+0000eb20: 2020 2020 2020 2020 2020 2020 7072 616e              pran
+0000eb30: 6765 2830 2c20 7361 6d70 6c65 5f31 2e73  ge(0, sample_1.s
+0000eb40: 6861 7065 5b30 5d20 2b20 3129 2c0a 2020  hape[0] + 1),.  
+0000eb50: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+0000eb60: 616e 6765 2877 696e 646f 775f 7369 7a65  ange(window_size
+0000eb70: 2c20 7361 6d70 6c65 5f31 2e73 6861 7065  , sample_1.shape
+0000eb80: 5b30 5d20 2b20 3129 2c0a 2020 2020 2020  [0] + 1),.      
+0000eb90: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+0000eba0: 2020 2020 2020 2020 2073 312c 2073 3220           s1, s2 
+0000ebb0: 3d20 7361 6d70 6c65 5f31 5b6c 6566 743a  = sample_1[left:
+0000ebc0: 7269 6768 745d 2c20 7361 6d70 6c65 5f32  right], sample_2
+0000ebd0: 5b6c 6566 743a 7269 6768 745d 0a20 2020  [left:right].   
+0000ebe0: 2020 2020 2020 2020 2020 2020 206d 312c               m1,
+0000ebf0: 206d 3220 3d20 6e70 2e6d 6561 6e28 7331   m2 = np.mean(s1
+0000ec00: 292c 206e 702e 6d65 616e 2873 3229 0a20  ), np.mean(s2). 
+0000ec10: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0000ec20: 756d 6572 6174 6f72 203d 206e 702e 7375  umerator = np.su
+0000ec30: 6d28 2873 3120 2d20 6d31 2920 2a20 2873  m((s1 - m1) * (s
+0000ec40: 3220 2d20 6d32 2929 0a20 2020 2020 2020  2 - m2)).       
+0000ec50: 2020 2020 2020 2020 2064 656e 6f6d 696e           denomin
+0000ec60: 6174 6f72 203d 206e 702e 7371 7274 286e  ator = np.sqrt(n
+0000ec70: 702e 7375 6d28 2873 3120 2d20 6d31 2920  p.sum((s1 - m1) 
+0000ec80: 2a2a 2032 2920 2a20 6e70 2e73 756d 2828  ** 2) * np.sum((
+0000ec90: 7332 202d 206d 3229 202a 2a20 3229 290a  s2 - m2) ** 2)).
+0000eca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ecb0: 6966 2064 656e 6f6d 696e 6174 6f72 2021  if denominator !
+0000ecc0: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
+0000ecd0: 2020 2020 2020 2020 2072 203d 206e 756d           r = num
+0000ece0: 6572 6174 6f72 202f 2064 656e 6f6d 696e  erator / denomin
+0000ecf0: 6174 6f72 0a20 2020 2020 2020 2020 2020  ator.           
+0000ed00: 2020 2020 2020 2020 2072 6573 756c 7473           results
+0000ed10: 5b72 6967 6874 202d 2031 2c20 695d 203d  [right - 1, i] =
+0000ed20: 2072 0a20 2020 2020 2020 2020 2020 2020   r.             
+0000ed30: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0000ed40: 2020 2020 2020 2020 2020 2020 2072 6573               res
+0000ed50: 756c 7473 5b72 6967 6874 202d 2031 2c20  ults[right - 1, 
+0000ed60: 695d 203d 202d 312e 300a 0a20 2020 2020  i] = -1.0..     
+0000ed70: 2020 2072 6574 7572 6e20 7265 7375 6c74     return result
+0000ed80: 730a 0a20 2020 2040 7374 6174 6963 6d65  s..    @staticme
+0000ed90: 7468 6f64 0a20 2020 2040 6e6a 6974 280a  thod.    @njit(.
+0000eda0: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
+0000edb0: 2020 2020 2020 2228 666c 6f61 7433 325b        "(float32[
+0000edc0: 3a5d 2c20 666c 6f61 7433 325b 3a5d 2c20  :], float32[:], 
+0000edd0: 666c 6f61 7436 345b 3a2c 3a5d 2c20 7479  float64[:,:], ty
+0000ede0: 7065 732e 756e 6963 6f64 655f 7479 7065  pes.unicode_type
+0000edf0: 2922 2c0a 2020 2020 2020 2020 2020 2020  )",.            
+0000ee00: 2728 666c 6f61 7433 325b 3a5d 2c20 666c  '(float32[:], fl
+0000ee10: 6f61 7433 325b 3a5d 2c20 666c 6f61 7436  oat32[:], float6
+0000ee20: 345b 3a2c 3a5d 2c20 7479 7065 732e 6d69  4[:,:], types.mi
+0000ee30: 7363 2e4f 6d69 7474 6564 2822 676f 6f64  sc.Omitted("good
+0000ee40: 6e65 7373 5f6f 665f 6669 7422 2929 272c  ness_of_fit"))',
+0000ee50: 0a20 2020 2020 2020 2020 2020 2022 2866  .            "(f
+0000ee60: 6c6f 6174 3332 5b3a 5d2c 2066 6c6f 6174  loat32[:], float
+0000ee70: 3332 5b3a 5d2c 2074 7970 6573 2e6d 6973  32[:], types.mis
+0000ee80: 632e 4f6d 6974 7465 6428 4e6f 6e65 292c  c.Omitted(None),
+0000ee90: 2074 7970 6573 2e75 6e69 636f 6465 5f74   types.unicode_t
+0000eea0: 7970 6529 222c 0a20 2020 2020 2020 2020  ype)",.         
+0000eeb0: 2020 2027 2866 6c6f 6174 3332 5b3a 5d2c     '(float32[:],
+0000eec0: 2066 6c6f 6174 3332 5b3a 5d2c 2074 7970   float32[:], typ
+0000eed0: 6573 2e6d 6973 632e 4f6d 6974 7465 6428  es.misc.Omitted(
+0000eee0: 4e6f 6e65 292c 2074 7970 6573 2e6d 6973  None), types.mis
+0000eef0: 632e 4f6d 6974 7465 6428 2267 6f6f 646e  c.Omitted("goodn
+0000ef00: 6573 735f 6f66 5f66 6974 2229 2927 2c0a  ess_of_fit"))',.
+0000ef10: 2020 2020 2020 2020 5d0a 2020 2020 290a          ].    ).
+0000ef20: 2020 2020 6465 6620 6368 695f 7371 7561      def chi_squa
+0000ef30: 7265 280a 2020 2020 2020 2020 7361 6d70  re(.        samp
+0000ef40: 6c65 5f31 3a20 6e70 2e6e 6461 7272 6179  le_1: np.ndarray
+0000ef50: 2c0a 2020 2020 2020 2020 7361 6d70 6c65  ,.        sample
+0000ef60: 5f32 3a20 6e70 2e6e 6461 7272 6179 2c0a  _2: np.ndarray,.
+0000ef70: 2020 2020 2020 2020 6372 6974 6963 616c          critical
+0000ef80: 5f76 616c 7565 733a 204f 7074 696f 6e61  _values: Optiona
+0000ef90: 6c5b 6e70 2e6e 6461 7272 6179 5d20 3d20  l[np.ndarray] = 
+0000efa0: 4e6f 6e65 2c0a 2020 2020 2020 2020 7479  None,.        ty
+0000efb0: 7065 3a20 4f70 7469 6f6e 616c 5b4c 6974  pe: Optional[Lit
+0000efc0: 6572 616c 5b22 676f 6f64 6e65 7373 5f6f  eral["goodness_o
+0000efd0: 665f 6669 7422 2c20 2269 6e64 6570 656e  f_fit", "indepen
+0000efe0: 6465 6e63 6522 5d5d 203d 2022 676f 6f64  dence"]] = "good
+0000eff0: 6e65 7373 5f6f 665f 6669 7422 2c0a 2020  ness_of_fit",.  
+0000f000: 2020 2920 2d3e 2054 7570 6c65 5b66 6c6f    ) -> Tuple[flo
+0000f010: 6174 2c20 556e 696f 6e5b 626f 6f6c 2c20  at, Union[bool, 
+0000f020: 4e6f 6e65 5d5d 3a0a 2020 2020 2020 2020  None]]:.        
+0000f030: 2222 220a 2020 2020 2020 2020 4a69 7474  """.        Jitt
+0000f040: 6564 2063 6f6d 7075 7465 206f 6620 6368  ed compute of ch
+0000f050: 6920 7371 7561 7265 2062 6574 7765 656e  i square between
+0000f060: 2074 776f 2063 6174 6567 6f72 6963 616c   two categorical
+0000f070: 2064 6973 7472 6962 7574 696f 6e73 2e0a   distributions..
+0000f080: 0a20 2020 2020 2020 203a 7061 7261 6d65  .        :parame
+0000f090: 7465 7220 6e64 6172 7261 7920 7361 6d70  ter ndarray samp
+0000f0a0: 6c65 5f31 3a20 4669 7273 7420 3164 2061  le_1: First 1d a
+0000f0b0: 7272 6179 2072 6570 7265 7365 6e74 696e  rray representin
+0000f0c0: 6720 6665 6174 7572 6520 7661 6c75 6573  g feature values
+0000f0d0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0000f0e0: 6574 6572 206e 6461 7272 6179 2073 616d  eter ndarray sam
+0000f0f0: 706c 655f 323a 2053 6563 6f6e 6420 3164  ple_2: Second 1d
+0000f100: 2061 7272 6179 2072 6570 7265 7365 6e74   array represent
+0000f110: 696e 6720 6665 6174 7572 6520 7661 6c75  ing feature valu
+0000f120: 6573 2e0a 2020 2020 2020 2020 3a70 6172  es..        :par
+0000f130: 616d 6574 6572 206e 6461 7272 6179 2063  ameter ndarray c
+0000f140: 7269 7469 6361 6c5f 7661 6c75 6573 3a20  ritical_values: 
+0000f150: 3244 2061 7272 6179 2077 6974 6820 7768  2D array with wh
+0000f160: 6572 6520 696e 6465 7865 7320 7265 7072  ere indexes repr
+0000f170: 6573 656e 7420 6465 6772 6565 7320 6f66  esent degrees of
+0000f180: 2066 7265 6564 6f6d 2061 6e64 2076 616c   freedom and val
+0000f190: 7565 730a 2020 2020 2020 2020 2020 2020  ues.            
+0000f1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f1c0: 7265 7072 6573 656e 7420 6372 6974 6963  represent critic
+0000f1d0: 616c 2076 616c 7565 732e 2043 616e 2062  al values. Can b
+0000f1e0: 6520 666f 756e 6420 696e 2060 6073 696d  e found in ``sim
+0000f1f0: 6261 2e61 7373 6574 732e 6372 6974 6963  ba.assets.critic
+0000f200: 616c 5f76 616c 7565 735f 3035 2e70 6963  al_values_05.pic
+0000f210: 6b6c 6560 600a 0a20 2020 2020 2020 202e  kle``..        .
+0000f220: 2e20 6e6f 7465 3a3a 0a20 2020 2020 2020  . note::.       
+0000f230: 2020 2020 5265 7175 6972 6573 2073 616d      Requires sam
+0000f240: 706c 655f 3120 616e 6420 7361 6d70 6c65  ple_1 and sample
+0000f250: 5f32 2068 6173 2074 6f20 6265 206e 756d  _2 has to be num
+0000f260: 6572 6963 2e20 6966 2077 6f72 6b69 6e67  eric. if working
+0000f270: 2077 6974 6820 7374 7269 6e67 732c 2063   with strings, c
+0000f280: 6f6e 7665 7274 2074 6f0a 2020 2020 2020  onvert to.      
+0000f290: 2020 2020 206e 756d 6572 6963 2063 6174       numeric cat
+0000f2a0: 6567 6f72 7920 7661 6c75 6573 2062 6566  egory values bef
+0000f2b0: 6f72 6520 7573 696e 6720 6368 695f 7371  ore using chi_sq
+0000f2c0: 7561 7265 2e0a 0a20 2020 2020 2020 202e  uare...        .
+0000f2d0: 2e20 7761 726e 696e 673a 0a20 2020 2020  . warning:.     
+0000f2e0: 2020 2020 2020 4e6f 6e2d 6f76 6572 6c61        Non-overla
+0000f2f0: 7070 696e 6720 7661 6c75 6573 2028 692e  pping values (i.
+0000f300: 652e 2c20 6361 7465 676f 7269 6573 2065  e., categories e
+0000f310: 7869 7374 2069 6e20 7361 6d70 6c65 5f31  xist in sample_1
+0000f320: 2074 6861 7420 646f 6573 206e 6f74 2065   that does not e
+0000f330: 7869 7374 2069 6e20 7361 6d70 6c65 3229  xist in sample2)
+0000f340: 206f 7220 736d 616c 6c20 7661 6c75 6573   or small values
+0000f350: 206d 6179 2063 6175 7365 2069 6e66 6c61   may cause infla
+0000f360: 7465 6420 6368 6920 7371 7561 7265 2076  ted chi square v
+0000f370: 616c 7565 732e 0a20 2020 2020 2020 2020  alues..         
+0000f380: 2020 4966 2073 6d61 6c6c 2063 6f6e 7469    If small conti
+0000f390: 6e67 656e 6379 2074 6162 6c65 2073 6d61  ngency table sma
+0000f3a0: 6c6c 2076 616c 7565 732c 2063 6f6e 7369  ll values, consi
+0000f3b0: 6465 7220 544f 444f 2046 6973 6865 7227  der TODO Fisher'
+0000f3c0: 7320 6578 6163 7420 7465 7374 0a0a 2020  s exact test..  
+0000f3d0: 2020 2020 2020 3a65 7861 6d70 6c65 3a0a        :example:.
+0000f3e0: 2020 2020 2020 2020 3e3e 3e20 7361 6d70          >>> samp
+0000f3f0: 6c65 5f31 203d 206e 702e 6172 7261 7928  le_1 = np.array(
+0000f400: 5b31 2c20 312c 2032 2c20 322c 2033 2c20  [1, 1, 2, 2, 3, 
+0000f410: 332c 2034 2c20 342c 2035 2c20 352c 2035  3, 4, 4, 5, 5, 5
+0000f420: 5d29 2e61 7374 7970 6528 6e70 2e66 6c6f  ]).astype(np.flo
+0000f430: 6174 3332 290a 2020 2020 2020 2020 3e3e  at32).        >>
+0000f440: 3e20 7361 6d70 6c65 5f32 203d 206e 702e  > sample_2 = np.
+0000f450: 6172 7261 7928 5b31 2c20 322c 2033 2c20  array([1, 2, 3, 
+0000f460: 342c 2035 2c20 362c 2037 2c20 382c 2039  4, 5, 6, 7, 8, 9
+0000f470: 2c20 3130 5d29 2e61 7374 7970 6528 6e70  , 10]).astype(np
+0000f480: 2e66 6c6f 6174 3332 290a 2020 2020 2020  .float32).      
+0000f490: 2020 3e3e 3e20 6372 6974 6963 616c 5f76    >>> critical_v
+0000f4a0: 616c 7565 7320 3d20 7069 636b 6c65 2e6c  alues = pickle.l
+0000f4b0: 6f61 6428 6f70 656e 2822 7369 6d62 612f  oad(open("simba/
+0000f4c0: 6173 7365 7473 2f6c 6f6f 6b75 7073 2f63  assets/lookups/c
+0000f4d0: 7269 7469 6361 6c5f 7661 6c75 6573 5f35  ritical_values_5
+0000f4e0: 2e70 6963 6b6c 6522 2c20 2272 6222 2929  .pickle", "rb"))
+0000f4f0: 5b27 6368 695f 7371 7561 7265 275d 5b27  ['chi_square']['
+0000f500: 6f6e 655f 7461 696c 275d 2e76 616c 7565  one_tail'].value
+0000f510: 730a 2020 2020 2020 2020 3e3e 3e20 5374  s.        >>> St
+0000f520: 6174 6973 7469 6373 2e63 6869 5f73 7175  atistics.chi_squ
+0000f530: 6172 6528 7361 6d70 6c65 5f31 3d73 616d  are(sample_1=sam
+0000f540: 706c 655f 322c 2073 616d 706c 655f 323d  ple_2, sample_2=
+0000f550: 7361 6d70 6c65 5f31 2c20 6372 6974 6963  sample_1, critic
+0000f560: 616c 5f76 616c 7565 733d 6372 6974 6963  al_values=critic
+0000f570: 616c 5f76 616c 7565 732c 2074 7970 653d  al_values, type=
+0000f580: 2767 6f6f 646e 6573 735f 6f66 5f66 6974  'goodness_of_fit
+0000f590: 2729 0a20 2020 2020 2020 203e 3e3e 2028  ').        >>> (
+0000f5a0: 382e 3333 332c 2046 616c 7365 290a 2020  8.333, False).  
+0000f5b0: 2020 2020 2020 3e3e 3e0a 2020 2020 2020        >>>.      
+0000f5c0: 2020 2222 220a 0a20 2020 2020 2020 2063    """..        c
+0000f5d0: 6869 5f73 7175 6172 652c 2073 6967 6e69  hi_square, signi
+0000f5e0: 6669 6361 6e63 655f 626f 6f6c 203d 2030  ficance_bool = 0
+0000f5f0: 2e30 2c20 4e6f 6e65 0a20 2020 2020 2020  .0, None.       
+0000f600: 2075 6e69 7175 655f 6361 7465 676f 7269   unique_categori
+0000f610: 6573 203d 206e 702e 756e 6971 7565 286e  es = np.unique(n
+0000f620: 702e 636f 6e63 6174 656e 6174 6528 2873  p.concatenate((s
+0000f630: 616d 706c 655f 312c 2073 616d 706c 655f  ample_1, sample_
+0000f640: 3229 2929 0a20 2020 2020 2020 2073 616d  2))).        sam
+0000f650: 706c 655f 315f 636f 756e 7473 203d 206e  ple_1_counts = n
+0000f660: 702e 7a65 726f 7328 6c65 6e28 756e 6971  p.zeros(len(uniq
+0000f670: 7565 5f63 6174 6567 6f72 6965 7329 2c20  ue_categories), 
+0000f680: 6474 7970 653d 6e70 2e69 6e74 3634 290a  dtype=np.int64).
+0000f690: 2020 2020 2020 2020 7361 6d70 6c65 5f32          sample_2
+0000f6a0: 5f63 6f75 6e74 7320 3d20 6e70 2e7a 6572  _counts = np.zer
+0000f6b0: 6f73 286c 656e 2875 6e69 7175 655f 6361  os(len(unique_ca
+0000f6c0: 7465 676f 7269 6573 292c 2064 7479 7065  tegories), dtype
+0000f6d0: 3d6e 702e 696e 7436 3429 0a0a 2020 2020  =np.int64)..    
+0000f6e0: 2020 2020 666f 7220 6920 696e 2070 7261      for i in pra
+0000f6f0: 6e67 6528 6c65 6e28 756e 6971 7565 5f63  nge(len(unique_c
+0000f700: 6174 6567 6f72 6965 7329 293a 0a20 2020  ategories)):.   
+0000f710: 2020 2020 2020 2020 2073 616d 706c 655f           sample_
+0000f720: 315f 636f 756e 7473 5b69 5d2c 2073 616d  1_counts[i], sam
+0000f730: 706c 655f 325f 636f 756e 7473 5b69 5d20  ple_2_counts[i] 
+0000f740: 3d20 6e70 2e73 756d 280a 2020 2020 2020  = np.sum(.      
+0000f750: 2020 2020 2020 2020 2020 7361 6d70 6c65            sample
+0000f760: 5f31 203d 3d20 756e 6971 7565 5f63 6174  _1 == unique_cat
+0000f770: 6567 6f72 6965 735b 695d 0a20 2020 2020  egories[i].     
+0000f780: 2020 2020 2020 2029 2c20 6e70 2e73 756d         ), np.sum
+0000f790: 2873 616d 706c 655f 3220 3d3d 2075 6e69  (sample_2 == uni
+0000f7a0: 7175 655f 6361 7465 676f 7269 6573 5b69  que_categories[i
+0000f7b0: 5d29 0a0a 2020 2020 2020 2020 666f 7220  ])..        for 
+0000f7c0: 6920 696e 2070 7261 6e67 6528 6c65 6e28  i in prange(len(
+0000f7d0: 756e 6971 7565 5f63 6174 6567 6f72 6965  unique_categorie
+0000f7e0: 7329 293a 0a20 2020 2020 2020 2020 2020  s)):.           
+0000f7f0: 2063 6f75 6e74 5f31 2c20 636f 756e 745f   count_1, count_
+0000f800: 3220 3d20 7361 6d70 6c65 5f31 5f63 6f75  2 = sample_1_cou
+0000f810: 6e74 735b 695d 2c20 7361 6d70 6c65 5f32  nts[i], sample_2
+0000f820: 5f63 6f75 6e74 735b 695d 0a20 2020 2020  _counts[i].     
+0000f830: 2020 2020 2020 2069 6620 636f 756e 745f         if count_
+0000f840: 3220 3e20 303a 0a20 2020 2020 2020 2020  2 > 0:.         
+0000f850: 2020 2020 2020 2063 6869 5f73 7175 6172         chi_squar
+0000f860: 6520 2b3d 2028 2863 6f75 6e74 5f31 202d  e += ((count_1 -
+0000f870: 2063 6f75 6e74 5f32 2920 2a2a 2032 2920   count_2) ** 2) 
+0000f880: 2f20 636f 756e 745f 320a 2020 2020 2020  / count_2.      
+0000f890: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000f8a0: 2020 2020 2020 2020 2020 2020 6368 695f              chi_
+0000f8b0: 7371 7561 7265 202b 3d20 2828 636f 756e  square += ((coun
+0000f8c0: 745f 3120 2d20 636f 756e 745f 3229 202a  t_1 - count_2) *
+0000f8d0: 2a20 3229 202f 2028 636f 756e 745f 3220  * 2) / (count_2 
+0000f8e0: 2b20 3129 0a0a 2020 2020 2020 2020 6966  + 1)..        if
+0000f8f0: 2063 7269 7469 6361 6c5f 7661 6c75 6573   critical_values
+0000f900: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+0000f910: 2020 2020 2020 2020 2020 6966 2074 7970            if typ
+0000f920: 6520 3d3d 2022 676f 6f64 6e65 7373 5f6f  e == "goodness_o
+0000f930: 665f 6669 7422 3a0a 2020 2020 2020 2020  f_fit":.        
+0000f940: 2020 2020 2020 2020 6466 203d 2075 6e69          df = uni
+0000f950: 7175 655f 6361 7465 676f 7269 6573 2e73  que_categories.s
+0000f960: 6861 7065 5b30 5d20 2d20 310a 2020 2020  hape[0] - 1.    
+0000f970: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0000f980: 2020 2020 2020 2020 2020 2020 2020 6466                df
+0000f990: 203d 2028 6c65 6e28 7361 6d70 6c65 5f31   = (len(sample_1
+0000f9a0: 5f63 6f75 6e74 7329 202d 2031 2920 2a20  _counts) - 1) * 
+0000f9b0: 286c 656e 2873 616d 706c 655f 325f 636f  (len(sample_2_co
+0000f9c0: 756e 7473 2920 2d20 3129 0a0a 2020 2020  unts) - 1)..    
+0000f9d0: 2020 2020 2020 2020 6372 6974 6963 616c          critical
+0000f9e0: 5f76 616c 7565 203d 206e 702e 696e 7465  _value = np.inte
+0000f9f0: 7270 2864 662c 2063 7269 7469 6361 6c5f  rp(df, critical_
+0000fa00: 7661 6c75 6573 5b3a 2c20 305d 2c20 6372  values[:, 0], cr
+0000fa10: 6974 6963 616c 5f76 616c 7565 735b 3a2c  itical_values[:,
+0000fa20: 2031 5d29 0a20 2020 2020 2020 2020 2020   1]).           
+0000fa30: 2069 6620 6368 695f 7371 7561 7265 203e   if chi_square >
+0000fa40: 3d20 6372 6974 6963 616c 5f76 616c 7565  = critical_value
+0000fa50: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000fa60: 2020 7369 676e 6966 6963 616e 6365 5f62    significance_b
+0000fa70: 6f6f 6c20 3d20 5472 7565 0a20 2020 2020  ool = True.     
+0000fa80: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0000fa90: 2020 2020 2020 2020 2020 2020 2073 6967               sig
+0000faa0: 6e69 6669 6361 6e63 655f 626f 6f6c 203d  nificance_bool =
+0000fab0: 2046 616c 7365 0a0a 2020 2020 2020 2020   False..        
+0000fac0: 7265 7475 726e 2063 6869 5f73 7175 6172  return chi_squar
+0000fad0: 652c 2073 6967 6e69 6669 6361 6e63 655f  e, significance_
+0000fae0: 626f 6f6c 0a0a 2020 2020 4073 7461 7469  bool..    @stati
+0000faf0: 636d 6574 686f 640a 2020 2020 406e 6a69  cmethod.    @nji
+0000fb00: 7428 2228 666c 6f61 7433 325b 3a5d 2c20  t("(float32[:], 
+0000fb10: 666c 6f61 7433 322c 2066 6c6f 6174 3332  float32, float32
+0000fb20: 2c20 666c 6f61 7433 325b 3a2c 3a5d 2c20  , float32[:,:], 
+0000fb30: 666c 6f61 7433 3229 2229 0a20 2020 2064  float32)").    d
+0000fb40: 6566 2073 6c69 6469 6e67 5f69 6e64 6570  ef sliding_indep
+0000fb50: 656e 6465 6e74 5f73 616d 706c 6573 5f74  endent_samples_t
+0000fb60: 280a 2020 2020 2020 2020 6461 7461 3a20  (.        data: 
+0000fb70: 6e70 2e6e 6461 7272 6179 2c0a 2020 2020  np.ndarray,.    
+0000fb80: 2020 2020 7469 6d65 5f77 696e 646f 773a      time_window:
+0000fb90: 2066 6c6f 6174 2c0a 2020 2020 2020 2020   float,.        
+0000fba0: 736c 6964 655f 7469 6d65 3a20 666c 6f61  slide_time: floa
+0000fbb0: 742c 0a20 2020 2020 2020 2063 7269 7469  t,.        criti
+0000fbc0: 6361 6c5f 7661 6c75 6573 3a20 6e70 2e6e  cal_values: np.n
+0000fbd0: 6461 7272 6179 2c0a 2020 2020 2020 2020  darray,.        
+0000fbe0: 6670 733a 2066 6c6f 6174 2c0a 2020 2020  fps: float,.    
+0000fbf0: 2920 2d3e 206e 702e 6e64 6172 7261 793a  ) -> np.ndarray:
+0000fc00: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0000fc10: 2020 2020 204a 6974 7465 6420 636f 6d70       Jitted comp
+0000fc20: 7574 6520 6f66 2073 6c69 6469 6e67 2069  ute of sliding i
+0000fc30: 6e64 6570 656e 6465 6e74 2073 616d 706c  ndependent sampl
+0000fc40: 6520 742d 7465 7374 2e20 436f 6d70 6172  e t-test. Compar
+0000fc50: 6573 2074 6865 2066 6561 7475 7265 2076  es the feature v
+0000fc60: 616c 7565 7320 696e 2063 7572 7265 6e74  alues in current
+0000fc70: 2074 696d 652d 7769 6e64 6f77 0a20 2020   time-window.   
+0000fc80: 2020 2020 2074 6f20 7072 696f 7220 7469       to prior ti
+0000fc90: 6d65 2d77 696e 646f 7773 2074 6f20 6669  me-windows to fi
+0000fca0: 6e64 2074 6865 206c 656e 6774 6820 696e  nd the length in
+0000fcb0: 2074 696d 6520 746f 2074 6865 206d 6f73   time to the mos
+0000fcc0: 7420 7265 6365 6e74 2074 696d 652d 7769  t recent time-wi
+0000fcd0: 6e64 6f77 2077 6865 7265 2061 2073 6967  ndow where a sig
+0000fce0: 6e69 6669 6361 6e74 6c79 2064 6966 6665  nificantly diffe
+0000fcf0: 7265 6e74 0a20 2020 2020 2020 2066 6561  rent.        fea
+0000fd00: 7475 7265 2076 616c 7565 2064 6973 7472  ture value distr
+0000fd10: 6962 7574 696f 6e20 6973 2064 6574 6563  ibution is detec
+0000fd20: 7465 642e 0a0a 2020 2020 2020 2020 2e2e  ted...        ..
+0000fd30: 2069 6d61 6765 3a3a 205f 7374 6174 6963   image:: _static
+0000fd40: 2f69 6d67 2f73 6c69 6469 6e67 5f73 7461  /img/sliding_sta
+0000fd50: 7469 7374 6963 732e 706e 670a 2020 2020  tistics.png.    
+0000fd60: 2020 2020 2020 203a 7769 6474 683a 2031         :width: 1
+0000fd70: 3530 300a 2020 2020 2020 2020 2020 203a  500.           :
+0000fd80: 616c 6967 6e3a 2063 656e 7465 720a 0a20  align: center.. 
+0000fd90: 2020 2020 2020 203a 7061 7261 6d65 7465         :paramete
+0000fda0: 7220 6e64 6172 7261 7920 6461 7461 3a20  r ndarray data: 
+0000fdb0: 3144 2061 7272 6179 2077 6974 6820 6665  1D array with fe
+0000fdc0: 6174 7572 6520 7661 6c75 6573 2e0a 2020  ature values..  
+0000fdd0: 2020 2020 2020 3a70 6172 616d 6574 6572        :parameter
+0000fde0: 2066 6c6f 6174 2074 696d 655f 7769 6e64   float time_wind
+0000fdf0: 6f77 3a20 5468 6520 7369 7a65 7320 6f66  ow: The sizes of
+0000fe00: 2074 6865 2074 776f 2066 6561 7475 7265   the two feature
+0000fe10: 2076 616c 7565 2077 696e 646f 7773 2062   value windows b
+0000fe20: 6569 6e67 2063 6f6d 7061 7265 6420 696e  eing compared in
+0000fe30: 2073 6563 6f6e 6473 2e0a 2020 2020 2020   seconds..      
+0000fe40: 2020 3a70 6172 616d 6574 6572 2066 6c6f    :parameter flo
+0000fe50: 6174 2073 6c69 6465 5f74 696d 653a 2054  at slide_time: T
+0000fe60: 6865 2073 6c69 6465 2073 697a 6520 6f66  he slide size of
+0000fe70: 2074 6865 2073 6563 6f6e 6420 7769 6e64   the second wind
+0000fe80: 6f77 2e0a 2020 2020 2020 2020 3a70 6172  ow..        :par
+0000fe90: 616d 6574 6572 206e 6461 7272 6179 2063  ameter ndarray c
+0000fea0: 7269 7469 6361 6c5f 7661 6c75 6573 3a20  ritical_values: 
+0000feb0: 3244 2061 7272 6179 2077 6974 6820 7768  2D array with wh
+0000fec0: 6572 6520 696e 6465 7865 7320 7265 7072  ere indexes repr
+0000fed0: 6573 656e 7420 6465 6772 6565 7320 6f66  esent degrees of
+0000fee0: 2066 7265 6564 6f6d 2061 6e64 2076 616c   freedom and val
+0000fef0: 7565 730a 2020 2020 2020 2020 2020 2020  ues.            
+0000ff00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ff10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ff20: 7265 7072 6573 656e 7420 6372 6974 6963  represent critic
+0000ff30: 616c 2054 2076 616c 7565 732e 2043 616e  al T values. Can
+0000ff40: 2062 6520 666f 756e 6420 696e 2060 6073   be found in ``s
+0000ff50: 696d 6261 2e61 7373 6574 732e 6372 6974  imba.assets.crit
+0000ff60: 6963 616c 5f76 616c 7565 735f 3035 2e70  ical_values_05.p
+0000ff70: 6963 6b6c 6560 602e 0a20 2020 2020 2020  ickle``..       
+0000ff80: 203a 7061 7261 6d65 7465 7220 696e 7420   :parameter int 
+0000ff90: 6670 733a 2054 6865 2066 7073 206f 6620  fps: The fps of 
+0000ffa0: 7468 6520 7265 636f 7264 6564 2076 6964  the recorded vid
+0000ffb0: 656f 2e0a 2020 2020 2020 2020 3a72 6574  eo..        :ret
+0000ffc0: 7572 6e73 206e 702e 6e64 6172 7261 793a  urns np.ndarray:
+0000ffd0: 2031 4420 6172 7261 7920 6f66 2073 697a   1D array of siz
+0000ffe0: 6520 6c65 6e28 6461 7461 2920 7769 7468  e len(data) with
+0000fff0: 2076 616c 7565 7320 7265 7072 6573 656e   values represen
+00010000: 7469 6e67 2074 696d 6520 746f 206d 6f73  ting time to mos
+00010010: 7420 7265 6365 6e74 2073 6967 6e69 6669  t recent signifi
+00010020: 6361 6e74 6c79 2064 6966 6665 7265 6e74  cantly different
+00010030: 2066 6561 7475 7265 2064 6973 7472 6962   feature distrib
+00010040: 7574 696f 6e2e 0a0a 2020 2020 2020 2020  ution...        
+00010050: 3a65 7861 6d70 6c65 3a0a 2020 2020 2020  :example:.      
+00010060: 2020 3e3e 3e20 6461 7461 203d 206e 702e    >>> data = np.
+00010070: 7261 6e64 6f6d 2e72 616e 6469 6e74 2830  random.randint(0
+00010080: 2c20 3530 2c20 2831 3029 292e 6173 7479  , 50, (10)).asty
+00010090: 7065 286e 702e 666c 6f61 7433 3229 0a20  pe(np.float32). 
+000100a0: 2020 2020 2020 203e 3e3e 2063 7269 7469         >>> criti
+000100b0: 6361 6c5f 7661 6c75 6573 203d 2070 6963  cal_values = pic
+000100c0: 6b6c 652e 6c6f 6164 286f 7065 6e28 2273  kle.load(open("s
+000100d0: 696d 6261 2f61 7373 6574 732f 6c6f 6f6b  imba/assets/look
+000100e0: 7570 732f 6372 6974 6963 616c 5f76 616c  ups/critical_val
+000100f0: 7565 735f 3035 2e70 6963 6b6c 6522 2c20  ues_05.pickle", 
+00010100: 2272 6222 2929 5b27 696e 6465 7065 6e64  "rb"))['independ
+00010110: 656e 745f 745f 7465 7374 275d 5b27 6f6e  ent_t_test']['on
+00010120: 655f 7461 696c 275d 2e76 616c 7565 732e  e_tail'].values.
+00010130: 6173 7479 7065 286e 702e 666c 6f61 7433  astype(np.float3
+00010140: 3229 0a20 2020 2020 2020 203e 3e3e 2072  2).        >>> r
+00010150: 6573 756c 7473 203d 2053 7461 7469 7374  esults = Statist
+00010160: 6963 7328 292e 736c 6964 696e 675f 696e  ics().sliding_in
+00010170: 6465 7065 6e64 656e 745f 7361 6d70 6c65  dependent_sample
+00010180: 735f 7428 6461 7461 3d64 6174 612c 2074  s_t(data=data, t
+00010190: 696d 655f 7769 6e64 6f77 3d30 2e35 2c20  ime_window=0.5, 
+000101a0: 6670 733d 352e 302c 2063 7269 7469 6361  fps=5.0, critica
+000101b0: 6c5f 7661 6c75 6573 3d63 7269 7469 6361  l_values=critica
+000101c0: 6c5f 7661 6c75 6573 2c20 736c 6964 655f  l_values, slide_
+000101d0: 7469 6d65 3d30 2e33 3029 0a20 2020 2020  time=0.30).     
+000101e0: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+000101f0: 7265 7375 6c74 7320 3d20 6e70 2e66 756c  results = np.ful
+00010200: 6c28 2864 6174 612e 7368 6170 655b 305d  l((data.shape[0]
+00010210: 292c 2030 2e30 290a 2020 2020 2020 2020  ), 0.0).        
+00010220: 7769 6e64 6f77 5f73 697a 652c 2073 6c69  window_size, sli
+00010230: 6465 5f73 697a 6520 3d20 696e 7428 7469  de_size = int(ti
+00010240: 6d65 5f77 696e 646f 7720 2a20 6670 7329  me_window * fps)
+00010250: 2c20 696e 7428 736c 6964 655f 7469 6d65  , int(slide_time
+00010260: 202a 2066 7073 290a 2020 2020 2020 2020   * fps).        
+00010270: 666f 7220 6920 696e 2072 616e 6765 2831  for i in range(1
+00010280: 2c20 6461 7461 2e73 6861 7065 5b30 5d29  , data.shape[0])
+00010290: 3a0a 2020 2020 2020 2020 2020 2020 7361  :.            sa
+000102a0: 6d70 6c65 5f31 5f6c 6566 742c 2073 616d  mple_1_left, sam
+000102b0: 706c 655f 315f 7269 6768 7420 3d20 692c  ple_1_right = i,
+000102c0: 2069 202b 2077 696e 646f 775f 7369 7a65   i + window_size
+000102d0: 0a20 2020 2020 2020 2020 2020 2073 616d  .            sam
+000102e0: 706c 655f 325f 6c65 6674 2c20 7361 6d70  ple_2_left, samp
+000102f0: 6c65 5f32 5f72 6967 6874 203d 2028 0a20  le_2_right = (. 
+00010300: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00010310: 616d 706c 655f 315f 6c65 6674 202d 2073  ample_1_left - s
+00010320: 6c69 6465 5f73 697a 652c 0a20 2020 2020  lide_size,.     
+00010330: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
+00010340: 655f 315f 7269 6768 7420 2d20 736c 6964  e_1_right - slid
+00010350: 655f 7369 7a65 2c0a 2020 2020 2020 2020  e_size,.        
+00010360: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00010370: 2020 7361 6d70 6c65 5f31 203d 2064 6174    sample_1 = dat
+00010380: 615b 7361 6d70 6c65 5f31 5f6c 6566 743a  a[sample_1_left:
+00010390: 7361 6d70 6c65 5f31 5f72 6967 6874 5d0a  sample_1_right].
+000103a0: 2020 2020 2020 2020 2020 2020 646f 662c              dof,
+000103b0: 2073 7465 7073 5f74 616b 656e 203d 2028   steps_taken = (
+000103c0: 7361 6d70 6c65 5f31 2e73 6861 7065 5b30  sample_1.shape[0
+000103d0: 5d20 2b20 7361 6d70 6c65 5f31 2e73 6861  ] + sample_1.sha
+000103e0: 7065 5b30 5d29 202d 2032 2c20 310a 2020  pe[0]) - 2, 1.  
+000103f0: 2020 2020 2020 2020 2020 7768 696c 6520            while 
+00010400: 7361 6d70 6c65 5f32 5f6c 6566 7420 3e3d  sample_2_left >=
+00010410: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+00010420: 2020 2020 7361 6d70 6c65 5f32 203d 2064      sample_2 = d
+00010430: 6174 615b 7361 6d70 6c65 5f32 5f6c 6566  ata[sample_2_lef
+00010440: 743a 7361 6d70 6c65 5f32 5f72 6967 6874  t:sample_2_right
+00010450: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00010460: 2020 745f 7374 6174 6973 7469 6320 3d20    t_statistic = 
+00010470: 286e 702e 6d65 616e 2873 616d 706c 655f  (np.mean(sample_
+00010480: 3129 202d 206e 702e 6d65 616e 2873 616d  1) - np.mean(sam
+00010490: 706c 655f 3229 2920 2f20 6e70 2e73 7172  ple_2)) / np.sqr
+000104a0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+000104b0: 2020 2020 2020 2028 6e70 2e73 7464 2873         (np.std(s
+000104c0: 616d 706c 655f 3129 202f 2073 616d 706c  ample_1) / sampl
+000104d0: 655f 312e 7368 6170 655b 305d 290a 2020  e_1.shape[0]).  
+000104e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000104f0: 2020 2b20 286e 702e 7374 6428 7361 6d70    + (np.std(samp
+00010500: 6c65 5f32 2920 2f20 7361 6d70 6c65 5f31  le_2) / sample_1
+00010510: 2e73 6861 7065 5b30 5d29 0a20 2020 2020  .shape[0]).     
+00010520: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00010530: 2020 2020 2020 2020 2020 2020 2063 7269               cri
+00010540: 7469 6361 6c5f 7661 6c20 3d20 6372 6974  tical_val = crit
+00010550: 6963 616c 5f76 616c 7565 735b 646f 6620  ical_values[dof 
+00010560: 2d20 315d 5b31 5d0a 2020 2020 2020 2020  - 1][1].        
+00010570: 2020 2020 2020 2020 6966 2074 5f73 7461          if t_sta
+00010580: 7469 7374 6963 203e 3d20 6372 6974 6963  tistic >= critic
+00010590: 616c 5f76 616c 3a0a 2020 2020 2020 2020  al_val:.        
+000105a0: 2020 2020 2020 2020 2020 2020 6272 6561              brea
+000105b0: 6b0a 2020 2020 2020 2020 2020 2020 2020  k.              
+000105c0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000105d0: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
+000105e0: 6c65 5f32 5f6c 6566 7420 2d3d 2031 0a20  le_2_left -= 1. 
+000105f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010600: 2020 2073 616d 706c 655f 325f 7269 6768     sample_2_righ
+00010610: 7420 2d3d 2031 0a20 2020 2020 2020 2020  t -= 1.         
+00010620: 2020 2020 2020 2020 2020 2073 7465 7073             steps
+00010630: 5f74 616b 656e 202b 3d20 310a 2020 2020  _taken += 1.    
+00010640: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00010650: 616d 706c 655f 325f 6c65 6674 203c 2030  ample_2_left < 0
+00010660: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00010670: 2020 2020 2020 7374 6570 735f 7461 6b65        steps_take
+00010680: 6e20 3d20 2d31 0a20 2020 2020 2020 2020  n = -1.         
+00010690: 2020 2069 6620 7374 6570 735f 7461 6b65     if steps_take
+000106a0: 6e20 3d3d 202d 313a 0a20 2020 2020 2020  n == -1:.       
+000106b0: 2020 2020 2020 2020 2072 6573 756c 7473           results
+000106c0: 5b69 202b 2077 696e 646f 775f 7369 7a65  [i + window_size
+000106d0: 5d20 3d20 2d31 0a20 2020 2020 2020 2020  ] = -1.         
+000106e0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+000106f0: 2020 2020 2020 2020 2072 6573 756c 7473           results
+00010700: 5b69 202b 2077 696e 646f 775f 7369 7a65  [i + window_size
+00010710: 5d20 3d20 7374 6570 735f 7461 6b65 6e20  ] = steps_taken 
+00010720: 2a20 736c 6964 655f 7469 6d65 0a0a 2020  * slide_time..  
+00010730: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+00010740: 756c 7473 0a0a 2020 2020 4073 7461 7469  ults..    @stati
+00010750: 636d 6574 686f 640a 2020 2020 406e 6a69  cmethod.    @nji
+00010760: 7428 2228 666c 6f61 7433 325b 3a5d 2c20  t("(float32[:], 
+00010770: 666c 6f61 7436 345b 3a5d 2c20 666c 6f61  float64[:], floa
+00010780: 7433 3229 2229 0a20 2020 2064 6566 2072  t32)").    def r
+00010790: 6f6c 6c69 6e67 5f6d 616e 6e5f 7768 6974  olling_mann_whit
+000107a0: 6e65 7928 6461 7461 3a20 6e70 2e6e 6461  ney(data: np.nda
+000107b0: 7272 6179 2c20 7469 6d65 5f77 696e 646f  rray, time_windo
+000107c0: 7773 3a20 6e70 2e6e 6461 7272 6179 2c20  ws: np.ndarray, 
+000107d0: 6670 733a 2066 6c6f 6174 293a 0a20 2020  fps: float):.   
+000107e0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000107f0: 204a 6974 7465 6420 636f 6d70 7574 6520   Jitted compute 
+00010800: 6f66 2072 6f6c 6c69 6e67 204d 616e 6e2d  of rolling Mann-
+00010810: 5768 6974 6e65 7920 5520 636f 6d70 6172  Whitney U compar
+00010820: 696e 6720 7468 6520 6375 7272 656e 7420  ing the current 
+00010830: 7469 6d65 2d77 696e 646f 7720 6f66 0a20  time-window of. 
+00010840: 2020 2020 2020 2073 697a 6520 4e20 746f         size N to
+00010850: 2074 6865 2070 7265 6365 6469 6e67 2077   the preceding w
+00010860: 696e 646f 7720 6f66 2073 697a 6520 4e2e  indow of size N.
+00010870: 0a0a 2020 2020 2020 2020 2e2e 206e 6f74  ..        .. not
+00010880: 653a 3a0a 2020 2020 2020 2020 2020 2046  e::.           F
+00010890: 6972 7374 2074 696d 6520 6269 6e20 2877  irst time bin (w
+000108a0: 6865 7265 2068 6173 206e 6f20 7072 6563  here has no prec
+000108b0: 6564 696e 6720 7469 6d65 2062 696e 2920  eding time bin) 
+000108c0: 7769 6c6c 2068 6176 6520 6669 6c6c 2076  will have fill v
+000108d0: 616c 7565 2060 6030 6060 0a0a 2020 2020  alue ``0``..    
+000108e0: 2020 2020 2020 2060 4d6f 6469 6669 6564         `Modified
+000108f0: 2066 726f 6d20 4a61 6d65 7320 5765 6262   from James Webb
+00010900: 6572 2067 6973 7420 3c68 7474 7073 3a2f  er gist <https:/
+00010910: 2f67 6973 742e 6769 7468 7562 2e63 6f6d  /gist.github.com
+00010920: 2f6a 616d 6573 7477 6562 6265 722f 3338  /jamestwebber/38
+00010930: 6162 3236 6432 3831 6639 3766 6562 3831  ab26d281f97feb81
+00010940: 3936 6233 6439 3365 6465 6562 3762 3e60  96b3d93edeeb7b>`
+00010950: 5f5f 2e0a 0a20 2020 2020 2020 203a 7061  __...        :pa
+00010960: 7261 6d65 7465 7220 6e64 6172 7261 7920  rameter ndarray 
+00010970: 7361 6d70 6c65 5f31 3a20 4669 7273 7420  sample_1: First 
+00010980: 3164 2061 7272 6179 2072 6570 7265 7365  1d array represe
+00010990: 6e74 696e 6720 6665 6174 7572 6520 7661  nting feature va
+000109a0: 6c75 6573 2e0a 2020 2020 2020 2020 3a70  lues..        :p
+000109b0: 6172 616d 6574 6572 206e 6461 7272 6179  arameter ndarray
+000109c0: 2073 616d 706c 655f 323a 2053 6563 6f6e   sample_2: Secon
+000109d0: 6420 3164 2061 7272 6179 2072 6570 7265  d 1d array repre
+000109e0: 7365 6e74 696e 6720 6665 6174 7572 6520  senting feature 
+000109f0: 7661 6c75 6573 2e0a 2020 2020 2020 2020  values..        
+00010a00: 3a72 6574 7572 6e73 206e 702e 6e64 6172  :returns np.ndar
+00010a10: 7261 793a 204d 616e 6e2d 5768 6974 6e65  ray: Mann-Whitne
+00010a20: 7920 5520 6461 7461 206f 6620 7369 7a65  y U data of size
+00010a30: 206c 656e 2864 6174 6129 2078 206c 656e   len(data) x len
+00010a40: 2874 696d 655f 7769 6e64 6f77 7329 2e0a  (time_windows)..
+00010a50: 0a20 2020 2020 2020 203a 6578 616d 706c  .        :exampl
+00010a60: 6573 3a0a 2020 2020 2020 2020 3e3e 3e20  es:.        >>> 
+00010a70: 6461 7461 203d 206e 702e 7261 6e64 6f6d  data = np.random
+00010a80: 2e72 616e 6469 6e74 2830 2c20 342c 2028  .randint(0, 4, (
+00010a90: 3230 3029 292e 6173 7479 7065 286e 702e  200)).astype(np.
+00010aa0: 666c 6f61 7433 3229 0a20 2020 2020 2020  float32).       
+00010ab0: 203e 3e3e 2072 6573 756c 7473 203d 2053   >>> results = S
+00010ac0: 7461 7469 7374 6963 7328 292e 726f 6c6c  tatistics().roll
+00010ad0: 696e 675f 6d61 6e6e 5f77 6869 746e 6579  ing_mann_whitney
+00010ae0: 2864 6174 613d 6461 7461 2c20 7469 6d65  (data=data, time
+00010af0: 5f77 696e 646f 7773 3d6e 702e 6172 7261  _windows=np.arra
+00010b00: 7928 5b31 2e30 5d29 2c20 6670 733d 3129  y([1.0]), fps=1)
+00010b10: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+00010b20: 2020 2020 2020 7265 7375 6c74 7320 3d20        results = 
+00010b30: 6e70 2e66 756c 6c28 2864 6174 612e 7368  np.full((data.sh
+00010b40: 6170 655b 305d 2c20 7469 6d65 5f77 696e  ape[0], time_win
+00010b50: 646f 7773 2e73 6861 7065 5b30 5d29 2c20  dows.shape[0]), 
+00010b60: 302e 3029 0a20 2020 2020 2020 2066 6f72  0.0).        for
+00010b70: 2069 2069 6e20 7072 616e 6765 2874 696d   i in prange(tim
+00010b80: 655f 7769 6e64 6f77 732e 7368 6170 655b  e_windows.shape[
+00010b90: 305d 293a 0a20 2020 2020 2020 2020 2020  0]):.           
+00010ba0: 2077 696e 646f 775f 7369 7a65 203d 2069   window_size = i
+00010bb0: 6e74 2874 696d 655f 7769 6e64 6f77 735b  nt(time_windows[
+00010bc0: 695d 202a 2066 7073 290a 2020 2020 2020  i] * fps).      
+00010bd0: 2020 2020 2020 6461 7461 5f73 706c 6974        data_split
+00010be0: 203d 206e 702e 7370 6c69 7428 0a20 2020   = np.split(.   
+00010bf0: 2020 2020 2020 2020 2020 2020 2064 6174               dat
+00010c00: 612c 206c 6973 7428 7261 6e67 6528 7769  a, list(range(wi
+00010c10: 6e64 6f77 5f73 697a 652c 2064 6174 612e  ndow_size, data.
+00010c20: 7368 6170 655b 305d 2c20 7769 6e64 6f77  shape[0], window
+00010c30: 5f73 697a 6529 290a 2020 2020 2020 2020  _size)).        
+00010c40: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00010c50: 2020 666f 7220 6a20 696e 2070 7261 6e67    for j in prang
+00010c60: 6528 312c 206c 656e 2864 6174 615f 7370  e(1, len(data_sp
+00010c70: 6c69 7429 293a 0a20 2020 2020 2020 2020  lit)):.         
+00010c80: 2020 2020 2020 2077 696e 646f 775f 7374         window_st
+00010c90: 6172 7420 3d20 696e 7428 7769 6e64 6f77  art = int(window
+00010ca0: 5f73 697a 6520 2a20 6a29 0a20 2020 2020  _size * j).     
+00010cb0: 2020 2020 2020 2020 2020 2077 696e 646f             windo
+00010cc0: 775f 656e 6420 3d20 696e 7428 7769 6e64  w_end = int(wind
+00010cd0: 6f77 5f73 7461 7274 202b 2077 696e 646f  ow_start + windo
+00010ce0: 775f 7369 7a65 290a 2020 2020 2020 2020  w_size).        
+00010cf0: 2020 2020 2020 2020 7361 6d70 6c65 5f31          sample_1
+00010d00: 2c20 7361 6d70 6c65 5f32 203d 2064 6174  , sample_2 = dat
+00010d10: 615f 7370 6c69 745b 6a20 2d20 315d 2e61  a_split[j - 1].a
+00010d20: 7374 7970 6528 6e70 2e66 6c6f 6174 3332  stype(np.float32
+00010d30: 292c 2064 6174 615f 7370 6c69 745b 0a20  ), data_split[. 
+00010d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010d50: 2020 206a 0a20 2020 2020 2020 2020 2020     j.           
+00010d60: 2020 2020 205d 2e61 7374 7970 6528 6e70       ].astype(np
+00010d70: 2e66 6c6f 6174 3332 290a 2020 2020 2020  .float32).      
+00010d80: 2020 2020 2020 2020 2020 6e31 2c20 6e32            n1, n2
+00010d90: 203d 2073 616d 706c 655f 312e 7368 6170   = sample_1.shap
+00010da0: 655b 305d 2c20 7361 6d70 6c65 5f32 2e73  e[0], sample_2.s
+00010db0: 6861 7065 5b30 5d0a 2020 2020 2020 2020  hape[0].        
+00010dc0: 2020 2020 2020 2020 7261 6e6b 6564 203d          ranked =
+00010dd0: 2066 6173 745f 6d65 616e 5f72 616e 6b28   fast_mean_rank(
+00010de0: 6e70 2e63 6f6e 6361 7465 6e61 7465 2828  np.concatenate((
+00010df0: 7361 6d70 6c65 5f31 2c20 7361 6d70 6c65  sample_1, sample
+00010e00: 5f32 2929 290a 2020 2020 2020 2020 2020  _2))).          
+00010e10: 2020 2020 2020 7531 203d 206e 3120 2a20        u1 = n1 * 
+00010e20: 6e32 202b 2028 6e31 202a 2028 6e31 202b  n2 + (n1 * (n1 +
+00010e30: 2031 2929 202f 2032 2e30 202d 206e 702e   1)) / 2.0 - np.
+00010e40: 7375 6d28 7261 6e6b 6564 5b3a 6e31 5d2c  sum(ranked[:n1],
+00010e50: 2061 7869 733d 3029 0a20 2020 2020 2020   axis=0).       
+00010e60: 2020 2020 2020 2020 2075 3220 3d20 6e31           u2 = n1
+00010e70: 202a 206e 3220 2d20 7531 0a20 2020 2020   * n2 - u1.     
+00010e80: 2020 2020 2020 2020 2020 2075 203d 206d             u = m
+00010e90: 696e 2875 312c 2075 3229 0a20 2020 2020  in(u1, u2).     
+00010ea0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+00010eb0: 7473 5b77 696e 646f 775f 7374 6172 743a  ts[window_start:
+00010ec0: 7769 6e64 6f77 5f65 6e64 2c20 695d 203d  window_end, i] =
+00010ed0: 2075 0a0a 2020 2020 2020 2020 7265 7475   u..        retu
+00010ee0: 726e 2072 6573 756c 7473 0a0a 2020 2020  rn results..    
+00010ef0: 6465 6620 6368 6f77 5f74 6573 7428 7365  def chow_test(se
+00010f00: 6c66 293a 0a20 2020 2020 2020 2070 6173  lf):.        pas
+00010f10: 730a 0a20 2020 2040 7374 6174 6963 6d65  s..    @staticme
+00010f20: 7468 6f64 0a20 2020 2040 6e6a 6974 2822  thod.    @njit("
+00010f30: 2866 6c6f 6174 3332 5b3a 5d2c 2066 6c6f  (float32[:], flo
+00010f40: 6174 3332 5b3a 5d2c 2066 6c6f 6174 3634  at32[:], float64
+00010f50: 5b3a 5d2c 2069 6e74 3634 2922 290a 2020  [:], int64)").  
+00010f60: 2020 6465 6620 736c 6964 696e 675f 7370    def sliding_sp
+00010f70: 6561 726d 616e 5f72 616e 6b5f 636f 7272  earman_rank_corr
+00010f80: 656c 6174 696f 6e28 0a20 2020 2020 2020  elation(.       
+00010f90: 2073 616d 706c 655f 313a 206e 702e 6e64   sample_1: np.nd
+00010fa0: 6172 7261 792c 2073 616d 706c 655f 323a  array, sample_2:
+00010fb0: 206e 702e 6e64 6172 7261 792c 2074 696d   np.ndarray, tim
+00010fc0: 655f 7769 6e64 6f77 733a 206e 702e 6e64  e_windows: np.nd
+00010fd0: 6172 7261 792c 2066 7073 3a20 696e 740a  array, fps: int.
+00010fe0: 2020 2020 2920 2d3e 206e 702e 6e64 6172      ) -> np.ndar
+00010ff0: 7261 793a 0a20 2020 2020 2020 2022 2222  ray:.        """
+00011000: 0a20 2020 2020 2020 2047 6976 656e 2074  .        Given t
+00011010: 776f 2031 4420 6172 7261 7973 206f 6620  wo 1D arrays of 
+00011020: 7369 7a65 204e 2c20 6372 6561 7465 2073  size N, create s
+00011030: 6c69 6469 6e67 2077 696e 646f 7720 6f66  liding window of
+00011040: 2073 697a 6520 7469 6d65 5f77 696e 646f   size time_windo
+00011050: 7773 5b69 5d20 2a20 6670 7320 616e 6420  ws[i] * fps and 
+00011060: 7265 7475 726e 2053 7065 6172 6d61 6e27  return Spearman'
+00011070: 7320 7261 6e6b 2063 6f72 7265 6c61 7469  s rank correlati
+00011080: 6f6e 0a20 2020 2020 2020 2062 6574 7765  on.        betwe
+00011090: 656e 2074 6865 2076 616c 7565 7320 696e  en the values in
+000110a0: 2074 6865 2074 776f 2031 4420 6172 7261   the two 1D arra
+000110b0: 7973 2069 6e20 6561 6368 2077 696e 646f  ys in each windo
+000110c0: 772e 2041 6464 7265 7373 2022 7768 6174  w. Address "what
+000110d0: 2069 7320 7468 6520 636f 7272 656c 6174   is the correlat
+000110e0: 696f 6e20 6265 7477 6565 6e20 4665 6174  ion between Feat
+000110f0: 7572 6520 3120 616e 640a 2020 2020 2020  ure 1 and.      
+00011100: 2020 4665 6174 7572 6520 3220 696e 2074    Feature 2 in t
+00011110: 6865 2063 7572 7265 6e74 2058 2e58 2073  he current X.X s
+00011120: 6563 6f6e 6473 206f 6620 7468 6520 7669  econds of the vi
+00011130: 6465 6f2e 0a0a 2020 2020 2020 2020 2e2e  deo...        ..
+00011140: 2069 6d61 6765 3a3a 205f 7374 6174 6963   image:: _static
+00011150: 2f69 6d67 2f73 6c69 6469 6e67 5f73 7065  /img/sliding_spe
+00011160: 6172 6d61 6e2e 706e 670a 2020 2020 2020  arman.png.      
+00011170: 2020 2020 203a 7769 6474 683a 2036 3030       :width: 600
+00011180: 0a20 2020 2020 2020 2020 2020 3a61 6c69  .           :ali
+00011190: 676e 3a20 6365 6e74 6572 0a0a 2020 2020  gn: center..    
+000111a0: 2020 2020 3a70 6172 616d 6574 6572 206e      :parameter n
+000111b0: 6461 7272 6179 2073 616d 706c 655f 313a  darray sample_1:
+000111c0: 2046 6972 7374 2031 4420 6172 7261 7920   First 1D array 
+000111d0: 7769 7468 2066 6561 7475 7265 2076 616c  with feature val
+000111e0: 7565 732e 0a20 2020 2020 2020 203a 7061  ues..        :pa
+000111f0: 7261 6d65 7465 7220 6e64 6172 7261 7920  rameter ndarray 
+00011200: 7361 6d70 6c65 5f31 3a20 5365 636f 6e64  sample_1: Second
+00011210: 2031 4420 6172 7261 7920 7769 7468 2066   1D array with f
+00011220: 6561 7475 7265 2076 616c 7565 732e 0a20  eature values.. 
+00011230: 2020 2020 2020 203a 7061 7261 6d65 7465         :paramete
+00011240: 7220 666c 6f61 7420 7469 6d65 5f77 696e  r float time_win
+00011250: 646f 7773 3a20 5468 6520 6c65 6e67 7468  dows: The length
+00011260: 206f 6620 7468 6520 736c 6964 696e 6720   of the sliding 
+00011270: 7769 6e64 6f77 2069 6e20 7365 636f 6e64  window in second
+00011280: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
+00011290: 6d65 7465 7220 696e 7420 6670 733a 2054  meter int fps: T
+000112a0: 6865 2066 7073 206f 6620 7468 6520 7265  he fps of the re
+000112b0: 636f 7264 6564 2076 6964 656f 2e0a 2020  corded video..  
+000112c0: 2020 2020 2020 3a72 6574 7572 6e73 206e        :returns n
+000112d0: 702e 6e64 6172 7261 793a 2032 6420 6172  p.ndarray: 2d ar
+000112e0: 7261 7920 6f66 2053 6f65 6172 6d61 6e27  ray of Soearman'
+000112f0: 7320 7261 6e6b 7320 6f66 2073 697a 6520  s ranks of size 
+00011300: 6c65 6e28 7361 6d70 6c65 5f31 2920 7820  len(sample_1) x 
+00011310: 6c65 6e28 7469 6d65 5f77 696e 646f 7773  len(time_windows
+00011320: 292e 204e 6f74 652c 2069 6620 736c 6964  ). Note, if slid
+00011330: 696e 6720 7769 6e64 6f77 2069 7320 3130  ing window is 10
+00011340: 2066 7261 6d65 732c 2074 6865 2066 6972   frames, the fir
+00011350: 7374 2039 2065 6e74 7269 6573 2077 696c  st 9 entries wil
+00011360: 6c20 6265 2066 696c 6c65 6420 7769 7468  l be filled with
+00011370: 2030 2e20 5468 6520 3130 7468 2076 616c   0. The 10th val
+00011380: 7565 2072 6570 7265 7365 6e74 7320 7468  ue represents th
+00011390: 6520 636f 7272 656c 6174 696f 6e20 696e  e correlation in
+000113a0: 2074 6865 2066 6972 7374 2031 3020 6672   the first 10 fr
+000113b0: 616d 6573 2e0a 0a20 2020 2020 2020 203a  ames...        :
+000113c0: 6578 616d 706c 653a 0a20 2020 2020 2020  example:.       
+000113d0: 203e 3e3e 2073 616d 706c 655f 3120 3d20   >>> sample_1 = 
+000113e0: 6e70 2e61 7272 6179 285b 392c 3130 2c31  np.array([9,10,1
+000113f0: 332c 3232 2c31 352c 3138 2c31 352c 3139  3,22,15,18,15,19
+00011400: 2c33 322c 3131 5d29 2e61 7374 7970 6528  ,32,11]).astype(
+00011410: 6e70 2e66 6c6f 6174 3332 290a 2020 2020  np.float32).    
+00011420: 2020 2020 3e3e 3e20 7361 6d70 6c65 5f32      >>> sample_2
+00011430: 203d 206e 702e 6172 7261 7928 5b31 312c   = np.array([11,
+00011440: 2031 322c 2031 352c 2031 392c 2032 312c   12, 15, 19, 21,
+00011450: 2032 362c 2031 392c 2032 302c 2032 322c   26, 19, 20, 22,
+00011460: 2031 395d 292e 6173 7479 7065 286e 702e   19]).astype(np.
+00011470: 666c 6f61 7433 3229 0a20 2020 2020 2020  float32).       
+00011480: 203e 3e3e 2053 7461 7469 7374 6963 7328   >>> Statistics(
+00011490: 292e 736c 6964 696e 675f 7370 6561 726d  ).sliding_spearm
+000114a0: 616e 5f72 616e 6b5f 636f 7272 656c 6174  an_rank_correlat
+000114b0: 696f 6e28 7361 6d70 6c65 5f31 3d73 616d  ion(sample_1=sam
+000114c0: 706c 655f 312c 2073 616d 706c 655f 323d  ple_1, sample_2=
+000114d0: 7361 6d70 6c65 5f32 2c20 7469 6d65 5f77  sample_2, time_w
+000114e0: 696e 646f 7773 3d6e 702e 6172 7261 7928  indows=np.array(
+000114f0: 5b30 2e35 5d29 2c20 6670 733d 3130 290a  [0.5]), fps=10).
+00011500: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
+00011510: 2020 2020 2072 6573 756c 7473 203d 206e       results = n
+00011520: 702e 6675 6c6c 2828 7361 6d70 6c65 5f31  p.full((sample_1
+00011530: 2e73 6861 7065 5b30 5d2c 2074 696d 655f  .shape[0], time_
+00011540: 7769 6e64 6f77 732e 7368 6170 655b 305d  windows.shape[0]
+00011550: 292c 2030 2e30 290a 2020 2020 2020 2020  ), 0.0).        
+00011560: 666f 7220 6920 696e 2070 7261 6e67 6528  for i in prange(
+00011570: 7469 6d65 5f77 696e 646f 7773 2e73 6861  time_windows.sha
+00011580: 7065 5b30 5d29 3a0a 2020 2020 2020 2020  pe[0]):.        
+00011590: 2020 2020 7769 6e64 6f77 5f73 697a 6520      window_size 
+000115a0: 3d20 696e 7428 7469 6d65 5f77 696e 646f  = int(time_windo
+000115b0: 7773 5b69 5d20 2a20 6670 7329 0a20 2020  ws[i] * fps).   
+000115c0: 2020 2020 2020 2020 2066 6f72 206c 6566           for lef
+000115d0: 742c 2072 6967 6874 2069 6e20 7a69 7028  t, right in zip(
+000115e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000115f0: 2070 7261 6e67 6528 302c 2073 616d 706c   prange(0, sampl
+00011600: 655f 312e 7368 6170 655b 305d 202b 2031  e_1.shape[0] + 1
+00011610: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00011620: 2020 2070 7261 6e67 6528 7769 6e64 6f77     prange(window
+00011630: 5f73 697a 652c 2073 616d 706c 655f 312e  _size, sample_1.
+00011640: 7368 6170 655b 305d 202b 2031 292c 0a20  shape[0] + 1),. 
+00011650: 2020 2020 2020 2020 2020 2029 3a0a 2020             ):.  
+00011660: 2020 2020 2020 2020 2020 2020 2020 7331                s1
+00011670: 2c20 7332 203d 2073 616d 706c 655f 315b  , s2 = sample_1[
+00011680: 6c65 6674 3a72 6967 6874 5d2c 2073 616d  left:right], sam
+00011690: 706c 655f 325b 6c65 6674 3a72 6967 6874  ple_2[left:right
+000116a0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+000116b0: 2020 7261 6e6b 5f78 2c20 7261 6e6b 5f79    rank_x, rank_y
+000116c0: 203d 206e 702e 6172 6773 6f72 7428 6e70   = np.argsort(np
+000116d0: 2e61 7267 736f 7274 2873 3129 292c 206e  .argsort(s1)), n
+000116e0: 702e 6172 6773 6f72 7428 6e70 2e61 7267  p.argsort(np.arg
+000116f0: 736f 7274 2873 3229 290a 2020 2020 2020  sort(s2)).      
+00011700: 2020 2020 2020 2020 2020 645f 7371 7561            d_squa
+00011710: 7265 6420 3d20 6e70 2e73 756d 2828 7261  red = np.sum((ra
+00011720: 6e6b 5f78 202d 2072 616e 6b5f 7929 202a  nk_x - rank_y) *
+00011730: 2a20 3229 0a20 2020 2020 2020 2020 2020  * 2).           
+00011740: 2020 2020 2073 203d 2031 202d 2028 3620       s = 1 - (6 
+00011750: 2a20 645f 7371 7561 7265 6429 202f 2028  * d_squared) / (
+00011760: 6c65 6e28 7331 2920 2a20 286c 656e 2873  len(s1) * (len(s
+00011770: 3229 202a 2a20 3220 2d20 3129 290a 2020  2) ** 2 - 1)).  
+00011780: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00011790: 7375 6c74 735b 7269 6768 7420 2d20 312c  sults[right - 1,
+000117a0: 2069 5d20 3d20 730a 0a20 2020 2020 2020   i] = s..       
+000117b0: 2072 6574 7572 6e20 7265 7375 6c74 730a   return results.
+000117c0: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
+000117d0: 6f64 0a20 2020 2040 6e6a 6974 2822 2866  od.    @njit("(f
+000117e0: 6c6f 6174 3332 5b3a 5d2c 2066 6c6f 6174  loat32[:], float
+000117f0: 3634 2c20 666c 6f61 7436 342c 2066 6c6f  64, float64, flo
+00011800: 6174 3634 2922 290a 2020 2020 6465 6620  at64)").    def 
+00011810: 736c 6964 696e 675f 6175 746f 636f 7272  sliding_autocorr
+00011820: 656c 6174 696f 6e28 0a20 2020 2020 2020  elation(.       
+00011830: 2064 6174 613a 206e 702e 6e64 6172 7261   data: np.ndarra
+00011840: 792c 206d 6178 5f6c 6167 3a20 666c 6f61  y, max_lag: floa
+00011850: 742c 2074 696d 655f 7769 6e64 6f77 3a20  t, time_window: 
+00011860: 666c 6f61 742c 2066 7073 3a20 666c 6f61  float, fps: floa
+00011870: 740a 2020 2020 293a 0a20 2020 2020 2020  t.    ):.       
+00011880: 2022 2222 0a20 2020 2020 2020 204a 6974   """.        Jit
+00011890: 7465 6420 636f 6d70 7574 6520 6f66 2073  ted compute of s
+000118a0: 6c69 6469 6e67 2061 7574 6f2d 636f 7272  liding auto-corr
+000118b0: 656c 6174 696f 6e73 2028 7468 6520 636f  elations (the co
+000118c0: 7272 656c 6174 696f 6e20 6f66 2061 2066  rrelation of a f
+000118d0: 6561 7475 7265 2077 6974 6820 6974 7365  eature with itse
+000118e0: 6c66 2075 7369 6e67 206c 6167 6765 6420  lf using lagged 
+000118f0: 7769 6e64 6f77 7329 2e0a 0a20 2020 2020  windows)...     
+00011900: 2020 203a 6578 616d 706c 653a 0a20 2020     :example:.   
+00011910: 2020 2020 203e 3e3e 2064 6174 6120 3d20       >>> data = 
+00011920: 6e70 2e61 7272 6179 285b 302c 312c 322c  np.array([0,1,2,
+00011930: 332c 342c 2035 2c36 2c37 2c38 2c31 2c31  3,4, 5,6,7,8,1,1
+00011940: 302c 3131 2c31 322c 3133 2c31 345d 292e  0,11,12,13,14]).
+00011950: 6173 7479 7065 286e 702e 666c 6f61 7433  astype(np.float3
+00011960: 3229 0a20 2020 2020 2020 203e 3e3e 2053  2).        >>> S
+00011970: 7461 7469 7374 6963 7328 292e 736c 6964  tatistics().slid
+00011980: 696e 675f 6175 746f 636f 7272 656c 6174  ing_autocorrelat
+00011990: 696f 6e28 6461 7461 3d64 6174 612c 206d  ion(data=data, m
+000119a0: 6178 5f6c 6167 3d30 2e35 2c20 7469 6d65  ax_lag=0.5, time
+000119b0: 5f77 696e 646f 773d 312e 302c 2066 7073  _window=1.0, fps
+000119c0: 3d31 3029 0a20 2020 2020 2020 203e 3e3e  =10).        >>>
+000119d0: 205b 2030 2e2c 2030 2e2c 2030 2e2c 2020   [ 0., 0., 0.,  
+000119e0: 302e 2c20 2030 2e2c 2030 2e2c 2030 2e2c  0.,  0., 0., 0.,
+000119f0: 2020 302e 202c 2020 302e 2c20 2d33 2e36    0. ,  0., -3.6
+00011a00: 3836 2c20 2d32 2e30 3239 2c20 2d31 2e33  86, -2.029, -1.3
+00011a10: 3233 2c20 2d31 2e37 3533 2c20 2d33 2e38  23, -1.753, -3.8
+00011a20: 3037 2c20 2d34 2e36 3334 5d0a 2020 2020  07, -4.634].    
+00011a30: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+00011a40: 206d 6178 5f66 726d 5f6c 6167 2c20 7469   max_frm_lag, ti
+00011a50: 6d65 5f77 696e 646f 775f 6672 6d73 203d  me_window_frms =
+00011a60: 2069 6e74 286d 6178 5f6c 6167 202a 2066   int(max_lag * f
+00011a70: 7073 292c 2069 6e74 2874 696d 655f 7769  ps), int(time_wi
+00011a80: 6e64 6f77 202a 2066 7073 290a 2020 2020  ndow * fps).    
+00011a90: 2020 2020 7265 7375 6c74 7320 3d20 6e70      results = np
+00011aa0: 2e66 756c 6c28 2864 6174 612e 7368 6170  .full((data.shap
+00011ab0: 655b 305d 292c 202d 312e 3029 0a20 2020  e[0]), -1.0).   
+00011ac0: 2020 2020 2066 6f72 2072 6967 6874 2069       for right i
+00011ad0: 6e20 7072 616e 6765 2874 696d 655f 7769  n prange(time_wi
+00011ae0: 6e64 6f77 5f66 726d 7320 2d20 312c 2064  ndow_frms - 1, d
+00011af0: 6174 612e 7368 6170 655b 305d 293a 0a20  ata.shape[0]):. 
+00011b00: 2020 2020 2020 2020 2020 206c 6566 7420             left 
+00011b10: 3d20 7269 6768 7420 2d20 7469 6d65 5f77  = right - time_w
+00011b20: 696e 646f 775f 6672 6d73 202b 2031 0a20  indow_frms + 1. 
+00011b30: 2020 2020 2020 2020 2020 2077 5f64 6174             w_dat
+00011b40: 6120 3d20 6461 7461 5b6c 6566 7420 3a20  a = data[left : 
+00011b50: 7269 6768 7420 2b20 315d 0a20 2020 2020  right + 1].     
+00011b60: 2020 2020 2020 2063 6f72 7263 6673 203d         corrcfs =
+00011b70: 206e 702e 6675 6c6c 2828 6d61 785f 6672   np.full((max_fr
+00011b80: 6d5f 6c61 6729 2c20 6e70 2e6e 616e 290a  m_lag), np.nan).
+00011b90: 2020 2020 2020 2020 2020 2020 636f 7272              corr
+00011ba0: 6366 735b 305d 203d 2031 0a20 2020 2020  cfs[0] = 1.     
+00011bb0: 2020 2020 2020 2066 6f72 2073 6869 6674         for shift
+00011bc0: 2069 6e20 7261 6e67 6528 312c 206d 6178   in range(1, max
+00011bd0: 5f66 726d 5f6c 6167 293a 0a20 2020 2020  _frm_lag):.     
+00011be0: 2020 2020 2020 2020 2020 2063 203d 206e             c = n
+00011bf0: 702e 636f 7272 636f 6566 2877 5f64 6174  p.corrcoef(w_dat
+00011c00: 615b 3a2d 7368 6966 745d 2c20 775f 6461  a[:-shift], w_da
+00011c10: 7461 5b73 6869 6674 3a5d 295b 305d 5b31  ta[shift:])[0][1
+00011c20: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00011c30: 2020 6966 206e 702e 6973 6e61 6e28 6329    if np.isnan(c)
+00011c40: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00011c50: 2020 2020 2020 636f 7272 6366 735b 7368        corrcfs[sh
+00011c60: 6966 745d 203d 2031 0a20 2020 2020 2020  ift] = 1.       
+00011c70: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00011c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011c90: 2020 2063 6f72 7263 6673 5b73 6869 6674     corrcfs[shift
+00011ca0: 5d20 3d20 6e70 2e63 6f72 7263 6f65 6628  ] = np.corrcoef(
+00011cb0: 775f 6461 7461 5b3a 2d73 6869 6674 5d2c  w_data[:-shift],
+00011cc0: 2077 5f64 6174 615b 7368 6966 743a 5d29   w_data[shift:])
+00011cd0: 5b30 5d5b 315d 0a20 2020 2020 2020 2020  [0][1].         
+00011ce0: 2020 206d 6174 5f20 3d20 6e70 2e7a 6572     mat_ = np.zer
+00011cf0: 6f73 2873 6861 7065 3d28 636f 7272 6366  os(shape=(corrcf
+00011d00: 732e 7368 6170 655b 305d 2c20 3229 290a  s.shape[0], 2)).
+00011d10: 2020 2020 2020 2020 2020 2020 636f 6e73              cons
+00011d20: 7420 3d20 6e70 2e6f 6e65 735f 6c69 6b65  t = np.ones_like
+00011d30: 2863 6f72 7263 6673 290a 2020 2020 2020  (corrcfs).      
+00011d40: 2020 2020 2020 6d61 745f 5b3a 2c20 305d        mat_[:, 0]
+00011d50: 203d 2063 6f6e 7374 0a20 2020 2020 2020   = const.       
+00011d60: 2020 2020 206d 6174 5f5b 3a2c 2031 5d20       mat_[:, 1] 
+00011d70: 3d20 636f 7272 6366 730a 2020 2020 2020  = corrcfs.      
+00011d80: 2020 2020 2020 6465 745f 203d 206e 702e        det_ = np.
+00011d90: 6c69 6e61 6c67 2e6c 7374 7371 280a 2020  linalg.lstsq(.  
+00011da0: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
+00011db0: 745f 2e61 7374 7970 6528 6e70 2e66 6c6f  t_.astype(np.flo
+00011dc0: 6174 3332 292c 206e 702e 6172 616e 6765  at32), np.arange
+00011dd0: 2830 2c20 6d61 785f 6672 6d5f 6c61 6729  (0, max_frm_lag)
+00011de0: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
+00011df0: 3332 290a 2020 2020 2020 2020 2020 2020  32).            
+00011e00: 295b 305d 0a20 2020 2020 2020 2020 2020  )[0].           
+00011e10: 2072 6573 756c 7473 5b72 6967 6874 5d20   results[right] 
+00011e20: 3d20 6465 745f 5b3a 3a2d 315d 5b30 5d0a  = det_[::-1][0].
+00011e30: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+00011e40: 6573 756c 7473 0a0a 2020 2020 4073 7461  esults..    @sta
+00011e50: 7469 636d 6574 686f 640a 2020 2020 6465  ticmethod.    de
+00011e60: 6620 736c 6964 696e 675f 646f 6d69 6e61  f sliding_domina
+00011e70: 6e74 5f66 7265 7175 656e 6369 6573 280a  nt_frequencies(.
+00011e80: 2020 2020 2020 2020 6461 7461 3a20 6e70          data: np
+00011e90: 2e6e 6461 7272 6179 2c0a 2020 2020 2020  .ndarray,.      
+00011ea0: 2020 6670 733a 2066 6c6f 6174 2c0a 2020    fps: float,.  
+00011eb0: 2020 2020 2020 6b3a 2069 6e74 2c0a 2020        k: int,.  
+00011ec0: 2020 2020 2020 7469 6d65 5f77 696e 646f        time_windo
+00011ed0: 7773 3a20 6e70 2e6e 6461 7272 6179 2c0a  ws: np.ndarray,.
+00011ee0: 2020 2020 2020 2020 7769 6e64 6f77 5f66          window_f
+00011ef0: 756e 6374 696f 6e3a 204c 6974 6572 616c  unction: Literal
+00011f00: 5b22 4861 6e6e 222c 2022 4861 6d6d 696e  ["Hann", "Hammin
+00011f10: 6722 2c20 2242 6c61 636b 6d61 6e22 5d20  g", "Blackman"] 
+00011f20: 3d20 4e6f 6e65 2c0a 2020 2020 293a 0a20  = None,.    ):. 
+00011f30: 2020 2020 2020 2022 2222 4669 6e64 2074         """Find t
+00011f40: 6865 204b 2064 6f6d 696e 616e 7420 6672  he K dominant fr
+00011f50: 6571 7565 6e63 6965 7320 7769 7468 696e  equencies within
+00011f60: 2061 2066 6561 7475 7265 2076 6563 746f   a feature vecto
+00011f70: 7220 7573 696e 6720 736c 6964 696e 6720  r using sliding 
+00011f80: 7769 6e64 6f77 7322 2222 0a0a 2020 2020  windows"""..    
+00011f90: 2020 2020 7265 7375 6c74 7320 3d20 6e70      results = np
+00011fa0: 2e66 756c 6c28 2864 6174 612e 7368 6170  .full((data.shap
+00011fb0: 655b 305d 2c20 7469 6d65 5f77 696e 646f  e[0], time_windo
+00011fc0: 7773 2e73 6861 7065 5b30 5d29 2c20 302e  ws.shape[0]), 0.
+00011fd0: 3029 0a20 2020 2020 2020 2066 6f72 2074  0).        for t
+00011fe0: 696d 655f 7769 6e64 6f77 5f63 6e74 2069  ime_window_cnt i
+00011ff0: 6e20 7261 6e67 6528 7469 6d65 5f77 696e  n range(time_win
+00012000: 646f 7773 2e73 6861 7065 5b30 5d29 3a0a  dows.shape[0]):.
+00012010: 2020 2020 2020 2020 2020 2020 7769 6e64              wind
+00012020: 6f77 5f73 697a 6520 3d20 696e 7428 7469  ow_size = int(ti
+00012030: 6d65 5f77 696e 646f 7773 5b74 696d 655f  me_windows[time_
+00012040: 7769 6e64 6f77 5f63 6e74 5d20 2a20 6670  window_cnt] * fp
+00012050: 7329 0a20 2020 2020 2020 2020 2020 2066  s).            f
+00012060: 6f72 206c 6566 742c 2072 6967 6874 2069  or left, right i
+00012070: 6e20 7a69 7028 0a20 2020 2020 2020 2020  n zip(.         
+00012080: 2020 2020 2020 2072 616e 6765 2830 2c20         range(0, 
+00012090: 6461 7461 2e73 6861 7065 5b30 5d20 2b20  data.shape[0] + 
+000120a0: 3129 2c20 7261 6e67 6528 7769 6e64 6f77  1), range(window
+000120b0: 5f73 697a 652c 2064 6174 612e 7368 6170  _size, data.shap
+000120c0: 655b 305d 202b 2031 290a 2020 2020 2020  e[0] + 1).      
+000120d0: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+000120e0: 2020 2020 2020 2020 2077 696e 646f 775f           window_
+000120f0: 6461 7461 203d 2064 6174 615b 6c65 6674  data = data[left
+00012100: 3a72 6967 6874 5d0a 2020 2020 2020 2020  :right].        
+00012110: 2020 2020 2020 2020 6966 2077 696e 646f          if windo
+00012120: 775f 6675 6e63 7469 6f6e 203d 3d20 2248  w_function == "H
+00012130: 616e 6e22 3a0a 2020 2020 2020 2020 2020  ann":.          
+00012140: 2020 2020 2020 2020 2020 7769 6e64 6f77            window
+00012150: 5f64 6174 6120 3d20 7769 6e64 6f77 5f64  _data = window_d
+00012160: 6174 6120 2a20 6e70 2e68 616e 6e69 6e67  ata * np.hanning
+00012170: 286c 656e 2877 696e 646f 775f 6461 7461  (len(window_data
+00012180: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+00012190: 2020 2065 6c69 6620 7769 6e64 6f77 5f66     elif window_f
+000121a0: 756e 6374 696f 6e20 3d3d 2022 4861 6d6d  unction == "Hamm
+000121b0: 696e 6722 3a0a 2020 2020 2020 2020 2020  ing":.          
+000121c0: 2020 2020 2020 2020 2020 7769 6e64 6f77            window
+000121d0: 5f64 6174 6120 3d20 7769 6e64 6f77 5f64  _data = window_d
+000121e0: 6174 6120 2a20 6e70 2e68 616d 6d69 6e67  ata * np.hamming
+000121f0: 286c 656e 2877 696e 646f 775f 6461 7461  (len(window_data
+00012200: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+00012210: 2020 2065 6c69 6620 7769 6e64 6f77 5f66     elif window_f
+00012220: 756e 6374 696f 6e20 3d3d 2022 426c 6163  unction == "Blac
+00012230: 6b6d 616e 223a 0a20 2020 2020 2020 2020  kman":.         
+00012240: 2020 2020 2020 2020 2020 2077 696e 646f             windo
+00012250: 775f 6461 7461 203d 2077 696e 646f 775f  w_data = window_
+00012260: 6461 7461 202a 206e 702e 626c 6163 6b6d  data * np.blackm
+00012270: 616e 286c 656e 2877 696e 646f 775f 6461  an(len(window_da
+00012280: 7461 2929 0a20 2020 2020 2020 2020 2020  ta)).           
+00012290: 2020 2020 2066 6674 5f72 6573 756c 7420       fft_result 
+000122a0: 3d20 6e70 2e66 6674 2e66 6674 2877 696e  = np.fft.fft(win
+000122b0: 646f 775f 6461 7461 290a 2020 2020 2020  dow_data).      
+000122c0: 2020 2020 2020 2020 2020 6672 6571 7565            freque
+000122d0: 6e63 6965 7320 3d20 6e70 2e66 6674 2e66  ncies = np.fft.f
+000122e0: 6674 6672 6571 2877 696e 646f 775f 6461  ftfreq(window_da
+000122f0: 7461 2e73 6861 7065 5b30 5d2c 2031 202f  ta.shape[0], 1 /
+00012300: 2066 7073 290a 2020 2020 2020 2020 2020   fps).          
+00012310: 2020 2020 2020 6d61 676e 6974 7564 6520        magnitude 
+00012320: 3d20 6e70 2e61 6273 2866 6674 5f72 6573  = np.abs(fft_res
+00012330: 756c 7429 0a20 2020 2020 2020 2020 2020  ult).           
+00012340: 2020 2020 2074 6f70 5f6b 5f66 7265 7175       top_k_frequ
+00012350: 656e 6379 203d 2066 7265 7175 656e 6369  ency = frequenci
+00012360: 6573 5b6e 702e 6172 6773 6f72 7428 6d61  es[np.argsort(ma
+00012370: 676e 6974 7564 6529 5b2d 286b 202b 2031  gnitude)[-(k + 1
+00012380: 2920 3a20 2d31 5d5d 0a20 2020 2020 2020  ) : -1]].       
+00012390: 2020 2020 2020 2020 2072 6573 756c 7473           results
+000123a0: 5b72 6967 6874 202d 2031 5d5b 7469 6d65  [right - 1][time
+000123b0: 5f77 696e 646f 775f 636e 745d 203d 2074  _window_cnt] = t
+000123c0: 6f70 5f6b 5f66 7265 7175 656e 6379 5b30  op_k_frequency[0
+000123d0: 5d0a 2020 2020 2020 2020 7265 7475 726e  ].        return
+000123e0: 2072 6573 756c 7473 0a0a 2020 2020 4073   results..    @s
+000123f0: 7461 7469 636d 6574 686f 640a 2020 2020  taticmethod.    
+00012400: 406e 6a69 7428 2228 666c 6f61 7433 325b  @njit("(float32[
+00012410: 3a5d 2c20 666c 6f61 7433 325b 3a5d 2922  :], float32[:])"
+00012420: 290a 2020 2020 6465 6620 6b65 6e64 616c  ).    def kendal
+00012430: 6c5f 7461 7528 7361 6d70 6c65 5f31 3a20  l_tau(sample_1: 
+00012440: 6e70 2e6e 6461 7272 6179 2c20 7361 6d70  np.ndarray, samp
+00012450: 6c65 5f32 3a20 6e70 2e6e 6461 7272 6179  le_2: np.ndarray
+00012460: 2920 2d3e 2054 7570 6c65 5b66 6c6f 6174  ) -> Tuple[float
+00012470: 2c20 666c 6f61 745d 3a0a 2020 2020 2020  , float]:.      
+00012480: 2020 2222 220a 2020 2020 2020 2020 4a69    """.        Ji
+00012490: 7474 6564 204b 656e 6461 6c6c 2054 6175  tted Kendall Tau
+000124a0: 2028 7261 6e6b 2063 6f72 7265 6c61 7469   (rank correlati
+000124b0: 6f6e 2063 6f65 6666 6963 6965 6e74 292e  on coefficient).
+000124c0: 204e 6f6e 2d70 6172 616d 6574 7269 6320   Non-parametric 
+000124d0: 6d65 7468 6f64 2066 6f72 2063 6f6d 7075  method for compu
+000124e0: 7469 6e67 2063 6f72 7265 6c61 7469 6f6e  ting correlation
+000124f0: 0a20 2020 2020 2020 2062 6574 7765 656e  .        between
+00012500: 2074 776f 2074 696d 652d 7365 7269 6573   two time-series
+00012510: 2066 6561 7475 7265 732e 2052 6574 7572   features. Retur
+00012520: 6e73 2074 6175 2061 6e64 2061 7373 6f63  ns tau and assoc
+00012530: 6961 7465 6420 7a2d 7363 6f72 652e 0a0a  iated z-score...
+00012540: 2020 2020 2020 2020 3a70 6172 616d 6574          :paramet
+00012550: 6572 206e 6461 7272 6179 2073 616d 706c  er ndarray sampl
+00012560: 655f 313a 2046 6972 7374 2031 4420 6172  e_1: First 1D ar
+00012570: 7261 7920 7769 7468 2066 6561 7475 7265  ray with feature
+00012580: 2076 616c 7565 732e 0a20 2020 2020 2020   values..       
+00012590: 203a 7061 7261 6d65 7465 7220 6e64 6172   :parameter ndar
+000125a0: 7261 7920 7361 6d70 6c65 5f31 3a20 5365  ray sample_1: Se
+000125b0: 636f 6e64 2031 4420 6172 7261 7920 7769  cond 1D array wi
+000125c0: 7468 2066 6561 7475 7265 2076 616c 7565  th feature value
+000125d0: 732e 0a20 2020 2020 2020 203a 7265 7475  s..        :retu
+000125e0: 726e 7320 5475 706c 655b 666c 6f61 742c  rns Tuple[float,
+000125f0: 2066 6c6f 6174 5d3a 204b 656e 6461 6c6c   float]: Kendall
+00012600: 2054 6175 2061 6e64 2061 7373 6f63 6961   Tau and associa
+00012610: 7465 6420 7a2d 7363 6f72 652e 0a0a 2020  ted z-score...  
+00012620: 2020 2020 2020 3a65 7861 6d70 6c65 733a        :examples:
+00012630: 0a20 2020 2020 2020 203e 3e3e 2073 616d  .        >>> sam
+00012640: 706c 655f 3120 3d20 6e70 2e61 7272 6179  ple_1 = np.array
+00012650: 285b 342c 2032 2c20 332c 2034 2c20 352c  ([4, 2, 3, 4, 5,
+00012660: 2037 5d29 2e61 7374 7970 6528 6e70 2e66   7]).astype(np.f
+00012670: 6c6f 6174 3332 290a 2020 2020 2020 2020  loat32).        
+00012680: 3e3e 3e20 7361 6d70 6c65 5f32 203d 206e  >>> sample_2 = n
+00012690: 702e 6172 7261 7928 5b31 2c20 322c 2033  p.array([1, 2, 3
+000126a0: 2c20 342c 2035 2c20 375d 292e 6173 7479  , 4, 5, 7]).asty
+000126b0: 7065 286e 702e 666c 6f61 7433 3229 0a20  pe(np.float32). 
+000126c0: 2020 2020 2020 203e 3e3e 2053 7461 7469         >>> Stati
+000126d0: 7374 6963 7328 292e 6b65 6e64 616c 6c5f  stics().kendall_
+000126e0: 7461 7528 7361 6d70 6c65 5f31 3d73 616d  tau(sample_1=sam
+000126f0: 706c 655f 312c 2073 616d 706c 655f 323d  ple_1, sample_2=
+00012700: 7361 6d70 6c65 5f32 290a 2020 2020 2020  sample_2).      
+00012710: 2020 3e3e 3e20 2830 2e37 3333 3333 3333    >>> (0.7333333
+00012720: 3333 3333 3333 3333 332c 2032 2e30 3636  333333333, 2.066
+00012730: 3534 3031 3630 3538 3039 3932 3829 0a0a  5401605809928)..
+00012740: 2020 2020 2020 2020 5265 6665 7265 6e63          Referenc
+00012750: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
+00012760: 2d2d 2d2d 2d0a 2020 2020 2020 2020 2e2e  -----.        ..
+00012770: 205b 315d 2060 5374 6570 6861 6e69 6520   [1] `Stephanie 
+00012780: 476c 656e 2c20 224b 656e 6461 6c6c e280  Glen, "Kendall..
+00012790: 9973 2054 6175 2028 4b65 6e64 616c 6c20  .s Tau (Kendall 
+000127a0: 5261 6e6b 2043 6f72 7265 6c61 7469 6f6e  Rank Correlation
+000127b0: 2043 6f65 6666 6963 6965 6e74 2922 2020   Coefficient)"  
+000127c0: 3c68 7474 7073 3a2f 2f77 7777 2e73 7461  <https://www.sta
+000127d0: 7469 7374 6963 7368 6f77 746f 2e63 6f6d  tisticshowto.com
+000127e0: 2f6b 656e 6461 6c6c 732d 7461 752f 3e60  /kendalls-tau/>`
+000127f0: 5f5f 2e0a 2020 2020 2020 2020 2222 220a  __..        """.
+00012800: 0a20 2020 2020 2020 2072 6e6b 7320 3d20  .        rnks = 
+00012810: 6e70 2e61 7267 736f 7274 2873 616d 706c  np.argsort(sampl
+00012820: 655f 3129 0a20 2020 2020 2020 2073 315f  e_1).        s1_
+00012830: 726e 6b2c 2073 325f 726e 6b20 3d20 7361  rnk, s2_rnk = sa
+00012840: 6d70 6c65 5f31 5b72 6e6b 735d 2c20 7361  mple_1[rnks], sa
+00012850: 6d70 6c65 5f32 5b72 6e6b 735d 0a20 2020  mple_2[rnks].   
+00012860: 2020 2020 2063 6e63 7264 6e74 5f63 6e74       cncrdnt_cnt
+00012870: 732c 2064 7363 7264 6e74 5f63 6e74 7320  s, dscrdnt_cnts 
+00012880: 3d20 6e70 2e66 756c 6c28 2873 315f 726e  = np.full((s1_rn
+00012890: 6b2e 7368 6170 655b 305d 202d 2031 292c  k.shape[0] - 1),
+000128a0: 206e 702e 6e61 6e29 2c20 6e70 2e66 756c   np.nan), np.ful
+000128b0: 6c28 0a20 2020 2020 2020 2020 2020 2028  l(.            (
+000128c0: 7331 5f72 6e6b 2e73 6861 7065 5b30 5d20  s1_rnk.shape[0] 
+000128d0: 2d20 3129 2c20 6e70 2e6e 616e 0a20 2020  - 1), np.nan.   
+000128e0: 2020 2020 2029 0a20 2020 2020 2020 2066       ).        f
+000128f0: 6f72 2069 2069 6e20 7261 6e67 6528 7332  or i in range(s2
+00012900: 5f72 6e6b 2e73 6861 7065 5b30 5d20 2d20  _rnk.shape[0] - 
+00012910: 3129 3a0a 2020 2020 2020 2020 2020 2020  1):.            
+00012920: 636e 6372 646e 745f 636e 7473 5b69 5d20  cncrdnt_cnts[i] 
+00012930: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+00012940: 2020 2020 6e70 2e61 7267 7768 6572 6528      np.argwhere(
+00012950: 7332 5f72 6e6b 5b69 202b 2031 203a 5d20  s2_rnk[i + 1 :] 
+00012960: 3e20 7332 5f72 6e6b 5b69 5d29 2e66 6c61  > s2_rnk[i]).fla
+00012970: 7474 656e 2829 2e73 6861 7065 5b30 5d0a  tten().shape[0].
+00012980: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00012990: 2020 2020 2020 2020 2020 6473 6372 646e            dscrdn
+000129a0: 745f 636e 7473 5b69 5d20 3d20 280a 2020  t_cnts[i] = (.  
+000129b0: 2020 2020 2020 2020 2020 2020 2020 6e70                np
+000129c0: 2e61 7267 7768 6572 6528 7332 5f72 6e6b  .argwhere(s2_rnk
+000129d0: 5b69 202b 2031 203a 5d20 3c20 7332 5f72  [i + 1 :] < s2_r
+000129e0: 6e6b 5b69 5d29 2e66 6c61 7474 656e 2829  nk[i]).flatten()
+000129f0: 2e73 6861 7065 5b30 5d0a 2020 2020 2020  .shape[0].      
+00012a00: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00012a10: 7420 3d20 286e 702e 7375 6d28 636e 6372  t = (np.sum(cncr
+00012a20: 646e 745f 636e 7473 2920 2d20 6e70 2e73  dnt_cnts) - np.s
+00012a30: 756d 2864 7363 7264 6e74 5f63 6e74 7329  um(dscrdnt_cnts)
+00012a40: 2920 2f20 280a 2020 2020 2020 2020 2020  ) / (.          
+00012a50: 2020 6e70 2e73 756d 2863 6e63 7264 6e74    np.sum(cncrdnt
+00012a60: 5f63 6e74 7329 202b 206e 702e 7375 6d28  _cnts) + np.sum(
+00012a70: 6473 6372 646e 745f 636e 7473 290a 2020  dscrdnt_cnts).  
+00012a80: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00012a90: 7a20 3d20 280a 2020 2020 2020 2020 2020  z = (.          
+00012aa0: 2020 330a 2020 2020 2020 2020 2020 2020    3.            
+00012ab0: 2a20 740a 2020 2020 2020 2020 2020 2020  * t.            
+00012ac0: 2a20 286e 702e 7371 7274 2873 315f 726e  * (np.sqrt(s1_rn
+00012ad0: 6b2e 7368 6170 655b 305d 202a 2028 7331  k.shape[0] * (s1
+00012ae0: 5f72 6e6b 2e73 6861 7065 5b30 5d20 2d20  _rnk.shape[0] - 
+00012af0: 3129 2929 0a20 2020 2020 2020 2020 2020  1))).           
+00012b00: 202f 206e 702e 7371 7274 2832 202a 2028   / np.sqrt(2 * (
+00012b10: 2832 202a 2073 315f 726e 6b2e 7368 6170  (2 * s1_rnk.shap
+00012b20: 655b 305d 2920 2b20 3529 290a 2020 2020  e[0]) + 5)).    
+00012b30: 2020 2020 290a 0a20 2020 2020 2020 2072      )..        r
+00012b40: 6574 7572 6e20 742c 207a 0a0a 2020 2020  eturn t, z..    
+00012b50: 4073 7461 7469 636d 6574 686f 640a 2020  @staticmethod.  
+00012b60: 2020 406e 6a69 7428 2228 666c 6f61 7433    @njit("(float3
+00012b70: 325b 3a5d 2c20 666c 6f61 7433 325b 3a5d  2[:], float32[:]
+00012b80: 2c20 666c 6f61 7436 345b 3a5d 2c20 696e  , float64[:], in
+00012b90: 7436 3429 2229 0a20 2020 2064 6566 2073  t64)").    def s
+00012ba0: 6c69 6469 6e67 5f6b 656e 6461 6c6c 5f74  liding_kendall_t
+00012bb0: 6175 280a 2020 2020 2020 2020 7361 6d70  au(.        samp
+00012bc0: 6c65 5f31 3a20 6e70 2e6e 6461 7272 6179  le_1: np.ndarray
+00012bd0: 2c20 7361 6d70 6c65 5f32 3a20 6e70 2e6e  , sample_2: np.n
+00012be0: 6461 7272 6179 2c20 7469 6d65 5f77 696e  darray, time_win
+00012bf0: 646f 7773 3a20 6e70 2e6e 6461 7272 6179  dows: np.ndarray
+00012c00: 2c20 6670 733a 2066 6c6f 6174 0a20 2020  , fps: float.   
+00012c10: 2029 202d 3e20 6e70 2e6e 6461 7272 6179   ) -> np.ndarray
+00012c20: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00012c30: 2020 2020 2020 436f 6d70 7574 6520 736c        Compute sl
+00012c40: 6964 696e 6720 4b65 6e64 616c 6c27 7320  iding Kendall's 
+00012c50: 5461 7520 636f 7272 656c 6174 696f 6e20  Tau correlation 
+00012c60: 636f 6566 6669 6369 656e 742e 0a0a 2020  coefficient...  
+00012c70: 2020 2020 2020 4361 6c63 756c 6174 6573        Calculates
+00012c80: 204b 656e 6461 6c6c 2773 2054 6175 2063   Kendall's Tau c
+00012c90: 6f72 7265 6c61 7469 6f6e 2063 6f65 6666  orrelation coeff
+00012ca0: 6963 6965 6e74 2062 6574 7765 656e 2074  icient between t
+00012cb0: 776f 2073 616d 706c 6573 206f 7665 7220  wo samples over 
+00012cc0: 736c 6964 696e 6720 7469 6d65 2077 696e  sliding time win
+00012cd0: 646f 7773 2e20 4b65 6e64 616c 6c27 7320  dows. Kendall's 
+00012ce0: 5461 7520 6973 2061 206d 6561 7375 7265  Tau is a measure
+00012cf0: 206f 6620 636f 7272 656c 6174 696f 6e20   of correlation 
+00012d00: 6265 7477 6565 6e20 7477 6f20 7261 6e6b  between two rank
+00012d10: 6564 2064 6174 6173 6574 732e 0a0a 2020  ed datasets...  
+00012d20: 2020 2020 2020 5468 6520 636f 6d70 7574        The comput
+00012d30: 6174 696f 6e20 6973 2062 6173 6564 206f  ation is based o
+00012d40: 6e20 7468 6520 666f 726d 756c 613a 0a0a  n the formula:..
+00012d50: 2020 2020 2020 2020 2e2e 206d 6174 683a          .. math:
+00012d60: 3a0a 0a20 2020 2020 2020 2020 2020 5c5c  :..           \\
+00012d70: 7461 7520 3d20 5c5c 6672 6163 7b7b 5c5c  tau = \\frac{{\\
+00012d80: 7465 7874 7b7b 636f 6e63 6f72 6461 6e74  text{{concordant
+00012d90: 2070 6169 7273 7d7d 202d 205c 5c74 6578   pairs}} - \\tex
+00012da0: 747b 7b64 6973 636f 7264 616e 7420 7061  t{{discordant pa
+00012db0: 6972 737d 7d7d 7d7b 7b5c 5c74 6578 747b  irs}}}}{{\\text{
+00012dc0: 7b63 6f6e 636f 7264 616e 7420 7061 6972  {concordant pair
+00012dd0: 737d 7d20 2b20 5c5c 7465 7874 7b7b 6469  s}} + \\text{{di
+00012de0: 7363 6f72 6461 6e74 2070 6169 7273 7d7d  scordant pairs}}
+00012df0: 7d7d 0a0a 2020 2020 2020 2020 7768 6572  }}..        wher
+00012e00: 6520 636f 6e63 6f72 6461 6e74 2070 6169  e concordant pai
+00012e10: 7273 2061 7265 2070 6169 7273 206f 6620  rs are pairs of 
+00012e20: 656c 656d 656e 7473 2077 6974 6820 7468  elements with th
+00012e30: 6520 7361 6d65 206f 7264 6572 2069 6e20  e same order in 
+00012e40: 626f 7468 2073 616d 706c 6573 2c20 616e  both samples, an
+00012e50: 6420 6469 7363 6f72 6461 6e74 2070 6169  d discordant pai
+00012e60: 7273 2061 7265 2070 6169 7273 2077 6974  rs are pairs wit
+00012e70: 6820 6469 6666 6572 656e 7420 6f72 6465  h different orde
+00012e80: 7273 2e0a 0a20 2020 2020 2020 2052 6566  rs...        Ref
+00012e90: 6572 656e 6365 730a 2020 2020 2020 2020  erences.        
+00012ea0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00012eb0: 2020 202e 2e20 5b31 5d20 6053 7465 7068     .. [1] `Steph
+00012ec0: 616e 6965 2047 6c65 6e2c 2022 4b65 6e64  anie Glen, "Kend
+00012ed0: 616c 6ce2 8099 7320 5461 7520 284b 656e  all...s Tau (Ken
+00012ee0: 6461 6c6c 2052 616e 6b20 436f 7272 656c  dall Rank Correl
+00012ef0: 6174 696f 6e20 436f 6566 6669 6369 656e  ation Coefficien
+00012f00: 7429 2220 203c 6874 7470 733a 2f2f 7777  t)"  <https://ww
+00012f10: 772e 7374 6174 6973 7469 6373 686f 7774  w.statisticshowt
+00012f20: 6f2e 636f 6d2f 6b65 6e64 616c 6c73 2d74  o.com/kendalls-t
+00012f30: 6175 2f3e 605f 5f2e 0a0a 0a20 2020 2020  au/>`__....     
+00012f40: 2020 203a 7061 7261 6d20 6e70 2e6e 6461     :param np.nda
+00012f50: 7272 6179 2073 616d 706c 655f 313a 2046  rray sample_1: F
+00012f60: 6972 7374 2073 616d 706c 6520 666f 7220  irst sample for 
+00012f70: 636f 6d70 6172 6973 6f6e 2e0a 2020 2020  comparison..    
+00012f80: 2020 2020 3a70 6172 616d 206e 702e 6e64      :param np.nd
+00012f90: 6172 7261 7920 7361 6d70 6c65 5f32 3a20  array sample_2: 
+00012fa0: 5365 636f 6e64 2073 616d 706c 6520 666f  Second sample fo
+00012fb0: 7220 636f 6d70 6172 6973 6f6e 2e0a 2020  r comparison..  
+00012fc0: 2020 2020 2020 3a70 6172 616d 206e 702e        :param np.
+00012fd0: 6e64 6172 7261 7920 7469 6d65 5f77 696e  ndarray time_win
+00012fe0: 646f 7773 3a20 526f 6c6c 696e 6720 7469  dows: Rolling ti
+00012ff0: 6d65 2077 696e 646f 7773 2069 6e20 7365  me windows in se
+00013000: 636f 6e64 732e 0a20 2020 2020 2020 203a  conds..        :
+00013010: 7061 7261 6d20 666c 6f61 7420 6670 733a  param float fps:
+00013020: 2046 7261 6d65 7320 7065 7220 7365 636f   Frames per seco
+00013030: 6e64 2028 4650 5329 206f 6620 7468 6520  nd (FPS) of the 
+00013040: 7265 636f 7264 6564 2076 6964 656f 2e0a  recorded video..
+00013050: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
+00013060: 2041 7272 6179 206f 6620 4b65 6e64 616c   Array of Kendal
+00013070: 6c27 7320 5461 7520 636f 7272 656c 6174  l's Tau correlat
+00013080: 696f 6e20 636f 6566 6669 6369 656e 7473  ion coefficients
+00013090: 2063 6f72 7265 7370 6f6e 6469 6e67 2074   corresponding t
+000130a0: 6f20 6561 6368 2074 696d 6520 7769 6e64  o each time wind
+000130b0: 6f77 2e0a 2020 2020 2020 2020 2222 220a  ow..        """.
+000130c0: 0a20 2020 2020 2020 2072 6573 756c 7473  .        results
+000130d0: 203d 206e 702e 6675 6c6c 2828 7361 6d70   = np.full((samp
+000130e0: 6c65 5f31 2e73 6861 7065 5b30 5d2c 2074  le_1.shape[0], t
+000130f0: 696d 655f 7769 6e64 6f77 732e 7368 6170  ime_windows.shap
+00013100: 655b 305d 292c 2030 2e30 290a 2020 2020  e[0]), 0.0).    
+00013110: 2020 2020 666f 7220 7469 6d65 5f77 696e      for time_win
+00013120: 646f 775f 636e 7420 696e 2072 616e 6765  dow_cnt in range
+00013130: 2874 696d 655f 7769 6e64 6f77 732e 7368  (time_windows.sh
+00013140: 6170 655b 305d 293a 0a20 2020 2020 2020  ape[0]):.       
+00013150: 2020 2020 2077 696e 646f 775f 7369 7a65       window_size
+00013160: 203d 2069 6e74 2874 696d 655f 7769 6e64   = int(time_wind
+00013170: 6f77 735b 7469 6d65 5f77 696e 646f 775f  ows[time_window_
+00013180: 636e 745d 202a 2066 7073 290a 2020 2020  cnt] * fps).    
+00013190: 2020 2020 2020 2020 666f 7220 6c65 6674          for left
+000131a0: 2c20 7269 6768 7420 696e 207a 6970 280a  , right in zip(.
+000131b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000131c0: 7261 6e67 6528 302c 2073 616d 706c 655f  range(0, sample_
+000131d0: 312e 7368 6170 655b 305d 202b 2031 292c  1.shape[0] + 1),
+000131e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000131f0: 2072 616e 6765 2877 696e 646f 775f 7369   range(window_si
+00013200: 7a65 2c20 7361 6d70 6c65 5f31 2e73 6861  ze, sample_1.sha
+00013210: 7065 5b30 5d20 2b20 3129 2c0a 2020 2020  pe[0] + 1),.    
+00013220: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
+00013230: 2020 2020 2020 2020 2020 2073 6c69 6365             slice
+00013240: 645f 7361 6d70 6c65 5f31 2c20 736c 6963  d_sample_1, slic
+00013250: 6564 5f73 616d 706c 655f 3220 3d20 280a  ed_sample_2 = (.
+00013260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013270: 2020 2020 7361 6d70 6c65 5f31 5b6c 6566      sample_1[lef
+00013280: 743a 7269 6768 745d 2c0a 2020 2020 2020  t:right],.      
+00013290: 2020 2020 2020 2020 2020 2020 2020 7361                sa
+000132a0: 6d70 6c65 5f32 5b6c 6566 743a 7269 6768  mple_2[left:righ
+000132b0: 745d 2c0a 2020 2020 2020 2020 2020 2020  t],.            
+000132c0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+000132d0: 2020 2020 2020 726e 6b73 203d 206e 702e        rnks = np.
+000132e0: 6172 6773 6f72 7428 736c 6963 6564 5f73  argsort(sliced_s
+000132f0: 616d 706c 655f 3129 0a20 2020 2020 2020  ample_1).       
+00013300: 2020 2020 2020 2020 2073 315f 726e 6b2c           s1_rnk,
+00013310: 2073 325f 726e 6b20 3d20 736c 6963 6564   s2_rnk = sliced
+00013320: 5f73 616d 706c 655f 315b 726e 6b73 5d2c  _sample_1[rnks],
+00013330: 2073 6c69 6365 645f 7361 6d70 6c65 5f32   sliced_sample_2
+00013340: 5b72 6e6b 735d 0a20 2020 2020 2020 2020  [rnks].         
+00013350: 2020 2020 2020 2063 6e63 7264 6e74 5f63         cncrdnt_c
+00013360: 6e74 732c 2064 7363 7264 6e74 5f63 6e74  nts, dscrdnt_cnt
+00013370: 7320 3d20 6e70 2e66 756c 6c28 0a20 2020  s = np.full(.   
+00013380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013390: 2028 7331 5f72 6e6b 2e73 6861 7065 5b30   (s1_rnk.shape[0
+000133a0: 5d20 2d20 3129 2c20 6e70 2e6e 616e 0a20  ] - 1), np.nan. 
+000133b0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+000133c0: 2c20 6e70 2e66 756c 6c28 2873 315f 726e  , np.full((s1_rn
+000133d0: 6b2e 7368 6170 655b 305d 202d 2031 292c  k.shape[0] - 1),
+000133e0: 206e 702e 6e61 6e29 0a20 2020 2020 2020   np.nan).       
+000133f0: 2020 2020 2020 2020 2066 6f72 2069 2069           for i i
+00013400: 6e20 7261 6e67 6528 7332 5f72 6e6b 2e73  n range(s2_rnk.s
+00013410: 6861 7065 5b30 5d20 2d20 3129 3a0a 2020  hape[0] - 1):.  
+00013420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013430: 2020 636e 6372 646e 745f 636e 7473 5b69    cncrdnt_cnts[i
+00013440: 5d20 3d20 280a 2020 2020 2020 2020 2020  ] = (.          
+00013450: 2020 2020 2020 2020 2020 2020 2020 6e70                np
+00013460: 2e61 7267 7768 6572 6528 7332 5f72 6e6b  .argwhere(s2_rnk
+00013470: 5b69 202b 2031 203a 5d20 3e20 7332 5f72  [i + 1 :] > s2_r
+00013480: 6e6b 5b69 5d29 2e66 6c61 7474 656e 2829  nk[i]).flatten()
+00013490: 2e73 6861 7065 5b30 5d0a 2020 2020 2020  .shape[0].      
+000134a0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+000134b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000134c0: 2020 2020 6473 6372 646e 745f 636e 7473      dscrdnt_cnts
+000134d0: 5b69 5d20 3d20 280a 2020 2020 2020 2020  [i] = (.        
+000134e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000134f0: 6e70 2e61 7267 7768 6572 6528 7332 5f72  np.argwhere(s2_r
+00013500: 6e6b 5b69 202b 2031 203a 5d20 3c20 7332  nk[i + 1 :] < s2
+00013510: 5f72 6e6b 5b69 5d29 2e66 6c61 7474 656e  _rnk[i]).flatten
+00013520: 2829 2e73 6861 7065 5b30 5d0a 2020 2020  ().shape[0].    
+00013530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013540: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00013550: 2020 7265 7375 6c74 735b 7269 6768 745d    results[right]
+00013560: 5b74 696d 655f 7769 6e64 6f77 5f63 6e74  [time_window_cnt
+00013570: 5d20 3d20 280a 2020 2020 2020 2020 2020  ] = (.          
+00013580: 2020 2020 2020 2020 2020 6e70 2e73 756d            np.sum
+00013590: 2863 6e63 7264 6e74 5f63 6e74 7329 202d  (cncrdnt_cnts) -
+000135a0: 206e 702e 7375 6d28 6473 6372 646e 745f   np.sum(dscrdnt_
+000135b0: 636e 7473 290a 2020 2020 2020 2020 2020  cnts).          
+000135c0: 2020 2020 2020 2920 2f20 286e 702e 7375        ) / (np.su
+000135d0: 6d28 636e 6372 646e 745f 636e 7473 2920  m(cncrdnt_cnts) 
+000135e0: 2b20 6e70 2e73 756d 2864 7363 7264 6e74  + np.sum(dscrdnt
+000135f0: 5f63 6e74 7329 290a 0a20 2020 2020 2020  _cnts))..       
+00013600: 2072 6574 7572 6e20 7265 7375 6c74 730a   return results.
+00013610: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
+00013620: 6f64 0a20 2020 2064 6566 2066 696e 645f  od.    def find_
+00013630: 636f 6c6c 696e 6561 725f 6665 6174 7572  collinear_featur
+00013640: 6573 280a 2020 2020 2020 2020 6466 3a20  es(.        df: 
+00013650: 7064 2e44 6174 6146 7261 6d65 2c0a 2020  pd.DataFrame,.  
+00013660: 2020 2020 2020 7468 7265 7368 6f6c 643a        threshold:
+00013670: 2066 6c6f 6174 2c0a 2020 2020 2020 2020   float,.        
+00013680: 6d65 7468 6f64 3a20 4f70 7469 6f6e 616c  method: Optional
+00013690: 5b4c 6974 6572 616c 5b22 7065 6172 736f  [Literal["pearso
+000136a0: 6e22 2c20 2273 7065 6172 6d61 6e22 2c20  n", "spearman", 
+000136b0: 226b 656e 6461 6c6c 225d 5d20 3d20 2270  "kendall"]] = "p
+000136c0: 6561 7273 6f6e 222c 0a20 2020 2020 2020  earson",.       
+000136d0: 2076 6572 626f 7365 3a20 4f70 7469 6f6e   verbose: Option
+000136e0: 616c 5b62 6f6f 6c5d 203d 2046 616c 7365  al[bool] = False
+000136f0: 2c0a 2020 2020 2920 2d3e 204c 6973 745b  ,.    ) -> List[
+00013700: 7374 725d 3a0a 2020 2020 2020 2020 2222  str]:.        ""
+00013710: 220a 2020 2020 2020 2020 4964 656e 7469  ".        Identi
+00013720: 6679 2063 6f6c 6c69 6e65 6172 2066 6561  fy collinear fea
+00013730: 7475 7265 7320 696e 2074 6865 2064 6174  tures in the dat
+00013740: 6166 7261 6d65 2062 6173 6564 206f 6e20  aframe based on 
+00013750: 7468 6520 7370 6563 6966 6965 6420 636f  the specified co
+00013760: 7272 656c 6174 696f 6e20 6d65 7468 6f64  rrelation method
+00013770: 2061 6e64 2074 6872 6573 686f 6c64 2e0a   and threshold..
+00013780: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00013790: 7064 2e44 6174 6146 7261 6d65 2064 663a  pd.DataFrame df:
+000137a0: 2049 6e70 7574 2044 6174 6146 7261 6d65   Input DataFrame
+000137b0: 2063 6f6e 7461 696e 696e 6720 6665 6174   containing feat
+000137c0: 7572 6573 2e0a 2020 2020 2020 2020 3a70  ures..        :p
+000137d0: 6172 616d 2066 6c6f 6174 2074 6872 6573  aram float thres
+000137e0: 686f 6c64 3a20 5468 7265 7368 6f6c 6420  hold: Threshold 
+000137f0: 7661 6c75 6520 746f 2064 6574 6572 6d69  value to determi
+00013800: 6e65 2063 6f6c 6c69 6e65 6172 6974 792e  ne collinearity.
+00013810: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00013820: 4f70 7469 6f6e 616c 5b4c 6974 6572 616c  Optional[Literal
+00013830: 5b27 7065 6172 736f 6e27 2c20 2773 7065  ['pearson', 'spe
+00013840: 6172 6d61 6e27 2c20 276b 656e 6461 6c6c  arman', 'kendall
+00013850: 275d 5d20 6d65 7468 6f64 3a20 4d65 7468  ']] method: Meth
+00013860: 6f64 2066 6f72 2063 616c 6375 6c61 7469  od for calculati
+00013870: 6e67 2063 6f72 7265 6c61 7469 6f6e 2e20  ng correlation. 
+00013880: 4465 6661 756c 7473 2074 6f20 2770 6561  Defaults to 'pea
+00013890: 7273 6f6e 272e 0a20 2020 2020 2020 203a  rson'..        :
+000138a0: 7265 7475 726e 3a20 5365 7420 6f66 2066  return: Set of f
+000138b0: 6561 7475 7265 206e 616d 6573 2069 6465  eature names ide
+000138c0: 6e74 6966 6965 6420 6173 2063 6f6c 6c69  ntified as colli
+000138d0: 6e65 6172 2e20 5265 7475 726e 7320 6f6e  near. Returns on
+000138e0: 6520 6665 6174 7572 6520 666f 7220 6576  e feature for ev
+000138f0: 6572 7920 6665 6174 7572 6520 7061 6972  ery feature pair
+00013900: 2077 6974 6820 636f 7272 656c 6174 696f   with correlatio
+00013910: 6e20 7661 6c75 6520 6162 6f76 6520 7370  n value above sp
+00013920: 6563 6966 6965 6420 7468 7265 7368 6f6c  ecified threshol
+00013930: 642e 0a0a 2020 2020 2020 2020 3a65 7861  d...        :exa
+00013940: 6d70 6c65 3a0a 2020 2020 2020 2020 3e3e  mple:.        >>
+00013950: 3e20 7820 3d20 7064 2e44 6174 6146 7261  > x = pd.DataFra
+00013960: 6d65 286e 702e 7261 6e64 6f6d 2e72 616e  me(np.random.ran
+00013970: 6469 6e74 2830 2c20 3130 302c 2028 3130  dint(0, 100, (10
+00013980: 302c 2031 3030 2929 290a 2020 2020 2020  0, 100))).      
+00013990: 2020 3e3e 3e20 6e61 6d65 7320 3d20 5374    >>> names = St
+000139a0: 6174 6973 7469 6373 2e66 696e 645f 636f  atistics.find_co
+000139b0: 6c6c 696e 6561 725f 6665 6174 7572 6573  llinear_features
+000139c0: 2864 663d 782c 2074 6872 6573 686f 6c64  (df=x, threshold
+000139d0: 3d30 2e32 2c20 6d65 7468 6f64 3d27 7065  =0.2, method='pe
+000139e0: 6172 736f 6e27 2c20 7665 7262 6f73 653d  arson', verbose=
+000139f0: 5472 7565 290a 2020 2020 2020 2020 2222  True).        ""
+00013a00: 220a 0a20 2020 2020 2020 2063 6865 636b  "..        check
+00013a10: 5f76 616c 6964 5f64 6174 6166 7261 6d65  _valid_dataframe
+00013a20: 280a 2020 2020 2020 2020 2020 2020 6466  (.            df
+00013a30: 3d64 662c 0a20 2020 2020 2020 2020 2020  =df,.           
+00013a40: 2073 6f75 7263 653d 5374 6174 6973 7469   source=Statisti
+00013a50: 6373 2e66 696e 645f 636f 6c6c 696e 6561  cs.find_collinea
+00013a60: 725f 6665 6174 7572 6573 2e5f 5f6e 616d  r_features.__nam
+00013a70: 655f 5f2c 0a20 2020 2020 2020 2020 2020  e__,.           
+00013a80: 2076 616c 6964 5f64 7479 7065 733d 2866   valid_dtypes=(f
+00013a90: 6c6f 6174 2c20 696e 742c 206e 702e 666c  loat, int, np.fl
+00013aa0: 6f61 7433 322c 206e 702e 666c 6f61 7436  oat32, np.float6
+00013ab0: 342c 206e 702e 696e 7433 322c 206e 702e  4, np.int32, np.
+00013ac0: 696e 7436 3429 2c0a 2020 2020 2020 2020  int64),.        
+00013ad0: 2020 2020 6d69 6e5f 6178 6973 5f31 3d31      min_axis_1=1
+00013ae0: 2c0a 2020 2020 2020 2020 2020 2020 6d69  ,.            mi
+00013af0: 6e5f 6178 6973 5f30 3d31 2c0a 2020 2020  n_axis_0=1,.    
+00013b00: 2020 2020 290a 2020 2020 2020 2020 6368      ).        ch
+00013b10: 6563 6b5f 666c 6f61 7428 0a20 2020 2020  eck_float(.     
+00013b20: 2020 2020 2020 206e 616d 653d 5374 6174         name=Stat
+00013b30: 6973 7469 6373 2e66 696e 645f 636f 6c6c  istics.find_coll
+00013b40: 696e 6561 725f 6665 6174 7572 6573 2e5f  inear_features._
+00013b50: 5f6e 616d 655f 5f2c 0a20 2020 2020 2020  _name__,.       
+00013b60: 2020 2020 2076 616c 7565 3d74 6872 6573       value=thres
+00013b70: 686f 6c64 2c0a 2020 2020 2020 2020 2020  hold,.          
+00013b80: 2020 6d61 785f 7661 6c75 653d 312e 302c    max_value=1.0,
+00013b90: 0a20 2020 2020 2020 2020 2020 206d 696e  .            min
+00013ba0: 5f76 616c 7565 3d30 2e30 2c0a 2020 2020  _value=0.0,.    
+00013bb0: 2020 2020 290a 2020 2020 2020 2020 6368      ).        ch
+00013bc0: 6563 6b5f 7374 7228 0a20 2020 2020 2020  eck_str(.       
+00013bd0: 2020 2020 206e 616d 653d 5374 6174 6973       name=Statis
+00013be0: 7469 6373 2e66 696e 645f 636f 6c6c 696e  tics.find_collin
+00013bf0: 6561 725f 6665 6174 7572 6573 2e5f 5f6e  ear_features.__n
+00013c00: 616d 655f 5f2c 0a20 2020 2020 2020 2020  ame__,.         
+00013c10: 2020 2076 616c 7565 3d6d 6574 686f 642c     value=method,
+00013c20: 0a20 2020 2020 2020 2020 2020 206f 7074  .            opt
+00013c30: 696f 6e73 3d28 2270 6561 7273 6f6e 222c  ions=("pearson",
+00013c40: 2022 7370 6561 726d 616e 222c 2022 6b65   "spearman", "ke
+00013c50: 6e64 616c 6c22 292c 0a20 2020 2020 2020  ndall"),.       
+00013c60: 2029 0a20 2020 2020 2020 2066 6561 7475   ).        featu
+00013c70: 7265 5f6e 616d 6573 203d 2073 6574 2829  re_names = set()
+00013c80: 0a20 2020 2020 2020 2066 6561 7475 7265  .        feature
+00013c90: 5f70 6169 7273 203d 206c 6973 7428 636f  _pairs = list(co
+00013ca0: 6d62 696e 6174 696f 6e73 286c 6973 7428  mbinations(list(
+00013cb0: 6466 2e63 6f6c 756d 6e73 292c 2032 2929  df.columns), 2))
+00013cc0: 0a0a 2020 2020 2020 2020 666f 7220 636e  ..        for cn
+00013cd0: 742c 2069 2069 6e20 656e 756d 6572 6174  t, i in enumerat
+00013ce0: 6528 6665 6174 7572 655f 7061 6972 7329  e(feature_pairs)
+00013cf0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00013d00: 2076 6572 626f 7365 3a0a 2020 2020 2020   verbose:.      
+00013d10: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00013d20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013d30: 2020 2020 2066 2241 6e61 6c79 7a69 6e67       f"Analyzing
+00013d40: 2066 6561 7475 7265 2070 6169 7220 636f   feature pair co
+00013d50: 6c6c 696e 6561 7269 7479 207b 636e 7420  llinearity {cnt 
+00013d60: 2b20 317d 2f7b 6c65 6e28 6665 6174 7572  + 1}/{len(featur
+00013d70: 655f 7061 6972 7329 7d2e 2e2e 220a 2020  e_pairs)}...".  
+00013d80: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00013d90: 2020 2020 2020 2020 2020 2020 6966 2028              if (
+00013da0: 695b 305d 206e 6f74 2069 6e20 6665 6174  i[0] not in feat
+00013db0: 7572 655f 6e61 6d65 7329 2061 6e64 2028  ure_names) and (
+00013dc0: 695b 315d 206e 6f74 2069 6e20 6665 6174  i[1] not in feat
+00013dd0: 7572 655f 6e61 6d65 7329 3a0a 2020 2020  ure_names):.    
+00013de0: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
+00013df0: 6c65 5f31 2c20 7361 6d70 6c65 5f32 203d  le_1, sample_2 =
+00013e00: 2064 665b 695b 305d 5d2e 7661 6c75 6573   df[i[0]].values
+00013e10: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
+00013e20: 3332 292c 2064 665b 0a20 2020 2020 2020  32), df[.       
+00013e30: 2020 2020 2020 2020 2020 2020 2069 5b31               i[1
+00013e40: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00013e50: 2020 5d2e 7661 6c75 6573 2e61 7374 7970    ].values.astyp
+00013e60: 6528 6e70 2e66 6c6f 6174 3332 290a 2020  e(np.float32).  
+00013e70: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00013e80: 206d 6574 686f 6420 3d3d 2022 7065 6172   method == "pear
+00013e90: 736f 6e22 3a0a 2020 2020 2020 2020 2020  son":.          
+00013ea0: 2020 2020 2020 2020 2020 7220 3d20 5374            r = St
+00013eb0: 6174 6973 7469 6373 2e70 6561 7273 6f6e  atistics.pearson
+00013ec0: 735f 7228 7361 6d70 6c65 5f31 3d73 616d  s_r(sample_1=sam
+00013ed0: 706c 655f 312c 2073 616d 706c 655f 323d  ple_1, sample_2=
+00013ee0: 7361 6d70 6c65 5f32 290a 2020 2020 2020  sample_2).      
+00013ef0: 2020 2020 2020 2020 2020 656c 6966 206d            elif m
+00013f00: 6574 686f 6420 3d3d 2022 7370 6561 726d  ethod == "spearm
+00013f10: 616e 223a 0a20 2020 2020 2020 2020 2020  an":.           
+00013f20: 2020 2020 2020 2020 2072 203d 2053 7461           r = Sta
+00013f30: 7469 7374 6963 732e 7370 6561 726d 616e  tistics.spearman
+00013f40: 5f72 616e 6b5f 636f 7272 656c 6174 696f  _rank_correlatio
+00013f50: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
+00013f60: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
+00013f70: 655f 313d 7361 6d70 6c65 5f31 2c20 7361  e_1=sample_1, sa
+00013f80: 6d70 6c65 5f32 3d73 616d 706c 655f 320a  mple_2=sample_2.
+00013f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013fa0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00013fb0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00013fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013fd0: 7220 3d20 5374 6174 6973 7469 6373 2e6b  r = Statistics.k
+00013fe0: 656e 6461 6c6c 5f74 6175 2873 616d 706c  endall_tau(sampl
+00013ff0: 655f 313d 7361 6d70 6c65 5f31 2c20 7361  e_1=sample_1, sa
+00014000: 6d70 6c65 5f32 3d73 616d 706c 655f 3229  mple_2=sample_2)
+00014010: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
+00014020: 2020 2020 6966 2061 6273 2872 2920 3e20      if abs(r) > 
+00014030: 7468 7265 7368 6f6c 643a 0a20 2020 2020  threshold:.     
+00014040: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00014050: 6561 7475 7265 5f6e 616d 6573 2e61 6464  eature_names.add
+00014060: 2869 5b30 5d29 0a20 2020 2020 2020 2069  (i[0]).        i
+00014070: 6620 7665 7262 6f73 653a 0a20 2020 2020  f verbose:.     
+00014080: 2020 2020 2020 2070 7269 6e74 2822 436f         print("Co
+00014090: 6c6c 696e 6561 7220 616e 616c 7973 6973  llinear analysis
+000140a0: 2063 6f6d 706c 6574 652e 2229 0a20 2020   complete.").   
+000140b0: 2020 2020 2072 6574 7572 6e20 6665 6174       return feat
+000140c0: 7572 655f 6e61 6d65 730a 0a20 2020 2040  ure_names..    @
+000140d0: 7374 6174 6963 6d65 7468 6f64 0a20 2020  staticmethod.   
+000140e0: 2064 6566 206c 6f63 616c 5f6f 7574 6c69   def local_outli
+000140f0: 6572 5f66 6163 746f 7228 0a20 2020 2020  er_factor(.     
+00014100: 2020 2064 6174 613a 206e 702e 6e64 6172     data: np.ndar
+00014110: 7261 792c 0a20 2020 2020 2020 206b 3a20  ray,.        k: 
+00014120: 556e 696f 6e5b 696e 742c 2066 6c6f 6174  Union[int, float
+00014130: 5d20 3d20 352c 0a20 2020 2020 2020 2063  ] = 5,.        c
+00014140: 6f6e 7461 6d69 6e61 7469 6f6e 3a20 4f70  ontamination: Op
+00014150: 7469 6f6e 616c 5b66 6c6f 6174 5d20 3d20  tional[float] = 
+00014160: 3165 2d31 302c 0a20 2020 2020 2020 206e  1e-10,.        n
+00014170: 6f72 6d61 6c69 7a65 3a20 4f70 7469 6f6e  ormalize: Option
+00014180: 616c 5b62 6f6f 6c5d 203d 2046 616c 7365  al[bool] = False
+00014190: 2c0a 2020 2020 2020 2020 6772 6f75 7062  ,.        groupb
+000141a0: 795f 6964 783a 204f 7074 696f 6e61 6c5b  y_idx: Optional[
+000141b0: 696e 745d 203d 204e 6f6e 652c 0a20 2020  int] = None,.   
+000141c0: 2029 202d 3e20 6e70 2e6e 6461 7272 6179   ) -> np.ndarray
+000141d0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+000141e0: 2020 2020 2020 436f 6d70 7574 6520 7468        Compute th
+000141f0: 6520 6c6f 6361 6c20 6f75 746c 6965 7220  e local outlier 
+00014200: 6661 6374 6f72 206f 6620 6561 6368 206f  factor of each o
+00014210: 6273 6572 7661 7469 6f6e 2e0a 0a20 2020  bservation...   
+00014220: 2020 2020 202e 2e20 6e6f 7465 3a3a 0a20       .. note::. 
+00014230: 2020 2020 2020 2020 2020 5468 6520 6669            The fi
+00014240: 6e61 6c20 4c4f 4620 7363 6f72 6573 2061  nal LOF scores a
+00014250: 7265 206e 6567 6174 6564 2e20 5468 7573  re negated. Thus
+00014260: 2c20 6869 6768 6572 2076 616c 7565 7320  , higher values 
+00014270: 696e 6469 6361 7465 206d 6f72 6520 6174  indicate more at
+00014280: 7970 6963 616c 2028 6f75 746c 6965 7229  ypical (outlier)
+00014290: 2064 6174 6120 706f 696e 7473 2e20 5661   data points. Va
+000142a0: 6c75 6573 0a20 2020 2020 2020 2020 2020  lues.           
+000142b0: 4d65 7468 6f64 2063 616c 6c73 2060 6073  Method calls ``s
+000142c0: 6b6c 6561 726e 2e6e 6569 6768 626f 7273  klearn.neighbors
+000142d0: 2e4c 6f63 616c 4f75 746c 6965 7246 6163  .LocalOutlierFac
+000142e0: 746f 7260 6020 6469 7265 6374 6c79 2e20  tor`` directly. 
+000142f0: 4174 7465 6d70 7465 6420 746f 2075 7365  Attempted to use
+00014300: 206f 776e 206a 6974 2063 6f6d 7069 6c65   own jit compile
+00014310: 6420 696d 706c 656d 656e 7461 7469 6f6e  d implementation
+00014320: 2c0a 2020 2020 2020 2020 2020 2062 7574  ,.           but
+00014330: 2072 756e 7469 6d65 2077 6173 2033 782d   runtime was 3x-
+00014340: 6973 6820 736c 6f77 6572 2074 6861 6e20  ish slower than 
+00014350: 6060 736b 6c65 6172 6e2e 6e65 6967 6862  ``sklearn.neighb
+00014360: 6f72 732e 4c6f 6361 6c4f 7574 6c69 6572  ors.LocalOutlier
+00014370: 4661 6374 6f72 6060 2e0a 0a20 2020 2020  Factor``...     
+00014380: 2020 2020 2020 4966 2067 726f 7570 6279        If groupby
+00014390: 5f69 6478 2069 7320 6e6f 7420 4e6f 6e65  _idx is not None
+000143a0: 2c20 7468 656e 2074 6865 2069 6e64 6578  , then the index
+000143b0: 2031 206f 6620 6060 6461 7461 6060 2061   1 of ``data`` a
+000143c0: 7272 6179 2066 6f72 2077 6869 6368 2074  rray for which t
+000143d0: 6f20 6772 6f75 7020 7468 6520 6461 7461  o group the data
+000143e0: 2061 6e64 2063 6f6d 7075 7465 204c 4f46   and compute LOF
+000143f0: 2077 6974 6869 6e20 6561 6368 2073 6567   within each seg
+00014400: 6d65 6e74 2f63 6c75 7374 6572 2e0a 2020  ment/cluster..  
+00014410: 2020 2020 2020 2020 2045 2e67 2e2c 2063           E.g., c
+00014420: 616e 2062 6520 6669 656c 6420 686f 6c64  an be field hold
+00014430: 696e 6720 636c 7573 7465 7220 6964 656e  ing cluster iden
+00014440: 7469 6669 6572 2e20 5468 7573 2c20 6f75  tifier. Thus, ou
+00014450: 746c 6965 7273 2061 7265 2063 6f6d 7075  tliers are compu
+00014460: 7465 6420 7769 7468 696e 2065 6163 6820  ted within each 
+00014470: 7365 676d 656e 742f 636c 7573 7465 722c  segment/cluster,
+00014480: 2065 6e73 7572 696e 6720 7468 6174 206f   ensuring that o
+00014490: 7468 6572 2073 6567 6d65 6e74 7320 6361  ther segments ca
+000144a0: 6e6e 6f74 2061 6666 6563 740a 2020 2020  nnot affect.    
+000144b0: 2020 2020 2020 206f 7574 6c69 6572 2073         outlier s
+000144c0: 636f 7265 7320 7769 7468 696e 2065 6163  cores within eac
+000144d0: 6820 616e 616c 797a 696e 6720 6561 6368  h analyzing each
+000144e0: 2063 6c75 7374 6572 2e0a 0a20 2020 2020   cluster...     
+000144f0: 2020 2020 2020 4966 2067 726f 7570 6279        If groupby
+00014500: 5f69 6478 2069 7320 7072 6f76 6964 6564  _idx is provided
+00014510: 2c20 7468 656e 2061 6c6c 206f 6273 6572  , then all obser
+00014520: 7661 7469 6f6e 7320 7769 7468 2063 6c75  vations with clu
+00014530: 7374 6572 2f73 6567 6d65 6e74 2076 6172  ster/segment var
+00014540: 6961 626c 6520 6060 2d31 6060 2077 696c  iable ``-1`` wil
+00014550: 6c20 6265 2074 7265 6174 6564 2061 7320  l be treated as 
+00014560: 756e 636c 7573 7465 7265 6420 616e 6420  unclustered and 
+00014570: 6173 7369 676e 6564 2074 6865 206d 6178  assigned the max
+00014580: 206f 7574 6c69 6572 2073 636f 7265 2066   outlier score f
+00014590: 6f75 6e64 2077 6974 6869 696e 2074 6865  ound withiin the
+000145a0: 2063 6c75 7374 6572 6564 206f 6273 6572   clustered obser
+000145b0: 7661 7469 6f6e 732e 0a0a 2020 2020 2020  vations...      
+000145c0: 2020 2e2e 2069 6d61 6765 3a3a 205f 7374    .. image:: _st
+000145d0: 6174 6963 2f69 6d67 2f6c 6f63 616c 5f6f  atic/img/local_o
+000145e0: 7574 6c69 6572 5f66 6163 746f 722e 706e  utlier_factor.pn
+000145f0: 670a 2020 2020 2020 2020 2020 203a 7769  g.           :wi
+00014600: 6474 683a 2037 3030 0a20 2020 2020 2020  dth: 700.       
+00014610: 2020 2020 3a61 6c69 676e 3a20 6365 6e74      :align: cent
+00014620: 6572 0a0a 2020 2020 2020 2020 3a70 6172  er..        :par
+00014630: 616d 206e 6461 7272 6179 2064 6174 613a  am ndarray data:
+00014640: 2032 4420 6172 7261 7920 7769 7468 2066   2D array with f
+00014650: 6561 7475 7265 2076 616c 7565 7320 7768  eature values wh
+00014660: 6572 6520 726f 7773 2072 6570 7265 7365  ere rows represe
+00014670: 6e74 2066 7261 6d65 7320 616e 6420 636f  nt frames and co
+00014680: 6c75 6d6e 7320 7265 7072 6573 656e 7420  lumns represent 
+00014690: 6665 6174 7572 6573 2e0a 2020 2020 2020  features..      
+000146a0: 2020 3a70 6172 616d 2055 6e69 6f6e 5b69    :param Union[i
+000146b0: 6e74 2c20 666c 6f61 745d 206b 3a20 4e75  nt, float] k: Nu
+000146c0: 6d62 6572 206f 6620 6e65 6967 6862 6f72  mber of neighbor
+000146d0: 7320 746f 2065 7661 6c75 6174 6520 666f  s to evaluate fo
+000146e0: 7220 6561 6368 206f 6273 6572 7661 7469  r each observati
+000146f0: 6f6e 2e20 4966 2074 6865 2076 616c 7565  on. If the value
+00014700: 2069 7320 6120 666c 6f61 742c 2074 6865   is a float, the
+00014710: 6e20 696e 7465 7270 7265 7465 6420 6173  n interpreted as
+00014720: 2074 6865 2072 6174 696f 206f 6620 6461   the ratio of da
+00014730: 7461 2e73 6861 7065 5b30 5d2e 2049 6620  ta.shape[0]. If 
+00014740: 7468 6520 7661 6c75 6520 6973 2061 6e20  the value is an 
+00014750: 696e 7465 6765 722c 2074 6865 6e20 6974  integer, then it
+00014760: 2072 6570 7265 7365 6e74 2074 6865 206e   represent the n
+00014770: 756d 6265 7220 6f66 206e 6569 6768 626f  umber of neighbo
+00014780: 7572 7320 746f 2065 7661 6c75 6174 652e  urs to evaluate.
+00014790: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+000147a0: 4f70 7469 6f6e 616c 5b66 6c6f 6174 5d20  Optional[float] 
+000147b0: 636f 6e74 616d 696e 6174 696f 6e3a 2053  contamination: S
+000147c0: 6d61 6c6c 2070 7365 7564 6f6e 756d 6265  mall pseudonumbe
+000147d0: 7220 746f 2061 766f 6964 2044 6976 6973  r to avoid Divis
+000147e0: 696f 6e42 795a 6572 6f20 6572 726f 722e  ionByZero error.
+000147f0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00014800: 4f70 7469 6f6e 616c 5b62 6f6f 6c5d 206e  Optional[bool] n
+00014810: 6f72 6d61 6c69 7a65 3a20 5768 6574 6865  ormalize: Whethe
+00014820: 7220 746f 206e 6f72 6d61 6c69 7a65 2074  r to normalize t
+00014830: 6865 2064 6973 7461 6e63 6573 2062 6574  he distances bet
+00014840: 7765 656e 2030 2061 6e64 2031 2e20 4465  ween 0 and 1. De
+00014850: 6661 756c 7473 2074 6f20 4661 6c73 652e  faults to False.
+00014860: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00014870: 4f70 7469 6f6e 616c 5b69 6e74 5d20 6772  Optional[int] gr
+00014880: 6f75 7062 795f 6964 783a 2049 6620 696e  oupby_idx: If in
+00014890: 742c 2074 6865 6e20 7468 6520 696e 6465  t, then the inde
+000148a0: 7820 3120 6f66 2060 6064 6174 6160 6020  x 1 of ``data`` 
+000148b0: 666f 7220 7768 6963 6820 746f 2067 726f  for which to gro
+000148c0: 7570 2074 6865 2064 6174 6120 616e 6420  up the data and 
+000148d0: 636f 6d70 7574 6520 4c4f 4620 6f6e 2065  compute LOF on e
+000148e0: 6163 6820 7365 676d 656e 742e 2045 2e67  ach segment. E.g
+000148f0: 2e2c 2063 616e 2062 6520 6669 656c 6420  ., can be field 
+00014900: 686f 6c64 696e 6720 6120 636c 7573 7465  holding a cluste
+00014910: 7220 6964 656e 7469 6669 6572 2e0a 2020  r identifier..  
+00014920: 2020 2020 2020 3a72 6574 7572 6e73 206e        :returns n
+00014930: 702e 6e64 6172 7261 793a 2041 7272 6179  p.ndarray: Array
+00014940: 206f 6620 7369 7a65 2064 6174 612e 7368   of size data.sh
+00014950: 6170 655b 305d 2077 6974 6820 6c6f 6361  ape[0] with loca
+00014960: 6c20 6f75 746c 6965 7220 7363 6f72 6573  l outlier scores
+00014970: 2e0a 0a20 2020 2020 2020 203a 6578 616d  ...        :exam
+00014980: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
+00014990: 2064 6174 612c 206c 626c 7320 3d20 6d61   data, lbls = ma
+000149a0: 6b65 5f62 6c6f 6273 286e 5f73 616d 706c  ke_blobs(n_sampl
+000149b0: 6573 3d32 3030 302c 206e 5f66 6561 7475  es=2000, n_featu
+000149c0: 7265 733d 322c 2063 656e 7465 7273 3d31  res=2, centers=1
+000149d0: 302c 2072 616e 646f 6d5f 7374 6174 653d  0, random_state=
+000149e0: 3432 290a 2020 2020 2020 2020 3e3e 3e20  42).        >>> 
+000149f0: 6461 7461 203d 206e 702e 6873 7461 636b  data = np.hstack
+00014a00: 2828 6461 7461 2c20 6c62 6c73 2e72 6573  ((data, lbls.res
+00014a10: 6861 7065 282d 312c 2031 2929 290a 2020  hape(-1, 1))).  
+00014a20: 2020 2020 2020 3e3e 3e20 6c6f 6620 3d20        >>> lof = 
+00014a30: 5374 6174 6973 7469 6373 2e6c 6f63 616c  Statistics.local
+00014a40: 5f6f 7574 6c69 6572 5f66 6163 746f 7228  _outlier_factor(
+00014a50: 6461 7461 3d64 6174 612c 2067 726f 7570  data=data, group
+00014a60: 6279 5f69 6478 3d32 2c20 6b3d 3130 302c  by_idx=2, k=100,
+00014a70: 206e 6f72 6d61 6c69 7a65 3d54 7275 6529   normalize=True)
+00014a80: 0a20 2020 2020 2020 203e 3e3e 2072 6573  .        >>> res
+00014a90: 756c 7473 203d 206e 702e 6873 7461 636b  ults = np.hstack
+00014aa0: 2828 6461 7461 5b3a 2c20 303a 325d 2c20  ((data[:, 0:2], 
+00014ab0: 6c6f 662e 7265 7368 6170 6528 6c6f 662e  lof.reshape(lof.
+00014ac0: 7368 6170 655b 305d 2c20 3129 2929 0a20  shape[0], 1))). 
+00014ad0: 2020 2020 2020 203e 3e3e 2050 6c6f 7474         >>> Plott
+00014ae0: 696e 674d 6978 696e 2e63 6f6e 7469 6e75  ingMixin.continu
+00014af0: 6f75 735f 7363 6174 7465 7228 6461 7461  ous_scatter(data
+00014b00: 3d72 6573 756c 7473 2c20 7061 6c65 7474  =results, palett
+00014b10: 653d 2773 6569 736d 6963 272c 2062 675f  e='seismic', bg_
+00014b20: 636c 723d 276c 6967 6874 6772 6579 272c  clr='lightgrey',
+00014b30: 7369 7a65 3d33 3029 0a20 2020 2020 2020  size=30).       
+00014b40: 2022 2222 0a0a 2020 2020 2020 2020 6465   """..        de
+00014b50: 6620 6765 745f 6c6f 6628 6461 7461 2c20  f get_lof(data, 
+00014b60: 6b2c 2063 6f6e 7461 6d69 6e61 7469 6f6e  k, contamination
+00014b70: 293a 0a20 2020 2020 2020 2020 2020 2063  ):.            c
+00014b80: 6865 636b 5f66 6c6f 6174 286e 616d 653d  heck_float(name=
+00014b90: 6622 7b53 7461 7469 7374 6963 732e 6c6f  f"{Statistics.lo
+00014ba0: 6361 6c5f 6f75 746c 6965 725f 6661 6374  cal_outlier_fact
+00014bb0: 6f72 2e5f 5f6e 616d 655f 5f7d 206b 222c  or.__name__} k",
+00014bc0: 2076 616c 7565 3d6b 290a 2020 2020 2020   value=k).      
+00014bd0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+00014be0: 6e63 6528 6b2c 2069 6e74 293a 0a20 2020  nce(k, int):.   
+00014bf0: 2020 2020 2020 2020 2020 2020 206b 203d               k =
+00014c00: 206d 696e 286b 2c20 6461 7461 2e73 6861   min(k, data.sha
+00014c10: 7065 5b30 5d29 0a20 2020 2020 2020 2020  pe[0]).         
+00014c20: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
+00014c30: 6365 286b 2c20 666c 6f61 7429 3a0a 2020  ce(k, float):.  
+00014c40: 2020 2020 2020 2020 2020 2020 2020 6b20                k 
+00014c50: 3d20 696e 7428 6461 7461 2e73 6861 7065  = int(data.shape
+00014c60: 5b30 5d20 2a20 6b29 0a20 2020 2020 2020  [0] * k).       
+00014c70: 2020 2020 206c 6f66 5f6d 6f64 656c 203d       lof_model =
+00014c80: 204c 6f63 616c 4f75 746c 6965 7246 6163   LocalOutlierFac
+00014c90: 746f 7228 6e5f 6e65 6967 6862 6f72 733d  tor(n_neighbors=
+00014ca0: 6b2c 2063 6f6e 7461 6d69 6e61 7469 6f6e  k, contamination
+00014cb0: 3d63 6f6e 7461 6d69 6e61 7469 6f6e 290a  =contamination).
+00014cc0: 2020 2020 2020 2020 2020 2020 5f20 3d20              _ = 
+00014cd0: 6c6f 665f 6d6f 6465 6c2e 6669 745f 7072  lof_model.fit_pr
+00014ce0: 6564 6963 7428 6461 7461 290a 2020 2020  edict(data).    
+00014cf0: 2020 2020 2020 2020 7920 3d20 2d6c 6f66          y = -lof
+00014d00: 5f6d 6f64 656c 2e6e 6567 6174 6976 655f  _model.negative_
+00014d10: 6f75 746c 6965 725f 6661 6374 6f72 5f2e  outlier_factor_.
+00014d20: 6173 7479 7065 286e 702e 666c 6f61 7433  astype(np.float3
+00014d30: 3229 0a20 2020 2020 2020 2020 2020 2069  2).            i
+00014d40: 6620 6e6f 726d 616c 697a 653a 0a20 2020  f normalize:.   
+00014d50: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00014d60: 7572 6e20 2879 202d 206e 702e 6d69 6e28  urn (y - np.min(
+00014d70: 7929 2920 2f20 286e 702e 6d61 7828 7929  y)) / (np.max(y)
+00014d80: 202d 206e 702e 6d69 6e28 7929 290a 2020   - np.min(y)).  
+00014d90: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00014da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014db0: 7265 7475 726e 2079 0a0a 2020 2020 2020  return y..      
+00014dc0: 2020 6966 2067 726f 7570 6279 5f69 6478    if groupby_idx
+00014dd0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+00014de0: 2020 2020 2020 2020 2020 6368 6563 6b5f            check_
+00014df0: 696e 7428 0a20 2020 2020 2020 2020 2020  int(.           
+00014e00: 2020 2020 206e 616d 653d 6622 7b53 7461       name=f"{Sta
+00014e10: 7469 7374 6963 732e 6c6f 6361 6c5f 6f75  tistics.local_ou
+00014e20: 746c 6965 725f 6661 6374 6f72 2e5f 5f6e  tlier_factor.__n
+00014e30: 616d 655f 5f7d 2067 726f 7570 6279 5f69  ame__} groupby_i
+00014e40: 6478 222c 0a20 2020 2020 2020 2020 2020  dx",.           
+00014e50: 2020 2020 2076 616c 7565 3d67 726f 7570       value=group
+00014e60: 6279 5f69 6478 2c0a 2020 2020 2020 2020  by_idx,.        
+00014e70: 2020 2020 2020 2020 6d69 6e5f 7661 6c75          min_valu
+00014e80: 653d 302c 0a20 2020 2020 2020 2020 2020  e=0,.           
+00014e90: 2020 2020 206d 6178 5f76 616c 7565 3d64       max_value=d
+00014ea0: 6174 612e 7368 6170 655b 315d 202d 2031  ata.shape[1] - 1
+00014eb0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+00014ec0: 2020 2020 2020 2020 2020 2020 6368 6563              chec
+00014ed0: 6b5f 7661 6c69 645f 6172 7261 7928 0a20  k_valid_array(. 
+00014ee0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00014ef0: 6f75 7263 653d 6622 7b53 7461 7469 7374  ource=f"{Statist
+00014f00: 6963 732e 6c6f 6361 6c5f 6f75 746c 6965  ics.local_outlie
+00014f10: 725f 6661 6374 6f72 2e5f 5f6e 616d 655f  r_factor.__name_
+00014f20: 5f7d 206c 6f63 616c 5f6f 7574 6c69 6572  _} local_outlier
+00014f30: 5f66 6163 746f 7222 2c0a 2020 2020 2020  _factor",.      
+00014f40: 2020 2020 2020 2020 2020 6461 7461 3d64            data=d
+00014f50: 6174 612c 0a20 2020 2020 2020 2020 2020  ata,.           
+00014f60: 2020 2020 2061 6363 6570 7465 645f 7369       accepted_si
+00014f70: 7a65 733d 5b32 5d2c 0a20 2020 2020 2020  zes=[2],.       
+00014f80: 2020 2020 2020 2020 206d 696e 5f61 7869           min_axi
+00014f90: 735f 313d 332c 0a20 2020 2020 2020 2020  s_1=3,.         
+00014fa0: 2020 2029 0a20 2020 2020 2020 2065 6c73     ).        els
+00014fb0: 653a 0a20 2020 2020 2020 2020 2020 2063  e:.            c
+00014fc0: 6865 636b 5f76 616c 6964 5f61 7272 6179  heck_valid_array
+00014fd0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00014fe0: 2020 736f 7572 6365 3d66 227b 5374 6174    source=f"{Stat
+00014ff0: 6973 7469 6373 2e6c 6f63 616c 5f6f 7574  istics.local_out
+00015000: 6c69 6572 5f66 6163 746f 722e 5f5f 6e61  lier_factor.__na
+00015010: 6d65 5f5f 7d20 6461 7461 222c 0a20 2020  me__} data",.   
+00015020: 2020 2020 2020 2020 2020 2020 2064 6174               dat
+00015030: 613d 6461 7461 2c0a 2020 2020 2020 2020  a=data,.        
+00015040: 2020 2020 2020 2020 6163 6365 7074 6564          accepted
+00015050: 5f73 697a 6573 3d5b 325d 2c0a 2020 2020  _sizes=[2],.    
+00015060: 2020 2020 2020 2020 2020 2020 6d69 6e5f              min_
+00015070: 6178 6973 5f31 3d32 2c0a 2020 2020 2020  axis_1=2,.      
+00015080: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00015090: 6368 6563 6b5f 666c 6f61 7428 0a20 2020  check_float(.   
+000150a0: 2020 2020 2020 2020 206e 616d 653d 6622           name=f"
+000150b0: 7b53 7461 7469 7374 6963 732e 6c6f 6361  {Statistics.loca
+000150c0: 6c5f 6f75 746c 6965 725f 6661 6374 6f72  l_outlier_factor
+000150d0: 2e5f 5f6e 616d 655f 5f7d 2063 6f6e 7461  .__name__} conta
+000150e0: 6d69 6e61 7469 6f6e 222c 0a20 2020 2020  mination",.     
+000150f0: 2020 2020 2020 2076 616c 7565 3d63 6f6e         value=con
+00015100: 7461 6d69 6e61 7469 6f6e 2c0a 2020 2020  tamination,.    
+00015110: 2020 2020 2020 2020 6d69 6e5f 7661 6c75          min_valu
+00015120: 653d 302e 302c 0a20 2020 2020 2020 2029  e=0.0,.        )
+00015130: 0a0a 2020 2020 2020 2020 6966 2067 726f  ..        if gro
+00015140: 7570 6279 5f69 6478 2069 7320 4e6f 6e65  upby_idx is None
+00015150: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00015160: 7475 726e 2067 6574 5f6c 6f66 2864 6174  turn get_lof(dat
+00015170: 612c 206b 2c20 636f 6e74 616d 696e 6174  a, k, contaminat
+00015180: 696f 6e29 0a20 2020 2020 2020 2065 6c73  ion).        els
+00015190: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+000151a0: 6573 756c 7473 203d 205b 5d0a 2020 2020  esults = [].    
+000151b0: 2020 2020 2020 2020 6461 7461 5f77 5f69          data_w_i
+000151c0: 6478 203d 206e 702e 6873 7461 636b 2828  dx = np.hstack((
+000151d0: 6e70 2e61 7261 6e67 6528 302c 2064 6174  np.arange(0, dat
+000151e0: 612e 7368 6170 655b 305d 292e 7265 7368  a.shape[0]).resh
+000151f0: 6170 6528 2d31 2c20 3129 2c20 6461 7461  ape(-1, 1), data
+00015200: 2929 0a20 2020 2020 2020 2020 2020 2075  )).            u
+00015210: 6e69 7175 655f 6320 3d20 6e70 2e75 6e69  nique_c = np.uni
+00015220: 7175 6528 6461 7461 5b3a 2c20 6772 6f75  que(data[:, grou
+00015230: 7062 795f 6964 785d 292e 6173 7479 7065  pby_idx]).astype
+00015240: 286e 702e 666c 6f61 7433 3229 0a20 2020  (np.float32).   
+00015250: 2020 2020 2020 2020 2069 6620 2d31 2e30           if -1.0
+00015260: 2069 6e20 756e 6971 7565 5f63 3a0a 2020   in unique_c:.  
+00015270: 2020 2020 2020 2020 2020 2020 2020 756e                un
+00015280: 6971 7565 5f63 203d 2075 6e69 7175 655f  ique_c = unique_
+00015290: 635b 6e70 2e77 6865 7265 2875 6e69 7175  c[np.where(uniqu
+000152a0: 655f 6320 213d 202d 3129 5d0a 2020 2020  e_c != -1)].    
+000152b0: 2020 2020 2020 2020 2020 2020 756e 636c              uncl
+000152c0: 7573 7465 7265 645f 6964 7820 3d20 6e70  ustered_idx = np
+000152d0: 2e61 7267 7768 6572 6528 6461 7461 5b3a  .argwhere(data[:
+000152e0: 2c20 6772 6f75 7062 795f 6964 785d 203d  , groupby_idx] =
+000152f0: 3d20 2d31 2e30 292e 666c 6174 7465 6e28  = -1.0).flatten(
+00015300: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00015310: 2020 756e 636c 7573 7465 7265 6420 3d20    unclustered = 
+00015320: 6461 7461 5f77 5f69 6478 5b75 6e63 6c75  data_w_idx[unclu
+00015330: 7374 6572 6564 5f69 6478 5d0a 2020 2020  stered_idx].    
+00015340: 2020 2020 2020 2020 2020 2020 6461 7461              data
+00015350: 5f77 5f69 6478 203d 206e 702e 6465 6c65  _w_idx = np.dele
+00015360: 7465 2864 6174 615f 775f 6964 782c 2075  te(data_w_idx, u
+00015370: 6e63 6c75 7374 6572 6564 5f69 6478 2c20  nclustered_idx, 
+00015380: 6178 6973 3d30 290a 2020 2020 2020 2020  axis=0).        
+00015390: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000153a0: 2020 2020 2020 2020 2020 756e 636c 7573            unclus
+000153b0: 7465 7265 6420 3d20 4e6f 6e65 0a20 2020  tered = None.   
+000153c0: 2020 2020 2020 2020 2066 6f72 2069 2069           for i i
+000153d0: 6e20 756e 6971 7565 5f63 3a0a 2020 2020  n unique_c:.    
+000153e0: 2020 2020 2020 2020 2020 2020 735f 6461              s_da
+000153f0: 7461 203d 2064 6174 615f 775f 6964 785b  ta = data_w_idx[
+00015400: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015410: 2020 2020 206e 702e 6172 6777 6865 7265       np.argwhere
+00015420: 2864 6174 615f 775f 6964 785b 3a2c 2067  (data_w_idx[:, g
+00015430: 726f 7570 6279 5f69 6478 202b 2031 5d20  roupby_idx + 1] 
+00015440: 3d3d 2069 290a 2020 2020 2020 2020 2020  == i).          
+00015450: 2020 2020 2020 5d2e 7265 7368 6170 6528        ].reshape(
+00015460: 2d31 2c20 6461 7461 5f77 5f69 6478 2e73  -1, data_w_idx.s
+00015470: 6861 7065 5b31 5d29 0a20 2020 2020 2020  hape[1]).       
+00015480: 2020 2020 2020 2020 2069 6478 203d 2073           idx = s
+00015490: 5f64 6174 615b 3a2c 2030 5d2e 7265 7368  _data[:, 0].resh
+000154a0: 6170 6528 735f 6461 7461 2e73 6861 7065  ape(s_data.shape
+000154b0: 5b30 5d2c 2031 290a 2020 2020 2020 2020  [0], 1).        
+000154c0: 2020 2020 2020 2020 735f 6461 7461 203d          s_data =
+000154d0: 206e 702e 6465 6c65 7465 2873 5f64 6174   np.delete(s_dat
+000154e0: 612c 205b 302c 2067 726f 7570 6279 5f69  a, [0, groupby_i
+000154f0: 6478 202b 2031 5d2c 2031 290a 2020 2020  dx + 1], 1).    
+00015500: 2020 2020 2020 2020 2020 2020 6c6f 6620              lof 
+00015510: 3d20 6765 745f 6c6f 6628 735f 6461 7461  = get_lof(s_data
+00015520: 2c20 6b2c 2063 6f6e 7461 6d69 6e61 7469  , k, contaminati
+00015530: 6f6e 292e 7265 7368 6170 6528 735f 6461  on).reshape(s_da
+00015540: 7461 2e73 6861 7065 5b30 5d2c 2031 290a  ta.shape[0], 1).
+00015550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015560: 7265 7375 6c74 732e 6170 7065 6e64 286e  results.append(n
+00015570: 702e 6873 7461 636b 2828 6964 782c 206c  p.hstack((idx, l
+00015580: 6f66 2929 290a 2020 2020 2020 2020 2020  of))).          
+00015590: 2020 7820 3d20 6e70 2e63 6f6e 6361 7465    x = np.concate
+000155a0: 6e61 7465 2872 6573 756c 7473 2c20 6178  nate(results, ax
+000155b0: 6973 3d30 290a 2020 2020 2020 2020 2020  is=0).          
+000155c0: 2020 6966 2075 6e63 6c75 7374 6572 6564    if unclustered
+000155d0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+000155e0: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
+000155f0: 785f 6c6f 6620 3d20 6e70 2e66 756c 6c28  x_lof = np.full(
+00015600: 2875 6e63 6c75 7374 6572 6564 2e73 6861  (unclustered.sha
+00015610: 7065 5b30 5d2c 2031 292c 206e 702e 6d61  pe[0], 1), np.ma
+00015620: 7828 785b 3a2c 202d 315d 2929 0a20 2020  x(x[:, -1])).   
+00015630: 2020 2020 2020 2020 2020 2020 2075 6e63               unc
+00015640: 6c75 7374 6572 6564 203d 206e 702e 6873  lustered = np.hs
+00015650: 7461 636b 2828 756e 636c 7573 7465 7265  tack((unclustere
+00015660: 642c 206d 6178 5f6c 6f66 2929 5b3a 2c20  d, max_lof))[:, 
+00015670: 5b30 2c20 2d31 5d5d 0a20 2020 2020 2020  [0, -1]].       
+00015680: 2020 2020 2020 2020 2078 203d 206e 702e           x = np.
+00015690: 7673 7461 636b 2828 782c 2075 6e63 6c75  vstack((x, unclu
+000156a0: 7374 6572 6564 2929 0a20 2020 2020 2020  stered)).       
+000156b0: 2020 2020 2072 6574 7572 6e20 785b 6e70       return x[np
+000156c0: 2e61 7267 736f 7274 2878 5b3a 2c20 305d  .argsort(x[:, 0]
+000156d0: 295d 5b3a 2c20 2d31 5d0a 0a20 2020 2064  )][:, -1]..    d
+000156e0: 6566 2065 6c6c 6970 7469 635f 656e 7665  ef elliptic_enve
+000156f0: 6c6f 7065 280a 2020 2020 2020 2020 6461  lope(.        da
+00015700: 7461 3a20 6e70 2e6e 6461 7272 6179 2c0a  ta: np.ndarray,.
+00015710: 2020 2020 2020 2020 636f 6e74 616d 696e          contamin
+00015720: 6174 696f 6e3a 204f 7074 696f 6e61 6c5b  ation: Optional[
+00015730: 666c 6f61 745d 203d 2031 652d 312c 0a20  float] = 1e-1,. 
+00015740: 2020 2020 2020 206e 6f72 6d61 6c69 7a65         normalize
+00015750: 3a20 4f70 7469 6f6e 616c 5b62 6f6f 6c5d  : Optional[bool]
+00015760: 203d 2046 616c 7365 2c0a 2020 2020 2020   = False,.      
+00015770: 2020 6772 6f75 7062 795f 6964 783a 204f    groupby_idx: O
+00015780: 7074 696f 6e61 6c5b 696e 745d 203d 204e  ptional[int] = N
+00015790: 6f6e 652c 0a20 2020 2029 202d 3e20 6e70  one,.    ) -> np
+000157a0: 2e6e 6461 7272 6179 3a0a 2020 2020 2020  .ndarray:.      
+000157b0: 2020 2222 220a 2020 2020 2020 2020 436f    """.        Co
+000157c0: 6d70 7574 6520 7468 6520 4d61 6861 6c61  mpute the Mahala
+000157d0: 6e6f 6269 7320 6469 7374 616e 6365 7320  nobis distances 
+000157e0: 6f66 2065 6163 6820 6f62 7365 7276 6174  of each observat
+000157f0: 696f 6e20 696e 2074 6865 2069 6e70 7574  ion in the input
+00015800: 2061 7272 6179 2075 7369 6e67 2045 6c6c   array using Ell
+00015810: 6970 7469 6320 456e 7665 6c6f 7065 206d  iptic Envelope m
+00015820: 6574 686f 642e 0a0a 2020 2020 2020 2020  ethod...        
+00015830: 2e2e 2069 6d61 6765 3a3a 205f 7374 6174  .. image:: _stat
+00015840: 6963 2f69 6d67 2f45 6c6c 6970 7469 6345  ic/img/EllipticE
+00015850: 6e76 656c 6f70 652e 706e 670a 2020 2020  nvelope.png.    
+00015860: 2020 2020 2020 203a 7769 6474 683a 2037         :width: 7
+00015870: 3030 0a20 2020 2020 2020 2020 2020 3a61  00.           :a
+00015880: 6c69 676e 3a20 6365 6e74 6572 0a0a 2020  lign: center..  
+00015890: 2020 2020 2020 2e2e 2069 6d61 6765 3a3a        .. image::
+000158a0: 205f 7374 6174 6963 2f69 6d67 2f65 6c6c   _static/img/ell
+000158b0: 6970 7469 635f 656e 7665 6c6f 7065 2e70  iptic_envelope.p
+000158c0: 6e67 0a20 2020 2020 2020 2020 2020 3a77  ng.           :w
+000158d0: 6964 7468 3a20 3730 300a 2020 2020 2020  idth: 700.      
+000158e0: 2020 2020 203a 616c 6967 6e3a 2063 656e       :align: cen
+000158f0: 7465 720a 0a20 2020 2020 2020 203a 7061  ter..        :pa
+00015900: 7261 6d20 6461 7461 3a20 496e 7075 7420  ram data: Input 
+00015910: 6461 7461 2061 7272 6179 206f 6620 7368  data array of sh
+00015920: 6170 6520 286e 5f73 616d 706c 6573 2c20  ape (n_samples, 
+00015930: 6e5f 6665 6174 7572 6573 292e 0a20 2020  n_features)..   
+00015940: 2020 2020 203a 7061 7261 6d20 4f70 7469       :param Opti
+00015950: 6f6e 616c 5b66 6c6f 6174 5d20 636f 6e74  onal[float] cont
+00015960: 616d 696e 6174 696f 6e3a 2054 6865 2070  amination: The p
+00015970: 726f 706f 7274 696f 6e20 6f66 206f 7574  roportion of out
+00015980: 6c69 6572 7320 746f 2062 6520 6173 7375  liers to be assu
+00015990: 6d65 6420 696e 2074 6865 2064 6174 612e  med in the data.
+000159a0: 2044 6566 6175 6c74 7320 746f 2030 2e31   Defaults to 0.1
+000159b0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000159c0: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
+000159d0: 6e6f 726d 616c 697a 653a 2057 6865 7468  normalize: Wheth
+000159e0: 6572 2074 6f20 6e6f 726d 616c 697a 6520  er to normalize 
+000159f0: 7468 6520 4d61 6861 6c61 6e6f 6269 7320  the Mahalanobis 
+00015a00: 6469 7374 616e 6365 7320 6265 7477 6565  distances betwee
+00015a10: 6e20 3020 616e 6420 312e 2044 6566 6175  n 0 and 1. Defau
+00015a20: 6c74 7320 746f 2054 7275 652e 0a20 2020  lts to True..   
+00015a30: 2020 2020 203a 7265 7475 726e 206e 702e       :return np.
+00015a40: 6e64 6172 7261 793a 2054 6865 204d 6168  ndarray: The Mah
+00015a50: 616c 616e 6f62 6973 2064 6973 7461 6e63  alanobis distanc
+00015a60: 6573 206f 6620 6561 6368 206f 6273 6572  es of each obser
+00015a70: 7661 7469 6f6e 2069 6e20 6172 7261 792e  vation in array.
+00015a80: 204c 6172 6765 7220 7661 6c75 6573 2069   Larger values i
+00015a90: 6e64 6963 6174 6520 6f75 746c 6965 7273  ndicate outliers
+00015aa0: 2e0a 0a20 2020 2020 2020 203a 6578 616d  ...        :exam
+00015ab0: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
+00015ac0: 2064 6174 612c 206c 626c 7320 3d20 6d61   data, lbls = ma
+00015ad0: 6b65 5f62 6c6f 6273 286e 5f73 616d 706c  ke_blobs(n_sampl
+00015ae0: 6573 3d32 3030 302c 206e 5f66 6561 7475  es=2000, n_featu
+00015af0: 7265 733d 322c 2063 656e 7465 7273 3d31  res=2, centers=1
+00015b00: 2c20 7261 6e64 6f6d 5f73 7461 7465 3d34  , random_state=4
+00015b10: 3229 0a20 2020 2020 2020 203e 3e3e 2065  2).        >>> e
+00015b20: 6e76 656c 6f70 655f 7363 6f72 6520 3d20  nvelope_score = 
+00015b30: 656c 6c69 7074 6963 5f65 6e76 656c 6f70  elliptic_envelop
+00015b40: 6528 6461 7461 3d64 6174 612c 206e 6f72  e(data=data, nor
+00015b50: 6d61 6c69 7a65 3d54 7275 6529 0a20 2020  malize=True).   
+00015b60: 2020 2020 203e 3e3e 2072 6573 756c 7473       >>> results
+00015b70: 203d 206e 702e 6873 7461 636b 2828 6461   = np.hstack((da
+00015b80: 7461 5b3a 2c20 303a 325d 2c20 656e 7665  ta[:, 0:2], enve
+00015b90: 6c6f 7065 5f73 636f 7265 2e72 6573 6861  lope_score.resha
+00015ba0: 7065 286c 6f66 2e73 6861 7065 5b30 5d2c  pe(lof.shape[0],
+00015bb0: 2031 2929 290a 2020 2020 2020 2020 3e3e   1))).        >>
+00015bc0: 3e20 7265 7375 6c74 7320 3d20 7064 2e44  > results = pd.D
+00015bd0: 6174 6146 7261 6d65 2872 6573 756c 7473  ataFrame(results
+00015be0: 2c20 636f 6c75 6d6e 733d 5b27 5827 2c20  , columns=['X', 
+00015bf0: 2759 272c 2027 454e 5645 4c4f 5045 2053  'Y', 'ENVELOPE S
+00015c00: 434f 5245 275d 290a 2020 2020 2020 2020  CORE']).        
+00015c10: 3e3e 3e20 506c 6f74 7469 6e67 4d69 7869  >>> PlottingMixi
+00015c20: 6e2e 636f 6e74 696e 756f 7573 5f73 6361  n.continuous_sca
+00015c30: 7474 6572 2864 6174 613d 7265 7375 6c74  tter(data=result
+00015c40: 732c 2070 616c 6574 7465 3d27 7365 6973  s, palette='seis
+00015c50: 6d69 6327 2c20 6267 5f63 6c72 3d27 6c69  mic', bg_clr='li
+00015c60: 6768 7467 7265 7927 2c20 636f 6c75 6d6e  ghtgrey', column
+00015c70: 733d 5b27 5827 2c20 2759 272c 2027 454e  s=['X', 'Y', 'EN
+00015c80: 5645 4c4f 5045 2053 434f 5245 275d 2c73  VELOPE SCORE'],s
+00015c90: 697a 653d 3330 290a 0a20 2020 2020 2020  ize=30)..       
+00015ca0: 2022 2222 0a0a 2020 2020 2020 2020 6465   """..        de
+00015cb0: 6620 6765 745f 656e 7665 6c6f 7065 2864  f get_envelope(d
+00015cc0: 6174 612c 2063 6f6e 7461 6d69 6e61 7469  ata, contaminati
+00015cd0: 6f6e 2920 2d3e 206e 702e 6e64 6172 7261  on) -> np.ndarra
+00015ce0: 793a 0a20 2020 2020 2020 2020 2020 206d  y:.            m
+00015cf0: 646c 203d 2045 6c6c 6970 7469 6345 6e76  dl = EllipticEnv
+00015d00: 656c 6f70 6528 636f 6e74 616d 696e 6174  elope(contaminat
+00015d10: 696f 6e3d 636f 6e74 616d 696e 6174 696f  ion=contaminatio
+00015d20: 6e29 2e66 6974 2864 6174 6129 0a20 2020  n).fit(data).   
+00015d30: 2020 2020 2020 2020 2079 203d 202d 6d64           y = -md
+00015d40: 6c2e 7363 6f72 655f 7361 6d70 6c65 7328  l.score_samples(
+00015d50: 6461 7461 290a 2020 2020 2020 2020 2020  data).          
+00015d60: 2020 6966 206e 6f72 6d61 6c69 7a65 3a0a    if normalize:.
+00015d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015d80: 7920 3d20 2879 202d 206e 702e 6d69 6e28  y = (y - np.min(
+00015d90: 7929 2920 2f20 286e 702e 6d61 7828 7929  y)) / (np.max(y)
+00015da0: 202d 206e 702e 6d69 6e28 7929 290a 2020   - np.min(y)).  
+00015db0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00015dc0: 2079 0a0a 2020 2020 2020 2020 6966 2067   y..        if g
+00015dd0: 726f 7570 6279 5f69 6478 2069 7320 6e6f  roupby_idx is no
+00015de0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+00015df0: 2020 2020 6368 6563 6b5f 696e 7428 0a20      check_int(. 
+00015e00: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00015e10: 616d 653d 6622 7b53 7461 7469 7374 6963  ame=f"{Statistic
+00015e20: 732e 656c 6c69 7074 6963 5f65 6e76 656c  s.elliptic_envel
+00015e30: 6f70 652e 5f5f 6e61 6d65 5f5f 7d20 6772  ope.__name__} gr
+00015e40: 6f75 7062 795f 6964 7822 2c0a 2020 2020  oupby_idx",.    
+00015e50: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+00015e60: 653d 6772 6f75 7062 795f 6964 782c 0a20  e=groupby_idx,. 
+00015e70: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00015e80: 696e 5f76 616c 7565 3d30 2c0a 2020 2020  in_value=0,.    
+00015e90: 2020 2020 2020 2020 2020 2020 6d61 785f              max_
+00015ea0: 7661 6c75 653d 6461 7461 2e73 6861 7065  value=data.shape
+00015eb0: 5b31 5d20 2d20 312c 0a20 2020 2020 2020  [1] - 1,.       
+00015ec0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00015ed0: 2020 2063 6865 636b 5f76 616c 6964 5f61     check_valid_a
+00015ee0: 7272 6179 280a 2020 2020 2020 2020 2020  rray(.          
+00015ef0: 2020 2020 2020 736f 7572 6365 3d66 227b        source=f"{
+00015f00: 5374 6174 6973 7469 6373 2e65 6c6c 6970  Statistics.ellip
+00015f10: 7469 635f 656e 7665 6c6f 7065 2e5f 5f6e  tic_envelope.__n
+00015f20: 616d 655f 5f7d 206c 6f63 616c 5f6f 7574  ame__} local_out
+00015f30: 6c69 6572 5f66 6163 746f 7222 2c0a 2020  lier_factor",.  
+00015f40: 2020 2020 2020 2020 2020 2020 2020 6461                da
+00015f50: 7461 3d64 6174 612c 0a20 2020 2020 2020  ta=data,.       
+00015f60: 2020 2020 2020 2020 2061 6363 6570 7465           accepte
+00015f70: 645f 7369 7a65 733d 5b32 5d2c 0a20 2020  d_sizes=[2],.   
+00015f80: 2020 2020 2020 2020 2020 2020 206d 696e               min
+00015f90: 5f61 7869 735f 313d 332c 0a20 2020 2020  _axis_1=3,.     
+00015fa0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00015fb0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00015fc0: 2020 2063 6865 636b 5f76 616c 6964 5f61     check_valid_a
+00015fd0: 7272 6179 280a 2020 2020 2020 2020 2020  rray(.          
+00015fe0: 2020 2020 2020 736f 7572 6365 3d66 227b        source=f"{
+00015ff0: 5374 6174 6973 7469 6373 2e65 6c6c 6970  Statistics.ellip
+00016000: 7469 635f 656e 7665 6c6f 7065 2e5f 5f6e  tic_envelope.__n
+00016010: 616d 655f 5f7d 2064 6174 6122 2c0a 2020  ame__} data",.  
+00016020: 2020 2020 2020 2020 2020 2020 2020 6461                da
+00016030: 7461 3d64 6174 612c 0a20 2020 2020 2020  ta=data,.       
+00016040: 2020 2020 2020 2020 2061 6363 6570 7465           accepte
+00016050: 645f 7369 7a65 733d 5b32 5d2c 0a20 2020  d_sizes=[2],.   
+00016060: 2020 2020 2020 2020 2020 2020 206d 696e               min
+00016070: 5f61 7869 735f 313d 322c 0a20 2020 2020  _axis_1=2,.     
+00016080: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+00016090: 2020 6368 6563 6b5f 666c 6f61 7428 0a20    check_float(. 
+000160a0: 2020 2020 2020 2020 2020 206e 616d 653d             name=
+000160b0: 6622 7b53 7461 7469 7374 6963 732e 656c  f"{Statistics.el
+000160c0: 6c69 7074 6963 5f65 6e76 656c 6f70 652e  liptic_envelope.
+000160d0: 5f5f 6e61 6d65 5f5f 7d20 636f 6e74 616d  __name__} contam
+000160e0: 696e 6174 696f 6e22 2c0a 2020 2020 2020  ination",.      
+000160f0: 2020 2020 2020 7661 6c75 653d 636f 6e74        value=cont
+00016100: 616d 696e 6174 696f 6e2c 0a20 2020 2020  amination,.     
+00016110: 2020 2020 2020 206d 696e 5f76 616c 7565         min_value
+00016120: 3d30 2e30 2c0a 2020 2020 2020 2020 2020  =0.0,.          
+00016130: 2020 6d61 785f 7661 6c75 653d 312e 302c    max_value=1.0,
+00016140: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00016150: 2020 2069 6620 6772 6f75 7062 795f 6964     if groupby_id
+00016160: 7820 6973 204e 6f6e 653a 0a20 2020 2020  x is None:.     
+00016170: 2020 2020 2020 2072 6574 7572 6e20 6765         return ge
+00016180: 745f 656e 7665 6c6f 7065 2864 6174 612c  t_envelope(data,
+00016190: 2063 6f6e 7461 6d69 6e61 7469 6f6e 290a   contamination).
+000161a0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+000161b0: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+000161c0: 7320 3d20 5b5d 0a20 2020 2020 2020 2020  s = [].         
+000161d0: 2020 2064 6174 615f 775f 6964 7820 3d20     data_w_idx = 
+000161e0: 6e70 2e68 7374 6163 6b28 286e 702e 6172  np.hstack((np.ar
+000161f0: 616e 6765 2830 2c20 6461 7461 2e73 6861  ange(0, data.sha
+00016200: 7065 5b30 5d29 2e72 6573 6861 7065 282d  pe[0]).reshape(-
+00016210: 312c 2031 292c 2064 6174 6129 290a 2020  1, 1), data)).  
+00016220: 2020 2020 2020 2020 2020 756e 6971 7565            unique
+00016230: 5f63 203d 206e 702e 756e 6971 7565 2864  _c = np.unique(d
+00016240: 6174 615b 3a2c 2067 726f 7570 6279 5f69  ata[:, groupby_i
+00016250: 6478 5d29 2e61 7374 7970 6528 6e70 2e66  dx]).astype(np.f
+00016260: 6c6f 6174 3332 290a 2020 2020 2020 2020  loat32).        
+00016270: 2020 2020 6966 202d 312e 3020 696e 2075      if -1.0 in u
+00016280: 6e69 7175 655f 633a 0a20 2020 2020 2020  nique_c:.       
+00016290: 2020 2020 2020 2020 2075 6e69 7175 655f           unique_
+000162a0: 6320 3d20 756e 6971 7565 5f63 5b6e 702e  c = unique_c[np.
+000162b0: 7768 6572 6528 756e 6971 7565 5f63 2021  where(unique_c !
+000162c0: 3d20 2d31 295d 0a20 2020 2020 2020 2020  = -1)].         
+000162d0: 2020 2020 2020 2075 6e63 6c75 7374 6572         uncluster
+000162e0: 6564 5f69 6478 203d 206e 702e 6172 6777  ed_idx = np.argw
+000162f0: 6865 7265 2864 6174 615b 3a2c 2067 726f  here(data[:, gro
+00016300: 7570 6279 5f69 6478 5d20 3d3d 202d 312e  upby_idx] == -1.
+00016310: 3029 2e66 6c61 7474 656e 2829 0a20 2020  0).flatten().   
+00016320: 2020 2020 2020 2020 2020 2020 2075 6e63               unc
+00016330: 6c75 7374 6572 6564 203d 2064 6174 615f  lustered = data_
+00016340: 775f 6964 785b 756e 636c 7573 7465 7265  w_idx[unclustere
+00016350: 645f 6964 785d 0a20 2020 2020 2020 2020  d_idx].         
+00016360: 2020 2020 2020 2064 6174 615f 775f 6964         data_w_id
+00016370: 7820 3d20 6e70 2e64 656c 6574 6528 6461  x = np.delete(da
+00016380: 7461 5f77 5f69 6478 2c20 756e 636c 7573  ta_w_idx, unclus
+00016390: 7465 7265 645f 6964 782c 2061 7869 733d  tered_idx, axis=
+000163a0: 3029 0a20 2020 2020 2020 2020 2020 2065  0).            e
+000163b0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+000163c0: 2020 2020 2075 6e63 6c75 7374 6572 6564       unclustered
+000163d0: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
+000163e0: 2020 2020 666f 7220 6920 696e 2075 6e69      for i in uni
+000163f0: 7175 655f 633a 0a20 2020 2020 2020 2020  que_c:.         
+00016400: 2020 2020 2020 2073 5f64 6174 6120 3d20         s_data = 
+00016410: 6461 7461 5f77 5f69 6478 5b0a 2020 2020  data_w_idx[.    
+00016420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016430: 6e70 2e61 7267 7768 6572 6528 6461 7461  np.argwhere(data
+00016440: 5f77 5f69 6478 5b3a 2c20 6772 6f75 7062  _w_idx[:, groupb
+00016450: 795f 6964 7820 2b20 315d 203d 3d20 6929  y_idx + 1] == i)
+00016460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016470: 205d 2e72 6573 6861 7065 282d 312c 2064   ].reshape(-1, d
+00016480: 6174 615f 775f 6964 782e 7368 6170 655b  ata_w_idx.shape[
+00016490: 315d 290a 2020 2020 2020 2020 2020 2020  1]).            
+000164a0: 2020 2020 6964 7820 3d20 735f 6461 7461      idx = s_data
+000164b0: 5b3a 2c20 305d 2e72 6573 6861 7065 2873  [:, 0].reshape(s
+000164c0: 5f64 6174 612e 7368 6170 655b 305d 2c20  _data.shape[0], 
+000164d0: 3129 0a20 2020 2020 2020 2020 2020 2020  1).             
+000164e0: 2020 2073 5f64 6174 6120 3d20 6e70 2e64     s_data = np.d
+000164f0: 656c 6574 6528 735f 6461 7461 2c20 5b30  elete(s_data, [0
+00016500: 2c20 6772 6f75 7062 795f 6964 7820 2b20  , groupby_idx + 
+00016510: 315d 2c20 3129 0a20 2020 2020 2020 2020  1], 1).         
+00016520: 2020 2020 2020 206c 6f66 203d 2067 6574         lof = get
+00016530: 5f65 6e76 656c 6f70 6528 735f 6461 7461  _envelope(s_data
+00016540: 2c20 636f 6e74 616d 696e 6174 696f 6e29  , contamination)
+00016550: 2e72 6573 6861 7065 2873 5f64 6174 612e  .reshape(s_data.
+00016560: 7368 6170 655b 305d 2c20 3129 0a20 2020  shape[0], 1).   
+00016570: 2020 2020 2020 2020 2020 2020 2072 6573               res
+00016580: 756c 7473 2e61 7070 656e 6428 6e70 2e68  ults.append(np.h
+00016590: 7374 6163 6b28 2869 6478 2c20 6c6f 6629  stack((idx, lof)
+000165a0: 2929 0a20 2020 2020 2020 2020 2020 2078  )).            x
+000165b0: 203d 206e 702e 636f 6e63 6174 656e 6174   = np.concatenat
+000165c0: 6528 7265 7375 6c74 732c 2061 7869 733d  e(results, axis=
+000165d0: 3029 0a20 2020 2020 2020 2020 2020 2069  0).            i
+000165e0: 6620 756e 636c 7573 7465 7265 6420 6973  f unclustered is
+000165f0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+00016600: 2020 2020 2020 2020 2020 206d 6178 5f65             max_e
+00016610: 6e76 5f73 636f 7265 203d 206e 702e 6675  nv_score = np.fu
+00016620: 6c6c 2828 756e 636c 7573 7465 7265 642e  ll((unclustered.
+00016630: 7368 6170 655b 305d 2c20 3129 2c20 6e70  shape[0], 1), np
+00016640: 2e6d 6178 2878 5b3a 2c20 2d31 5d29 290a  .max(x[:, -1])).
+00016650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016660: 756e 636c 7573 7465 7265 6420 3d20 6e70  unclustered = np
+00016670: 2e68 7374 6163 6b28 2875 6e63 6c75 7374  .hstack((unclust
+00016680: 6572 6564 2c20 6d61 785f 656e 765f 7363  ered, max_env_sc
+00016690: 6f72 6529 295b 3a2c 205b 302c 202d 315d  ore))[:, [0, -1]
+000166a0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+000166b0: 2020 7820 3d20 6e70 2e76 7374 6163 6b28    x = np.vstack(
+000166c0: 2878 2c20 756e 636c 7573 7465 7265 6429  (x, unclustered)
+000166d0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+000166e0: 7475 726e 2078 5b6e 702e 6172 6773 6f72  turn x[np.argsor
+000166f0: 7428 785b 3a2c 2030 5d29 5d5b 3a2c 202d  t(x[:, 0])][:, -
+00016700: 315d 0a0a 2020 2020 4073 7461 7469 636d  1]..    @staticm
+00016710: 6574 686f 640a 2020 2020 406a 6974 286e  ethod.    @jit(n
+00016720: 6f70 7974 686f 6e3d 5472 7565 290a 2020  opython=True).  
+00016730: 2020 6465 6620 5f68 626f 735f 636f 6d70    def _hbos_comp
+00016740: 7574 6528 0a20 2020 2020 2020 2064 6174  ute(.        dat
+00016750: 613a 206e 702e 6e64 6172 7261 792c 2068  a: np.ndarray, h
+00016760: 6973 746f 6772 616d 733a 2074 7970 6564  istograms: typed
+00016770: 2e44 6963 742c 2068 6973 746f 6772 616d  .Dict, histogram
+00016780: 5f65 6467 6573 3a20 7479 7065 642e 4469  _edges: typed.Di
+00016790: 6374 0a20 2020 2029 202d 3e20 6e70 2e6e  ct.    ) -> np.n
+000167a0: 6461 7272 6179 3a0a 2020 2020 2020 2020  darray:.        
+000167b0: 2222 220a 2020 2020 2020 2020 4a69 7474  """.        Jitt
+000167c0: 6564 2068 656c 7065 7220 746f 2063 6f6d  ed helper to com
+000167d0: 7075 7465 2048 6973 746f 6772 616d 2d62  pute Histogram-b
+000167e0: 6173 6564 204f 7574 6c69 6572 2053 636f  ased Outlier Sco
+000167f0: 7265 2028 4842 4f53 2920 6361 6c6c 6564  re (HBOS) called
+00016800: 2062 7920 6060 7369 6d62 612e 6d69 7869   by ``simba.mixi
+00016810: 6e73 2e73 7461 7469 7374 6963 735f 6d69  ns.statistics_mi
+00016820: 7869 6e2e 5374 6174 6973 7469 6373 2e68  xin.Statistics.h
+00016830: 626f 7360 602e 0a0a 2020 2020 2020 2020  bos``...        
+00016840: 3a70 6172 616d 6574 6572 206e 702e 6e64  :parameter np.nd
+00016850: 6172 7261 7920 6461 7461 3a20 3264 2061  array data: 2d a
+00016860: 7272 6179 2077 6974 6820 6672 616d 6573  rray with frames
+00016870: 2072 6570 7265 7365 6e74 6564 2062 7920   represented by 
+00016880: 726f 7773 2061 6e64 2063 6f6c 756d 6e73  rows and columns
+00016890: 2072 6570 7265 7365 6e74 696e 6720 6665   representing fe
+000168a0: 6174 7572 6520 7661 6c75 6573 2e0a 2020  ature values..  
+000168b0: 2020 2020 2020 3a70 6172 616d 6574 6572        :parameter
+000168c0: 2074 7970 6564 2e44 6963 7420 6869 7374   typed.Dict hist
+000168d0: 6f67 7261 6d73 3a20 4e75 6d62 6120 7479  ograms: Numba ty
+000168e0: 7065 642e 4469 6374 2077 6974 6820 696e  ped.Dict with in
+000168f0: 7465 6765 7220 6b65 7973 2028 7265 7072  teger keys (repr
+00016900: 6573 656e 7469 6e67 206f 7264 6572 206f  esenting order o
+00016910: 6620 6665 6174 7572 6529 2061 6e64 2031  f feature) and 1
+00016920: 6420 6172 7261 7973 2061 7320 7661 6c75  d arrays as valu
+00016930: 6573 2072 6570 7265 7365 6e74 696e 6720  es representing 
+00016940: 6f62 7365 7276 6174 696f 6e20 6269 6e20  observation bin 
+00016950: 636f 756e 7473 2e0a 2020 2020 2020 2020  counts..        
+00016960: 3a70 6172 616d 6574 6572 3a20 7479 7065  :parameter: type
+00016970: 642e 4469 6374 2068 6973 746f 6772 616d  d.Dict histogram
+00016980: 5f65 6467 6573 3a20 4e75 6d62 6120 7479  _edges: Numba ty
+00016990: 7065 642e 4469 6374 2077 6974 6820 696e  ped.Dict with in
+000169a0: 7465 6765 7220 6b65 7973 2028 7265 7072  teger keys (repr
+000169b0: 6573 656e 7469 6e67 206f 7264 6572 206f  esenting order o
+000169c0: 6620 6665 6174 7572 6529 2061 6e64 2031  f feature) and 1
+000169d0: 6420 6172 7261 7973 2061 7320 7661 6c75  d arrays as valu
+000169e0: 6573 2072 6570 7265 7365 6e74 696e 6720  es representing 
+000169f0: 6269 6e20 6564 6765 732e 0a20 2020 2020  bin edges..     
+00016a00: 2020 203a 7265 7475 726e 206e 702e 6e64     :return np.nd
+00016a10: 6172 7261 793a 2041 7272 6179 206f 6620  array: Array of 
+00016a20: 7369 7a65 2064 6174 612e 7368 6170 655b  size data.shape[
+00016a30: 305d 2072 6570 7265 7365 6e74 696e 6720  0] representing 
+00016a40: 6f75 746c 6965 7220 7363 6f72 6573 2c20  outlier scores, 
+00016a50: 7769 7468 2068 6967 6865 7220 7661 6c75  with higher valu
+00016a60: 6573 2072 6570 7265 7365 6e74 696e 6720  es representing 
+00016a70: 6772 6561 7465 7220 6f75 746c 6965 7273  greater outliers
+00016a80: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
+00016a90: 2020 2020 2020 2072 6573 756c 7473 203d         results =
+00016aa0: 206e 702e 6675 6c6c 2828 6461 7461 2e73   np.full((data.s
+00016ab0: 6861 7065 5b30 5d29 2c20 6e70 2e6e 616e  hape[0]), np.nan
+00016ac0: 290a 2020 2020 2020 2020 6461 7461 203d  ).        data =
+00016ad0: 2064 6174 612e 6173 7479 7065 286e 702e   data.astype(np.
+00016ae0: 666c 6f61 7433 3229 0a20 2020 2020 2020  float32).       
+00016af0: 2066 6f72 2069 2069 6e20 7072 616e 6765   for i in prange
+00016b00: 2864 6174 612e 7368 6170 655b 305d 293a  (data.shape[0]):
+00016b10: 0a20 2020 2020 2020 2020 2020 2073 636f  .            sco
+00016b20: 7265 203d 2030 2e30 0a20 2020 2020 2020  re = 0.0.       
+00016b30: 2020 2020 2066 6f72 206a 2069 6e20 7072       for j in pr
+00016b40: 616e 6765 2864 6174 612e 7368 6170 655b  ange(data.shape[
+00016b50: 315d 293a 0a20 2020 2020 2020 2020 2020  1]):.           
+00016b60: 2020 2020 2076 616c 7565 2c20 6269 6e5f       value, bin_
+00016b70: 6964 7820 3d20 6461 7461 5b69 5d5b 6a5d  idx = data[i][j]
+00016b80: 2c20 6e70 2e6e 616e 0a20 2020 2020 2020  , np.nan.       
+00016b90: 2020 2020 2020 2020 2066 6f72 206b 2069           for k i
+00016ba0: 6e20 6e70 2e61 7261 6e67 6528 6869 7374  n np.arange(hist
+00016bb0: 6f67 7261 6d5f 6564 6765 735b 6a5d 2e73  ogram_edges[j].s
+00016bc0: 6861 7065 5b30 5d2c 2030 2c20 2d31 293a  hape[0], 0, -1):
+00016bd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016be0: 2020 2020 2062 696e 5f6d 6178 2c20 6269       bin_max, bi
+00016bf0: 6e5f 6d69 6e20 3d20 6869 7374 6f67 7261  n_min = histogra
+00016c00: 6d5f 6564 6765 735b 6a5d 5b6b 5d2c 2068  m_edges[j][k], h
+00016c10: 6973 746f 6772 616d 5f65 6467 6573 5b6a  istogram_edges[j
+00016c20: 5d5b 6b20 2d20 315d 0a20 2020 2020 2020  ][k - 1].       
+00016c30: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00016c40: 2876 616c 7565 203c 3d20 6269 6e5f 6d61  (value <= bin_ma
+00016c50: 7829 2061 6e64 2028 7661 6c75 6520 3e20  x) and (value > 
+00016c60: 6269 6e5f 6d69 6e29 3a0a 2020 2020 2020  bin_min):.      
+00016c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016c80: 2020 6269 6e5f 6964 7820 3d20 6b0a 2020    bin_idx = k.  
+00016c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016ca0: 2020 2020 2020 636f 6e74 696e 7565 0a20        continue. 
+00016cb0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00016cc0: 6620 6e70 2e69 736e 616e 2862 696e 5f69  f np.isnan(bin_i
+00016cd0: 6478 293a 0a20 2020 2020 2020 2020 2020  dx):.           
+00016ce0: 2020 2020 2020 2020 2062 696e 5f69 6478           bin_idx
+00016cf0: 203d 2030 0a20 2020 2020 2020 2020 2020   = 0.           
+00016d00: 2020 2020 2073 636f 7265 202b 3d20 2d6e       score += -n
+00016d10: 702e 6c6f 6728 6869 7374 6f67 7261 6d73  p.log(histograms
+00016d20: 5b6a 5d5b 696e 7428 6269 6e5f 6964 7829  [j][int(bin_idx)
+00016d30: 202d 2031 5d20 2b20 3165 2d31 3029 0a20   - 1] + 1e-10). 
+00016d40: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+00016d50: 7473 5b69 5d20 3d20 7363 6f72 650a 2020  ts[i] = score.  
+00016d60: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+00016d70: 756c 7473 0a0a 2020 2020 6465 6620 6862  ults..    def hb
+00016d80: 6f73 280a 2020 2020 2020 2020 7365 6c66  os(.        self
+00016d90: 2c0a 2020 2020 2020 2020 6461 7461 3a20  ,.        data: 
+00016da0: 6e70 2e6e 6461 7272 6179 2c0a 2020 2020  np.ndarray,.    
+00016db0: 2020 2020 6275 636b 6574 5f6d 6574 686f      bucket_metho
+00016dc0: 643a 204c 6974 6572 616c 5b0a 2020 2020  d: Literal[.    
+00016dd0: 2020 2020 2020 2020 2266 6422 2c20 2264          "fd", "d
+00016de0: 6f61 6e65 222c 2022 6175 746f 222c 2022  oane", "auto", "
+00016df0: 7363 6f74 7422 2c20 2273 746f 6e65 222c  scott", "stone",
+00016e00: 2022 7269 6365 222c 2022 7374 7572 6765   "rice", "sturge
+00016e10: 7322 2c20 2273 7172 7422 0a20 2020 2020  s", "sqrt".     
+00016e20: 2020 205d 203d 2022 6175 746f 222c 0a20     ] = "auto",. 
+00016e30: 2020 2029 202d 3e20 6e70 2e6e 6461 7272     ) -> np.ndarr
+00016e40: 6179 3a0a 2020 2020 2020 2020 2222 220a  ay:.        """.
+00016e50: 2020 2020 2020 2020 4a69 7474 6564 2063          Jitted c
+00016e60: 6f6d 7075 7465 206f 6620 4869 7374 6f67  ompute of Histog
+00016e70: 7261 6d2d 6261 7365 6420 4f75 746c 6965  ram-based Outlie
+00016e80: 7220 5363 6f72 6573 2028 4842 4f53 292e  r Scores (HBOS).
+00016e90: 2048 424f 5320 7175 616e 7469 6669 6573   HBOS quantifies
+00016ea0: 2074 6865 2061 626e 6f72 6d61 6c69 7479   the abnormality
+00016eb0: 206f 6620 6461 7461 2070 6f69 6e74 7320   of data points 
+00016ec0: 6261 7365 6420 6f6e 2074 6865 2064 656e  based on the den
+00016ed0: 7369 7469 6573 206f 6620 7468 6569 7220  sities of their 
+00016ee0: 6665 6174 7572 6520 7661 6c75 6573 0a20  feature values. 
+00016ef0: 2020 2020 2020 2077 6974 6869 6e20 7468         within th
+00016f00: 6569 7220 7265 7370 6563 7469 7665 2062  eir respective b
+00016f10: 7563 6b65 7473 206f 7665 7220 616c 6c20  uckets over all 
+00016f20: 6665 6174 7572 6520 7661 6c75 6573 2e0a  feature values..
+00016f30: 0a20 2020 2020 2020 203a 7061 7261 6d65  .        :parame
+00016f40: 7465 7220 6e70 2e6e 6461 7272 6179 2064  ter np.ndarray d
+00016f50: 6174 613a 2032 6420 6172 7261 7920 7769  ata: 2d array wi
+00016f60: 7468 2066 7261 6d65 7320 7265 7072 6573  th frames repres
+00016f70: 656e 7465 6420 6279 2072 6f77 7320 616e  ented by rows an
+00016f80: 6420 636f 6c75 6d6e 7320 7265 7072 6573  d columns repres
+00016f90: 656e 7469 6e67 2066 6561 7475 7265 2076  enting feature v
+00016fa0: 616c 7565 732e 0a20 2020 2020 2020 203a  alues..        :
+00016fb0: 7061 7261 6d65 7465 7220 4c69 7465 7261  parameter Litera
+00016fc0: 6c20 6275 636b 6574 5f6d 6574 686f 643a  l bucket_method:
+00016fd0: 2045 7374 696d 6174 6f72 2064 6574 6572   Estimator deter
+00016fe0: 6d69 6e69 6e67 206f 7074 696d 616c 2062  mining optimal b
+00016ff0: 7563 6b65 7420 636f 756e 7420 616e 6420  ucket count and 
+00017000: 6275 636b 6574 2077 6964 7468 2e20 4465  bucket width. De
+00017010: 6661 756c 743a 2054 6865 206d 6178 696d  fault: The maxim
+00017020: 756d 206f 6620 7468 6520 5374 7572 6765  um of the Sturge
+00017030: 7320 616e 6420 4672 6565 646d 616e 2d44  s and Freedman-D
+00017040: 6961 636f 6e69 7320 6573 7469 6d61 746f  iaconis estimato
+00017050: 7273 2e0a 2020 2020 2020 2020 3a72 6574  rs..        :ret
+00017060: 7572 6e20 6e70 2e6e 6461 7272 6179 3a20  urn np.ndarray: 
+00017070: 4172 7261 7920 6f66 2073 697a 6520 6461  Array of size da
+00017080: 7461 2e73 6861 7065 5b30 5d20 7265 7072  ta.shape[0] repr
+00017090: 6573 656e 7469 6e67 206f 7574 6c69 6572  esenting outlier
+000170a0: 2073 636f 7265 732c 2077 6974 6820 6869   scores, with hi
+000170b0: 6768 6572 2076 616c 7565 7320 7265 7072  gher values repr
+000170c0: 6573 656e 7469 6e67 2067 7265 6174 6572  esenting greater
+000170d0: 206f 7574 6c69 6572 732e 0a0a 2020 2020   outliers...    
+000170e0: 2020 2020 2e2e 2069 6d61 6765 3a3a 205f      .. image:: _
+000170f0: 7374 6174 6963 2f69 6d67 2f68 626f 732e  static/img/hbos.
+00017100: 706e 670a 2020 2020 2020 2020 2020 203a  png.           :
+00017110: 7769 6474 683a 2031 3230 300a 2020 2020  width: 1200.    
+00017120: 2020 2020 2020 203a 616c 6967 6e3a 2063         :align: c
+00017130: 656e 7465 720a 0a20 2020 2020 2020 203a  enter..        :
+00017140: 6578 616d 706c 653a 0a20 2020 2020 2020  example:.       
+00017150: 203e 3e3e 2073 616d 706c 655f 3120 3d20   >>> sample_1 = 
+00017160: 6e70 2e72 616e 646f 6d2e 7261 6e64 6f6d  np.random.random
+00017170: 5f69 6e74 6567 6572 7328 6c6f 773d 312c  _integers(low=1,
+00017180: 2068 6967 683d 322c 2073 697a 653d 2831   high=2, size=(1
+00017190: 302c 2035 3029 292e 6173 7479 7065 286e  0, 50)).astype(n
+000171a0: 702e 666c 6f61 7436 3429 0a20 2020 2020  p.float64).     
+000171b0: 2020 203e 3e3e 2073 616d 706c 655f 3220     >>> sample_2 
+000171c0: 3d20 6e70 2e72 616e 646f 6d2e 7261 6e64  = np.random.rand
+000171d0: 6f6d 5f69 6e74 6567 6572 7328 6c6f 773d  om_integers(low=
+000171e0: 372c 2068 6967 683d 3230 2c20 7369 7a65  7, high=20, size
+000171f0: 3d28 322c 2035 3029 292e 6173 7479 7065  =(2, 50)).astype
+00017200: 286e 702e 666c 6f61 7436 3429 0a20 2020  (np.float64).   
+00017210: 2020 2020 203e 3e3e 2064 6174 6120 3d20       >>> data = 
+00017220: 6e70 2e76 7374 6163 6b28 5b73 616d 706c  np.vstack([sampl
+00017230: 655f 312c 2073 616d 706c 655f 325d 290a  e_1, sample_2]).
+00017240: 2020 2020 2020 2020 3e3e 3e20 5374 6174          >>> Stat
+00017250: 6973 7469 6373 2829 2e68 626f 7328 6461  istics().hbos(da
+00017260: 7461 3d64 6174 6129 0a20 2020 2020 2020  ta=data).       
+00017270: 2022 2222 0a0a 2020 2020 2020 2020 6368   """..        ch
+00017280: 6563 6b5f 7661 6c69 645f 6172 7261 7928  eck_valid_array(
+00017290: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
+000172a0: 613d 6461 7461 2c0a 2020 2020 2020 2020  a=data,.        
+000172b0: 2020 2020 736f 7572 6365 3d66 227b 5374      source=f"{St
+000172c0: 6174 6973 7469 6373 2e5f 5f63 6c61 7373  atistics.__class
+000172d0: 5f5f 2e5f 5f6e 616d 655f 5f7d 2064 6174  __.__name__} dat
+000172e0: 6122 2c0a 2020 2020 2020 2020 2020 2020  a",.            
+000172f0: 6163 6365 7074 6564 5f73 697a 6573 3d5b  accepted_sizes=[
+00017300: 325d 2c0a 2020 2020 2020 2020 290a 2020  2],.        ).  
+00017310: 2020 2020 2020 6368 6563 6b5f 7374 7228        check_str(
+00017320: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
+00017330: 653d 6622 7b53 7461 7469 7374 6963 732e  e=f"{Statistics.
+00017340: 5f5f 636c 6173 735f 5f2e 5f5f 6e61 6d65  __class__.__name
+00017350: 5f5f 7d20 6275 636b 6574 5f6d 6574 686f  __} bucket_metho
+00017360: 6422 2c0a 2020 2020 2020 2020 2020 2020  d",.            
+00017370: 7661 6c75 653d 6275 636b 6574 5f6d 6574  value=bucket_met
+00017380: 686f 642c 0a20 2020 2020 2020 2020 2020  hod,.           
+00017390: 206f 7074 696f 6e73 3d4f 7074 696f 6e73   options=Options
+000173a0: 2e42 5543 4b45 545f 4d45 5448 4f44 532e  .BUCKET_METHODS.
+000173b0: 7661 6c75 652c 0a20 2020 2020 2020 2029  value,.        )
+000173c0: 0a20 2020 2020 2020 206d 696e 5f76 616c  .        min_val
+000173d0: 732c 206d 6178 5f76 616c 7320 3d20 6e70  s, max_vals = np
+000173e0: 2e6d 696e 2864 6174 612c 2061 7869 733d  .min(data, axis=
+000173f0: 3029 2c20 6e70 2e6d 6178 2864 6174 612c  0), np.max(data,
+00017400: 2061 7869 733d 3029 0a20 2020 2020 2020   axis=0).       
+00017410: 2064 6174 6120 3d20 2864 6174 6120 2d20   data = (data - 
+00017420: 6d69 6e5f 7661 6c73 2920 2f20 286d 6178  min_vals) / (max
+00017430: 5f76 616c 7320 2d20 6d69 6e5f 7661 6c73  _vals - min_vals
+00017440: 2920 2a20 2831 202d 2030 2920 2b20 300a  ) * (1 - 0) + 0.
+00017450: 2020 2020 2020 2020 6869 7374 6f67 7261          histogra
+00017460: 6d5f 6564 6765 7320 3d20 7479 7065 642e  m_edges = typed.
+00017470: 4469 6374 2e65 6d70 7479 280a 2020 2020  Dict.empty(.    
+00017480: 2020 2020 2020 2020 6b65 795f 7479 7065          key_type
+00017490: 3d74 7970 6573 2e69 6e74 3634 2c20 7661  =types.int64, va
+000174a0: 6c75 655f 7479 7065 3d74 7970 6573 2e66  lue_type=types.f
+000174b0: 6c6f 6174 3634 5b3a 5d0a 2020 2020 2020  loat64[:].      
+000174c0: 2020 290a 2020 2020 2020 2020 6869 7374    ).        hist
+000174d0: 6f67 7261 6d73 203d 2074 7970 6564 2e44  ograms = typed.D
+000174e0: 6963 742e 656d 7074 7928 6b65 795f 7479  ict.empty(key_ty
+000174f0: 7065 3d74 7970 6573 2e69 6e74 3634 2c20  pe=types.int64, 
+00017500: 7661 6c75 655f 7479 7065 3d74 7970 6573  value_type=types
+00017510: 2e69 6e74 3634 5b3a 5d29 0a20 2020 2020  .int64[:]).     
+00017520: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+00017530: 6528 6461 7461 2e73 6861 7065 5b31 5d29  e(data.shape[1])
+00017540: 3a0a 2020 2020 2020 2020 2020 2020 6269  :.            bi
+00017550: 6e5f 7769 6474 682c 2062 696e 5f63 6f75  n_width, bin_cou
+00017560: 6e74 203d 2062 7563 6b65 745f 6461 7461  nt = bucket_data
+00017570: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00017580: 2020 6461 7461 3d64 6174 615b 3a2c 2069    data=data[:, i
+00017590: 5d2e 666c 6174 7465 6e28 292c 206d 6574  ].flatten(), met
+000175a0: 686f 643d 6275 636b 6574 5f6d 6574 686f  hod=bucket_metho
+000175b0: 640a 2020 2020 2020 2020 2020 2020 290a  d.            ).
+000175c0: 2020 2020 2020 2020 2020 2020 6869 7374              hist
+000175d0: 6f67 7261 6d73 5b69 5d20 3d20 7365 6c66  ograms[i] = self
+000175e0: 2e5f 6869 7374 5f31 6428 0a20 2020 2020  ._hist_1d(.     
+000175f0: 2020 2020 2020 2020 2020 2064 6174 613d             data=
+00017600: 6461 7461 5b3a 2c20 695d 2e66 6c61 7474  data[:, i].flatt
+00017610: 656e 2829 2c0a 2020 2020 2020 2020 2020  en(),.          
+00017620: 2020 2020 2020 6269 6e5f 636f 756e 743d        bin_count=
+00017630: 6269 6e5f 636f 756e 742c 0a20 2020 2020  bin_count,.     
+00017640: 2020 2020 2020 2020 2020 2072 616e 6765             range
+00017650: 3d6e 702e 6172 7261 7928 5b30 2c20 696e  =np.array([0, in
+00017660: 7428 6269 6e5f 7769 6474 6820 2a20 6269  t(bin_width * bi
+00017670: 6e5f 636f 756e 7429 5d29 2c0a 2020 2020  n_count)]),.    
+00017680: 2020 2020 2020 2020 292e 6173 7479 7065          ).astype
+00017690: 286e 702e 696e 7436 3429 0a20 2020 2020  (np.int64).     
+000176a0: 2020 2020 2020 2068 6973 746f 6772 616d         histogram
+000176b0: 5f65 6467 6573 5b69 5d20 3d20 6e70 2e61  _edges[i] = np.a
+000176c0: 7261 6e67 6528 302c 2031 202b 2062 696e  range(0, 1 + bin
+000176d0: 5f77 6964 7468 2c20 6269 6e5f 7769 6474  _width, bin_widt
+000176e0: 6829 2e61 7374 7970 6528 0a20 2020 2020  h).astype(.     
+000176f0: 2020 2020 2020 2020 2020 206e 702e 666c             np.fl
+00017700: 6f61 7436 340a 2020 2020 2020 2020 2020  oat64.          
+00017710: 2020 290a 2020 2020 2020 2020 7265 7375    ).        resu
+00017720: 6c74 7320 3d20 7365 6c66 2e5f 6862 6f73  lts = self._hbos
+00017730: 5f63 6f6d 7075 7465 280a 2020 2020 2020  _compute(.      
+00017740: 2020 2020 2020 6461 7461 3d64 6174 612c        data=data,
+00017750: 2068 6973 746f 6772 616d 733d 6869 7374   histograms=hist
+00017760: 6f67 7261 6d73 2c20 6869 7374 6f67 7261  ograms, histogra
+00017770: 6d5f 6564 6765 733d 6869 7374 6f67 7261  m_edges=histogra
+00017780: 6d5f 6564 6765 730a 2020 2020 2020 2020  m_edges.        
+00017790: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+000177a0: 2072 6573 756c 7473 2e61 7374 7970 6528   results.astype(
+000177b0: 6e70 2e66 6c6f 6174 3332 290a 0a20 2020  np.float32)..   
+000177c0: 2064 6566 2072 6f6c 6c69 6e67 5f73 6861   def rolling_sha
+000177d0: 7069 726f 5f77 696c 6b73 280a 2020 2020  piro_wilks(.    
+000177e0: 2020 2020 7365 6c66 2c20 6461 7461 3a20      self, data: 
+000177f0: 6e70 2e6e 6461 7272 6179 2c20 7469 6d65  np.ndarray, time
+00017800: 5f77 696e 646f 773a 2066 6c6f 6174 2c20  _window: float, 
+00017810: 6670 733a 2069 6e74 0a20 2020 2029 202d  fps: int.    ) -
+00017820: 3e20 6e70 2e6e 6461 7272 6179 3a0a 2020  > np.ndarray:.  
+00017830: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00017840: 2020 436f 6d70 7574 6520 5368 6170 6972    Compute Shapir
+00017850: 6f2d 5769 6c6b 7320 6e6f 726d 616c 6974  o-Wilks normalit
+00017860: 7920 7374 6174 6973 7469 6373 2066 6f72  y statistics for
+00017870: 2073 6571 7565 6e74 6961 6c6c 7920 6269   sequentially bi
+00017880: 6e6e 6564 2076 616c 7565 7320 696e 2061  nned values in a
+00017890: 2074 696d 652d 7365 7269 6573 2e20 452e   time-series. E.
+000178a0: 672e 2c20 636f 6d70 7574 650a 2020 2020  g., compute.    
+000178b0: 2020 2020 7468 6520 6e6f 726d 616c 6974      the normalit
+000178c0: 7920 7374 6174 6973 7469 6373 206f 6620  y statistics of 
+000178d0: 6060 4665 6174 7572 6520 4e60 6020 696e  ``Feature N`` in
+000178e0: 2065 6163 6820 7769 6e64 6f77 206f 6620   each window of 
+000178f0: 6060 7469 6d65 5f77 696e 646f 7760 6020  ``time_window`` 
+00017900: 7365 636f 6e64 732e 0a0a 2020 2020 2020  seconds...      
+00017910: 2020 3a70 6172 616d 6574 6572 206e 6461    :parameter nda
+00017920: 7272 6179 2064 6174 613a 2031 4420 6172  rray data: 1D ar
+00017930: 7261 7920 6f66 2073 697a 6520 6c65 6e28  ray of size len(
+00017940: 6672 616d 6573 2920 7265 7072 6573 656e  frames) represen
+00017950: 7469 6e67 2066 6561 7475 7265 2076 616c  ting feature val
+00017960: 7565 732e 0a20 2020 2020 2020 203a 7061  ues..        :pa
+00017970: 7261 6d65 7465 7220 696e 7420 7469 6d65  rameter int time
+00017980: 5f77 696e 646f 773a 2054 6865 2073 697a  _window: The siz
+00017990: 6520 6f66 2074 6865 2062 7563 6b65 7473  e of the buckets
+000179a0: 2069 6e20 7365 636f 6e64 732e 0a20 2020   in seconds..   
+000179b0: 2020 2020 203a 7061 7261 6d65 7465 7220       :parameter 
+000179c0: 696e 7420 6670 733a 2046 7261 6d65 2d72  int fps: Frame-r
+000179d0: 6174 6520 6f66 2072 6563 6f72 6465 6420  ate of recorded 
+000179e0: 7669 6465 6f2e 0a20 2020 2020 2020 203a  video..        :
+000179f0: 7265 7475 726e 206e 702e 6e64 6172 7261  return np.ndarra
+00017a00: 793a 2041 7272 6179 206f 6620 7369 7a65  y: Array of size
+00017a10: 2064 6174 612e 7368 6170 655b 305d 2077   data.shape[0] w
+00017a20: 6974 6820 5368 6170 6972 6f2d 5769 6c6b  ith Shapiro-Wilk
+00017a30: 7320 6e6f 726d 616c 6974 7920 7374 6174  s normality stat
+00017a40: 6973 7469 6373 0a0a 2020 2020 2020 2020  istics..        
+00017a50: 3a65 7861 6d70 6c65 3a0a 2020 2020 2020  :example:.      
+00017a60: 2020 3e3e 3e20 6461 7461 203d 206e 702e    >>> data = np.
+00017a70: 7261 6e64 6f6d 2e72 616e 6469 6e74 286c  random.randint(l
+00017a80: 6f77 3d30 2c20 6869 6768 3d31 3030 2c20  ow=0, high=100, 
+00017a90: 7369 7a65 3d28 3230 3029 292e 6173 7479  size=(200)).asty
+00017aa0: 7065 2827 666c 6f61 7433 3227 290a 2020  pe('float32').  
+00017ab0: 2020 2020 2020 3e3e 3e20 7265 7375 6c74        >>> result
+00017ac0: 7320 3d20 7365 6c66 2e72 6f6c 6c69 6e67  s = self.rolling
+00017ad0: 5f73 6861 7069 726f 5f77 696c 6b73 2864  _shapiro_wilks(d
+00017ae0: 6174 613d 6461 7461 2c20 7469 6d65 5f77  ata=data, time_w
+00017af0: 696e 646f 773d 312c 2066 7073 3d33 3029  indow=1, fps=30)
+00017b00: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+00017b10: 2020 2020 2020 6368 6563 6b5f 7661 6c69        check_vali
+00017b20: 645f 6172 7261 7928 0a20 2020 2020 2020  d_array(.       
+00017b30: 2020 2020 2064 6174 613d 6461 7461 2c0a       data=data,.
+00017b40: 2020 2020 2020 2020 2020 2020 736f 7572              sour
+00017b50: 6365 3d66 227b 5374 6174 6973 7469 6373  ce=f"{Statistics
+00017b60: 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e 616d  .__class__.__nam
+00017b70: 655f 5f7d 2064 6174 6122 2c0a 2020 2020  e__} data",.    
+00017b80: 2020 2020 2020 2020 6163 6365 7074 6564          accepted
+00017b90: 5f73 697a 6573 3d5b 315d 2c0a 2020 2020  _sizes=[1],.    
+00017ba0: 2020 2020 290a 2020 2020 2020 2020 6368      ).        ch
+00017bb0: 6563 6b5f 666c 6f61 7428 0a20 2020 2020  eck_float(.     
+00017bc0: 2020 2020 2020 206e 616d 653d 6622 7b53         name=f"{S
+00017bd0: 7461 7469 7374 6963 732e 5f5f 636c 6173  tatistics.__clas
+00017be0: 735f 5f2e 5f5f 6e61 6d65 5f5f 7d20 6461  s__.__name__} da
+00017bf0: 7461 222c 0a20 2020 2020 2020 2020 2020  ta",.           
+00017c00: 2076 616c 7565 3d74 696d 655f 7769 6e64   value=time_wind
+00017c10: 6f77 2c0a 2020 2020 2020 2020 2020 2020  ow,.            
+00017c20: 6d69 6e5f 7661 6c75 653d 302e 312c 0a20  min_value=0.1,. 
+00017c30: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00017c40: 2063 6865 636b 5f69 6e74 280a 2020 2020   check_int(.    
+00017c50: 2020 2020 2020 2020 6e61 6d65 3d66 227b          name=f"{
+00017c60: 5374 6174 6973 7469 6373 2e5f 5f63 6c61  Statistics.__cla
+00017c70: 7373 5f5f 2e5f 5f6e 616d 655f 5f7d 2064  ss__.__name__} d
+00017c80: 6174 6122 2c20 7661 6c75 653d 7469 6d65  ata", value=time
+00017c90: 5f77 696e 646f 772c 206d 696e 5f76 616c  _window, min_val
+00017ca0: 7565 3d31 0a20 2020 2020 2020 2029 0a20  ue=1.        ). 
+00017cb0: 2020 2020 2020 2077 696e 646f 775f 7369         window_si
+00017cc0: 7a65 2c20 7265 7375 6c74 7320 3d20 696e  ze, results = in
+00017cd0: 7428 7469 6d65 5f77 696e 646f 7720 2a20  t(time_window * 
+00017ce0: 6670 7329 2c20 6e70 2e66 756c 6c28 2864  fps), np.full((d
+00017cf0: 6174 612e 7368 6170 655b 305d 292c 202d  ata.shape[0]), -
+00017d00: 312e 3029 0a20 2020 2020 2020 2064 6174  1.0).        dat
+00017d10: 6120 3d20 6e70 2e73 706c 6974 2864 6174  a = np.split(dat
+00017d20: 612c 206c 6973 7428 7261 6e67 6528 7769  a, list(range(wi
+00017d30: 6e64 6f77 5f73 697a 652c 2064 6174 612e  ndow_size, data.
+00017d40: 7368 6170 655b 305d 2c20 7769 6e64 6f77  shape[0], window
+00017d50: 5f73 697a 6529 2929 0a20 2020 2020 2020  _size))).       
+00017d60: 2066 6f72 2063 6e74 2c20 6920 696e 2065   for cnt, i in e
+00017d70: 6e75 6d65 7261 7465 2870 7261 6e67 6528  numerate(prange(
+00017d80: 312c 206c 656e 2864 6174 6129 2929 3a0a  1, len(data))):.
+00017d90: 2020 2020 2020 2020 2020 2020 7374 6172              star
+00017da0: 742c 2065 6e64 203d 2069 6e74 2828 636e  t, end = int((cn
+00017db0: 7420 2b20 3129 202a 2077 696e 646f 775f  t + 1) * window_
+00017dc0: 7369 7a65 292c 2069 6e74 280a 2020 2020  size), int(.    
+00017dd0: 2020 2020 2020 2020 2020 2020 2828 636e              ((cn
+00017de0: 7420 2b20 3129 202a 2077 696e 646f 775f  t + 1) * window_
+00017df0: 7369 7a65 2920 2b20 7769 6e64 6f77 5f73  size) + window_s
+00017e00: 697a 650a 2020 2020 2020 2020 2020 2020  ize.            
+00017e10: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+00017e20: 7375 6c74 735b 7374 6172 743a 656e 645d  sults[start:end]
+00017e30: 203d 2073 7461 7473 2e73 6861 7069 726f   = stats.shapiro
+00017e40: 2864 6174 615b 695d 295b 305d 0a20 2020  (data[i])[0].   
+00017e50: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
+00017e60: 6c74 730a 0a20 2020 2040 7374 6174 6963  lts..    @static
+00017e70: 6d65 7468 6f64 0a20 2020 2040 6e6a 6974  method.    @njit
+00017e80: 2822 2866 6c6f 6174 3332 5b3a 5d2c 2066  ("(float32[:], f
+00017e90: 6c6f 6174 3634 5b3a 5d2c 2069 6e74 3634  loat64[:], int64
+00017ea0: 2c29 2229 0a20 2020 2064 6566 2073 6c69  ,)").    def sli
+00017eb0: 6469 6e67 5f7a 5f73 636f 7265 7328 0a20  ding_z_scores(. 
+00017ec0: 2020 2020 2020 2064 6174 613a 206e 702e         data: np.
+00017ed0: 6e64 6172 7261 792c 2074 696d 655f 7769  ndarray, time_wi
+00017ee0: 6e64 6f77 733a 206e 702e 6e64 6172 7261  ndows: np.ndarra
+00017ef0: 792c 2066 7073 3a20 696e 740a 2020 2020  y, fps: int.    
+00017f00: 2920 2d3e 206e 702e 6e64 6172 7261 793a  ) -> np.ndarray:
+00017f10: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00017f20: 2020 2020 2043 616c 6375 6c61 7465 2073       Calculate s
+00017f30: 6c69 6469 6e67 205a 2d73 636f 7265 7320  liding Z-scores 
+00017f40: 666f 7220 6120 6769 7665 6e20 6461 7461  for a given data
+00017f50: 2061 7272 6179 206f 7665 7220 7370 6563   array over spec
+00017f60: 6966 6965 6420 7469 6d65 2077 696e 646f  ified time windo
+00017f70: 7773 2e0a 0a20 2020 2020 2020 2054 6869  ws...        Thi
+00017f80: 7320 6675 6e63 7469 6f6e 2063 6f6d 7075  s function compu
+00017f90: 7465 7320 736c 6964 696e 6720 5a2d 7363  tes sliding Z-sc
+00017fa0: 6f72 6573 2066 6f72 2061 2031 4420 6461  ores for a 1D da
+00017fb0: 7461 2061 7272 6179 206f 7665 7220 6469  ta array over di
+00017fc0: 6666 6572 656e 7420 7469 6d65 2077 696e  fferent time win
+00017fd0: 646f 7773 2e20 5468 6520 736c 6964 696e  dows. The slidin
+00017fe0: 6720 5a2d 7363 6f72 650a 2020 2020 2020  g Z-score.      
+00017ff0: 2020 6973 2061 206d 6561 7375 7265 206f    is a measure o
+00018000: 6620 686f 7720 6d61 6e79 2073 7461 6e64  f how many stand
+00018010: 6172 6420 6465 7669 6174 696f 6e73 2061  ard deviations a
+00018020: 2064 6174 6120 706f 696e 7420 6973 2066   data point is f
+00018030: 726f 6d20 7468 6520 6d65 616e 206f 6620  rom the mean of 
+00018040: 7468 6520 7375 7272 6f75 6e64 696e 6720  the surrounding 
+00018050: 6461 7461 2077 6974 6869 6e0a 2020 2020  data within.    
+00018060: 2020 2020 7468 6520 7370 6563 6966 6965      the specifie
+00018070: 6420 7469 6d65 2077 696e 646f 772e 2054  d time window. T
+00018080: 6869 7320 6361 6e20 6265 2075 7365 6675  his can be usefu
+00018090: 6c20 666f 7220 6465 7465 6374 696e 6720  l for detecting 
+000180a0: 616e 6f6d 616c 6965 7320 6f72 2076 6172  anomalies or var
+000180b0: 6961 7469 6f6e 7320 696e 2074 696d 652d  iations in time-
+000180c0: 7365 7269 6573 2064 6174 612e 0a0a 2020  series data...  
+000180d0: 2020 2020 2020 3a70 6172 616d 6574 6572        :parameter
+000180e0: 206e 6461 7272 6179 2064 6174 613a 2031   ndarray data: 1
+000180f0: 4420 4e75 6d50 7920 6172 7261 7920 636f  D NumPy array co
+00018100: 6e74 6169 6e69 6e67 2074 6865 2074 696d  ntaining the tim
+00018110: 652d 7365 7269 6573 2064 6174 612e 0a20  e-series data.. 
+00018120: 2020 2020 2020 203a 7061 7261 6d65 7465         :paramete
+00018130: 7220 6e64 6172 7261 7920 7469 6d65 5f77  r ndarray time_w
+00018140: 696e 646f 7773 3a20 3144 204e 756d 5079  indows: 1D NumPy
+00018150: 2061 7272 6179 2073 7065 6369 6679 696e   array specifyin
+00018160: 6720 7468 6520 7469 6d65 2077 696e 646f  g the time windo
+00018170: 7773 2069 6e20 7365 636f 6e64 7320 6f76  ws in seconds ov
+00018180: 6572 2077 6869 6368 2074 6f20 6361 6c63  er which to calc
+00018190: 756c 6174 6520 7468 6520 5a2d 7363 6f72  ulate the Z-scor
+000181a0: 6573 2e0a 2020 2020 2020 2020 3a70 6172  es..        :par
+000181b0: 616d 6574 6572 2069 6e74 2074 696d 655f  ameter int time_
+000181c0: 7769 6e64 6f77 733a 2046 7261 6d65 7320  windows: Frames 
+000181d0: 7065 7220 7365 636f 6e64 2c20 7573 6564  per second, used
+000181e0: 2074 6f20 636f 6e76 6572 7420 7469 6d65   to convert time
+000181f0: 2077 696e 646f 7773 2066 726f 6d20 7365   windows from se
+00018200: 636f 6e64 7320 746f 2074 6865 2063 6f72  conds to the cor
+00018210: 7265 7370 6f6e 6469 6e67 206e 756d 6265  responding numbe
+00018220: 7220 6f66 2064 6174 6120 706f 696e 7473  r of data points
+00018230: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
+00018240: 6e73 206e 702e 6e64 6172 7261 793a 2041  ns np.ndarray: A
+00018250: 2032 4420 4e75 6d50 7920 6172 7261 7920   2D NumPy array 
+00018260: 636f 6e74 6169 6e69 6e67 2074 6865 2063  containing the c
+00018270: 616c 6375 6c61 7465 6420 5a2d 7363 6f72  alculated Z-scor
+00018280: 6573 2e20 4561 6368 2072 6f77 2063 6f72  es. Each row cor
+00018290: 7265 7370 6f6e 6473 2074 6f20 7468 6520  responds to the 
+000182a0: 5a2d 7363 6f72 6573 2063 616c 6375 6c61  Z-scores calcula
+000182b0: 7465 6420 666f 7220 6120 7370 6563 6966  ted for a specif
+000182c0: 6963 2074 696d 6520 7769 6e64 6f77 2e20  ic time window. 
+000182d0: 5468 6520 7469 6d65 2077 696e 646f 7773  The time windows
+000182e0: 2061 7265 2072 6570 7265 7365 6e74 6564   are represented
+000182f0: 2062 7920 7468 6520 636f 6c75 6d6e 732e   by the columns.
+00018300: 0a0a 2020 2020 2020 2020 3a65 7861 6d70  ..        :examp
+00018310: 6c65 3a0a 2020 2020 2020 2020 3e3e 3e20  le:.        >>> 
+00018320: 6461 7461 203d 206e 702e 7261 6e64 6f6d  data = np.random
+00018330: 2e72 616e 6469 6e74 2830 2c20 3130 302c  .randint(0, 100,
+00018340: 2028 3130 3030 2c29 292e 6173 7479 7065   (1000,)).astype
+00018350: 286e 702e 666c 6f61 7433 3229 0a20 2020  (np.float32).   
+00018360: 2020 2020 203e 3e3e 207a 5f73 636f 7265       >>> z_score
+00018370: 7320 3d20 5374 6174 6973 7469 6373 2829  s = Statistics()
+00018380: 2e73 6c69 6469 6e67 5f7a 5f73 636f 7265  .sliding_z_score
+00018390: 7328 6461 7461 3d64 6174 612c 2074 696d  s(data=data, tim
+000183a0: 655f 7769 6e64 6f77 733d 6e70 2e61 7272  e_windows=np.arr
+000183b0: 6179 285b 312e 302c 2032 2e35 5d29 2c20  ay([1.0, 2.5]), 
+000183c0: 6670 733d 3130 290a 2020 2020 2020 2020  fps=10).        
+000183d0: 2222 220a 0a20 2020 2020 2020 2072 6573  """..        res
+000183e0: 756c 7473 203d 206e 702e 6675 6c6c 2828  ults = np.full((
+000183f0: 6461 7461 2e73 6861 7065 5b30 5d2c 2074  data.shape[0], t
+00018400: 696d 655f 7769 6e64 6f77 732e 7368 6170  ime_windows.shap
+00018410: 655b 305d 292c 2030 2e30 290a 2020 2020  e[0]), 0.0).    
+00018420: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+00018430: 6765 2874 696d 655f 7769 6e64 6f77 732e  ge(time_windows.
+00018440: 7368 6170 655b 305d 293a 0a20 2020 2020  shape[0]):.     
+00018450: 2020 2020 2020 2077 696e 646f 775f 7369         window_si
+00018460: 7a65 203d 2069 6e74 2874 696d 655f 7769  ze = int(time_wi
+00018470: 6e64 6f77 735b 695d 202a 2066 7073 290a  ndows[i] * fps).
+00018480: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00018490: 7269 6768 7420 696e 2072 616e 6765 2877  right in range(w
+000184a0: 696e 646f 775f 7369 7a65 202d 2031 2c20  indow_size - 1, 
+000184b0: 6461 7461 2e73 6861 7065 5b30 5d29 3a0a  data.shape[0]):.
+000184c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000184d0: 6c65 6674 203d 2072 6967 6874 202d 2077  left = right - w
+000184e0: 696e 646f 775f 7369 7a65 202b 2031 0a20  indow_size + 1. 
+000184f0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00018500: 616d 706c 655f 6461 7461 203d 2064 6174  ample_data = dat
+00018510: 615b 6c65 6674 203a 2072 6967 6874 202b  a[left : right +
+00018520: 2031 5d0a 2020 2020 2020 2020 2020 2020   1].            
+00018530: 2020 2020 6d2c 2073 203d 206e 702e 6d65      m, s = np.me
+00018540: 616e 2873 616d 706c 655f 6461 7461 292c  an(sample_data),
+00018550: 206e 702e 7374 6428 7361 6d70 6c65 5f64   np.std(sample_d
+00018560: 6174 6129 0a20 2020 2020 2020 2020 2020  ata).           
+00018570: 2020 2020 2076 616c 7320 3d20 2873 616d       vals = (sam
+00018580: 706c 655f 6461 7461 202d 206d 2920 2f20  ple_data - m) / 
+00018590: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
+000185a0: 2020 7265 7375 6c74 735b 6c65 6674 203a    results[left :
+000185b0: 2072 6967 6874 202b 2031 2c20 695d 203d   right + 1, i] =
+000185c0: 2076 616c 730a 2020 2020 2020 2020 7265   vals.        re
+000185d0: 7475 726e 2072 6573 756c 7473 0a0a 2020  turn results..  
+000185e0: 2020 4073 7461 7469 636d 6574 686f 640a    @staticmethod.
+000185f0: 2020 2020 406e 6a69 7428 2228 696e 7436      @njit("(int6
+00018600: 345b 3a2c 203a 5d2c 2922 290a 2020 2020  4[:, :],)").    
+00018610: 6465 6620 7068 695f 636f 6566 6669 6369  def phi_coeffici
+00018620: 656e 7428 6461 7461 3a20 6e70 2e6e 6461  ent(data: np.nda
+00018630: 7272 6179 2920 2d3e 2066 6c6f 6174 3a0a  rray) -> float:.
+00018640: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00018650: 2020 2020 436f 6d70 7574 6520 7468 6520      Compute the 
+00018660: 7068 6920 636f 6566 6669 6369 656e 7420  phi coefficient 
+00018670: 666f 7220 6120 4e78 3220 6172 7261 7920  for a Nx2 array 
+00018680: 6f66 2062 696e 6172 7920 6461 7461 2e0a  of binary data..
+00018690: 0a20 2020 2020 2020 2054 6865 2070 6869  .        The phi
+000186a0: 2063 6f65 6666 6963 6965 6e74 2028 612e   coefficient (a.
+000186b0: 6b2e 6120 4d61 7474 6865 7773 2043 6f72  k.a Matthews Cor
+000186c0: 7265 6c61 7469 6f6e 2043 6f65 6666 6963  relation Coeffic
+000186d0: 6965 6e74 2028 4d43 4329 292c 2069 7320  ient (MCC)), is 
+000186e0: 6120 6d65 6173 7572 6520 6f66 2061 7373  a measure of ass
+000186f0: 6f63 6961 7469 6f6e 2066 6f72 2062 696e  ociation for bin
+00018700: 6172 7920 6461 7461 2069 6e20 6120 3278  ary data in a 2x
+00018710: 3220 636f 6e74 696e 6765 6e63 7920 7461  2 contingency ta
+00018720: 626c 652e 2049 7420 7175 616e 7469 6669  ble. It quantifi
+00018730: 6573 2074 6865 0a20 2020 2020 2020 2064  es the.        d
+00018740: 6567 7265 6520 6f66 2061 7373 6f63 6961  egree of associa
+00018750: 7469 6f6e 206f 7220 636f 7272 656c 6174  tion or correlat
+00018760: 696f 6e20 6265 7477 6565 6e20 7477 6f20  ion between two 
+00018770: 6269 6e61 7279 2076 6172 6961 626c 6573  binary variables
+00018780: 2028 652e 672e 2c20 6269 6e61 7279 2063   (e.g., binary c
+00018790: 6c61 7373 6966 6963 6174 696f 6e20 7461  lassification ta
+000187a0: 7267 6574 7329 2e0a 0a20 2020 2020 2020  rgets)...       
+000187b0: 2054 6865 2066 6f72 6d75 6c61 2066 6f72   The formula for
+000187c0: 2074 6865 2070 6869 2063 6f65 6666 6963   the phi coeffic
+000187d0: 6965 6e74 2069 7320 6465 6669 6e65 6420  ient is defined 
+000187e0: 6173 3a0a 0a20 2020 2020 2020 202e 2e20  as:..        .. 
+000187f0: 6d61 7468 3a3a 0a20 2020 2020 2020 2020  math::.         
+00018800: 2020 5c70 6869 203d 205c 6672 6163 7b28    \phi = \frac{(
+00018810: 4243 202d 2041 4429 7d7b 5c73 7172 747b  BC - AD)}{\sqrt{
+00018820: 2843 5f31 202b 2043 5f32 2928 525f 3120  (C_1 + C_2)(R_1 
+00018830: 2b20 525f 3229 2843 5f31 202b 2052 5f31  + R_2)(C_1 + R_1
+00018840: 2928 435f 3220 2b20 525f 3229 7d7d 0a0a  )(C_2 + R_2)}}..
+00018850: 2020 2020 2020 2020 7768 6572 653a 0a20          where:. 
+00018860: 2020 2020 2020 202d 2042 433a 2048 6974         - BC: Hit
+00018870: 2072 6174 6520 2872 6570 6f6e 7365 2061   rate (reponse a
+00018880: 6e64 2074 7275 7468 2069 7320 626f 7468  nd truth is both
+00018890: 2031 290a 2020 2020 2020 2020 2d20 4144   1).        - AD
+000188a0: 3a20 436f 7272 6563 7420 7265 6a65 6374  : Correct reject
+000188b0: 696f 6e73 2028 7265 7370 6f6e 7365 2061  ions (response a
+000188c0: 6e64 2074 7275 7468 2061 7265 2062 6f74  nd truth are bot
+000188d0: 6820 3029 0a20 2020 2020 2020 202d 2043  h 0).        - C
+000188e0: 312c 2043 323a 2043 6f75 6e74 7320 6f66  1, C2: Counts of
+000188f0: 206f 6363 7572 7265 6e63 6573 2077 6865   occurrences whe
+00018900: 7265 2074 6865 2072 6573 706f 6e73 6520  re the response 
+00018910: 6973 2031 2061 6e64 2030 2c20 7265 7370  is 1 and 0, resp
+00018920: 6563 7469 7665 6c79 2e0a 2020 2020 2020  ectively..      
+00018930: 2020 2d20 5231 2c20 5232 3a20 436f 756e    - R1, R2: Coun
+00018940: 7473 206f 6620 6f63 6375 7272 656e 6365  ts of occurrence
+00018950: 7320 7768 6572 6520 7468 6520 7472 7574  s where the trut
+00018960: 6820 6973 2031 2061 6e64 2030 2c20 7265  h is 1 and 0, re
+00018970: 7370 6563 7469 7665 6c79 2e0a 0a20 2020  spectively...   
+00018980: 2020 2020 203a 7061 7261 6d20 6e70 2e6e       :param np.n
+00018990: 6461 7272 6179 2064 6174 613a 2041 204e  darray data: A N
+000189a0: 756d 5079 2061 7272 6179 2063 6f6e 7461  umPy array conta
+000189b0: 696e 696e 6720 6269 6e61 7279 2064 6174  ining binary dat
+000189c0: 6120 6f72 6761 6e69 7a65 6420 696e 2074  a organized in t
+000189d0: 776f 2063 6f6c 756d 6e73 2e20 4561 6368  wo columns. Each
+000189e0: 2072 6f77 2072 6570 7265 7365 6e74 7320   row represents 
+000189f0: 6120 7061 6972 206f 6620 6269 6e61 7279  a pair of binary
+00018a00: 2076 616c 7565 7320 666f 7220 7477 6f20   values for two 
+00018a10: 7661 7269 6162 6c65 732e 2043 6f6c 756d  variables. Colum
+00018a20: 6e73 2072 6570 7265 7365 6e74 2074 776f  ns represent two
+00018a30: 2066 6561 7475 7265 7320 6f72 2074 776f   features or two
+00018a40: 2062 696e 6172 7920 636c 6173 7369 6669   binary classifi
+00018a50: 6361 7469 6f6e 2072 6573 756c 7473 2e0a  cation results..
+00018a60: 2020 2020 2020 2020 3a70 6172 616d 2066          :param f
+00018a70: 6c6f 6174 3a20 5468 6520 6361 6c63 756c  loat: The calcul
+00018a80: 6174 6564 2070 6869 2063 6f65 6666 6963  ated phi coeffic
+00018a90: 6965 6e74 2c20 6120 7661 6c75 6520 6265  ient, a value be
+00018aa0: 7477 6565 6e20 3020 616e 6420 312e 2041  tween 0 and 1. A
+00018ab0: 2076 616c 7565 206f 6620 3020 696e 6469   value of 0 indi
+00018ac0: 6361 7465 7320 6e6f 2061 7373 6f63 6961  cates no associa
+00018ad0: 7469 6f6e 2062 6574 7765 656e 2074 6865  tion between the
+00018ae0: 2076 6172 6961 626c 6573 2c20 7768 696c   variables, whil
+00018af0: 6520 3120 696e 6469 6361 7465 7320 6120  e 1 indicates a 
+00018b00: 7065 7266 6563 7420 6173 736f 6369 6174  perfect associat
+00018b10: 696f 6e2e 0a0a 2020 2020 2020 2020 3a65  ion...        :e
+00018b20: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
+00018b30: 3e3e 3e20 6461 7461 203d 206e 702e 6172  >>> data = np.ar
+00018b40: 7261 7928 5b5b 302c 2031 5d2c 205b 312c  ray([[0, 1], [1,
+00018b50: 2030 5d2c 205b 312c 2030 5d2c 205b 312c   0], [1, 0], [1,
+00018b60: 2031 5d5d 292e 6173 7479 7065 286e 702e   1]]).astype(np.
+00018b70: 696e 7436 3429 0a20 2020 2020 2020 203e  int64).        >
+00018b80: 3e3e 2053 7461 7469 7374 6963 7328 292e  >> Statistics().
+00018b90: 7068 695f 636f 6566 6669 6369 656e 7428  phi_coefficient(
+00018ba0: 6461 7461 3d64 6174 6129 0a20 2020 2020  data=data).     
+00018bb0: 2020 203e 3e3e 2030 2e38 3136 3439 3635     >>> 0.8164965
+00018bc0: 3830 3932 3737 3236 310a 2020 2020 2020  809277261.      
+00018bd0: 2020 3e3e 3e20 6461 7461 203d 206e 702e    >>> data = np.
+00018be0: 7261 6e64 6f6d 2e72 616e 6469 6e74 2830  random.randint(0
+00018bf0: 2c20 322c 2028 3130 302c 2032 2929 0a20  , 2, (100, 2)). 
+00018c00: 2020 2020 2020 203e 3e3e 2072 6573 756c         >>> resul
+00018c10: 7420 3d20 5374 6174 6973 7469 6373 2e70  t = Statistics.p
+00018c20: 6869 5f63 6f65 6666 6963 6965 6e74 2864  hi_coefficient(d
+00018c30: 6174 613d 6461 7461 290a 2020 2020 2020  ata=data).      
+00018c40: 2020 2222 220a 2020 2020 2020 2020 636e    """.        cn
+00018c50: 745f 305f 3020 3d20 6c65 6e28 6e70 2e61  t_0_0 = len(np.a
+00018c60: 7267 7768 6572 6528 2864 6174 615b 3a2c  rgwhere((data[:,
+00018c70: 2030 5d20 3d3d 2030 2920 2620 2864 6174   0] == 0) & (dat
+00018c80: 615b 3a2c 2031 5d20 3d3d 2030 2929 2e66  a[:, 1] == 0)).f
+00018c90: 6c61 7474 656e 2829 290a 2020 2020 2020  latten()).      
+00018ca0: 2020 636e 745f 305f 3120 3d20 6c65 6e28    cnt_0_1 = len(
+00018cb0: 6e70 2e61 7267 7768 6572 6528 2864 6174  np.argwhere((dat
+00018cc0: 615b 3a2c 2030 5d20 3d3d 2030 2920 2620  a[:, 0] == 0) & 
+00018cd0: 2864 6174 615b 3a2c 2031 5d20 3d3d 2031  (data[:, 1] == 1
+00018ce0: 2929 2e66 6c61 7474 656e 2829 290a 2020  )).flatten()).  
+00018cf0: 2020 2020 2020 636e 745f 315f 3020 3d20        cnt_1_0 = 
+00018d00: 6c65 6e28 6e70 2e61 7267 7768 6572 6528  len(np.argwhere(
+00018d10: 2864 6174 615b 3a2c 2030 5d20 3d3d 2031  (data[:, 0] == 1
+00018d20: 2920 2620 2864 6174 615b 3a2c 2031 5d20  ) & (data[:, 1] 
+00018d30: 3d3d 2030 2929 2e66 6c61 7474 656e 2829  == 0)).flatten()
+00018d40: 290a 2020 2020 2020 2020 636e 745f 315f  ).        cnt_1_
+00018d50: 3120 3d20 6c65 6e28 6e70 2e61 7267 7768  1 = len(np.argwh
+00018d60: 6572 6528 2864 6174 615b 3a2c 2030 5d20  ere((data[:, 0] 
+00018d70: 3d3d 2031 2920 2620 2864 6174 615b 3a2c  == 1) & (data[:,
+00018d80: 2031 5d20 3d3d 2031 2929 2e66 6c61 7474   1] == 1)).flatt
+00018d90: 656e 2829 290a 0a20 2020 2020 2020 2042  en())..        B
+00018da0: 432c 2041 4420 3d20 636e 745f 315f 3120  C, AD = cnt_1_1 
+00018db0: 2a20 636e 745f 305f 302c 2063 6e74 5f31  * cnt_0_0, cnt_1
+00018dc0: 5f30 202a 2063 6e74 5f30 5f31 0a20 2020  _0 * cnt_0_1.   
+00018dd0: 2020 2020 206e 6f6d 696e 6174 6f72 203d       nominator =
+00018de0: 2042 4320 2d20 4144 0a20 2020 2020 2020   BC - AD.       
+00018df0: 2064 656e 6f6d 696e 6174 6f72 203d 206e   denominator = n
+00018e00: 702e 7371 7274 280a 2020 2020 2020 2020  p.sqrt(.        
+00018e10: 2020 2020 2863 6e74 5f31 5f30 202b 2063      (cnt_1_0 + c
+00018e20: 6e74 5f31 5f31 290a 2020 2020 2020 2020  nt_1_1).        
+00018e30: 2020 2020 2a20 2863 6e74 5f30 5f30 202b      * (cnt_0_0 +
+00018e40: 2063 6e74 5f30 5f31 290a 2020 2020 2020   cnt_0_1).      
+00018e50: 2020 2020 2020 2a20 2863 6e74 5f31 5f30        * (cnt_1_0
+00018e60: 202b 2063 6e74 5f30 5f30 290a 2020 2020   + cnt_0_0).    
+00018e70: 2020 2020 2020 2020 2a20 2863 6e74 5f31          * (cnt_1
+00018e80: 5f31 202a 2063 6e74 5f30 5f31 290a 2020  _1 * cnt_0_1).  
+00018e90: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00018ea0: 6966 206e 6f6d 696e 6174 6f72 203d 3d20  if nominator == 
+00018eb0: 3020 6f72 2064 656e 6f6d 696e 6174 6f72  0 or denominator
+00018ec0: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
+00018ed0: 2020 2072 6574 7572 6e20 312e 300a 2020     return 1.0.  
+00018ee0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00018ef0: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+00018f00: 702e 6162 7328 0a20 2020 2020 2020 2020  p.abs(.         
+00018f10: 2020 2020 2020 2028 4243 202d 2041 4429         (BC - AD)
+00018f20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018f30: 202f 206e 702e 7371 7274 280a 2020 2020   / np.sqrt(.    
+00018f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018f50: 2863 6e74 5f31 5f30 202b 2063 6e74 5f31  (cnt_1_0 + cnt_1
+00018f60: 5f31 290a 2020 2020 2020 2020 2020 2020  _1).            
+00018f70: 2020 2020 2020 2020 2a20 2863 6e74 5f30          * (cnt_0
+00018f80: 5f30 202b 2063 6e74 5f30 5f31 290a 2020  _0 + cnt_0_1).  
+00018f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018fa0: 2020 2a20 2863 6e74 5f31 5f30 202b 2063    * (cnt_1_0 + c
+00018fb0: 6e74 5f30 5f30 290a 2020 2020 2020 2020  nt_0_0).        
+00018fc0: 2020 2020 2020 2020 2020 2020 2a20 2863              * (c
+00018fd0: 6e74 5f31 5f31 202a 2063 6e74 5f30 5f31  nt_1_1 * cnt_0_1
+00018fe0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00018ff0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00019000: 290a 0a20 2020 2040 7374 6174 6963 6d65  )..    @staticme
+00019010: 7468 6f64 0a20 2020 2040 6e6a 6974 2822  thod.    @njit("
+00019020: 2869 6e74 3332 5b3a 2c20 3a5d 2c20 666c  (int32[:, :], fl
+00019030: 6f61 7436 345b 3a5d 2c20 696e 7436 3429  oat64[:], int64)
+00019040: 2229 0a20 2020 2064 6566 2073 6c69 6469  ").    def slidi
+00019050: 6e67 5f70 6869 5f63 6f65 6666 6963 6965  ng_phi_coefficie
+00019060: 6e74 280a 2020 2020 2020 2020 6461 7461  nt(.        data
+00019070: 3a20 6e70 2e6e 6461 7272 6179 2c20 7769  : np.ndarray, wi
+00019080: 6e64 6f77 5f73 697a 6573 3a20 6e70 2e6e  ndow_sizes: np.n
+00019090: 6461 7272 6179 2c20 7361 6d70 6c65 5f72  darray, sample_r
+000190a0: 6174 653a 2069 6e74 0a20 2020 2029 202d  ate: int.    ) -
+000190b0: 3e20 6e70 2e6e 6461 7272 6179 3a0a 2020  > np.ndarray:.  
+000190c0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000190d0: 2020 4361 6c63 756c 6174 6520 736c 6964    Calculate slid
+000190e0: 696e 6720 7068 6920 636f 6566 6669 6369  ing phi coeffici
+000190f0: 656e 7473 2066 6f72 2061 2032 7832 2063  ents for a 2x2 c
+00019100: 6f6e 7469 6e67 656e 6379 2074 6162 6c65  ontingency table
+00019110: 2064 6572 6976 6564 2066 726f 6d20 6269   derived from bi
+00019120: 6e61 7279 2064 6174 612e 0a0a 2020 2020  nary data...    
+00019130: 2020 2020 436f 6d70 7574 6573 2073 6c69      Computes sli
+00019140: 6469 6e67 2070 6869 2063 6f65 6666 6963  ding phi coeffic
+00019150: 6965 6e74 7320 666f 7220 6120 3278 3220  ients for a 2x2 
+00019160: 636f 6e74 696e 6765 6e63 7920 7461 626c  contingency tabl
+00019170: 6520 6465 7269 7665 6420 6672 6f6d 2062  e derived from b
+00019180: 696e 6172 7920 6461 7461 206f 7665 7220  inary data over 
+00019190: 6469 6666 6572 656e 740a 2020 2020 2020  different.      
+000191a0: 2020 7469 6d65 2077 696e 646f 7773 2e20    time windows. 
+000191b0: 5468 6520 7068 6920 636f 6566 6669 6369  The phi coeffici
+000191c0: 656e 7420 6973 2061 206d 6561 7375 7265  ent is a measure
+000191d0: 206f 6620 6173 736f 6369 6174 696f 6e20   of association 
+000191e0: 6265 7477 6565 6e20 7477 6f20 6269 6e61  between two bina
+000191f0: 7279 2076 6172 6961 626c 6573 2c20 616e  ry variables, an
+00019200: 6420 736c 6964 696e 6720 7068 690a 2020  d sliding phi.  
+00019210: 2020 2020 2020 636f 6566 6669 6369 656e        coefficien
+00019220: 7473 2063 616e 2072 6576 6561 6c20 6368  ts can reveal ch
+00019230: 616e 6765 7320 696e 2061 7373 6f63 6961  anges in associa
+00019240: 7469 6f6e 206f 7665 7220 7469 6d65 2e0a  tion over time..
+00019250: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00019260: 6e70 2e6e 6461 7272 6179 2064 6174 613a  np.ndarray data:
+00019270: 2041 2032 4420 4e75 6d50 7920 6172 7261   A 2D NumPy arra
+00019280: 7920 636f 6e74 6169 6e69 6e67 2062 696e  y containing bin
+00019290: 6172 7920 6461 7461 206f 7267 616e 697a  ary data organiz
+000192a0: 6564 2069 6e20 7477 6f20 636f 6c75 6d6e  ed in two column
+000192b0: 732e 2045 6163 6820 726f 7720 7265 7072  s. Each row repr
+000192c0: 6573 656e 7473 2061 2070 6169 7220 6f66  esents a pair of
+000192d0: 2062 696e 6172 7920 7661 6c75 6573 2066   binary values f
+000192e0: 6f72 2074 776f 2076 6172 6961 626c 6573  or two variables
+000192f0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00019300: 206e 702e 6e64 6172 7261 7920 7769 6e64   np.ndarray wind
+00019310: 6f77 5f73 697a 6573 3a20 3144 204e 756d  ow_sizes: 1D Num
+00019320: 5079 2061 7272 6179 2073 7065 6369 6679  Py array specify
+00019330: 696e 6720 7468 6520 7469 6d65 2077 696e  ing the time win
+00019340: 646f 7773 2028 696e 2073 6563 6f6e 6473  dows (in seconds
+00019350: 2920 6f76 6572 2077 6869 6368 2074 6f20  ) over which to 
+00019360: 6361 6c63 756c 6174 6520 7468 6520 736c  calculate the sl
+00019370: 6964 696e 6720 7068 6920 636f 6566 6669  iding phi coeffi
+00019380: 6369 656e 7473 2e0a 2020 2020 2020 2020  cients..        
+00019390: 3a70 6172 616d 2069 6e74 2073 616d 706c  :param int sampl
+000193a0: 655f 7261 7465 3a20 5468 6520 7361 6d70  e_rate: The samp
+000193b0: 6c69 6e67 2072 6174 6520 6f72 2074 696d  ling rate or tim
+000193c0: 6520 696e 7465 7276 616c 2028 696e 2073  e interval (in s
+000193d0: 616d 706c 6573 2070 6572 2073 6563 6f6e  amples per secon
+000193e0: 642c 2065 2e67 2e2c 2066 7073 2920 6174  d, e.g., fps) at
+000193f0: 2077 6869 6368 2064 6174 6120 706f 696e   which data poin
+00019400: 7473 2077 6572 6520 636f 6c6c 6563 7465  ts were collecte
+00019410: 642e 0a20 2020 2020 2020 203a 7265 7475  d..        :retu
+00019420: 726e 7320 6e70 2e6e 6461 7272 6179 3a20  rns np.ndarray: 
+00019430: 4120 3244 204e 756d 5079 2061 7272 6179  A 2D NumPy array
+00019440: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
+00019450: 6361 6c63 756c 6174 6564 2073 6c69 6469  calculated slidi
+00019460: 6e67 2070 6869 2063 6f65 6666 6963 6965  ng phi coefficie
+00019470: 6e74 732e 2045 6163 6820 726f 7720 636f  nts. Each row co
+00019480: 7272 6573 706f 6e64 7320 746f 2074 6865  rresponds to the
+00019490: 2070 6869 2063 6f65 6666 6963 6965 6e74   phi coefficient
+000194a0: 7320 6361 6c63 756c 6174 6564 2066 6f72  s calculated for
+000194b0: 2061 2073 7065 6369 6669 6320 7469 6d65   a specific time
+000194c0: 2070 6f69 6e74 2c20 7468 6520 636f 6c75   point, the colu
+000194d0: 6d6e 7320 636f 7272 6573 706f 6e64 2074  mns correspond t
+000194e0: 6f20 7469 6d65 2d77 696e 646f 7773 2e0a  o time-windows..
+000194f0: 0a20 2020 2020 2020 203a 6578 616d 706c  .        :exampl
+00019500: 653a 0a20 2020 2020 2020 203e 3e3e 2064  e:.        >>> d
+00019510: 6174 6120 3d20 6e70 2e72 616e 646f 6d2e  ata = np.random.
+00019520: 7261 6e64 696e 7428 302c 2032 2c20 2832  randint(0, 2, (2
+00019530: 3030 2c20 3229 290a 2020 2020 2020 2020  00, 2)).        
+00019540: 3e3e 3e20 5374 6174 6973 7469 6373 2829  >>> Statistics()
+00019550: 2e73 6c69 6469 6e67 5f70 6869 5f63 6f65  .sliding_phi_coe
+00019560: 6666 6963 6965 6e74 2864 6174 613d 6461  fficient(data=da
+00019570: 7461 2c20 7769 6e64 6f77 5f73 697a 6573  ta, window_sizes
+00019580: 3d6e 702e 6172 7261 7928 5b31 2e30 2c20  =np.array([1.0, 
+00019590: 342e 305d 292c 2073 616d 706c 655f 7261  4.0]), sample_ra
+000195a0: 7465 3d31 3029 0a20 2020 2020 2020 2022  te=10).        "
+000195b0: 2222 0a0a 2020 2020 2020 2020 7265 7375  ""..        resu
+000195c0: 6c74 7320 3d20 6e70 2e66 756c 6c28 2864  lts = np.full((d
+000195d0: 6174 612e 7368 6170 655b 305d 2c20 7769  ata.shape[0], wi
+000195e0: 6e64 6f77 5f73 697a 6573 2e73 6861 7065  ndow_sizes.shape
+000195f0: 5b30 5d29 2c20 2d31 2e30 290a 2020 2020  [0]), -1.0).    
+00019600: 2020 2020 666f 7220 6920 696e 2070 7261      for i in pra
+00019610: 6e67 6528 7769 6e64 6f77 5f73 697a 6573  nge(window_sizes
+00019620: 2e73 6861 7065 5b30 5d29 3a0a 2020 2020  .shape[0]):.    
+00019630: 2020 2020 2020 2020 7769 6e64 6f77 5f73          window_s
+00019640: 697a 6520 3d20 696e 7428 7769 6e64 6f77  ize = int(window
+00019650: 5f73 697a 6573 5b69 5d20 2a20 7361 6d70  _sizes[i] * samp
+00019660: 6c65 5f72 6174 6529 0a20 2020 2020 2020  le_rate).       
+00019670: 2020 2020 2066 6f72 206c 2c20 7220 696e       for l, r in
+00019680: 207a 6970 280a 2020 2020 2020 2020 2020   zip(.          
+00019690: 2020 2020 2020 7261 6e67 6528 302c 2064        range(0, d
+000196a0: 6174 612e 7368 6170 655b 305d 202b 2031  ata.shape[0] + 1
+000196b0: 292c 2072 616e 6765 2877 696e 646f 775f  ), range(window_
+000196c0: 7369 7a65 2c20 6461 7461 2e73 6861 7065  size, data.shape
+000196d0: 5b30 5d20 2b20 3129 0a20 2020 2020 2020  [0] + 1).       
+000196e0: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
+000196f0: 2020 2020 2020 2020 7361 6d70 6c65 203d          sample =
+00019700: 2064 6174 615b 6c3a 722c 203a 5d0a 2020   data[l:r, :].  
+00019710: 2020 2020 2020 2020 2020 2020 2020 636e                cn
+00019720: 745f 305f 3020 3d20 6c65 6e28 0a20 2020  t_0_0 = len(.   
+00019730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019740: 206e 702e 6172 6777 6865 7265 2828 7361   np.argwhere((sa
+00019750: 6d70 6c65 5b3a 2c20 305d 203d 3d20 3029  mple[:, 0] == 0)
+00019760: 2026 2028 7361 6d70 6c65 5b3a 2c20 315d   & (sample[:, 1]
+00019770: 203d 3d20 3029 292e 666c 6174 7465 6e28   == 0)).flatten(
+00019780: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00019790: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+000197a0: 2020 2020 636e 745f 305f 3120 3d20 6c65      cnt_0_1 = le
+000197b0: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
+000197c0: 2020 2020 2020 206e 702e 6172 6777 6865         np.argwhe
+000197d0: 7265 2828 7361 6d70 6c65 5b3a 2c20 305d  re((sample[:, 0]
+000197e0: 203d 3d20 3029 2026 2028 7361 6d70 6c65   == 0) & (sample
+000197f0: 5b3a 2c20 315d 203d 3d20 3129 292e 666c  [:, 1] == 1)).fl
+00019800: 6174 7465 6e28 290a 2020 2020 2020 2020  atten().        
+00019810: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00019820: 2020 2020 2020 2020 2020 636e 745f 315f            cnt_1_
+00019830: 3020 3d20 6c65 6e28 0a20 2020 2020 2020  0 = len(.       
+00019840: 2020 2020 2020 2020 2020 2020 206e 702e               np.
+00019850: 6172 6777 6865 7265 2828 7361 6d70 6c65  argwhere((sample
+00019860: 5b3a 2c20 305d 203d 3d20 3129 2026 2028  [:, 0] == 1) & (
+00019870: 7361 6d70 6c65 5b3a 2c20 315d 203d 3d20  sample[:, 1] == 
+00019880: 3029 292e 666c 6174 7465 6e28 290a 2020  0)).flatten().  
+00019890: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+000198a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000198b0: 636e 745f 315f 3120 3d20 6c65 6e28 0a20  cnt_1_1 = len(. 
+000198c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000198d0: 2020 206e 702e 6172 6777 6865 7265 2828     np.argwhere((
+000198e0: 7361 6d70 6c65 5b3a 2c20 305d 203d 3d20  sample[:, 0] == 
+000198f0: 3129 2026 2028 7361 6d70 6c65 5b3a 2c20  1) & (sample[:, 
+00019900: 315d 203d 3d20 3129 292e 666c 6174 7465  1] == 1)).flatte
+00019910: 6e28 290a 2020 2020 2020 2020 2020 2020  n().            
+00019920: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00019930: 2020 2020 2020 4243 2c20 4144 203d 2063        BC, AD = c
+00019940: 6e74 5f31 5f31 202a 2063 6e74 5f30 5f30  nt_1_1 * cnt_0_0
+00019950: 2c20 636e 745f 315f 3020 2a20 636e 745f  , cnt_1_0 * cnt_
+00019960: 305f 310a 2020 2020 2020 2020 2020 2020  0_1.            
+00019970: 2020 2020 6e6f 6d69 6e61 746f 7220 3d20      nominator = 
+00019980: 4243 202d 2041 440a 2020 2020 2020 2020  BC - AD.        
+00019990: 2020 2020 2020 2020 6465 6e6f 6d69 6e61          denomina
+000199a0: 746f 7220 3d20 6e70 2e73 7172 7428 0a20  tor = np.sqrt(. 
+000199b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000199c0: 2020 2028 636e 745f 315f 3020 2b20 636e     (cnt_1_0 + cn
+000199d0: 745f 315f 3129 0a20 2020 2020 2020 2020  t_1_1).         
+000199e0: 2020 2020 2020 2020 2020 202a 2028 636e             * (cn
+000199f0: 745f 305f 3020 2b20 636e 745f 305f 3129  t_0_0 + cnt_0_1)
+00019a00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019a10: 2020 2020 202a 2028 636e 745f 315f 3020       * (cnt_1_0 
+00019a20: 2b20 636e 745f 305f 3029 0a20 2020 2020  + cnt_0_0).     
+00019a30: 2020 2020 2020 2020 2020 2020 2020 202a                 *
+00019a40: 2028 636e 745f 315f 3120 2a20 636e 745f   (cnt_1_1 * cnt_
+00019a50: 305f 3129 0a20 2020 2020 2020 2020 2020  0_1).           
+00019a60: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00019a70: 2020 2020 2020 2069 6620 6e6f 6d69 6e61         if nomina
+00019a80: 746f 7220 3d3d 2030 206f 7220 6465 6e6f  tor == 0 or deno
+00019a90: 6d69 6e61 746f 7220 3d3d 2030 3a0a 2020  minator == 0:.  
+00019aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019ab0: 2020 7265 7375 6c74 735b 7220 2d20 312c    results[r - 1,
+00019ac0: 2069 5d20 3d20 302e 300a 2020 2020 2020   i] = 0.0.      
+00019ad0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00019ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019af0: 2020 2020 7265 7375 6c74 735b 7220 2d20      results[r - 
+00019b00: 312c 2069 5d20 3d20 6e70 2e61 6273 280a  1, i] = np.abs(.
+00019b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019b20: 2020 2020 2020 2020 2842 4320 2d20 4144          (BC - AD
+00019b30: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00019b40: 2020 2020 2020 2020 2020 2f20 6e70 2e73            / np.s
+00019b50: 7172 7428 0a20 2020 2020 2020 2020 2020  qrt(.           
+00019b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019b70: 2028 636e 745f 315f 3020 2b20 636e 745f   (cnt_1_0 + cnt_
+00019b80: 315f 3129 0a20 2020 2020 2020 2020 2020  1_1).           
 00019b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019ba0: 2020 2064 6973 745f 7375 6d20 3d20 6e70     dist_sum = np
-00019bb0: 2e73 756d 2864 6973 7429 0a20 2020 2020  .sum(dist).     
-00019bc0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00019bd0: 6620 6469 7374 5f73 756d 203c 206d 696e  f dist_sum < min
-00019be0: 5f64 6973 743a 0a20 2020 2020 2020 2020  _dist:.         
-00019bf0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00019c00: 696e 5f64 6973 7420 3d20 6469 7374 5f73  in_dist = dist_s
-00019c10: 756d 0a20 2020 2020 2020 2020 2020 2020  um.             
-00019c20: 2020 2020 2020 2020 2020 206c 6162 656c             label
-00019c30: 735b 695d 203d 206a 0a0a 2020 2020 2020  s[i] = j..      
-00019c40: 2020 2020 2020 6e65 775f 6365 6e74 726f        new_centro
-00019c50: 6964 7320 3d20 6e70 2e7a 6572 6f73 5f6c  ids = np.zeros_l
-00019c60: 696b 6528 6365 6e74 726f 6964 7329 0a20  ike(centroids). 
-00019c70: 2020 2020 2020 2020 2020 2063 6f75 6e74             count
-00019c80: 7320 3d20 6e70 2e7a 6572 6f73 286b 2c20  s = np.zeros(k, 
-00019c90: 6474 7970 653d 6e70 2e69 6e74 3634 290a  dtype=np.int64).
-00019ca0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00019cb0: 6920 696e 2072 616e 6765 2858 2e73 6861  i in range(X.sha
-00019cc0: 7065 5b30 5d29 3a0a 2020 2020 2020 2020  pe[0]):.        
-00019cd0: 2020 2020 2020 2020 636c 7573 7465 7220          cluster 
-00019ce0: 3d20 6c61 6265 6c73 5b69 5d0a 2020 2020  = labels[i].    
-00019cf0: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
-00019d00: 6365 6e74 726f 6964 735b 636c 7573 7465  centroids[cluste
-00019d10: 725d 202b 3d20 585b 695d 0a20 2020 2020  r] += X[i].     
-00019d20: 2020 2020 2020 2020 2020 2063 6f75 6e74             count
-00019d30: 735b 636c 7573 7465 725d 202b 3d20 310a  s[cluster] += 1.
-00019d40: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-00019d50: 206a 2069 6e20 7261 6e67 6528 6b29 3a0a   j in range(k):.
-00019d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019d70: 6966 2063 6f75 6e74 735b 6a5d 203e 2030  if counts[j] > 0
-00019d80: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00019d90: 2020 2020 2020 6e65 775f 6365 6e74 726f        new_centro
-00019da0: 6964 735b 6a5d 202f 3d20 636f 756e 7473  ids[j] /= counts
-00019db0: 5b6a 5d0a 0a20 2020 2020 2020 2020 2020  [j]..           
-00019dc0: 2069 6620 6e70 2e61 7272 6179 5f65 7175   if np.array_equ
-00019dd0: 616c 2863 656e 7472 6f69 6473 2c20 6e65  al(centroids, ne
-00019de0: 775f 6365 6e74 726f 6964 7329 3a0a 2020  w_centroids):.  
-00019df0: 2020 2020 2020 2020 2020 2020 2020 6272                br
-00019e00: 6561 6b0a 2020 2020 2020 2020 2020 2020  eak.            
-00019e10: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00019e20: 2020 2020 2020 6365 6e74 726f 6964 7320        centroids 
-00019e30: 3d20 6e65 775f 6365 6e74 726f 6964 730a  = new_centroids.
-00019e40: 0a20 2020 2020 2020 2069 6620 6361 6c63  .        if calc
-00019e50: 5f6d 6564 6961 6e73 3a0a 2020 2020 2020  _medians:.      
-00019e60: 2020 2020 2020 6c61 6265 6c73 2c20 6d65        labels, me
-00019e70: 6469 616e 7320 3d20 6c61 6265 6c73 2e61  dians = labels.a
-00019e80: 7374 7970 6528 6e70 2e69 6e74 3634 292c  stype(np.int64),
-00019e90: 207b 7d0a 2020 2020 2020 2020 2020 2020   {}.            
-00019ea0: 666f 7220 6920 696e 2070 7261 6e67 6528  for i in prange(
-00019eb0: 302c 206b 2c20 3129 3a0a 2020 2020 2020  0, k, 1):.      
-00019ec0: 2020 2020 2020 2020 2020 6d65 6469 616e            median
-00019ed0: 735b 695d 203d 206e 702e 6d65 6469 616e  s[i] = np.median
-00019ee0: 2864 6174 615b 6e70 2e61 7267 7768 6572  (data[np.argwher
-00019ef0: 6528 6c61 6265 6c73 203d 3d20 6929 2e66  e(labels == i).f
-00019f00: 6c61 7474 656e 2829 5d29 0a0a 2020 2020  latten()])..    
-00019f10: 2020 2020 7265 7475 726e 2063 656e 7472      return centr
-00019f20: 6f69 6473 2c20 6c61 6265 6c73 2c20 6d65  oids, labels, me
-00019f30: 6469 616e 730a 0a20 2020 2040 7374 6174  dians..    @stat
-00019f40: 6963 6d65 7468 6f64 0a20 2020 2040 6e6a  icmethod.    @nj
-00019f50: 6974 280a 2020 2020 2020 2020 5b0a 2020  it(.        [.  
-00019f60: 2020 2020 2020 2020 2020 2869 6e74 385b            (int8[
-00019f70: 3a5d 2c20 696e 7438 5b3a 5d2c 2074 7970  :], int8[:], typ
-00019f80: 6573 2e6d 6973 632e 4f6d 6974 7465 6428  es.misc.Omitted(
-00019f90: 7661 6c75 653d 4661 6c73 6529 2c20 666c  value=False), fl
-00019fa0: 6f61 7433 325b 3a5d 292c 0a20 2020 2020  oat32[:]),.     
-00019fb0: 2020 2020 2020 2028 0a20 2020 2020 2020         (.       
-00019fc0: 2020 2020 2020 2020 2069 6e74 385b 3a5d           int8[:]
-00019fd0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00019fe0: 2020 696e 7438 5b3a 5d2c 0a20 2020 2020    int8[:],.     
-00019ff0: 2020 2020 2020 2020 2020 2074 7970 6573             types
-0001a000: 2e6d 6973 632e 4f6d 6974 7465 6428 7661  .misc.Omitted(va
-0001a010: 6c75 653d 4661 6c73 6529 2c0a 2020 2020  lue=False),.    
-0001a020: 2020 2020 2020 2020 2020 2020 7479 7065              type
-0001a030: 732e 6d69 7363 2e4f 6d69 7474 6564 284e  s.misc.Omitted(N
-0001a040: 6f6e 6529 2c0a 2020 2020 2020 2020 2020  one),.          
-0001a050: 2020 292c 0a20 2020 2020 2020 2020 2020    ),.           
-0001a060: 2028 696e 7438 5b3a 5d2c 2069 6e74 385b   (int8[:], int8[
-0001a070: 3a5d 2c20 626f 6f6c 5f2c 2066 6c6f 6174  :], bool_, float
-0001a080: 3332 5b3a 5d29 2c0a 2020 2020 2020 2020  32[:]),.        
-0001a090: 2020 2020 2869 6e74 385b 3a5d 2c20 696e      (int8[:], in
-0001a0a0: 7438 5b3a 5d2c 2062 6f6f 6c5f 2c20 7479  t8[:], bool_, ty
-0001a0b0: 7065 732e 6d69 7363 2e4f 6d69 7474 6564  pes.misc.Omitted
-0001a0c0: 284e 6f6e 6529 292c 0a20 2020 2020 2020  (None)),.       
-0001a0d0: 205d 0a20 2020 2029 0a20 2020 2064 6566   ].    ).    def
-0001a0e0: 2068 616d 6d69 6e67 5f64 6973 7461 6e63   hamming_distanc
-0001a0f0: 6528 0a20 2020 2020 2020 2078 3a20 6e70  e(.        x: np
-0001a100: 2e6e 6461 7272 6179 2c0a 2020 2020 2020  .ndarray,.      
-0001a110: 2020 793a 206e 702e 6e64 6172 7261 792c    y: np.ndarray,
-0001a120: 0a20 2020 2020 2020 2073 6f72 743a 204f  .        sort: O
-0001a130: 7074 696f 6e61 6c5b 626f 6f6c 5d20 3d20  ptional[bool] = 
-0001a140: 4661 6c73 652c 0a20 2020 2020 2020 2077  False,.        w
-0001a150: 3a20 4f70 7469 6f6e 616c 5b6e 702e 6e64  : Optional[np.nd
-0001a160: 6172 7261 795d 203d 204e 6f6e 652c 0a20  array] = None,. 
-0001a170: 2020 2029 202d 3e20 666c 6f61 743a 0a20     ) -> float:. 
-0001a180: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001a190: 2020 204a 6974 7465 6420 6361 6c63 756c     Jitted calcul
-0001a1a0: 6174 6520 6f66 2074 6865 2048 616d 6d69  ate of the Hammi
-0001a1b0: 6e67 2073 696d 696c 6172 6974 7920 6265  ng similarity be
-0001a1c0: 7477 6565 6e20 7477 6f20 7665 6374 6f72  tween two vector
-0001a1d0: 732e 0a0a 2020 2020 2020 2020 2e2e 206e  s...        .. n
-0001a1e0: 6f74 653a 3a0a 2020 2020 2020 2020 2020  ote::.          
-0001a1f0: 2041 6461 7074 6564 2066 726f 6d20 6070   Adapted from `p
-0001a200: 796e 6e64 6573 6365 6e74 203c 6874 7470  ynndescent <http
-0001a210: 733a 2f2f 7079 6e6e 6465 7363 656e 742e  s://pynndescent.
-0001a220: 7265 6164 7468 6564 6f63 732e 696f 2f65  readthedocs.io/e
-0001a230: 6e2f 6c61 7465 7374 2f3e 605f 2e0a 0a20  n/latest/>`_... 
-0001a240: 2020 2020 2020 203a 7061 7261 6d65 7465         :paramete
-0001a250: 7220 6e70 2e6e 6461 7272 6179 2078 3a20  r np.ndarray x: 
-0001a260: 4669 7273 7420 6269 6e61 7279 2076 6563  First binary vec
-0001a270: 746f 722e 0a20 2020 2020 2020 203a 7061  tor..        :pa
-0001a280: 7261 6d65 7465 7220 6e70 2e6e 6461 7272  rameter np.ndarr
-0001a290: 6179 2078 3a20 5365 636f 6e64 2062 696e  ay x: Second bin
-0001a2a0: 6172 7920 7665 6374 6f72 2e0a 2020 2020  ary vector..    
-0001a2b0: 2020 2020 3a70 6172 616d 6574 6572 204f      :parameter O
-0001a2c0: 7074 696f 6e61 6c5b 6e70 2e6e 6461 7272  ptional[np.ndarr
-0001a2d0: 6179 5d20 773a 204f 7074 696f 6e61 6c20  ay] w: Optional 
-0001a2e0: 7765 6967 6874 7320 666f 7220 6561 6368  weights for each
-0001a2f0: 2065 6c65 6d65 6e74 2e20 4361 6e20 6265   element. Can be
-0001a300: 2063 6c61 7373 6966 6963 6174 696f 6e20   classification 
-0001a310: 7072 6f62 6162 696c 6974 6965 732e 2049  probabilities. I
-0001a320: 6620 6e6f 7420 7072 6f76 6964 6564 2c20  f not provided, 
-0001a330: 6571 7561 6c20 7765 6967 6874 7320 6172  equal weights ar
-0001a340: 6520 6173 7375 6d65 642e 0a20 2020 2020  e assumed..     
-0001a350: 2020 203a 7061 7261 6d65 7465 7220 4f70     :parameter Op
-0001a360: 7469 6f6e 616c 5b62 6f6f 6c5d 2073 6f72  tional[bool] sor
-0001a370: 743a 2049 6620 5472 7565 2c20 736f 7274  t: If True, sort
-0001a380: 7320 7820 616e 6420 7920 7072 696f 7220  s x and y prior 
-0001a390: 746f 2068 616d 6d69 6e67 2064 6973 7461  to hamming dista
-0001a3a0: 6e63 6520 6361 6c63 756c 6174 696f 6e2e  nce calculation.
-0001a3b0: 2044 6566 6175 6c74 2c20 4661 6c73 652e   Default, False.
-0001a3c0: 0a0a 2020 2020 2020 2020 3a65 7861 6d70  ..        :examp
-0001a3d0: 6c65 3a0a 2020 2020 2020 2020 3e3e 3e20  le:.        >>> 
-0001a3e0: 782c 2079 203d 206e 702e 7261 6e64 6f6d  x, y = np.random
-0001a3f0: 2e72 616e 6469 6e74 2830 2c20 322c 2028  .randint(0, 2, (
-0001a400: 3130 2c29 292e 6173 7479 7065 286e 702e  10,)).astype(np.
-0001a410: 696e 7438 292c 206e 702e 7261 6e64 6f6d  int8), np.random
-0001a420: 2e72 616e 6469 6e74 2830 2c20 322c 2028  .randint(0, 2, (
-0001a430: 3130 2c29 292e 6173 7479 7065 286e 702e  10,)).astype(np.
-0001a440: 696e 7438 290a 2020 2020 2020 2020 3e3e  int8).        >>
-0001a450: 3e20 5374 6174 6973 7469 6373 2829 2e68  > Statistics().h
-0001a460: 616d 6d69 6e67 5f64 6973 7461 6e63 6528  amming_distance(
-0001a470: 783d 782c 2079 3d79 290a 2020 2020 2020  x=x, y=y).      
-0001a480: 2020 3e3e 3e20 302e 3931 0a20 2020 2020    >>> 0.91.     
-0001a490: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
-0001a4a0: 2070 6173 730a 2020 2020 2020 2020 6966   pass.        if
-0001a4b0: 2077 2069 7320 4e6f 6e65 3a0a 2020 2020   w is None:.    
-0001a4c0: 2020 2020 2020 2020 7720 3d20 6e70 2e6f          w = np.o
-0001a4d0: 6e65 7328 782e 7368 6170 655b 305d 292e  nes(x.shape[0]).
-0001a4e0: 6173 7479 7065 286e 702e 666c 6f61 7433  astype(np.float3
-0001a4f0: 3229 0a0a 2020 2020 2020 2020 7265 7375  2)..        resu
-0001a500: 6c74 7320 3d20 302e 300a 2020 2020 2020  lts = 0.0.      
-0001a510: 2020 6966 2073 6f72 743a 0a20 2020 2020    if sort:.     
-0001a520: 2020 2020 2020 2078 2c20 7920 3d20 6e70         x, y = np
-0001a530: 2e73 6f72 7428 7829 2c20 6e70 2e73 6f72  .sort(x), np.sor
-0001a540: 7428 7929 0a20 2020 2020 2020 2066 6f72  t(y).        for
-0001a550: 2069 2069 6e20 7072 616e 6765 2878 2e73   i in prange(x.s
-0001a560: 6861 7065 5b30 5d29 3a0a 2020 2020 2020  hape[0]):.      
-0001a570: 2020 2020 2020 6966 2078 5b69 5d20 213d        if x[i] !=
-0001a580: 2079 5b69 5d3a 0a20 2020 2020 2020 2020   y[i]:.         
-0001a590: 2020 2020 2020 2072 6573 756c 7473 202b         results +
-0001a5a0: 3d20 312e 3020 2a20 775b 695d 0a20 2020  = 1.0 * w[i].   
-0001a5b0: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
-0001a5c0: 6c74 7320 2f20 782e 7368 6170 655b 305d  lts / x.shape[0]
-0001a5d0: 0a0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
-0001a5e0: 686f 640a 2020 2020 406e 6a69 7428 0a20  hod.    @njit(. 
-0001a5f0: 2020 2020 2020 205b 2869 6e74 385b 3a5d         [(int8[:]
-0001a600: 2c20 696e 7438 5b3a 5d2c 2066 6c6f 6174  , int8[:], float
-0001a610: 3332 5b3a 5d29 2c20 2869 6e74 385b 3a5d  32[:]), (int8[:]
-0001a620: 2c20 696e 7438 5b3a 5d2c 2074 7970 6573  , int8[:], types
-0001a630: 2e6d 6973 632e 4f6d 6974 7465 6428 4e6f  .misc.Omitted(No
-0001a640: 6e65 2929 5d0a 2020 2020 290a 2020 2020  ne))].    ).    
-0001a650: 6465 6620 7975 6c65 5f63 6f65 6628 0a20  def yule_coef(. 
-0001a660: 2020 2020 2020 2078 3a20 6e70 2e6e 6461         x: np.nda
-0001a670: 7272 6179 2c20 793a 206e 702e 6e64 6172  rray, y: np.ndar
-0001a680: 7261 792c 2077 3a20 4f70 7469 6f6e 616c  ray, w: Optional
-0001a690: 5b6e 702e 6e64 6172 7261 795d 203d 204e  [np.ndarray] = N
-0001a6a0: 6f6e 650a 2020 2020 2920 2d3e 2066 6c6f  one.    ) -> flo
-0001a6b0: 6174 3634 3a0a 2020 2020 2020 2020 2222  at64:.        ""
-0001a6c0: 220a 2020 2020 2020 2020 4a69 7474 6564  ".        Jitted
-0001a6d0: 2063 616c 6375 6c61 7465 206f 6620 7468   calculate of th
-0001a6e0: 6520 7975 6c65 2063 6f65 6666 6963 6965  e yule coefficie
-0001a6f0: 6e74 2062 6574 7765 656e 2074 776f 2062  nt between two b
-0001a700: 696e 6172 7920 7665 6374 6f72 7320 2865  inary vectors (e
-0001a710: 2e67 2e2c 2074 6f20 636c 6173 7369 6669  .g., to classifi
-0001a720: 6564 2062 6568 6176 696f 7273 292e 2030  ed behaviors). 0
-0001a730: 2072 6570 7265 7365 6e74 2069 6e64 6570   represent indep
-0001a740: 656e 6465 6e63 652c 2032 2072 6570 7265  endence, 2 repre
-0001a750: 7365 6e74 730a 2020 2020 2020 2020 636f  sents.        co
-0001a760: 6d70 6c65 7465 2069 6e74 6572 6465 7065  mplete interdepe
-0001a770: 6e64 656e 6365 2e0a 0a20 2020 2020 2020  ndence...       
-0001a780: 202e 2e20 6e6f 7465 3a3a 0a20 2020 2020   .. note::.     
-0001a790: 2020 2020 2020 4164 6170 7465 6420 6672        Adapted fr
-0001a7a0: 6f6d 2060 7079 6e6e 6465 7363 656e 7420  om `pynndescent 
-0001a7b0: 3c68 7474 7073 3a2f 2f70 796e 6e64 6573  <https://pynndes
-0001a7c0: 6365 6e74 2e72 6561 6474 6865 646f 6373  cent.readthedocs
-0001a7d0: 2e69 6f2f 656e 2f6c 6174 6573 742f 3e60  .io/en/latest/>`
-0001a7e0: 5f2e 0a0a 2020 2020 2020 2020 3a70 6172  _...        :par
-0001a7f0: 616d 6574 6572 206e 702e 6e64 6172 7261  ameter np.ndarra
-0001a800: 7920 783a 2046 6972 7374 2062 696e 6172  y x: First binar
-0001a810: 7920 7665 6374 6f72 2e0a 2020 2020 2020  y vector..      
-0001a820: 2020 3a70 6172 616d 6574 6572 206e 702e    :parameter np.
-0001a830: 6e64 6172 7261 7920 783a 2053 6563 6f6e  ndarray x: Secon
-0001a840: 6420 6269 6e61 7279 2076 6563 746f 722e  d binary vector.
-0001a850: 0a20 2020 2020 2020 203a 7061 7261 6d65  .        :parame
-0001a860: 7465 7220 4f70 7469 6f6e 616c 5b6e 702e  ter Optional[np.
-0001a870: 6e64 6172 7261 795d 2077 3a20 4f70 7469  ndarray] w: Opti
-0001a880: 6f6e 616c 2077 6569 6768 7473 2066 6f72  onal weights for
-0001a890: 2065 6163 6820 656c 656d 656e 742e 2043   each element. C
-0001a8a0: 616e 2062 6520 636c 6173 7369 6669 6361  an be classifica
-0001a8b0: 7469 6f6e 2070 726f 6261 6269 6c69 7469  tion probabiliti
-0001a8c0: 6573 2e20 4966 206e 6f74 2070 726f 7669  es. If not provi
-0001a8d0: 6465 642c 2065 7175 616c 2077 6569 6768  ded, equal weigh
-0001a8e0: 7473 2061 7265 2061 7373 756d 6564 2e0a  ts are assumed..
-0001a8f0: 0a20 2020 2020 2020 203a 6578 616d 706c  .        :exampl
-0001a900: 653a 0a20 2020 2020 2020 203e 3e3e 2078  e:.        >>> x
-0001a910: 203d 206e 702e 7261 6e64 6f6d 2e72 616e   = np.random.ran
-0001a920: 6469 6e74 2830 2c20 322c 2028 3530 2c29  dint(0, 2, (50,)
-0001a930: 292e 6173 7479 7065 286e 702e 696e 7438  ).astype(np.int8
-0001a940: 290a 2020 2020 2020 2020 3e3e 3e20 7920  ).        >>> y 
-0001a950: 3d20 7820 5e20 310a 2020 2020 2020 2020  = x ^ 1.        
-0001a960: 3e3e 3e20 5374 6174 6973 7469 6373 2829  >>> Statistics()
-0001a970: 2e79 756c 655f 636f 6566 2878 3d78 2c20  .yule_coef(x=x, 
-0001a980: 793d 7929 0a20 2020 2020 2020 203e 3e3e  y=y).        >>>
-0001a990: 2032 0a20 2020 2020 2020 203e 3e3e 2072   2.        >>> r
-0001a9a0: 616e 646f 6d5f 696e 6469 6365 7320 3d20  andom_indices = 
-0001a9b0: 6e70 2e72 616e 646f 6d2e 6368 6f69 6365  np.random.choice
-0001a9c0: 286c 656e 2878 292c 2073 697a 653d 6c65  (len(x), size=le
-0001a9d0: 6e28 7829 2f2f 322c 2072 6570 6c61 6365  n(x)//2, replace
-0001a9e0: 3d46 616c 7365 290a 2020 2020 2020 2020  =False).        
-0001a9f0: 3e3e 3e20 7920 3d20 6e70 2e63 6f70 7928  >>> y = np.copy(
-0001aa00: 7829 0a20 2020 2020 2020 203e 3e3e 2079  x).        >>> y
-0001aa10: 5b72 616e 646f 6d5f 696e 6469 6365 735d  [random_indices]
-0001aa20: 203d 2031 202d 2079 5b72 616e 646f 6d5f   = 1 - y[random_
-0001aa30: 696e 6469 6365 735d 0a20 2020 2020 2020  indices].       
-0001aa40: 203e 3e3e 2053 7461 7469 7374 6963 7328   >>> Statistics(
-0001aa50: 292e 7975 6c65 5f63 6f65 6628 783d 782c  ).yule_coef(x=x,
-0001aa60: 2079 3d79 290a 2020 2020 2020 2020 3e3e   y=y).        >>
-0001aa70: 3e20 302e 3939 0a20 2020 2020 2020 2022  > 0.99.        "
-0001aa80: 2222 0a20 2020 2020 2020 2069 6620 7720  "".        if w 
-0001aa90: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-0001aaa0: 2020 2020 2077 203d 206e 702e 6f6e 6573       w = np.ones
-0001aab0: 2878 2e73 6861 7065 5b30 5d29 2e61 7374  (x.shape[0]).ast
-0001aac0: 7970 6528 6e70 2e66 6c6f 6174 3332 290a  ype(np.float32).
-0001aad0: 0a20 2020 2020 2020 2066 5f66 2c20 745f  .        f_f, t_
-0001aae0: 742c 2074 5f66 2c20 665f 7420 3d20 302e  t, t_f, f_t = 0.
-0001aaf0: 302c 2030 2e30 2c20 302e 302c 2030 2e30  0, 0.0, 0.0, 0.0
-0001ab00: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
-0001ab10: 6e20 7072 616e 6765 2878 2e73 6861 7065  n prange(x.shape
-0001ab20: 5b30 5d29 3a0a 2020 2020 2020 2020 2020  [0]):.          
-0001ab30: 2020 6966 2028 785b 695d 203d 3d20 3129    if (x[i] == 1)
-0001ab40: 2061 6e64 2028 795b 695d 203d 3d20 3129   and (y[i] == 1)
-0001ab50: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001ab60: 2020 745f 7420 2b3d 2031 202a 2077 5b69    t_t += 1 * w[i
-0001ab70: 5d0a 2020 2020 2020 2020 2020 2020 6966  ].            if
-0001ab80: 2028 785b 695d 203d 3d20 3029 2061 6e64   (x[i] == 0) and
-0001ab90: 2028 795b 695d 203d 3d20 3029 3a0a 2020   (y[i] == 0):.  
-0001aba0: 2020 2020 2020 2020 2020 2020 2020 665f                f_
-0001abb0: 6620 2b3d 2031 202a 2077 5b69 5d0a 2020  f += 1 * w[i].  
-0001abc0: 2020 2020 2020 2020 2020 6966 2028 785b            if (x[
-0001abd0: 695d 203d 3d20 3029 2061 6e64 2028 795b  i] == 0) and (y[
-0001abe0: 695d 203d 3d20 3129 3a0a 2020 2020 2020  i] == 1):.      
-0001abf0: 2020 2020 2020 2020 2020 665f 7420 2b3d            f_t +=
-0001ac00: 2031 202a 2077 5b69 5d0a 2020 2020 2020   1 * w[i].      
-0001ac10: 2020 2020 2020 6966 2028 785b 695d 203d        if (x[i] =
-0001ac20: 3d20 3129 2061 6e64 2028 795b 695d 203d  = 1) and (y[i] =
-0001ac30: 3d20 3029 3a0a 2020 2020 2020 2020 2020  = 0):.          
-0001ac40: 2020 2020 2020 745f 6620 2b3d 2031 202a        t_f += 1 *
-0001ac50: 2077 5b69 5d0a 2020 2020 2020 2020 6966   w[i].        if
-0001ac60: 2074 5f66 203d 3d20 302e 3020 6f72 2066   t_f == 0.0 or f
-0001ac70: 5f74 203d 3d20 302e 303a 0a20 2020 2020  _t == 0.0:.     
-0001ac80: 2020 2020 2020 2072 6574 7572 6e20 302e         return 0.
-0001ac90: 300a 2020 2020 2020 2020 656c 7365 3a0a  0.        else:.
-0001aca0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001acb0: 726e 2028 322e 3020 2a20 745f 6620 2a20  rn (2.0 * t_f * 
-0001acc0: 665f 7429 202f 2028 745f 7420 2a20 665f  f_t) / (t_t * f_
-0001acd0: 6620 2b20 745f 6620 2a20 665f 7429 0a0a  f + t_f * f_t)..
-0001ace0: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
-0001acf0: 640a 2020 2020 406e 6a69 7428 0a20 2020  d.    @njit(.   
-0001ad00: 2020 2020 205b 2869 6e74 385b 3a5d 2c20       [(int8[:], 
-0001ad10: 696e 7438 5b3a 5d2c 2074 7970 6573 2e6d  int8[:], types.m
-0001ad20: 6973 632e 4f6d 6974 7465 6428 4e6f 6e65  isc.Omitted(None
-0001ad30: 2929 2c20 2869 6e74 385b 3a5d 2c20 696e  )), (int8[:], in
-0001ad40: 7438 5b3a 5d2c 2066 6c6f 6174 3332 5b3a  t8[:], float32[:
-0001ad50: 5d29 5d0a 2020 2020 290a 2020 2020 6465  ])].    ).    de
-0001ad60: 6620 736f 6b61 6c5f 736e 6561 7468 280a  f sokal_sneath(.
-0001ad70: 2020 2020 2020 2020 783a 206e 702e 6e64          x: np.nd
-0001ad80: 6172 7261 792c 2079 3a20 6e70 2e6e 6461  array, y: np.nda
-0001ad90: 7272 6179 2c20 773a 204f 7074 696f 6e61  rray, w: Optiona
-0001ada0: 6c5b 6e70 2e6e 6461 7272 6179 5d20 3d20  l[np.ndarray] = 
-0001adb0: 4e6f 6e65 0a20 2020 2029 202d 3e20 666c  None.    ) -> fl
-0001adc0: 6f61 7436 343a 0a20 2020 2020 2020 2022  oat64:.        "
-0001add0: 2222 0a20 2020 2020 2020 204a 6974 7465  "".        Jitte
-0001ade0: 6420 6361 6c63 756c 6174 6520 6f66 2074  d calculate of t
-0001adf0: 6865 2073 6f6b 616c 2073 6e65 6174 6820  he sokal sneath 
-0001ae00: 636f 6566 6669 6369 656e 7420 6265 7477  coefficient betw
-0001ae10: 6565 6e20 7477 6f20 6269 6e61 7279 2076  een two binary v
-0001ae20: 6563 746f 7273 2028 652e 672e 2c20 746f  ectors (e.g., to
-0001ae30: 2063 6c61 7373 6966 6965 6420 6265 6861   classified beha
-0001ae40: 7669 6f72 7329 2e20 3020 7265 7072 6573  viors). 0 repres
-0001ae50: 656e 7420 696e 6465 7065 6e64 656e 6365  ent independence
-0001ae60: 2c20 3120 7265 7072 6573 656e 7473 2063  , 1 represents c
-0001ae70: 6f6d 706c 6574 6520 696e 7465 7264 6570  omplete interdep
-0001ae80: 656e 6465 6e63 652e 0a0a 2020 2020 2020  endence...      
-0001ae90: 2020 3a70 6172 616d 6574 6572 206e 702e    :parameter np.
-0001aea0: 6e64 6172 7261 7920 783a 2046 6972 7374  ndarray x: First
-0001aeb0: 2062 696e 6172 7920 7665 6374 6f72 2e0a   binary vector..
-0001aec0: 2020 2020 2020 2020 3a70 6172 616d 6574          :paramet
-0001aed0: 6572 206e 702e 6e64 6172 7261 7920 783a  er np.ndarray x:
-0001aee0: 2053 6563 6f6e 6420 6269 6e61 7279 2076   Second binary v
-0001aef0: 6563 746f 722e 0a20 2020 2020 2020 203a  ector..        :
-0001af00: 7061 7261 6d65 7465 7220 4f70 7469 6f6e  parameter Option
-0001af10: 616c 5b6e 702e 6e64 6172 7261 795d 2077  al[np.ndarray] w
-0001af20: 3a20 4f70 7469 6f6e 616c 2077 6569 6768  : Optional weigh
-0001af30: 7473 2066 6f72 2065 6163 6820 656c 656d  ts for each elem
-0001af40: 656e 742e 2043 616e 2062 6520 636c 6173  ent. Can be clas
-0001af50: 7369 6669 6361 7469 6f6e 2070 726f 6261  sification proba
-0001af60: 6269 6c69 7469 6573 2e20 4966 206e 6f74  bilities. If not
-0001af70: 2070 726f 7669 6465 642c 2065 7175 616c   provided, equal
-0001af80: 2077 6569 6768 7473 2061 7265 2061 7373   weights are ass
-0001af90: 756d 6564 2e0a 0a20 2020 2020 2020 202e  umed...        .
-0001afa0: 2e20 6e6f 7465 3a3a 0a20 2020 2020 2020  . note::.       
-0001afb0: 2020 2020 4164 6170 7465 6420 6672 6f6d      Adapted from
-0001afc0: 2060 7079 6e6e 6465 7363 656e 7420 3c68   `pynndescent <h
-0001afd0: 7474 7073 3a2f 2f70 796e 6e64 6573 6365  ttps://pynndesce
-0001afe0: 6e74 2e72 6561 6474 6865 646f 6373 2e69  nt.readthedocs.i
-0001aff0: 6f2f 656e 2f6c 6174 6573 742f 3e60 5f2e  o/en/latest/>`_.
-0001b000: 0a0a 2020 2020 2020 2020 3a65 7861 6d70  ..        :examp
-0001b010: 6c65 3a0a 2020 2020 2020 2020 3e3e 3e20  le:.        >>> 
-0001b020: 7820 3d20 6e70 2e61 7272 6179 285b 302c  x = np.array([0,
-0001b030: 2031 2c20 302c 2030 2c20 315d 292e 6173   1, 0, 0, 1]).as
-0001b040: 7479 7065 286e 702e 696e 7438 290a 2020  type(np.int8).  
-0001b050: 2020 2020 2020 3e3e 3e20 7920 3d20 6e70        >>> y = np
-0001b060: 2e61 7272 6179 285b 312c 2030 2c20 312c  .array([1, 0, 1,
-0001b070: 2031 2c20 305d 292e 6173 7479 7065 286e   1, 0]).astype(n
-0001b080: 702e 696e 7438 290a 2020 2020 2020 2020  p.int8).        
-0001b090: 3e3e 3e20 5374 6174 6973 7469 6373 2829  >>> Statistics()
-0001b0a0: 2e73 6f6b 616c 5f73 6e65 6174 6828 782c  .sokal_sneath(x,
-0001b0b0: 2079 290a 2020 2020 2020 2020 3e3e 3e20   y).        >>> 
-0001b0c0: 302e 300a 2020 2020 2020 2020 2222 220a  0.0.        """.
-0001b0d0: 2020 2020 2020 2020 6966 2077 2069 7320          if w is 
-0001b0e0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0001b0f0: 2020 7720 3d20 6e70 2e6f 6e65 7328 782e    w = np.ones(x.
-0001b100: 7368 6170 655b 305d 292e 6173 7479 7065  shape[0]).astype
-0001b110: 2866 6c6f 6174 3332 290a 2020 2020 2020  (float32).      
-0001b120: 2020 745f 636e 742c 2066 5f63 6e74 2c20    t_cnt, f_cnt, 
-0001b130: 745f 662c 2066 5f74 203d 2030 2e30 2c20  t_f, f_t = 0.0, 
-0001b140: 302e 302c 2030 2e30 2c20 302e 300a 2020  0.0, 0.0, 0.0.  
-0001b150: 2020 2020 2020 666f 7220 6920 696e 2070        for i in p
-0001b160: 7261 6e67 6528 782e 7368 6170 655b 305d  range(x.shape[0]
-0001b170: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-0001b180: 6620 2878 5b69 5d20 3d3d 2031 2920 616e  f (x[i] == 1) an
-0001b190: 6420 2879 5b69 5d20 3d3d 2031 293a 0a20  d (y[i] == 1):. 
-0001b1a0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-0001b1b0: 5f63 6e74 202b 3d20 312e 3020 2a20 775b  _cnt += 1.0 * w[
-0001b1c0: 695d 0a20 2020 2020 2020 2020 2020 2065  i].            e
-0001b1d0: 6c69 6620 2878 5b69 5d20 3d3d 2030 2920  lif (x[i] == 0) 
-0001b1e0: 616e 6420 2879 5b69 5d20 3d3d 2030 293a  and (y[i] == 0):
-0001b1f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b200: 2066 5f63 6e74 202b 3d20 312e 3020 2a20   f_cnt += 1.0 * 
-0001b210: 775b 695d 0a20 2020 2020 2020 2020 2020  w[i].           
-0001b220: 2065 6c69 6620 2878 5b69 5d20 3d3d 2030   elif (x[i] == 0
-0001b230: 2920 616e 6420 2879 5b69 5d20 3d3d 2031  ) and (y[i] == 1
-0001b240: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0001b250: 2020 2066 5f74 202b 3d20 312e 3020 2a20     f_t += 1.0 * 
-0001b260: 775b 695d 0a20 2020 2020 2020 2020 2020  w[i].           
-0001b270: 2065 6c69 6620 2878 5b69 5d20 3d3d 2031   elif (x[i] == 1
-0001b280: 2920 616e 6420 2879 5b69 5d20 3d3d 2030  ) and (y[i] == 0
-0001b290: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0001b2a0: 2020 2074 5f66 202b 3d20 312e 3020 2a20     t_f += 1.0 * 
-0001b2b0: 775b 695d 0a0a 2020 2020 2020 2020 6966  w[i]..        if
-0001b2c0: 2074 5f66 202b 2066 5f74 203d 3d20 302e   t_f + f_t == 0.
-0001b2d0: 303a 0a20 2020 2020 2020 2020 2020 2072  0:.            r
-0001b2e0: 6574 7572 6e20 302e 300a 2020 2020 2020  eturn 0.0.      
-0001b2f0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0001b300: 2020 2020 7265 7475 726e 2028 665f 7420      return (f_t 
-0001b310: 2b20 745f 6629 202f 2028 3220 2a20 2874  + t_f) / (2 * (t
-0001b320: 5f63 6e74 202b 2066 5f63 6e74 2920 2b20  _cnt + f_cnt) + 
-0001b330: 665f 7420 2b20 745f 6629 0a0a 2020 2020  f_t + t_f)..    
-0001b340: 4073 7461 7469 636d 6574 686f 640a 2020  @staticmethod.  
-0001b350: 2020 406e 6a69 7428 5b28 666c 6f61 7433    @njit([(float3
-0001b360: 325b 3a2c 203a 5d2c 2066 6c6f 6174 3332  2[:, :], float32
-0001b370: 5b3a 2c20 3a5d 292c 2028 666c 6f61 7433  [:, :]), (float3
-0001b380: 325b 3a2c 203a 5d2c 2074 7970 6573 2e6d  2[:, :], types.m
-0001b390: 6973 632e 4f6d 6974 7465 6428 4e6f 6e65  isc.Omitted(None
-0001b3a0: 2929 5d29 0a20 2020 2064 6566 2062 7261  ))]).    def bra
-0001b3b0: 795f 6375 7274 6973 5f64 6973 7369 6d69  y_curtis_dissimi
-0001b3c0: 6c61 7269 7479 280a 2020 2020 2020 2020  larity(.        
-0001b3d0: 783a 206e 702e 6e64 6172 7261 792c 2077  x: np.ndarray, w
-0001b3e0: 3a20 4f70 7469 6f6e 616c 5b6e 702e 6e64  : Optional[np.nd
-0001b3f0: 6172 7261 795d 203d 204e 6f6e 650a 2020  array] = None.  
-0001b400: 2020 2920 2d3e 206e 702e 6e64 6172 7261    ) -> np.ndarra
-0001b410: 793a 0a20 2020 2020 2020 2022 2222 0a20  y:.        """. 
-0001b420: 2020 2020 2020 204a 6974 7465 6420 6361         Jitted ca
-0001b430: 6c63 756c 6174 6520 6f66 2074 6865 2042  lculate of the B
-0001b440: 7261 792d 4375 7274 6973 2064 6973 7369  ray-Curtis dissi
-0001b450: 6d69 6c61 7269 7479 206d 6174 7269 7820  milarity matrix 
-0001b460: 6265 7477 6565 6e20 7361 6d70 6c65 7320  between samples 
-0001b470: 6261 7365 6420 6f6e 2066 6561 7475 7265  based on feature
-0001b480: 2076 616c 7565 732e 0a0a 2020 2020 2020   values...      
-0001b490: 2020 5573 6566 756c 2066 6f72 2066 696e    Useful for fin
-0001b4a0: 6469 6e67 2073 696d 696c 6172 2066 7261  ding similar fra
-0001b4b0: 6d65 7320 6261 7365 6420 6f6e 2062 6568  mes based on beh
-0001b4c0: 6176 696f 722e 0a0a 2020 2020 2020 2020  avior...        
-0001b4d0: 2e2e 206e 6f74 653a 3a0a 2020 2020 2020  .. note::.      
-0001b4e0: 2020 2020 2041 6461 7074 6564 2066 726f       Adapted fro
-0001b4f0: 6d20 6070 796e 6e64 6573 6365 6e74 203c  m `pynndescent <
-0001b500: 6874 7470 733a 2f2f 7079 6e6e 6465 7363  https://pynndesc
-0001b510: 656e 742e 7265 6164 7468 6564 6f63 732e  ent.readthedocs.
-0001b520: 696f 2f65 6e2f 6c61 7465 7374 2f3e 605f  io/en/latest/>`_
-0001b530: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-0001b540: 6d65 7465 7220 6e70 2e6e 6461 7272 6179  meter np.ndarray
-0001b550: 2078 3a20 3264 2061 7272 6179 2077 6974   x: 2d array wit
-0001b560: 6820 6c69 6b65 6c79 206e 6f72 6d61 6c69  h likely normali
-0001b570: 7a65 6420 6665 6174 7572 6520 7661 6c75  zed feature valu
-0001b580: 6573 2e0a 2020 2020 2020 2020 3a70 6172  es..        :par
-0001b590: 616d 6574 6572 204f 7074 696f 6e61 6c5b  ameter Optional[
-0001b5a0: 6e70 2e6e 6461 7272 6179 5d20 773a 204f  np.ndarray] w: O
-0001b5b0: 7074 696f 6e61 6c20 3264 2061 7272 6179  ptional 2d array
-0001b5c0: 2077 6974 6820 7765 6967 6874 7320 6f66   with weights of
-0001b5d0: 2073 616d 6520 7369 7a65 2061 7320 782e   same size as x.
-0001b5e0: 2044 6566 6175 6c74 204e 6f6e 6520 616e   Default None an
-0001b5f0: 6420 616c 6c20 6f62 7365 7276 6174 696f  d all observatio
-0001b600: 6e73 2077 696c 6c20 6861 7665 2074 6865  ns will have the
-0001b610: 2073 616d 6520 7765 6967 6874 2e0a 2020   same weight..  
-0001b620: 2020 2020 2020 3a72 6574 7572 6e73 206e        :returns n
-0001b630: 702e 6e64 6172 7261 793a 2032 6420 6172  p.ndarray: 2d ar
-0001b640: 7261 7920 7769 7468 2073 616d 6520 7369  ray with same si
-0001b650: 7a65 2061 7320 7820 7265 7072 6573 656e  ze as x represen
-0001b660: 7469 6e67 2064 6973 7369 6d69 6c61 7269  ting dissimilari
-0001b670: 7479 2076 616c 7565 732e 2030 2061 6e64  ty values. 0 and
-0001b680: 2074 6865 206f 6273 6572 7661 7469 6f6e   the observation
-0001b690: 7320 6172 6520 6964 656e 7469 6361 6c20  s are identical 
-0001b6a0: 616e 6420 6174 2031 2074 6865 206f 6273  and at 1 the obs
-0001b6b0: 6572 7661 7469 6f6e 7320 6172 6520 636f  ervations are co
-0001b6c0: 6d70 6c65 746c 7920 6469 7369 6d69 6c61  mpletly disimila
-0001b6d0: 722e 0a0a 2020 2020 2020 2020 3a65 7861  r...        :exa
-0001b6e0: 6d70 6c65 3a0a 2020 2020 2020 2020 3e3e  mple:.        >>
-0001b6f0: 3e20 7820 3d20 6e70 2e61 7272 6179 285b  > x = np.array([
-0001b700: 5b31 2c20 312c 2031 2c20 312c 2031 5d2c  [1, 1, 1, 1, 1],
-0001b710: 205b 302c 2030 2c20 302c 2030 2c20 305d   [0, 0, 0, 0, 0]
-0001b720: 2c20 5b30 2c20 302c 2030 2c20 302c 2030  , [0, 0, 0, 0, 0
-0001b730: 5d2c 205b 312c 2031 2c20 312c 2031 2c20  ], [1, 1, 1, 1, 
-0001b740: 315d 5d29 2e61 7374 7970 6528 6e70 2e66  1]]).astype(np.f
-0001b750: 6c6f 6174 3332 290a 2020 2020 2020 2020  loat32).        
-0001b760: 3e3e 3e20 5374 6174 6973 7469 6373 2829  >>> Statistics()
-0001b770: 2e62 7261 795f 6375 7274 6973 5f64 6973  .bray_curtis_dis
-0001b780: 7369 6d69 6c61 7269 7479 2878 3d78 290a  similarity(x=x).
-0001b790: 2020 2020 2020 2020 3e3e 3e20 5b5b 302c          >>> [[0,
-0001b7a0: 2031 2e2c 2031 2e2c 2030 2e5d 2c20 5b31   1., 1., 0.], [1
-0001b7b0: 2e2c 2030 2e2c 2030 2e2c 2031 2e5d 2c20  ., 0., 0., 1.], 
-0001b7c0: 5b31 2e2c 2030 2e2c 2030 2e2c 2031 2e5d  [1., 0., 0., 1.]
-0001b7d0: 2c20 5b30 2e2c 2031 2e2c 2031 2e2c 2030  , [0., 1., 1., 0
-0001b7e0: 2e5d 5d0a 2020 2020 2020 2020 2222 220a  .]].        """.
-0001b7f0: 2020 2020 2020 2020 6966 2077 2069 7320          if w is 
-0001b800: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0001b810: 2020 7720 3d20 6e70 2e6f 6e65 7328 2878    w = np.ones((x
-0001b820: 2e73 6861 7065 5b30 5d2c 2078 2e73 6861  .shape[0], x.sha
-0001b830: 7065 5b30 5d29 292e 6173 7479 7065 286e  pe[0])).astype(n
-0001b840: 702e 666c 6f61 7433 3229 0a20 2020 2020  p.float32).     
-0001b850: 2020 2072 6573 756c 7473 203d 206e 702e     results = np.
-0001b860: 6675 6c6c 2828 782e 7368 6170 655b 305d  full((x.shape[0]
-0001b870: 2c20 782e 7368 6170 655b 305d 292c 2030  , x.shape[0]), 0
-0001b880: 2e30 290a 2020 2020 2020 2020 666f 7220  .0).        for 
-0001b890: 6920 696e 2070 7261 6e67 6528 782e 7368  i in prange(x.sh
-0001b8a0: 6170 655b 305d 293a 0a20 2020 2020 2020  ape[0]):.       
-0001b8b0: 2020 2020 2066 6f72 206a 2069 6e20 7261       for j in ra
-0001b8c0: 6e67 6528 6920 2b20 312c 2078 2e73 6861  nge(i + 1, x.sha
-0001b8d0: 7065 5b30 5d29 3a0a 2020 2020 2020 2020  pe[0]):.        
-0001b8e0: 2020 2020 2020 2020 7331 2c20 7332 2c20          s1, s2, 
-0001b8f0: 6e75 6d2c 2064 656e 203d 2078 5b69 5d2c  num, den = x[i],
-0001b900: 2078 5b6a 5d2c 2030 2e30 2c20 302e 300a   x[j], 0.0, 0.0.
-0001b910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b920: 666f 7220 6b20 696e 2072 616e 6765 2873  for k in range(s
-0001b930: 312e 7368 6170 655b 305d 293a 0a20 2020  1.shape[0]):.   
-0001b940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b950: 206e 756d 202b 3d20 6e70 2e61 6273 2873   num += np.abs(s
-0001b960: 315b 6b5d 202d 2073 325b 6b5d 290a 2020  1[k] - s2[k]).  
-0001b970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b980: 2020 6465 6e20 2b3d 206e 702e 6162 7328    den += np.abs(
-0001b990: 7331 5b6b 5d20 2b20 7332 5b6b 5d29 0a20  s1[k] + s2[k]). 
-0001b9a0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0001b9b0: 6620 6465 6e20 3d3d 2030 2e30 3a0a 2020  f den == 0.0:.  
-0001b9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b9d0: 2020 7661 6c20 3d20 302e 300a 2020 2020    val = 0.0.    
-0001b9e0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0001b9f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001ba00: 2020 2020 2020 7661 6c20 3d20 2866 6c6f        val = (flo
-0001ba10: 6174 286e 756d 2920 2f20 6465 6e29 202a  at(num) / den) *
-0001ba20: 2077 5b69 2c20 6a5d 0a20 2020 2020 2020   w[i, j].       
-0001ba30: 2020 2020 2020 2020 2072 6573 756c 7473           results
-0001ba40: 5b69 2c20 6a5d 203d 2076 616c 0a20 2020  [i, j] = val.   
-0001ba50: 2020 2020 2020 2020 2020 2020 2072 6573               res
-0001ba60: 756c 7473 5b6a 2c20 695d 203d 2076 616c  ults[j, i] = val
-0001ba70: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001ba80: 7265 7375 6c74 732e 6173 7479 7065 2866  results.astype(f
-0001ba90: 6c6f 6174 3332 290a 0a20 2020 2040 7374  loat32)..    @st
-0001baa0: 6174 6963 6d65 7468 6f64 0a20 2020 2040  aticmethod.    @
-0001bab0: 6e6a 6974 2828 666c 6f61 7433 325b 3a5d  njit((float32[:]
-0001bac0: 2c20 666c 6f61 7433 325b 3a5d 2929 0a20  , float32[:])). 
-0001bad0: 2020 2064 6566 205f 6865 6c6c 696e 6765     def _hellinge
-0001bae0: 725f 6865 6c70 6572 2878 3a20 6e70 2e6e  r_helper(x: np.n
-0001baf0: 6461 7272 6179 2c20 793a 206e 702e 6e64  darray, y: np.nd
-0001bb00: 6172 7261 7929 3a0a 2020 2020 2020 2020  array):.        
-0001bb10: 2222 224a 6974 7465 6420 6865 6c70 6572  """Jitted helper
-0001bb20: 2066 6f72 2063 6f6d 7075 7469 6e67 2048   for computing H
-0001bb30: 656c 6c69 6e67 6572 2064 6973 7461 6e63  ellinger distanc
-0001bb40: 6573 2066 726f 6d20 6060 6865 6c6c 696e  es from ``hellin
-0001bb50: 6765 725f 6469 7374 616e 6365 6060 2222  ger_distance``""
-0001bb60: 220a 2020 2020 2020 2020 7265 7375 6c74  ".        result
-0001bb70: 2c20 6e6f 726d 5f78 2c20 6e6f 726d 5f79  , norm_x, norm_y
-0001bb80: 203d 2030 2e30 2c20 302e 302c 2030 2e30   = 0.0, 0.0, 0.0
-0001bb90: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
-0001bba0: 6e20 7261 6e67 6528 782e 7368 6170 655b  n range(x.shape[
-0001bbb0: 305d 293a 0a20 2020 2020 2020 2020 2020  0]):.           
-0001bbc0: 2072 6573 756c 7420 2b3d 206e 702e 7371   result += np.sq
-0001bbd0: 7274 2878 5b69 5d20 2a20 795b 695d 290a  rt(x[i] * y[i]).
-0001bbe0: 2020 2020 2020 2020 2020 2020 6e6f 726d              norm
-0001bbf0: 5f78 202b 3d20 785b 695d 0a20 2020 2020  _x += x[i].     
-0001bc00: 2020 2020 2020 206e 6f72 6d5f 7920 2b3d         norm_y +=
-0001bc10: 2079 5b69 5d0a 2020 2020 2020 2020 6966   y[i].        if
-0001bc20: 206e 6f72 6d5f 7820 3d3d 2030 2061 6e64   norm_x == 0 and
-0001bc30: 206e 6f72 6d5f 7920 3d3d 2030 3a0a 2020   norm_y == 0:.  
-0001bc40: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001bc50: 2030 2e30 0a20 2020 2020 2020 2065 6c69   0.0.        eli
-0001bc60: 6620 6e6f 726d 5f78 203d 3d20 3020 6f72  f norm_x == 0 or
-0001bc70: 206e 6f72 6d5f 7920 3d3d 2030 3a0a 2020   norm_y == 0:.  
-0001bc80: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001bc90: 2031 2e30 0a20 2020 2020 2020 2065 6c73   1.0.        els
-0001bca0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0001bcb0: 6574 7572 6e20 6e70 2e73 7172 7428 3120  eturn np.sqrt(1 
-0001bcc0: 2d20 7265 7375 6c74 202f 206e 702e 7371  - result / np.sq
-0001bcd0: 7274 286e 6f72 6d5f 7820 2a20 6e6f 726d  rt(norm_x * norm
-0001bce0: 5f79 2929 0a0a 2020 2020 6465 6620 6865  _y))..    def he
-0001bcf0: 6c6c 696e 6765 725f 6469 7374 616e 6365  llinger_distance
-0001bd00: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0001bd10: 2020 2020 2020 2020 783a 206e 702e 6e64          x: np.nd
-0001bd20: 6172 7261 792c 0a20 2020 2020 2020 2079  array,.        y
-0001bd30: 3a20 6e70 2e6e 6461 7272 6179 2c0a 2020  : np.ndarray,.  
-0001bd40: 2020 2020 2020 6275 636b 6574 5f6d 6574        bucket_met
-0001bd50: 686f 643a 204f 7074 696f 6e61 6c5b 0a20  hod: Optional[. 
-0001bd60: 2020 2020 2020 2020 2020 204c 6974 6572             Liter
-0001bd70: 616c 5b22 6664 222c 2022 646f 616e 6522  al["fd", "doane"
-0001bd80: 2c20 2261 7574 6f22 2c20 2273 636f 7474  , "auto", "scott
-0001bd90: 222c 2022 7374 6f6e 6522 2c20 2272 6963  ", "stone", "ric
-0001bda0: 6522 2c20 2273 7475 7267 6573 222c 2022  e", "sturges", "
-0001bdb0: 7371 7274 225d 0a20 2020 2020 2020 205d  sqrt"].        ]
-0001bdc0: 203d 2022 6175 746f 222c 0a20 2020 2029   = "auto",.    )
-0001bdd0: 202d 3e20 666c 6f61 743a 0a20 2020 2020   -> float:.     
-0001bde0: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
-0001bdf0: 6f6d 7075 7465 2074 6865 2048 656c 6c69  ompute the Helli
-0001be00: 6e67 6572 2064 6973 7461 6e63 6520 6265  nger distance be
-0001be10: 7477 6565 6e20 7477 6f20 7665 6374 6f72  tween two vector
-0001be20: 2064 6973 7472 6962 6974 696f 6e73 2e0a   distribitions..
-0001be30: 0a20 2020 2020 2020 202e 2e20 6e6f 7465  .        .. note
-0001be40: 3a3a 0a20 2020 2020 2020 2020 2020 5468  ::.           Th
-0001be50: 6520 4865 6c6c 696e 6765 7220 6469 7374  e Hellinger dist
-0001be60: 616e 6365 2069 7320 626f 756e 6465 6420  ance is bounded 
-0001be70: 616e 6420 7261 6e67 6573 2066 726f 6d20  and ranges from 
-0001be80: 3020 746f 20e2 889a 322e 2044 6973 7461  0 to ...2. Dista
-0001be90: 6e63 6520 6f66 20e2 889a 3220 696e 6469  nce of ...2 indi
-0001bea0: 6361 7465 7320 7468 6174 2074 6865 2074  cates that the t
-0001beb0: 776f 2064 6973 7472 6962 7574 696f 6e73  wo distributions
-0001bec0: 2061 7265 206d 6178 696d 616c 6c79 2064   are maximally d
-0001bed0: 6973 7369 6d69 6c61 720a 0a20 2020 2020  issimilar..     
-0001bee0: 2020 203a 7061 7261 6d20 6e70 2e6e 6461     :param np.nda
-0001bef0: 7272 6179 2078 3a20 4669 7273 7420 3144  rray x: First 1D
-0001bf00: 2061 7272 6179 2072 6570 7265 7365 6e74   array represent
-0001bf10: 696e 6720 6120 7072 6f62 6162 696c 6974  ing a probabilit
-0001bf20: 7920 6469 7374 7269 6275 7469 6f6e 2e0a  y distribution..
-0001bf30: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
-0001bf40: 702e 6e64 6172 7261 7920 793a 2053 6563  p.ndarray y: Sec
-0001bf50: 6f6e 6420 3144 2061 7272 6179 2072 6570  ond 1D array rep
-0001bf60: 7265 7365 6e74 696e 6720 6120 7072 6f62  resenting a prob
-0001bf70: 6162 696c 6974 7920 6469 7374 7269 6275  ability distribu
-0001bf80: 7469 6f6e 2e0a 2020 2020 2020 2020 3a70  tion..        :p
-0001bf90: 6172 616d 204f 7074 696f 6e61 6c5b 4c69  aram Optional[Li
-0001bfa0: 7465 7261 6c5b 2766 6427 2c20 2764 6f61  teral['fd', 'doa
-0001bfb0: 6e65 272c 2027 6175 746f 272c 2027 7363  ne', 'auto', 'sc
-0001bfc0: 6f74 7427 2c20 2773 746f 6e65 272c 2027  ott', 'stone', '
-0001bfd0: 7269 6365 272c 2027 7374 7572 6765 7327  rice', 'sturges'
-0001bfe0: 2c20 2773 7172 7427 5d5d 2062 7563 6b65  , 'sqrt']] bucke
-0001bff0: 745f 6d65 7468 6f64 3a20 4d65 7468 6f64  t_method: Method
-0001c000: 2066 6f72 2063 6f6d 7075 7469 6e67 2068   for computing h
-0001c010: 6973 746f 6772 616d 2062 696e 732e 2044  istogram bins. D
-0001c020: 6566 6175 6c74 2069 7320 2761 7574 6f27  efault is 'auto'
-0001c030: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-0001c040: 6e73 2066 6c6f 6174 3a20 4865 6c6c 696e  ns float: Hellin
-0001c050: 6765 7220 6469 7374 616e 6365 2062 6574  ger distance bet
-0001c060: 7765 656e 2074 6865 2074 776f 2069 6e70  ween the two inp
-0001c070: 7574 2070 726f 6261 6269 6c69 7479 2064  ut probability d
-0001c080: 6973 7472 6962 7574 696f 6e73 2e0a 0a20  istributions... 
-0001c090: 2020 2020 2020 203a 6578 616d 706c 653a         :example:
-0001c0a0: 0a20 2020 2020 2020 203e 3e3e 2078 203d  .        >>> x =
-0001c0b0: 206e 702e 7261 6e64 6f6d 2e72 616e 6469   np.random.randi
-0001c0c0: 6e74 2830 2c20 3930 3030 2c20 2835 3030  nt(0, 9000, (500
-0001c0d0: 3030 302c 2929 0a20 2020 2020 2020 203e  000,)).        >
-0001c0e0: 3e3e 2079 203d 206e 702e 7261 6e64 6f6d  >> y = np.random
-0001c0f0: 2e72 616e 6469 6e74 2830 2c20 3930 3030  .randint(0, 9000
-0001c100: 2c20 2835 3030 3030 302c 2929 0a20 2020  , (500000,)).   
-0001c110: 2020 2020 203e 3e3e 2053 7461 7469 7374       >>> Statist
-0001c120: 6963 7328 292e 6865 6c6c 696e 6765 725f  ics().hellinger_
-0001c130: 6469 7374 616e 6365 2878 3d78 2c20 793d  distance(x=x, y=
-0001c140: 792c 2062 7563 6b65 745f 6d65 7468 6f64  y, bucket_method
-0001c150: 3d27 6175 746f 2729 0a20 2020 2020 2020  ='auto').       
-0001c160: 2022 2222 0a0a 2020 2020 2020 2020 6368   """..        ch
-0001c170: 6563 6b5f 7661 6c69 645f 6172 7261 7928  eck_valid_array(
-0001c180: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-0001c190: 613d 782c 0a20 2020 2020 2020 2020 2020  a=x,.           
-0001c1a0: 2073 6f75 7263 653d 5374 6174 6973 7469   source=Statisti
-0001c1b0: 6373 2e68 656c 6c69 6e67 6572 5f64 6973  cs.hellinger_dis
-0001c1c0: 7461 6e63 652e 5f5f 6e61 6d65 5f5f 2c0a  tance.__name__,.
-0001c1d0: 2020 2020 2020 2020 2020 2020 6163 6365              acce
-0001c1e0: 7074 6564 5f6e 6469 6d73 3d28 312c 292c  pted_ndims=(1,),
-0001c1f0: 0a20 2020 2020 2020 2020 2020 2061 6363  .            acc
-0001c200: 6570 7465 645f 6474 7970 6573 3d28 0a20  epted_dtypes=(. 
-0001c210: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0001c220: 702e 696e 7436 342c 0a20 2020 2020 2020  p.int64,.       
-0001c230: 2020 2020 2020 2020 206e 702e 696e 7433           np.int3
-0001c240: 322c 0a20 2020 2020 2020 2020 2020 2020  2,.             
-0001c250: 2020 206e 702e 696e 7438 2c0a 2020 2020     np.int8,.    
-0001c260: 2020 2020 2020 2020 2020 2020 6e70 2e66              np.f
-0001c270: 6c6f 6174 3332 2c0a 2020 2020 2020 2020  loat32,.        
-0001c280: 2020 2020 2020 2020 6e70 2e66 6c6f 6174          np.float
-0001c290: 3634 2c0a 2020 2020 2020 2020 2020 2020  64,.            
-0001c2a0: 2020 2020 696e 742c 0a20 2020 2020 2020      int,.       
-0001c2b0: 2020 2020 2020 2020 2066 6c6f 6174 2c0a           float,.
-0001c2c0: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
-0001c2d0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001c2e0: 2063 6865 636b 5f76 616c 6964 5f61 7272   check_valid_arr
-0001c2f0: 6179 280a 2020 2020 2020 2020 2020 2020  ay(.            
-0001c300: 6461 7461 3d79 2c0a 2020 2020 2020 2020  data=y,.        
-0001c310: 2020 2020 736f 7572 6365 3d53 7461 7469      source=Stati
-0001c320: 7374 6963 732e 6865 6c6c 696e 6765 725f  stics.hellinger_
-0001c330: 6469 7374 616e 6365 2e5f 5f6e 616d 655f  distance.__name_
-0001c340: 5f2c 0a20 2020 2020 2020 2020 2020 2061  _,.            a
-0001c350: 6363 6570 7465 645f 6e64 696d 733d 2831  ccepted_ndims=(1
-0001c360: 2c29 2c0a 2020 2020 2020 2020 2020 2020  ,),.            
-0001c370: 6163 6365 7074 6564 5f64 7479 7065 733d  accepted_dtypes=
-0001c380: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0001c390: 2020 6e70 2e69 6e74 3634 2c0a 2020 2020    np.int64,.    
-0001c3a0: 2020 2020 2020 2020 2020 2020 6e70 2e69              np.i
-0001c3b0: 6e74 3332 2c0a 2020 2020 2020 2020 2020  nt32,.          
-0001c3c0: 2020 2020 2020 6e70 2e69 6e74 382c 0a20        np.int8,. 
-0001c3d0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0001c3e0: 702e 666c 6f61 7433 322c 0a20 2020 2020  p.float32,.     
-0001c3f0: 2020 2020 2020 2020 2020 206e 702e 666c             np.fl
-0001c400: 6f61 7436 342c 0a20 2020 2020 2020 2020  oat64,.         
-0001c410: 2020 2020 2020 2069 6e74 2c0a 2020 2020         int,.    
-0001c420: 2020 2020 2020 2020 2020 2020 666c 6f61              floa
-0001c430: 742c 0a20 2020 2020 2020 2020 2020 2029  t,.            )
-0001c440: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-0001c450: 2020 2020 6368 6563 6b5f 7374 7228 0a20      check_str(. 
-0001c460: 2020 2020 2020 2020 2020 206e 616d 653d             name=
-0001c470: 6622 7b53 7461 7469 7374 6963 732e 6865  f"{Statistics.he
-0001c480: 6c6c 696e 6765 725f 6469 7374 616e 6365  llinger_distance
-0001c490: 2e5f 5f6e 616d 655f 5f7d 206d 6574 686f  .__name__} metho
-0001c4a0: 6422 2c0a 2020 2020 2020 2020 2020 2020  d",.            
-0001c4b0: 7661 6c75 653d 6275 636b 6574 5f6d 6574  value=bucket_met
-0001c4c0: 686f 642c 0a20 2020 2020 2020 2020 2020  hod,.           
-0001c4d0: 206f 7074 696f 6e73 3d4f 7074 696f 6e73   options=Options
-0001c4e0: 2e42 5543 4b45 545f 4d45 5448 4f44 532e  .BUCKET_METHODS.
-0001c4f0: 7661 6c75 652c 0a20 2020 2020 2020 2029  value,.        )
-0001c500: 0a20 2020 2020 2020 2062 696e 5f77 6964  .        bin_wid
-0001c510: 7468 2c20 6269 6e5f 636f 756e 7420 3d20  th, bin_count = 
-0001c520: 6275 636b 6574 5f64 6174 6128 6461 7461  bucket_data(data
-0001c530: 3d78 2c20 6d65 7468 6f64 3d62 7563 6b65  =x, method=bucke
-0001c540: 745f 6d65 7468 6f64 290a 2020 2020 2020  t_method).      
-0001c550: 2020 7331 5f68 203d 2073 656c 662e 5f68    s1_h = self._h
-0001c560: 6973 745f 3164 280a 2020 2020 2020 2020  ist_1d(.        
-0001c570: 2020 2020 6461 7461 3d78 2c20 6269 6e5f      data=x, bin_
-0001c580: 636f 756e 743d 6269 6e5f 636f 756e 742c  count=bin_count,
-0001c590: 2072 616e 6765 3d6e 702e 6172 7261 7928   range=np.array(
-0001c5a0: 5b30 2c20 696e 7428 6269 6e5f 7769 6474  [0, int(bin_widt
-0001c5b0: 6820 2a20 6269 6e5f 636f 756e 7429 5d29  h * bin_count)])
-0001c5c0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-0001c5d0: 2020 2073 325f 6820 3d20 7365 6c66 2e5f     s2_h = self._
-0001c5e0: 6869 7374 5f31 6428 0a20 2020 2020 2020  hist_1d(.       
-0001c5f0: 2020 2020 2064 6174 613d 792c 2062 696e       data=y, bin
-0001c600: 5f63 6f75 6e74 3d62 696e 5f63 6f75 6e74  _count=bin_count
-0001c610: 2c20 7261 6e67 653d 6e70 2e61 7272 6179  , range=np.array
-0001c620: 285b 302c 2069 6e74 2862 696e 5f77 6964  ([0, int(bin_wid
-0001c630: 7468 202a 2062 696e 5f63 6f75 6e74 295d  th * bin_count)]
-0001c640: 290a 2020 2020 2020 2020 290a 2020 2020  ).        ).    
-0001c650: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0001c660: 5f68 656c 6c69 6e67 6572 5f68 656c 7065  _hellinger_helpe
-0001c670: 7228 0a20 2020 2020 2020 2020 2020 2078  r(.            x
-0001c680: 3d73 315f 682e 6173 7479 7065 286e 702e  =s1_h.astype(np.
-0001c690: 666c 6f61 7433 3229 2c20 793d 7332 5f68  float32), y=s2_h
-0001c6a0: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
-0001c6b0: 3332 290a 2020 2020 2020 2020 290a 0a20  32).        ).. 
-0001c6c0: 2020 2040 7374 6174 6963 6d65 7468 6f64     @staticmethod
-0001c6d0: 0a20 2020 2040 6e6a 6974 2822 2869 6e74  .    @njit("(int
-0001c6e0: 3634 5b3a 5d2c 696e 7436 345b 3a5d 2922  64[:],int64[:])"
-0001c6f0: 290a 2020 2020 6465 6620 636f 6865 6e73  ).    def cohens
-0001c700: 5f6b 6170 7061 2873 616d 706c 655f 313a  _kappa(sample_1:
-0001c710: 206e 702e 6e64 6172 7261 792c 2073 616d   np.ndarray, sam
-0001c720: 706c 655f 323a 206e 702e 6e64 6172 7261  ple_2: np.ndarra
-0001c730: 7929 3a0a 2020 2020 2020 2020 2222 220a  y):.        """.
-0001c740: 2020 2020 2020 2020 4a69 7474 6564 2063          Jitted c
-0001c750: 6f6d 7075 7465 2043 6f68 656e 2773 204b  ompute Cohen's K
-0001c760: 6170 7061 2063 6f65 6666 6963 6965 6e74  appa coefficient
-0001c770: 2066 6f72 2074 776f 2062 696e 6172 7920   for two binary 
-0001c780: 7361 6d70 6c65 732e 0a0a 2020 2020 2020  samples...      
-0001c790: 2020 436f 6865 6e27 7320 4b61 7070 6120    Cohen's Kappa 
-0001c7a0: 636f 6566 6669 6369 656e 7420 6265 7477  coefficient betw
-0001c7b0: 6565 6e20 636c 6173 7369 6669 6361 7469  een classificati
-0001c7c0: 6f6e 7320 616e 6420 6772 6f75 6e64 2074  ons and ground t
-0001c7d0: 7275 7468 2074 616b 696e 6720 696e 746f  ruth taking into
-0001c7e0: 2061 6363 6f75 6e74 2061 6772 6565 6d65   account agreeme
-0001c7f0: 6e74 2062 6574 7765 656e 2063 6c61 7373  nt between class
-0001c800: 6966 6963 6174 696f 6e73 2061 6e64 2067  ifications and g
-0001c810: 726f 756e 6420 7472 7574 6820 6f63 6375  round truth occu
-0001c820: 7272 696e 6720 6279 2063 6861 6e63 652e  rring by chance.
-0001c830: 0a20 2020 2020 2020 2049 6e74 6572 7072  .        Interpr
-0001c840: 6574 6174 696f 6e3a 203e 302e 3809 416c  etation: >0.8.Al
-0001c850: 6d6f 7374 2050 6572 6665 6374 2c20 3e30  most Perfect, >0
-0001c860: 2e36 0953 7562 7374 616e 7469 616c 2c20  .6.Substantial, 
-0001c870: 203e 302e 3409 4d6f 6465 7261 7465 203e   >0.4.Moderate >
-0001c880: 302e 3209 4661 6972 2c20 302d 302c 3209  0.2.Fair, 0-0,2.
-0001c890: 536c 6967 6874 2c20 3c30 0950 6f6f 7220  Slight, <0.Poor 
-0001c8a0: 2820 4c61 6e64 6973 2026 204b 6f63 6820  ( Landis & Koch 
-0001c8b0: 2831 3937 3729 292e 0a0a 2020 2020 2020  (1977))...      
-0001c8c0: 2020 3a65 7861 6d70 6c65 3a0a 2020 2020    :example:.    
-0001c8d0: 2020 2020 3e3e 3e20 7361 6d70 6c65 5f31      >>> sample_1
-0001c8e0: 203d 206e 702e 7261 6e64 6f6d 2e72 616e   = np.random.ran
-0001c8f0: 6469 6e74 2830 2c20 322c 2073 697a 653d  dint(0, 2, size=
-0001c900: 2831 3030 3030 2c29 290a 2020 2020 2020  (10000,)).      
-0001c910: 2020 3e3e 3e20 7361 6d70 6c65 5f32 203d    >>> sample_2 =
-0001c920: 206e 702e 7261 6e64 6f6d 2e72 616e 6469   np.random.randi
-0001c930: 6e74 2830 2c20 322c 2073 697a 653d 2831  nt(0, 2, size=(1
-0001c940: 3030 3030 2c29 290a 2020 2020 2020 2020  0000,)).        
-0001c950: 3e3e 3e20 5374 6174 6973 7469 6373 2e63  >>> Statistics.c
-0001c960: 6f68 656e 735f 6b61 7070 6128 7361 6d70  ohens_kappa(samp
-0001c970: 6c65 5f31 3d73 616d 706c 655f 312c 2073  le_1=sample_1, s
-0001c980: 616d 706c 655f 323d 7361 6d70 6c65 5f32  ample_2=sample_2
-0001c990: 2929 0a20 2020 2020 2020 2022 2222 0a20  )).        """. 
-0001c9a0: 2020 2020 2020 2073 616d 706c 655f 3120         sample_1 
-0001c9b0: 3d20 6e70 2e61 7363 6f6e 7469 6775 6f75  = np.ascontiguou
-0001c9c0: 7361 7272 6179 2873 616d 706c 655f 3129  sarray(sample_1)
-0001c9d0: 0a20 2020 2020 2020 2073 616d 706c 655f  .        sample_
-0001c9e0: 3220 3d20 6e70 2e61 7363 6f6e 7469 6775  2 = np.ascontigu
-0001c9f0: 6f75 7361 7272 6179 2873 616d 706c 655f  ousarray(sample_
-0001ca00: 3229 0a20 2020 2020 2020 2064 6174 6120  2).        data 
-0001ca10: 3d20 6e70 2e68 7374 6163 6b28 2873 616d  = np.hstack((sam
-0001ca20: 706c 655f 312e 7265 7368 6170 6528 2d31  ple_1.reshape(-1
-0001ca30: 2c20 3129 2c20 7361 6d70 6c65 5f32 2e72  , 1), sample_2.r
-0001ca40: 6573 6861 7065 282d 312c 2031 2929 290a  eshape(-1, 1))).
-0001ca50: 2020 2020 2020 2020 7470 203d 206c 656e          tp = len
-0001ca60: 286e 702e 6172 6777 6865 7265 2828 6461  (np.argwhere((da
-0001ca70: 7461 5b3a 2c20 305d 203d 3d20 3129 2026  ta[:, 0] == 1) &
-0001ca80: 2028 6461 7461 5b3a 2c20 315d 203d 3d20   (data[:, 1] == 
-0001ca90: 3129 292e 666c 6174 7465 6e28 2929 0a20  1)).flatten()). 
-0001caa0: 2020 2020 2020 2074 6e20 3d20 6c65 6e28         tn = len(
-0001cab0: 6e70 2e61 7267 7768 6572 6528 2864 6174  np.argwhere((dat
-0001cac0: 615b 3a2c 2030 5d20 3d3d 2030 2920 2620  a[:, 0] == 0) & 
-0001cad0: 2864 6174 615b 3a2c 2031 5d20 3d3d 2030  (data[:, 1] == 0
-0001cae0: 2929 2e66 6c61 7474 656e 2829 290a 2020  )).flatten()).  
-0001caf0: 2020 2020 2020 6670 203d 206c 656e 286e        fp = len(n
-0001cb00: 702e 6172 6777 6865 7265 2828 6461 7461  p.argwhere((data
-0001cb10: 5b3a 2c20 305d 203d 3d20 3129 2026 2028  [:, 0] == 1) & (
-0001cb20: 6461 7461 5b3a 2c20 315d 203d 3d20 3029  data[:, 1] == 0)
-0001cb30: 292e 666c 6174 7465 6e28 2929 0a20 2020  ).flatten()).   
-0001cb40: 2020 2020 2066 6e20 3d20 6c65 6e28 6e70       fn = len(np
-0001cb50: 2e61 7267 7768 6572 6528 2864 6174 615b  .argwhere((data[
-0001cb60: 3a2c 2030 5d20 3d3d 2030 2920 2620 2864  :, 0] == 0) & (d
-0001cb70: 6174 615b 3a2c 2031 5d20 3d3d 2031 2929  ata[:, 1] == 1))
-0001cb80: 2e66 6c61 7474 656e 2829 290a 2020 2020  .flatten()).    
-0001cb90: 2020 2020 6461 7461 203d 206e 702e 6172      data = np.ar
-0001cba0: 7261 7928 285b 7470 2c20 6670 5d2c 205b  ray(([tp, fp], [
-0001cbb0: 666e 2c20 746e 5d29 290a 2020 2020 2020  fn, tn])).      
-0001cbc0: 2020 7375 6d30 203d 2064 6174 612e 7375    sum0 = data.su
-0001cbd0: 6d28 6178 6973 3d30 290a 2020 2020 2020  m(axis=0).      
-0001cbe0: 2020 7375 6d31 203d 2064 6174 612e 7375    sum1 = data.su
-0001cbf0: 6d28 6178 6973 3d31 290a 2020 2020 2020  m(axis=1).      
-0001cc00: 2020 6578 7065 6374 6564 203d 206e 702e    expected = np.
-0001cc10: 6f75 7465 7228 7375 6d30 2c20 7375 6d31  outer(sum0, sum1
-0001cc20: 2920 2f20 6e70 2e73 756d 2873 756d 3029  ) / np.sum(sum0)
-0001cc30: 0a20 2020 2020 2020 2077 5f6d 6174 203d  .        w_mat =
-0001cc40: 206e 702e 6675 6c6c 2873 6861 7065 3d28   np.full(shape=(
-0001cc50: 322c 2032 292c 2066 696c 6c5f 7661 6c75  2, 2), fill_valu
-0001cc60: 653d 3129 0a20 2020 2020 2020 2077 5f6d  e=1).        w_m
-0001cc70: 6174 5b30 2c20 305d 203d 2030 0a20 2020  at[0, 0] = 0.   
-0001cc80: 2020 2020 2077 5f6d 6174 5b31 2c20 315d       w_mat[1, 1]
-0001cc90: 203d 2030 0a20 2020 2020 2020 2072 6574   = 0.        ret
-0001cca0: 7572 6e20 3120 2d20 6e70 2e73 756d 2877  urn 1 - np.sum(w
-0001ccb0: 5f6d 6174 202a 2064 6174 6129 202f 206e  _mat * data) / n
-0001ccc0: 702e 7375 6d28 775f 6d61 7420 2a20 6578  p.sum(w_mat * ex
-0001ccd0: 7065 6374 6564 290a 0a20 2020 2040 7374  pected)..    @st
-0001cce0: 6174 6963 6d65 7468 6f64 0a20 2020 2064  aticmethod.    d
-0001ccf0: 6566 2064 5f70 7269 6d65 280a 2020 2020  ef d_prime(.    
-0001cd00: 2020 2020 783a 206e 702e 6e64 6172 7261      x: np.ndarra
-0001cd10: 792c 0a20 2020 2020 2020 2079 3a20 6e70  y,.        y: np
-0001cd20: 2e6e 6461 7272 6179 2c0a 2020 2020 2020  .ndarray,.      
-0001cd30: 2020 6c6f 7765 725f 6c69 6d69 743a 204f    lower_limit: O
-0001cd40: 7074 696f 6e61 6c5b 666c 6f61 745d 203d  ptional[float] =
-0001cd50: 2030 2e30 3030 312c 0a20 2020 2020 2020   0.0001,.       
-0001cd60: 2075 7070 6572 5f6c 696d 6974 3a20 4f70   upper_limit: Op
-0001cd70: 7469 6f6e 616c 5b66 6c6f 6174 5d20 3d20  tional[float] = 
-0001cd80: 302e 3939 3939 2c0a 2020 2020 2920 2d3e  0.9999,.    ) ->
-0001cd90: 2066 6c6f 6174 3a0a 2020 2020 2020 2020   float:.        
-0001cda0: 2222 220a 2020 2020 2020 2020 436f 6d70  """.        Comp
-0001cdb0: 7574 6573 2064 2d70 7269 6d65 2066 726f  utes d-prime fro
-0001cdc0: 6d20 7477 6f20 426f 6f6c 6561 6e20 3164  m two Boolean 1d
-0001cdd0: 2061 7272 6179 732c 2065 2e67 2e2c 2062   arrays, e.g., b
-0001cde0: 6574 7765 656e 2063 6c61 7373 6966 6963  etween classific
-0001cdf0: 6174 696f 6e73 2061 6e64 2067 726f 756e  ations and groun
-0001ce00: 6420 7472 7574 682e 0a0a 2020 2020 2020  d truth...      
-0001ce10: 2020 3a70 6172 616d 206e 702e 6e64 6172    :param np.ndar
-0001ce20: 7261 7920 783a 2042 6f6f 6c65 616e 2031  ray x: Boolean 1
-0001ce30: 4420 6172 7261 7920 6f66 2072 6573 706f  D array of respo
-0001ce40: 6e73 6520 7661 6c75 6573 2c20 7768 6572  nse values, wher
-0001ce50: 6520 3120 7265 7072 6573 656e 7473 2070  e 1 represents p
-0001ce60: 7265 7365 6e63 652c 2061 6e64 2030 2072  resence, and 0 r
-0001ce70: 6570 7265 7365 6e74 696e 6720 6162 7365  epresenting abse
-0001ce80: 6e63 652e 0a20 2020 2020 2020 203a 7061  nce..        :pa
-0001ce90: 7261 6d20 6e70 2e6e 6461 7272 6179 2079  ram np.ndarray y
-0001cea0: 3a20 426f 6f6c 6561 6e20 3144 2061 7272  : Boolean 1D arr
-0001ceb0: 6179 206f 6620 6772 6f75 6e64 2074 7275  ay of ground tru
-0001cec0: 7468 2c20 7768 6572 6520 3120 7265 7072  th, where 1 repr
-0001ced0: 6573 656e 7473 2070 7265 7365 6e63 652c  esents presence,
-0001cee0: 2061 6e64 2030 2072 6570 7265 7365 6e74   and 0 represent
-0001cef0: 696e 6720 6162 7365 6e63 652e 0a20 2020  ing absence..   
-0001cf00: 2020 2020 203a 7061 7261 6d20 4f70 7469       :param Opti
-0001cf10: 6f6e 616c 5b66 6c6f 6174 5d20 6c6f 7765  onal[float] lowe
-0001cf20: 725f 6c69 6d69 743a 204c 6f77 6572 206c  r_limit: Lower l
-0001cf30: 696d 6974 2074 6f20 626f 756e 6420 6869  imit to bound hi
-0001cf40: 7420 616e 6420 6661 6c73 6520 616c 6172  t and false alar
-0001cf50: 6d20 7261 7465 732e 2044 6566 6175 6c74  m rates. Default
-0001cf60: 7320 746f 2030 2e30 3030 312e 0a20 2020  s to 0.0001..   
-0001cf70: 2020 2020 203a 7061 7261 6d20 4f70 7469       :param Opti
-0001cf80: 6f6e 616c 5b66 6c6f 6174 5d20 7570 7065  onal[float] uppe
-0001cf90: 725f 6c69 6d69 743a 2055 7070 6572 206c  r_limit: Upper l
-0001cfa0: 696d 6974 2074 6f20 626f 756e 6420 6869  imit to bound hi
-0001cfb0: 7420 616e 6420 6661 6c73 6520 616c 6172  t and false alar
-0001cfc0: 6d20 7261 7465 732e 2044 6566 6175 6c74  m rates. Default
-0001cfd0: 7320 746f 2030 2e39 3939 392e 0a20 2020  s to 0.9999..   
-0001cfe0: 2020 2020 203a 7265 7475 726e 2066 6c6f       :return flo
-0001cff0: 6174 3a20 5468 6520 6361 6c63 756c 6174  at: The calculat
-0001d000: 6564 2064 2720 2864 2d70 7269 6d65 2920  ed d' (d-prime) 
-0001d010: 7661 6c75 652e 0a0a 2020 2020 2020 2020  value...        
-0001d020: 3a65 7861 6d70 6c65 3a0a 2020 2020 2020  :example:.      
-0001d030: 2020 3e3e 3e20 7820 3d20 6e70 2e72 616e    >>> x = np.ran
-0001d040: 646f 6d2e 7261 6e64 696e 7428 302c 2032  dom.randint(0, 2
-0001d050: 2c20 2831 3030 302c 2929 0a20 2020 2020  , (1000,)).     
-0001d060: 2020 203e 3e3e 2079 203d 206e 702e 7261     >>> y = np.ra
-0001d070: 6e64 6f6d 2e72 616e 6469 6e74 2830 2c20  ndom.randint(0, 
-0001d080: 322c 2028 3130 3030 2c29 290a 2020 2020  2, (1000,)).    
-0001d090: 2020 2020 3e3e 3e20 5374 6174 6973 7469      >>> Statisti
-0001d0a0: 6373 2e64 5f70 7269 6d65 2878 3d78 2c20  cs.d_prime(x=x, 
-0001d0b0: 793d 7929 0a20 2020 2020 2020 2022 2222  y=y).        """
-0001d0c0: 0a0a 2020 2020 2020 2020 6368 6563 6b5f  ..        check_
-0001d0d0: 7661 6c69 645f 6172 7261 7928 0a20 2020  valid_array(.   
-0001d0e0: 2020 2020 2020 2020 2064 6174 613d 782c           data=x,
-0001d0f0: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
-0001d100: 7263 653d 5374 6174 6973 7469 6373 2e64  rce=Statistics.d
-0001d110: 5f70 7269 6d65 2e5f 5f6e 616d 655f 5f2c  _prime.__name__,
-0001d120: 0a20 2020 2020 2020 2020 2020 2061 6363  .            acc
-0001d130: 6570 7465 645f 6e64 696d 733d 2831 2c29  epted_ndims=(1,)
-0001d140: 2c0a 2020 2020 2020 2020 2020 2020 6163  ,.            ac
-0001d150: 6365 7074 6564 5f64 7479 7065 733d 286e  cepted_dtypes=(n
-0001d160: 702e 696e 7436 342c 206e 702e 696e 7433  p.int64, np.int3
-0001d170: 322c 206e 702e 696e 7438 292c 0a20 2020  2, np.int8),.   
-0001d180: 2020 2020 2029 0a20 2020 2020 2020 2063       ).        c
-0001d190: 6865 636b 5f76 616c 6964 5f61 7272 6179  heck_valid_array
-0001d1a0: 280a 2020 2020 2020 2020 2020 2020 6461  (.            da
-0001d1b0: 7461 3d79 2c0a 2020 2020 2020 2020 2020  ta=y,.          
-0001d1c0: 2020 736f 7572 6365 3d53 7461 7469 7374    source=Statist
-0001d1d0: 6963 732e 645f 7072 696d 652e 5f5f 6e61  ics.d_prime.__na
-0001d1e0: 6d65 5f5f 2c0a 2020 2020 2020 2020 2020  me__,.          
-0001d1f0: 2020 6163 6365 7074 6564 5f6e 6469 6d73    accepted_ndims
-0001d200: 3d28 312c 292c 0a20 2020 2020 2020 2020  =(1,),.         
-0001d210: 2020 2061 6363 6570 7465 645f 6474 7970     accepted_dtyp
-0001d220: 6573 3d28 6e70 2e69 6e74 3634 2c20 6e70  es=(np.int64, np
-0001d230: 2e69 6e74 3332 2c20 6e70 2e69 6e74 3829  .int32, np.int8)
-0001d240: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-0001d250: 2020 2020 6966 206c 656e 286c 6973 7428      if len(list(
-0001d260: 7b78 2e73 6861 7065 5b30 5d2c 2079 2e73  {x.shape[0], y.s
-0001d270: 6861 7065 5b30 5d7d 2929 2021 3d20 313a  hape[0]})) != 1:
-0001d280: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0001d290: 7365 2043 6f75 6e74 4572 726f 7228 0a20  se CountError(. 
-0001d2a0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0001d2b0: 7367 3d66 2254 6865 2074 776f 2061 7272  sg=f"The two arr
-0001d2c0: 6179 7320 6861 7320 746f 2062 6520 6571  ays has to be eq
-0001d2d0: 7561 6c20 6c65 6e67 7468 7320 6275 7420  ual lengths but 
-0001d2e0: 676f 743a 207b 782e 7368 6170 655b 305d  got: {x.shape[0]
-0001d2f0: 2c20 792e 7368 6170 655b 305d 7d22 2c0a  , y.shape[0]}",.
-0001d300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d310: 736f 7572 6365 3d53 7461 7469 7374 6963  source=Statistic
-0001d320: 732e 645f 7072 696d 652e 5f5f 6e61 6d65  s.d_prime.__name
-0001d330: 5f5f 2c0a 2020 2020 2020 2020 2020 2020  __,.            
-0001d340: 290a 2020 2020 2020 2020 666f 7220 6920  ).        for i 
-0001d350: 696e 205b 782c 2079 5d3a 0a20 2020 2020  in [x, y]:.     
-0001d360: 2020 2020 2020 2061 6464 6974 696f 6e61         additiona
-0001d370: 6c20 3d20 6c69 7374 2873 6574 286c 6973  l = list(set(lis
-0001d380: 7428 6e70 2e73 6f72 7428 6e70 2e75 6e69  t(np.sort(np.uni
-0001d390: 7175 6528 6929 2929 2920 2d20 7b30 2c20  que(i)))) - {0, 
-0001d3a0: 317d 290a 2020 2020 2020 2020 2020 2020  1}).            
-0001d3b0: 6966 206c 656e 2861 6464 6974 696f 6e61  if len(additiona
-0001d3c0: 6c29 203e 2030 3a0a 2020 2020 2020 2020  l) > 0:.        
-0001d3d0: 2020 2020 2020 2020 7261 6973 6520 496e          raise In
-0001d3e0: 7661 6c69 6449 6e70 7574 4572 726f 7228  validInputError(
-0001d3f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d400: 2020 2020 206d 7367 3d66 2244 2d70 7269       msg=f"D-pri
-0001d410: 6d65 2072 6571 7569 7265 7320 6269 6e61  me requires bina
-0001d420: 7279 2069 6e70 7574 2064 6174 6120 6275  ry input data bu
-0001d430: 7420 666f 756e 6420 7b61 6464 6974 696f  t found {additio
-0001d440: 6e61 6c7d 222c 0a20 2020 2020 2020 2020  nal}",.         
-0001d450: 2020 2020 2020 2020 2020 2073 6f75 7263             sourc
-0001d460: 653d 5374 6174 6973 7469 6373 2e64 5f70  e=Statistics.d_p
-0001d470: 7269 6d65 2829 2e5f 5f6e 616d 655f 5f2c  rime().__name__,
-0001d480: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d490: 2029 0a20 2020 2020 2020 2074 6172 6765   ).        targe
-0001d4a0: 745f 6964 7820 3d20 6e70 2e61 7267 7768  t_idx = np.argwh
-0001d4b0: 6572 6528 7920 3d3d 2031 292e 666c 6174  ere(y == 1).flat
-0001d4c0: 7465 6e28 290a 2020 2020 2020 2020 6869  ten().        hi
-0001d4d0: 745f 7261 7465 203d 206e 702e 7375 6d28  t_rate = np.sum(
-0001d4e0: 785b 6e70 2e61 7267 7768 6572 6528 7920  x[np.argwhere(y 
-0001d4f0: 3d3d 2031 295d 2920 2f20 7461 7267 6574  == 1)]) / target
-0001d500: 5f69 6478 2e73 6861 7065 5b30 5d0a 2020  _idx.shape[0].  
-0001d510: 2020 2020 2020 6661 6c73 655f 616c 6172        false_alar
-0001d520: 6d5f 7261 7465 203d 206e 702e 7375 6d28  m_rate = np.sum(
-0001d530: 785b 6e70 2e61 7267 7768 6572 6528 7920  x[np.argwhere(y 
-0001d540: 3d3d 2030 295d 2920 2f20 7461 7267 6574  == 0)]) / target
-0001d550: 5f69 6478 2e73 6861 7065 5b30 5d0a 2020  _idx.shape[0].  
-0001d560: 2020 2020 2020 6966 2068 6974 5f72 6174        if hit_rat
-0001d570: 6520 3c20 6c6f 7765 725f 6c69 6d69 743a  e < lower_limit:
-0001d580: 0a20 2020 2020 2020 2020 2020 2068 6974  .            hit
-0001d590: 5f72 6174 6520 3d20 6c6f 7765 725f 6c69  _rate = lower_li
-0001d5a0: 6d69 740a 2020 2020 2020 2020 656c 6966  mit.        elif
-0001d5b0: 2068 6974 5f72 6174 6520 3e20 7570 7065   hit_rate > uppe
-0001d5c0: 725f 6c69 6d69 743a 0a20 2020 2020 2020  r_limit:.       
-0001d5d0: 2020 2020 2068 6974 5f72 6174 6520 3d20       hit_rate = 
-0001d5e0: 7570 7065 725f 6c69 6d69 740a 2020 2020  upper_limit.    
-0001d5f0: 2020 2020 6966 2066 616c 7365 5f61 6c61      if false_ala
-0001d600: 726d 5f72 6174 6520 3c20 6c6f 7765 725f  rm_rate < lower_
-0001d610: 6c69 6d69 743a 0a20 2020 2020 2020 2020  limit:.         
-0001d620: 2020 2066 616c 7365 5f61 6c61 726d 5f72     false_alarm_r
-0001d630: 6174 6520 3d20 6c6f 7765 725f 6c69 6d69  ate = lower_limi
-0001d640: 740a 2020 2020 2020 2020 656c 6966 2066  t.        elif f
-0001d650: 616c 7365 5f61 6c61 726d 5f72 6174 6520  alse_alarm_rate 
-0001d660: 3e20 7570 7065 725f 6c69 6d69 743a 0a20  > upper_limit:. 
-0001d670: 2020 2020 2020 2020 2020 2066 616c 7365             false
-0001d680: 5f61 6c61 726d 5f72 6174 6520 3d20 7570  _alarm_rate = up
-0001d690: 7065 725f 6c69 6d69 740a 2020 2020 2020  per_limit.      
-0001d6a0: 2020 7265 7475 726e 2073 7461 7473 2e6e    return stats.n
-0001d6b0: 6f72 6d2e 7070 6628 6869 745f 7261 7465  orm.ppf(hit_rate
-0001d6c0: 2920 2d20 7374 6174 732e 6e6f 726d 2e70  ) - stats.norm.p
-0001d6d0: 7066 2866 616c 7365 5f61 6c61 726d 5f72  pf(false_alarm_r
-0001d6e0: 6174 6529 0a0a 2020 2020 4073 7461 7469  ate)..    @stati
-0001d6f0: 636d 6574 686f 640a 2020 2020 6465 6620  cmethod.    def 
-0001d700: 6d63 6e65 6d61 7228 0a20 2020 2020 2020  mcnemar(.       
-0001d710: 2078 3a20 6e70 2e6e 6461 7272 6179 2c0a   x: np.ndarray,.
-0001d720: 2020 2020 2020 2020 793a 206e 702e 6e64          y: np.nd
-0001d730: 6172 7261 792c 0a20 2020 2020 2020 2067  array,.        g
-0001d740: 726f 756e 645f 7472 7574 683a 206e 702e  round_truth: np.
-0001d750: 6e64 6172 7261 792c 0a20 2020 2020 2020  ndarray,.       
-0001d760: 2063 6f6e 7469 6e75 6974 795f 636f 7272   continuity_corr
-0001d770: 6563 7465 643a 204f 7074 696f 6e61 6c5b  ected: Optional[
-0001d780: 626f 6f6c 5d20 3d20 5472 7565 2c0a 2020  bool] = True,.  
-0001d790: 2020 2920 2d3e 2054 7570 6c65 5b66 6c6f    ) -> Tuple[flo
-0001d7a0: 6174 2c20 666c 6f61 745d 3a0a 2020 2020  at, float]:.    
-0001d7b0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001d7c0: 4d63 4e65 6d61 7227 7320 7465 7374 2074  McNemar's test t
-0001d7d0: 6f20 636f 6d70 6172 6520 7468 6520 6469  o compare the di
-0001d7e0: 6666 6572 656e 6365 2069 6e20 7072 6564  fference in pred
-0001d7f0: 6963 7469 7665 2061 6363 7572 6163 7920  ictive accuracy 
-0001d800: 6f66 2074 776f 206d 6f64 656c 732e 0a0a  of two models...
-0001d810: 2020 2020 2020 2020 452e 672e 2c20 6361          E.g., ca
-0001d820: 6e20 6265 2075 7365 6420 746f 2063 6f6d  n be used to com
-0001d830: 7075 7465 2069 6620 7468 6520 6163 6375  pute if the accu
-0001d840: 7261 6379 206f 6620 7477 6f20 636c 6173  racy of two clas
-0001d850: 7369 6669 6572 7320 6172 6520 7369 676e  sifiers are sign
-0001d860: 6966 6963 616e 746c 7920 6469 6666 6572  ificantly differ
-0001d870: 656e 7420 7768 656e 2074 7261 6e73 666f  ent when transfo
-0001d880: 726d 696e 6720 7468 6520 7361 6d65 2064  rming the same d
-0001d890: 6174 612e 0a0a 2020 2020 2020 2020 2e2e  ata...        ..
-0001d8a0: 206e 6f74 653a 3a0a 2020 2020 2020 2020   note::.        
-0001d8b0: 2020 2060 6d6c 6578 7465 6e64 203c 6874     `mlextend <ht
-0001d8c0: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
-0001d8d0: 2f72 6173 6274 2f6d 6c78 7465 6e64 2f62  /rasbt/mlxtend/b
-0001d8e0: 6c6f 622f 6d61 7374 6572 2f6d 6c78 7465  lob/master/mlxte
-0001d8f0: 6e64 2f65 7661 6c75 6174 652f 6d63 6e65  nd/evaluate/mcne
-0001d900: 6d61 722e 7079 3e60 5f5f 2e0a 0a20 2020  mar.py>`__...   
-0001d910: 2020 2020 203a 7061 7261 6d20 6e70 2e6e       :param np.n
-0001d920: 6461 7272 6179 2078 3a20 312d 6469 6d65  darray x: 1-dime
-0001d930: 6e73 696f 6e61 6c20 426f 6f6c 6561 6e20  nsional Boolean 
-0001d940: 6172 7261 7920 7769 7468 2070 7265 6469  array with predi
-0001d950: 6374 696f 6e73 206f 6620 7468 6520 6669  ctions of the fi
-0001d960: 7273 7420 6d6f 6465 6c2e 0a20 2020 2020  rst model..     
-0001d970: 2020 203a 7061 7261 6d20 6e70 2e6e 6461     :param np.nda
-0001d980: 7272 6179 2078 3a20 312d 6469 6d65 6e73  rray x: 1-dimens
-0001d990: 696f 6e61 6c20 426f 6f6c 6561 6e20 6172  ional Boolean ar
-0001d9a0: 7261 7920 7769 7468 2070 7265 6469 6374  ray with predict
-0001d9b0: 696f 6e73 206f 6620 7468 6520 7365 636f  ions of the seco
-0001d9c0: 6e64 206d 6f64 656c 2e0a 2020 2020 2020  nd model..      
-0001d9d0: 2020 3a70 6172 616d 206e 702e 6e64 6172    :param np.ndar
-0001d9e0: 7261 7920 783a 2031 2d64 696d 656e 7369  ray x: 1-dimensi
-0001d9f0: 6f6e 616c 2042 6f6f 6c65 616e 2061 7272  onal Boolean arr
-0001da00: 6179 2077 6974 6820 6772 6f75 6e64 2074  ay with ground t
-0001da10: 7275 7468 206c 6162 656c 732e 0a20 2020  ruth labels..   
-0001da20: 2020 2020 203a 7061 7261 6d20 4f70 7469       :param Opti
-0001da30: 6f6e 616c 5b62 6f6f 6c5d 2063 6f6e 7469  onal[bool] conti
-0001da40: 6e75 6974 795f 636f 7272 6563 7465 6420  nuity_corrected 
-0001da50: 3a20 5768 6574 6865 7220 746f 2061 7070  : Whether to app
-0001da60: 6c79 2063 6f6e 7469 6e75 6974 7920 636f  ly continuity co
-0001da70: 7272 6563 7469 6f6e 2e20 4465 6661 756c  rrection. Defaul
-0001da80: 7420 6973 2054 7275 652e 0a0a 2020 2020  t is True...    
-0001da90: 2020 2020 3a65 7861 6d70 6c65 3a0a 2020      :example:.  
-0001daa0: 2020 2020 2020 3e3e 3e20 7820 3d20 6e70        >>> x = np
-0001dab0: 2e72 616e 646f 6d2e 7261 6e64 696e 7428  .random.randint(
-0001dac0: 302c 2032 2c20 2831 3030 3030 302c 2029  0, 2, (100000, )
-0001dad0: 290a 2020 2020 2020 2020 3e3e 3e20 7920  ).        >>> y 
-0001dae0: 3d20 6e70 2e72 616e 646f 6d2e 7261 6e64  = np.random.rand
-0001daf0: 696e 7428 302c 2032 2c20 2831 3030 3030  int(0, 2, (10000
-0001db00: 302c 2029 290a 2020 2020 2020 2020 3e3e  0, )).        >>
-0001db10: 3e20 6772 6f75 6e64 5f74 7275 7468 203d  > ground_truth =
-0001db20: 206e 702e 7261 6e64 6f6d 2e72 616e 6469   np.random.randi
-0001db30: 6e74 2830 2c20 322c 2028 3130 3030 3030  nt(0, 2, (100000
-0001db40: 2c20 2929 0a20 2020 2020 2020 203e 3e3e  , )).        >>>
-0001db50: 2053 7461 7469 7374 6963 732e 6d63 6e65   Statistics.mcne
-0001db60: 6d61 7228 783d 782c 2079 3d79 2c20 6772  mar(x=x, y=y, gr
-0001db70: 6f75 6e64 5f74 7275 7468 3d67 726f 756e  ound_truth=groun
-0001db80: 645f 7472 7574 6829 0a20 2020 2020 2020  d_truth).       
-0001db90: 2022 2222 0a0a 2020 2020 2020 2020 6368   """..        ch
-0001dba0: 6563 6b5f 7661 6c69 645f 6172 7261 7928  eck_valid_array(
-0001dbb0: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-0001dbc0: 613d 782c 0a20 2020 2020 2020 2020 2020  a=x,.           
-0001dbd0: 2073 6f75 7263 653d 5374 6174 6973 7469   source=Statisti
-0001dbe0: 6373 2e6d 636e 656d 6172 2e5f 5f6e 616d  cs.mcnemar.__nam
-0001dbf0: 655f 5f2c 0a20 2020 2020 2020 2020 2020  e__,.           
-0001dc00: 2061 6363 6570 7465 645f 6e64 696d 733d   accepted_ndims=
-0001dc10: 2831 2c29 2c0a 2020 2020 2020 2020 2020  (1,),.          
-0001dc20: 2020 6163 6365 7074 6564 5f64 7479 7065    accepted_dtype
-0001dc30: 733d 286e 702e 696e 7436 342c 206e 702e  s=(np.int64, np.
-0001dc40: 696e 7433 322c 206e 702e 696e 7438 292c  int32, np.int8),
-0001dc50: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-0001dc60: 2020 2063 6865 636b 5f76 616c 6964 5f61     check_valid_a
-0001dc70: 7272 6179 280a 2020 2020 2020 2020 2020  rray(.          
-0001dc80: 2020 6461 7461 3d79 2c0a 2020 2020 2020    data=y,.      
-0001dc90: 2020 2020 2020 736f 7572 6365 3d53 7461        source=Sta
-0001dca0: 7469 7374 6963 732e 6d63 6e65 6d61 722e  tistics.mcnemar.
-0001dcb0: 5f5f 6e61 6d65 5f5f 2c0a 2020 2020 2020  __name__,.      
-0001dcc0: 2020 2020 2020 6163 6365 7074 6564 5f6e        accepted_n
-0001dcd0: 6469 6d73 3d28 312c 292c 0a20 2020 2020  dims=(1,),.     
-0001dce0: 2020 2020 2020 2061 6363 6570 7465 645f         accepted_
-0001dcf0: 6474 7970 6573 3d28 6e70 2e69 6e74 3634  dtypes=(np.int64
-0001dd00: 2c20 6e70 2e69 6e74 3332 2c20 6e70 2e69  , np.int32, np.i
-0001dd10: 6e74 3829 2c0a 2020 2020 2020 2020 290a  nt8),.        ).
-0001dd20: 2020 2020 2020 2020 6368 6563 6b5f 7661          check_va
-0001dd30: 6c69 645f 6172 7261 7928 0a20 2020 2020  lid_array(.     
-0001dd40: 2020 2020 2020 2064 6174 613d 6772 6f75         data=grou
-0001dd50: 6e64 5f74 7275 7468 2c0a 2020 2020 2020  nd_truth,.      
-0001dd60: 2020 2020 2020 736f 7572 6365 3d53 7461        source=Sta
-0001dd70: 7469 7374 6963 732e 6d63 6e65 6d61 722e  tistics.mcnemar.
-0001dd80: 5f5f 6e61 6d65 5f5f 2c0a 2020 2020 2020  __name__,.      
-0001dd90: 2020 2020 2020 6163 6365 7074 6564 5f6e        accepted_n
-0001dda0: 6469 6d73 3d28 312c 292c 0a20 2020 2020  dims=(1,),.     
-0001ddb0: 2020 2020 2020 2061 6363 6570 7465 645f         accepted_
-0001ddc0: 6474 7970 6573 3d28 6e70 2e69 6e74 3634  dtypes=(np.int64
-0001ddd0: 2c20 6e70 2e69 6e74 3332 2c20 6e70 2e69  , np.int32, np.i
-0001dde0: 6e74 3829 2c0a 2020 2020 2020 2020 290a  nt8),.        ).
-0001ddf0: 2020 2020 2020 2020 6966 206c 656e 286c          if len(l
-0001de00: 6973 7428 7b78 2e73 6861 7065 5b30 5d2c  ist({x.shape[0],
-0001de10: 2079 2e73 6861 7065 5b30 5d2c 2067 726f   y.shape[0], gro
-0001de20: 756e 645f 7472 7574 682e 7368 6170 655b  und_truth.shape[
-0001de30: 305d 7d29 2920 213d 2031 3a0a 2020 2020  0]})) != 1:.    
-0001de40: 2020 2020 2020 2020 7261 6973 6520 436f          raise Co
-0001de50: 756e 7445 7272 6f72 280a 2020 2020 2020  untError(.      
-0001de60: 2020 2020 2020 2020 2020 6d73 673d 6622            msg=f"
-0001de70: 5468 6520 7468 7265 6520 6172 7261 7973  The three arrays
-0001de80: 2068 6173 2074 6f20 6265 2065 7175 616c   has to be equal
-0001de90: 206c 656e 6774 6873 2062 7574 2067 6f74   lengths but got
-0001dea0: 3a20 7b78 2e73 6861 7065 5b30 5d2c 2079  : {x.shape[0], y
-0001deb0: 2e73 6861 7065 5b30 5d2c 2067 726f 756e  .shape[0], groun
-0001dec0: 645f 7472 7574 682e 7368 6170 655b 305d  d_truth.shape[0]
-0001ded0: 7d22 2c0a 2020 2020 2020 2020 2020 2020  }",.            
-0001dee0: 2020 2020 736f 7572 6365 3d53 7461 7469      source=Stati
-0001def0: 7374 6963 732e 6d63 6e65 6d61 722e 5f5f  stics.mcnemar.__
-0001df00: 6e61 6d65 5f5f 2c0a 2020 2020 2020 2020  name__,.        
-0001df10: 2020 2020 290a 2020 2020 2020 2020 666f      ).        fo
-0001df20: 7220 6920 696e 205b 782c 2079 2c20 6772  r i in [x, y, gr
-0001df30: 6f75 6e64 5f74 7275 7468 5d3a 0a20 2020  ound_truth]:.   
-0001df40: 2020 2020 2020 2020 2061 6464 6974 696f           additio
-0001df50: 6e61 6c20 3d20 6c69 7374 2873 6574 286c  nal = list(set(l
-0001df60: 6973 7428 6e70 2e73 6f72 7428 6e70 2e75  ist(np.sort(np.u
-0001df70: 6e69 7175 6528 6929 2929 2920 2d20 7b30  nique(i)))) - {0
-0001df80: 2c20 317d 290a 2020 2020 2020 2020 2020  , 1}).          
-0001df90: 2020 6966 206c 656e 2861 6464 6974 696f    if len(additio
-0001dfa0: 6e61 6c29 203e 2030 3a0a 2020 2020 2020  nal) > 0:.      
-0001dfb0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0001dfc0: 496e 7661 6c69 6449 6e70 7574 4572 726f  InvalidInputErro
-0001dfd0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-0001dfe0: 2020 2020 2020 206d 7367 3d66 224d 636e         msg=f"Mcn
-0001dff0: 656d 6172 2072 6571 7569 7265 7320 6269  emar requires bi
-0001e000: 6e61 7279 2069 6e70 7574 2064 6174 6120  nary input data 
-0001e010: 6275 7420 666f 756e 6420 7b61 6464 6974  but found {addit
-0001e020: 696f 6e61 6c7d 222c 0a20 2020 2020 2020  ional}",.       
-0001e030: 2020 2020 2020 2020 2020 2020 2073 6f75               sou
-0001e040: 7263 653d 5374 6174 6973 7469 6373 2e6d  rce=Statistics.m
-0001e050: 636e 656d 6172 2e5f 5f6e 616d 655f 5f2c  cnemar.__name__,
-0001e060: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001e070: 2029 0a20 2020 2020 2020 2064 6174 6120   ).        data 
-0001e080: 3d20 6e70 2e68 7374 6163 6b28 0a20 2020  = np.hstack(.   
-0001e090: 2020 2020 2020 2020 2028 782e 7265 7368           (x.resh
-0001e0a0: 6170 6528 2d31 2c20 3129 2c20 792e 7265  ape(-1, 1), y.re
-0001e0b0: 7368 6170 6528 2d31 2c20 3129 2c20 6772  shape(-1, 1), gr
-0001e0c0: 6f75 6e64 5f74 7275 7468 2e72 6573 6861  ound_truth.resha
-0001e0d0: 7065 282d 312c 2031 2929 0a20 2020 2020  pe(-1, 1)).     
-0001e0e0: 2020 2029 0a20 2020 2020 2020 2062 203d     ).        b =
-0001e0f0: 2028 0a20 2020 2020 2020 2020 2020 206e   (.            n
-0001e100: 702e 7768 6572 6528 2864 6174 6120 3d3d  p.where((data ==
-0001e110: 2028 302c 2031 2c20 3029 292e 616c 6c28   (0, 1, 0)).all(
-0001e120: 6178 6973 3d31 2929 5b30 5d2e 7368 6170  axis=1))[0].shap
-0001e130: 655b 305d 0a20 2020 2020 2020 2020 2020  e[0].           
-0001e140: 202b 206e 702e 7768 6572 6528 2864 6174   + np.where((dat
-0001e150: 6120 3d3d 2028 312c 2030 2c20 3129 292e  a == (1, 0, 1)).
-0001e160: 616c 6c28 6178 6973 3d31 2929 5b30 5d2e  all(axis=1))[0].
-0001e170: 7368 6170 655b 305d 0a20 2020 2020 2020  shape[0].       
-0001e180: 2029 0a20 2020 2020 2020 2063 203d 2028   ).        c = (
-0001e190: 0a20 2020 2020 2020 2020 2020 206e 702e  .            np.
-0001e1a0: 7768 6572 6528 2864 6174 6120 3d3d 2028  where((data == (
-0001e1b0: 312c 2030 2c20 3029 292e 616c 6c28 6178  1, 0, 0)).all(ax
-0001e1c0: 6973 3d31 2929 5b30 5d2e 7368 6170 655b  is=1))[0].shape[
-0001e1d0: 305d 0a20 2020 2020 2020 2020 2020 202b  0].            +
-0001e1e0: 206e 702e 7768 6572 6528 2864 6174 6120   np.where((data 
-0001e1f0: 3d3d 2028 302c 2031 2c20 3129 292e 616c  == (0, 1, 1)).al
-0001e200: 6c28 6178 6973 3d31 2929 5b30 5d2e 7368  l(axis=1))[0].sh
-0001e210: 6170 655b 305d 0a20 2020 2020 2020 2029  ape[0].        )
-0001e220: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-0001e230: 636f 6e74 696e 7569 7479 5f63 6f72 7265  continuity_corre
-0001e240: 6374 6564 3a0a 2020 2020 2020 2020 2020  cted:.          
-0001e250: 2020 7820 3d20 286e 702e 7371 7561 7265    x = (np.square
-0001e260: 2862 202d 2063 2929 202f 2028 6220 2b20  (b - c)) / (b + 
-0001e270: 6329 0a20 2020 2020 2020 2065 6c73 653a  c).        else:
-0001e280: 0a20 2020 2020 2020 2020 2020 2078 203d  .            x =
-0001e290: 2028 6e70 2e73 7175 6172 6528 6e70 2e61   (np.square(np.a
-0001e2a0: 6273 2862 202d 2063 2920 2d20 3129 2920  bs(b - c) - 1)) 
-0001e2b0: 2f20 2862 202b 2063 290a 2020 2020 2020  / (b + c).      
-0001e2c0: 2020 7020 3d20 6368 6932 2e73 6628 782c    p = chi2.sf(x,
-0001e2d0: 2031 290a 2020 2020 2020 2020 7265 7475   1).        retu
-0001e2e0: 726e 2078 2c20 700a 0a20 2020 2040 7374  rn x, p..    @st
-0001e2f0: 6174 6963 6d65 7468 6f64 0a20 2020 2064  aticmethod.    d
-0001e300: 6566 2063 6f63 6872 616e 735f 7128 6461  ef cochrans_q(da
-0001e310: 7461 3a20 6e70 2e6e 6461 7272 6179 2920  ta: np.ndarray) 
-0001e320: 2d3e 2054 7570 6c65 5b66 6c6f 6174 2c20  -> Tuple[float, 
-0001e330: 666c 6f61 745d 3a0a 2020 2020 2020 2020  float]:.        
-0001e340: 2222 220a 2020 2020 2020 2020 436f 6d70  """.        Comp
-0001e350: 7574 6520 436f 6368 7261 6e73 2051 2066  ute Cochrans Q f
-0001e360: 6f72 2032 2d64 696d 656e 7369 6f6e 616c  or 2-dimensional
-0001e370: 2062 6f6f 6c65 616e 2061 7272 6179 2e0a   boolean array..
-0001e380: 0a20 2020 2020 2020 2043 616e 2062 6520  .        Can be 
-0001e390: 7573 6564 2074 6f20 6576 616c 7561 7465  used to evaluate
-0001e3a0: 2069 6620 7468 6520 7065 7266 6f72 6d61   if the performa
-0001e3b0: 6e63 6520 6f66 206d 756c 7469 706c 6520  nce of multiple 
-0001e3c0: 283e 3d32 2920 636c 6173 7369 6669 6572  (>=2) classifier
-0001e3d0: 7320 6f6e 2074 6865 2073 616d 6520 6461  s on the same da
-0001e3e0: 7461 2069 7320 7468 6520 7361 6d65 206f  ta is the same o
-0001e3f0: 7220 7369 676e 6966 6963 616e 746c 7920  r significantly 
-0001e400: 6469 6666 6572 656e 742e 0a0a 2020 2020  different...    
-0001e410: 2020 2020 2e2e 206e 6f74 653a 3a0a 2020      .. note::.  
-0001e420: 2020 2020 2020 2020 2049 6620 7477 6f20           If two 
-0001e430: 636c 6173 7369 6669 6572 732c 2063 6f6e  classifiers, con
-0001e440: 7369 6465 7220 6060 7369 6d62 612e 6d69  sider ``simba.mi
-0001e450: 7869 6e73 2e73 7461 7469 7374 6963 732e  xins.statistics.
-0001e460: 5374 6174 6973 7469 6373 2e6d 636e 656d  Statistics.mcnem
-0001e470: 6172 6060 2e0a 2020 2020 2020 2020 2020  ar``..          
-0001e480: 2060 5573 6566 756c 2062 6163 6b67 726f   `Useful backgro
-0001e490: 756e 6420 203c 6874 7470 733a 2f2f 7073  und  <https://ps
-0001e4a0: 7963 682e 756e 6c2e 6564 752f 7073 7963  ych.unl.edu/psyc
-0001e4b0: 7273 2f68 616e 6463 6f6d 702f 6863 636f  rs/handcomp/hcco
-0001e4c0: 6368 7261 6e2e 5044 463e 605f 5f2e 0a0a  chran.PDF>`__...
-0001e4d0: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
-0001e4e0: 702e 6e64 6172 7261 7920 6461 7461 3a20  p.ndarray data: 
-0001e4f0: 5477 6f20 6469 6d65 6e73 696f 6e61 6c20  Two dimensional 
-0001e500: 6172 7261 7920 6f66 2062 6f6f 6c65 616e  array of boolean
-0001e510: 2076 616c 7565 7320 7768 6572 6520 6178   values where ax
-0001e520: 6973 2031 2072 6570 7265 7365 6e74 7320  is 1 represents 
-0001e530: 636c 6173 7369 6669 6572 7320 6f72 2066  classifiers or f
-0001e540: 6561 7475 7265 7320 616e 6420 726f 7773  eatures and rows
-0001e550: 2072 6570 7265 7365 6e74 2066 7261 6d65   represent frame
-0001e560: 732e 0a20 2020 2020 2020 203a 7265 7475  s..        :retu
-0001e570: 726e 2054 7570 6c65 5b66 6c6f 6174 2c20  rn Tuple[float, 
-0001e580: 666c 6f61 745d 3a20 436f 6368 7261 6e27  float]: Cochran'
-0001e590: 7320 5120 7374 6174 6973 7469 6320 7369  s Q statistic si
-0001e5a0: 676e 6964 6963 616e 6365 2076 616c 7565  gnidicance value
-0001e5b0: 2e0a 0a20 2020 2020 2020 203a 6578 616d  ...        :exam
-0001e5c0: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
-0001e5d0: 2064 6174 6120 3d20 6e70 2e72 616e 646f   data = np.rando
-0001e5e0: 6d2e 7261 6e64 696e 7428 302c 2032 2c20  m.randint(0, 2, 
-0001e5f0: 2831 3030 3030 302c 2034 2929 0a20 2020  (100000, 4)).   
-0001e600: 2020 2020 203e 3e3e 2053 7461 7469 7374       >>> Statist
-0001e610: 6963 732e 636f 6368 7261 6e73 5f71 2864  ics.cochrans_q(d
-0001e620: 6174 613d 6461 7461 290a 2020 2020 2020  ata=data).      
-0001e630: 2020 2222 220a 2020 2020 2020 2020 6368    """.        ch
-0001e640: 6563 6b5f 7661 6c69 645f 6172 7261 7928  eck_valid_array(
-0001e650: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-0001e660: 613d 6461 7461 2c20 736f 7572 6365 3d53  a=data, source=S
-0001e670: 7461 7469 7374 6963 732e 636f 6368 7261  tatistics.cochra
-0001e680: 6e73 5f71 2e5f 5f6e 616d 655f 5f2c 2061  ns_q.__name__, a
-0001e690: 6363 6570 7465 645f 6e64 696d 733d 2832  ccepted_ndims=(2
-0001e6a0: 2c29 0a20 2020 2020 2020 2029 0a20 2020  ,).        ).   
-0001e6b0: 2020 2020 2061 6464 6974 696f 6e61 6c20       additional 
-0001e6c0: 3d20 6c69 7374 2873 6574 286c 6973 7428  = list(set(list(
-0001e6d0: 6e70 2e73 6f72 7428 6e70 2e75 6e69 7175  np.sort(np.uniqu
-0001e6e0: 6528 6461 7461 2929 2929 202d 207b 302c  e(data)))) - {0,
-0001e6f0: 2031 7d29 0a20 2020 2020 2020 2069 6620   1}).        if 
-0001e700: 6c65 6e28 6164 6469 7469 6f6e 616c 2920  len(additional) 
-0001e710: 3e20 303a 0a20 2020 2020 2020 2020 2020  > 0:.           
-0001e720: 2072 6169 7365 2049 6e76 616c 6964 496e   raise InvalidIn
-0001e730: 7075 7445 7272 6f72 280a 2020 2020 2020  putError(.      
-0001e740: 2020 2020 2020 2020 2020 6d73 673d 6622            msg=f"
-0001e750: 436f 6368 7261 6e73 2051 2072 6571 7569  Cochrans Q requi
-0001e760: 7265 7320 6269 6e61 7279 2069 6e70 7574  res binary input
-0001e770: 2064 6174 6120 6275 7420 666f 756e 6420   data but found 
-0001e780: 7b61 6464 6974 696f 6e61 6c7d 222c 0a20  {additional}",. 
-0001e790: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001e7a0: 6f75 7263 653d 5374 6174 6973 7469 6373  ource=Statistics
-0001e7b0: 2e63 6f63 6872 616e 735f 712e 5f5f 6e61  .cochrans_q.__na
-0001e7c0: 6d65 5f5f 2c0a 2020 2020 2020 2020 2020  me__,.          
-0001e7d0: 2020 290a 2020 2020 2020 2020 636f 6c5f    ).        col_
-0001e7e0: 7375 6d73 203d 206e 702e 7375 6d28 6461  sums = np.sum(da
-0001e7f0: 7461 2c20 6178 6973 3d30 290a 2020 2020  ta, axis=0).    
-0001e800: 2020 2020 726f 775f 7375 6d5f 7375 6d20      row_sum_sum 
-0001e810: 3d20 6e70 2e73 756d 286e 702e 7375 6d28  = np.sum(np.sum(
-0001e820: 6461 7461 2c20 6178 6973 3d31 2929 0a20  data, axis=1)). 
-0001e830: 2020 2020 2020 2072 6f77 5f73 756d 5f73         row_sum_s
-0001e840: 7175 6172 655f 7375 6d20 3d20 6e70 2e73  quare_sum = np.s
-0001e850: 756d 286e 702e 7371 7561 7265 286e 702e  um(np.square(np.
-0001e860: 7375 6d28 6461 7461 2c20 6178 6973 3d31  sum(data, axis=1
-0001e870: 2929 290a 2020 2020 2020 2020 6b20 3d20  ))).        k = 
-0001e880: 6461 7461 2e73 6861 7065 5b31 5d0a 2020  data.shape[1].  
-0001e890: 2020 2020 2020 6732 203d 206e 702e 7375        g2 = np.su
-0001e8a0: 6d28 7375 6d28 6e70 2e73 7175 6172 6528  m(sum(np.square(
-0001e8b0: 636f 6c5f 7375 6d73 2929 290a 2020 2020  col_sums))).    
-0001e8c0: 2020 2020 6e6f 6d69 6e61 746f 7220 3d20      nominator = 
-0001e8d0: 286b 202d 2031 2920 2a20 2828 6b20 2a20  (k - 1) * ((k * 
-0001e8e0: 6732 2920 2d20 6e70 2e73 7175 6172 6528  g2) - np.square(
-0001e8f0: 6e70 2e73 756d 2863 6f6c 5f73 756d 7329  np.sum(col_sums)
-0001e900: 2929 0a20 2020 2020 2020 2064 656e 6f6d  )).        denom
-0001e910: 696e 6174 6f72 203d 2028 6b20 2a20 726f  inator = (k * ro
-0001e920: 775f 7375 6d5f 7375 6d29 202d 2072 6f77  w_sum_sum) - row
-0001e930: 5f73 756d 5f73 7175 6172 655f 7375 6d0a  _sum_square_sum.
-0001e940: 2020 2020 2020 2020 6966 206e 6f6d 696e          if nomin
-0001e950: 6174 6f72 203d 3d20 3020 6f72 2064 656e  ator == 0 or den
-0001e960: 6f6d 696e 6174 6f72 203d 3d20 303a 0a20  ominator == 0:. 
-0001e970: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0001e980: 6e20 2d31 2e30 2c20 2d31 2e30 0a20 2020  n -1.0, -1.0.   
-0001e990: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0001e9a0: 2020 2020 2020 2071 203d 2028 6e6f 6d69         q = (nomi
-0001e9b0: 6e61 746f 7220 2f20 6465 6e6f 6d69 6e61  nator / denomina
-0001e9c0: 746f 722c 290a 2020 2020 2020 2020 2020  tor,).          
-0001e9d0: 2020 7265 7475 726e 2071 2c20 7374 6174    return q, stat
-0001e9e0: 732e 6368 6932 2e73 6628 712c 206b 202d  s.chi2.sf(q, k -
-0001e9f0: 2031 290a 0a20 2020 2040 7374 6174 6963   1)..    @static
-0001ea00: 6d65 7468 6f64 0a20 2020 2064 6566 2068  method.    def h
-0001ea10: 6172 746c 6579 5f66 6d61 7828 783a 206e  artley_fmax(x: n
-0001ea20: 702e 6e64 6172 7261 792c 2079 3a20 6e70  p.ndarray, y: np
-0001ea30: 2e6e 6461 7272 6179 293a 0a20 2020 2020  .ndarray):.     
-0001ea40: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
-0001ea50: 6f6d 7075 7465 2048 6172 746c 6579 2773  ompute Hartley's
-0001ea60: 2046 6d61 7820 7374 6174 6973 7469 6320   Fmax statistic 
-0001ea70: 746f 2074 6573 7420 666f 7220 6571 7561  to test for equa
-0001ea80: 6c69 7479 206f 6620 7661 7269 616e 6365  lity of variance
-0001ea90: 7320 6265 7477 6565 6e20 7477 6f20 6665  s between two fe
-0001eaa0: 6174 7572 6573 206f 7220 6772 6f75 7073  atures or groups
-0001eab0: 2e0a 0a20 2020 2020 2020 2056 616c 7565  ...        Value
-0001eac0: 7320 636c 6f73 6520 746f 206f 6e65 2072  s close to one r
-0001ead0: 6570 7265 7365 6e74 7320 636c 6f73 6572  epresents closer
-0001eae0: 2074 6f20 6571 7561 6c20 7661 7269 616e   to equal varian
-0001eaf0: 6365 2e0a 0a20 2020 2020 2020 203a 7061  ce...        :pa
-0001eb00: 7261 6d20 6e70 2e6e 6461 7272 6179 2078  ram np.ndarray x
-0001eb10: 3a20 3144 2061 7272 6179 2072 6570 7265  : 1D array repre
-0001eb20: 7365 6e74 696e 6720 6e75 6d65 7269 6320  senting numeric 
-0001eb30: 6461 7461 206f 6620 7468 6520 6669 7273  data of the firs
-0001eb40: 7420 6772 6f75 702f 6665 6174 7572 652e  t group/feature.
-0001eb50: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0001eb60: 6e70 2e6e 6461 7272 6179 2078 3a20 3144  np.ndarray x: 1D
-0001eb70: 2061 7272 6179 2072 6570 7265 7365 6e74   array represent
-0001eb80: 696e 6720 6e75 6d65 7269 6320 6461 7461  ing numeric data
-0001eb90: 206f 6620 7468 6520 7365 636f 6e64 2067   of the second g
-0001eba0: 726f 7570 2f66 6561 7475 7265 2e0a 0a20  roup/feature... 
-0001ebb0: 2020 2020 2020 203a 6578 616d 706c 653a         :example:
-0001ebc0: 0a20 2020 2020 2020 203e 3e3e 2078 203d  .        >>> x =
-0001ebd0: 206e 702e 7261 6e64 6f6d 2e72 616e 646f   np.random.rando
-0001ebe0: 6d28 2831 3030 2c29 290a 2020 2020 2020  m((100,)).      
-0001ebf0: 2020 3e3e 3e20 7920 3d20 6e70 2e72 616e    >>> y = np.ran
-0001ec00: 646f 6d2e 7261 6e64 6f6d 2828 3130 302c  dom.random((100,
-0001ec10: 2929 0a20 2020 2020 2020 203e 3e3e 2053  )).        >>> S
-0001ec20: 7461 7469 7374 6963 732e 6861 7274 6c65  tatistics.hartle
-0001ec30: 795f 666d 6178 2878 3d78 2c20 793d 7929  y_fmax(x=x, y=y)
-0001ec40: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001ec50: 2020 2020 2063 6865 636b 5f76 616c 6964       check_valid
-0001ec60: 5f61 7272 6179 280a 2020 2020 2020 2020  _array(.        
-0001ec70: 2020 2020 6461 7461 3d78 2c0a 2020 2020      data=x,.    
-0001ec80: 2020 2020 2020 2020 736f 7572 6365 3d53          source=S
-0001ec90: 7461 7469 7374 6963 732e 6861 7274 6c65  tatistics.hartle
-0001eca0: 795f 666d 6178 2e5f 5f6e 616d 655f 5f2c  y_fmax.__name__,
-0001ecb0: 0a20 2020 2020 2020 2020 2020 2061 6363  .            acc
-0001ecc0: 6570 7465 645f 6e64 696d 733d 2831 2c29  epted_ndims=(1,)
-0001ecd0: 2c0a 2020 2020 2020 2020 2020 2020 6163  ,.            ac
-0001ece0: 6365 7074 6564 5f64 7479 7065 733d 286e  cepted_dtypes=(n
-0001ecf0: 702e 666c 6f61 7433 322c 206e 702e 666c  p.float32, np.fl
-0001ed00: 6f61 7436 342c 206e 702e 696e 7436 342c  oat64, np.int64,
-0001ed10: 206e 702e 666c 6f61 7433 3229 2c0a 2020   np.float32),.  
-0001ed20: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0001ed30: 6368 6563 6b5f 7661 6c69 645f 6172 7261  check_valid_arra
-0001ed40: 7928 0a20 2020 2020 2020 2020 2020 2064  y(.            d
-0001ed50: 6174 613d 792c 0a20 2020 2020 2020 2020  ata=y,.         
-0001ed60: 2020 2073 6f75 7263 653d 5374 6174 6973     source=Statis
-0001ed70: 7469 6373 2e68 6172 746c 6579 5f66 6d61  tics.hartley_fma
-0001ed80: 782e 5f5f 6e61 6d65 5f5f 2c0a 2020 2020  x.__name__,.    
-0001ed90: 2020 2020 2020 2020 6163 6365 7074 6564          accepted
-0001eda0: 5f6e 6469 6d73 3d28 312c 292c 0a20 2020  _ndims=(1,),.   
-0001edb0: 2020 2020 2020 2020 2061 6363 6570 7465           accepte
-0001edc0: 645f 6474 7970 6573 3d28 6e70 2e66 6c6f  d_dtypes=(np.flo
-0001edd0: 6174 3332 2c20 6e70 2e66 6c6f 6174 3634  at32, np.float64
-0001ede0: 2c20 6e70 2e69 6e74 3634 2c20 6e70 2e66  , np.int64, np.f
-0001edf0: 6c6f 6174 3332 292c 0a20 2020 2020 2020  loat32),.       
-0001ee00: 2029 0a20 2020 2020 2020 206d 6178 5f76   ).        max_v
-0001ee10: 6172 203d 206e 702e 6d61 7828 286e 702e  ar = np.max((np.
-0001ee20: 7661 7228 7829 2c20 6e70 2e76 6172 2879  var(x), np.var(y
-0001ee30: 2929 290a 2020 2020 2020 2020 6d69 6e5f  ))).        min_
-0001ee40: 7661 7220 3d20 6e70 2e6d 696e 2828 6e70  var = np.min((np
-0001ee50: 2e76 6172 2878 292c 206e 702e 7661 7228  .var(x), np.var(
-0001ee60: 7929 2929 0a20 2020 2020 2020 2069 6620  y))).        if 
-0001ee70: 286d 6178 5f76 6172 203d 3d20 3029 206f  (max_var == 0) o
-0001ee80: 7220 286d 696e 5f76 6172 203d 3d20 3029  r (min_var == 0)
-0001ee90: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0001eea0: 7475 726e 202d 312e 300a 2020 2020 2020  turn -1.0.      
-0001eeb0: 2020 7265 7475 726e 206d 6178 5f76 6172    return max_var
-0001eec0: 202f 206d 696e 5f76 6172 0a0a 2020 2020   / min_var..    
-0001eed0: 4073 7461 7469 636d 6574 686f 640a 2020  @staticmethod.  
-0001eee0: 2020 6465 6620 6772 7562 6273 5f74 6573    def grubbs_tes
-0001eef0: 7428 783a 206e 702e 6e64 6172 7261 792c  t(x: np.ndarray,
-0001ef00: 206c 6566 745f 7461 696c 3a20 4f70 7469   left_tail: Opti
-0001ef10: 6f6e 616c 5b62 6f6f 6c5d 203d 2046 616c  onal[bool] = Fal
-0001ef20: 7365 2920 2d3e 2066 6c6f 6174 3a0a 2020  se) -> float:.  
-0001ef30: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001ef40: 2020 5065 7266 6f72 6d20 4772 7562 6273    Perform Grubbs
-0001ef50: 2720 7465 7374 2074 6f20 6465 7465 6374  ' test to detect
-0001ef60: 206f 7574 6c69 6572 7320 6966 2074 6865   outliers if the
-0001ef70: 206d 696e 696d 756d 206f 7220 6d61 7869   minimum or maxi
-0001ef80: 6d75 6d20 7661 6c75 6520 696e 2061 2066  mum value in a f
-0001ef90: 6561 7475 7265 2073 6572 6965 7320 6973  eature series is
-0001efa0: 2061 6e20 6f75 746c 6965 722e 0a0a 2020   an outlier...  
-0001efb0: 2020 2020 2020 3a70 6172 616d 206e 702e        :param np.
-0001efc0: 6e64 6172 7261 7920 783a 2031 4420 6172  ndarray x: 1D ar
-0001efd0: 7261 7920 7265 7072 6573 656e 7469 6e67  ray representing
-0001efe0: 206e 756d 6572 6963 2064 6174 612e 0a20   numeric data.. 
-0001eff0: 2020 2020 2020 203a 7061 7261 6d20 4f70         :param Op
-0001f000: 7469 6f6e 616c 5b62 6f6f 6c5d 206c 6566  tional[bool] lef
-0001f010: 745f 7461 696c 3a20 4966 2054 7275 652c  t_tail: If True,
-0001f020: 2074 6865 2074 6573 7420 6361 6c63 756c   the test calcul
-0001f030: 6174 6573 2074 6865 2047 7275 6262 7327  ates the Grubbs'
-0001f040: 2074 6573 7420 7374 6174 6973 7469 6320   test statistic 
-0001f050: 666f 7220 7468 6520 6c65 6674 2074 6169  for the left tai
-0001f060: 6c20 286d 696e 696d 756d 2076 616c 7565  l (minimum value
-0001f070: 292e 2049 6620 4661 6c73 6520 2864 6566  ). If False (def
-0001f080: 6175 6c74 292c 2069 7420 6361 6c63 756c  ault), it calcul
-0001f090: 6174 6573 2074 6865 2073 7461 7469 7374  ates the statist
-0001f0a0: 6963 2066 6f72 2074 6865 2072 6967 6874  ic for the right
-0001f0b0: 2074 6169 6c20 286d 6178 696d 756d 2076   tail (maximum v
-0001f0c0: 616c 7565 292e 0a20 2020 2020 2020 203a  alue)..        :
-0001f0d0: 7265 7475 726e 2066 6c6f 6174 3a20 5468  return float: Th
-0001f0e0: 6520 636f 6d70 7574 6564 2047 7275 6262  e computed Grubb
-0001f0f0: 7327 2074 6573 7420 7374 6174 6973 7469  s' test statisti
-0001f100: 632e 0a0a 2020 2020 2020 2020 3a65 7861  c...        :exa
-0001f110: 6d70 6c65 3a0a 2020 2020 2020 2020 3e3e  mple:.        >>
-0001f120: 3e20 7820 3d20 6e70 2e72 616e 646f 6d2e  > x = np.random.
-0001f130: 7261 6e64 6f6d 2828 3130 302c 2929 0a20  random((100,)). 
-0001f140: 2020 2020 2020 203e 3e3e 2053 7461 7469         >>> Stati
-0001f150: 7374 6963 732e 6772 7562 6273 5f74 6573  stics.grubbs_tes
-0001f160: 7428 783d 7829 0a20 2020 2020 2020 2022  t(x=x).        "
-0001f170: 2222 0a20 2020 2020 2020 2063 6865 636b  "".        check
-0001f180: 5f76 616c 6964 5f61 7272 6179 280a 2020  _valid_array(.  
-0001f190: 2020 2020 2020 2020 2020 6461 7461 3d78            data=x
-0001f1a0: 2c0a 2020 2020 2020 2020 2020 2020 736f  ,.            so
-0001f1b0: 7572 6365 3d53 7461 7469 7374 6963 732e  urce=Statistics.
-0001f1c0: 6772 7562 6273 5f74 6573 742e 5f5f 6e61  grubbs_test.__na
-0001f1d0: 6d65 5f5f 2c0a 2020 2020 2020 2020 2020  me__,.          
-0001f1e0: 2020 6163 6365 7074 6564 5f6e 6469 6d73    accepted_ndims
-0001f1f0: 3d28 312c 292c 0a20 2020 2020 2020 2020  =(1,),.         
-0001f200: 2020 2061 6363 6570 7465 645f 6474 7970     accepted_dtyp
-0001f210: 6573 3d28 6e70 2e66 6c6f 6174 3332 2c20  es=(np.float32, 
-0001f220: 6e70 2e66 6c6f 6174 3634 2c20 6e70 2e69  np.float64, np.i
-0001f230: 6e74 3634 2c20 6e70 2e66 6c6f 6174 3332  nt64, np.float32
-0001f240: 292c 0a20 2020 2020 2020 2029 0a20 2020  ),.        ).   
-0001f250: 2020 2020 2078 203d 206e 702e 736f 7274       x = np.sort
-0001f260: 2878 290a 2020 2020 2020 2020 6966 206c  (x).        if l
-0001f270: 6566 745f 7461 696c 3a0a 2020 2020 2020  eft_tail:.      
-0001f280: 2020 2020 2020 7265 7475 726e 2028 6e70        return (np
-0001f290: 2e6d 6561 6e28 7829 202d 206e 702e 6d69  .mean(x) - np.mi
-0001f2a0: 6e28 7829 2920 2f20 6e70 2e73 7464 2878  n(x)) / np.std(x
-0001f2b0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-0001f2c0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001f2d0: 726e 2028 6e70 2e6d 6178 2878 2920 2d20  rn (np.max(x) - 
-0001f2e0: 6e70 2e6d 6561 6e28 7829 2920 2f20 6e70  np.mean(x)) / np
-0001f2f0: 2e73 7464 2878 290a 0a20 2020 2040 7374  .std(x)..    @st
-0001f300: 6174 6963 6d65 7468 6f64 0a20 2020 2064  aticmethod.    d
-0001f310: 6566 2077 696c 636f 786f 6e28 783a 206e  ef wilcoxon(x: n
-0001f320: 702e 6e64 6172 7261 792c 2079 3a20 6e70  p.ndarray, y: np
-0001f330: 2e6e 6461 7272 6179 293a 0a20 2020 2020  .ndarray):.     
-0001f340: 2020 2022 2222 4e6f 6e2d 7061 7261 6d65     """Non-parame
-0001f350: 7472 6963 2074 776f 2d77 6179 2077 6974  tric two-way wit
-0001f360: 6869 6e2d 7375 626a 6563 7473 2074 6573  hin-subjects tes
-0001f370: 7422 2222 0a20 2020 2020 2020 2064 6174  t""".        dat
-0001f380: 6120 3d20 6e70 2e68 7374 6163 6b28 2878  a = np.hstack((x
-0001f390: 2e72 6573 6861 7065 282d 312c 2031 292c  .reshape(-1, 1),
-0001f3a0: 2079 2e72 6573 6861 7065 282d 312c 2031   y.reshape(-1, 1
-0001f3b0: 2929 290a 2020 2020 2020 2020 6e20 3d20  ))).        n = 
-0001f3c0: 6461 7461 2e73 6861 7065 5b30 5d0a 2020  data.shape[0].  
-0001f3d0: 2020 2020 2020 6469 6666 203d 206e 702e        diff = np.
-0001f3e0: 6469 6666 2864 6174 6129 2e66 6c61 7474  diff(data).flatt
-0001f3f0: 656e 2829 0a20 2020 2020 2020 2064 6966  en().        dif
-0001f400: 665f 6162 7320 3d20 6e70 2e61 6273 2864  f_abs = np.abs(d
-0001f410: 6966 6629 0a20 2020 2020 2020 2072 616e  iff).        ran
-0001f420: 6b5f 775f 7469 6573 203d 2066 6173 745f  k_w_ties = fast_
-0001f430: 6d65 616e 5f72 616e 6b28 6461 7461 3d64  mean_rank(data=d
-0001f440: 6966 665f 6162 732c 2064 6573 6365 6e64  iff_abs, descend
-0001f450: 696e 673d 4661 6c73 6529 0a20 2020 2020  ing=False).     
-0001f460: 2020 2073 6967 6e65 645f 7261 6e6b 5f77     signed_rank_w
-0001f470: 5f74 6965 7320 3d20 6e70 2e66 756c 6c28  _ties = np.full(
-0001f480: 2872 616e 6b5f 775f 7469 6573 2e73 6861  (rank_w_ties.sha
-0001f490: 7065 5b30 5d29 2c20 6e70 2e6e 616e 290a  pe[0]), np.nan).
-0001f4a0: 2020 2020 2020 2020 745f 706c 7573 2c20          t_plus, 
-0001f4b0: 745f 6d69 6e75 7320 3d20 302c 2030 0a0a  t_minus = 0, 0..
-0001f4c0: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-0001f4d0: 2072 616e 6765 2864 6966 662e 7368 6170   range(diff.shap
-0001f4e0: 655b 305d 293a 0a20 2020 2020 2020 2020  e[0]):.         
-0001f4f0: 2020 2069 6620 6469 6666 5b69 5d20 3c20     if diff[i] < 
-0001f500: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-0001f510: 2020 2073 6967 6e65 645f 7261 6e6b 5f77     signed_rank_w
-0001f520: 5f74 6965 735b 695d 203d 202d 7261 6e6b  _ties[i] = -rank
-0001f530: 5f77 5f74 6965 735b 695d 0a20 2020 2020  _w_ties[i].     
-0001f540: 2020 2020 2020 2020 2020 2074 5f6d 696e             t_min
-0001f550: 7573 202b 3d20 6e70 2e61 6273 2872 616e  us += np.abs(ran
-0001f560: 6b5f 775f 7469 6573 5b69 5d29 0a20 2020  k_w_ties[i]).   
-0001f570: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-0001f580: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001f590: 6967 6e65 645f 7261 6e6b 5f77 5f74 6965  igned_rank_w_tie
-0001f5a0: 735b 695d 203d 2072 616e 6b5f 775f 7469  s[i] = rank_w_ti
-0001f5b0: 6573 5b69 5d0a 2020 2020 2020 2020 2020  es[i].          
-0001f5c0: 2020 2020 2020 745f 706c 7573 202b 3d20        t_plus += 
-0001f5d0: 6e70 2e61 6273 2872 616e 6b5f 775f 7469  np.abs(rank_w_ti
-0001f5e0: 6573 5b69 5d29 0a20 2020 2020 2020 2075  es[i]).        u
-0001f5f0: 5f77 203d 2028 6e20 2a20 286e 202b 2031  _w = (n * (n + 1
-0001f600: 2929 202f 2034 0a20 2020 2020 2020 2073  )) / 4.        s
-0001f610: 7464 5f63 6f72 7265 6374 696f 6e20 3d20  td_correction = 
-0001f620: 300a 2020 2020 2020 2020 666f 7220 6920  0.        for i 
-0001f630: 696e 2072 616e 6765 2873 6967 6e65 645f  in range(signed_
-0001f640: 7261 6e6b 5f77 5f74 6965 732e 7368 6170  rank_w_ties.shap
-0001f650: 655b 305d 293a 0a20 2020 2020 2020 2020  e[0]):.         
-0001f660: 2020 2073 616d 655f 7261 6e6b 5f6e 203d     same_rank_n =
-0001f670: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-0001f680: 2020 206e 702e 6172 6777 6865 7265 2873     np.argwhere(s
-0001f690: 6967 6e65 645f 7261 6e6b 5f77 5f74 6965  igned_rank_w_tie
-0001f6a0: 7320 3d3d 2073 6967 6e65 645f 7261 6e6b  s == signed_rank
-0001f6b0: 5f77 5f74 6965 735b 695d 290a 2020 2020  _w_ties[i]).    
-0001f6c0: 2020 2020 2020 2020 2020 2020 2e66 6c61              .fla
-0001f6d0: 7474 656e 2829 0a20 2020 2020 2020 2020  tten().         
-0001f6e0: 2020 2020 2020 202e 7368 6170 655b 305d         .shape[0]
-0001f6f0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0001f700: 2020 2020 2020 2020 2020 2069 6620 7361             if sa
-0001f710: 6d65 5f72 616e 6b5f 6e20 3e20 313a 0a20  me_rank_n > 1:. 
-0001f720: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001f730: 7464 5f63 6f72 7265 6374 696f 6e20 2b3d  td_correction +=
-0001f740: 2028 2873 616d 655f 7261 6e6b 5f6e 2a2a   ((same_rank_n**
-0001f750: 3329 202d 2073 616d 655f 7261 6e6b 5f6e  3) - same_rank_n
-0001f760: 2920 2f20 320a 0a20 2020 2020 2020 2073  ) / 2..        s
-0001f770: 7464 203d 206e 702e 7371 7274 2828 286e  td = np.sqrt(((n
-0001f780: 202a 2028 6e20 2b20 3129 2920 2a20 2828   * (n + 1)) * ((
-0001f790: 3220 2a20 6e29 202b 2031 2920 2d20 7374  2 * n) + 1) - st
-0001f7a0: 645f 636f 7272 6563 7469 6f6e 2920 2f20  d_correction) / 
-0001f7b0: 3234 290a 2020 2020 2020 2020 5720 3d20  24).        W = 
-0001f7c0: 6e70 2e6d 696e 2828 745f 706c 7573 2c20  np.min((t_plus, 
-0001f7d0: 745f 6d69 6e75 7329 290a 2020 2020 2020  t_minus)).      
-0001f7e0: 2020 7a20 3d20 2857 202d 2075 5f77 2920    z = (W - u_w) 
-0001f7f0: 2f20 7374 640a 2020 2020 2020 2020 7220  / std.        r 
-0001f800: 3d20 7a20 2f20 6e70 2e73 7172 7428 6e29  = z / np.sqrt(n)
-0001f810: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001f820: 7a2c 2072 0a0a 2020 2020 4073 7461 7469  z, r..    @stati
-0001f830: 636d 6574 686f 640a 2020 2020 406e 6a69  cmethod.    @nji
-0001f840: 7428 0a20 2020 2020 2020 2022 2866 6c6f  t(.        "(flo
-0001f850: 6174 3332 5b3a 2c3a 5d2c 2029 222c 0a20  at32[:,:], )",. 
-0001f860: 2020 2029 0a20 2020 2064 6566 2063 6f76     ).    def cov
-0001f870: 5f6d 6174 7269 7828 6461 7461 3a20 6e70  _matrix(data: np
-0001f880: 2e6e 6461 7272 6179 293a 0a20 2020 2020  .ndarray):.     
-0001f890: 2020 2022 2222 0a20 2020 2020 2020 204a     """.        J
-0001f8a0: 6974 7465 6420 6865 6c70 6572 2074 6f20  itted helper to 
-0001f8b0: 636f 6d70 7574 6520 7468 6520 636f 7661  compute the cova
-0001f8c0: 7269 616e 6365 206d 6174 7269 7820 6f66  riance matrix of
-0001f8d0: 2074 6865 2069 6e70 7574 2064 6174 612e   the input data.
-0001f8e0: 2048 656c 7065 7220 666f 7220 636f 6d70   Helper for comp
-0001f8f0: 7574 696e 6720 6372 6f6e 6261 6368 2061  uting cronbach a
-0001f900: 6c70 6861 2c0a 2020 2020 2020 2020 6d75  lpha,.        mu
-0001f910: 6c74 6976 6172 6961 7465 2061 6e61 6c79  ltivariate analy
-0001f920: 7369 732c 2061 6e64 2064 6973 7461 6e63  sis, and distanc
-0001f930: 6520 636f 6d70 7574 6174 696f 6e73 2e0a  e computations..
-0001f940: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0001f950: 6e70 2e6e 6461 7272 6179 2064 6174 613a  np.ndarray data:
-0001f960: 2032 2d64 696d 656e 7369 6f6e 616c 206e   2-dimensional n
-0001f970: 756d 7079 2061 7272 6179 2072 6570 7265  umpy array repre
-0001f980: 7365 6e74 696e 6720 7468 6520 696e 7075  senting the inpu
-0001f990: 7420 6461 7461 2077 6974 6820 7368 6170  t data with shap
-0001f9a0: 6520 286e 2c20 6d29 2c20 7768 6572 6520  e (n, m), where 
-0001f9b0: 6e20 6973 2074 6865 206e 756d 6265 7220  n is the number 
-0001f9c0: 6f66 206f 6273 6572 7661 7469 6f6e 7320  of observations 
-0001f9d0: 616e 6420 6d20 6973 2074 6865 206e 756d  and m is the num
-0001f9e0: 6265 7220 6f66 2066 6561 7475 7265 732e  ber of features.
-0001f9f0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-0001fa00: 3a20 436f 7661 7269 616e 6365 206d 6174  : Covariance mat
-0001fa10: 7269 7820 6f66 2074 6865 2069 6e70 7574  rix of the input
-0001fa20: 2064 6174 6120 7769 7468 2073 6861 7065   data with shape
-0001fa30: 2028 6d2c 206d 292e 2054 6865 2028 692c   (m, m). The (i,
-0001fa40: 206a 292d 7468 2065 6c65 6d65 6e74 206f   j)-th element o
-0001fa50: 6620 7468 6520 6d61 7472 6978 2072 6570  f the matrix rep
-0001fa60: 7265 7365 6e74 7320 7468 6520 636f 7661  resents the cova
-0001fa70: 7269 616e 6365 2062 6574 7765 656e 2074  riance between t
-0001fa80: 6865 2069 2d74 6820 616e 6420 6a2d 7468  he i-th and j-th
-0001fa90: 2066 6561 7475 7265 7320 696e 2074 6865   features in the
-0001faa0: 2064 6174 612e 0a0a 2020 2020 2020 2020   data...        
-0001fab0: 3a65 7861 6d70 6c65 3a0a 2020 2020 2020  :example:.      
-0001fac0: 2020 3e3e 3e20 6461 7461 203d 206e 702e    >>> data = np.
-0001fad0: 7261 6e64 6f6d 2e72 616e 6469 6e74 2830  random.randint(0
-0001fae0: 2c32 2c20 2832 3030 2c20 3430 2929 2e61  ,2, (200, 40)).a
-0001faf0: 7374 7970 6528 6e70 2e66 6c6f 6174 3332  stype(np.float32
-0001fb00: 290a 2020 2020 2020 2020 3e3e 3e20 636f  ).        >>> co
-0001fb10: 7661 7269 616e 6365 5f6d 6174 7269 7820  variance_matrix 
-0001fb20: 3d20 5374 6174 6973 7469 6373 2e63 6f76  = Statistics.cov
-0001fb30: 5f6d 6174 7269 7828 6461 7461 3d64 6174  _matrix(data=dat
-0001fb40: 6129 0a20 2020 2020 2020 2022 2222 0a20  a).        """. 
-0001fb50: 2020 2020 2020 206e 2c20 6d20 3d20 6461         n, m = da
-0001fb60: 7461 2e73 6861 7065 0a20 2020 2020 2020  ta.shape.       
-0001fb70: 2063 6f76 203d 206e 702e 6675 6c6c 2828   cov = np.full((
-0001fb80: 6d2c 206d 292c 2030 2e30 290a 2020 2020  m, m), 0.0).    
-0001fb90: 2020 2020 666f 7220 6920 696e 2070 7261      for i in pra
-0001fba0: 6e67 6528 6d29 3a0a 2020 2020 2020 2020  nge(m):.        
-0001fbb0: 2020 2020 6d65 616e 5f69 203d 206e 702e      mean_i = np.
-0001fbc0: 7375 6d28 6461 7461 5b3a 2c20 695d 2920  sum(data[:, i]) 
-0001fbd0: 2f20 6e0a 2020 2020 2020 2020 2020 2020  / n.            
-0001fbe0: 666f 7220 6a20 696e 2072 616e 6765 286d  for j in range(m
-0001fbf0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0001fc00: 2020 206d 6561 6e5f 6a20 3d20 6e70 2e73     mean_j = np.s
-0001fc10: 756d 2864 6174 615b 3a2c 206a 5d29 202f  um(data[:, j]) /
-0001fc20: 206e 0a20 2020 2020 2020 2020 2020 2020   n.             
-0001fc30: 2020 2063 6f76 5b69 2c20 6a5d 203d 206e     cov[i, j] = n
-0001fc40: 702e 7375 6d28 2864 6174 615b 3a2c 2069  p.sum((data[:, i
-0001fc50: 5d20 2d20 6d65 616e 5f69 2920 2a20 2864  ] - mean_i) * (d
-0001fc60: 6174 615b 3a2c 206a 5d20 2d20 6d65 616e  ata[:, j] - mean
-0001fc70: 5f6a 2929 202f 2028 0a20 2020 2020 2020  _j)) / (.       
-0001fc80: 2020 2020 2020 2020 2020 2020 206e 202d               n -
-0001fc90: 2031 0a20 2020 2020 2020 2020 2020 2020   1.             
-0001fca0: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
-0001fcb0: 7572 6e20 636f 760a 0a20 2020 2040 7374  urn cov..    @st
-0001fcc0: 6174 6963 6d65 7468 6f64 0a20 2020 2040  aticmethod.    @
-0001fcd0: 6e6a 6974 2822 2866 6c6f 6174 3332 5b3a  njit("(float32[:
-0001fce0: 5d2c 2066 6c6f 6174 3634 2c29 2229 0a20  ], float64,)"). 
-0001fcf0: 2020 2064 6566 206d 6164 5f6d 6564 6961     def mad_media
-0001fd00: 6e5f 7275 6c65 2864 6174 613a 206e 702e  n_rule(data: np.
-0001fd10: 6e64 6172 7261 792c 206b 3a20 696e 7429  ndarray, k: int)
-0001fd20: 202d 3e20 6e70 2e6e 6461 7272 6179 3a0a   -> np.ndarray:.
-0001fd30: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0001fd40: 2020 2020 4465 7465 6374 206f 7574 6c69      Detect outli
-0001fd50: 6572 7320 7573 696e 6720 7468 6520 4d41  ers using the MA
-0001fd60: 442d 4d65 6469 616e 2052 756c 652e 2052  D-Median Rule. R
-0001fd70: 6574 7572 6e73 2031 6420 6172 7261 7920  eturns 1d array 
-0001fd80: 6f66 2073 697a 6520 6461 7461 2e73 6861  of size data.sha
-0001fd90: 7065 5b30 5d20 7769 7468 2031 2072 6570  pe[0] with 1 rep
-0001fda0: 7265 7365 6e74 696e 6720 6f75 746c 6965  resenting outlie
-0001fdb0: 7220 616e 6420 3020 7265 7072 6573 656e  r and 0 represen
-0001fdc0: 7469 6e67 2069 6e6c 6965 722e 0a0a 2020  ting inlier...  
-0001fdd0: 2020 2020 2020 3a65 7861 6d70 6c65 3a0a        :example:.
-0001fde0: 2020 2020 2020 2020 3e3e 3e20 6461 7461          >>> data
-0001fdf0: 203d 206e 702e 7261 6e64 6f6d 2e72 616e   = np.random.ran
-0001fe00: 6469 6e74 2830 2c20 3630 302c 2028 3930  dint(0, 600, (90
-0001fe10: 3030 3030 302c 2929 2e61 7374 7970 6528  00000,)).astype(
-0001fe20: 6e70 2e66 6c6f 6174 3332 290a 2020 2020  np.float32).    
-0001fe30: 2020 2020 3e3e 3e20 5374 6174 6973 7469      >>> Statisti
-0001fe40: 6373 2e6d 6164 5f6d 6564 6961 6e5f 7275  cs.mad_median_ru
-0001fe50: 6c65 2864 6174 613d 6461 7461 2c20 6b3d  le(data=data, k=
-0001fe60: 312e 3029 0a20 2020 2020 2020 2022 2222  1.0).        """
-0001fe70: 0a0a 2020 2020 2020 2020 6d65 6469 616e  ..        median
-0001fe80: 203d 206e 702e 6d65 6469 616e 2864 6174   = np.median(dat
-0001fe90: 6129 0a20 2020 2020 2020 206d 6164 203d  a).        mad =
-0001fea0: 206e 702e 6d65 6469 616e 286e 702e 6162   np.median(np.ab
-0001feb0: 7328 6461 7461 202d 206d 6564 6961 6e29  s(data - median)
-0001fec0: 290a 2020 2020 2020 2020 7468 7265 7368  ).        thresh
-0001fed0: 6f6c 6420 3d20 6b20 2a20 6d61 640a 2020  old = k * mad.  
-0001fee0: 2020 2020 2020 6f75 746c 6965 7273 203d        outliers =
-0001fef0: 206e 702e 6162 7328 6461 7461 202d 206d   np.abs(data - m
-0001ff00: 6564 6961 6e29 203e 2074 6872 6573 686f  edian) > thresho
-0001ff10: 6c64 0a20 2020 2020 2020 2072 6574 7572  ld.        retur
-0001ff20: 6e20 6f75 746c 6965 7273 202a 2031 0a0a  n outliers * 1..
-0001ff30: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
-0001ff40: 640a 2020 2020 406e 6a69 7428 2228 666c  d.    @njit("(fl
-0001ff50: 6f61 7433 325b 3a5d 2c20 666c 6f61 7436  oat32[:], float6
-0001ff60: 342c 2066 6c6f 6174 3634 5b3a 5d2c 2066  4, float64[:], f
-0001ff70: 6c6f 6174 3634 2922 290a 2020 2020 6465  loat64)").    de
-0001ff80: 6620 736c 6964 696e 675f 6d61 645f 6d65  f sliding_mad_me
-0001ff90: 6469 616e 5f72 756c 6528 0a20 2020 2020  dian_rule(.     
-0001ffa0: 2020 2064 6174 613a 206e 702e 6e64 6172     data: np.ndar
-0001ffb0: 7261 792c 206b 3a20 696e 742c 2074 696d  ray, k: int, tim
-0001ffc0: 655f 7769 6e64 6f77 733a 206e 702e 6e64  e_windows: np.nd
-0001ffd0: 6172 7261 792c 2066 7073 3a20 666c 6f61  array, fps: floa
-0001ffe0: 740a 2020 2020 2920 2d3e 206e 702e 6e64  t.    ) -> np.nd
-0001fff0: 6172 7261 793a 0a20 2020 2020 2020 2022  array:.        "
-00020000: 2222 0a20 2020 2020 2020 2043 6f75 6e74  "".        Count
-00020010: 2074 6865 206e 756d 6265 7220 6f66 206f   the number of o
-00020020: 7574 6c69 6572 7320 696e 2061 2073 6c69  utliers in a sli
-00020030: 6469 6e67 2074 696d 652d 7769 6e64 6f77  ding time-window
-00020040: 2075 7369 6e67 2074 6865 204d 4144 2d4d   using the MAD-M
-00020050: 6564 6961 6e20 5275 6c65 2e0a 0a20 2020  edian Rule...   
-00020060: 2020 2020 203a 7061 7261 6d20 6e70 2e6e       :param np.n
-00020070: 6461 7272 6179 2064 6174 613a 2031 4420  darray data: 1D 
-00020080: 6e75 6d65 7269 6361 6c20 6172 7261 7920  numerical array 
-00020090: 7265 7072 6573 656e 7469 6e67 2066 6561  representing fea
-000200a0: 7475 7265 2e0a 2020 2020 2020 2020 3a70  ture..        :p
-000200b0: 6172 616d 2069 6e74 206b 3a20 5468 6520  aram int k: The 
-000200c0: 6f75 746c 6965 7220 7468 7265 7368 6f6c  outlier threshol
-000200d0: 6420 6465 6669 6e65 6420 6173 206b 202a  d defined as k *
-000200e0: 206d 6564 6961 6e20 6162 736f 6c75 7465   median absolute
-000200f0: 2064 6576 6961 7469 6f6e 2069 6e20 6561   deviation in ea
-00020100: 6368 2074 696d 6520 7769 6e64 6f77 2e0a  ch time window..
-00020110: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
-00020120: 702e 6e64 6172 7261 7920 7469 6d65 5f77  p.ndarray time_w
-00020130: 696e 646f 7773 3a20 3144 2061 7272 6179  indows: 1D array
-00020140: 206f 6620 7469 6d65 2077 696e 646f 7720   of time window 
-00020150: 7369 7a65 7320 696e 2073 6563 6f6e 6473  sizes in seconds
-00020160: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00020170: 2066 6c6f 6174 2066 7073 3a20 5468 6520   float fps: The 
-00020180: 6672 6571 7565 6e63 7920 6f66 2074 6865  frequency of the
-00020190: 2073 6967 6e61 6c2e 0a20 2020 2020 2020   signal..       
-000201a0: 203a 7265 7475 726e 206e 702e 6e64 6172   :return np.ndar
-000201b0: 7261 793a 2041 7272 6179 206f 6620 7369  ray: Array of si
-000201c0: 7a65 2028 6461 7461 2e73 6861 7065 5b30  ze (data.shape[0
-000201d0: 5d2c 2074 696d 655f 7769 6e64 6f77 732e  ], time_windows.
-000201e0: 7368 6170 655b 305d 2920 7769 7468 2063  shape[0]) with c
-000201f0: 6f75 6e74 7320 6966 206f 7574 6c69 6572  ounts if outlier
-00020200: 7320 6465 7465 6374 6564 2e0a 0a20 2020  s detected...   
-00020210: 2020 2020 203a 6578 616d 706c 653a 0a20       :example:. 
-00020220: 2020 2020 2020 203e 3e3e 2064 6174 6120         >>> data 
-00020230: 3d20 6e70 2e72 616e 646f 6d2e 7261 6e64  = np.random.rand
-00020240: 696e 7428 302c 2035 302c 2028 3530 3030  int(0, 50, (5000
-00020250: 302c 2929 2e61 7374 7970 6528 6e70 2e66  0,)).astype(np.f
-00020260: 6c6f 6174 3332 290a 2020 2020 2020 2020  loat32).        
-00020270: 3e3e 3e20 5374 6174 6973 7469 6373 2e73  >>> Statistics.s
-00020280: 6c69 6469 6e67 5f6d 6164 5f6d 6564 6961  liding_mad_media
-00020290: 6e5f 7275 6c65 2864 6174 613d 6461 7461  n_rule(data=data
-000202a0: 2c20 6b3d 322c 2074 696d 655f 7769 6e64  , k=2, time_wind
-000202b0: 6f77 733d 6e70 2e61 7272 6179 285b 3230  ows=np.array([20
-000202c0: 2e30 5d29 2c20 6670 733d 312e 3029 0a20  .0]), fps=1.0). 
-000202d0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000202e0: 2020 2072 6573 756c 7473 203d 206e 702e     results = np.
-000202f0: 6675 6c6c 2828 6461 7461 2e73 6861 7065  full((data.shape
-00020300: 5b30 5d2c 2074 696d 655f 7769 6e64 6f77  [0], time_window
-00020310: 732e 7368 6170 655b 305d 292c 202d 3129  s.shape[0]), -1)
-00020320: 0a20 2020 2020 2020 2066 6f72 2074 696d  .        for tim
-00020330: 655f 7769 6e64 6f77 2069 6e20 7469 6d65  e_window in time
-00020340: 5f77 696e 646f 7773 3a0a 2020 2020 2020  _windows:.      
-00020350: 2020 2020 2020 7720 3d20 696e 7428 6670        w = int(fp
-00020360: 7320 2a20 7469 6d65 5f77 696e 646f 7729  s * time_window)
-00020370: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-00020380: 2069 2069 6e20 7261 6e67 6528 772c 2064   i in range(w, d
-00020390: 6174 612e 7368 6170 655b 305d 202b 2031  ata.shape[0] + 1
-000203a0: 2c20 3129 3a0a 2020 2020 2020 2020 2020  , 1):.          
-000203b0: 2020 2020 2020 775f 6461 7461 203d 2064        w_data = d
-000203c0: 6174 615b 6920 2d20 7720 3a20 695d 0a20  ata[i - w : i]. 
-000203d0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-000203e0: 6564 6961 6e20 3d20 6e70 2e6d 6564 6961  edian = np.media
-000203f0: 6e28 775f 6461 7461 290a 2020 2020 2020  n(w_data).      
-00020400: 2020 2020 2020 2020 2020 6d61 6420 3d20            mad = 
-00020410: 6e70 2e6d 6564 6961 6e28 6e70 2e61 6273  np.median(np.abs
-00020420: 2877 5f64 6174 6120 2d20 6d65 6469 616e  (w_data - median
-00020430: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
-00020440: 2020 2074 6872 6573 686f 6c64 203d 206b     threshold = k
-00020450: 202a 206d 6164 0a20 2020 2020 2020 2020   * mad.         
-00020460: 2020 2020 2020 206f 7574 6c69 6572 7320         outliers 
-00020470: 3d20 6e70 2e61 6273 2877 5f64 6174 6120  = np.abs(w_data 
-00020480: 2d20 6d65 6469 616e 2920 3e20 7468 7265  - median) > thre
-00020490: 7368 6f6c 640a 2020 2020 2020 2020 2020  shold.          
-000204a0: 2020 2020 2020 7265 7375 6c74 735b 6920        results[i 
-000204b0: 2d20 315d 203d 206e 702e 7375 6d28 6f75  - 1] = np.sum(ou
-000204c0: 746c 6965 7273 202a 2031 290a 2020 2020  tliers * 1).    
-000204d0: 2020 2020 7265 7475 726e 2072 6573 756c      return resul
-000204e0: 7473 0a0a 2020 2020 4073 7461 7469 636d  ts..    @staticm
-000204f0: 6574 686f 640a 2020 2020 6465 6620 6475  ethod.    def du
-00020500: 6e6e 5f69 6e64 6578 2878 3a20 6e70 2e6e  nn_index(x: np.n
-00020510: 6461 7272 6179 2c20 793a 206e 702e 6e64  darray, y: np.nd
-00020520: 6172 7261 7929 202d 3e20 666c 6f61 743a  array) -> float:
-00020530: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00020540: 2020 2020 2043 616c 6375 6c61 7465 2074       Calculate t
-00020550: 6865 2044 756e 6e20 696e 6465 7820 746f  he Dunn index to
-00020560: 2065 7661 6c75 6174 6520 7468 6520 7175   evaluate the qu
-00020570: 616c 6974 7920 6f66 2063 6c75 7374 6572  ality of cluster
-00020580: 6564 206c 6162 656c 732e 0a0a 2020 2020  ed labels...    
-00020590: 2020 2020 5468 6973 2066 756e 6374 696f      This functio
-000205a0: 6e20 6361 6c63 756c 6174 6573 2074 6865  n calculates the
-000205b0: 2044 756e 6e20 696e 6465 782c 2077 6869   Dunn index, whi
-000205c0: 6368 2069 7320 6120 6d65 6173 7572 6520  ch is a measure 
-000205d0: 6f66 2063 6c75 7374 6572 696e 6720 7175  of clustering qu
-000205e0: 616c 6974 792e 0a20 2020 2020 2020 2054  ality..        T
-000205f0: 6865 2069 6e64 6578 2063 6f6e 7369 6465  he index conside
-00020600: 7273 2074 6865 2072 6174 696f 206f 6620  rs the ratio of 
-00020610: 7468 6520 6d69 6e69 6d75 6d20 696e 7465  the minimum inte
-00020620: 722d 636c 7573 7465 7220 6469 7374 616e  r-cluster distan
-00020630: 6365 2074 6f20 7468 6520 6d61 7869 6d75  ce to the maximu
-00020640: 6d0a 2020 2020 2020 2020 696e 7472 612d  m.        intra-
-00020650: 636c 7573 7465 7220 6469 7374 616e 6365  cluster distance
-00020660: 2e20 4120 6869 6768 6572 2044 756e 6e20  . A higher Dunn 
-00020670: 696e 6465 7820 696e 6469 6361 7465 7320  index indicates 
-00020680: 6265 7474 6572 2063 6c75 7374 6572 696e  better clusterin
-00020690: 672e 0a0a 2020 2020 2020 2020 2e2e 206e  g...        .. n
-000206a0: 6f74 653a 3a0a 2020 2020 2020 2020 2020  ote::.          
-000206b0: 204d 6f64 6966 6965 6420 6672 6f6d 2060   Modified from `
-000206c0: 6a71 6d76 6965 6761 7320 3c68 7474 7073  jqmviegas <https
-000206d0: 3a2f 2f67 6974 6875 622e 636f 6d2f 6a71  ://github.com/jq
-000206e0: 6d76 6965 6761 732f 6a71 6d5f 6376 692f  mviegas/jqm_cvi/
-000206f0: 3e60 5f0a 2020 2020 2020 2020 2020 2057  >`_.           W
-00020700: 696b 6920 6068 7474 7073 3a2f 2f65 6e2e  iki `https://en.
-00020710: 7769 6b69 7065 6469 612e 6f72 672f 7769  wikipedia.org/wi
-00020720: 6b69 2f44 756e 6e5f 696e 6465 7820 3c68  ki/Dunn_index <h
-00020730: 7474 7073 3a2f 2f65 6e2e 7769 6b69 7065  ttps://en.wikipe
-00020740: 6469 612e 6f72 672f 7769 6b69 2f44 756e  dia.org/wiki/Dun
-00020750: 6e5f 696e 6465 783e 605f 0a20 2020 2020  n_index>`_.     
-00020760: 2020 2020 2020 5573 6573 2045 7563 6c69        Uses Eucli
-00020770: 6465 616e 2064 6973 7461 6e63 6573 2e0a  dean distances..
-00020780: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00020790: 6e70 2e6e 6461 7272 6179 2078 3a20 3244  np.ndarray x: 2D
-000207a0: 2061 7272 6179 2072 6570 7265 7365 6e74   array represent
-000207b0: 696e 6720 7468 6520 6461 7461 2070 6f69  ing the data poi
-000207c0: 6e74 732e 2053 6861 7065 2028 6e5f 7361  nts. Shape (n_sa
-000207d0: 6d70 6c65 732c 206e 5f66 6561 7475 7265  mples, n_feature
-000207e0: 7329 2e0a 2020 2020 2020 2020 3a70 6172  s)..        :par
-000207f0: 616d 206e 702e 6e64 6172 7261 7920 793a  am np.ndarray y:
-00020800: 2032 4420 6172 7261 7920 7265 7072 6573   2D array repres
-00020810: 656e 7469 6e67 2063 6c75 7374 6572 206c  enting cluster l
-00020820: 6162 656c 7320 666f 7220 6561 6368 2064  abels for each d
-00020830: 6174 6120 706f 696e 742e 2053 6861 7065  ata point. Shape
-00020840: 2028 6e5f 7361 6d70 6c65 732c 292e 0a20   (n_samples,).. 
-00020850: 2020 2020 2020 203a 7265 7475 726e 2066         :return f
-00020860: 6c6f 6174 3a20 5468 6520 4475 6e6e 2069  loat: The Dunn i
-00020870: 6e64 6578 2076 616c 7565 0a0a 2020 2020  ndex value..    
-00020880: 2020 2020 3a65 7861 6d70 6c65 3a0a 2020      :example:.  
-00020890: 2020 2020 2020 3e3e 3e20 7820 3d20 6e70        >>> x = np
-000208a0: 2e72 616e 646f 6d2e 7261 6e64 696e 7428  .random.randint(
-000208b0: 302c 2031 3030 2c20 2831 3030 2c20 3229  0, 100, (100, 2)
-000208c0: 290a 2020 2020 2020 2020 3e3e 3e20 7920  ).        >>> y 
-000208d0: 3d20 6e70 2e72 616e 646f 6d2e 7261 6e64  = np.random.rand
-000208e0: 696e 7428 302c 2033 2c20 2831 3030 2c29  int(0, 3, (100,)
-000208f0: 290a 2020 2020 2020 2020 3e3e 3e20 5374  ).        >>> St
-00020900: 6174 6973 7469 6373 2e64 756e 6e5f 696e  atistics.dunn_in
-00020910: 6465 7828 783d 782c 2079 3d79 290a 2020  dex(x=x, y=y).  
-00020920: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-00020930: 2020 2063 6865 636b 5f76 616c 6964 5f61     check_valid_a
-00020940: 7272 6179 280a 2020 2020 2020 2020 2020  rray(.          
-00020950: 2020 6461 7461 3d78 2c0a 2020 2020 2020    data=x,.      
-00020960: 2020 2020 2020 736f 7572 6365 3d53 7461        source=Sta
-00020970: 7469 7374 6963 732e 6475 6e6e 5f69 6e64  tistics.dunn_ind
-00020980: 6578 2e5f 5f6e 616d 655f 5f2c 0a20 2020  ex.__name__,.   
-00020990: 2020 2020 2020 2020 2061 6363 6570 7465           accepte
-000209a0: 645f 6e64 696d 733d 2832 2c29 2c0a 2020  d_ndims=(2,),.  
-000209b0: 2020 2020 2020 2020 2020 6163 6365 7074            accept
-000209c0: 6564 5f64 7479 7065 733d 2869 6e74 2c20  ed_dtypes=(int, 
-000209d0: 666c 6f61 742c 206e 702e 666c 6f61 7436  float, np.float6
-000209e0: 342c 206e 702e 666c 6f61 7433 322c 206e  4, np.float32, n
-000209f0: 702e 696e 7436 342c 206e 702e 696e 7433  p.int64, np.int3
-00020a00: 3229 2c0a 2020 2020 2020 2020 290a 2020  2),.        ).  
-00020a10: 2020 2020 2020 6368 6563 6b5f 7661 6c69        check_vali
-00020a20: 645f 6172 7261 7928 0a20 2020 2020 2020  d_array(.       
-00020a30: 2020 2020 2064 6174 613d 792c 0a20 2020       data=y,.   
-00020a40: 2020 2020 2020 2020 2073 6f75 7263 653d           source=
-00020a50: 5374 6174 6973 7469 6373 2e64 756e 6e5f  Statistics.dunn_
-00020a60: 696e 6465 782e 5f5f 6e61 6d65 5f5f 2c0a  index.__name__,.
-00020a70: 2020 2020 2020 2020 2020 2020 6163 6365              acce
-00020a80: 7074 6564 5f6e 6469 6d73 3d28 312c 292c  pted_ndims=(1,),
-00020a90: 0a20 2020 2020 2020 2020 2020 2061 6363  .            acc
-00020aa0: 6570 7465 645f 7368 6170 6573 3d5b 2878  epted_shapes=[(x
-00020ab0: 2e73 6861 7065 5b30 5d2c 295d 2c0a 2020  .shape[0],)],.  
-00020ac0: 2020 2020 2020 2020 2020 6163 6365 7074            accept
-00020ad0: 6564 5f64 7479 7065 733d 2869 6e74 2c20  ed_dtypes=(int, 
-00020ae0: 666c 6f61 742c 206e 702e 666c 6f61 7436  float, np.float6
-00020af0: 342c 206e 702e 666c 6f61 7433 322c 206e  4, np.float32, n
-00020b00: 702e 696e 7436 342c 206e 702e 696e 7433  p.int64, np.int3
-00020b10: 3229 2c0a 2020 2020 2020 2020 290a 2020  2),.        ).  
-00020b20: 2020 2020 2020 6469 7374 616e 6365 7320        distances 
-00020b30: 3d20 4665 6174 7572 6545 7874 7261 6374  = FeatureExtract
-00020b40: 696f 6e4d 6978 696e 2e63 6469 7374 280a  ionMixin.cdist(.
-00020b50: 2020 2020 2020 2020 2020 2020 6172 7261              arra
-00020b60: 795f 313d 782e 6173 7479 7065 286e 702e  y_1=x.astype(np.
-00020b70: 666c 6f61 7433 3229 2c20 6172 7261 795f  float32), array_
-00020b80: 323d 782e 6173 7479 7065 286e 702e 666c  2=x.astype(np.fl
-00020b90: 6f61 7433 3229 0a20 2020 2020 2020 2029  oat32).        )
-00020ba0: 0a20 2020 2020 2020 206b 7320 3d20 6e70  .        ks = np
-00020bb0: 2e73 6f72 7428 6e70 2e75 6e69 7175 6528  .sort(np.unique(
-00020bc0: 7929 292e 6173 7479 7065 286e 702e 696e  y)).astype(np.in
-00020bd0: 7436 3429 0a20 2020 2020 2020 2064 656c  t64).        del
-00020be0: 7461 7320 3d20 6e70 2e66 756c 6c28 286b  tas = np.full((k
-00020bf0: 732e 7368 6170 655b 305d 2c20 6b73 2e73  s.shape[0], ks.s
-00020c00: 6861 7065 5b30 5d29 2c20 6e70 2e69 6e66  hape[0]), np.inf
-00020c10: 290a 2020 2020 2020 2020 6269 675f 6465  ).        big_de
-00020c20: 6c74 6173 203d 206e 702e 7a65 726f 7328  ltas = np.zeros(
-00020c30: 5b6b 732e 7368 6170 655b 305d 2c20 315d  [ks.shape[0], 1]
-00020c40: 290a 2020 2020 2020 2020 666f 7220 692c  ).        for i,
-00020c50: 206c 2069 6e20 6c69 7374 2870 6572 6d75   l in list(permu
-00020c60: 7461 7469 6f6e 7328 6b73 2c20 3229 293a  tations(ks, 2)):
-00020c70: 0a20 2020 2020 2020 2020 2020 2076 616c  .            val
-00020c80: 7565 7320 3d20 6469 7374 616e 6365 735b  ues = distances[
-00020c90: 6e70 2e77 6865 7265 2828 7920 3d3d 2069  np.where((y == i
-00020ca0: 2929 5d5b 3a2c 206e 702e 7768 6572 6528  ))][:, np.where(
-00020cb0: 2879 203d 3d20 6c29 295d 0a20 2020 2020  (y == l))].     
-00020cc0: 2020 2020 2020 2064 656c 7461 735b 692c         deltas[i,
-00020cd0: 206c 5d20 3d20 6e70 2e6d 696e 2876 616c   l] = np.min(val
-00020ce0: 7565 735b 6e70 2e6e 6f6e 7a65 726f 2876  ues[np.nonzero(v
-00020cf0: 616c 7565 7329 5d29 0a20 2020 2020 2020  alues)]).       
-00020d00: 2066 6f72 206b 2069 6e20 6b73 3a0a 2020   for k in ks:.  
-00020d10: 2020 2020 2020 2020 2020 7661 6c75 6573            values
-00020d20: 203d 2064 6973 7461 6e63 6573 5b6e 702e   = distances[np.
-00020d30: 7768 6572 6528 2879 203d 3d20 6b73 5b6b  where((y == ks[k
-00020d40: 5d29 295d 5b3a 2c20 6e70 2e77 6865 7265  ]))][:, np.where
-00020d50: 2828 7920 3d3d 206b 735b 6b5d 2929 5d0a  ((y == ks[k]))].
-00020d60: 2020 2020 2020 2020 2020 2020 6269 675f              big_
-00020d70: 6465 6c74 6173 5b6b 5d20 3d20 6e70 2e6d  deltas[k] = np.m
-00020d80: 6178 2876 616c 7565 7329 0a0a 2020 2020  ax(values)..    
-00020d90: 2020 2020 7265 7475 726e 206e 702e 6d69      return np.mi
-00020da0: 6e28 6465 6c74 6173 2920 2f20 6e70 2e6d  n(deltas) / np.m
-00020db0: 6178 2862 6967 5f64 656c 7461 7329 0a0a  ax(big_deltas)..
-00020dc0: 2020 2020 6465 6620 6461 7669 735f 626f      def davis_bo
-00020dd0: 756c 6469 6e28 783a 206e 702e 6e64 6172  uldin(x: np.ndar
-00020de0: 7261 792c 2079 3a20 6e70 2e6e 6461 7272  ray, y: np.ndarr
-00020df0: 6179 2920 2d3e 2066 6c6f 6174 3a0a 2020  ay) -> float:.  
-00020e00: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00020e10: 2020 4361 6c63 756c 6174 6520 7468 6520    Calculate the 
-00020e20: 4461 7669 732d 426f 756c 6469 6e20 696e  Davis-Bouldin in
-00020e30: 6465 7820 666f 7220 6576 616c 7561 7469  dex for evaluati
-00020e40: 6e67 2063 6c75 7374 6572 696e 6720 7065  ng clustering pe
-00020e50: 7266 6f72 6d61 6e63 652e 0a0a 2020 2020  rformance...    
-00020e60: 2020 2020 4461 7669 732d 426f 756c 6469      Davis-Bouldi
-00020e70: 6e20 696e 6465 7820 6d65 6173 7572 6573  n index measures
-00020e80: 2074 6865 2063 6c75 7374 6572 696e 6720   the clustering 
-00020e90: 7175 616c 6974 7920 6261 7365 6420 6f6e  quality based on
-00020ea0: 2074 6865 2077 6974 6869 6e2d 636c 7573   the within-clus
-00020eb0: 7465 720a 2020 2020 2020 2020 7369 6d69  ter.        simi
-00020ec0: 6c61 7269 7479 2061 6e64 2062 6574 7765  larity and betwe
-00020ed0: 656e 2d63 6c75 7374 6572 2064 6973 7369  en-cluster dissi
-00020ee0: 6d69 6c61 7269 7479 2e20 4c6f 7765 7220  milarity. Lower 
-00020ef0: 7661 6c75 6573 2069 6e64 6963 6174 6520  values indicate 
-00020f00: 6265 7474 6572 2063 6c75 7374 6572 696e  better clusterin
-00020f10: 672e 0a0a 2020 2020 2020 2020 2e2e 206e  g...        .. n
-00020f20: 6f74 653a 3a0a 2020 2020 2020 2020 2020  ote::.          
-00020f30: 204d 6f64 6966 6965 6420 6672 6f6d 2060   Modified from `
-00020f40: 7363 696b 6974 2d6c 6561 726e 203c 6874  scikit-learn <ht
-00020f50: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
-00020f60: 2f73 6369 6b69 742d 6c65 6172 6e2f 7363  /scikit-learn/sc
-00020f70: 696b 6974 2d6c 6561 726e 2f62 6c6f 622f  ikit-learn/blob/
-00020f80: 6630 3765 3031 3338 6266 6565 3431 6364  f07e0138bfee41cd
-00020f90: 3263 3061 3564 3032 3531 6463 3366 6530  2c0a5d0251dc3fe0
-00020fa0: 3365 3665 3130 3834 2f73 6b6c 6561 726e  3e6e1084/sklearn
-00020fb0: 2f6d 6574 7269 6373 2f63 6c75 7374 6572  /metrics/cluster
-00020fc0: 2f5f 756e 7375 7065 7276 6973 6564 2e70  /_unsupervised.p
-00020fd0: 7923 4c33 3930 3e60 5f0a 0a20 2020 2020  y#L390>`_..     
-00020fe0: 2020 203a 7061 7261 6d20 6e70 2e6e 6461     :param np.nda
-00020ff0: 7272 6179 2078 3a20 3244 2061 7272 6179  rray x: 2D array
-00021000: 2072 6570 7265 7365 6e74 696e 6720 7468   representing th
-00021010: 6520 6461 7461 2070 6f69 6e74 732e 2053  e data points. S
-00021020: 6861 7065 2028 6e5f 7361 6d70 6c65 732c  hape (n_samples,
-00021030: 206e 5f66 6561 7475 7265 732f 6e5f 6469   n_features/n_di
-00021040: 6d65 6e73 696f 6e29 2e0a 2020 2020 2020  mension)..      
-00021050: 2020 3a70 6172 616d 206e 702e 6e64 6172    :param np.ndar
-00021060: 7261 7920 793a 2032 4420 6172 7261 7920  ray y: 2D array 
-00021070: 7265 7072 6573 656e 7469 6e67 2063 6c75  representing clu
-00021080: 7374 6572 206c 6162 656c 7320 666f 7220  ster labels for 
-00021090: 6561 6368 2064 6174 6120 706f 696e 742e  each data point.
-000210a0: 2053 6861 7065 2028 6e5f 7361 6d70 6c65   Shape (n_sample
-000210b0: 732c 292e 0a20 2020 2020 2020 203a 7265  s,)..        :re
-000210c0: 7475 726e 2066 6c6f 6174 3a20 4461 7669  turn float: Davi
-000210d0: 732d 426f 756c 6469 6e20 7363 6f72 652e  s-Bouldin score.
-000210e0: 0a0a 2020 2020 2020 2020 3a65 7861 6d70  ..        :examp
-000210f0: 6c65 3a0a 2020 2020 2020 2020 3e3e 3e20  le:.        >>> 
-00021100: 7820 3d20 6e70 2e72 616e 646f 6d2e 7261  x = np.random.ra
-00021110: 6e64 696e 7428 302c 2031 3030 2c20 2831  ndint(0, 100, (1
-00021120: 3030 2c20 3229 290a 2020 2020 2020 2020  00, 2)).        
-00021130: 3e3e 3e20 7920 3d20 6e70 2e72 616e 646f  >>> y = np.rando
-00021140: 6d2e 7261 6e64 696e 7428 302c 2033 2c20  m.randint(0, 3, 
-00021150: 2831 3030 2c29 290a 2020 2020 2020 2020  (100,)).        
-00021160: 3e3e 3e20 5374 6174 6973 7469 6373 2e64  >>> Statistics.d
-00021170: 6176 6973 5f62 6f75 6c64 696e 2878 3d78  avis_bouldin(x=x
-00021180: 2c20 793d 7929 0a20 2020 2020 2020 2022  , y=y).        "
-00021190: 2222 0a0a 2020 2020 2020 2020 6368 6563  ""..        chec
-000211a0: 6b5f 7661 6c69 645f 6172 7261 7928 0a20  k_valid_array(. 
-000211b0: 2020 2020 2020 2020 2020 2064 6174 613d             data=
-000211c0: 782c 0a20 2020 2020 2020 2020 2020 2073  x,.            s
-000211d0: 6f75 7263 653d 5374 6174 6973 7469 6373  ource=Statistics
-000211e0: 2e64 6176 6973 5f62 6f75 6c64 696e 2e5f  .davis_bouldin._
-000211f0: 5f6e 616d 655f 5f2c 0a20 2020 2020 2020  _name__,.       
-00021200: 2020 2020 2061 6363 6570 7465 645f 6e64       accepted_nd
-00021210: 696d 733d 2832 2c29 2c0a 2020 2020 2020  ims=(2,),.      
-00021220: 2020 2020 2020 6163 6365 7074 6564 5f64        accepted_d
-00021230: 7479 7065 733d 2869 6e74 2c20 666c 6f61  types=(int, floa
-00021240: 742c 206e 702e 666c 6f61 7436 342c 206e  t, np.float64, n
-00021250: 702e 666c 6f61 7433 322c 206e 702e 696e  p.float32, np.in
-00021260: 7436 342c 206e 702e 696e 7433 3229 2c0a  t64, np.int32),.
-00021270: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00021280: 2020 6368 6563 6b5f 7661 6c69 645f 6172    check_valid_ar
-00021290: 7261 7928 0a20 2020 2020 2020 2020 2020  ray(.           
-000212a0: 2064 6174 613d 792c 0a20 2020 2020 2020   data=y,.       
-000212b0: 2020 2020 2073 6f75 7263 653d 5374 6174       source=Stat
-000212c0: 6973 7469 6373 2e64 6176 6973 5f62 6f75  istics.davis_bou
-000212d0: 6c64 696e 2e5f 5f6e 616d 655f 5f2c 0a20  ldin.__name__,. 
-000212e0: 2020 2020 2020 2020 2020 2061 6363 6570             accep
-000212f0: 7465 645f 6e64 696d 733d 2831 2c29 2c0a  ted_ndims=(1,),.
-00021300: 2020 2020 2020 2020 2020 2020 6163 6365              acce
-00021310: 7074 6564 5f73 6861 7065 733d 5b28 782e  pted_shapes=[(x.
-00021320: 7368 6170 655b 305d 2c29 5d2c 0a20 2020  shape[0],)],.   
-00021330: 2020 2020 2020 2020 2061 6363 6570 7465           accepte
-00021340: 645f 6474 7970 6573 3d28 696e 742c 2066  d_dtypes=(int, f
-00021350: 6c6f 6174 2c20 6e70 2e66 6c6f 6174 3634  loat, np.float64
-00021360: 2c20 6e70 2e66 6c6f 6174 3332 2c20 6e70  , np.float32, np
-00021370: 2e69 6e74 3634 2c20 6e70 2e69 6e74 3332  .int64, np.int32
-00021380: 292c 0a20 2020 2020 2020 2029 0a20 2020  ),.        ).   
-00021390: 2020 2020 206e 5f6c 6162 656c 7320 3d20       n_labels = 
-000213a0: 6e70 2e75 6e69 7175 6528 7929 2e73 6861  np.unique(y).sha
-000213b0: 7065 5b30 5d0a 2020 2020 2020 2020 6c61  pe[0].        la
-000213c0: 6265 6c73 203d 206e 702e 756e 6971 7565  bels = np.unique
-000213d0: 2879 290a 2020 2020 2020 2020 696e 7472  (y).        intr
-000213e0: 615f 6469 7374 7320 3d20 6e70 2e66 756c  a_dists = np.ful
-000213f0: 6c28 286e 5f6c 6162 656c 7329 2c20 302e  l((n_labels), 0.
-00021400: 3029 0a20 2020 2020 2020 2063 656e 7472  0).        centr
-00021410: 6f69 6473 203d 206e 702e 6675 6c6c 2828  oids = np.full((
-00021420: 6e5f 6c61 6265 6c73 2c20 782e 7368 6170  n_labels, x.shap
-00021430: 655b 315d 292c 2030 2e30 290a 2020 2020  e[1]), 0.0).    
-00021440: 2020 2020 666f 7220 6b20 696e 2072 616e      for k in ran
-00021450: 6765 286e 5f6c 6162 656c 7329 3a0a 2020  ge(n_labels):.  
-00021460: 2020 2020 2020 2020 2020 636c 7573 7465            cluste
-00021470: 725f 6b20 3d20 785b 6e70 2e61 7267 7768  r_k = x[np.argwh
-00021480: 6572 6528 7920 3d3d 206c 6162 656c 735b  ere(y == labels[
-00021490: 6b5d 295d 2e72 6573 6861 7065 282d 312c  k])].reshape(-1,
-000214a0: 2032 290a 2020 2020 2020 2020 2020 2020   2).            
-000214b0: 636c 7573 7465 725f 6d65 616e 203d 206e  cluster_mean = n
-000214c0: 702e 6675 6c6c 2828 782e 7368 6170 655b  p.full((x.shape[
-000214d0: 315d 292c 206e 702e 6e61 6e29 0a20 2020  1]), np.nan).   
-000214e0: 2020 2020 2020 2020 2066 6f72 2069 2069           for i i
-000214f0: 6e20 7261 6e67 6528 636c 7573 7465 725f  n range(cluster_
-00021500: 6d65 616e 2e73 6861 7065 5b30 5d29 3a0a  mean.shape[0]):.
-00021510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021520: 636c 7573 7465 725f 6d65 616e 5b69 5d20  cluster_mean[i] 
-00021530: 3d20 6e70 2e6d 6561 6e28 636c 7573 7465  = np.mean(cluste
-00021540: 725f 6b5b 3a2c 2069 5d2e 666c 6174 7465  r_k[:, i].flatte
-00021550: 6e28 2929 0a20 2020 2020 2020 2020 2020  n()).           
-00021560: 2063 656e 7472 6f69 6473 5b6b 5d20 3d20   centroids[k] = 
-00021570: 636c 7573 7465 725f 6d65 616e 0a20 2020  cluster_mean.   
-00021580: 2020 2020 2020 2020 2069 6e74 7261 5f64           intra_d
-00021590: 6973 7473 5b6b 5d20 3d20 6e70 2e61 7665  ists[k] = np.ave
-000215a0: 7261 6765 280a 2020 2020 2020 2020 2020  rage(.          
-000215b0: 2020 2020 2020 4665 6174 7572 6545 7874        FeatureExt
-000215c0: 7261 6374 696f 6e4d 6978 696e 2e66 7261  ractionMixin.fra
-000215d0: 6d65 7769 7365 5f65 7563 6c69 6465 616e  mewise_euclidean
-000215e0: 5f64 6973 7461 6e63 6528 0a20 2020 2020  _distance(.     
-000215f0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00021600: 6f63 6174 696f 6e5f 313d 636c 7573 7465  ocation_1=cluste
-00021610: 725f 6b2c 0a20 2020 2020 2020 2020 2020  r_k,.           
-00021620: 2020 2020 2020 2020 206c 6f63 6174 696f           locatio
-00021630: 6e5f 323d 6e70 2e66 756c 6c28 636c 7573  n_2=np.full(clus
-00021640: 7465 725f 6b2e 7368 6170 652c 2063 6c75  ter_k.shape, clu
-00021650: 7374 6572 5f6d 6561 6e29 2c0a 2020 2020  ster_mean),.    
-00021660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021670: 7078 5f70 6572 5f6d 6d3d 312c 0a20 2020  px_per_mm=1,.   
-00021680: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-00021690: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-000216a0: 2020 2020 2063 656e 7472 6f69 645f 6469       centroid_di
-000216b0: 7374 616e 6365 7320 3d20 4665 6174 7572  stances = Featur
-000216c0: 6545 7874 7261 6374 696f 6e4d 6978 696e  eExtractionMixin
-000216d0: 2e63 6469 7374 280a 2020 2020 2020 2020  .cdist(.        
-000216e0: 2020 2020 6172 7261 795f 313d 6365 6e74      array_1=cent
-000216f0: 726f 6964 732e 6173 7479 7065 286e 702e  roids.astype(np.
-00021700: 666c 6f61 7433 3229 2c20 6172 7261 795f  float32), array_
-00021710: 323d 6365 6e74 726f 6964 732e 6173 7479  2=centroids.asty
-00021720: 7065 286e 702e 666c 6f61 7433 3229 0a20  pe(np.float32). 
-00021730: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00021740: 2069 6620 6e70 2e61 6c6c 636c 6f73 6528   if np.allclose(
-00021750: 696e 7472 615f 6469 7374 732c 2030 2920  intra_dists, 0) 
-00021760: 6f72 206e 702e 616c 6c63 6c6f 7365 2863  or np.allclose(c
-00021770: 656e 7472 6f69 645f 6469 7374 616e 6365  entroid_distance
-00021780: 732c 2030 293a 0a20 2020 2020 2020 2020  s, 0):.         
-00021790: 2020 2072 6574 7572 6e20 302e 300a 2020     return 0.0.  
-000217a0: 2020 2020 2020 6365 6e74 726f 6964 5f64        centroid_d
-000217b0: 6973 7461 6e63 6573 5b63 656e 7472 6f69  istances[centroi
-000217c0: 645f 6469 7374 616e 6365 7320 3d3d 2030  d_distances == 0
-000217d0: 5d20 3d20 6e70 2e69 6e66 0a20 2020 2020  ] = np.inf.     
-000217e0: 2020 2063 6f6d 6269 6e65 645f 696e 7472     combined_intr
-000217f0: 615f 6469 7374 7320 3d20 696e 7472 615f  a_dists = intra_
-00021800: 6469 7374 735b 3a2c 204e 6f6e 655d 202b  dists[:, None] +
-00021810: 2069 6e74 7261 5f64 6973 7473 0a20 2020   intra_dists.   
-00021820: 2020 2020 2072 6574 7572 6e20 6e70 2e6d       return np.m
-00021830: 6561 6e28 6e70 2e6d 6178 2863 6f6d 6269  ean(np.max(combi
-00021840: 6e65 645f 696e 7472 615f 6469 7374 7320  ned_intra_dists 
-00021850: 2f20 6365 6e74 726f 6964 5f64 6973 7461  / centroid_dista
-00021860: 6e63 6573 2c20 6178 6973 3d31 2929 0a0a  nces, axis=1))..
-00021870: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
-00021880: 640a 2020 2020 406e 6a69 7428 2228 666c  d.    @njit("(fl
-00021890: 6f61 7433 325b 3a2c 3a5d 2c20 696e 7436  oat32[:,:], int6
-000218a0: 345b 3a5d 2922 2c20 6361 6368 653d 5472  4[:])", cache=Tr
-000218b0: 7565 290a 2020 2020 6465 6620 6361 6c69  ue).    def cali
-000218c0: 6e73 6b69 5f68 6172 6162 6173 7a28 783a  nski_harabasz(x:
-000218d0: 206e 702e 6e64 6172 7261 792c 2079 3a20   np.ndarray, y: 
-000218e0: 6e70 2e6e 6461 7272 6179 2920 2d3e 2066  np.ndarray) -> f
-000218f0: 6c6f 6174 3a0a 2020 2020 2020 2020 2222  loat:.        ""
-00021900: 220a 2020 2020 2020 2020 436f 6d70 7574  ".        Comput
-00021910: 6520 7468 6520 4361 6c69 6e73 6b69 2d48  e the Calinski-H
-00021920: 6172 6162 6173 7a20 7363 6f72 6520 746f  arabasz score to
-00021930: 2065 7661 6c75 6174 6520 636c 7573 7465   evaluate cluste
-00021940: 7269 6e67 2071 7561 6c69 7479 2e0a 0a20  ring quality... 
-00021950: 2020 2020 2020 2054 6865 2043 616c 696e         The Calin
-00021960: 736b 692d 4861 7261 6261 737a 2073 636f  ski-Harabasz sco
-00021970: 7265 2069 7320 6120 6d65 6173 7572 6520  re is a measure 
-00021980: 6f66 2063 6c75 7374 6572 2073 6570 6172  of cluster separ
-00021990: 6174 696f 6e20 616e 6420 636f 6d70 6163  ation and compac
-000219a0: 746e 6573 732e 0a20 2020 2020 2020 2049  tness..        I
-000219b0: 7420 6973 2063 616c 6375 6c61 7465 6420  t is calculated 
-000219c0: 6173 2074 6865 2072 6174 696f 206f 6620  as the ratio of 
-000219d0: 7468 6520 6265 7477 6565 6e2d 636c 7573  the between-clus
-000219e0: 7465 7220 6469 7370 6572 7369 6f6e 2074  ter dispersion t
-000219f0: 6f20 7468 650a 2020 2020 2020 2020 7769  o the.        wi
-00021a00: 7468 696e 2d63 6c75 7374 6572 2064 6973  thin-cluster dis
-00021a10: 7065 7273 696f 6e2e 2041 2068 6967 6865  persion. A highe
-00021a20: 7220 7363 6f72 6520 696e 6469 6361 7465  r score indicate
-00021a30: 7320 6265 7474 6572 2063 6c75 7374 6572  s better cluster
-00021a40: 696e 672e 0a0a 2020 2020 2020 2020 3a70  ing...        :p
-00021a50: 6172 616d 2078 3a20 3244 2061 7272 6179  aram x: 2D array
-00021a60: 2072 6570 7265 7365 6e74 696e 6720 7468   representing th
-00021a70: 6520 6461 7461 2070 6f69 6e74 732e 2053  e data points. S
-00021a80: 6861 7065 2028 6e5f 7361 6d70 6c65 732c  hape (n_samples,
-00021a90: 206e 5f66 6561 7475 7265 732f 6e5f 6469   n_features/n_di
-00021aa0: 6d65 6e73 696f 6e29 2e0a 2020 2020 2020  mension)..      
-00021ab0: 2020 3a70 6172 616d 2079 3a20 3244 2061    :param y: 2D a
-00021ac0: 7272 6179 2072 6570 7265 7365 6e74 696e  rray representin
-00021ad0: 6720 636c 7573 7465 7220 6c61 6265 6c73  g cluster labels
-00021ae0: 2066 6f72 2065 6163 6820 6461 7461 2070   for each data p
-00021af0: 6f69 6e74 2e20 5368 6170 6520 286e 5f73  oint. Shape (n_s
-00021b00: 616d 706c 6573 2c29 2e0a 2020 2020 2020  amples,)..      
-00021b10: 2020 3a72 6574 7572 6e20 666c 6f61 743a    :return float:
-00021b20: 2043 616c 696e 736b 692d 4861 7261 6261   Calinski-Haraba
-00021b30: 737a 2073 636f 7265 2e0a 0a20 2020 2020  sz score...     
-00021b40: 2020 203a 6578 616d 706c 653a 0a20 2020     :example:.   
-00021b50: 2020 2020 203e 3e3e 2078 203d 206e 702e       >>> x = np.
-00021b60: 7261 6e64 6f6d 2e72 616e 646f 6d28 2831  random.random((1
-00021b70: 3030 2c20 3229 292e 6173 7479 7065 286e  00, 2)).astype(n
-00021b80: 702e 666c 6f61 7433 3229 0a20 2020 2020  p.float32).     
-00021b90: 2020 203e 3e3e 2079 203d 206e 702e 7261     >>> y = np.ra
-00021ba0: 6e64 6f6d 2e72 616e 6469 6e74 2830 2c20  ndom.randint(0, 
-00021bb0: 3130 302c 2028 3130 302c 2929 2e61 7374  100, (100,)).ast
-00021bc0: 7970 6528 6e70 2e69 6e74 3634 290a 2020  ype(np.int64).  
-00021bd0: 2020 2020 2020 3e3e 3e20 5374 6174 6973        >>> Statis
-00021be0: 7469 6373 2e63 616c 696e 736b 695f 6861  tics.calinski_ha
-00021bf0: 7261 6261 737a 2878 3d78 2c20 793d 7929  rabasz(x=x, y=y)
-00021c00: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-00021c10: 2020 2020 2020 6e5f 6c61 6265 6c73 203d        n_labels =
-00021c20: 206e 702e 756e 6971 7565 2879 292e 7368   np.unique(y).sh
-00021c30: 6170 655b 305d 0a20 2020 2020 2020 206c  ape[0].        l
-00021c40: 6162 656c 7320 3d20 6e70 2e75 6e69 7175  abels = np.uniqu
-00021c50: 6528 7929 0a20 2020 2020 2020 2065 7874  e(y).        ext
-00021c60: 7261 5f64 6973 7065 7273 696f 6e2c 2069  ra_dispersion, i
-00021c70: 6e74 7261 5f64 6973 7065 7273 696f 6e20  ntra_dispersion 
-00021c80: 3d20 302e 302c 2030 2e30 0a20 2020 2020  = 0.0, 0.0.     
-00021c90: 2020 2067 6c6f 6261 6c5f 6d65 616e 203d     global_mean =
-00021ca0: 206e 702e 6675 6c6c 2828 782e 7368 6170   np.full((x.shap
-00021cb0: 655b 315d 292c 206e 702e 6e61 6e29 0a20  e[1]), np.nan). 
-00021cc0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-00021cd0: 7261 6e67 6528 782e 7368 6170 655b 315d  range(x.shape[1]
-00021ce0: 293a 0a20 2020 2020 2020 2020 2020 2067  ):.            g
-00021cf0: 6c6f 6261 6c5f 6d65 616e 5b69 5d20 3d20  lobal_mean[i] = 
-00021d00: 6e70 2e6d 6561 6e28 785b 3a2c 2069 5d2e  np.mean(x[:, i].
-00021d10: 666c 6174 7465 6e28 2929 0a20 2020 2020  flatten()).     
-00021d20: 2020 2066 6f72 206b 2069 6e20 7261 6e67     for k in rang
-00021d30: 6528 6e5f 6c61 6265 6c73 293a 0a20 2020  e(n_labels):.   
-00021d40: 2020 2020 2020 2020 2063 6c75 7374 6572           cluster
-00021d50: 5f6b 203d 2078 5b6e 702e 6172 6777 6865  _k = x[np.argwhe
-00021d60: 7265 2879 203d 3d20 6c61 6265 6c73 5b6b  re(y == labels[k
-00021d70: 5d29 2e66 6c61 7474 656e 2829 2c20 3a5d  ]).flatten(), :]
-00021d80: 0a20 2020 2020 2020 2020 2020 206d 6561  .            mea
-00021d90: 6e5f 6b20 3d20 6e70 2e66 756c 6c28 2863  n_k = np.full((c
-00021da0: 6c75 7374 6572 5f6b 2e73 6861 7065 5b31  luster_k.shape[1
-00021db0: 5d29 2c20 6e70 2e6e 616e 290a 2020 2020  ]), np.nan).    
-00021dc0: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-00021dd0: 2072 616e 6765 2863 6c75 7374 6572 5f6b   range(cluster_k
-00021de0: 2e73 6861 7065 5b31 5d29 3a0a 2020 2020  .shape[1]):.    
-00021df0: 2020 2020 2020 2020 2020 2020 6d65 616e              mean
-00021e00: 5f6b 5b69 5d20 3d20 6e70 2e6d 6561 6e28  _k[i] = np.mean(
-00021e10: 636c 7573 7465 725f 6b5b 3a2c 2069 5d2e  cluster_k[:, i].
-00021e20: 666c 6174 7465 6e28 2929 0a20 2020 2020  flatten()).     
-00021e30: 2020 2020 2020 2065 7874 7261 5f64 6973         extra_dis
-00021e40: 7065 7273 696f 6e20 2b3d 206c 656e 2863  persion += len(c
-00021e50: 6c75 7374 6572 5f6b 2920 2a20 6e70 2e73  luster_k) * np.s
-00021e60: 756d 2828 6d65 616e 5f6b 202d 2067 6c6f  um((mean_k - glo
-00021e70: 6261 6c5f 6d65 616e 2920 2a2a 2032 290a  bal_mean) ** 2).
-00021e80: 2020 2020 2020 2020 2020 2020 696e 7472              intr
-00021e90: 615f 6469 7370 6572 7369 6f6e 202b 3d20  a_dispersion += 
-00021ea0: 6e70 2e73 756d 2828 636c 7573 7465 725f  np.sum((cluster_
-00021eb0: 6b20 2d20 6d65 616e 5f6b 2920 2a2a 2032  k - mean_k) ** 2
-00021ec0: 290a 0a20 2020 2020 2020 2064 656e 6f6d  )..        denom
-00021ed0: 696e 6174 6f72 203d 2069 6e74 7261 5f64  inator = intra_d
-00021ee0: 6973 7065 7273 696f 6e20 2a20 286e 5f6c  ispersion * (n_l
-00021ef0: 6162 656c 7320 2d20 312e 3029 0a20 2020  abels - 1.0).   
-00021f00: 2020 2020 2069 6620 6465 6e6f 6d69 6e61       if denomina
-00021f10: 746f 7220 3d3d 2030 2e30 3a0a 2020 2020  tor == 0.0:.    
-00021f20: 2020 2020 2020 2020 7265 7475 726e 2030          return 0
-00021f30: 2e30 0a20 2020 2020 2020 2065 6c73 653a  .0.        else:
-00021f40: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00021f50: 7572 6e20 6578 7472 615f 6469 7370 6572  urn extra_disper
-00021f60: 7369 6f6e 202a 2028 782e 7368 6170 655b  sion * (x.shape[
-00021f70: 305d 202d 206e 5f6c 6162 656c 7329 202f  0] - n_labels) /
-00021f80: 2064 656e 6f6d 696e 6174 6f72 0a0a 2020   denominator..  
-00021f90: 2020 4073 7461 7469 636d 6574 686f 640a    @staticmethod.
-00021fa0: 2020 2020 6465 6620 6164 6a75 7374 6564      def adjusted
-00021fb0: 5f72 616e 6428 783a 206e 702e 6e64 6172  _rand(x: np.ndar
-00021fc0: 7261 792c 2079 3a20 6e70 2e6e 6461 7272  ray, y: np.ndarr
-00021fd0: 6179 2920 2d3e 2066 6c6f 6174 3a0a 2020  ay) -> float:.  
-00021fe0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00021ff0: 2020 4361 6c63 756c 6174 6520 7468 6520    Calculate the 
-00022000: 4164 6a75 7374 6564 2052 616e 6420 496e  Adjusted Rand In
-00022010: 6465 7820 2841 5249 2920 6265 7477 6565  dex (ARI) betwee
-00022020: 6e20 7477 6f20 636c 7573 7465 7269 6e67  n two clustering
-00022030: 732e 0a0a 2020 2020 2020 2020 3a70 6172  s...        :par
-00022040: 616d 206e 702e 6e64 6172 7261 7920 783a  am np.ndarray x:
-00022050: 2031 4420 6172 7261 7920 7265 7072 6573   1D array repres
-00022060: 656e 7469 6e67 2074 6865 206c 6162 656c  enting the label
-00022070: 7320 6f66 2074 6865 2066 6972 7374 206d  s of the first m
-00022080: 6f64 656c 2e0a 2020 2020 2020 2020 3a70  odel..        :p
-00022090: 6172 616d 206e 702e 6e64 6172 7261 7920  aram np.ndarray 
-000220a0: 793a 2031 4420 6172 7261 7920 7265 7072  y: 1D array repr
-000220b0: 6573 656e 7469 6e67 2074 6865 206c 6162  esenting the lab
-000220c0: 656c 7320 6f66 2074 6865 2073 6563 6f6e  els of the secon
-000220d0: 6420 6d6f 6465 6c2e 0a20 2020 2020 2020  d model..       
-000220e0: 203a 7265 7475 726e 2066 6c6f 6174 3a20   :return float: 
-000220f0: 3120 696e 6469 6361 7465 7320 7065 7266  1 indicates perf
-00022100: 6563 7420 636c 7573 7465 7269 6e67 2061  ect clustering a
-00022110: 6772 6565 6d65 6e74 2c20 3020 696e 6469  greement, 0 indi
-00022120: 6361 7465 7320 7261 6e64 6f6d 2063 6c75  cates random clu
-00022130: 7374 6572 696e 672c 2061 6e64 206e 6567  stering, and neg
-00022140: 6174 6976 6520 7661 6c75 6573 2069 6e64  ative values ind
-00022150: 6963 6174 6520 6469 7361 6772 6565 6d65  icate disagreeme
-00022160: 6e74 2062 6574 7765 656e 2074 6865 2063  nt between the c
-00022170: 6c75 7374 6572 696e 6773 2e0a 0a20 2020  lusterings...   
-00022180: 2020 2020 203a 6578 616d 706c 653a 0a20       :example:. 
-00022190: 2020 2020 2020 203e 3e3e 2078 203d 206e         >>> x = n
-000221a0: 702e 6172 7261 7928 5b30 2c20 302c 2030  p.array([0, 0, 0
-000221b0: 2c20 302c 2030 5d29 0a20 2020 2020 2020  , 0, 0]).       
-000221c0: 203e 3e3e 2079 203d 206e 702e 6172 7261   >>> y = np.arra
-000221d0: 7928 5b31 2c20 312c 2031 2c20 312c 2031  y([1, 1, 1, 1, 1
-000221e0: 5d29 0a20 2020 2020 2020 203e 3e3e 2053  ]).        >>> S
-000221f0: 7461 7469 7374 6963 732e 6164 6a75 7374  tatistics.adjust
-00022200: 6564 5f72 616e 6428 783d 782c 2079 3d79  ed_rand(x=x, y=y
-00022210: 290a 2020 2020 2020 2020 3e3e 3e20 312e  ).        >>> 1.
-00022220: 300a 2020 2020 2020 2020 2222 220a 0a20  0.        """.. 
-00022230: 2020 2020 2020 2063 6865 636b 5f76 616c         check_val
-00022240: 6964 5f61 7272 6179 280a 2020 2020 2020  id_array(.      
-00022250: 2020 2020 2020 6461 7461 3d78 2c0a 2020        data=x,.  
-00022260: 2020 2020 2020 2020 2020 736f 7572 6365            source
-00022270: 3d53 7461 7469 7374 6963 732e 6164 6a75  =Statistics.adju
-00022280: 7374 6564 5f72 616e 642e 5f5f 6e61 6d65  sted_rand.__name
-00022290: 5f5f 2c0a 2020 2020 2020 2020 2020 2020  __,.            
-000222a0: 6163 6365 7074 6564 5f6e 6469 6d73 3d28  accepted_ndims=(
-000222b0: 312c 292c 0a20 2020 2020 2020 2020 2020  1,),.           
-000222c0: 2061 6363 6570 7465 645f 6474 7970 6573   accepted_dtypes
-000222d0: 3d28 6e70 2e69 6e74 3634 2c20 6e70 2e69  =(np.int64, np.i
-000222e0: 6e74 3332 2c20 696e 7429 2c0a 2020 2020  nt32, int),.    
-000222f0: 2020 2020 2020 2020 6d69 6e5f 6178 6973          min_axis
-00022300: 5f30 3d31 2c0a 2020 2020 2020 2020 290a  _0=1,.        ).
-00022310: 2020 2020 2020 2020 6368 6563 6b5f 7661          check_va
-00022320: 6c69 645f 6172 7261 7928 0a20 2020 2020  lid_array(.     
-00022330: 2020 2020 2020 2064 6174 613d 792c 0a20         data=y,. 
-00022340: 2020 2020 2020 2020 2020 2073 6f75 7263             sourc
-00022350: 653d 5374 6174 6973 7469 6373 2e61 646a  e=Statistics.adj
-00022360: 7573 7465 645f 7261 6e64 2e5f 5f6e 616d  usted_rand.__nam
-00022370: 655f 5f2c 0a20 2020 2020 2020 2020 2020  e__,.           
-00022380: 2061 6363 6570 7465 645f 6e64 696d 733d   accepted_ndims=
-00022390: 2831 2c29 2c0a 2020 2020 2020 2020 2020  (1,),.          
-000223a0: 2020 6163 6365 7074 6564 5f64 7479 7065    accepted_dtype
-000223b0: 733d 286e 702e 696e 7436 342c 206e 702e  s=(np.int64, np.
-000223c0: 696e 7433 322c 2069 6e74 292c 0a20 2020  int32, int),.   
-000223d0: 2020 2020 2020 2020 2061 6363 6570 7465           accepte
-000223e0: 645f 7368 6170 6573 3d5b 2878 2e73 6861  d_shapes=[(x.sha
-000223f0: 7065 5b30 5d2c 295d 2c0a 2020 2020 2020  pe[0],)],.      
-00022400: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
-00022410: 726e 2061 646a 7573 7465 645f 7261 6e64  rn adjusted_rand
-00022420: 5f73 636f 7265 286c 6162 656c 735f 7472  _score(labels_tr
-00022430: 7565 3d78 2c20 6c61 6265 6c73 5f70 7265  ue=x, labels_pre
-00022440: 643d 7929 0a0a 2020 2020 4073 7461 7469  d=y)..    @stati
-00022450: 636d 6574 686f 640a 2020 2020 6465 6620  cmethod.    def 
-00022460: 666f 776c 6b65 735f 6d61 6c6c 6f77 7328  fowlkes_mallows(
-00022470: 783a 206e 702e 6e64 6172 7261 792c 2079  x: np.ndarray, y
-00022480: 3a20 6e70 2e6e 6461 7272 6179 2920 2d3e  : np.ndarray) ->
-00022490: 2066 6c6f 6174 3a0a 2020 2020 2020 2020   float:.        
-000224a0: 2222 220a 2020 2020 2020 2020 4361 6c63  """.        Calc
-000224b0: 756c 6174 6520 7468 6520 466f 776c 6b65  ulate the Fowlke
-000224c0: 732d 4d61 6c6c 6f77 7320 496e 6465 7820  s-Mallows Index 
-000224d0: 2846 4d49 2920 6265 7477 6565 6e20 7477  (FMI) between tw
-000224e0: 6f20 636c 7573 7465 7269 6e67 732e 0a0a  o clusterings...
-000224f0: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
-00022500: 702e 6e64 6172 7261 7920 783a 2031 4420  p.ndarray x: 1D 
-00022510: 6172 7261 7920 7265 7072 6573 656e 7469  array representi
-00022520: 6e67 2074 6865 206c 6162 656c 7320 6f66  ng the labels of
-00022530: 2074 6865 2066 6972 7374 206d 6f64 656c   the first model
-00022540: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00022550: 206e 702e 6e64 6172 7261 7920 793a 2031   np.ndarray y: 1
-00022560: 4420 6172 7261 7920 7265 7072 6573 656e  D array represen
-00022570: 7469 6e67 2074 6865 206c 6162 656c 7320  ting the labels 
-00022580: 6f66 2074 6865 2073 6563 6f6e 6420 6d6f  of the second mo
-00022590: 6465 6c2e 0a20 2020 2020 2020 203a 7265  del..        :re
-000225a0: 7475 726e 2066 6c6f 6174 3a20 5363 6f72  turn float: Scor
-000225b0: 6520 6265 7477 6565 6e20 3020 616e 6420  e between 0 and 
-000225c0: 312e 2031 2069 6e64 6963 6174 6573 2070  1. 1 indicates p
-000225d0: 6572 6665 6374 2063 6c75 7374 6572 696e  erfect clusterin
-000225e0: 6720 6167 7265 656d 656e 742c 2030 2069  g agreement, 0 i
-000225f0: 6e64 6963 6174 6573 2072 616e 646f 6d20  ndicates random 
-00022600: 636c 7573 7465 7269 6e67 2e0a 2020 2020  clustering..    
-00022610: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00022620: 6368 6563 6b5f 7661 6c69 645f 6172 7261  check_valid_arra
-00022630: 7928 0a20 2020 2020 2020 2020 2020 2064  y(.            d
-00022640: 6174 613d 782c 0a20 2020 2020 2020 2020  ata=x,.         
-00022650: 2020 2073 6f75 7263 653d 5374 6174 6973     source=Statis
-00022660: 7469 6373 2e66 6f77 6c6b 6573 5f6d 616c  tics.fowlkes_mal
-00022670: 6c6f 7773 2e5f 5f6e 616d 655f 5f2c 0a20  lows.__name__,. 
-00022680: 2020 2020 2020 2020 2020 2061 6363 6570             accep
-00022690: 7465 645f 6e64 696d 733d 2831 2c29 2c0a  ted_ndims=(1,),.
-000226a0: 2020 2020 2020 2020 2020 2020 6163 6365              acce
-000226b0: 7074 6564 5f64 7479 7065 733d 286e 702e  pted_dtypes=(np.
-000226c0: 696e 7436 342c 206e 702e 696e 7433 322c  int64, np.int32,
-000226d0: 2069 6e74 292c 0a20 2020 2020 2020 2020   int),.         
-000226e0: 2020 206d 696e 5f61 7869 735f 303d 312c     min_axis_0=1,
-000226f0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00022700: 2020 2063 6865 636b 5f76 616c 6964 5f61     check_valid_a
-00022710: 7272 6179 280a 2020 2020 2020 2020 2020  rray(.          
-00022720: 2020 6461 7461 3d79 2c0a 2020 2020 2020    data=y,.      
-00022730: 2020 2020 2020 736f 7572 6365 3d53 7461        source=Sta
-00022740: 7469 7374 6963 732e 666f 776c 6b65 735f  tistics.fowlkes_
-00022750: 6d61 6c6c 6f77 732e 5f5f 6e61 6d65 5f5f  mallows.__name__
-00022760: 2c0a 2020 2020 2020 2020 2020 2020 6163  ,.            ac
-00022770: 6365 7074 6564 5f6e 6469 6d73 3d28 312c  cepted_ndims=(1,
-00022780: 292c 0a20 2020 2020 2020 2020 2020 2061  ),.            a
-00022790: 6363 6570 7465 645f 6474 7970 6573 3d28  ccepted_dtypes=(
-000227a0: 6e70 2e69 6e74 3634 2c20 6e70 2e69 6e74  np.int64, np.int
-000227b0: 3332 2c20 696e 7429 2c0a 2020 2020 2020  32, int),.      
-000227c0: 2020 2020 2020 6163 6365 7074 6564 5f73        accepted_s
-000227d0: 6861 7065 733d 5b28 782e 7368 6170 655b  hapes=[(x.shape[
-000227e0: 305d 2c29 5d2c 0a20 2020 2020 2020 2029  0],)],.        )
-000227f0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00022800: 666f 776c 6b65 735f 6d61 6c6c 6f77 735f  fowlkes_mallows_
-00022810: 7363 6f72 6528 6c61 6265 6c73 5f74 7275  score(labels_tru
-00022820: 653d 782c 206c 6162 656c 735f 7072 6564  e=x, labels_pred
-00022830: 3d79 290a 0a20 2020 2040 7374 6174 6963  =y)..    @static
-00022840: 6d65 7468 6f64 0a20 2020 2064 6566 2061  method.    def a
-00022850: 646a 7573 7465 645f 6d75 7475 616c 5f69  djusted_mutual_i
-00022860: 6e66 6f28 783a 206e 702e 6e64 6172 7261  nfo(x: np.ndarra
-00022870: 792c 2079 3a20 6e70 2e6e 6461 7272 6179  y, y: np.ndarray
-00022880: 2920 2d3e 2066 6c6f 6174 3a0a 2020 2020  ) -> float:.    
-00022890: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000228a0: 4361 6c63 756c 6174 6520 7468 6520 4164  Calculate the Ad
-000228b0: 6a75 7374 6564 204d 7574 7561 6c20 496e  justed Mutual In
-000228c0: 666f 726d 6174 696f 6e20 2841 4d49 2920  formation (AMI) 
-000228d0: 6265 7477 6565 6e20 7477 6f20 636c 7573  between two clus
-000228e0: 7465 7269 6e67 7320 6173 2061 206d 6561  terings as a mea
-000228f0: 7373 7572 6520 6f66 2073 696d 696c 6172  ssure of similar
-00022900: 6974 792e 0a20 2020 2020 2020 2063 6c75  ity..        clu
-00022910: 7374 6572 696e 6773 2e0a 0a20 2020 2020  sterings...     
-00022920: 2020 203a 7061 7261 6d20 6e70 2e6e 6461     :param np.nda
-00022930: 7272 6179 2078 3a20 3144 2061 7272 6179  rray x: 1D array
-00022940: 2072 6570 7265 7365 6e74 696e 6720 7468   representing th
-00022950: 6520 6c61 6265 6c73 206f 6620 7468 6520  e labels of the 
-00022960: 6669 7273 7420 6d6f 6465 6c2e 0a20 2020  first model..   
-00022970: 2020 2020 203a 7061 7261 6d20 6e70 2e6e       :param np.n
-00022980: 6461 7272 6179 2079 3a20 3144 2061 7272  darray y: 1D arr
-00022990: 6179 2072 6570 7265 7365 6e74 696e 6720  ay representing 
-000229a0: 7468 6520 6c61 6265 6c73 206f 6620 7468  the labels of th
-000229b0: 6520 7365 636f 6e64 206d 6f64 656c 2e0a  e second model..
-000229c0: 2020 2020 2020 2020 3a72 6574 7572 6e20          :return 
-000229d0: 666c 6f61 743a 2053 636f 7265 2062 6574  float: Score bet
-000229e0: 7765 656e 2030 2061 6e64 2031 2c20 7768  ween 0 and 1, wh
-000229f0: 6572 6520 3120 696e 6469 6361 7465 7320  ere 1 indicates 
-00022a00: 7065 7266 6563 7420 636c 7573 7465 7269  perfect clusteri
-00022a10: 6e67 2061 6772 6565 6d65 6e74 2e0a 0a20  ng agreement... 
-00022a20: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00022a30: 2020 2063 6865 636b 5f76 616c 6964 5f61     check_valid_a
-00022a40: 7272 6179 280a 2020 2020 2020 2020 2020  rray(.          
-00022a50: 2020 6461 7461 3d78 2c0a 2020 2020 2020    data=x,.      
-00022a60: 2020 2020 2020 736f 7572 6365 3d53 7461        source=Sta
-00022a70: 7469 7374 6963 732e 6164 6a75 7374 6564  tistics.adjusted
-00022a80: 5f6d 7574 7561 6c5f 696e 666f 2e5f 5f6e  _mutual_info.__n
-00022a90: 616d 655f 5f2c 0a20 2020 2020 2020 2020  ame__,.         
-00022aa0: 2020 2061 6363 6570 7465 645f 6e64 696d     accepted_ndim
-00022ab0: 733d 2831 2c29 2c0a 2020 2020 2020 2020  s=(1,),.        
-00022ac0: 2020 2020 6163 6365 7074 6564 5f64 7479      accepted_dty
-00022ad0: 7065 733d 286e 702e 696e 7436 342c 206e  pes=(np.int64, n
-00022ae0: 702e 696e 7433 322c 2069 6e74 292c 0a20  p.int32, int),. 
-00022af0: 2020 2020 2020 2020 2020 206d 696e 5f61             min_a
-00022b00: 7869 735f 303d 312c 0a20 2020 2020 2020  xis_0=1,.       
-00022b10: 2029 0a20 2020 2020 2020 2063 6865 636b   ).        check
-00022b20: 5f76 616c 6964 5f61 7272 6179 280a 2020  _valid_array(.  
-00022b30: 2020 2020 2020 2020 2020 6461 7461 3d79            data=y
-00022b40: 2c0a 2020 2020 2020 2020 2020 2020 736f  ,.            so
-00022b50: 7572 6365 3d53 7461 7469 7374 6963 732e  urce=Statistics.
-00022b60: 6164 6a75 7374 6564 5f6d 7574 7561 6c5f  adjusted_mutual_
-00022b70: 696e 666f 2e5f 5f6e 616d 655f 5f2c 0a20  info.__name__,. 
-00022b80: 2020 2020 2020 2020 2020 2061 6363 6570             accep
-00022b90: 7465 645f 6e64 696d 733d 2831 2c29 2c0a  ted_ndims=(1,),.
-00022ba0: 2020 2020 2020 2020 2020 2020 6163 6365              acce
-00022bb0: 7074 6564 5f64 7479 7065 733d 286e 702e  pted_dtypes=(np.
-00022bc0: 696e 7436 342c 206e 702e 696e 7433 322c  int64, np.int32,
-00022bd0: 2069 6e74 292c 0a20 2020 2020 2020 2020   int),.         
-00022be0: 2020 2061 6363 6570 7465 645f 7368 6170     accepted_shap
-00022bf0: 6573 3d5b 2878 2e73 6861 7065 5b30 5d2c  es=[(x.shape[0],
-00022c00: 295d 2c0a 2020 2020 2020 2020 290a 2020  )],.        ).  
-00022c10: 2020 2020 2020 7265 7475 726e 2061 646a        return adj
-00022c20: 7573 7465 645f 6d75 7475 616c 5f69 6e66  usted_mutual_inf
-00022c30: 6f5f 7363 6f72 6528 6c61 6265 6c73 5f74  o_score(labels_t
-00022c40: 7275 653d 782c 206c 6162 656c 735f 7072  rue=x, labels_pr
-00022c50: 6564 3d79 290a 0a0a 2320 7361 6d70 6c65  ed=y)...# sample
-00022c60: 5f31 203d 206e 702e 7261 6e64 6f6d 2e72  _1 = np.random.r
-00022c70: 616e 646f 6d5f 696e 7465 6765 7273 286c  andom_integers(l
-00022c80: 6f77 3d31 2c20 6869 6768 3d32 2c20 7369  ow=1, high=2, si
-00022c90: 7a65 3d28 3130 2c20 3530 2929 2e61 7374  ze=(10, 50)).ast
-00022ca0: 7970 6528 6e70 2e66 6c6f 6174 3634 290a  ype(np.float64).
-00022cb0: 2320 7361 6d70 6c65 5f32 203d 206e 702e  # sample_2 = np.
-00022cc0: 7261 6e64 6f6d 2e72 616e 646f 6d5f 696e  random.random_in
-00022cd0: 7465 6765 7273 286c 6f77 3d37 2c20 6869  tegers(low=7, hi
-00022ce0: 6768 3d32 302c 2073 697a 653d 2831 302c  gh=20, size=(10,
-00022cf0: 2035 3029 292e 6173 7479 7065 286e 702e   50)).astype(np.
-00022d00: 666c 6f61 7436 3429 0a23 2064 6174 6120  float64).# data 
-00022d10: 3d20 6e70 2e76 7374 6163 6b28 5b73 616d  = np.vstack([sam
-00022d20: 706c 655f 312c 2073 616d 706c 655f 325d  ple_1, sample_2]
-00022d30: 290a 2320 5374 6174 6973 7469 6373 2829  ).# Statistics()
-00022d40: 2e68 626f 7328 6461 7461 3d64 6174 6129  .hbos(data=data)
-00022d50: 0a0a 2320 7361 6d70 6c65 5f31 203d 206e  ..# sample_1 = n
-00022d60: 702e 7261 6e64 6f6d 2e6e 6f72 6d61 6c28  p.random.normal(
-00022d70: 6c6f 633d 3130 2c20 7363 616c 653d 322c  loc=10, scale=2,
-00022d80: 2073 697a 653d 3130 3030 292e 6173 7479   size=1000).asty
-00022d90: 7065 286e 702e 666c 6f61 7436 3429 0a23  pe(np.float64).#
-00022da0: 2073 616d 706c 655f 3220 3d20 6e70 2e72   sample_2 = np.r
-00022db0: 616e 646f 6d2e 6e6f 726d 616c 286c 6f63  andom.normal(loc
-00022dc0: 3d31 322c 2073 6361 6c65 3d32 2c20 7369  =12, scale=2, si
-00022dd0: 7a65 3d31 3030 3030 292e 6173 7479 7065  ze=10000).astype
-00022de0: 286e 702e 666c 6f61 7436 3429 0a0a 2320  (np.float64)..# 
-00022df0: 7361 6d70 6c65 5f31 203d 206e 702e 7261  sample_1 = np.ra
-00022e00: 6e64 6f6d 2e72 616e 6469 6e74 2830 2c20  ndom.randint(0, 
-00022e10: 3130 302c 2028 3130 302c 2029 292e 6173  100, (100, )).as
-00022e20: 7479 7065 286e 702e 666c 6f61 7436 3429  type(np.float64)
-00022e30: 0a23 2073 616d 706c 655f 3220 3d20 6e70  .# sample_2 = np
-00022e40: 2e72 616e 646f 6d2e 7261 6e64 696e 7428  .random.randint(
-00022e50: 3131 302c 2032 3030 2c20 2831 3030 2c20  110, 200, (100, 
-00022e60: 2929 2e61 7374 7970 6528 6e70 2e66 6c6f  )).astype(np.flo
-00022e70: 6174 3634 290a 230a 2320 5374 6174 6973  at64).#.# Statis
-00022e80: 7469 6373 2829 2e6a 656e 7365 6e5f 7368  tics().jensen_sh
-00022e90: 616e 6e6f 6e5f 6469 7665 7267 656e 6365  annon_divergence
-00022ea0: 2873 616d 706c 655f 313d 7361 6d70 6c65  (sample_1=sample
-00022eb0: 5f31 2c20 7361 6d70 6c65 5f32 3d73 616d  _1, sample_2=sam
-00022ec0: 706c 655f 3229 0a                        ple_2).
+00019ba0: 202a 2028 636e 745f 305f 3020 2b20 636e   * (cnt_0_0 + cn
+00019bb0: 745f 305f 3129 0a20 2020 2020 2020 2020  t_0_1).         
+00019bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019bd0: 2020 202a 2028 636e 745f 315f 3020 2b20     * (cnt_1_0 + 
+00019be0: 636e 745f 305f 3029 0a20 2020 2020 2020  cnt_0_0).       
+00019bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019c00: 2020 2020 202a 2028 636e 745f 315f 3120       * (cnt_1_1 
+00019c10: 2a20 636e 745f 305f 3129 0a20 2020 2020  * cnt_0_1).     
+00019c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019c30: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00019c40: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+00019c50: 2020 2020 7265 7475 726e 2072 6573 756c      return resul
+00019c60: 7473 2e61 7374 7970 6528 6e70 2e66 6c6f  ts.astype(np.flo
+00019c70: 6174 3332 290a 0a20 2020 2040 7374 6174  at32)..    @stat
+00019c80: 6963 6d65 7468 6f64 0a20 2020 2040 6e6a  icmethod.    @nj
+00019c90: 6974 2822 696e 7436 345b 3a5d 2c20 696e  it("int64[:], in
+00019ca0: 7436 345b 3a5d 2c22 290a 2020 2020 6465  t64[:],").    de
+00019cb0: 6620 636f 6865 6e73 5f68 2873 616d 706c  f cohens_h(sampl
+00019cc0: 655f 313a 206e 702e 6e64 6172 7261 792c  e_1: np.ndarray,
+00019cd0: 2073 616d 706c 655f 323a 206e 702e 6e64   sample_2: np.nd
+00019ce0: 6172 7261 7929 202d 3e20 666c 6f61 743a  array) -> float:
+00019cf0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00019d00: 2020 2020 204a 6974 7465 6420 636f 6d70       Jitted comp
+00019d10: 7574 6520 436f 6865 6e27 7320 6820 6566  ute Cohen's h ef
+00019d20: 6665 6374 2073 697a 6520 666f 7220 7477  fect size for tw
+00019d30: 6f20 7361 6d70 6c65 7320 6f66 2062 696e  o samples of bin
+00019d40: 6172 7920 5b30 2c20 315d 2076 616c 7565  ary [0, 1] value
+00019d50: 732e 2043 6f68 656e 2773 2068 2069 7320  s. Cohen's h is 
+00019d60: 6120 6d65 6173 7572 6520 6f66 2065 6666  a measure of eff
+00019d70: 6563 7420 7369 7a65 0a20 2020 2020 2020  ect size.       
+00019d80: 2066 6f72 2063 6f6d 7061 7269 6e67 2074   for comparing t
+00019d90: 776f 2069 6e64 6570 656e 6465 6e74 2073  wo independent s
+00019da0: 616d 706c 6573 2062 6173 6564 206f 6e20  amples based on 
+00019db0: 7468 6520 6469 6666 6572 656e 6365 7320  the differences 
+00019dc0: 696e 2070 726f 706f 7274 696f 6e73 206f  in proportions o
+00019dd0: 6620 7468 6520 7477 6f20 7361 6d70 6c65  f the two sample
+00019de0: 732e 0a0a 2020 2020 2020 2020 2e2e 206e  s...        .. n
+00019df0: 6f74 653a 0a20 2020 2020 2020 2020 2020  ote:.           
+00019e00: 4d6f 6469 6669 6564 2066 726f 6d20 6044  Modified from `D
+00019e10: 4142 4553 5420 3c68 7474 7073 3a2f 2f67  ABEST <https://g
+00019e20: 6974 6875 622e 636f 6d2f 4143 434c 4142  ithub.com/ACCLAB
+00019e30: 2f44 4142 4553 542d 7079 7468 6f6e 2f62  /DABEST-python/b
+00019e40: 6c6f 622f 6661 3764 6635 3064 3230 6162  lob/fa7df50d20ab
+00019e50: 3163 3963 6336 3837 6336 3664 6438 6264  1c9cc687c66dd8bd
+00019e60: 6466 3535 6439 6139 6463 6533 2f64 6162  df55d9a9dce3/dab
+00019e70: 6573 742f 5f73 7461 7473 5f74 6f6f 6c73  est/_stats_tools
+00019e80: 2f65 6666 7369 7a65 2e70 7923 4c32 3136  /effsize.py#L216
+00019e90: 3e60 5f0a 2020 2020 2020 2020 2020 2060  >`_.           `
+00019ea0: 436f 6865 6e27 7320 6820 7769 6b69 203c  Cohen's h wiki <
+00019eb0: 6874 7470 733a 2f2f 656e 2e77 696b 6970  https://en.wikip
+00019ec0: 6564 6961 2e6f 7267 2f77 696b 692f 436f  edia.org/wiki/Co
+00019ed0: 6865 6e25 3237 735f 683e 605f 0a0a 2020  hen%27s_h>`_..  
+00019ee0: 2020 2020 2020 2e2e 206d 6174 683a 3a0a        .. math::.
+00019ef0: 0a20 2020 2020 2020 2020 2020 5c5c 7465  .           \\te
+00019f00: 7874 7b43 6f68 656e 2773 2068 7d20 3d20  xt{Cohen's h} = 
+00019f10: 3220 5c5c 6172 6373 696e 5c5c 6c65 6674  2 \\arcsin\\left
+00019f20: 285c 5c73 7172 747b 5c5c 6672 6163 7b5c  (\\sqrt{\\frac{\
+00019f30: 5c73 756d 7b73 616d 706c 655f 317d 7d7b  \sum{sample_1}}{
+00019f40: 4e5f 317d 7d5c 5c72 6967 6874 2920 2d20  N_1}}\\right) - 
+00019f50: 3220 5c5c 6172 6373 696e 5c6c 6566 7428  2 \\arcsin\left(
+00019f60: 5c5c 7371 7274 7b5c 6672 6163 7b5c 5c73  \\sqrt{\frac{\\s
+00019f70: 756d 7b73 616d 706c 655f 327d 7d7b 4e5f  um{sample_2}}{N_
+00019f80: 327d 7d5c 5c72 6967 6874 290a 0a20 2020  2}}\\right)..   
+00019f90: 2020 2020 2057 6865 7265 204e 5f31 2061       Where N_1 a
+00019fa0: 6e64 204e 5f32 2061 7265 2074 6865 2073  nd N_2 are the s
+00019fb0: 616d 706c 6520 7369 7a65 7320 6f66 2073  ample sizes of s
+00019fc0: 616d 706c 655f 3120 616e 6420 7361 6d70  ample_1 and samp
+00019fd0: 6c65 5f32 2c20 7265 7370 6563 7469 7665  le_2, respective
+00019fe0: 6c79 2e0a 0a20 2020 2020 2020 203a 7061  ly...        :pa
+00019ff0: 7261 6d20 6e70 2e6e 6461 7272 6179 2073  ram np.ndarray s
+0001a000: 616d 706c 655f 313a 2031 4420 6172 7261  ample_1: 1D arra
+0001a010: 7920 7769 7468 2062 696e 6172 7920 5b30  y with binary [0
+0001a020: 2c20 315d 2076 616c 7565 7320 2865 2e67  , 1] values (e.g
+0001a030: 2e2c 2066 6972 7374 2063 6c61 7373 6966  ., first classif
+0001a040: 6965 7220 696e 6665 7265 6e63 6520 7661  ier inference va
+0001a050: 6c75 6573 292e 0a20 2020 2020 2020 203a  lues)..        :
+0001a060: 7061 7261 6d20 6e70 2e6e 6461 7272 6179  param np.ndarray
+0001a070: 2073 616d 706c 655f 323a 2031 4420 6172   sample_2: 1D ar
+0001a080: 7261 7920 7769 7468 2062 696e 6172 7920  ray with binary 
+0001a090: 5b30 2c20 315d 2076 616c 7565 7320 2865  [0, 1] values (e
+0001a0a0: 2e67 2e2c 2073 6563 6f6e 6420 636c 6173  .g., second clas
+0001a0b0: 7369 6669 6572 2069 6e66 6572 656e 6365  sifier inference
+0001a0c0: 2076 616c 7565 7329 2e0a 2020 2020 2020   values)..      
+0001a0d0: 2020 3a72 6574 7572 6e20 666c 6f61 743a    :return float:
+0001a0e0: 2043 6f68 656e 2773 2068 2065 6666 6563   Cohen's h effec
+0001a0f0: 7420 7369 7a65 2e0a 0a20 2020 2020 2020  t size...       
+0001a100: 203a 6578 616d 706c 653a 0a20 2020 2020   :example:.     
+0001a110: 2020 203e 3e3e 2073 616d 706c 655f 3120     >>> sample_1 
+0001a120: 3d20 6e70 2e61 7272 6179 285b 312c 2030  = np.array([1, 0
+0001a130: 2c20 302c 2031 5d29 0a20 2020 2020 2020  , 0, 1]).       
+0001a140: 203e 3e3e 2073 616d 706c 655f 3220 3d20   >>> sample_2 = 
+0001a150: 6e70 2e61 7272 6179 285b 312c 2031 2c20  np.array([1, 1, 
+0001a160: 312c 2030 5d29 0a20 2020 2020 2020 203e  1, 0]).        >
+0001a170: 3e3e 2053 7461 7469 7374 6963 7328 292e  >> Statistics().
+0001a180: 636f 6865 6e73 5f68 2873 616d 706c 655f  cohens_h(sample_
+0001a190: 313d 7361 6d70 6c65 5f31 2c20 7361 6d70  1=sample_1, samp
+0001a1a0: 6c65 5f32 3d73 616d 706c 655f 3229 0a20  le_2=sample_2). 
+0001a1b0: 2020 2020 2020 203e 3e3e 202d 302e 3532         >>> -0.52
+0001a1c0: 3335 3938 3737 3535 3938 3239 3835 0a20  35987755982985. 
+0001a1d0: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+0001a1e0: 2020 2020 7361 6d70 6c65 5f31 5f70 726f      sample_1_pro
+0001a1f0: 706f 7274 696f 6e20 3d20 6e70 2e73 756d  portion = np.sum
+0001a200: 2873 616d 706c 655f 3129 202f 2073 616d  (sample_1) / sam
+0001a210: 706c 655f 312e 7368 6170 655b 305d 0a20  ple_1.shape[0]. 
+0001a220: 2020 2020 2020 2073 616d 706c 655f 325f         sample_2_
+0001a230: 7072 6f70 6f72 7469 6f6e 203d 206e 702e  proportion = np.
+0001a240: 7375 6d28 7361 6d70 6c65 5f32 2920 2f20  sum(sample_2) / 
+0001a250: 7361 6d70 6c65 5f32 2e73 6861 7065 5b30  sample_2.shape[0
+0001a260: 5d0a 2020 2020 2020 2020 7068 695f 7361  ].        phi_sa
+0001a270: 6d70 6c65 5f31 203d 2032 202a 206e 702e  mple_1 = 2 * np.
+0001a280: 6172 6373 696e 286e 702e 7371 7274 2873  arcsin(np.sqrt(s
+0001a290: 616d 706c 655f 315f 7072 6f70 6f72 7469  ample_1_proporti
+0001a2a0: 6f6e 2929 0a20 2020 2020 2020 2070 6869  on)).        phi
+0001a2b0: 5f73 616d 706c 655f 3220 3d20 3220 2a20  _sample_2 = 2 * 
+0001a2c0: 6e70 2e61 7263 7369 6e28 6e70 2e73 7172  np.arcsin(np.sqr
+0001a2d0: 7428 7361 6d70 6c65 5f32 5f70 726f 706f  t(sample_2_propo
+0001a2e0: 7274 696f 6e29 290a 0a20 2020 2020 2020  rtion))..       
+0001a2f0: 2072 6574 7572 6e20 7068 695f 7361 6d70   return phi_samp
+0001a300: 6c65 5f31 202d 2070 6869 5f73 616d 706c  le_1 - phi_sampl
+0001a310: 655f 320a 0a20 2020 2040 7374 6174 6963  e_2..    @static
+0001a320: 6d65 7468 6f64 0a20 2020 2040 6a69 7428  method.    @jit(
+0001a330: 2228 666c 6f61 7433 325b 3a5d 2c20 666c  "(float32[:], fl
+0001a340: 6f61 7436 345b 3a5d 2c20 696e 7436 342c  oat64[:], int64,
+0001a350: 2922 290a 2020 2020 6465 6620 736c 6964  )").    def slid
+0001a360: 696e 675f 736b 6577 280a 2020 2020 2020  ing_skew(.      
+0001a370: 2020 6461 7461 3a20 6e70 2e6e 6461 7272    data: np.ndarr
+0001a380: 6179 2c20 7469 6d65 5f77 696e 646f 7773  ay, time_windows
+0001a390: 3a20 6e70 2e6e 6461 7272 6179 2c20 7361  : np.ndarray, sa
+0001a3a0: 6d70 6c65 5f72 6174 653a 2069 6e74 0a20  mple_rate: int. 
+0001a3b0: 2020 2029 202d 3e20 6e70 2e6e 6461 7272     ) -> np.ndarr
+0001a3c0: 6179 3a0a 2020 2020 2020 2020 2222 220a  ay:.        """.
+0001a3d0: 2020 2020 2020 2020 436f 6d70 7574 6520          Compute 
+0001a3e0: 7468 6520 736b 6577 6e65 7373 206f 6620  the skewness of 
+0001a3f0: 6120 3144 2061 7272 6179 2077 6974 6869  a 1D array withi
+0001a400: 6e20 736c 6964 696e 6720 7469 6d65 2077  n sliding time w
+0001a410: 696e 646f 7773 2e0a 0a20 2020 2020 2020  indows...       
+0001a420: 203a 7061 7261 6d20 6e70 2e6e 6461 7272   :param np.ndarr
+0001a430: 6179 2064 6174 613a 2049 6e70 7574 2064  ay data: Input d
+0001a440: 6174 6120 6172 7261 792e 0a20 2020 2020  ata array..     
+0001a450: 2020 203a 7061 7261 6d20 6e70 2e6e 6461     :param np.nda
+0001a460: 7272 6179 2064 6174 613a 2031 4420 6172  rray data: 1D ar
+0001a470: 7261 7920 6f66 2074 696d 6520 7769 6e64  ray of time wind
+0001a480: 6f77 2064 7572 6174 696f 6e73 2069 6e20  ow durations in 
+0001a490: 7365 636f 6e64 732e 0a20 2020 2020 2020  seconds..       
+0001a4a0: 203a 7061 7261 6d20 6e70 2e6e 6461 7272   :param np.ndarr
+0001a4b0: 6179 2064 6174 613a 2053 616d 706c 696e  ay data: Samplin
+0001a4c0: 6720 7261 7465 206f 6620 7468 6520 6461  g rate of the da
+0001a4d0: 7461 2069 6e20 7361 6d70 6c65 7320 7065  ta in samples pe
+0001a4e0: 7220 7365 636f 6e64 2e0a 2020 2020 2020  r second..      
+0001a4f0: 2020 3a72 6574 7572 6e20 6e70 2e6e 6461    :return np.nda
+0001a500: 7272 6179 3a20 3244 2061 7272 6179 206f  rray: 2D array o
+0001a510: 6620 736b 6577 6e65 7373 6031 2076 616c  f skewness`1 val
+0001a520: 7565 7320 7769 7468 2072 6f77 7320 636f  ues with rows co
+0001a530: 7272 6573 706f 6e64 696e 6720 746f 2064  rresponding to d
+0001a540: 6174 6120 706f 696e 7473 2061 6e64 2063  ata points and c
+0001a550: 6f6c 756d 6e73 2063 6f72 7265 7370 6f6e  olumns correspon
+0001a560: 6469 6e67 2074 6f20 7469 6d65 2077 696e  ding to time win
+0001a570: 646f 7773 2e0a 0a20 2020 2020 2020 203a  dows...        :
+0001a580: 6578 616d 706c 653a 0a20 2020 2020 2020  example:.       
+0001a590: 203e 3e3e 2064 6174 6120 3d20 6e70 2e72   >>> data = np.r
+0001a5a0: 616e 646f 6d2e 7261 6e64 696e 7428 302c  andom.randint(0,
+0001a5b0: 2031 3030 2c20 2831 302c 2929 0a20 2020   100, (10,)).   
+0001a5c0: 2020 2020 203e 3e3e 2073 6b65 776e 6573       >>> skewnes
+0001a5d0: 7320 3d20 5374 6174 6973 7469 6373 2829  s = Statistics()
+0001a5e0: 2e73 6c69 6469 6e67 5f73 6b65 7728 6461  .sliding_skew(da
+0001a5f0: 7461 3d64 6174 612e 6173 7479 7065 286e  ta=data.astype(n
+0001a600: 702e 666c 6f61 7433 3229 2c20 7469 6d65  p.float32), time
+0001a610: 5f77 696e 646f 7773 3d6e 702e 6172 7261  _windows=np.arra
+0001a620: 7928 5b31 2e30 2c20 322e 305d 292c 2073  y([1.0, 2.0]), s
+0001a630: 616d 706c 655f 7261 7465 3d32 290a 2020  ample_rate=2).  
+0001a640: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+0001a650: 2020 2072 6573 756c 7473 203d 206e 702e     results = np.
+0001a660: 6675 6c6c 2828 6461 7461 2e73 6861 7065  full((data.shape
+0001a670: 5b30 5d2c 2074 696d 655f 7769 6e64 6f77  [0], time_window
+0001a680: 732e 7368 6170 655b 305d 292c 2030 2e30  s.shape[0]), 0.0
+0001a690: 290a 2020 2020 2020 2020 666f 7220 6920  ).        for i 
+0001a6a0: 696e 2070 7261 6e67 6528 7469 6d65 5f77  in prange(time_w
+0001a6b0: 696e 646f 7773 2e73 6861 7065 5b30 5d29  indows.shape[0])
+0001a6c0: 3a0a 2020 2020 2020 2020 2020 2020 7769  :.            wi
+0001a6d0: 6e64 6f77 5f73 697a 6520 3d20 696e 7428  ndow_size = int(
+0001a6e0: 7469 6d65 5f77 696e 646f 7773 5b69 5d20  time_windows[i] 
+0001a6f0: 2a20 7361 6d70 6c65 5f72 6174 6529 0a20  * sample_rate). 
+0001a700: 2020 2020 2020 2020 2020 2066 6f72 206a             for j
+0001a710: 2069 6e20 7261 6e67 6528 7769 6e64 6f77   in range(window
+0001a720: 5f73 697a 652c 2064 6174 612e 7368 6170  _size, data.shap
+0001a730: 655b 305d 202b 2031 293a 0a20 2020 2020  e[0] + 1):.     
+0001a740: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
+0001a750: 6520 3d20 6461 7461 5b6a 202d 2077 696e  e = data[j - win
+0001a760: 646f 775f 7369 7a65 203a 206a 5d0a 2020  dow_size : j].  
+0001a770: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+0001a780: 616e 2c20 7374 6420 3d20 6e70 2e6d 6561  an, std = np.mea
+0001a790: 6e28 7361 6d70 6c65 292c 206e 702e 7374  n(sample), np.st
+0001a7a0: 6428 7361 6d70 6c65 290a 2020 2020 2020  d(sample).      
+0001a7b0: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+0001a7c0: 735b 6a20 2d20 315d 5b69 5d20 3d20 2831  s[j - 1][i] = (1
+0001a7d0: 202f 2073 616d 706c 652e 7368 6170 655b   / sample.shape[
+0001a7e0: 305d 2920 2a20 6e70 2e73 756d 280a 2020  0]) * np.sum(.  
+0001a7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a800: 2020 2828 6461 7461 202d 206d 6561 6e29    ((data - mean)
+0001a810: 202f 2073 7464 2920 2a2a 2033 0a20 2020   / std) ** 3.   
+0001a820: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+0001a830: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+0001a840: 6573 756c 7473 0a0a 2020 2020 4073 7461  esults..    @sta
+0001a850: 7469 636d 6574 686f 640a 2020 2020 406a  ticmethod.    @j
+0001a860: 6974 2822 2866 6c6f 6174 3332 5b3a 5d2c  it("(float32[:],
+0001a870: 2066 6c6f 6174 3634 5b3a 5d2c 2069 6e74   float64[:], int
+0001a880: 3634 2c29 2229 0a20 2020 2064 6566 2073  64,)").    def s
+0001a890: 6c69 6469 6e67 5f6b 7572 746f 7369 7328  liding_kurtosis(
+0001a8a0: 0a20 2020 2020 2020 2064 6174 613a 206e  .        data: n
+0001a8b0: 702e 6e64 6172 7261 792c 2074 696d 655f  p.ndarray, time_
+0001a8c0: 7769 6e64 6f77 733a 206e 702e 6e64 6172  windows: np.ndar
+0001a8d0: 7261 792c 2073 616d 706c 655f 7261 7465  ray, sample_rate
+0001a8e0: 3a20 696e 740a 2020 2020 2920 2d3e 206e  : int.    ) -> n
+0001a8f0: 702e 6e64 6172 7261 793a 0a20 2020 2020  p.ndarray:.     
+0001a900: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
+0001a910: 6f6d 7075 7465 2074 6865 206b 7572 746f  ompute the kurto
+0001a920: 7369 7320 6f66 2061 2031 4420 6172 7261  sis of a 1D arra
+0001a930: 7920 7769 7468 696e 2073 6c69 6469 6e67  y within sliding
+0001a940: 2074 696d 6520 7769 6e64 6f77 732e 0a0a   time windows...
+0001a950: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
+0001a960: 702e 6e64 6172 7261 7920 6461 7461 3a20  p.ndarray data: 
+0001a970: 496e 7075 7420 6461 7461 2061 7272 6179  Input data array
+0001a980: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0001a990: 206e 702e 6e64 6172 7261 7920 7469 6d65   np.ndarray time
+0001a9a0: 5f77 696e 646f 7773 3a20 3144 2061 7272  _windows: 1D arr
+0001a9b0: 6179 206f 6620 7469 6d65 2077 696e 646f  ay of time windo
+0001a9c0: 7720 6475 7261 7469 6f6e 7320 696e 2073  w durations in s
+0001a9d0: 6563 6f6e 6473 2e0a 2020 2020 2020 2020  econds..        
+0001a9e0: 3a70 6172 616d 206e 702e 6e64 6172 7261  :param np.ndarra
+0001a9f0: 7920 7361 6d70 6c65 5f72 6174 653a 2053  y sample_rate: S
+0001aa00: 616d 706c 696e 6720 7261 7465 206f 6620  ampling rate of 
+0001aa10: 7468 6520 6461 7461 2069 6e20 7361 6d70  the data in samp
+0001aa20: 6c65 7320 7065 7220 7365 636f 6e64 2e0a  les per second..
+0001aa30: 2020 2020 2020 2020 3a72 6574 7572 6e20          :return 
+0001aa40: 6e70 2e6e 6461 7272 6179 3a20 3244 2061  np.ndarray: 2D a
+0001aa50: 7272 6179 206f 6620 736b 6577 6e65 7373  rray of skewness
+0001aa60: 6031 2076 616c 7565 7320 7769 7468 2072  `1 values with r
+0001aa70: 6f77 7320 636f 7272 6573 706f 6e64 696e  ows correspondin
+0001aa80: 6720 746f 2064 6174 6120 706f 696e 7473  g to data points
+0001aa90: 2061 6e64 2063 6f6c 756d 6e73 2063 6f72   and columns cor
+0001aaa0: 7265 7370 6f6e 6469 6e67 2074 6f20 7469  responding to ti
+0001aab0: 6d65 2077 696e 646f 7773 2e0a 0a20 2020  me windows...   
+0001aac0: 2020 2020 203a 6578 616d 706c 653a 0a20       :example:. 
+0001aad0: 2020 2020 2020 203e 3e3e 2064 6174 6120         >>> data 
+0001aae0: 3d20 6e70 2e72 616e 646f 6d2e 7261 6e64  = np.random.rand
+0001aaf0: 696e 7428 302c 2031 3030 2c20 2831 302c  int(0, 100, (10,
+0001ab00: 2929 0a20 2020 2020 2020 203e 3e3e 206b  )).        >>> k
+0001ab10: 7572 746f 7369 7320 3d20 5374 6174 6973  urtosis = Statis
+0001ab20: 7469 6373 2829 2e73 6c69 6469 6e67 5f6b  tics().sliding_k
+0001ab30: 7572 746f 7369 7328 6461 7461 3d64 6174  urtosis(data=dat
+0001ab40: 612e 6173 7479 7065 286e 702e 666c 6f61  a.astype(np.floa
+0001ab50: 7433 3229 2c20 7469 6d65 5f77 696e 646f  t32), time_windo
+0001ab60: 7773 3d6e 702e 6172 7261 7928 5b31 2e30  ws=np.array([1.0
+0001ab70: 2c20 322e 305d 292c 2073 616d 706c 655f  , 2.0]), sample_
+0001ab80: 7261 7465 3d32 290a 2020 2020 2020 2020  rate=2).        
+0001ab90: 2222 220a 2020 2020 2020 2020 7265 7375  """.        resu
+0001aba0: 6c74 7320 3d20 6e70 2e66 756c 6c28 2864  lts = np.full((d
+0001abb0: 6174 612e 7368 6170 655b 305d 2c20 7469  ata.shape[0], ti
+0001abc0: 6d65 5f77 696e 646f 7773 2e73 6861 7065  me_windows.shape
+0001abd0: 5b30 5d29 2c20 302e 3029 0a20 2020 2020  [0]), 0.0).     
+0001abe0: 2020 2066 6f72 2069 2069 6e20 7072 616e     for i in pran
+0001abf0: 6765 2874 696d 655f 7769 6e64 6f77 732e  ge(time_windows.
+0001ac00: 7368 6170 655b 305d 293a 0a20 2020 2020  shape[0]):.     
+0001ac10: 2020 2020 2020 2077 696e 646f 775f 7369         window_si
+0001ac20: 7a65 203d 2074 696d 655f 7769 6e64 6f77  ze = time_window
+0001ac30: 735b 695d 202a 2073 616d 706c 655f 7261  s[i] * sample_ra
+0001ac40: 7465 0a20 2020 2020 2020 2020 2020 2066  te.            f
+0001ac50: 6f72 206a 2069 6e20 7261 6e67 6528 7769  or j in range(wi
+0001ac60: 6e64 6f77 5f73 697a 652c 2064 6174 612e  ndow_size, data.
+0001ac70: 7368 6170 655b 305d 202b 2031 293a 0a20  shape[0] + 1):. 
+0001ac80: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001ac90: 616d 706c 6520 3d20 6461 7461 5b6a 202d  ample = data[j -
+0001aca0: 2077 696e 646f 775f 7369 7a65 203a 206a   window_size : j
+0001acb0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0001acc0: 2020 6d65 616e 2c20 7374 6420 3d20 6e70    mean, std = np
+0001acd0: 2e6d 6561 6e28 7361 6d70 6c65 292c 206e  .mean(sample), n
+0001ace0: 702e 7374 6428 7361 6d70 6c65 290a 2020  p.std(sample).  
+0001acf0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0001ad00: 7375 6c74 735b 6a20 2d20 315d 5b69 5d20  sults[j - 1][i] 
+0001ad10: 3d20 6e70 2e6d 6561 6e28 2828 6461 7461  = np.mean(((data
+0001ad20: 202d 206d 6561 6e29 202f 2073 7464 2920   - mean) / std) 
+0001ad30: 2a2a 2034 2920 2d20 330a 2020 2020 2020  ** 4) - 3.      
+0001ad40: 2020 7265 7475 726e 2072 6573 756c 7473    return results
+0001ad50: 0a0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
+0001ad60: 686f 640a 2020 2020 406a 6974 286e 6f70  hod.    @jit(nop
+0001ad70: 7974 686f 6e3d 5472 7565 290a 2020 2020  ython=True).    
+0001ad80: 2320 406e 6a69 7428 5b28 666c 6f61 7433  # @njit([(float3
+0001ad90: 325b 3a5d 2c20 666c 6f61 7436 342c 2069  2[:], float64, i
+0001ada0: 6e74 3634 2c20 626f 6f6c 6561 6e29 2c5d  nt64, boolean),]
+0001adb0: 290a 2020 2020 6465 6620 6b6d 6561 6e73  ).    def kmeans
+0001adc0: 5f31 6428 0a20 2020 2020 2020 2064 6174  _1d(.        dat
+0001add0: 613a 206e 702e 6e64 6172 7261 792c 206b  a: np.ndarray, k
+0001ade0: 3a20 696e 742c 206d 6178 5f69 7465 7273  : int, max_iters
+0001adf0: 3a20 696e 742c 2063 616c 635f 6d65 6469  : int, calc_medi
+0001ae00: 616e 733a 2062 6f6f 6c0a 2020 2020 2920  ans: bool.    ) 
+0001ae10: 2d3e 2054 7570 6c65 5b6e 702e 6e64 6172  -> Tuple[np.ndar
+0001ae20: 7261 792c 206e 702e 6e64 6172 7261 792c  ray, np.ndarray,
+0001ae30: 2055 6e69 6f6e 5b4e 6f6e 652c 2074 7970   Union[None, typ
+0001ae40: 6573 2e44 6963 7454 7970 655d 5d3a 0a20  es.DictType]]:. 
+0001ae50: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0001ae60: 2020 2050 6572 666f 726d 206b 2d6d 6561     Perform k-mea
+0001ae70: 6e73 2063 6c75 7374 6572 696e 6720 6f6e  ns clustering on
+0001ae80: 2061 2031 2d64 696d 656e 7369 6f6e 616c   a 1-dimensional
+0001ae90: 2064 6174 6173 6574 2e0a 0a20 2020 2020   dataset...     
+0001aea0: 2020 203a 7061 7261 6d65 7465 7220 6e70     :parameter np
+0001aeb0: 2e6e 6461 7272 6179 2064 6174 613a 2031  .ndarray data: 1
+0001aec0: 6420 6172 7261 7920 636f 6e74 6169 6e69  d array containi
+0001aed0: 6e67 2066 6561 7475 7265 2076 616c 7565  ng feature value
+0001aee0: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
+0001aef0: 6d65 7465 7220 696e 7420 6b3a 204e 756d  meter int k: Num
+0001af00: 6265 7220 6f66 2063 6c75 7374 6572 732e  ber of clusters.
+0001af10: 0a20 2020 2020 2020 203a 7061 7261 6d65  .        :parame
+0001af20: 7465 7220 696e 7420 6d61 785f 6974 6572  ter int max_iter
+0001af30: 733a 204d 6178 696d 756d 206e 756d 6265  s: Maximum numbe
+0001af40: 7220 6f66 2069 7465 7261 7469 6f6e 7320  r of iterations 
+0001af50: 666f 7220 7468 6520 6b2d 6d65 616e 7320  for the k-means 
+0001af60: 616c 676f 7269 7468 6d2e 0a20 2020 2020  algorithm..     
+0001af70: 2020 203a 7061 7261 6d65 7465 7220 626f     :parameter bo
+0001af80: 6f6c 2063 616c 635f 6d65 6469 616e 733a  ol calc_medians:
+0001af90: 2046 6c61 6720 696e 6469 6361 7469 6e67   Flag indicating
+0001afa0: 2077 6865 7468 6572 2074 6f20 6361 6c63   whether to calc
+0001afb0: 756c 6174 6520 636c 7573 7465 7220 6d65  ulate cluster me
+0001afc0: 6469 616e 732e 0a20 2020 2020 2020 203a  dians..        :
+0001afd0: 7265 7475 726e 7320 5475 706c 653a 2054  returns Tuple: T
+0001afe0: 7570 6c65 206f 6620 7468 7265 6520 656c  uple of three el
+0001aff0: 656d 656e 7473 2e20 4669 6e61 6c20 6365  ements. Final ce
+0001b000: 6e74 726f 6964 7320 6f66 2074 6865 2063  ntroids of the c
+0001b010: 6c75 7374 6572 732e 204c 6162 656c 7320  lusters. Labels 
+0001b020: 6173 7369 676e 6564 2074 6f20 6561 6368  assigned to each
+0001b030: 2064 6174 6120 706f 696e 7420 6261 7365   data point base
+0001b040: 6420 6f6e 2063 6c75 7374 6572 732e 2043  d on clusters. C
+0001b050: 6c75 7374 6572 206d 6564 6961 6e73 2028  luster medians (
+0001b060: 6966 2063 616c 635f 6d65 6469 616e 7320  if calc_medians 
+0001b070: 6973 2054 7275 6529 2c20 6f74 6865 7277  is True), otherw
+0001b080: 6973 6520 4e6f 6e65 2e0a 0a20 2020 2020  ise None...     
+0001b090: 2020 203a 6578 616d 706c 653a 0a20 2020     :example:.   
+0001b0a0: 2020 2020 203e 3e3e 2064 6174 615f 3164       >>> data_1d
+0001b0b0: 203d 206e 702e 6172 7261 7928 5b31 2c20   = np.array([1, 
+0001b0c0: 322c 2033 2c20 3535 2c20 3635 2c20 3430  2, 3, 55, 65, 40
+0001b0d0: 2c20 3433 2c20 3430 5d29 2e61 7374 7970  , 43, 40]).astyp
+0001b0e0: 6528 6e70 2e66 6c6f 6174 3634 290a 2020  e(np.float64).  
+0001b0f0: 2020 2020 2020 3e3e 3e20 6365 6e74 726f        >>> centro
+0001b100: 6964 732c 206c 6162 656c 732c 206d 6564  ids, labels, med
+0001b110: 6961 6e73 203d 2053 7461 7469 7374 6963  ians = Statistic
+0001b120: 7328 292e 6b6d 6561 6e73 5f31 6428 6461  s().kmeans_1d(da
+0001b130: 7461 5f31 642c 2032 2c20 3130 3030 2c20  ta_1d, 2, 1000, 
+0001b140: 5472 7565 290a 2020 2020 2020 2020 2222  True).        ""
+0001b150: 220a 0a20 2020 2020 2020 2064 6174 6120  "..        data 
+0001b160: 3d20 6e70 2e61 7363 6f6e 7469 6775 6f75  = np.ascontiguou
+0001b170: 7361 7272 6179 2864 6174 6129 0a20 2020  sarray(data).   
+0001b180: 2020 2020 2058 203d 2064 6174 612e 7265       X = data.re
+0001b190: 7368 6170 6528 2864 6174 612e 7368 6170  shape((data.shap
+0001b1a0: 655b 305d 2c20 3129 290a 2020 2020 2020  e[0], 1)).      
+0001b1b0: 2020 6c61 6265 6c73 2c20 6d65 6469 616e    labels, median
+0001b1c0: 7320 3d20 4e6f 6e65 2c20 4e6f 6e65 0a20  s = None, None. 
+0001b1d0: 2020 2020 2020 2063 656e 7472 6f69 6473         centroids
+0001b1e0: 203d 2058 5b6e 702e 7261 6e64 6f6d 2e63   = X[np.random.c
+0001b1f0: 686f 6963 6528 6461 7461 2e73 6861 7065  hoice(data.shape
+0001b200: 5b30 5d2c 206b 2c20 7265 706c 6163 653d  [0], k, replace=
+0001b210: 4661 6c73 6529 5d2e 636f 7079 2829 0a20  False)].copy(). 
+0001b220: 2020 2020 2020 2066 6f72 205f 2069 6e20         for _ in 
+0001b230: 7261 6e67 6528 6d61 785f 6974 6572 7329  range(max_iters)
+0001b240: 3a0a 2020 2020 2020 2020 2020 2020 6c61  :.            la
+0001b250: 6265 6c73 203d 206e 702e 7a65 726f 7328  bels = np.zeros(
+0001b260: 582e 7368 6170 655b 305d 2c20 6474 7970  X.shape[0], dtyp
+0001b270: 653d 6e70 2e69 6e74 3634 290a 2020 2020  e=np.int64).    
+0001b280: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+0001b290: 2072 616e 6765 2858 2e73 6861 7065 5b30   range(X.shape[0
+0001b2a0: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
+0001b2b0: 2020 2020 6d69 6e5f 6469 7374 203d 206e      min_dist = n
+0001b2c0: 702e 696e 660a 2020 2020 2020 2020 2020  p.inf.          
+0001b2d0: 2020 2020 2020 666f 7220 6a20 696e 2072        for j in r
+0001b2e0: 616e 6765 286b 293a 0a20 2020 2020 2020  ange(k):.       
+0001b2f0: 2020 2020 2020 2020 2020 2020 2064 6973               dis
+0001b300: 7420 3d20 6e70 2e61 6273 2858 5b69 5d20  t = np.abs(X[i] 
+0001b310: 2d20 6365 6e74 726f 6964 735b 6a5d 290a  - centroids[j]).
+0001b320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b330: 2020 2020 6469 7374 5f73 756d 203d 206e      dist_sum = n
+0001b340: 702e 7375 6d28 6469 7374 290a 2020 2020  p.sum(dist).    
+0001b350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b360: 6966 2064 6973 745f 7375 6d20 3c20 6d69  if dist_sum < mi
+0001b370: 6e5f 6469 7374 3a0a 2020 2020 2020 2020  n_dist:.        
+0001b380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b390: 6d69 6e5f 6469 7374 203d 2064 6973 745f  min_dist = dist_
+0001b3a0: 7375 6d0a 2020 2020 2020 2020 2020 2020  sum.            
+0001b3b0: 2020 2020 2020 2020 2020 2020 6c61 6265              labe
+0001b3c0: 6c73 5b69 5d20 3d20 6a0a 0a20 2020 2020  ls[i] = j..     
+0001b3d0: 2020 2020 2020 206e 6577 5f63 656e 7472         new_centr
+0001b3e0: 6f69 6473 203d 206e 702e 7a65 726f 735f  oids = np.zeros_
+0001b3f0: 6c69 6b65 2863 656e 7472 6f69 6473 290a  like(centroids).
+0001b400: 2020 2020 2020 2020 2020 2020 636f 756e              coun
+0001b410: 7473 203d 206e 702e 7a65 726f 7328 6b2c  ts = np.zeros(k,
+0001b420: 2064 7479 7065 3d6e 702e 696e 7436 3429   dtype=np.int64)
+0001b430: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0001b440: 2069 2069 6e20 7261 6e67 6528 582e 7368   i in range(X.sh
+0001b450: 6170 655b 305d 293a 0a20 2020 2020 2020  ape[0]):.       
+0001b460: 2020 2020 2020 2020 2063 6c75 7374 6572           cluster
+0001b470: 203d 206c 6162 656c 735b 695d 0a20 2020   = labels[i].   
+0001b480: 2020 2020 2020 2020 2020 2020 206e 6577               new
+0001b490: 5f63 656e 7472 6f69 6473 5b63 6c75 7374  _centroids[clust
+0001b4a0: 6572 5d20 2b3d 2058 5b69 5d0a 2020 2020  er] += X[i].    
+0001b4b0: 2020 2020 2020 2020 2020 2020 636f 756e              coun
+0001b4c0: 7473 5b63 6c75 7374 6572 5d20 2b3d 2031  ts[cluster] += 1
+0001b4d0: 0a0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
+0001b4e0: 7220 6a20 696e 2072 616e 6765 286b 293a  r j in range(k):
+0001b4f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b500: 2069 6620 636f 756e 7473 5b6a 5d20 3e20   if counts[j] > 
+0001b510: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
+0001b520: 2020 2020 2020 206e 6577 5f63 656e 7472         new_centr
+0001b530: 6f69 6473 5b6a 5d20 2f3d 2063 6f75 6e74  oids[j] /= count
+0001b540: 735b 6a5d 0a0a 2020 2020 2020 2020 2020  s[j]..          
+0001b550: 2020 6966 206e 702e 6172 7261 795f 6571    if np.array_eq
+0001b560: 7561 6c28 6365 6e74 726f 6964 732c 206e  ual(centroids, n
+0001b570: 6577 5f63 656e 7472 6f69 6473 293a 0a20  ew_centroids):. 
+0001b580: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+0001b590: 7265 616b 0a20 2020 2020 2020 2020 2020  reak.           
+0001b5a0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0001b5b0: 2020 2020 2020 2063 656e 7472 6f69 6473         centroids
+0001b5c0: 203d 206e 6577 5f63 656e 7472 6f69 6473   = new_centroids
+0001b5d0: 0a0a 2020 2020 2020 2020 6966 2063 616c  ..        if cal
+0001b5e0: 635f 6d65 6469 616e 733a 0a20 2020 2020  c_medians:.     
+0001b5f0: 2020 2020 2020 206c 6162 656c 732c 206d         labels, m
+0001b600: 6564 6961 6e73 203d 206c 6162 656c 732e  edians = labels.
+0001b610: 6173 7479 7065 286e 702e 696e 7436 3429  astype(np.int64)
+0001b620: 2c20 7b7d 0a20 2020 2020 2020 2020 2020  , {}.           
+0001b630: 2066 6f72 2069 2069 6e20 7072 616e 6765   for i in prange
+0001b640: 2830 2c20 6b2c 2031 293a 0a20 2020 2020  (0, k, 1):.     
+0001b650: 2020 2020 2020 2020 2020 206d 6564 6961             media
+0001b660: 6e73 5b69 5d20 3d20 6e70 2e6d 6564 6961  ns[i] = np.media
+0001b670: 6e28 6461 7461 5b6e 702e 6172 6777 6865  n(data[np.argwhe
+0001b680: 7265 286c 6162 656c 7320 3d3d 2069 292e  re(labels == i).
+0001b690: 666c 6174 7465 6e28 295d 290a 0a20 2020  flatten()])..   
+0001b6a0: 2020 2020 2072 6574 7572 6e20 6365 6e74       return cent
+0001b6b0: 726f 6964 732c 206c 6162 656c 732c 206d  roids, labels, m
+0001b6c0: 6564 6961 6e73 0a0a 2020 2020 4073 7461  edians..    @sta
+0001b6d0: 7469 636d 6574 686f 640a 2020 2020 406e  ticmethod.    @n
+0001b6e0: 6a69 7428 0a20 2020 2020 2020 205b 0a20  jit(.        [. 
+0001b6f0: 2020 2020 2020 2020 2020 2028 696e 7438             (int8
+0001b700: 5b3a 5d2c 2069 6e74 385b 3a5d 2c20 7479  [:], int8[:], ty
+0001b710: 7065 732e 6d69 7363 2e4f 6d69 7474 6564  pes.misc.Omitted
+0001b720: 2876 616c 7565 3d46 616c 7365 292c 2066  (value=False), f
+0001b730: 6c6f 6174 3332 5b3a 5d29 2c0a 2020 2020  loat32[:]),.    
+0001b740: 2020 2020 2020 2020 280a 2020 2020 2020          (.      
+0001b750: 2020 2020 2020 2020 2020 696e 7438 5b3a            int8[:
+0001b760: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0001b770: 2020 2069 6e74 385b 3a5d 2c0a 2020 2020     int8[:],.    
+0001b780: 2020 2020 2020 2020 2020 2020 7479 7065              type
+0001b790: 732e 6d69 7363 2e4f 6d69 7474 6564 2876  s.misc.Omitted(v
+0001b7a0: 616c 7565 3d46 616c 7365 292c 0a20 2020  alue=False),.   
+0001b7b0: 2020 2020 2020 2020 2020 2020 2074 7970               typ
+0001b7c0: 6573 2e6d 6973 632e 4f6d 6974 7465 6428  es.misc.Omitted(
+0001b7d0: 4e6f 6e65 292c 0a20 2020 2020 2020 2020  None),.         
+0001b7e0: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
+0001b7f0: 2020 2869 6e74 385b 3a5d 2c20 696e 7438    (int8[:], int8
+0001b800: 5b3a 5d2c 2062 6f6f 6c5f 2c20 666c 6f61  [:], bool_, floa
+0001b810: 7433 325b 3a5d 292c 0a20 2020 2020 2020  t32[:]),.       
+0001b820: 2020 2020 2028 696e 7438 5b3a 5d2c 2069       (int8[:], i
+0001b830: 6e74 385b 3a5d 2c20 626f 6f6c 5f2c 2074  nt8[:], bool_, t
+0001b840: 7970 6573 2e6d 6973 632e 4f6d 6974 7465  ypes.misc.Omitte
+0001b850: 6428 4e6f 6e65 2929 2c0a 2020 2020 2020  d(None)),.      
+0001b860: 2020 5d0a 2020 2020 290a 2020 2020 6465    ].    ).    de
+0001b870: 6620 6861 6d6d 696e 675f 6469 7374 616e  f hamming_distan
+0001b880: 6365 280a 2020 2020 2020 2020 783a 206e  ce(.        x: n
+0001b890: 702e 6e64 6172 7261 792c 0a20 2020 2020  p.ndarray,.     
+0001b8a0: 2020 2079 3a20 6e70 2e6e 6461 7272 6179     y: np.ndarray
+0001b8b0: 2c0a 2020 2020 2020 2020 736f 7274 3a20  ,.        sort: 
+0001b8c0: 4f70 7469 6f6e 616c 5b62 6f6f 6c5d 203d  Optional[bool] =
+0001b8d0: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
+0001b8e0: 773a 204f 7074 696f 6e61 6c5b 6e70 2e6e  w: Optional[np.n
+0001b8f0: 6461 7272 6179 5d20 3d20 4e6f 6e65 2c0a  darray] = None,.
+0001b900: 2020 2020 2920 2d3e 2066 6c6f 6174 3a0a      ) -> float:.
+0001b910: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0001b920: 2020 2020 4a69 7474 6564 2063 616c 6375      Jitted calcu
+0001b930: 6c61 7465 206f 6620 7468 6520 4861 6d6d  late of the Hamm
+0001b940: 696e 6720 7369 6d69 6c61 7269 7479 2062  ing similarity b
+0001b950: 6574 7765 656e 2074 776f 2076 6563 746f  etween two vecto
+0001b960: 7273 2e0a 0a20 2020 2020 2020 202e 2e20  rs...        .. 
+0001b970: 6e6f 7465 3a3a 0a20 2020 2020 2020 2020  note::.         
+0001b980: 2020 4164 6170 7465 6420 6672 6f6d 2060    Adapted from `
+0001b990: 7079 6e6e 6465 7363 656e 7420 3c68 7474  pynndescent <htt
+0001b9a0: 7073 3a2f 2f70 796e 6e64 6573 6365 6e74  ps://pynndescent
+0001b9b0: 2e72 6561 6474 6865 646f 6373 2e69 6f2f  .readthedocs.io/
+0001b9c0: 656e 2f6c 6174 6573 742f 3e60 5f2e 0a0a  en/latest/>`_...
+0001b9d0: 2020 2020 2020 2020 3a70 6172 616d 6574          :paramet
+0001b9e0: 6572 206e 702e 6e64 6172 7261 7920 783a  er np.ndarray x:
+0001b9f0: 2046 6972 7374 2062 696e 6172 7920 7665   First binary ve
+0001ba00: 6374 6f72 2e0a 2020 2020 2020 2020 3a70  ctor..        :p
+0001ba10: 6172 616d 6574 6572 206e 702e 6e64 6172  arameter np.ndar
+0001ba20: 7261 7920 783a 2053 6563 6f6e 6420 6269  ray x: Second bi
+0001ba30: 6e61 7279 2076 6563 746f 722e 0a20 2020  nary vector..   
+0001ba40: 2020 2020 203a 7061 7261 6d65 7465 7220       :parameter 
+0001ba50: 4f70 7469 6f6e 616c 5b6e 702e 6e64 6172  Optional[np.ndar
+0001ba60: 7261 795d 2077 3a20 4f70 7469 6f6e 616c  ray] w: Optional
+0001ba70: 2077 6569 6768 7473 2066 6f72 2065 6163   weights for eac
+0001ba80: 6820 656c 656d 656e 742e 2043 616e 2062  h element. Can b
+0001ba90: 6520 636c 6173 7369 6669 6361 7469 6f6e  e classification
+0001baa0: 2070 726f 6261 6269 6c69 7469 6573 2e20   probabilities. 
+0001bab0: 4966 206e 6f74 2070 726f 7669 6465 642c  If not provided,
+0001bac0: 2065 7175 616c 2077 6569 6768 7473 2061   equal weights a
+0001bad0: 7265 2061 7373 756d 6564 2e0a 2020 2020  re assumed..    
+0001bae0: 2020 2020 3a70 6172 616d 6574 6572 204f      :parameter O
+0001baf0: 7074 696f 6e61 6c5b 626f 6f6c 5d20 736f  ptional[bool] so
+0001bb00: 7274 3a20 4966 2054 7275 652c 2073 6f72  rt: If True, sor
+0001bb10: 7473 2078 2061 6e64 2079 2070 7269 6f72  ts x and y prior
+0001bb20: 2074 6f20 6861 6d6d 696e 6720 6469 7374   to hamming dist
+0001bb30: 616e 6365 2063 616c 6375 6c61 7469 6f6e  ance calculation
+0001bb40: 2e20 4465 6661 756c 742c 2046 616c 7365  . Default, False
+0001bb50: 2e0a 0a20 2020 2020 2020 203a 6578 616d  ...        :exam
+0001bb60: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
+0001bb70: 2078 2c20 7920 3d20 6e70 2e72 616e 646f   x, y = np.rando
+0001bb80: 6d2e 7261 6e64 696e 7428 302c 2032 2c20  m.randint(0, 2, 
+0001bb90: 2831 302c 2929 2e61 7374 7970 6528 6e70  (10,)).astype(np
+0001bba0: 2e69 6e74 3829 2c20 6e70 2e72 616e 646f  .int8), np.rando
+0001bbb0: 6d2e 7261 6e64 696e 7428 302c 2032 2c20  m.randint(0, 2, 
+0001bbc0: 2831 302c 2929 2e61 7374 7970 6528 6e70  (10,)).astype(np
+0001bbd0: 2e69 6e74 3829 0a20 2020 2020 2020 203e  .int8).        >
+0001bbe0: 3e3e 2053 7461 7469 7374 6963 7328 292e  >> Statistics().
+0001bbf0: 6861 6d6d 696e 675f 6469 7374 616e 6365  hamming_distance
+0001bc00: 2878 3d78 2c20 793d 7929 0a20 2020 2020  (x=x, y=y).     
+0001bc10: 2020 203e 3e3e 2030 2e39 310a 2020 2020     >>> 0.91.    
+0001bc20: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001bc30: 2320 7061 7373 0a20 2020 2020 2020 2069  # pass.        i
+0001bc40: 6620 7720 6973 204e 6f6e 653a 0a20 2020  f w is None:.   
+0001bc50: 2020 2020 2020 2020 2077 203d 206e 702e           w = np.
+0001bc60: 6f6e 6573 2878 2e73 6861 7065 5b30 5d29  ones(x.shape[0])
+0001bc70: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
+0001bc80: 3332 290a 0a20 2020 2020 2020 2072 6573  32)..        res
+0001bc90: 756c 7473 203d 2030 2e30 0a20 2020 2020  ults = 0.0.     
+0001bca0: 2020 2069 6620 736f 7274 3a0a 2020 2020     if sort:.    
+0001bcb0: 2020 2020 2020 2020 782c 2079 203d 206e          x, y = n
+0001bcc0: 702e 736f 7274 2878 292c 206e 702e 736f  p.sort(x), np.so
+0001bcd0: 7274 2879 290a 2020 2020 2020 2020 666f  rt(y).        fo
+0001bce0: 7220 6920 696e 2070 7261 6e67 6528 782e  r i in prange(x.
+0001bcf0: 7368 6170 655b 305d 293a 0a20 2020 2020  shape[0]):.     
+0001bd00: 2020 2020 2020 2069 6620 785b 695d 2021         if x[i] !
+0001bd10: 3d20 795b 695d 3a0a 2020 2020 2020 2020  = y[i]:.        
+0001bd20: 2020 2020 2020 2020 7265 7375 6c74 7320          results 
+0001bd30: 2b3d 2031 2e30 202a 2077 5b69 5d0a 2020  += 1.0 * w[i].  
+0001bd40: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+0001bd50: 756c 7473 202f 2078 2e73 6861 7065 5b30  ults / x.shape[0
+0001bd60: 5d0a 0a20 2020 2040 7374 6174 6963 6d65  ]..    @staticme
+0001bd70: 7468 6f64 0a20 2020 2040 6e6a 6974 280a  thod.    @njit(.
+0001bd80: 2020 2020 2020 2020 5b28 696e 7438 5b3a          [(int8[:
+0001bd90: 5d2c 2069 6e74 385b 3a5d 2c20 666c 6f61  ], int8[:], floa
+0001bda0: 7433 325b 3a5d 292c 2028 696e 7438 5b3a  t32[:]), (int8[:
+0001bdb0: 5d2c 2069 6e74 385b 3a5d 2c20 7479 7065  ], int8[:], type
+0001bdc0: 732e 6d69 7363 2e4f 6d69 7474 6564 284e  s.misc.Omitted(N
+0001bdd0: 6f6e 6529 295d 0a20 2020 2029 0a20 2020  one))].    ).   
+0001bde0: 2064 6566 2079 756c 655f 636f 6566 280a   def yule_coef(.
+0001bdf0: 2020 2020 2020 2020 783a 206e 702e 6e64          x: np.nd
+0001be00: 6172 7261 792c 2079 3a20 6e70 2e6e 6461  array, y: np.nda
+0001be10: 7272 6179 2c20 773a 204f 7074 696f 6e61  rray, w: Optiona
+0001be20: 6c5b 6e70 2e6e 6461 7272 6179 5d20 3d20  l[np.ndarray] = 
+0001be30: 4e6f 6e65 0a20 2020 2029 202d 3e20 666c  None.    ) -> fl
+0001be40: 6f61 7436 343a 0a20 2020 2020 2020 2022  oat64:.        "
+0001be50: 2222 0a20 2020 2020 2020 204a 6974 7465  "".        Jitte
+0001be60: 6420 6361 6c63 756c 6174 6520 6f66 2074  d calculate of t
+0001be70: 6865 2079 756c 6520 636f 6566 6669 6369  he yule coeffici
+0001be80: 656e 7420 6265 7477 6565 6e20 7477 6f20  ent between two 
+0001be90: 6269 6e61 7279 2076 6563 746f 7273 2028  binary vectors (
+0001bea0: 652e 672e 2c20 746f 2063 6c61 7373 6966  e.g., to classif
+0001beb0: 6965 6420 6265 6861 7669 6f72 7329 2e20  ied behaviors). 
+0001bec0: 3020 7265 7072 6573 656e 7420 696e 6465  0 represent inde
+0001bed0: 7065 6e64 656e 6365 2c20 3220 7265 7072  pendence, 2 repr
+0001bee0: 6573 656e 7473 0a20 2020 2020 2020 2063  esents.        c
+0001bef0: 6f6d 706c 6574 6520 696e 7465 7264 6570  omplete interdep
+0001bf00: 656e 6465 6e63 652e 0a0a 2020 2020 2020  endence...      
+0001bf10: 2020 2e2e 206e 6f74 653a 3a0a 2020 2020    .. note::.    
+0001bf20: 2020 2020 2020 2041 6461 7074 6564 2066         Adapted f
+0001bf30: 726f 6d20 6070 796e 6e64 6573 6365 6e74  rom `pynndescent
+0001bf40: 203c 6874 7470 733a 2f2f 7079 6e6e 6465   <https://pynnde
+0001bf50: 7363 656e 742e 7265 6164 7468 6564 6f63  scent.readthedoc
+0001bf60: 732e 696f 2f65 6e2f 6c61 7465 7374 2f3e  s.io/en/latest/>
+0001bf70: 605f 2e0a 0a20 2020 2020 2020 203a 7061  `_...        :pa
+0001bf80: 7261 6d65 7465 7220 6e70 2e6e 6461 7272  rameter np.ndarr
+0001bf90: 6179 2078 3a20 4669 7273 7420 6269 6e61  ay x: First bina
+0001bfa0: 7279 2076 6563 746f 722e 0a20 2020 2020  ry vector..     
+0001bfb0: 2020 203a 7061 7261 6d65 7465 7220 6e70     :parameter np
+0001bfc0: 2e6e 6461 7272 6179 2078 3a20 5365 636f  .ndarray x: Seco
+0001bfd0: 6e64 2062 696e 6172 7920 7665 6374 6f72  nd binary vector
+0001bfe0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0001bff0: 6574 6572 204f 7074 696f 6e61 6c5b 6e70  eter Optional[np
+0001c000: 2e6e 6461 7272 6179 5d20 773a 204f 7074  .ndarray] w: Opt
+0001c010: 696f 6e61 6c20 7765 6967 6874 7320 666f  ional weights fo
+0001c020: 7220 6561 6368 2065 6c65 6d65 6e74 2e20  r each element. 
+0001c030: 4361 6e20 6265 2063 6c61 7373 6966 6963  Can be classific
+0001c040: 6174 696f 6e20 7072 6f62 6162 696c 6974  ation probabilit
+0001c050: 6965 732e 2049 6620 6e6f 7420 7072 6f76  ies. If not prov
+0001c060: 6964 6564 2c20 6571 7561 6c20 7765 6967  ided, equal weig
+0001c070: 6874 7320 6172 6520 6173 7375 6d65 642e  hts are assumed.
+0001c080: 0a0a 2020 2020 2020 2020 3a65 7861 6d70  ..        :examp
+0001c090: 6c65 3a0a 2020 2020 2020 2020 3e3e 3e20  le:.        >>> 
+0001c0a0: 7820 3d20 6e70 2e72 616e 646f 6d2e 7261  x = np.random.ra
+0001c0b0: 6e64 696e 7428 302c 2032 2c20 2835 302c  ndint(0, 2, (50,
+0001c0c0: 2929 2e61 7374 7970 6528 6e70 2e69 6e74  )).astype(np.int
+0001c0d0: 3829 0a20 2020 2020 2020 203e 3e3e 2079  8).        >>> y
+0001c0e0: 203d 2078 205e 2031 0a20 2020 2020 2020   = x ^ 1.       
+0001c0f0: 203e 3e3e 2053 7461 7469 7374 6963 7328   >>> Statistics(
+0001c100: 292e 7975 6c65 5f63 6f65 6628 783d 782c  ).yule_coef(x=x,
+0001c110: 2079 3d79 290a 2020 2020 2020 2020 3e3e   y=y).        >>
+0001c120: 3e20 320a 2020 2020 2020 2020 3e3e 3e20  > 2.        >>> 
+0001c130: 7261 6e64 6f6d 5f69 6e64 6963 6573 203d  random_indices =
+0001c140: 206e 702e 7261 6e64 6f6d 2e63 686f 6963   np.random.choic
+0001c150: 6528 6c65 6e28 7829 2c20 7369 7a65 3d6c  e(len(x), size=l
+0001c160: 656e 2878 292f 2f32 2c20 7265 706c 6163  en(x)//2, replac
+0001c170: 653d 4661 6c73 6529 0a20 2020 2020 2020  e=False).       
+0001c180: 203e 3e3e 2079 203d 206e 702e 636f 7079   >>> y = np.copy
+0001c190: 2878 290a 2020 2020 2020 2020 3e3e 3e20  (x).        >>> 
+0001c1a0: 795b 7261 6e64 6f6d 5f69 6e64 6963 6573  y[random_indices
+0001c1b0: 5d20 3d20 3120 2d20 795b 7261 6e64 6f6d  ] = 1 - y[random
+0001c1c0: 5f69 6e64 6963 6573 5d0a 2020 2020 2020  _indices].      
+0001c1d0: 2020 3e3e 3e20 5374 6174 6973 7469 6373    >>> Statistics
+0001c1e0: 2829 2e79 756c 655f 636f 6566 2878 3d78  ().yule_coef(x=x
+0001c1f0: 2c20 793d 7929 0a20 2020 2020 2020 203e  , y=y).        >
+0001c200: 3e3e 2030 2e39 390a 2020 2020 2020 2020  >> 0.99.        
+0001c210: 2222 220a 2020 2020 2020 2020 6966 2077  """.        if w
+0001c220: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+0001c230: 2020 2020 2020 7720 3d20 6e70 2e6f 6e65        w = np.one
+0001c240: 7328 782e 7368 6170 655b 305d 292e 6173  s(x.shape[0]).as
+0001c250: 7479 7065 286e 702e 666c 6f61 7433 3229  type(np.float32)
+0001c260: 0a0a 2020 2020 2020 2020 665f 662c 2074  ..        f_f, t
+0001c270: 5f74 2c20 745f 662c 2066 5f74 203d 2030  _t, t_f, f_t = 0
+0001c280: 2e30 2c20 302e 302c 2030 2e30 2c20 302e  .0, 0.0, 0.0, 0.
+0001c290: 300a 2020 2020 2020 2020 666f 7220 6920  0.        for i 
+0001c2a0: 696e 2070 7261 6e67 6528 782e 7368 6170  in prange(x.shap
+0001c2b0: 655b 305d 293a 0a20 2020 2020 2020 2020  e[0]):.         
+0001c2c0: 2020 2069 6620 2878 5b69 5d20 3d3d 2031     if (x[i] == 1
+0001c2d0: 2920 616e 6420 2879 5b69 5d20 3d3d 2031  ) and (y[i] == 1
+0001c2e0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0001c2f0: 2020 2074 5f74 202b 3d20 3120 2a20 775b     t_t += 1 * w[
+0001c300: 695d 0a20 2020 2020 2020 2020 2020 2069  i].            i
+0001c310: 6620 2878 5b69 5d20 3d3d 2030 2920 616e  f (x[i] == 0) an
+0001c320: 6420 2879 5b69 5d20 3d3d 2030 293a 0a20  d (y[i] == 0):. 
+0001c330: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0001c340: 5f66 202b 3d20 3120 2a20 775b 695d 0a20  _f += 1 * w[i]. 
+0001c350: 2020 2020 2020 2020 2020 2069 6620 2878             if (x
+0001c360: 5b69 5d20 3d3d 2030 2920 616e 6420 2879  [i] == 0) and (y
+0001c370: 5b69 5d20 3d3d 2031 293a 0a20 2020 2020  [i] == 1):.     
+0001c380: 2020 2020 2020 2020 2020 2066 5f74 202b             f_t +
+0001c390: 3d20 3120 2a20 775b 695d 0a20 2020 2020  = 1 * w[i].     
+0001c3a0: 2020 2020 2020 2069 6620 2878 5b69 5d20         if (x[i] 
+0001c3b0: 3d3d 2031 2920 616e 6420 2879 5b69 5d20  == 1) and (y[i] 
+0001c3c0: 3d3d 2030 293a 0a20 2020 2020 2020 2020  == 0):.         
+0001c3d0: 2020 2020 2020 2074 5f66 202b 3d20 3120         t_f += 1 
+0001c3e0: 2a20 775b 695d 0a20 2020 2020 2020 2069  * w[i].        i
+0001c3f0: 6620 745f 6620 3d3d 2030 2e30 206f 7220  f t_f == 0.0 or 
+0001c400: 665f 7420 3d3d 2030 2e30 3a0a 2020 2020  f_t == 0.0:.    
+0001c410: 2020 2020 2020 2020 7265 7475 726e 2030          return 0
+0001c420: 2e30 0a20 2020 2020 2020 2065 6c73 653a  .0.        else:
+0001c430: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0001c440: 7572 6e20 2832 2e30 202a 2074 5f66 202a  urn (2.0 * t_f *
+0001c450: 2066 5f74 2920 2f20 2874 5f74 202a 2066   f_t) / (t_t * f
+0001c460: 5f66 202b 2074 5f66 202a 2066 5f74 290a  _f + t_f * f_t).
+0001c470: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
+0001c480: 6f64 0a20 2020 2040 6e6a 6974 280a 2020  od.    @njit(.  
+0001c490: 2020 2020 2020 5b28 696e 7438 5b3a 5d2c        [(int8[:],
+0001c4a0: 2069 6e74 385b 3a5d 2c20 7479 7065 732e   int8[:], types.
+0001c4b0: 6d69 7363 2e4f 6d69 7474 6564 284e 6f6e  misc.Omitted(Non
+0001c4c0: 6529 292c 2028 696e 7438 5b3a 5d2c 2069  e)), (int8[:], i
+0001c4d0: 6e74 385b 3a5d 2c20 666c 6f61 7433 325b  nt8[:], float32[
+0001c4e0: 3a5d 295d 0a20 2020 2029 0a20 2020 2064  :])].    ).    d
+0001c4f0: 6566 2073 6f6b 616c 5f73 6e65 6174 6828  ef sokal_sneath(
+0001c500: 0a20 2020 2020 2020 2078 3a20 6e70 2e6e  .        x: np.n
+0001c510: 6461 7272 6179 2c20 793a 206e 702e 6e64  darray, y: np.nd
+0001c520: 6172 7261 792c 2077 3a20 4f70 7469 6f6e  array, w: Option
+0001c530: 616c 5b6e 702e 6e64 6172 7261 795d 203d  al[np.ndarray] =
+0001c540: 204e 6f6e 650a 2020 2020 2920 2d3e 2066   None.    ) -> f
+0001c550: 6c6f 6174 3634 3a0a 2020 2020 2020 2020  loat64:.        
+0001c560: 2222 220a 2020 2020 2020 2020 4a69 7474  """.        Jitt
+0001c570: 6564 2063 616c 6375 6c61 7465 206f 6620  ed calculate of 
+0001c580: 7468 6520 736f 6b61 6c20 736e 6561 7468  the sokal sneath
+0001c590: 2063 6f65 6666 6963 6965 6e74 2062 6574   coefficient bet
+0001c5a0: 7765 656e 2074 776f 2062 696e 6172 7920  ween two binary 
+0001c5b0: 7665 6374 6f72 7320 2865 2e67 2e2c 2074  vectors (e.g., t
+0001c5c0: 6f20 636c 6173 7369 6669 6564 2062 6568  o classified beh
+0001c5d0: 6176 696f 7273 292e 2030 2072 6570 7265  aviors). 0 repre
+0001c5e0: 7365 6e74 2069 6e64 6570 656e 6465 6e63  sent independenc
+0001c5f0: 652c 2031 2072 6570 7265 7365 6e74 7320  e, 1 represents 
+0001c600: 636f 6d70 6c65 7465 2069 6e74 6572 6465  complete interde
+0001c610: 7065 6e64 656e 6365 2e0a 0a20 2020 2020  pendence...     
+0001c620: 2020 203a 7061 7261 6d65 7465 7220 6e70     :parameter np
+0001c630: 2e6e 6461 7272 6179 2078 3a20 4669 7273  .ndarray x: Firs
+0001c640: 7420 6269 6e61 7279 2076 6563 746f 722e  t binary vector.
+0001c650: 0a20 2020 2020 2020 203a 7061 7261 6d65  .        :parame
+0001c660: 7465 7220 6e70 2e6e 6461 7272 6179 2078  ter np.ndarray x
+0001c670: 3a20 5365 636f 6e64 2062 696e 6172 7920  : Second binary 
+0001c680: 7665 6374 6f72 2e0a 2020 2020 2020 2020  vector..        
+0001c690: 3a70 6172 616d 6574 6572 204f 7074 696f  :parameter Optio
+0001c6a0: 6e61 6c5b 6e70 2e6e 6461 7272 6179 5d20  nal[np.ndarray] 
+0001c6b0: 773a 204f 7074 696f 6e61 6c20 7765 6967  w: Optional weig
+0001c6c0: 6874 7320 666f 7220 6561 6368 2065 6c65  hts for each ele
+0001c6d0: 6d65 6e74 2e20 4361 6e20 6265 2063 6c61  ment. Can be cla
+0001c6e0: 7373 6966 6963 6174 696f 6e20 7072 6f62  ssification prob
+0001c6f0: 6162 696c 6974 6965 732e 2049 6620 6e6f  abilities. If no
+0001c700: 7420 7072 6f76 6964 6564 2c20 6571 7561  t provided, equa
+0001c710: 6c20 7765 6967 6874 7320 6172 6520 6173  l weights are as
+0001c720: 7375 6d65 642e 0a0a 2020 2020 2020 2020  sumed...        
+0001c730: 2e2e 206e 6f74 653a 3a0a 2020 2020 2020  .. note::.      
+0001c740: 2020 2020 2041 6461 7074 6564 2066 726f       Adapted fro
+0001c750: 6d20 6070 796e 6e64 6573 6365 6e74 203c  m `pynndescent <
+0001c760: 6874 7470 733a 2f2f 7079 6e6e 6465 7363  https://pynndesc
+0001c770: 656e 742e 7265 6164 7468 6564 6f63 732e  ent.readthedocs.
+0001c780: 696f 2f65 6e2f 6c61 7465 7374 2f3e 605f  io/en/latest/>`_
+0001c790: 2e0a 0a20 2020 2020 2020 203a 6578 616d  ...        :exam
+0001c7a0: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
+0001c7b0: 2078 203d 206e 702e 6172 7261 7928 5b30   x = np.array([0
+0001c7c0: 2c20 312c 2030 2c20 302c 2031 5d29 2e61  , 1, 0, 0, 1]).a
+0001c7d0: 7374 7970 6528 6e70 2e69 6e74 3829 0a20  stype(np.int8). 
+0001c7e0: 2020 2020 2020 203e 3e3e 2079 203d 206e         >>> y = n
+0001c7f0: 702e 6172 7261 7928 5b31 2c20 302c 2031  p.array([1, 0, 1
+0001c800: 2c20 312c 2030 5d29 2e61 7374 7970 6528  , 1, 0]).astype(
+0001c810: 6e70 2e69 6e74 3829 0a20 2020 2020 2020  np.int8).       
+0001c820: 203e 3e3e 2053 7461 7469 7374 6963 7328   >>> Statistics(
+0001c830: 292e 736f 6b61 6c5f 736e 6561 7468 2878  ).sokal_sneath(x
+0001c840: 2c20 7929 0a20 2020 2020 2020 203e 3e3e  , y).        >>>
+0001c850: 2030 2e30 0a20 2020 2020 2020 2022 2222   0.0.        """
+0001c860: 0a20 2020 2020 2020 2069 6620 7720 6973  .        if w is
+0001c870: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0001c880: 2020 2077 203d 206e 702e 6f6e 6573 2878     w = np.ones(x
+0001c890: 2e73 6861 7065 5b30 5d29 2e61 7374 7970  .shape[0]).astyp
+0001c8a0: 6528 666c 6f61 7433 3229 0a20 2020 2020  e(float32).     
+0001c8b0: 2020 2074 5f63 6e74 2c20 665f 636e 742c     t_cnt, f_cnt,
+0001c8c0: 2074 5f66 2c20 665f 7420 3d20 302e 302c   t_f, f_t = 0.0,
+0001c8d0: 2030 2e30 2c20 302e 302c 2030 2e30 0a20   0.0, 0.0, 0.0. 
+0001c8e0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+0001c8f0: 7072 616e 6765 2878 2e73 6861 7065 5b30  prange(x.shape[0
+0001c900: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
+0001c910: 6966 2028 785b 695d 203d 3d20 3129 2061  if (x[i] == 1) a
+0001c920: 6e64 2028 795b 695d 203d 3d20 3129 3a0a  nd (y[i] == 1):.
+0001c930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c940: 745f 636e 7420 2b3d 2031 2e30 202a 2077  t_cnt += 1.0 * w
+0001c950: 5b69 5d0a 2020 2020 2020 2020 2020 2020  [i].            
+0001c960: 656c 6966 2028 785b 695d 203d 3d20 3029  elif (x[i] == 0)
+0001c970: 2061 6e64 2028 795b 695d 203d 3d20 3029   and (y[i] == 0)
+0001c980: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001c990: 2020 665f 636e 7420 2b3d 2031 2e30 202a    f_cnt += 1.0 *
+0001c9a0: 2077 5b69 5d0a 2020 2020 2020 2020 2020   w[i].          
+0001c9b0: 2020 656c 6966 2028 785b 695d 203d 3d20    elif (x[i] == 
+0001c9c0: 3029 2061 6e64 2028 795b 695d 203d 3d20  0) and (y[i] == 
+0001c9d0: 3129 3a0a 2020 2020 2020 2020 2020 2020  1):.            
+0001c9e0: 2020 2020 665f 7420 2b3d 2031 2e30 202a      f_t += 1.0 *
+0001c9f0: 2077 5b69 5d0a 2020 2020 2020 2020 2020   w[i].          
+0001ca00: 2020 656c 6966 2028 785b 695d 203d 3d20    elif (x[i] == 
+0001ca10: 3129 2061 6e64 2028 795b 695d 203d 3d20  1) and (y[i] == 
+0001ca20: 3029 3a0a 2020 2020 2020 2020 2020 2020  0):.            
+0001ca30: 2020 2020 745f 6620 2b3d 2031 2e30 202a      t_f += 1.0 *
+0001ca40: 2077 5b69 5d0a 0a20 2020 2020 2020 2069   w[i]..        i
+0001ca50: 6620 745f 6620 2b20 665f 7420 3d3d 2030  f t_f + f_t == 0
+0001ca60: 2e30 3a0a 2020 2020 2020 2020 2020 2020  .0:.            
+0001ca70: 7265 7475 726e 2030 2e30 0a20 2020 2020  return 0.0.     
+0001ca80: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0001ca90: 2020 2020 2072 6574 7572 6e20 2866 5f74       return (f_t
+0001caa0: 202b 2074 5f66 2920 2f20 2832 202a 2028   + t_f) / (2 * (
+0001cab0: 745f 636e 7420 2b20 665f 636e 7429 202b  t_cnt + f_cnt) +
+0001cac0: 2066 5f74 202b 2074 5f66 290a 0a20 2020   f_t + t_f)..   
+0001cad0: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
+0001cae0: 2020 2040 6e6a 6974 285b 2866 6c6f 6174     @njit([(float
+0001caf0: 3332 5b3a 2c20 3a5d 2c20 666c 6f61 7433  32[:, :], float3
+0001cb00: 325b 3a2c 203a 5d29 2c20 2866 6c6f 6174  2[:, :]), (float
+0001cb10: 3332 5b3a 2c20 3a5d 2c20 7479 7065 732e  32[:, :], types.
+0001cb20: 6d69 7363 2e4f 6d69 7474 6564 284e 6f6e  misc.Omitted(Non
+0001cb30: 6529 295d 290a 2020 2020 6465 6620 6272  e))]).    def br
+0001cb40: 6179 5f63 7572 7469 735f 6469 7373 696d  ay_curtis_dissim
+0001cb50: 696c 6172 6974 7928 0a20 2020 2020 2020  ilarity(.       
+0001cb60: 2078 3a20 6e70 2e6e 6461 7272 6179 2c20   x: np.ndarray, 
+0001cb70: 773a 204f 7074 696f 6e61 6c5b 6e70 2e6e  w: Optional[np.n
+0001cb80: 6461 7272 6179 5d20 3d20 4e6f 6e65 0a20  darray] = None. 
+0001cb90: 2020 2029 202d 3e20 6e70 2e6e 6461 7272     ) -> np.ndarr
+0001cba0: 6179 3a0a 2020 2020 2020 2020 2222 220a  ay:.        """.
+0001cbb0: 2020 2020 2020 2020 4a69 7474 6564 2063          Jitted c
+0001cbc0: 616c 6375 6c61 7465 206f 6620 7468 6520  alculate of the 
+0001cbd0: 4272 6179 2d43 7572 7469 7320 6469 7373  Bray-Curtis diss
+0001cbe0: 696d 696c 6172 6974 7920 6d61 7472 6978  imilarity matrix
+0001cbf0: 2062 6574 7765 656e 2073 616d 706c 6573   between samples
+0001cc00: 2062 6173 6564 206f 6e20 6665 6174 7572   based on featur
+0001cc10: 6520 7661 6c75 6573 2e0a 0a20 2020 2020  e values...     
+0001cc20: 2020 2055 7365 6675 6c20 666f 7220 6669     Useful for fi
+0001cc30: 6e64 696e 6720 7369 6d69 6c61 7220 6672  nding similar fr
+0001cc40: 616d 6573 2062 6173 6564 206f 6e20 6265  ames based on be
+0001cc50: 6861 7669 6f72 2e0a 0a20 2020 2020 2020  havior...       
+0001cc60: 202e 2e20 6e6f 7465 3a3a 0a20 2020 2020   .. note::.     
+0001cc70: 2020 2020 2020 4164 6170 7465 6420 6672        Adapted fr
+0001cc80: 6f6d 2060 7079 6e6e 6465 7363 656e 7420  om `pynndescent 
+0001cc90: 3c68 7474 7073 3a2f 2f70 796e 6e64 6573  <https://pynndes
+0001cca0: 6365 6e74 2e72 6561 6474 6865 646f 6373  cent.readthedocs
+0001ccb0: 2e69 6f2f 656e 2f6c 6174 6573 742f 3e60  .io/en/latest/>`
+0001ccc0: 5f2e 0a0a 2020 2020 2020 2020 3a70 6172  _...        :par
+0001ccd0: 616d 6574 6572 206e 702e 6e64 6172 7261  ameter np.ndarra
+0001cce0: 7920 783a 2032 6420 6172 7261 7920 7769  y x: 2d array wi
+0001ccf0: 7468 206c 696b 656c 7920 6e6f 726d 616c  th likely normal
+0001cd00: 697a 6564 2066 6561 7475 7265 2076 616c  ized feature val
+0001cd10: 7565 732e 0a20 2020 2020 2020 203a 7061  ues..        :pa
+0001cd20: 7261 6d65 7465 7220 4f70 7469 6f6e 616c  rameter Optional
+0001cd30: 5b6e 702e 6e64 6172 7261 795d 2077 3a20  [np.ndarray] w: 
+0001cd40: 4f70 7469 6f6e 616c 2032 6420 6172 7261  Optional 2d arra
+0001cd50: 7920 7769 7468 2077 6569 6768 7473 206f  y with weights o
+0001cd60: 6620 7361 6d65 2073 697a 6520 6173 2078  f same size as x
+0001cd70: 2e20 4465 6661 756c 7420 4e6f 6e65 2061  . Default None a
+0001cd80: 6e64 2061 6c6c 206f 6273 6572 7661 7469  nd all observati
+0001cd90: 6f6e 7320 7769 6c6c 2068 6176 6520 7468  ons will have th
+0001cda0: 6520 7361 6d65 2077 6569 6768 742e 0a20  e same weight.. 
+0001cdb0: 2020 2020 2020 203a 7265 7475 726e 7320         :returns 
+0001cdc0: 6e70 2e6e 6461 7272 6179 3a20 3264 2061  np.ndarray: 2d a
+0001cdd0: 7272 6179 2077 6974 6820 7361 6d65 2073  rray with same s
+0001cde0: 697a 6520 6173 2078 2072 6570 7265 7365  ize as x represe
+0001cdf0: 6e74 696e 6720 6469 7373 696d 696c 6172  nting dissimilar
+0001ce00: 6974 7920 7661 6c75 6573 2e20 3020 616e  ity values. 0 an
+0001ce10: 6420 7468 6520 6f62 7365 7276 6174 696f  d the observatio
+0001ce20: 6e73 2061 7265 2069 6465 6e74 6963 616c  ns are identical
+0001ce30: 2061 6e64 2061 7420 3120 7468 6520 6f62   and at 1 the ob
+0001ce40: 7365 7276 6174 696f 6e73 2061 7265 2063  servations are c
+0001ce50: 6f6d 706c 6574 6c79 2064 6973 696d 696c  ompletly disimil
+0001ce60: 6172 2e0a 0a20 2020 2020 2020 203a 6578  ar...        :ex
+0001ce70: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
+0001ce80: 3e3e 2078 203d 206e 702e 6172 7261 7928  >> x = np.array(
+0001ce90: 5b5b 312c 2031 2c20 312c 2031 2c20 315d  [[1, 1, 1, 1, 1]
+0001cea0: 2c20 5b30 2c20 302c 2030 2c20 302c 2030  , [0, 0, 0, 0, 0
+0001ceb0: 5d2c 205b 302c 2030 2c20 302c 2030 2c20  ], [0, 0, 0, 0, 
+0001cec0: 305d 2c20 5b31 2c20 312c 2031 2c20 312c  0], [1, 1, 1, 1,
+0001ced0: 2031 5d5d 292e 6173 7479 7065 286e 702e   1]]).astype(np.
+0001cee0: 666c 6f61 7433 3229 0a20 2020 2020 2020  float32).       
+0001cef0: 203e 3e3e 2053 7461 7469 7374 6963 7328   >>> Statistics(
+0001cf00: 292e 6272 6179 5f63 7572 7469 735f 6469  ).bray_curtis_di
+0001cf10: 7373 696d 696c 6172 6974 7928 783d 7829  ssimilarity(x=x)
+0001cf20: 0a20 2020 2020 2020 203e 3e3e 205b 5b30  .        >>> [[0
+0001cf30: 2c20 312e 2c20 312e 2c20 302e 5d2c 205b  , 1., 1., 0.], [
+0001cf40: 312e 2c20 302e 2c20 302e 2c20 312e 5d2c  1., 0., 0., 1.],
+0001cf50: 205b 312e 2c20 302e 2c20 302e 2c20 312e   [1., 0., 0., 1.
+0001cf60: 5d2c 205b 302e 2c20 312e 2c20 312e 2c20  ], [0., 1., 1., 
+0001cf70: 302e 5d5d 0a20 2020 2020 2020 2022 2222  0.]].        """
+0001cf80: 0a20 2020 2020 2020 2069 6620 7720 6973  .        if w is
+0001cf90: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0001cfa0: 2020 2077 203d 206e 702e 6f6e 6573 2828     w = np.ones((
+0001cfb0: 782e 7368 6170 655b 305d 2c20 782e 7368  x.shape[0], x.sh
+0001cfc0: 6170 655b 305d 2929 2e61 7374 7970 6528  ape[0])).astype(
+0001cfd0: 6e70 2e66 6c6f 6174 3332 290a 2020 2020  np.float32).    
+0001cfe0: 2020 2020 7265 7375 6c74 7320 3d20 6e70      results = np
+0001cff0: 2e66 756c 6c28 2878 2e73 6861 7065 5b30  .full((x.shape[0
+0001d000: 5d2c 2078 2e73 6861 7065 5b30 5d29 2c20  ], x.shape[0]), 
+0001d010: 302e 3029 0a20 2020 2020 2020 2066 6f72  0.0).        for
+0001d020: 2069 2069 6e20 7072 616e 6765 2878 2e73   i in prange(x.s
+0001d030: 6861 7065 5b30 5d29 3a0a 2020 2020 2020  hape[0]):.      
+0001d040: 2020 2020 2020 666f 7220 6a20 696e 2072        for j in r
+0001d050: 616e 6765 2869 202b 2031 2c20 782e 7368  ange(i + 1, x.sh
+0001d060: 6170 655b 305d 293a 0a20 2020 2020 2020  ape[0]):.       
+0001d070: 2020 2020 2020 2020 2073 312c 2073 322c           s1, s2,
+0001d080: 206e 756d 2c20 6465 6e20 3d20 785b 695d   num, den = x[i]
+0001d090: 2c20 785b 6a5d 2c20 302e 302c 2030 2e30  , x[j], 0.0, 0.0
+0001d0a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001d0b0: 2066 6f72 206b 2069 6e20 7261 6e67 6528   for k in range(
+0001d0c0: 7331 2e73 6861 7065 5b30 5d29 3a0a 2020  s1.shape[0]):.  
+0001d0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d0e0: 2020 6e75 6d20 2b3d 206e 702e 6162 7328    num += np.abs(
+0001d0f0: 7331 5b6b 5d20 2d20 7332 5b6b 5d29 0a20  s1[k] - s2[k]). 
+0001d100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d110: 2020 2064 656e 202b 3d20 6e70 2e61 6273     den += np.abs
+0001d120: 2873 315b 6b5d 202b 2073 325b 6b5d 290a  (s1[k] + s2[k]).
+0001d130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d140: 6966 2064 656e 203d 3d20 302e 303a 0a20  if den == 0.0:. 
+0001d150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d160: 2020 2076 616c 203d 2030 2e30 0a20 2020     val = 0.0.   
+0001d170: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+0001d180: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0001d190: 2020 2020 2020 2076 616c 203d 2028 666c         val = (fl
+0001d1a0: 6f61 7428 6e75 6d29 202f 2064 656e 2920  oat(num) / den) 
+0001d1b0: 2a20 775b 692c 206a 5d0a 2020 2020 2020  * w[i, j].      
+0001d1c0: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+0001d1d0: 735b 692c 206a 5d20 3d20 7661 6c0a 2020  s[i, j] = val.  
+0001d1e0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0001d1f0: 7375 6c74 735b 6a2c 2069 5d20 3d20 7661  sults[j, i] = va
+0001d200: 6c0a 2020 2020 2020 2020 7265 7475 726e  l.        return
+0001d210: 2072 6573 756c 7473 2e61 7374 7970 6528   results.astype(
+0001d220: 666c 6f61 7433 3229 0a0a 2020 2020 4073  float32)..    @s
+0001d230: 7461 7469 636d 6574 686f 640a 2020 2020  taticmethod.    
+0001d240: 406e 6a69 7428 2866 6c6f 6174 3332 5b3a  @njit((float32[:
+0001d250: 5d2c 2066 6c6f 6174 3332 5b3a 5d29 290a  ], float32[:])).
+0001d260: 2020 2020 6465 6620 5f68 656c 6c69 6e67      def _helling
+0001d270: 6572 5f68 656c 7065 7228 783a 206e 702e  er_helper(x: np.
+0001d280: 6e64 6172 7261 792c 2079 3a20 6e70 2e6e  ndarray, y: np.n
+0001d290: 6461 7272 6179 293a 0a20 2020 2020 2020  darray):.       
+0001d2a0: 2022 2222 4a69 7474 6564 2068 656c 7065   """Jitted helpe
+0001d2b0: 7220 666f 7220 636f 6d70 7574 696e 6720  r for computing 
+0001d2c0: 4865 6c6c 696e 6765 7220 6469 7374 616e  Hellinger distan
+0001d2d0: 6365 7320 6672 6f6d 2060 6068 656c 6c69  ces from ``helli
+0001d2e0: 6e67 6572 5f64 6973 7461 6e63 6560 6022  nger_distance``"
+0001d2f0: 2222 0a20 2020 2020 2020 2072 6573 756c  "".        resul
+0001d300: 742c 206e 6f72 6d5f 782c 206e 6f72 6d5f  t, norm_x, norm_
+0001d310: 7920 3d20 302e 302c 2030 2e30 2c20 302e  y = 0.0, 0.0, 0.
+0001d320: 300a 2020 2020 2020 2020 666f 7220 6920  0.        for i 
+0001d330: 696e 2072 616e 6765 2878 2e73 6861 7065  in range(x.shape
+0001d340: 5b30 5d29 3a0a 2020 2020 2020 2020 2020  [0]):.          
+0001d350: 2020 7265 7375 6c74 202b 3d20 6e70 2e73    result += np.s
+0001d360: 7172 7428 785b 695d 202a 2079 5b69 5d29  qrt(x[i] * y[i])
+0001d370: 0a20 2020 2020 2020 2020 2020 206e 6f72  .            nor
+0001d380: 6d5f 7820 2b3d 2078 5b69 5d0a 2020 2020  m_x += x[i].    
+0001d390: 2020 2020 2020 2020 6e6f 726d 5f79 202b          norm_y +
+0001d3a0: 3d20 795b 695d 0a20 2020 2020 2020 2069  = y[i].        i
+0001d3b0: 6620 6e6f 726d 5f78 203d 3d20 3020 616e  f norm_x == 0 an
+0001d3c0: 6420 6e6f 726d 5f79 203d 3d20 303a 0a20  d norm_y == 0:. 
+0001d3d0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0001d3e0: 6e20 302e 300a 2020 2020 2020 2020 656c  n 0.0.        el
+0001d3f0: 6966 206e 6f72 6d5f 7820 3d3d 2030 206f  if norm_x == 0 o
+0001d400: 7220 6e6f 726d 5f79 203d 3d20 303a 0a20  r norm_y == 0:. 
+0001d410: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0001d420: 6e20 312e 300a 2020 2020 2020 2020 656c  n 1.0.        el
+0001d430: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0001d440: 7265 7475 726e 206e 702e 7371 7274 2831  return np.sqrt(1
+0001d450: 202d 2072 6573 756c 7420 2f20 6e70 2e73   - result / np.s
+0001d460: 7172 7428 6e6f 726d 5f78 202a 206e 6f72  qrt(norm_x * nor
+0001d470: 6d5f 7929 290a 0a20 2020 2064 6566 2068  m_y))..    def h
+0001d480: 656c 6c69 6e67 6572 5f64 6973 7461 6e63  ellinger_distanc
+0001d490: 6528 0a20 2020 2020 2020 2073 656c 662c  e(.        self,
+0001d4a0: 0a20 2020 2020 2020 2078 3a20 6e70 2e6e  .        x: np.n
+0001d4b0: 6461 7272 6179 2c0a 2020 2020 2020 2020  darray,.        
+0001d4c0: 793a 206e 702e 6e64 6172 7261 792c 0a20  y: np.ndarray,. 
+0001d4d0: 2020 2020 2020 2062 7563 6b65 745f 6d65         bucket_me
+0001d4e0: 7468 6f64 3a20 4f70 7469 6f6e 616c 5b0a  thod: Optional[.
+0001d4f0: 2020 2020 2020 2020 2020 2020 4c69 7465              Lite
+0001d500: 7261 6c5b 2266 6422 2c20 2264 6f61 6e65  ral["fd", "doane
+0001d510: 222c 2022 6175 746f 222c 2022 7363 6f74  ", "auto", "scot
+0001d520: 7422 2c20 2273 746f 6e65 222c 2022 7269  t", "stone", "ri
+0001d530: 6365 222c 2022 7374 7572 6765 7322 2c20  ce", "sturges", 
+0001d540: 2273 7172 7422 5d0a 2020 2020 2020 2020  "sqrt"].        
+0001d550: 5d20 3d20 2261 7574 6f22 2c0a 2020 2020  ] = "auto",.    
+0001d560: 2920 2d3e 2066 6c6f 6174 3a0a 2020 2020  ) -> float:.    
+0001d570: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001d580: 436f 6d70 7574 6520 7468 6520 4865 6c6c  Compute the Hell
+0001d590: 696e 6765 7220 6469 7374 616e 6365 2062  inger distance b
+0001d5a0: 6574 7765 656e 2074 776f 2076 6563 746f  etween two vecto
+0001d5b0: 7220 6469 7374 7269 6269 7469 6f6e 732e  r distribitions.
+0001d5c0: 0a0a 2020 2020 2020 2020 2e2e 206e 6f74  ..        .. not
+0001d5d0: 653a 3a0a 2020 2020 2020 2020 2020 2054  e::.           T
+0001d5e0: 6865 2048 656c 6c69 6e67 6572 2064 6973  he Hellinger dis
+0001d5f0: 7461 6e63 6520 6973 2062 6f75 6e64 6564  tance is bounded
+0001d600: 2061 6e64 2072 616e 6765 7320 6672 6f6d   and ranges from
+0001d610: 2030 2074 6f20 e288 9a32 2e20 4469 7374   0 to ...2. Dist
+0001d620: 616e 6365 206f 6620 e288 9a32 2069 6e64  ance of ...2 ind
+0001d630: 6963 6174 6573 2074 6861 7420 7468 6520  icates that the 
+0001d640: 7477 6f20 6469 7374 7269 6275 7469 6f6e  two distribution
+0001d650: 7320 6172 6520 6d61 7869 6d61 6c6c 7920  s are maximally 
+0001d660: 6469 7373 696d 696c 6172 0a0a 2020 2020  dissimilar..    
+0001d670: 2020 2020 3a70 6172 616d 206e 702e 6e64      :param np.nd
+0001d680: 6172 7261 7920 783a 2046 6972 7374 2031  array x: First 1
+0001d690: 4420 6172 7261 7920 7265 7072 6573 656e  D array represen
+0001d6a0: 7469 6e67 2061 2070 726f 6261 6269 6c69  ting a probabili
+0001d6b0: 7479 2064 6973 7472 6962 7574 696f 6e2e  ty distribution.
+0001d6c0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0001d6d0: 6e70 2e6e 6461 7272 6179 2079 3a20 5365  np.ndarray y: Se
+0001d6e0: 636f 6e64 2031 4420 6172 7261 7920 7265  cond 1D array re
+0001d6f0: 7072 6573 656e 7469 6e67 2061 2070 726f  presenting a pro
+0001d700: 6261 6269 6c69 7479 2064 6973 7472 6962  bability distrib
+0001d710: 7574 696f 6e2e 0a20 2020 2020 2020 203a  ution..        :
+0001d720: 7061 7261 6d20 4f70 7469 6f6e 616c 5b4c  param Optional[L
+0001d730: 6974 6572 616c 5b27 6664 272c 2027 646f  iteral['fd', 'do
+0001d740: 616e 6527 2c20 2761 7574 6f27 2c20 2773  ane', 'auto', 's
+0001d750: 636f 7474 272c 2027 7374 6f6e 6527 2c20  cott', 'stone', 
+0001d760: 2772 6963 6527 2c20 2773 7475 7267 6573  'rice', 'sturges
+0001d770: 272c 2027 7371 7274 275d 5d20 6275 636b  ', 'sqrt']] buck
+0001d780: 6574 5f6d 6574 686f 643a 204d 6574 686f  et_method: Metho
+0001d790: 6420 666f 7220 636f 6d70 7574 696e 6720  d for computing 
+0001d7a0: 6869 7374 6f67 7261 6d20 6269 6e73 2e20  histogram bins. 
+0001d7b0: 4465 6661 756c 7420 6973 2027 6175 746f  Default is 'auto
+0001d7c0: 272e 0a20 2020 2020 2020 203a 7265 7475  '..        :retu
+0001d7d0: 726e 7320 666c 6f61 743a 2048 656c 6c69  rns float: Helli
+0001d7e0: 6e67 6572 2064 6973 7461 6e63 6520 6265  nger distance be
+0001d7f0: 7477 6565 6e20 7468 6520 7477 6f20 696e  tween the two in
+0001d800: 7075 7420 7072 6f62 6162 696c 6974 7920  put probability 
+0001d810: 6469 7374 7269 6275 7469 6f6e 732e 0a0a  distributions...
+0001d820: 2020 2020 2020 2020 3a65 7861 6d70 6c65          :example
+0001d830: 3a0a 2020 2020 2020 2020 3e3e 3e20 7820  :.        >>> x 
+0001d840: 3d20 6e70 2e72 616e 646f 6d2e 7261 6e64  = np.random.rand
+0001d850: 696e 7428 302c 2039 3030 302c 2028 3530  int(0, 9000, (50
+0001d860: 3030 3030 2c29 290a 2020 2020 2020 2020  0000,)).        
+0001d870: 3e3e 3e20 7920 3d20 6e70 2e72 616e 646f  >>> y = np.rando
+0001d880: 6d2e 7261 6e64 696e 7428 302c 2039 3030  m.randint(0, 900
+0001d890: 302c 2028 3530 3030 3030 2c29 290a 2020  0, (500000,)).  
+0001d8a0: 2020 2020 2020 3e3e 3e20 5374 6174 6973        >>> Statis
+0001d8b0: 7469 6373 2829 2e68 656c 6c69 6e67 6572  tics().hellinger
+0001d8c0: 5f64 6973 7461 6e63 6528 783d 782c 2079  _distance(x=x, y
+0001d8d0: 3d79 2c20 6275 636b 6574 5f6d 6574 686f  =y, bucket_metho
+0001d8e0: 643d 2761 7574 6f27 290a 2020 2020 2020  d='auto').      
+0001d8f0: 2020 2222 220a 0a20 2020 2020 2020 2063    """..        c
+0001d900: 6865 636b 5f76 616c 6964 5f61 7272 6179  heck_valid_array
+0001d910: 280a 2020 2020 2020 2020 2020 2020 6461  (.            da
+0001d920: 7461 3d78 2c0a 2020 2020 2020 2020 2020  ta=x,.          
+0001d930: 2020 736f 7572 6365 3d53 7461 7469 7374    source=Statist
+0001d940: 6963 732e 6865 6c6c 696e 6765 725f 6469  ics.hellinger_di
+0001d950: 7374 616e 6365 2e5f 5f6e 616d 655f 5f2c  stance.__name__,
+0001d960: 0a20 2020 2020 2020 2020 2020 2061 6363  .            acc
+0001d970: 6570 7465 645f 6e64 696d 733d 2831 2c29  epted_ndims=(1,)
+0001d980: 2c0a 2020 2020 2020 2020 2020 2020 6163  ,.            ac
+0001d990: 6365 7074 6564 5f64 7479 7065 733d 280a  cepted_dtypes=(.
+0001d9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d9b0: 6e70 2e69 6e74 3634 2c0a 2020 2020 2020  np.int64,.      
+0001d9c0: 2020 2020 2020 2020 2020 6e70 2e69 6e74            np.int
+0001d9d0: 3332 2c0a 2020 2020 2020 2020 2020 2020  32,.            
+0001d9e0: 2020 2020 6e70 2e69 6e74 382c 0a20 2020      np.int8,.   
+0001d9f0: 2020 2020 2020 2020 2020 2020 206e 702e               np.
+0001da00: 666c 6f61 7433 322c 0a20 2020 2020 2020  float32,.       
+0001da10: 2020 2020 2020 2020 206e 702e 666c 6f61           np.floa
+0001da20: 7436 342c 0a20 2020 2020 2020 2020 2020  t64,.           
+0001da30: 2020 2020 2069 6e74 2c0a 2020 2020 2020       int,.      
+0001da40: 2020 2020 2020 2020 2020 666c 6f61 742c            float,
+0001da50: 0a20 2020 2020 2020 2020 2020 2029 2c0a  .            ),.
+0001da60: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0001da70: 2020 6368 6563 6b5f 7661 6c69 645f 6172    check_valid_ar
+0001da80: 7261 7928 0a20 2020 2020 2020 2020 2020  ray(.           
+0001da90: 2064 6174 613d 792c 0a20 2020 2020 2020   data=y,.       
+0001daa0: 2020 2020 2073 6f75 7263 653d 5374 6174       source=Stat
+0001dab0: 6973 7469 6373 2e68 656c 6c69 6e67 6572  istics.hellinger
+0001dac0: 5f64 6973 7461 6e63 652e 5f5f 6e61 6d65  _distance.__name
+0001dad0: 5f5f 2c0a 2020 2020 2020 2020 2020 2020  __,.            
+0001dae0: 6163 6365 7074 6564 5f6e 6469 6d73 3d28  accepted_ndims=(
+0001daf0: 312c 292c 0a20 2020 2020 2020 2020 2020  1,),.           
+0001db00: 2061 6363 6570 7465 645f 6474 7970 6573   accepted_dtypes
+0001db10: 3d28 0a20 2020 2020 2020 2020 2020 2020  =(.             
+0001db20: 2020 206e 702e 696e 7436 342c 0a20 2020     np.int64,.   
+0001db30: 2020 2020 2020 2020 2020 2020 206e 702e               np.
+0001db40: 696e 7433 322c 0a20 2020 2020 2020 2020  int32,.         
+0001db50: 2020 2020 2020 206e 702e 696e 7438 2c0a         np.int8,.
+0001db60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001db70: 6e70 2e66 6c6f 6174 3332 2c0a 2020 2020  np.float32,.    
+0001db80: 2020 2020 2020 2020 2020 2020 6e70 2e66              np.f
+0001db90: 6c6f 6174 3634 2c0a 2020 2020 2020 2020  loat64,.        
+0001dba0: 2020 2020 2020 2020 696e 742c 0a20 2020          int,.   
+0001dbb0: 2020 2020 2020 2020 2020 2020 2066 6c6f               flo
+0001dbc0: 6174 2c0a 2020 2020 2020 2020 2020 2020  at,.            
+0001dbd0: 292c 0a20 2020 2020 2020 2029 0a20 2020  ),.        ).   
+0001dbe0: 2020 2020 2063 6865 636b 5f73 7472 280a       check_str(.
+0001dbf0: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+0001dc00: 3d66 227b 5374 6174 6973 7469 6373 2e68  =f"{Statistics.h
+0001dc10: 656c 6c69 6e67 6572 5f64 6973 7461 6e63  ellinger_distanc
+0001dc20: 652e 5f5f 6e61 6d65 5f5f 7d20 6d65 7468  e.__name__} meth
+0001dc30: 6f64 222c 0a20 2020 2020 2020 2020 2020  od",.           
+0001dc40: 2076 616c 7565 3d62 7563 6b65 745f 6d65   value=bucket_me
+0001dc50: 7468 6f64 2c0a 2020 2020 2020 2020 2020  thod,.          
+0001dc60: 2020 6f70 7469 6f6e 733d 4f70 7469 6f6e    options=Option
+0001dc70: 732e 4255 434b 4554 5f4d 4554 484f 4453  s.BUCKET_METHODS
+0001dc80: 2e76 616c 7565 2c0a 2020 2020 2020 2020  .value,.        
+0001dc90: 290a 2020 2020 2020 2020 6269 6e5f 7769  ).        bin_wi
+0001dca0: 6474 682c 2062 696e 5f63 6f75 6e74 203d  dth, bin_count =
+0001dcb0: 2062 7563 6b65 745f 6461 7461 2864 6174   bucket_data(dat
+0001dcc0: 613d 782c 206d 6574 686f 643d 6275 636b  a=x, method=buck
+0001dcd0: 6574 5f6d 6574 686f 6429 0a20 2020 2020  et_method).     
+0001dce0: 2020 2073 315f 6820 3d20 7365 6c66 2e5f     s1_h = self._
+0001dcf0: 6869 7374 5f31 6428 0a20 2020 2020 2020  hist_1d(.       
+0001dd00: 2020 2020 2064 6174 613d 782c 2062 696e       data=x, bin
+0001dd10: 5f63 6f75 6e74 3d62 696e 5f63 6f75 6e74  _count=bin_count
+0001dd20: 2c20 7261 6e67 653d 6e70 2e61 7272 6179  , range=np.array
+0001dd30: 285b 302c 2069 6e74 2862 696e 5f77 6964  ([0, int(bin_wid
+0001dd40: 7468 202a 2062 696e 5f63 6f75 6e74 295d  th * bin_count)]
+0001dd50: 290a 2020 2020 2020 2020 290a 2020 2020  ).        ).    
+0001dd60: 2020 2020 7332 5f68 203d 2073 656c 662e      s2_h = self.
+0001dd70: 5f68 6973 745f 3164 280a 2020 2020 2020  _hist_1d(.      
+0001dd80: 2020 2020 2020 6461 7461 3d79 2c20 6269        data=y, bi
+0001dd90: 6e5f 636f 756e 743d 6269 6e5f 636f 756e  n_count=bin_coun
+0001dda0: 742c 2072 616e 6765 3d6e 702e 6172 7261  t, range=np.arra
+0001ddb0: 7928 5b30 2c20 696e 7428 6269 6e5f 7769  y([0, int(bin_wi
+0001ddc0: 6474 6820 2a20 6269 6e5f 636f 756e 7429  dth * bin_count)
+0001ddd0: 5d29 0a20 2020 2020 2020 2029 0a20 2020  ]).        ).   
+0001dde0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0001ddf0: 2e5f 6865 6c6c 696e 6765 725f 6865 6c70  ._hellinger_help
+0001de00: 6572 280a 2020 2020 2020 2020 2020 2020  er(.            
+0001de10: 783d 7331 5f68 2e61 7374 7970 6528 6e70  x=s1_h.astype(np
+0001de20: 2e66 6c6f 6174 3332 292c 2079 3d73 325f  .float32), y=s2_
+0001de30: 682e 6173 7479 7065 286e 702e 666c 6f61  h.astype(np.floa
+0001de40: 7433 3229 0a20 2020 2020 2020 2029 0a0a  t32).        )..
+0001de50: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
+0001de60: 640a 2020 2020 406e 6a69 7428 2228 696e  d.    @njit("(in
+0001de70: 7436 345b 3a5d 2c69 6e74 3634 5b3a 5d29  t64[:],int64[:])
+0001de80: 2229 0a20 2020 2064 6566 2063 6f68 656e  ").    def cohen
+0001de90: 735f 6b61 7070 6128 7361 6d70 6c65 5f31  s_kappa(sample_1
+0001dea0: 3a20 6e70 2e6e 6461 7272 6179 2c20 7361  : np.ndarray, sa
+0001deb0: 6d70 6c65 5f32 3a20 6e70 2e6e 6461 7272  mple_2: np.ndarr
+0001dec0: 6179 293a 0a20 2020 2020 2020 2022 2222  ay):.        """
+0001ded0: 0a20 2020 2020 2020 204a 6974 7465 6420  .        Jitted 
+0001dee0: 636f 6d70 7574 6520 436f 6865 6e27 7320  compute Cohen's 
+0001def0: 4b61 7070 6120 636f 6566 6669 6369 656e  Kappa coefficien
+0001df00: 7420 666f 7220 7477 6f20 6269 6e61 7279  t for two binary
+0001df10: 2073 616d 706c 6573 2e0a 0a20 2020 2020   samples...     
+0001df20: 2020 2043 6f68 656e 2773 204b 6170 7061     Cohen's Kappa
+0001df30: 2063 6f65 6666 6963 6965 6e74 2062 6574   coefficient bet
+0001df40: 7765 656e 2063 6c61 7373 6966 6963 6174  ween classificat
+0001df50: 696f 6e73 2061 6e64 2067 726f 756e 6420  ions and ground 
+0001df60: 7472 7574 6820 7461 6b69 6e67 2069 6e74  truth taking int
+0001df70: 6f20 6163 636f 756e 7420 6167 7265 656d  o account agreem
+0001df80: 656e 7420 6265 7477 6565 6e20 636c 6173  ent between clas
+0001df90: 7369 6669 6361 7469 6f6e 7320 616e 6420  sifications and 
+0001dfa0: 6772 6f75 6e64 2074 7275 7468 206f 6363  ground truth occ
+0001dfb0: 7572 7269 6e67 2062 7920 6368 616e 6365  urring by chance
+0001dfc0: 2e0a 2020 2020 2020 2020 496e 7465 7270  ..        Interp
+0001dfd0: 7265 7461 7469 6f6e 3a20 3e30 2e38 0941  retation: >0.8.A
+0001dfe0: 6c6d 6f73 7420 5065 7266 6563 742c 203e  lmost Perfect, >
+0001dff0: 302e 3609 5375 6273 7461 6e74 6961 6c2c  0.6.Substantial,
+0001e000: 2020 3e30 2e34 094d 6f64 6572 6174 6520    >0.4.Moderate 
+0001e010: 3e30 2e32 0946 6169 722c 2030 2d30 2c32  >0.2.Fair, 0-0,2
+0001e020: 0953 6c69 6768 742c 203c 3009 506f 6f72  .Slight, <0.Poor
+0001e030: 2028 204c 616e 6469 7320 2620 4b6f 6368   ( Landis & Koch
+0001e040: 2028 3139 3737 2929 2e0a 0a20 2020 2020   (1977))...     
+0001e050: 2020 203a 6578 616d 706c 653a 0a20 2020     :example:.   
+0001e060: 2020 2020 203e 3e3e 2073 616d 706c 655f       >>> sample_
+0001e070: 3120 3d20 6e70 2e72 616e 646f 6d2e 7261  1 = np.random.ra
+0001e080: 6e64 696e 7428 302c 2032 2c20 7369 7a65  ndint(0, 2, size
+0001e090: 3d28 3130 3030 302c 2929 0a20 2020 2020  =(10000,)).     
+0001e0a0: 2020 203e 3e3e 2073 616d 706c 655f 3220     >>> sample_2 
+0001e0b0: 3d20 6e70 2e72 616e 646f 6d2e 7261 6e64  = np.random.rand
+0001e0c0: 696e 7428 302c 2032 2c20 7369 7a65 3d28  int(0, 2, size=(
+0001e0d0: 3130 3030 302c 2929 0a20 2020 2020 2020  10000,)).       
+0001e0e0: 203e 3e3e 2053 7461 7469 7374 6963 732e   >>> Statistics.
+0001e0f0: 636f 6865 6e73 5f6b 6170 7061 2873 616d  cohens_kappa(sam
+0001e100: 706c 655f 313d 7361 6d70 6c65 5f31 2c20  ple_1=sample_1, 
+0001e110: 7361 6d70 6c65 5f32 3d73 616d 706c 655f  sample_2=sample_
+0001e120: 3229 290a 2020 2020 2020 2020 2222 220a  2)).        """.
+0001e130: 2020 2020 2020 2020 7361 6d70 6c65 5f31          sample_1
+0001e140: 203d 206e 702e 6173 636f 6e74 6967 756f   = np.ascontiguo
+0001e150: 7573 6172 7261 7928 7361 6d70 6c65 5f31  usarray(sample_1
+0001e160: 290a 2020 2020 2020 2020 7361 6d70 6c65  ).        sample
+0001e170: 5f32 203d 206e 702e 6173 636f 6e74 6967  _2 = np.ascontig
+0001e180: 756f 7573 6172 7261 7928 7361 6d70 6c65  uousarray(sample
+0001e190: 5f32 290a 2020 2020 2020 2020 6461 7461  _2).        data
+0001e1a0: 203d 206e 702e 6873 7461 636b 2828 7361   = np.hstack((sa
+0001e1b0: 6d70 6c65 5f31 2e72 6573 6861 7065 282d  mple_1.reshape(-
+0001e1c0: 312c 2031 292c 2073 616d 706c 655f 322e  1, 1), sample_2.
+0001e1d0: 7265 7368 6170 6528 2d31 2c20 3129 2929  reshape(-1, 1)))
+0001e1e0: 0a20 2020 2020 2020 2074 7020 3d20 6c65  .        tp = le
+0001e1f0: 6e28 6e70 2e61 7267 7768 6572 6528 2864  n(np.argwhere((d
+0001e200: 6174 615b 3a2c 2030 5d20 3d3d 2031 2920  ata[:, 0] == 1) 
+0001e210: 2620 2864 6174 615b 3a2c 2031 5d20 3d3d  & (data[:, 1] ==
+0001e220: 2031 2929 2e66 6c61 7474 656e 2829 290a   1)).flatten()).
+0001e230: 2020 2020 2020 2020 746e 203d 206c 656e          tn = len
+0001e240: 286e 702e 6172 6777 6865 7265 2828 6461  (np.argwhere((da
+0001e250: 7461 5b3a 2c20 305d 203d 3d20 3029 2026  ta[:, 0] == 0) &
+0001e260: 2028 6461 7461 5b3a 2c20 315d 203d 3d20   (data[:, 1] == 
+0001e270: 3029 292e 666c 6174 7465 6e28 2929 0a20  0)).flatten()). 
+0001e280: 2020 2020 2020 2066 7020 3d20 6c65 6e28         fp = len(
+0001e290: 6e70 2e61 7267 7768 6572 6528 2864 6174  np.argwhere((dat
+0001e2a0: 615b 3a2c 2030 5d20 3d3d 2031 2920 2620  a[:, 0] == 1) & 
+0001e2b0: 2864 6174 615b 3a2c 2031 5d20 3d3d 2030  (data[:, 1] == 0
+0001e2c0: 2929 2e66 6c61 7474 656e 2829 290a 2020  )).flatten()).  
+0001e2d0: 2020 2020 2020 666e 203d 206c 656e 286e        fn = len(n
+0001e2e0: 702e 6172 6777 6865 7265 2828 6461 7461  p.argwhere((data
+0001e2f0: 5b3a 2c20 305d 203d 3d20 3029 2026 2028  [:, 0] == 0) & (
+0001e300: 6461 7461 5b3a 2c20 315d 203d 3d20 3129  data[:, 1] == 1)
+0001e310: 292e 666c 6174 7465 6e28 2929 0a20 2020  ).flatten()).   
+0001e320: 2020 2020 2064 6174 6120 3d20 6e70 2e61       data = np.a
+0001e330: 7272 6179 2828 5b74 702c 2066 705d 2c20  rray(([tp, fp], 
+0001e340: 5b66 6e2c 2074 6e5d 2929 0a20 2020 2020  [fn, tn])).     
+0001e350: 2020 2073 756d 3020 3d20 6461 7461 2e73     sum0 = data.s
+0001e360: 756d 2861 7869 733d 3029 0a20 2020 2020  um(axis=0).     
+0001e370: 2020 2073 756d 3120 3d20 6461 7461 2e73     sum1 = data.s
+0001e380: 756d 2861 7869 733d 3129 0a20 2020 2020  um(axis=1).     
+0001e390: 2020 2065 7870 6563 7465 6420 3d20 6e70     expected = np
+0001e3a0: 2e6f 7574 6572 2873 756d 302c 2073 756d  .outer(sum0, sum
+0001e3b0: 3129 202f 206e 702e 7375 6d28 7375 6d30  1) / np.sum(sum0
+0001e3c0: 290a 2020 2020 2020 2020 775f 6d61 7420  ).        w_mat 
+0001e3d0: 3d20 6e70 2e66 756c 6c28 7368 6170 653d  = np.full(shape=
+0001e3e0: 2832 2c20 3229 2c20 6669 6c6c 5f76 616c  (2, 2), fill_val
+0001e3f0: 7565 3d31 290a 2020 2020 2020 2020 775f  ue=1).        w_
+0001e400: 6d61 745b 302c 2030 5d20 3d20 300a 2020  mat[0, 0] = 0.  
+0001e410: 2020 2020 2020 775f 6d61 745b 312c 2031        w_mat[1, 1
+0001e420: 5d20 3d20 300a 2020 2020 2020 2020 7265  ] = 0.        re
+0001e430: 7475 726e 2031 202d 206e 702e 7375 6d28  turn 1 - np.sum(
+0001e440: 775f 6d61 7420 2a20 6461 7461 2920 2f20  w_mat * data) / 
+0001e450: 6e70 2e73 756d 2877 5f6d 6174 202a 2065  np.sum(w_mat * e
+0001e460: 7870 6563 7465 6429 0a0a 2020 2020 4073  xpected)..    @s
+0001e470: 7461 7469 636d 6574 686f 640a 2020 2020  taticmethod.    
+0001e480: 6465 6620 645f 7072 696d 6528 0a20 2020  def d_prime(.   
+0001e490: 2020 2020 2078 3a20 6e70 2e6e 6461 7272       x: np.ndarr
+0001e4a0: 6179 2c0a 2020 2020 2020 2020 793a 206e  ay,.        y: n
+0001e4b0: 702e 6e64 6172 7261 792c 0a20 2020 2020  p.ndarray,.     
+0001e4c0: 2020 206c 6f77 6572 5f6c 696d 6974 3a20     lower_limit: 
+0001e4d0: 4f70 7469 6f6e 616c 5b66 6c6f 6174 5d20  Optional[float] 
+0001e4e0: 3d20 302e 3030 3031 2c0a 2020 2020 2020  = 0.0001,.      
+0001e4f0: 2020 7570 7065 725f 6c69 6d69 743a 204f    upper_limit: O
+0001e500: 7074 696f 6e61 6c5b 666c 6f61 745d 203d  ptional[float] =
+0001e510: 2030 2e39 3939 392c 0a20 2020 2029 202d   0.9999,.    ) -
+0001e520: 3e20 666c 6f61 743a 0a20 2020 2020 2020  > float:.       
+0001e530: 2022 2222 0a20 2020 2020 2020 2043 6f6d   """.        Com
+0001e540: 7075 7465 7320 642d 7072 696d 6520 6672  putes d-prime fr
+0001e550: 6f6d 2074 776f 2042 6f6f 6c65 616e 2031  om two Boolean 1
+0001e560: 6420 6172 7261 7973 2c20 652e 672e 2c20  d arrays, e.g., 
+0001e570: 6265 7477 6565 6e20 636c 6173 7369 6669  between classifi
+0001e580: 6361 7469 6f6e 7320 616e 6420 6772 6f75  cations and grou
+0001e590: 6e64 2074 7275 7468 2e0a 0a20 2020 2020  nd truth...     
+0001e5a0: 2020 203a 7061 7261 6d20 6e70 2e6e 6461     :param np.nda
+0001e5b0: 7272 6179 2078 3a20 426f 6f6c 6561 6e20  rray x: Boolean 
+0001e5c0: 3144 2061 7272 6179 206f 6620 7265 7370  1D array of resp
+0001e5d0: 6f6e 7365 2076 616c 7565 732c 2077 6865  onse values, whe
+0001e5e0: 7265 2031 2072 6570 7265 7365 6e74 7320  re 1 represents 
+0001e5f0: 7072 6573 656e 6365 2c20 616e 6420 3020  presence, and 0 
+0001e600: 7265 7072 6573 656e 7469 6e67 2061 6273  representing abs
+0001e610: 656e 6365 2e0a 2020 2020 2020 2020 3a70  ence..        :p
+0001e620: 6172 616d 206e 702e 6e64 6172 7261 7920  aram np.ndarray 
+0001e630: 793a 2042 6f6f 6c65 616e 2031 4420 6172  y: Boolean 1D ar
+0001e640: 7261 7920 6f66 2067 726f 756e 6420 7472  ray of ground tr
+0001e650: 7574 682c 2077 6865 7265 2031 2072 6570  uth, where 1 rep
+0001e660: 7265 7365 6e74 7320 7072 6573 656e 6365  resents presence
+0001e670: 2c20 616e 6420 3020 7265 7072 6573 656e  , and 0 represen
+0001e680: 7469 6e67 2061 6273 656e 6365 2e0a 2020  ting absence..  
+0001e690: 2020 2020 2020 3a70 6172 616d 204f 7074        :param Opt
+0001e6a0: 696f 6e61 6c5b 666c 6f61 745d 206c 6f77  ional[float] low
+0001e6b0: 6572 5f6c 696d 6974 3a20 4c6f 7765 7220  er_limit: Lower 
+0001e6c0: 6c69 6d69 7420 746f 2062 6f75 6e64 2068  limit to bound h
+0001e6d0: 6974 2061 6e64 2066 616c 7365 2061 6c61  it and false ala
+0001e6e0: 726d 2072 6174 6573 2e20 4465 6661 756c  rm rates. Defaul
+0001e6f0: 7473 2074 6f20 302e 3030 3031 2e0a 2020  ts to 0.0001..  
+0001e700: 2020 2020 2020 3a70 6172 616d 204f 7074        :param Opt
+0001e710: 696f 6e61 6c5b 666c 6f61 745d 2075 7070  ional[float] upp
+0001e720: 6572 5f6c 696d 6974 3a20 5570 7065 7220  er_limit: Upper 
+0001e730: 6c69 6d69 7420 746f 2062 6f75 6e64 2068  limit to bound h
+0001e740: 6974 2061 6e64 2066 616c 7365 2061 6c61  it and false ala
+0001e750: 726d 2072 6174 6573 2e20 4465 6661 756c  rm rates. Defaul
+0001e760: 7473 2074 6f20 302e 3939 3939 2e0a 2020  ts to 0.9999..  
+0001e770: 2020 2020 2020 3a72 6574 7572 6e20 666c        :return fl
+0001e780: 6f61 743a 2054 6865 2063 616c 6375 6c61  oat: The calcula
+0001e790: 7465 6420 6427 2028 642d 7072 696d 6529  ted d' (d-prime)
+0001e7a0: 2076 616c 7565 2e0a 0a20 2020 2020 2020   value...       
+0001e7b0: 203a 6578 616d 706c 653a 0a20 2020 2020   :example:.     
+0001e7c0: 2020 203e 3e3e 2078 203d 206e 702e 7261     >>> x = np.ra
+0001e7d0: 6e64 6f6d 2e72 616e 6469 6e74 2830 2c20  ndom.randint(0, 
+0001e7e0: 322c 2028 3130 3030 2c29 290a 2020 2020  2, (1000,)).    
+0001e7f0: 2020 2020 3e3e 3e20 7920 3d20 6e70 2e72      >>> y = np.r
+0001e800: 616e 646f 6d2e 7261 6e64 696e 7428 302c  andom.randint(0,
+0001e810: 2032 2c20 2831 3030 302c 2929 0a20 2020   2, (1000,)).   
+0001e820: 2020 2020 203e 3e3e 2053 7461 7469 7374       >>> Statist
+0001e830: 6963 732e 645f 7072 696d 6528 783d 782c  ics.d_prime(x=x,
+0001e840: 2079 3d79 290a 2020 2020 2020 2020 2222   y=y).        ""
+0001e850: 220a 0a20 2020 2020 2020 2063 6865 636b  "..        check
+0001e860: 5f76 616c 6964 5f61 7272 6179 280a 2020  _valid_array(.  
+0001e870: 2020 2020 2020 2020 2020 6461 7461 3d78            data=x
+0001e880: 2c0a 2020 2020 2020 2020 2020 2020 736f  ,.            so
+0001e890: 7572 6365 3d53 7461 7469 7374 6963 732e  urce=Statistics.
+0001e8a0: 645f 7072 696d 652e 5f5f 6e61 6d65 5f5f  d_prime.__name__
+0001e8b0: 2c0a 2020 2020 2020 2020 2020 2020 6163  ,.            ac
+0001e8c0: 6365 7074 6564 5f6e 6469 6d73 3d28 312c  cepted_ndims=(1,
+0001e8d0: 292c 0a20 2020 2020 2020 2020 2020 2061  ),.            a
+0001e8e0: 6363 6570 7465 645f 6474 7970 6573 3d28  ccepted_dtypes=(
+0001e8f0: 6e70 2e69 6e74 3634 2c20 6e70 2e69 6e74  np.int64, np.int
+0001e900: 3332 2c20 6e70 2e69 6e74 3829 2c0a 2020  32, np.int8),.  
+0001e910: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0001e920: 6368 6563 6b5f 7661 6c69 645f 6172 7261  check_valid_arra
+0001e930: 7928 0a20 2020 2020 2020 2020 2020 2064  y(.            d
+0001e940: 6174 613d 792c 0a20 2020 2020 2020 2020  ata=y,.         
+0001e950: 2020 2073 6f75 7263 653d 5374 6174 6973     source=Statis
+0001e960: 7469 6373 2e64 5f70 7269 6d65 2e5f 5f6e  tics.d_prime.__n
+0001e970: 616d 655f 5f2c 0a20 2020 2020 2020 2020  ame__,.         
+0001e980: 2020 2061 6363 6570 7465 645f 6e64 696d     accepted_ndim
+0001e990: 733d 2831 2c29 2c0a 2020 2020 2020 2020  s=(1,),.        
+0001e9a0: 2020 2020 6163 6365 7074 6564 5f64 7479      accepted_dty
+0001e9b0: 7065 733d 286e 702e 696e 7436 342c 206e  pes=(np.int64, n
+0001e9c0: 702e 696e 7433 322c 206e 702e 696e 7438  p.int32, np.int8
+0001e9d0: 292c 0a20 2020 2020 2020 2029 0a20 2020  ),.        ).   
+0001e9e0: 2020 2020 2069 6620 6c65 6e28 6c69 7374       if len(list
+0001e9f0: 287b 782e 7368 6170 655b 305d 2c20 792e  ({x.shape[0], y.
+0001ea00: 7368 6170 655b 305d 7d29 2920 213d 2031  shape[0]})) != 1
+0001ea10: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0001ea20: 6973 6520 436f 756e 7445 7272 6f72 280a  ise CountError(.
+0001ea30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ea40: 6d73 673d 6622 5468 6520 7477 6f20 6172  msg=f"The two ar
+0001ea50: 7261 7973 2068 6173 2074 6f20 6265 2065  rays has to be e
+0001ea60: 7175 616c 206c 656e 6774 6873 2062 7574  qual lengths but
+0001ea70: 2067 6f74 3a20 7b78 2e73 6861 7065 5b30   got: {x.shape[0
+0001ea80: 5d2c 2079 2e73 6861 7065 5b30 5d7d 222c  ], y.shape[0]}",
+0001ea90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001eaa0: 2073 6f75 7263 653d 5374 6174 6973 7469   source=Statisti
+0001eab0: 6373 2e64 5f70 7269 6d65 2e5f 5f6e 616d  cs.d_prime.__nam
+0001eac0: 655f 5f2c 0a20 2020 2020 2020 2020 2020  e__,.           
+0001ead0: 2029 0a20 2020 2020 2020 2066 6f72 2069   ).        for i
+0001eae0: 2069 6e20 5b78 2c20 795d 3a0a 2020 2020   in [x, y]:.    
+0001eaf0: 2020 2020 2020 2020 6164 6469 7469 6f6e          addition
+0001eb00: 616c 203d 206c 6973 7428 7365 7428 6c69  al = list(set(li
+0001eb10: 7374 286e 702e 736f 7274 286e 702e 756e  st(np.sort(np.un
+0001eb20: 6971 7565 2869 2929 2929 202d 207b 302c  ique(i)))) - {0,
+0001eb30: 2031 7d29 0a20 2020 2020 2020 2020 2020   1}).           
+0001eb40: 2069 6620 6c65 6e28 6164 6469 7469 6f6e   if len(addition
+0001eb50: 616c 2920 3e20 303a 0a20 2020 2020 2020  al) > 0:.       
+0001eb60: 2020 2020 2020 2020 2072 6169 7365 2049           raise I
+0001eb70: 6e76 616c 6964 496e 7075 7445 7272 6f72  nvalidInputError
+0001eb80: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001eb90: 2020 2020 2020 6d73 673d 6622 442d 7072        msg=f"D-pr
+0001eba0: 696d 6520 7265 7175 6972 6573 2062 696e  ime requires bin
+0001ebb0: 6172 7920 696e 7075 7420 6461 7461 2062  ary input data b
+0001ebc0: 7574 2066 6f75 6e64 207b 6164 6469 7469  ut found {additi
+0001ebd0: 6f6e 616c 7d22 2c0a 2020 2020 2020 2020  onal}",.        
+0001ebe0: 2020 2020 2020 2020 2020 2020 736f 7572              sour
+0001ebf0: 6365 3d53 7461 7469 7374 6963 732e 645f  ce=Statistics.d_
+0001ec00: 7072 696d 6528 292e 5f5f 6e61 6d65 5f5f  prime().__name__
+0001ec10: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001ec20: 2020 290a 2020 2020 2020 2020 7461 7267    ).        targ
+0001ec30: 6574 5f69 6478 203d 206e 702e 6172 6777  et_idx = np.argw
+0001ec40: 6865 7265 2879 203d 3d20 3129 2e66 6c61  here(y == 1).fla
+0001ec50: 7474 656e 2829 0a20 2020 2020 2020 2068  tten().        h
+0001ec60: 6974 5f72 6174 6520 3d20 6e70 2e73 756d  it_rate = np.sum
+0001ec70: 2878 5b6e 702e 6172 6777 6865 7265 2879  (x[np.argwhere(y
+0001ec80: 203d 3d20 3129 5d29 202f 2074 6172 6765   == 1)]) / targe
+0001ec90: 745f 6964 782e 7368 6170 655b 305d 0a20  t_idx.shape[0]. 
+0001eca0: 2020 2020 2020 2066 616c 7365 5f61 6c61         false_ala
+0001ecb0: 726d 5f72 6174 6520 3d20 6e70 2e73 756d  rm_rate = np.sum
+0001ecc0: 2878 5b6e 702e 6172 6777 6865 7265 2879  (x[np.argwhere(y
+0001ecd0: 203d 3d20 3029 5d29 202f 2074 6172 6765   == 0)]) / targe
+0001ece0: 745f 6964 782e 7368 6170 655b 305d 0a20  t_idx.shape[0]. 
+0001ecf0: 2020 2020 2020 2069 6620 6869 745f 7261         if hit_ra
+0001ed00: 7465 203c 206c 6f77 6572 5f6c 696d 6974  te < lower_limit
+0001ed10: 3a0a 2020 2020 2020 2020 2020 2020 6869  :.            hi
+0001ed20: 745f 7261 7465 203d 206c 6f77 6572 5f6c  t_rate = lower_l
+0001ed30: 696d 6974 0a20 2020 2020 2020 2065 6c69  imit.        eli
+0001ed40: 6620 6869 745f 7261 7465 203e 2075 7070  f hit_rate > upp
+0001ed50: 6572 5f6c 696d 6974 3a0a 2020 2020 2020  er_limit:.      
+0001ed60: 2020 2020 2020 6869 745f 7261 7465 203d        hit_rate =
+0001ed70: 2075 7070 6572 5f6c 696d 6974 0a20 2020   upper_limit.   
+0001ed80: 2020 2020 2069 6620 6661 6c73 655f 616c       if false_al
+0001ed90: 6172 6d5f 7261 7465 203c 206c 6f77 6572  arm_rate < lower
+0001eda0: 5f6c 696d 6974 3a0a 2020 2020 2020 2020  _limit:.        
+0001edb0: 2020 2020 6661 6c73 655f 616c 6172 6d5f      false_alarm_
+0001edc0: 7261 7465 203d 206c 6f77 6572 5f6c 696d  rate = lower_lim
+0001edd0: 6974 0a20 2020 2020 2020 2065 6c69 6620  it.        elif 
+0001ede0: 6661 6c73 655f 616c 6172 6d5f 7261 7465  false_alarm_rate
+0001edf0: 203e 2075 7070 6572 5f6c 696d 6974 3a0a   > upper_limit:.
+0001ee00: 2020 2020 2020 2020 2020 2020 6661 6c73              fals
+0001ee10: 655f 616c 6172 6d5f 7261 7465 203d 2075  e_alarm_rate = u
+0001ee20: 7070 6572 5f6c 696d 6974 0a20 2020 2020  pper_limit.     
+0001ee30: 2020 2072 6574 7572 6e20 7374 6174 732e     return stats.
+0001ee40: 6e6f 726d 2e70 7066 2868 6974 5f72 6174  norm.ppf(hit_rat
+0001ee50: 6529 202d 2073 7461 7473 2e6e 6f72 6d2e  e) - stats.norm.
+0001ee60: 7070 6628 6661 6c73 655f 616c 6172 6d5f  ppf(false_alarm_
+0001ee70: 7261 7465 290a 0a20 2020 2040 7374 6174  rate)..    @stat
+0001ee80: 6963 6d65 7468 6f64 0a20 2020 2064 6566  icmethod.    def
+0001ee90: 206d 636e 656d 6172 280a 2020 2020 2020   mcnemar(.      
+0001eea0: 2020 783a 206e 702e 6e64 6172 7261 792c    x: np.ndarray,
+0001eeb0: 0a20 2020 2020 2020 2079 3a20 6e70 2e6e  .        y: np.n
+0001eec0: 6461 7272 6179 2c0a 2020 2020 2020 2020  darray,.        
+0001eed0: 6772 6f75 6e64 5f74 7275 7468 3a20 6e70  ground_truth: np
+0001eee0: 2e6e 6461 7272 6179 2c0a 2020 2020 2020  .ndarray,.      
+0001eef0: 2020 636f 6e74 696e 7569 7479 5f63 6f72    continuity_cor
+0001ef00: 7265 6374 6564 3a20 4f70 7469 6f6e 616c  rected: Optional
+0001ef10: 5b62 6f6f 6c5d 203d 2054 7275 652c 0a20  [bool] = True,. 
+0001ef20: 2020 2029 202d 3e20 5475 706c 655b 666c     ) -> Tuple[fl
+0001ef30: 6f61 742c 2066 6c6f 6174 5d3a 0a20 2020  oat, float]:.   
+0001ef40: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001ef50: 204d 634e 656d 6172 2773 2074 6573 7420   McNemar's test 
+0001ef60: 746f 2063 6f6d 7061 7265 2074 6865 2064  to compare the d
+0001ef70: 6966 6665 7265 6e63 6520 696e 2070 7265  ifference in pre
+0001ef80: 6469 6374 6976 6520 6163 6375 7261 6379  dictive accuracy
+0001ef90: 206f 6620 7477 6f20 6d6f 6465 6c73 2e0a   of two models..
+0001efa0: 0a20 2020 2020 2020 2045 2e67 2e2c 2063  .        E.g., c
+0001efb0: 616e 2062 6520 7573 6564 2074 6f20 636f  an be used to co
+0001efc0: 6d70 7574 6520 6966 2074 6865 2061 6363  mpute if the acc
+0001efd0: 7572 6163 7920 6f66 2074 776f 2063 6c61  uracy of two cla
+0001efe0: 7373 6966 6965 7273 2061 7265 2073 6967  ssifiers are sig
+0001eff0: 6e69 6669 6361 6e74 6c79 2064 6966 6665  nificantly diffe
+0001f000: 7265 6e74 2077 6865 6e20 7472 616e 7366  rent when transf
+0001f010: 6f72 6d69 6e67 2074 6865 2073 616d 6520  orming the same 
+0001f020: 6461 7461 2e0a 0a20 2020 2020 2020 202e  data...        .
+0001f030: 2e20 6e6f 7465 3a3a 0a20 2020 2020 2020  . note::.       
+0001f040: 2020 2020 606d 6c65 7874 656e 6420 3c68      `mlextend <h
+0001f050: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+0001f060: 6d2f 7261 7362 742f 6d6c 7874 656e 642f  m/rasbt/mlxtend/
+0001f070: 626c 6f62 2f6d 6173 7465 722f 6d6c 7874  blob/master/mlxt
+0001f080: 656e 642f 6576 616c 7561 7465 2f6d 636e  end/evaluate/mcn
+0001f090: 656d 6172 2e70 793e 605f 5f2e 0a0a 2020  emar.py>`__...  
+0001f0a0: 2020 2020 2020 3a70 6172 616d 206e 702e        :param np.
+0001f0b0: 6e64 6172 7261 7920 783a 2031 2d64 696d  ndarray x: 1-dim
+0001f0c0: 656e 7369 6f6e 616c 2042 6f6f 6c65 616e  ensional Boolean
+0001f0d0: 2061 7272 6179 2077 6974 6820 7072 6564   array with pred
+0001f0e0: 6963 7469 6f6e 7320 6f66 2074 6865 2066  ictions of the f
+0001f0f0: 6972 7374 206d 6f64 656c 2e0a 2020 2020  irst model..    
+0001f100: 2020 2020 3a70 6172 616d 206e 702e 6e64      :param np.nd
+0001f110: 6172 7261 7920 783a 2031 2d64 696d 656e  array x: 1-dimen
+0001f120: 7369 6f6e 616c 2042 6f6f 6c65 616e 2061  sional Boolean a
+0001f130: 7272 6179 2077 6974 6820 7072 6564 6963  rray with predic
+0001f140: 7469 6f6e 7320 6f66 2074 6865 2073 6563  tions of the sec
+0001f150: 6f6e 6420 6d6f 6465 6c2e 0a20 2020 2020  ond model..     
+0001f160: 2020 203a 7061 7261 6d20 6e70 2e6e 6461     :param np.nda
+0001f170: 7272 6179 2078 3a20 312d 6469 6d65 6e73  rray x: 1-dimens
+0001f180: 696f 6e61 6c20 426f 6f6c 6561 6e20 6172  ional Boolean ar
+0001f190: 7261 7920 7769 7468 2067 726f 756e 6420  ray with ground 
+0001f1a0: 7472 7574 6820 6c61 6265 6c73 2e0a 2020  truth labels..  
+0001f1b0: 2020 2020 2020 3a70 6172 616d 204f 7074        :param Opt
+0001f1c0: 696f 6e61 6c5b 626f 6f6c 5d20 636f 6e74  ional[bool] cont
+0001f1d0: 696e 7569 7479 5f63 6f72 7265 6374 6564  inuity_corrected
+0001f1e0: 203a 2057 6865 7468 6572 2074 6f20 6170   : Whether to ap
+0001f1f0: 706c 7920 636f 6e74 696e 7569 7479 2063  ply continuity c
+0001f200: 6f72 7265 6374 696f 6e2e 2044 6566 6175  orrection. Defau
+0001f210: 6c74 2069 7320 5472 7565 2e0a 0a20 2020  lt is True...   
+0001f220: 2020 2020 203a 6578 616d 706c 653a 0a20       :example:. 
+0001f230: 2020 2020 2020 203e 3e3e 2078 203d 206e         >>> x = n
+0001f240: 702e 7261 6e64 6f6d 2e72 616e 6469 6e74  p.random.randint
+0001f250: 2830 2c20 322c 2028 3130 3030 3030 2c20  (0, 2, (100000, 
+0001f260: 2929 0a20 2020 2020 2020 203e 3e3e 2079  )).        >>> y
+0001f270: 203d 206e 702e 7261 6e64 6f6d 2e72 616e   = np.random.ran
+0001f280: 6469 6e74 2830 2c20 322c 2028 3130 3030  dint(0, 2, (1000
+0001f290: 3030 2c20 2929 0a20 2020 2020 2020 203e  00, )).        >
+0001f2a0: 3e3e 2067 726f 756e 645f 7472 7574 6820  >> ground_truth 
+0001f2b0: 3d20 6e70 2e72 616e 646f 6d2e 7261 6e64  = np.random.rand
+0001f2c0: 696e 7428 302c 2032 2c20 2831 3030 3030  int(0, 2, (10000
+0001f2d0: 302c 2029 290a 2020 2020 2020 2020 3e3e  0, )).        >>
+0001f2e0: 3e20 5374 6174 6973 7469 6373 2e6d 636e  > Statistics.mcn
+0001f2f0: 656d 6172 2878 3d78 2c20 793d 792c 2067  emar(x=x, y=y, g
+0001f300: 726f 756e 645f 7472 7574 683d 6772 6f75  round_truth=grou
+0001f310: 6e64 5f74 7275 7468 290a 2020 2020 2020  nd_truth).      
+0001f320: 2020 2222 220a 0a20 2020 2020 2020 2063    """..        c
+0001f330: 6865 636b 5f76 616c 6964 5f61 7272 6179  heck_valid_array
+0001f340: 280a 2020 2020 2020 2020 2020 2020 6461  (.            da
+0001f350: 7461 3d78 2c0a 2020 2020 2020 2020 2020  ta=x,.          
+0001f360: 2020 736f 7572 6365 3d53 7461 7469 7374    source=Statist
+0001f370: 6963 732e 6d63 6e65 6d61 722e 5f5f 6e61  ics.mcnemar.__na
+0001f380: 6d65 5f5f 2c0a 2020 2020 2020 2020 2020  me__,.          
+0001f390: 2020 6163 6365 7074 6564 5f6e 6469 6d73    accepted_ndims
+0001f3a0: 3d28 312c 292c 0a20 2020 2020 2020 2020  =(1,),.         
+0001f3b0: 2020 2061 6363 6570 7465 645f 6474 7970     accepted_dtyp
+0001f3c0: 6573 3d28 6e70 2e69 6e74 3634 2c20 6e70  es=(np.int64, np
+0001f3d0: 2e69 6e74 3332 2c20 6e70 2e69 6e74 3829  .int32, np.int8)
+0001f3e0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+0001f3f0: 2020 2020 6368 6563 6b5f 7661 6c69 645f      check_valid_
+0001f400: 6172 7261 7928 0a20 2020 2020 2020 2020  array(.         
+0001f410: 2020 2064 6174 613d 792c 0a20 2020 2020     data=y,.     
+0001f420: 2020 2020 2020 2073 6f75 7263 653d 5374         source=St
+0001f430: 6174 6973 7469 6373 2e6d 636e 656d 6172  atistics.mcnemar
+0001f440: 2e5f 5f6e 616d 655f 5f2c 0a20 2020 2020  .__name__,.     
+0001f450: 2020 2020 2020 2061 6363 6570 7465 645f         accepted_
+0001f460: 6e64 696d 733d 2831 2c29 2c0a 2020 2020  ndims=(1,),.    
+0001f470: 2020 2020 2020 2020 6163 6365 7074 6564          accepted
+0001f480: 5f64 7479 7065 733d 286e 702e 696e 7436  _dtypes=(np.int6
+0001f490: 342c 206e 702e 696e 7433 322c 206e 702e  4, np.int32, np.
+0001f4a0: 696e 7438 292c 0a20 2020 2020 2020 2029  int8),.        )
+0001f4b0: 0a20 2020 2020 2020 2063 6865 636b 5f76  .        check_v
+0001f4c0: 616c 6964 5f61 7272 6179 280a 2020 2020  alid_array(.    
+0001f4d0: 2020 2020 2020 2020 6461 7461 3d67 726f          data=gro
+0001f4e0: 756e 645f 7472 7574 682c 0a20 2020 2020  und_truth,.     
+0001f4f0: 2020 2020 2020 2073 6f75 7263 653d 5374         source=St
+0001f500: 6174 6973 7469 6373 2e6d 636e 656d 6172  atistics.mcnemar
+0001f510: 2e5f 5f6e 616d 655f 5f2c 0a20 2020 2020  .__name__,.     
+0001f520: 2020 2020 2020 2061 6363 6570 7465 645f         accepted_
+0001f530: 6e64 696d 733d 2831 2c29 2c0a 2020 2020  ndims=(1,),.    
+0001f540: 2020 2020 2020 2020 6163 6365 7074 6564          accepted
+0001f550: 5f64 7479 7065 733d 286e 702e 696e 7436  _dtypes=(np.int6
+0001f560: 342c 206e 702e 696e 7433 322c 206e 702e  4, np.int32, np.
+0001f570: 696e 7438 292c 0a20 2020 2020 2020 2029  int8),.        )
+0001f580: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+0001f590: 6c69 7374 287b 782e 7368 6170 655b 305d  list({x.shape[0]
+0001f5a0: 2c20 792e 7368 6170 655b 305d 2c20 6772  , y.shape[0], gr
+0001f5b0: 6f75 6e64 5f74 7275 7468 2e73 6861 7065  ound_truth.shape
+0001f5c0: 5b30 5d7d 2929 2021 3d20 313a 0a20 2020  [0]})) != 1:.   
+0001f5d0: 2020 2020 2020 2020 2072 6169 7365 2043           raise C
+0001f5e0: 6f75 6e74 4572 726f 7228 0a20 2020 2020  ountError(.     
+0001f5f0: 2020 2020 2020 2020 2020 206d 7367 3d66             msg=f
+0001f600: 2254 6865 2074 6872 6565 2061 7272 6179  "The three array
+0001f610: 7320 6861 7320 746f 2062 6520 6571 7561  s has to be equa
+0001f620: 6c20 6c65 6e67 7468 7320 6275 7420 676f  l lengths but go
+0001f630: 743a 207b 782e 7368 6170 655b 305d 2c20  t: {x.shape[0], 
+0001f640: 792e 7368 6170 655b 305d 2c20 6772 6f75  y.shape[0], grou
+0001f650: 6e64 5f74 7275 7468 2e73 6861 7065 5b30  nd_truth.shape[0
+0001f660: 5d7d 222c 0a20 2020 2020 2020 2020 2020  ]}",.           
+0001f670: 2020 2020 2073 6f75 7263 653d 5374 6174       source=Stat
+0001f680: 6973 7469 6373 2e6d 636e 656d 6172 2e5f  istics.mcnemar._
+0001f690: 5f6e 616d 655f 5f2c 0a20 2020 2020 2020  _name__,.       
+0001f6a0: 2020 2020 2029 0a20 2020 2020 2020 2066       ).        f
+0001f6b0: 6f72 2069 2069 6e20 5b78 2c20 792c 2067  or i in [x, y, g
+0001f6c0: 726f 756e 645f 7472 7574 685d 3a0a 2020  round_truth]:.  
+0001f6d0: 2020 2020 2020 2020 2020 6164 6469 7469            additi
+0001f6e0: 6f6e 616c 203d 206c 6973 7428 7365 7428  onal = list(set(
+0001f6f0: 6c69 7374 286e 702e 736f 7274 286e 702e  list(np.sort(np.
+0001f700: 756e 6971 7565 2869 2929 2929 202d 207b  unique(i)))) - {
+0001f710: 302c 2031 7d29 0a20 2020 2020 2020 2020  0, 1}).         
+0001f720: 2020 2069 6620 6c65 6e28 6164 6469 7469     if len(additi
+0001f730: 6f6e 616c 2920 3e20 303a 0a20 2020 2020  onal) > 0:.     
+0001f740: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0001f750: 2049 6e76 616c 6964 496e 7075 7445 7272   InvalidInputErr
+0001f760: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+0001f770: 2020 2020 2020 2020 6d73 673d 6622 4d63          msg=f"Mc
+0001f780: 6e65 6d61 7220 7265 7175 6972 6573 2062  nemar requires b
+0001f790: 696e 6172 7920 696e 7075 7420 6461 7461  inary input data
+0001f7a0: 2062 7574 2066 6f75 6e64 207b 6164 6469   but found {addi
+0001f7b0: 7469 6f6e 616c 7d22 2c0a 2020 2020 2020  tional}",.      
+0001f7c0: 2020 2020 2020 2020 2020 2020 2020 736f                so
+0001f7d0: 7572 6365 3d53 7461 7469 7374 6963 732e  urce=Statistics.
+0001f7e0: 6d63 6e65 6d61 722e 5f5f 6e61 6d65 5f5f  mcnemar.__name__
+0001f7f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001f800: 2020 290a 2020 2020 2020 2020 6461 7461    ).        data
+0001f810: 203d 206e 702e 6873 7461 636b 280a 2020   = np.hstack(.  
+0001f820: 2020 2020 2020 2020 2020 2878 2e72 6573            (x.res
+0001f830: 6861 7065 282d 312c 2031 292c 2079 2e72  hape(-1, 1), y.r
+0001f840: 6573 6861 7065 282d 312c 2031 292c 2067  eshape(-1, 1), g
+0001f850: 726f 756e 645f 7472 7574 682e 7265 7368  round_truth.resh
+0001f860: 6170 6528 2d31 2c20 3129 290a 2020 2020  ape(-1, 1)).    
+0001f870: 2020 2020 290a 2020 2020 2020 2020 6220      ).        b 
+0001f880: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+0001f890: 6e70 2e77 6865 7265 2828 6461 7461 203d  np.where((data =
+0001f8a0: 3d20 2830 2c20 312c 2030 2929 2e61 6c6c  = (0, 1, 0)).all
+0001f8b0: 2861 7869 733d 3129 295b 305d 2e73 6861  (axis=1))[0].sha
+0001f8c0: 7065 5b30 5d0a 2020 2020 2020 2020 2020  pe[0].          
+0001f8d0: 2020 2b20 6e70 2e77 6865 7265 2828 6461    + np.where((da
+0001f8e0: 7461 203d 3d20 2831 2c20 302c 2031 2929  ta == (1, 0, 1))
+0001f8f0: 2e61 6c6c 2861 7869 733d 3129 295b 305d  .all(axis=1))[0]
+0001f900: 2e73 6861 7065 5b30 5d0a 2020 2020 2020  .shape[0].      
+0001f910: 2020 290a 2020 2020 2020 2020 6320 3d20    ).        c = 
+0001f920: 280a 2020 2020 2020 2020 2020 2020 6e70  (.            np
+0001f930: 2e77 6865 7265 2828 6461 7461 203d 3d20  .where((data == 
+0001f940: 2831 2c20 302c 2030 2929 2e61 6c6c 2861  (1, 0, 0)).all(a
+0001f950: 7869 733d 3129 295b 305d 2e73 6861 7065  xis=1))[0].shape
+0001f960: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
+0001f970: 2b20 6e70 2e77 6865 7265 2828 6461 7461  + np.where((data
+0001f980: 203d 3d20 2830 2c20 312c 2031 2929 2e61   == (0, 1, 1)).a
+0001f990: 6c6c 2861 7869 733d 3129 295b 305d 2e73  ll(axis=1))[0].s
+0001f9a0: 6861 7065 5b30 5d0a 2020 2020 2020 2020  hape[0].        
+0001f9b0: 290a 2020 2020 2020 2020 6966 206e 6f74  ).        if not
+0001f9c0: 2063 6f6e 7469 6e75 6974 795f 636f 7272   continuity_corr
+0001f9d0: 6563 7465 643a 0a20 2020 2020 2020 2020  ected:.         
+0001f9e0: 2020 2078 203d 2028 6e70 2e73 7175 6172     x = (np.squar
+0001f9f0: 6528 6220 2d20 6329 2920 2f20 2862 202b  e(b - c)) / (b +
+0001fa00: 2063 290a 2020 2020 2020 2020 656c 7365   c).        else
+0001fa10: 3a0a 2020 2020 2020 2020 2020 2020 7820  :.            x 
+0001fa20: 3d20 286e 702e 7371 7561 7265 286e 702e  = (np.square(np.
+0001fa30: 6162 7328 6220 2d20 6329 202d 2031 2929  abs(b - c) - 1))
+0001fa40: 202f 2028 6220 2b20 6329 0a20 2020 2020   / (b + c).     
+0001fa50: 2020 2070 203d 2063 6869 322e 7366 2878     p = chi2.sf(x
+0001fa60: 2c20 3129 0a20 2020 2020 2020 2072 6574  , 1).        ret
+0001fa70: 7572 6e20 782c 2070 0a0a 2020 2020 4073  urn x, p..    @s
+0001fa80: 7461 7469 636d 6574 686f 640a 2020 2020  taticmethod.    
+0001fa90: 6465 6620 636f 6368 7261 6e73 5f71 2864  def cochrans_q(d
+0001faa0: 6174 613a 206e 702e 6e64 6172 7261 7929  ata: np.ndarray)
+0001fab0: 202d 3e20 5475 706c 655b 666c 6f61 742c   -> Tuple[float,
+0001fac0: 2066 6c6f 6174 5d3a 0a20 2020 2020 2020   float]:.       
+0001fad0: 2022 2222 0a20 2020 2020 2020 2043 6f6d   """.        Com
+0001fae0: 7075 7465 2043 6f63 6872 616e 7320 5120  pute Cochrans Q 
+0001faf0: 666f 7220 322d 6469 6d65 6e73 696f 6e61  for 2-dimensiona
+0001fb00: 6c20 626f 6f6c 6561 6e20 6172 7261 792e  l boolean array.
+0001fb10: 0a0a 2020 2020 2020 2020 4361 6e20 6265  ..        Can be
+0001fb20: 2075 7365 6420 746f 2065 7661 6c75 6174   used to evaluat
+0001fb30: 6520 6966 2074 6865 2070 6572 666f 726d  e if the perform
+0001fb40: 616e 6365 206f 6620 6d75 6c74 6970 6c65  ance of multiple
+0001fb50: 2028 3e3d 3229 2063 6c61 7373 6966 6965   (>=2) classifie
+0001fb60: 7273 206f 6e20 7468 6520 7361 6d65 2064  rs on the same d
+0001fb70: 6174 6120 6973 2074 6865 2073 616d 6520  ata is the same 
+0001fb80: 6f72 2073 6967 6e69 6669 6361 6e74 6c79  or significantly
+0001fb90: 2064 6966 6665 7265 6e74 2e0a 0a20 2020   different...   
+0001fba0: 2020 2020 202e 2e20 6e6f 7465 3a3a 0a20       .. note::. 
+0001fbb0: 2020 2020 2020 2020 2020 4966 2074 776f            If two
+0001fbc0: 2063 6c61 7373 6966 6965 7273 2c20 636f   classifiers, co
+0001fbd0: 6e73 6964 6572 2060 6073 696d 6261 2e6d  nsider ``simba.m
+0001fbe0: 6978 696e 732e 7374 6174 6973 7469 6373  ixins.statistics
+0001fbf0: 2e53 7461 7469 7374 6963 732e 6d63 6e65  .Statistics.mcne
+0001fc00: 6d61 7260 602e 0a20 2020 2020 2020 2020  mar``..         
+0001fc10: 2020 6055 7365 6675 6c20 6261 636b 6772    `Useful backgr
+0001fc20: 6f75 6e64 2020 3c68 7474 7073 3a2f 2f70  ound  <https://p
+0001fc30: 7379 6368 2e75 6e6c 2e65 6475 2f70 7379  sych.unl.edu/psy
+0001fc40: 6372 732f 6861 6e64 636f 6d70 2f68 6363  crs/handcomp/hcc
+0001fc50: 6f63 6872 616e 2e50 4446 3e60 5f5f 2e0a  ochran.PDF>`__..
+0001fc60: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0001fc70: 6e70 2e6e 6461 7272 6179 2064 6174 613a  np.ndarray data:
+0001fc80: 2054 776f 2064 696d 656e 7369 6f6e 616c   Two dimensional
+0001fc90: 2061 7272 6179 206f 6620 626f 6f6c 6561   array of boolea
+0001fca0: 6e20 7661 6c75 6573 2077 6865 7265 2061  n values where a
+0001fcb0: 7869 7320 3120 7265 7072 6573 656e 7473  xis 1 represents
+0001fcc0: 2063 6c61 7373 6966 6965 7273 206f 7220   classifiers or 
+0001fcd0: 6665 6174 7572 6573 2061 6e64 2072 6f77  features and row
+0001fce0: 7320 7265 7072 6573 656e 7420 6672 616d  s represent fram
+0001fcf0: 6573 2e0a 2020 2020 2020 2020 3a72 6574  es..        :ret
+0001fd00: 7572 6e20 5475 706c 655b 666c 6f61 742c  urn Tuple[float,
+0001fd10: 2066 6c6f 6174 5d3a 2043 6f63 6872 616e   float]: Cochran
+0001fd20: 2773 2051 2073 7461 7469 7374 6963 2073  's Q statistic s
+0001fd30: 6967 6e69 6469 6361 6e63 6520 7661 6c75  ignidicance valu
+0001fd40: 652e 0a0a 2020 2020 2020 2020 3a65 7861  e...        :exa
+0001fd50: 6d70 6c65 3a0a 2020 2020 2020 2020 3e3e  mple:.        >>
+0001fd60: 3e20 6461 7461 203d 206e 702e 7261 6e64  > data = np.rand
+0001fd70: 6f6d 2e72 616e 6469 6e74 2830 2c20 322c  om.randint(0, 2,
+0001fd80: 2028 3130 3030 3030 2c20 3429 290a 2020   (100000, 4)).  
+0001fd90: 2020 2020 2020 3e3e 3e20 5374 6174 6973        >>> Statis
+0001fda0: 7469 6373 2e63 6f63 6872 616e 735f 7128  tics.cochrans_q(
+0001fdb0: 6461 7461 3d64 6174 6129 0a20 2020 2020  data=data).     
+0001fdc0: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
+0001fdd0: 6865 636b 5f76 616c 6964 5f61 7272 6179  heck_valid_array
+0001fde0: 280a 2020 2020 2020 2020 2020 2020 6461  (.            da
+0001fdf0: 7461 3d64 6174 612c 2073 6f75 7263 653d  ta=data, source=
+0001fe00: 5374 6174 6973 7469 6373 2e63 6f63 6872  Statistics.cochr
+0001fe10: 616e 735f 712e 5f5f 6e61 6d65 5f5f 2c20  ans_q.__name__, 
+0001fe20: 6163 6365 7074 6564 5f6e 6469 6d73 3d28  accepted_ndims=(
+0001fe30: 322c 290a 2020 2020 2020 2020 290a 2020  2,).        ).  
+0001fe40: 2020 2020 2020 6164 6469 7469 6f6e 616c        additional
+0001fe50: 203d 206c 6973 7428 7365 7428 6c69 7374   = list(set(list
+0001fe60: 286e 702e 736f 7274 286e 702e 756e 6971  (np.sort(np.uniq
+0001fe70: 7565 2864 6174 6129 2929 2920 2d20 7b30  ue(data)))) - {0
+0001fe80: 2c20 317d 290a 2020 2020 2020 2020 6966  , 1}).        if
+0001fe90: 206c 656e 2861 6464 6974 696f 6e61 6c29   len(additional)
+0001fea0: 203e 2030 3a0a 2020 2020 2020 2020 2020   > 0:.          
+0001feb0: 2020 7261 6973 6520 496e 7661 6c69 6449    raise InvalidI
+0001fec0: 6e70 7574 4572 726f 7228 0a20 2020 2020  nputError(.     
+0001fed0: 2020 2020 2020 2020 2020 206d 7367 3d66             msg=f
+0001fee0: 2243 6f63 6872 616e 7320 5120 7265 7175  "Cochrans Q requ
+0001fef0: 6972 6573 2062 696e 6172 7920 696e 7075  ires binary inpu
+0001ff00: 7420 6461 7461 2062 7574 2066 6f75 6e64  t data but found
+0001ff10: 207b 6164 6469 7469 6f6e 616c 7d22 2c0a   {additional}",.
+0001ff20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ff30: 736f 7572 6365 3d53 7461 7469 7374 6963  source=Statistic
+0001ff40: 732e 636f 6368 7261 6e73 5f71 2e5f 5f6e  s.cochrans_q.__n
+0001ff50: 616d 655f 5f2c 0a20 2020 2020 2020 2020  ame__,.         
+0001ff60: 2020 2029 0a20 2020 2020 2020 2063 6f6c     ).        col
+0001ff70: 5f73 756d 7320 3d20 6e70 2e73 756d 2864  _sums = np.sum(d
+0001ff80: 6174 612c 2061 7869 733d 3029 0a20 2020  ata, axis=0).   
+0001ff90: 2020 2020 2072 6f77 5f73 756d 5f73 756d       row_sum_sum
+0001ffa0: 203d 206e 702e 7375 6d28 6e70 2e73 756d   = np.sum(np.sum
+0001ffb0: 2864 6174 612c 2061 7869 733d 3129 290a  (data, axis=1)).
+0001ffc0: 2020 2020 2020 2020 726f 775f 7375 6d5f          row_sum_
+0001ffd0: 7371 7561 7265 5f73 756d 203d 206e 702e  square_sum = np.
+0001ffe0: 7375 6d28 6e70 2e73 7175 6172 6528 6e70  sum(np.square(np
+0001fff0: 2e73 756d 2864 6174 612c 2061 7869 733d  .sum(data, axis=
+00020000: 3129 2929 0a20 2020 2020 2020 206b 203d  1))).        k =
+00020010: 2064 6174 612e 7368 6170 655b 315d 0a20   data.shape[1]. 
+00020020: 2020 2020 2020 2067 3220 3d20 6e70 2e73         g2 = np.s
+00020030: 756d 2873 756d 286e 702e 7371 7561 7265  um(sum(np.square
+00020040: 2863 6f6c 5f73 756d 7329 2929 0a20 2020  (col_sums))).   
+00020050: 2020 2020 206e 6f6d 696e 6174 6f72 203d       nominator =
+00020060: 2028 6b20 2d20 3129 202a 2028 286b 202a   (k - 1) * ((k *
+00020070: 2067 3229 202d 206e 702e 7371 7561 7265   g2) - np.square
+00020080: 286e 702e 7375 6d28 636f 6c5f 7375 6d73  (np.sum(col_sums
+00020090: 2929 290a 2020 2020 2020 2020 6465 6e6f  ))).        deno
+000200a0: 6d69 6e61 746f 7220 3d20 286b 202a 2072  minator = (k * r
+000200b0: 6f77 5f73 756d 5f73 756d 2920 2d20 726f  ow_sum_sum) - ro
+000200c0: 775f 7375 6d5f 7371 7561 7265 5f73 756d  w_sum_square_sum
+000200d0: 0a20 2020 2020 2020 2069 6620 6e6f 6d69  .        if nomi
+000200e0: 6e61 746f 7220 3d3d 2030 206f 7220 6465  nator == 0 or de
+000200f0: 6e6f 6d69 6e61 746f 7220 3d3d 2030 3a0a  nominator == 0:.
+00020100: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00020110: 726e 202d 312e 302c 202d 312e 300a 2020  rn -1.0, -1.0.  
+00020120: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00020130: 2020 2020 2020 2020 7120 3d20 286e 6f6d          q = (nom
+00020140: 696e 6174 6f72 202f 2064 656e 6f6d 696e  inator / denomin
+00020150: 6174 6f72 2c29 0a20 2020 2020 2020 2020  ator,).         
+00020160: 2020 2072 6574 7572 6e20 712c 2073 7461     return q, sta
+00020170: 7473 2e63 6869 322e 7366 2871 2c20 6b20  ts.chi2.sf(q, k 
+00020180: 2d20 3129 0a0a 2020 2020 4073 7461 7469  - 1)..    @stati
+00020190: 636d 6574 686f 640a 2020 2020 6465 6620  cmethod.    def 
+000201a0: 6861 7274 6c65 795f 666d 6178 2878 3a20  hartley_fmax(x: 
+000201b0: 6e70 2e6e 6461 7272 6179 2c20 793a 206e  np.ndarray, y: n
+000201c0: 702e 6e64 6172 7261 7929 3a0a 2020 2020  p.ndarray):.    
+000201d0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000201e0: 436f 6d70 7574 6520 4861 7274 6c65 7927  Compute Hartley'
+000201f0: 7320 466d 6178 2073 7461 7469 7374 6963  s Fmax statistic
+00020200: 2074 6f20 7465 7374 2066 6f72 2065 7175   to test for equ
+00020210: 616c 6974 7920 6f66 2076 6172 6961 6e63  ality of varianc
+00020220: 6573 2062 6574 7765 656e 2074 776f 2066  es between two f
+00020230: 6561 7475 7265 7320 6f72 2067 726f 7570  eatures or group
+00020240: 732e 0a0a 2020 2020 2020 2020 5661 6c75  s...        Valu
+00020250: 6573 2063 6c6f 7365 2074 6f20 6f6e 6520  es close to one 
+00020260: 7265 7072 6573 656e 7473 2063 6c6f 7365  represents close
+00020270: 7220 746f 2065 7175 616c 2076 6172 6961  r to equal varia
+00020280: 6e63 652e 0a0a 2020 2020 2020 2020 3a70  nce...        :p
+00020290: 6172 616d 206e 702e 6e64 6172 7261 7920  aram np.ndarray 
+000202a0: 783a 2031 4420 6172 7261 7920 7265 7072  x: 1D array repr
+000202b0: 6573 656e 7469 6e67 206e 756d 6572 6963  esenting numeric
+000202c0: 2064 6174 6120 6f66 2074 6865 2066 6972   data of the fir
+000202d0: 7374 2067 726f 7570 2f66 6561 7475 7265  st group/feature
+000202e0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000202f0: 206e 702e 6e64 6172 7261 7920 783a 2031   np.ndarray x: 1
+00020300: 4420 6172 7261 7920 7265 7072 6573 656e  D array represen
+00020310: 7469 6e67 206e 756d 6572 6963 2064 6174  ting numeric dat
+00020320: 6120 6f66 2074 6865 2073 6563 6f6e 6420  a of the second 
+00020330: 6772 6f75 702f 6665 6174 7572 652e 0a0a  group/feature...
+00020340: 2020 2020 2020 2020 3a65 7861 6d70 6c65          :example
+00020350: 3a0a 2020 2020 2020 2020 3e3e 3e20 7820  :.        >>> x 
+00020360: 3d20 6e70 2e72 616e 646f 6d2e 7261 6e64  = np.random.rand
+00020370: 6f6d 2828 3130 302c 2929 0a20 2020 2020  om((100,)).     
+00020380: 2020 203e 3e3e 2079 203d 206e 702e 7261     >>> y = np.ra
+00020390: 6e64 6f6d 2e72 616e 646f 6d28 2831 3030  ndom.random((100
+000203a0: 2c29 290a 2020 2020 2020 2020 3e3e 3e20  ,)).        >>> 
+000203b0: 5374 6174 6973 7469 6373 2e68 6172 746c  Statistics.hartl
+000203c0: 6579 5f66 6d61 7828 783d 782c 2079 3d79  ey_fmax(x=x, y=y
+000203d0: 290a 2020 2020 2020 2020 2222 220a 2020  ).        """.  
+000203e0: 2020 2020 2020 6368 6563 6b5f 7661 6c69        check_vali
+000203f0: 645f 6172 7261 7928 0a20 2020 2020 2020  d_array(.       
+00020400: 2020 2020 2064 6174 613d 782c 0a20 2020       data=x,.   
+00020410: 2020 2020 2020 2020 2073 6f75 7263 653d           source=
+00020420: 5374 6174 6973 7469 6373 2e68 6172 746c  Statistics.hartl
+00020430: 6579 5f66 6d61 782e 5f5f 6e61 6d65 5f5f  ey_fmax.__name__
+00020440: 2c0a 2020 2020 2020 2020 2020 2020 6163  ,.            ac
+00020450: 6365 7074 6564 5f6e 6469 6d73 3d28 312c  cepted_ndims=(1,
+00020460: 292c 0a20 2020 2020 2020 2020 2020 2061  ),.            a
+00020470: 6363 6570 7465 645f 6474 7970 6573 3d28  ccepted_dtypes=(
+00020480: 6e70 2e66 6c6f 6174 3332 2c20 6e70 2e66  np.float32, np.f
+00020490: 6c6f 6174 3634 2c20 6e70 2e69 6e74 3634  loat64, np.int64
+000204a0: 2c20 6e70 2e66 6c6f 6174 3332 292c 0a20  , np.float32),. 
+000204b0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000204c0: 2063 6865 636b 5f76 616c 6964 5f61 7272   check_valid_arr
+000204d0: 6179 280a 2020 2020 2020 2020 2020 2020  ay(.            
+000204e0: 6461 7461 3d79 2c0a 2020 2020 2020 2020  data=y,.        
+000204f0: 2020 2020 736f 7572 6365 3d53 7461 7469      source=Stati
+00020500: 7374 6963 732e 6861 7274 6c65 795f 666d  stics.hartley_fm
+00020510: 6178 2e5f 5f6e 616d 655f 5f2c 0a20 2020  ax.__name__,.   
+00020520: 2020 2020 2020 2020 2061 6363 6570 7465           accepte
+00020530: 645f 6e64 696d 733d 2831 2c29 2c0a 2020  d_ndims=(1,),.  
+00020540: 2020 2020 2020 2020 2020 6163 6365 7074            accept
+00020550: 6564 5f64 7479 7065 733d 286e 702e 666c  ed_dtypes=(np.fl
+00020560: 6f61 7433 322c 206e 702e 666c 6f61 7436  oat32, np.float6
+00020570: 342c 206e 702e 696e 7436 342c 206e 702e  4, np.int64, np.
+00020580: 666c 6f61 7433 3229 2c0a 2020 2020 2020  float32),.      
+00020590: 2020 290a 2020 2020 2020 2020 6d61 785f    ).        max_
+000205a0: 7661 7220 3d20 6e70 2e6d 6178 2828 6e70  var = np.max((np
+000205b0: 2e76 6172 2878 292c 206e 702e 7661 7228  .var(x), np.var(
+000205c0: 7929 2929 0a20 2020 2020 2020 206d 696e  y))).        min
+000205d0: 5f76 6172 203d 206e 702e 6d69 6e28 286e  _var = np.min((n
+000205e0: 702e 7661 7228 7829 2c20 6e70 2e76 6172  p.var(x), np.var
+000205f0: 2879 2929 290a 2020 2020 2020 2020 6966  (y))).        if
+00020600: 2028 6d61 785f 7661 7220 3d3d 2030 2920   (max_var == 0) 
+00020610: 6f72 2028 6d69 6e5f 7661 7220 3d3d 2030  or (min_var == 0
+00020620: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+00020630: 6574 7572 6e20 2d31 2e30 0a20 2020 2020  eturn -1.0.     
+00020640: 2020 2072 6574 7572 6e20 6d61 785f 7661     return max_va
+00020650: 7220 2f20 6d69 6e5f 7661 720a 0a20 2020  r / min_var..   
+00020660: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
+00020670: 2020 2064 6566 2067 7275 6262 735f 7465     def grubbs_te
+00020680: 7374 2878 3a20 6e70 2e6e 6461 7272 6179  st(x: np.ndarray
+00020690: 2c20 6c65 6674 5f74 6169 6c3a 204f 7074  , left_tail: Opt
+000206a0: 696f 6e61 6c5b 626f 6f6c 5d20 3d20 4661  ional[bool] = Fa
+000206b0: 6c73 6529 202d 3e20 666c 6f61 743a 0a20  lse) -> float:. 
+000206c0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000206d0: 2020 2050 6572 666f 726d 2047 7275 6262     Perform Grubb
+000206e0: 7327 2074 6573 7420 746f 2064 6574 6563  s' test to detec
+000206f0: 7420 6f75 746c 6965 7273 2069 6620 7468  t outliers if th
+00020700: 6520 6d69 6e69 6d75 6d20 6f72 206d 6178  e minimum or max
+00020710: 696d 756d 2076 616c 7565 2069 6e20 6120  imum value in a 
+00020720: 6665 6174 7572 6520 7365 7269 6573 2069  feature series i
+00020730: 7320 616e 206f 7574 6c69 6572 2e0a 0a20  s an outlier... 
+00020740: 2020 2020 2020 203a 7061 7261 6d20 6e70         :param np
+00020750: 2e6e 6461 7272 6179 2078 3a20 3144 2061  .ndarray x: 1D a
+00020760: 7272 6179 2072 6570 7265 7365 6e74 696e  rray representin
+00020770: 6720 6e75 6d65 7269 6320 6461 7461 2e0a  g numeric data..
+00020780: 2020 2020 2020 2020 3a70 6172 616d 204f          :param O
+00020790: 7074 696f 6e61 6c5b 626f 6f6c 5d20 6c65  ptional[bool] le
+000207a0: 6674 5f74 6169 6c3a 2049 6620 5472 7565  ft_tail: If True
+000207b0: 2c20 7468 6520 7465 7374 2063 616c 6375  , the test calcu
+000207c0: 6c61 7465 7320 7468 6520 4772 7562 6273  lates the Grubbs
+000207d0: 2720 7465 7374 2073 7461 7469 7374 6963  ' test statistic
+000207e0: 2066 6f72 2074 6865 206c 6566 7420 7461   for the left ta
+000207f0: 696c 2028 6d69 6e69 6d75 6d20 7661 6c75  il (minimum valu
+00020800: 6529 2e20 4966 2046 616c 7365 2028 6465  e). If False (de
+00020810: 6661 756c 7429 2c20 6974 2063 616c 6375  fault), it calcu
+00020820: 6c61 7465 7320 7468 6520 7374 6174 6973  lates the statis
+00020830: 7469 6320 666f 7220 7468 6520 7269 6768  tic for the righ
+00020840: 7420 7461 696c 2028 6d61 7869 6d75 6d20  t tail (maximum 
+00020850: 7661 6c75 6529 2e0a 2020 2020 2020 2020  value)..        
+00020860: 3a72 6574 7572 6e20 666c 6f61 743a 2054  :return float: T
+00020870: 6865 2063 6f6d 7075 7465 6420 4772 7562  he computed Grub
+00020880: 6273 2720 7465 7374 2073 7461 7469 7374  bs' test statist
+00020890: 6963 2e0a 0a20 2020 2020 2020 203a 6578  ic...        :ex
+000208a0: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
+000208b0: 3e3e 2078 203d 206e 702e 7261 6e64 6f6d  >> x = np.random
+000208c0: 2e72 616e 646f 6d28 2831 3030 2c29 290a  .random((100,)).
+000208d0: 2020 2020 2020 2020 3e3e 3e20 5374 6174          >>> Stat
+000208e0: 6973 7469 6373 2e67 7275 6262 735f 7465  istics.grubbs_te
+000208f0: 7374 2878 3d78 290a 2020 2020 2020 2020  st(x=x).        
+00020900: 2222 220a 2020 2020 2020 2020 6368 6563  """.        chec
+00020910: 6b5f 7661 6c69 645f 6172 7261 7928 0a20  k_valid_array(. 
+00020920: 2020 2020 2020 2020 2020 2064 6174 613d             data=
+00020930: 782c 0a20 2020 2020 2020 2020 2020 2073  x,.            s
+00020940: 6f75 7263 653d 5374 6174 6973 7469 6373  ource=Statistics
+00020950: 2e67 7275 6262 735f 7465 7374 2e5f 5f6e  .grubbs_test.__n
+00020960: 616d 655f 5f2c 0a20 2020 2020 2020 2020  ame__,.         
+00020970: 2020 2061 6363 6570 7465 645f 6e64 696d     accepted_ndim
+00020980: 733d 2831 2c29 2c0a 2020 2020 2020 2020  s=(1,),.        
+00020990: 2020 2020 6163 6365 7074 6564 5f64 7479      accepted_dty
+000209a0: 7065 733d 286e 702e 666c 6f61 7433 322c  pes=(np.float32,
+000209b0: 206e 702e 666c 6f61 7436 342c 206e 702e   np.float64, np.
+000209c0: 696e 7436 342c 206e 702e 666c 6f61 7433  int64, np.float3
+000209d0: 3229 2c0a 2020 2020 2020 2020 290a 2020  2),.        ).  
+000209e0: 2020 2020 2020 7820 3d20 6e70 2e73 6f72        x = np.sor
+000209f0: 7428 7829 0a20 2020 2020 2020 2069 6620  t(x).        if 
+00020a00: 6c65 6674 5f74 6169 6c3a 0a20 2020 2020  left_tail:.     
+00020a10: 2020 2020 2020 2072 6574 7572 6e20 286e         return (n
+00020a20: 702e 6d65 616e 2878 2920 2d20 6e70 2e6d  p.mean(x) - np.m
+00020a30: 696e 2878 2929 202f 206e 702e 7374 6428  in(x)) / np.std(
+00020a40: 7829 0a20 2020 2020 2020 2065 6c73 653a  x).        else:
+00020a50: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00020a60: 7572 6e20 286e 702e 6d61 7828 7829 202d  urn (np.max(x) -
+00020a70: 206e 702e 6d65 616e 2878 2929 202f 206e   np.mean(x)) / n
+00020a80: 702e 7374 6428 7829 0a0a 2020 2020 4073  p.std(x)..    @s
+00020a90: 7461 7469 636d 6574 686f 640a 2020 2020  taticmethod.    
+00020aa0: 6465 6620 7769 6c63 6f78 6f6e 2878 3a20  def wilcoxon(x: 
+00020ab0: 6e70 2e6e 6461 7272 6179 2c20 793a 206e  np.ndarray, y: n
+00020ac0: 702e 6e64 6172 7261 7929 3a0a 2020 2020  p.ndarray):.    
+00020ad0: 2020 2020 2222 224e 6f6e 2d70 6172 616d      """Non-param
+00020ae0: 6574 7269 6320 7477 6f2d 7761 7920 7769  etric two-way wi
+00020af0: 7468 696e 2d73 7562 6a65 6374 7320 7465  thin-subjects te
+00020b00: 7374 2222 220a 2020 2020 2020 2020 6461  st""".        da
+00020b10: 7461 203d 206e 702e 6873 7461 636b 2828  ta = np.hstack((
+00020b20: 782e 7265 7368 6170 6528 2d31 2c20 3129  x.reshape(-1, 1)
+00020b30: 2c20 792e 7265 7368 6170 6528 2d31 2c20  , y.reshape(-1, 
+00020b40: 3129 2929 0a20 2020 2020 2020 206e 203d  1))).        n =
+00020b50: 2064 6174 612e 7368 6170 655b 305d 0a20   data.shape[0]. 
+00020b60: 2020 2020 2020 2064 6966 6620 3d20 6e70         diff = np
+00020b70: 2e64 6966 6628 6461 7461 292e 666c 6174  .diff(data).flat
+00020b80: 7465 6e28 290a 2020 2020 2020 2020 6469  ten().        di
+00020b90: 6666 5f61 6273 203d 206e 702e 6162 7328  ff_abs = np.abs(
+00020ba0: 6469 6666 290a 2020 2020 2020 2020 7261  diff).        ra
+00020bb0: 6e6b 5f77 5f74 6965 7320 3d20 6661 7374  nk_w_ties = fast
+00020bc0: 5f6d 6561 6e5f 7261 6e6b 2864 6174 613d  _mean_rank(data=
+00020bd0: 6469 6666 5f61 6273 2c20 6465 7363 656e  diff_abs, descen
+00020be0: 6469 6e67 3d46 616c 7365 290a 2020 2020  ding=False).    
+00020bf0: 2020 2020 7369 676e 6564 5f72 616e 6b5f      signed_rank_
+00020c00: 775f 7469 6573 203d 206e 702e 6675 6c6c  w_ties = np.full
+00020c10: 2828 7261 6e6b 5f77 5f74 6965 732e 7368  ((rank_w_ties.sh
+00020c20: 6170 655b 305d 292c 206e 702e 6e61 6e29  ape[0]), np.nan)
+00020c30: 0a20 2020 2020 2020 2074 5f70 6c75 732c  .        t_plus,
+00020c40: 2074 5f6d 696e 7573 203d 2030 2c20 300a   t_minus = 0, 0.
+00020c50: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
+00020c60: 6e20 7261 6e67 6528 6469 6666 2e73 6861  n range(diff.sha
+00020c70: 7065 5b30 5d29 3a0a 2020 2020 2020 2020  pe[0]):.        
+00020c80: 2020 2020 6966 2064 6966 665b 695d 203c      if diff[i] <
+00020c90: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+00020ca0: 2020 2020 7369 676e 6564 5f72 616e 6b5f      signed_rank_
+00020cb0: 775f 7469 6573 5b69 5d20 3d20 2d72 616e  w_ties[i] = -ran
+00020cc0: 6b5f 775f 7469 6573 5b69 5d0a 2020 2020  k_w_ties[i].    
+00020cd0: 2020 2020 2020 2020 2020 2020 745f 6d69              t_mi
+00020ce0: 6e75 7320 2b3d 206e 702e 6162 7328 7261  nus += np.abs(ra
+00020cf0: 6e6b 5f77 5f74 6965 735b 695d 290a 2020  nk_w_ties[i]).  
+00020d00: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00020d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020d20: 7369 676e 6564 5f72 616e 6b5f 775f 7469  signed_rank_w_ti
+00020d30: 6573 5b69 5d20 3d20 7261 6e6b 5f77 5f74  es[i] = rank_w_t
+00020d40: 6965 735b 695d 0a20 2020 2020 2020 2020  ies[i].         
+00020d50: 2020 2020 2020 2074 5f70 6c75 7320 2b3d         t_plus +=
+00020d60: 206e 702e 6162 7328 7261 6e6b 5f77 5f74   np.abs(rank_w_t
+00020d70: 6965 735b 695d 290a 2020 2020 2020 2020  ies[i]).        
+00020d80: 755f 7720 3d20 286e 202a 2028 6e20 2b20  u_w = (n * (n + 
+00020d90: 3129 2920 2f20 340a 2020 2020 2020 2020  1)) / 4.        
+00020da0: 7374 645f 636f 7272 6563 7469 6f6e 203d  std_correction =
+00020db0: 2030 0a20 2020 2020 2020 2066 6f72 2069   0.        for i
+00020dc0: 2069 6e20 7261 6e67 6528 7369 676e 6564   in range(signed
+00020dd0: 5f72 616e 6b5f 775f 7469 6573 2e73 6861  _rank_w_ties.sha
+00020de0: 7065 5b30 5d29 3a0a 2020 2020 2020 2020  pe[0]):.        
+00020df0: 2020 2020 7361 6d65 5f72 616e 6b5f 6e20      same_rank_n 
+00020e00: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+00020e10: 2020 2020 6e70 2e61 7267 7768 6572 6528      np.argwhere(
+00020e20: 7369 676e 6564 5f72 616e 6b5f 775f 7469  signed_rank_w_ti
+00020e30: 6573 203d 3d20 7369 676e 6564 5f72 616e  es == signed_ran
+00020e40: 6b5f 775f 7469 6573 5b69 5d29 0a20 2020  k_w_ties[i]).   
+00020e50: 2020 2020 2020 2020 2020 2020 202e 666c               .fl
+00020e60: 6174 7465 6e28 290a 2020 2020 2020 2020  atten().        
+00020e70: 2020 2020 2020 2020 2e73 6861 7065 5b30          .shape[0
+00020e80: 5d0a 2020 2020 2020 2020 2020 2020 290a  ].            ).
+00020e90: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00020ea0: 616d 655f 7261 6e6b 5f6e 203e 2031 3a0a  ame_rank_n > 1:.
+00020eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020ec0: 7374 645f 636f 7272 6563 7469 6f6e 202b  std_correction +
+00020ed0: 3d20 2828 7361 6d65 5f72 616e 6b5f 6e2a  = ((same_rank_n*
+00020ee0: 2a33 2920 2d20 7361 6d65 5f72 616e 6b5f  *3) - same_rank_
+00020ef0: 6e29 202f 2032 0a0a 2020 2020 2020 2020  n) / 2..        
+00020f00: 7374 6420 3d20 6e70 2e73 7172 7428 2828  std = np.sqrt(((
+00020f10: 6e20 2a20 286e 202b 2031 2929 202a 2028  n * (n + 1)) * (
+00020f20: 2832 202a 206e 2920 2b20 3129 202d 2073  (2 * n) + 1) - s
+00020f30: 7464 5f63 6f72 7265 6374 696f 6e29 202f  td_correction) /
+00020f40: 2032 3429 0a20 2020 2020 2020 2057 203d   24).        W =
+00020f50: 206e 702e 6d69 6e28 2874 5f70 6c75 732c   np.min((t_plus,
+00020f60: 2074 5f6d 696e 7573 2929 0a20 2020 2020   t_minus)).     
+00020f70: 2020 207a 203d 2028 5720 2d20 755f 7729     z = (W - u_w)
+00020f80: 202f 2073 7464 0a20 2020 2020 2020 2072   / std.        r
+00020f90: 203d 207a 202f 206e 702e 7371 7274 286e   = z / np.sqrt(n
+00020fa0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00020fb0: 207a 2c20 720a 0a20 2020 2040 7374 6174   z, r..    @stat
+00020fc0: 6963 6d65 7468 6f64 0a20 2020 2040 6e6a  icmethod.    @nj
+00020fd0: 6974 280a 2020 2020 2020 2020 2228 666c  it(.        "(fl
+00020fe0: 6f61 7433 325b 3a2c 3a5d 2c20 2922 2c0a  oat32[:,:], )",.
+00020ff0: 2020 2020 290a 2020 2020 6465 6620 636f      ).    def co
+00021000: 765f 6d61 7472 6978 2864 6174 613a 206e  v_matrix(data: n
+00021010: 702e 6e64 6172 7261 7929 3a0a 2020 2020  p.ndarray):.    
+00021020: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00021030: 4a69 7474 6564 2068 656c 7065 7220 746f  Jitted helper to
+00021040: 2063 6f6d 7075 7465 2074 6865 2063 6f76   compute the cov
+00021050: 6172 6961 6e63 6520 6d61 7472 6978 206f  ariance matrix o
+00021060: 6620 7468 6520 696e 7075 7420 6461 7461  f the input data
+00021070: 2e20 4865 6c70 6572 2066 6f72 2063 6f6d  . Helper for com
+00021080: 7075 7469 6e67 2063 726f 6e62 6163 6820  puting cronbach 
+00021090: 616c 7068 612c 0a20 2020 2020 2020 206d  alpha,.        m
+000210a0: 756c 7469 7661 7269 6174 6520 616e 616c  ultivariate anal
+000210b0: 7973 6973 2c20 616e 6420 6469 7374 616e  ysis, and distan
+000210c0: 6365 2063 6f6d 7075 7461 7469 6f6e 732e  ce computations.
+000210d0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000210e0: 206e 702e 6e64 6172 7261 7920 6461 7461   np.ndarray data
+000210f0: 3a20 322d 6469 6d65 6e73 696f 6e61 6c20  : 2-dimensional 
+00021100: 6e75 6d70 7920 6172 7261 7920 7265 7072  numpy array repr
+00021110: 6573 656e 7469 6e67 2074 6865 2069 6e70  esenting the inp
+00021120: 7574 2064 6174 6120 7769 7468 2073 6861  ut data with sha
+00021130: 7065 2028 6e2c 206d 292c 2077 6865 7265  pe (n, m), where
+00021140: 206e 2069 7320 7468 6520 6e75 6d62 6572   n is the number
+00021150: 206f 6620 6f62 7365 7276 6174 696f 6e73   of observations
+00021160: 2061 6e64 206d 2069 7320 7468 6520 6e75   and m is the nu
+00021170: 6d62 6572 206f 6620 6665 6174 7572 6573  mber of features
+00021180: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
+00021190: 6e3a 2043 6f76 6172 6961 6e63 6520 6d61  n: Covariance ma
+000211a0: 7472 6978 206f 6620 7468 6520 696e 7075  trix of the inpu
+000211b0: 7420 6461 7461 2077 6974 6820 7368 6170  t data with shap
+000211c0: 6520 286d 2c20 6d29 2e20 5468 6520 2869  e (m, m). The (i
+000211d0: 2c20 6a29 2d74 6820 656c 656d 656e 7420  , j)-th element 
+000211e0: 6f66 2074 6865 206d 6174 7269 7820 7265  of the matrix re
+000211f0: 7072 6573 656e 7473 2074 6865 2063 6f76  presents the cov
+00021200: 6172 6961 6e63 6520 6265 7477 6565 6e20  ariance between 
+00021210: 7468 6520 692d 7468 2061 6e64 206a 2d74  the i-th and j-t
+00021220: 6820 6665 6174 7572 6573 2069 6e20 7468  h features in th
+00021230: 6520 6461 7461 2e0a 0a20 2020 2020 2020  e data...       
+00021240: 203a 6578 616d 706c 653a 0a20 2020 2020   :example:.     
+00021250: 2020 203e 3e3e 2064 6174 6120 3d20 6e70     >>> data = np
+00021260: 2e72 616e 646f 6d2e 7261 6e64 696e 7428  .random.randint(
+00021270: 302c 322c 2028 3230 302c 2034 3029 292e  0,2, (200, 40)).
+00021280: 6173 7479 7065 286e 702e 666c 6f61 7433  astype(np.float3
+00021290: 3229 0a20 2020 2020 2020 203e 3e3e 2063  2).        >>> c
+000212a0: 6f76 6172 6961 6e63 655f 6d61 7472 6978  ovariance_matrix
+000212b0: 203d 2053 7461 7469 7374 6963 732e 636f   = Statistics.co
+000212c0: 765f 6d61 7472 6978 2864 6174 613d 6461  v_matrix(data=da
+000212d0: 7461 290a 2020 2020 2020 2020 2222 220a  ta).        """.
+000212e0: 2020 2020 2020 2020 6e2c 206d 203d 2064          n, m = d
+000212f0: 6174 612e 7368 6170 650a 2020 2020 2020  ata.shape.      
+00021300: 2020 636f 7620 3d20 6e70 2e66 756c 6c28    cov = np.full(
+00021310: 286d 2c20 6d29 2c20 302e 3029 0a20 2020  (m, m), 0.0).   
+00021320: 2020 2020 2066 6f72 2069 2069 6e20 7072       for i in pr
+00021330: 616e 6765 286d 293a 0a20 2020 2020 2020  ange(m):.       
+00021340: 2020 2020 206d 6561 6e5f 6920 3d20 6e70       mean_i = np
+00021350: 2e73 756d 2864 6174 615b 3a2c 2069 5d29  .sum(data[:, i])
+00021360: 202f 206e 0a20 2020 2020 2020 2020 2020   / n.           
+00021370: 2066 6f72 206a 2069 6e20 7261 6e67 6528   for j in range(
+00021380: 6d29 3a0a 2020 2020 2020 2020 2020 2020  m):.            
+00021390: 2020 2020 6d65 616e 5f6a 203d 206e 702e      mean_j = np.
+000213a0: 7375 6d28 6461 7461 5b3a 2c20 6a5d 2920  sum(data[:, j]) 
+000213b0: 2f20 6e0a 2020 2020 2020 2020 2020 2020  / n.            
+000213c0: 2020 2020 636f 765b 692c 206a 5d20 3d20      cov[i, j] = 
+000213d0: 6e70 2e73 756d 2828 6461 7461 5b3a 2c20  np.sum((data[:, 
+000213e0: 695d 202d 206d 6561 6e5f 6929 202a 2028  i] - mean_i) * (
+000213f0: 6461 7461 5b3a 2c20 6a5d 202d 206d 6561  data[:, j] - mea
+00021400: 6e5f 6a29 2920 2f20 280a 2020 2020 2020  n_j)) / (.      
+00021410: 2020 2020 2020 2020 2020 2020 2020 6e20                n 
+00021420: 2d20 310a 2020 2020 2020 2020 2020 2020  - 1.            
+00021430: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
+00021440: 7475 726e 2063 6f76 0a0a 2020 2020 4073  turn cov..    @s
+00021450: 7461 7469 636d 6574 686f 640a 2020 2020  taticmethod.    
+00021460: 406e 6a69 7428 2228 666c 6f61 7433 325b  @njit("(float32[
+00021470: 3a5d 2c20 666c 6f61 7436 342c 2922 290a  :], float64,)").
+00021480: 2020 2020 6465 6620 6d61 645f 6d65 6469      def mad_medi
+00021490: 616e 5f72 756c 6528 6461 7461 3a20 6e70  an_rule(data: np
+000214a0: 2e6e 6461 7272 6179 2c20 6b3a 2069 6e74  .ndarray, k: int
+000214b0: 2920 2d3e 206e 702e 6e64 6172 7261 793a  ) -> np.ndarray:
+000214c0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+000214d0: 2020 2020 2044 6574 6563 7420 6f75 746c       Detect outl
+000214e0: 6965 7273 2075 7369 6e67 2074 6865 204d  iers using the M
+000214f0: 4144 2d4d 6564 6961 6e20 5275 6c65 2e20  AD-Median Rule. 
+00021500: 5265 7475 726e 7320 3164 2061 7272 6179  Returns 1d array
+00021510: 206f 6620 7369 7a65 2064 6174 612e 7368   of size data.sh
+00021520: 6170 655b 305d 2077 6974 6820 3120 7265  ape[0] with 1 re
+00021530: 7072 6573 656e 7469 6e67 206f 7574 6c69  presenting outli
+00021540: 6572 2061 6e64 2030 2072 6570 7265 7365  er and 0 represe
+00021550: 6e74 696e 6720 696e 6c69 6572 2e0a 0a20  nting inlier... 
+00021560: 2020 2020 2020 203a 6578 616d 706c 653a         :example:
+00021570: 0a20 2020 2020 2020 203e 3e3e 2064 6174  .        >>> dat
+00021580: 6120 3d20 6e70 2e72 616e 646f 6d2e 7261  a = np.random.ra
+00021590: 6e64 696e 7428 302c 2036 3030 2c20 2839  ndint(0, 600, (9
+000215a0: 3030 3030 3030 2c29 292e 6173 7479 7065  000000,)).astype
+000215b0: 286e 702e 666c 6f61 7433 3229 0a20 2020  (np.float32).   
+000215c0: 2020 2020 203e 3e3e 2053 7461 7469 7374       >>> Statist
+000215d0: 6963 732e 6d61 645f 6d65 6469 616e 5f72  ics.mad_median_r
+000215e0: 756c 6528 6461 7461 3d64 6174 612c 206b  ule(data=data, k
+000215f0: 3d31 2e30 290a 2020 2020 2020 2020 2222  =1.0).        ""
+00021600: 220a 0a20 2020 2020 2020 206d 6564 6961  "..        media
+00021610: 6e20 3d20 6e70 2e6d 6564 6961 6e28 6461  n = np.median(da
+00021620: 7461 290a 2020 2020 2020 2020 6d61 6420  ta).        mad 
+00021630: 3d20 6e70 2e6d 6564 6961 6e28 6e70 2e61  = np.median(np.a
+00021640: 6273 2864 6174 6120 2d20 6d65 6469 616e  bs(data - median
+00021650: 2929 0a20 2020 2020 2020 2074 6872 6573  )).        thres
+00021660: 686f 6c64 203d 206b 202a 206d 6164 0a20  hold = k * mad. 
+00021670: 2020 2020 2020 206f 7574 6c69 6572 7320         outliers 
+00021680: 3d20 6e70 2e61 6273 2864 6174 6120 2d20  = np.abs(data - 
+00021690: 6d65 6469 616e 2920 3e20 7468 7265 7368  median) > thresh
+000216a0: 6f6c 640a 2020 2020 2020 2020 7265 7475  old.        retu
+000216b0: 726e 206f 7574 6c69 6572 7320 2a20 310a  rn outliers * 1.
+000216c0: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
+000216d0: 6f64 0a20 2020 2040 6e6a 6974 2822 2866  od.    @njit("(f
+000216e0: 6c6f 6174 3332 5b3a 5d2c 2066 6c6f 6174  loat32[:], float
+000216f0: 3634 2c20 666c 6f61 7436 345b 3a5d 2c20  64, float64[:], 
+00021700: 666c 6f61 7436 3429 2229 0a20 2020 2064  float64)").    d
+00021710: 6566 2073 6c69 6469 6e67 5f6d 6164 5f6d  ef sliding_mad_m
+00021720: 6564 6961 6e5f 7275 6c65 280a 2020 2020  edian_rule(.    
+00021730: 2020 2020 6461 7461 3a20 6e70 2e6e 6461      data: np.nda
+00021740: 7272 6179 2c20 6b3a 2069 6e74 2c20 7469  rray, k: int, ti
+00021750: 6d65 5f77 696e 646f 7773 3a20 6e70 2e6e  me_windows: np.n
+00021760: 6461 7272 6179 2c20 6670 733a 2066 6c6f  darray, fps: flo
+00021770: 6174 0a20 2020 2029 202d 3e20 6e70 2e6e  at.    ) -> np.n
+00021780: 6461 7272 6179 3a0a 2020 2020 2020 2020  darray:.        
+00021790: 2222 220a 2020 2020 2020 2020 436f 756e  """.        Coun
+000217a0: 7420 7468 6520 6e75 6d62 6572 206f 6620  t the number of 
+000217b0: 6f75 746c 6965 7273 2069 6e20 6120 736c  outliers in a sl
+000217c0: 6964 696e 6720 7469 6d65 2d77 696e 646f  iding time-windo
+000217d0: 7720 7573 696e 6720 7468 6520 4d41 442d  w using the MAD-
+000217e0: 4d65 6469 616e 2052 756c 652e 0a0a 2020  Median Rule...  
+000217f0: 2020 2020 2020 3a70 6172 616d 206e 702e        :param np.
+00021800: 6e64 6172 7261 7920 6461 7461 3a20 3144  ndarray data: 1D
+00021810: 206e 756d 6572 6963 616c 2061 7272 6179   numerical array
+00021820: 2072 6570 7265 7365 6e74 696e 6720 6665   representing fe
+00021830: 6174 7572 652e 0a20 2020 2020 2020 203a  ature..        :
+00021840: 7061 7261 6d20 696e 7420 6b3a 2054 6865  param int k: The
+00021850: 206f 7574 6c69 6572 2074 6872 6573 686f   outlier thresho
+00021860: 6c64 2064 6566 696e 6564 2061 7320 6b20  ld defined as k 
+00021870: 2a20 6d65 6469 616e 2061 6273 6f6c 7574  * median absolut
+00021880: 6520 6465 7669 6174 696f 6e20 696e 2065  e deviation in e
+00021890: 6163 6820 7469 6d65 2077 696e 646f 772e  ach time window.
+000218a0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+000218b0: 6e70 2e6e 6461 7272 6179 2074 696d 655f  np.ndarray time_
+000218c0: 7769 6e64 6f77 733a 2031 4420 6172 7261  windows: 1D arra
+000218d0: 7920 6f66 2074 696d 6520 7769 6e64 6f77  y of time window
+000218e0: 2073 697a 6573 2069 6e20 7365 636f 6e64   sizes in second
+000218f0: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
+00021900: 6d20 666c 6f61 7420 6670 733a 2054 6865  m float fps: The
+00021910: 2066 7265 7175 656e 6379 206f 6620 7468   frequency of th
+00021920: 6520 7369 676e 616c 2e0a 2020 2020 2020  e signal..      
+00021930: 2020 3a72 6574 7572 6e20 6e70 2e6e 6461    :return np.nda
+00021940: 7272 6179 3a20 4172 7261 7920 6f66 2073  rray: Array of s
+00021950: 697a 6520 2864 6174 612e 7368 6170 655b  ize (data.shape[
+00021960: 305d 2c20 7469 6d65 5f77 696e 646f 7773  0], time_windows
+00021970: 2e73 6861 7065 5b30 5d29 2077 6974 6820  .shape[0]) with 
+00021980: 636f 756e 7473 2069 6620 6f75 746c 6965  counts if outlie
+00021990: 7273 2064 6574 6563 7465 642e 0a0a 2020  rs detected...  
+000219a0: 2020 2020 2020 3a65 7861 6d70 6c65 3a0a        :example:.
+000219b0: 2020 2020 2020 2020 3e3e 3e20 6461 7461          >>> data
+000219c0: 203d 206e 702e 7261 6e64 6f6d 2e72 616e   = np.random.ran
+000219d0: 6469 6e74 2830 2c20 3530 2c20 2835 3030  dint(0, 50, (500
+000219e0: 3030 2c29 292e 6173 7479 7065 286e 702e  00,)).astype(np.
+000219f0: 666c 6f61 7433 3229 0a20 2020 2020 2020  float32).       
+00021a00: 203e 3e3e 2053 7461 7469 7374 6963 732e   >>> Statistics.
+00021a10: 736c 6964 696e 675f 6d61 645f 6d65 6469  sliding_mad_medi
+00021a20: 616e 5f72 756c 6528 6461 7461 3d64 6174  an_rule(data=dat
+00021a30: 612c 206b 3d32 2c20 7469 6d65 5f77 696e  a, k=2, time_win
+00021a40: 646f 7773 3d6e 702e 6172 7261 7928 5b32  dows=np.array([2
+00021a50: 302e 305d 292c 2066 7073 3d31 2e30 290a  0.0]), fps=1.0).
+00021a60: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00021a70: 2020 2020 7265 7375 6c74 7320 3d20 6e70      results = np
+00021a80: 2e66 756c 6c28 2864 6174 612e 7368 6170  .full((data.shap
+00021a90: 655b 305d 2c20 7469 6d65 5f77 696e 646f  e[0], time_windo
+00021aa0: 7773 2e73 6861 7065 5b30 5d29 2c20 2d31  ws.shape[0]), -1
+00021ab0: 290a 2020 2020 2020 2020 666f 7220 7469  ).        for ti
+00021ac0: 6d65 5f77 696e 646f 7720 696e 2074 696d  me_window in tim
+00021ad0: 655f 7769 6e64 6f77 733a 0a20 2020 2020  e_windows:.     
+00021ae0: 2020 2020 2020 2077 203d 2069 6e74 2866         w = int(f
+00021af0: 7073 202a 2074 696d 655f 7769 6e64 6f77  ps * time_window
+00021b00: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
+00021b10: 7220 6920 696e 2072 616e 6765 2877 2c20  r i in range(w, 
+00021b20: 6461 7461 2e73 6861 7065 5b30 5d20 2b20  data.shape[0] + 
+00021b30: 312c 2031 293a 0a20 2020 2020 2020 2020  1, 1):.         
+00021b40: 2020 2020 2020 2077 5f64 6174 6120 3d20         w_data = 
+00021b50: 6461 7461 5b69 202d 2077 203a 2069 5d0a  data[i - w : i].
+00021b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021b70: 6d65 6469 616e 203d 206e 702e 6d65 6469  median = np.medi
+00021b80: 616e 2877 5f64 6174 6129 0a20 2020 2020  an(w_data).     
+00021b90: 2020 2020 2020 2020 2020 206d 6164 203d             mad =
+00021ba0: 206e 702e 6d65 6469 616e 286e 702e 6162   np.median(np.ab
+00021bb0: 7328 775f 6461 7461 202d 206d 6564 6961  s(w_data - media
+00021bc0: 6e29 290a 2020 2020 2020 2020 2020 2020  n)).            
+00021bd0: 2020 2020 7468 7265 7368 6f6c 6420 3d20      threshold = 
+00021be0: 6b20 2a20 6d61 640a 2020 2020 2020 2020  k * mad.        
+00021bf0: 2020 2020 2020 2020 6f75 746c 6965 7273          outliers
+00021c00: 203d 206e 702e 6162 7328 775f 6461 7461   = np.abs(w_data
+00021c10: 202d 206d 6564 6961 6e29 203e 2074 6872   - median) > thr
+00021c20: 6573 686f 6c64 0a20 2020 2020 2020 2020  eshold.         
+00021c30: 2020 2020 2020 2072 6573 756c 7473 5b69         results[i
+00021c40: 202d 2031 5d20 3d20 6e70 2e73 756d 286f   - 1] = np.sum(o
+00021c50: 7574 6c69 6572 7320 2a20 3129 0a20 2020  utliers * 1).   
+00021c60: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
+00021c70: 6c74 730a 0a20 2020 2040 7374 6174 6963  lts..    @static
+00021c80: 6d65 7468 6f64 0a20 2020 2064 6566 2064  method.    def d
+00021c90: 756e 6e5f 696e 6465 7828 783a 206e 702e  unn_index(x: np.
+00021ca0: 6e64 6172 7261 792c 2079 3a20 6e70 2e6e  ndarray, y: np.n
+00021cb0: 6461 7272 6179 2920 2d3e 2066 6c6f 6174  darray) -> float
+00021cc0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00021cd0: 2020 2020 2020 4361 6c63 756c 6174 6520        Calculate 
+00021ce0: 7468 6520 4475 6e6e 2069 6e64 6578 2074  the Dunn index t
+00021cf0: 6f20 6576 616c 7561 7465 2074 6865 2071  o evaluate the q
+00021d00: 7561 6c69 7479 206f 6620 636c 7573 7465  uality of cluste
+00021d10: 7265 6420 6c61 6265 6c73 2e0a 0a20 2020  red labels...   
+00021d20: 2020 2020 2054 6869 7320 6675 6e63 7469       This functi
+00021d30: 6f6e 2063 616c 6375 6c61 7465 7320 7468  on calculates th
+00021d40: 6520 4475 6e6e 2069 6e64 6578 2c20 7768  e Dunn index, wh
+00021d50: 6963 6820 6973 2061 206d 6561 7375 7265  ich is a measure
+00021d60: 206f 6620 636c 7573 7465 7269 6e67 2071   of clustering q
+00021d70: 7561 6c69 7479 2e0a 2020 2020 2020 2020  uality..        
+00021d80: 5468 6520 696e 6465 7820 636f 6e73 6964  The index consid
+00021d90: 6572 7320 7468 6520 7261 7469 6f20 6f66  ers the ratio of
+00021da0: 2074 6865 206d 696e 696d 756d 2069 6e74   the minimum int
+00021db0: 6572 2d63 6c75 7374 6572 2064 6973 7461  er-cluster dista
+00021dc0: 6e63 6520 746f 2074 6865 206d 6178 696d  nce to the maxim
+00021dd0: 756d 0a20 2020 2020 2020 2069 6e74 7261  um.        intra
+00021de0: 2d63 6c75 7374 6572 2064 6973 7461 6e63  -cluster distanc
+00021df0: 652e 2041 2068 6967 6865 7220 4475 6e6e  e. A higher Dunn
+00021e00: 2069 6e64 6578 2069 6e64 6963 6174 6573   index indicates
+00021e10: 2062 6574 7465 7220 636c 7573 7465 7269   better clusteri
+00021e20: 6e67 2e0a 0a20 2020 2020 2020 202e 2e20  ng...        .. 
+00021e30: 6e6f 7465 3a3a 0a20 2020 2020 2020 2020  note::.         
+00021e40: 2020 4d6f 6469 6669 6564 2066 726f 6d20    Modified from 
+00021e50: 606a 716d 7669 6567 6173 203c 6874 7470  `jqmviegas <http
+00021e60: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f6a  s://github.com/j
+00021e70: 716d 7669 6567 6173 2f6a 716d 5f63 7669  qmviegas/jqm_cvi
+00021e80: 2f3e 605f 0a20 2020 2020 2020 2020 2020  />`_.           
+00021e90: 5769 6b69 2060 6874 7470 733a 2f2f 656e  Wiki `https://en
+00021ea0: 2e77 696b 6970 6564 6961 2e6f 7267 2f77  .wikipedia.org/w
+00021eb0: 696b 692f 4475 6e6e 5f69 6e64 6578 203c  iki/Dunn_index <
+00021ec0: 6874 7470 733a 2f2f 656e 2e77 696b 6970  https://en.wikip
+00021ed0: 6564 6961 2e6f 7267 2f77 696b 692f 4475  edia.org/wiki/Du
+00021ee0: 6e6e 5f69 6e64 6578 3e60 5f0a 2020 2020  nn_index>`_.    
+00021ef0: 2020 2020 2020 2055 7365 7320 4575 636c         Uses Eucl
+00021f00: 6964 6561 6e20 6469 7374 616e 6365 732e  idean distances.
+00021f10: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00021f20: 206e 702e 6e64 6172 7261 7920 783a 2032   np.ndarray x: 2
+00021f30: 4420 6172 7261 7920 7265 7072 6573 656e  D array represen
+00021f40: 7469 6e67 2074 6865 2064 6174 6120 706f  ting the data po
+00021f50: 696e 7473 2e20 5368 6170 6520 286e 5f73  ints. Shape (n_s
+00021f60: 616d 706c 6573 2c20 6e5f 6665 6174 7572  amples, n_featur
+00021f70: 6573 292e 0a20 2020 2020 2020 203a 7061  es)..        :pa
+00021f80: 7261 6d20 6e70 2e6e 6461 7272 6179 2079  ram np.ndarray y
+00021f90: 3a20 3244 2061 7272 6179 2072 6570 7265  : 2D array repre
+00021fa0: 7365 6e74 696e 6720 636c 7573 7465 7220  senting cluster 
+00021fb0: 6c61 6265 6c73 2066 6f72 2065 6163 6820  labels for each 
+00021fc0: 6461 7461 2070 6f69 6e74 2e20 5368 6170  data point. Shap
+00021fd0: 6520 286e 5f73 616d 706c 6573 2c29 2e0a  e (n_samples,)..
+00021fe0: 2020 2020 2020 2020 3a72 6574 7572 6e20          :return 
+00021ff0: 666c 6f61 743a 2054 6865 2044 756e 6e20  float: The Dunn 
+00022000: 696e 6465 7820 7661 6c75 650a 0a20 2020  index value..   
+00022010: 2020 2020 203a 6578 616d 706c 653a 0a20       :example:. 
+00022020: 2020 2020 2020 203e 3e3e 2078 203d 206e         >>> x = n
+00022030: 702e 7261 6e64 6f6d 2e72 616e 6469 6e74  p.random.randint
+00022040: 2830 2c20 3130 302c 2028 3130 302c 2032  (0, 100, (100, 2
+00022050: 2929 0a20 2020 2020 2020 203e 3e3e 2079  )).        >>> y
+00022060: 203d 206e 702e 7261 6e64 6f6d 2e72 616e   = np.random.ran
+00022070: 6469 6e74 2830 2c20 332c 2028 3130 302c  dint(0, 3, (100,
+00022080: 2929 0a20 2020 2020 2020 203e 3e3e 2053  )).        >>> S
+00022090: 7461 7469 7374 6963 732e 6475 6e6e 5f69  tatistics.dunn_i
+000220a0: 6e64 6578 2878 3d78 2c20 793d 7929 0a20  ndex(x=x, y=y). 
+000220b0: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+000220c0: 2020 2020 6368 6563 6b5f 7661 6c69 645f      check_valid_
+000220d0: 6172 7261 7928 0a20 2020 2020 2020 2020  array(.         
+000220e0: 2020 2064 6174 613d 782c 0a20 2020 2020     data=x,.     
+000220f0: 2020 2020 2020 2073 6f75 7263 653d 5374         source=St
+00022100: 6174 6973 7469 6373 2e64 756e 6e5f 696e  atistics.dunn_in
+00022110: 6465 782e 5f5f 6e61 6d65 5f5f 2c0a 2020  dex.__name__,.  
+00022120: 2020 2020 2020 2020 2020 6163 6365 7074            accept
+00022130: 6564 5f6e 6469 6d73 3d28 322c 292c 0a20  ed_ndims=(2,),. 
+00022140: 2020 2020 2020 2020 2020 2061 6363 6570             accep
+00022150: 7465 645f 6474 7970 6573 3d28 696e 742c  ted_dtypes=(int,
+00022160: 2066 6c6f 6174 2c20 6e70 2e66 6c6f 6174   float, np.float
+00022170: 3634 2c20 6e70 2e66 6c6f 6174 3332 2c20  64, np.float32, 
+00022180: 6e70 2e69 6e74 3634 2c20 6e70 2e69 6e74  np.int64, np.int
+00022190: 3332 292c 0a20 2020 2020 2020 2029 0a20  32),.        ). 
+000221a0: 2020 2020 2020 2063 6865 636b 5f76 616c         check_val
+000221b0: 6964 5f61 7272 6179 280a 2020 2020 2020  id_array(.      
+000221c0: 2020 2020 2020 6461 7461 3d79 2c0a 2020        data=y,.  
+000221d0: 2020 2020 2020 2020 2020 736f 7572 6365            source
+000221e0: 3d53 7461 7469 7374 6963 732e 6475 6e6e  =Statistics.dunn
+000221f0: 5f69 6e64 6578 2e5f 5f6e 616d 655f 5f2c  _index.__name__,
+00022200: 0a20 2020 2020 2020 2020 2020 2061 6363  .            acc
+00022210: 6570 7465 645f 6e64 696d 733d 2831 2c29  epted_ndims=(1,)
+00022220: 2c0a 2020 2020 2020 2020 2020 2020 6163  ,.            ac
+00022230: 6365 7074 6564 5f73 6861 7065 733d 5b28  cepted_shapes=[(
+00022240: 782e 7368 6170 655b 305d 2c29 5d2c 0a20  x.shape[0],)],. 
+00022250: 2020 2020 2020 2020 2020 2061 6363 6570             accep
+00022260: 7465 645f 6474 7970 6573 3d28 696e 742c  ted_dtypes=(int,
+00022270: 2066 6c6f 6174 2c20 6e70 2e66 6c6f 6174   float, np.float
+00022280: 3634 2c20 6e70 2e66 6c6f 6174 3332 2c20  64, np.float32, 
+00022290: 6e70 2e69 6e74 3634 2c20 6e70 2e69 6e74  np.int64, np.int
+000222a0: 3332 292c 0a20 2020 2020 2020 2029 0a20  32),.        ). 
+000222b0: 2020 2020 2020 2064 6973 7461 6e63 6573         distances
+000222c0: 203d 2046 6561 7475 7265 4578 7472 6163   = FeatureExtrac
+000222d0: 7469 6f6e 4d69 7869 6e2e 6364 6973 7428  tionMixin.cdist(
+000222e0: 0a20 2020 2020 2020 2020 2020 2061 7272  .            arr
+000222f0: 6179 5f31 3d78 2e61 7374 7970 6528 6e70  ay_1=x.astype(np
+00022300: 2e66 6c6f 6174 3332 292c 2061 7272 6179  .float32), array
+00022310: 5f32 3d78 2e61 7374 7970 6528 6e70 2e66  _2=x.astype(np.f
+00022320: 6c6f 6174 3332 290a 2020 2020 2020 2020  loat32).        
+00022330: 290a 2020 2020 2020 2020 6b73 203d 206e  ).        ks = n
+00022340: 702e 736f 7274 286e 702e 756e 6971 7565  p.sort(np.unique
+00022350: 2879 2929 2e61 7374 7970 6528 6e70 2e69  (y)).astype(np.i
+00022360: 6e74 3634 290a 2020 2020 2020 2020 6465  nt64).        de
+00022370: 6c74 6173 203d 206e 702e 6675 6c6c 2828  ltas = np.full((
+00022380: 6b73 2e73 6861 7065 5b30 5d2c 206b 732e  ks.shape[0], ks.
+00022390: 7368 6170 655b 305d 292c 206e 702e 696e  shape[0]), np.in
+000223a0: 6629 0a20 2020 2020 2020 2062 6967 5f64  f).        big_d
+000223b0: 656c 7461 7320 3d20 6e70 2e7a 6572 6f73  eltas = np.zeros
+000223c0: 285b 6b73 2e73 6861 7065 5b30 5d2c 2031  ([ks.shape[0], 1
+000223d0: 5d29 0a20 2020 2020 2020 2066 6f72 2069  ]).        for i
+000223e0: 2c20 6c20 696e 206c 6973 7428 7065 726d  , l in list(perm
+000223f0: 7574 6174 696f 6e73 286b 732c 2032 2929  utations(ks, 2))
+00022400: 3a0a 2020 2020 2020 2020 2020 2020 7661  :.            va
+00022410: 6c75 6573 203d 2064 6973 7461 6e63 6573  lues = distances
+00022420: 5b6e 702e 7768 6572 6528 2879 203d 3d20  [np.where((y == 
+00022430: 6929 295d 5b3a 2c20 6e70 2e77 6865 7265  i))][:, np.where
+00022440: 2828 7920 3d3d 206c 2929 5d0a 2020 2020  ((y == l))].    
+00022450: 2020 2020 2020 2020 6465 6c74 6173 5b69          deltas[i
+00022460: 2c20 6c5d 203d 206e 702e 6d69 6e28 7661  , l] = np.min(va
+00022470: 6c75 6573 5b6e 702e 6e6f 6e7a 6572 6f28  lues[np.nonzero(
+00022480: 7661 6c75 6573 295d 290a 2020 2020 2020  values)]).      
+00022490: 2020 666f 7220 6b20 696e 206b 733a 0a20    for k in ks:. 
+000224a0: 2020 2020 2020 2020 2020 2076 616c 7565             value
+000224b0: 7320 3d20 6469 7374 616e 6365 735b 6e70  s = distances[np
+000224c0: 2e77 6865 7265 2828 7920 3d3d 206b 735b  .where((y == ks[
+000224d0: 6b5d 2929 5d5b 3a2c 206e 702e 7768 6572  k]))][:, np.wher
+000224e0: 6528 2879 203d 3d20 6b73 5b6b 5d29 295d  e((y == ks[k]))]
+000224f0: 0a20 2020 2020 2020 2020 2020 2062 6967  .            big
+00022500: 5f64 656c 7461 735b 6b5d 203d 206e 702e  _deltas[k] = np.
+00022510: 6d61 7828 7661 6c75 6573 290a 0a20 2020  max(values)..   
+00022520: 2020 2020 2072 6574 7572 6e20 6e70 2e6d       return np.m
+00022530: 696e 2864 656c 7461 7329 202f 206e 702e  in(deltas) / np.
+00022540: 6d61 7828 6269 675f 6465 6c74 6173 290a  max(big_deltas).
+00022550: 0a20 2020 2064 6566 2064 6176 6973 5f62  .    def davis_b
+00022560: 6f75 6c64 696e 2878 3a20 6e70 2e6e 6461  ouldin(x: np.nda
+00022570: 7272 6179 2c20 793a 206e 702e 6e64 6172  rray, y: np.ndar
+00022580: 7261 7929 202d 3e20 666c 6f61 743a 0a20  ray) -> float:. 
+00022590: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000225a0: 2020 2043 616c 6375 6c61 7465 2074 6865     Calculate the
+000225b0: 2044 6176 6973 2d42 6f75 6c64 696e 2069   Davis-Bouldin i
+000225c0: 6e64 6578 2066 6f72 2065 7661 6c75 6174  ndex for evaluat
+000225d0: 696e 6720 636c 7573 7465 7269 6e67 2070  ing clustering p
+000225e0: 6572 666f 726d 616e 6365 2e0a 0a20 2020  erformance...   
+000225f0: 2020 2020 2044 6176 6973 2d42 6f75 6c64       Davis-Bould
+00022600: 696e 2069 6e64 6578 206d 6561 7375 7265  in index measure
+00022610: 7320 7468 6520 636c 7573 7465 7269 6e67  s the clustering
+00022620: 2071 7561 6c69 7479 2062 6173 6564 206f   quality based o
+00022630: 6e20 7468 6520 7769 7468 696e 2d63 6c75  n the within-clu
+00022640: 7374 6572 0a20 2020 2020 2020 2073 696d  ster.        sim
+00022650: 696c 6172 6974 7920 616e 6420 6265 7477  ilarity and betw
+00022660: 6565 6e2d 636c 7573 7465 7220 6469 7373  een-cluster diss
+00022670: 696d 696c 6172 6974 792e 204c 6f77 6572  imilarity. Lower
+00022680: 2076 616c 7565 7320 696e 6469 6361 7465   values indicate
+00022690: 2062 6574 7465 7220 636c 7573 7465 7269   better clusteri
+000226a0: 6e67 2e0a 0a20 2020 2020 2020 202e 2e20  ng...        .. 
+000226b0: 6e6f 7465 3a3a 0a20 2020 2020 2020 2020  note::.         
+000226c0: 2020 4d6f 6469 6669 6564 2066 726f 6d20    Modified from 
+000226d0: 6073 6369 6b69 742d 6c65 6172 6e20 3c68  `scikit-learn <h
+000226e0: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+000226f0: 6d2f 7363 696b 6974 2d6c 6561 726e 2f73  m/scikit-learn/s
+00022700: 6369 6b69 742d 6c65 6172 6e2f 626c 6f62  cikit-learn/blob
+00022710: 2f66 3037 6530 3133 3862 6665 6534 3163  /f07e0138bfee41c
+00022720: 6432 6330 6135 6430 3235 3164 6333 6665  d2c0a5d0251dc3fe
+00022730: 3033 6536 6531 3038 342f 736b 6c65 6172  03e6e1084/sklear
+00022740: 6e2f 6d65 7472 6963 732f 636c 7573 7465  n/metrics/cluste
+00022750: 722f 5f75 6e73 7570 6572 7669 7365 642e  r/_unsupervised.
+00022760: 7079 234c 3339 303e 605f 0a0a 2020 2020  py#L390>`_..    
+00022770: 2020 2020 3a70 6172 616d 206e 702e 6e64      :param np.nd
+00022780: 6172 7261 7920 783a 2032 4420 6172 7261  array x: 2D arra
+00022790: 7920 7265 7072 6573 656e 7469 6e67 2074  y representing t
+000227a0: 6865 2064 6174 6120 706f 696e 7473 2e20  he data points. 
+000227b0: 5368 6170 6520 286e 5f73 616d 706c 6573  Shape (n_samples
+000227c0: 2c20 6e5f 6665 6174 7572 6573 2f6e 5f64  , n_features/n_d
+000227d0: 696d 656e 7369 6f6e 292e 0a20 2020 2020  imension)..     
+000227e0: 2020 203a 7061 7261 6d20 6e70 2e6e 6461     :param np.nda
+000227f0: 7272 6179 2079 3a20 3244 2061 7272 6179  rray y: 2D array
+00022800: 2072 6570 7265 7365 6e74 696e 6720 636c   representing cl
+00022810: 7573 7465 7220 6c61 6265 6c73 2066 6f72  uster labels for
+00022820: 2065 6163 6820 6461 7461 2070 6f69 6e74   each data point
+00022830: 2e20 5368 6170 6520 286e 5f73 616d 706c  . Shape (n_sampl
+00022840: 6573 2c29 2e0a 2020 2020 2020 2020 3a72  es,)..        :r
+00022850: 6574 7572 6e20 666c 6f61 743a 2044 6176  eturn float: Dav
+00022860: 6973 2d42 6f75 6c64 696e 2073 636f 7265  is-Bouldin score
+00022870: 2e0a 0a20 2020 2020 2020 203a 6578 616d  ...        :exam
+00022880: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
+00022890: 2078 203d 206e 702e 7261 6e64 6f6d 2e72   x = np.random.r
+000228a0: 616e 6469 6e74 2830 2c20 3130 302c 2028  andint(0, 100, (
+000228b0: 3130 302c 2032 2929 0a20 2020 2020 2020  100, 2)).       
+000228c0: 203e 3e3e 2079 203d 206e 702e 7261 6e64   >>> y = np.rand
+000228d0: 6f6d 2e72 616e 6469 6e74 2830 2c20 332c  om.randint(0, 3,
+000228e0: 2028 3130 302c 2929 0a20 2020 2020 2020   (100,)).       
+000228f0: 203e 3e3e 2053 7461 7469 7374 6963 732e   >>> Statistics.
+00022900: 6461 7669 735f 626f 756c 6469 6e28 783d  davis_bouldin(x=
+00022910: 782c 2079 3d79 290a 2020 2020 2020 2020  x, y=y).        
+00022920: 2222 220a 0a20 2020 2020 2020 2063 6865  """..        che
+00022930: 636b 5f76 616c 6964 5f61 7272 6179 280a  ck_valid_array(.
+00022940: 2020 2020 2020 2020 2020 2020 6461 7461              data
+00022950: 3d78 2c0a 2020 2020 2020 2020 2020 2020  =x,.            
+00022960: 736f 7572 6365 3d53 7461 7469 7374 6963  source=Statistic
+00022970: 732e 6461 7669 735f 626f 756c 6469 6e2e  s.davis_bouldin.
+00022980: 5f5f 6e61 6d65 5f5f 2c0a 2020 2020 2020  __name__,.      
+00022990: 2020 2020 2020 6163 6365 7074 6564 5f6e        accepted_n
+000229a0: 6469 6d73 3d28 322c 292c 0a20 2020 2020  dims=(2,),.     
+000229b0: 2020 2020 2020 2061 6363 6570 7465 645f         accepted_
+000229c0: 6474 7970 6573 3d28 696e 742c 2066 6c6f  dtypes=(int, flo
+000229d0: 6174 2c20 6e70 2e66 6c6f 6174 3634 2c20  at, np.float64, 
+000229e0: 6e70 2e66 6c6f 6174 3332 2c20 6e70 2e69  np.float32, np.i
+000229f0: 6e74 3634 2c20 6e70 2e69 6e74 3332 292c  nt64, np.int32),
+00022a00: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00022a10: 2020 2063 6865 636b 5f76 616c 6964 5f61     check_valid_a
+00022a20: 7272 6179 280a 2020 2020 2020 2020 2020  rray(.          
+00022a30: 2020 6461 7461 3d79 2c0a 2020 2020 2020    data=y,.      
+00022a40: 2020 2020 2020 736f 7572 6365 3d53 7461        source=Sta
+00022a50: 7469 7374 6963 732e 6461 7669 735f 626f  tistics.davis_bo
+00022a60: 756c 6469 6e2e 5f5f 6e61 6d65 5f5f 2c0a  uldin.__name__,.
+00022a70: 2020 2020 2020 2020 2020 2020 6163 6365              acce
+00022a80: 7074 6564 5f6e 6469 6d73 3d28 312c 292c  pted_ndims=(1,),
+00022a90: 0a20 2020 2020 2020 2020 2020 2061 6363  .            acc
+00022aa0: 6570 7465 645f 7368 6170 6573 3d5b 2878  epted_shapes=[(x
+00022ab0: 2e73 6861 7065 5b30 5d2c 295d 2c0a 2020  .shape[0],)],.  
+00022ac0: 2020 2020 2020 2020 2020 6163 6365 7074            accept
+00022ad0: 6564 5f64 7479 7065 733d 2869 6e74 2c20  ed_dtypes=(int, 
+00022ae0: 666c 6f61 742c 206e 702e 666c 6f61 7436  float, np.float6
+00022af0: 342c 206e 702e 666c 6f61 7433 322c 206e  4, np.float32, n
+00022b00: 702e 696e 7436 342c 206e 702e 696e 7433  p.int64, np.int3
+00022b10: 3229 2c0a 2020 2020 2020 2020 290a 2020  2),.        ).  
+00022b20: 2020 2020 2020 6e5f 6c61 6265 6c73 203d        n_labels =
+00022b30: 206e 702e 756e 6971 7565 2879 292e 7368   np.unique(y).sh
+00022b40: 6170 655b 305d 0a20 2020 2020 2020 206c  ape[0].        l
+00022b50: 6162 656c 7320 3d20 6e70 2e75 6e69 7175  abels = np.uniqu
+00022b60: 6528 7929 0a20 2020 2020 2020 2069 6e74  e(y).        int
+00022b70: 7261 5f64 6973 7473 203d 206e 702e 6675  ra_dists = np.fu
+00022b80: 6c6c 2828 6e5f 6c61 6265 6c73 292c 2030  ll((n_labels), 0
+00022b90: 2e30 290a 2020 2020 2020 2020 6365 6e74  .0).        cent
+00022ba0: 726f 6964 7320 3d20 6e70 2e66 756c 6c28  roids = np.full(
+00022bb0: 286e 5f6c 6162 656c 732c 2078 2e73 6861  (n_labels, x.sha
+00022bc0: 7065 5b31 5d29 2c20 302e 3029 0a20 2020  pe[1]), 0.0).   
+00022bd0: 2020 2020 2066 6f72 206b 2069 6e20 7261       for k in ra
+00022be0: 6e67 6528 6e5f 6c61 6265 6c73 293a 0a20  nge(n_labels):. 
+00022bf0: 2020 2020 2020 2020 2020 2063 6c75 7374             clust
+00022c00: 6572 5f6b 203d 2078 5b6e 702e 6172 6777  er_k = x[np.argw
+00022c10: 6865 7265 2879 203d 3d20 6c61 6265 6c73  here(y == labels
+00022c20: 5b6b 5d29 5d2e 7265 7368 6170 6528 2d31  [k])].reshape(-1
+00022c30: 2c20 3229 0a20 2020 2020 2020 2020 2020  , 2).           
+00022c40: 2063 6c75 7374 6572 5f6d 6561 6e20 3d20   cluster_mean = 
+00022c50: 6e70 2e66 756c 6c28 2878 2e73 6861 7065  np.full((x.shape
+00022c60: 5b31 5d29 2c20 6e70 2e6e 616e 290a 2020  [1]), np.nan).  
+00022c70: 2020 2020 2020 2020 2020 666f 7220 6920            for i 
+00022c80: 696e 2072 616e 6765 2863 6c75 7374 6572  in range(cluster
+00022c90: 5f6d 6561 6e2e 7368 6170 655b 305d 293a  _mean.shape[0]):
+00022ca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022cb0: 2063 6c75 7374 6572 5f6d 6561 6e5b 695d   cluster_mean[i]
+00022cc0: 203d 206e 702e 6d65 616e 2863 6c75 7374   = np.mean(clust
+00022cd0: 6572 5f6b 5b3a 2c20 695d 2e66 6c61 7474  er_k[:, i].flatt
+00022ce0: 656e 2829 290a 2020 2020 2020 2020 2020  en()).          
+00022cf0: 2020 6365 6e74 726f 6964 735b 6b5d 203d    centroids[k] =
+00022d00: 2063 6c75 7374 6572 5f6d 6561 6e0a 2020   cluster_mean.  
+00022d10: 2020 2020 2020 2020 2020 696e 7472 615f            intra_
+00022d20: 6469 7374 735b 6b5d 203d 206e 702e 6176  dists[k] = np.av
+00022d30: 6572 6167 6528 0a20 2020 2020 2020 2020  erage(.         
+00022d40: 2020 2020 2020 2046 6561 7475 7265 4578         FeatureEx
+00022d50: 7472 6163 7469 6f6e 4d69 7869 6e2e 6672  tractionMixin.fr
+00022d60: 616d 6577 6973 655f 6575 636c 6964 6561  amewise_euclidea
+00022d70: 6e5f 6469 7374 616e 6365 280a 2020 2020  n_distance(.    
+00022d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022d90: 6c6f 6361 7469 6f6e 5f31 3d63 6c75 7374  location_1=clust
+00022da0: 6572 5f6b 2c0a 2020 2020 2020 2020 2020  er_k,.          
+00022db0: 2020 2020 2020 2020 2020 6c6f 6361 7469            locati
+00022dc0: 6f6e 5f32 3d6e 702e 6675 6c6c 2863 6c75  on_2=np.full(clu
+00022dd0: 7374 6572 5f6b 2e73 6861 7065 2c20 636c  ster_k.shape, cl
+00022de0: 7573 7465 725f 6d65 616e 292c 0a20 2020  uster_mean),.   
+00022df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022e00: 2070 785f 7065 725f 6d6d 3d31 2c0a 2020   px_per_mm=1,.  
+00022e10: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00022e20: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00022e30: 2020 2020 2020 6365 6e74 726f 6964 5f64        centroid_d
+00022e40: 6973 7461 6e63 6573 203d 2046 6561 7475  istances = Featu
+00022e50: 7265 4578 7472 6163 7469 6f6e 4d69 7869  reExtractionMixi
+00022e60: 6e2e 6364 6973 7428 0a20 2020 2020 2020  n.cdist(.       
+00022e70: 2020 2020 2061 7272 6179 5f31 3d63 656e       array_1=cen
+00022e80: 7472 6f69 6473 2e61 7374 7970 6528 6e70  troids.astype(np
+00022e90: 2e66 6c6f 6174 3332 292c 2061 7272 6179  .float32), array
+00022ea0: 5f32 3d63 656e 7472 6f69 6473 2e61 7374  _2=centroids.ast
+00022eb0: 7970 6528 6e70 2e66 6c6f 6174 3332 290a  ype(np.float32).
+00022ec0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00022ed0: 2020 6966 206e 702e 616c 6c63 6c6f 7365    if np.allclose
+00022ee0: 2869 6e74 7261 5f64 6973 7473 2c20 3029  (intra_dists, 0)
+00022ef0: 206f 7220 6e70 2e61 6c6c 636c 6f73 6528   or np.allclose(
+00022f00: 6365 6e74 726f 6964 5f64 6973 7461 6e63  centroid_distanc
+00022f10: 6573 2c20 3029 3a0a 2020 2020 2020 2020  es, 0):.        
+00022f20: 2020 2020 7265 7475 726e 2030 2e30 0a20      return 0.0. 
+00022f30: 2020 2020 2020 2063 656e 7472 6f69 645f         centroid_
+00022f40: 6469 7374 616e 6365 735b 6365 6e74 726f  distances[centro
+00022f50: 6964 5f64 6973 7461 6e63 6573 203d 3d20  id_distances == 
+00022f60: 305d 203d 206e 702e 696e 660a 2020 2020  0] = np.inf.    
+00022f70: 2020 2020 636f 6d62 696e 6564 5f69 6e74      combined_int
+00022f80: 7261 5f64 6973 7473 203d 2069 6e74 7261  ra_dists = intra
+00022f90: 5f64 6973 7473 5b3a 2c20 4e6f 6e65 5d20  _dists[:, None] 
+00022fa0: 2b20 696e 7472 615f 6469 7374 730a 2020  + intra_dists.  
+00022fb0: 2020 2020 2020 7265 7475 726e 206e 702e        return np.
+00022fc0: 6d65 616e 286e 702e 6d61 7828 636f 6d62  mean(np.max(comb
+00022fd0: 696e 6564 5f69 6e74 7261 5f64 6973 7473  ined_intra_dists
+00022fe0: 202f 2063 656e 7472 6f69 645f 6469 7374   / centroid_dist
+00022ff0: 616e 6365 732c 2061 7869 733d 3129 290a  ances, axis=1)).
+00023000: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
+00023010: 6f64 0a20 2020 2040 6e6a 6974 2822 2866  od.    @njit("(f
+00023020: 6c6f 6174 3332 5b3a 2c3a 5d2c 2069 6e74  loat32[:,:], int
+00023030: 3634 5b3a 5d29 222c 2063 6163 6865 3d54  64[:])", cache=T
+00023040: 7275 6529 0a20 2020 2064 6566 2063 616c  rue).    def cal
+00023050: 696e 736b 695f 6861 7261 6261 737a 2878  inski_harabasz(x
+00023060: 3a20 6e70 2e6e 6461 7272 6179 2c20 793a  : np.ndarray, y:
+00023070: 206e 702e 6e64 6172 7261 7929 202d 3e20   np.ndarray) -> 
+00023080: 666c 6f61 743a 0a20 2020 2020 2020 2022  float:.        "
+00023090: 2222 0a20 2020 2020 2020 2043 6f6d 7075  "".        Compu
+000230a0: 7465 2074 6865 2043 616c 696e 736b 692d  te the Calinski-
+000230b0: 4861 7261 6261 737a 2073 636f 7265 2074  Harabasz score t
+000230c0: 6f20 6576 616c 7561 7465 2063 6c75 7374  o evaluate clust
+000230d0: 6572 696e 6720 7175 616c 6974 792e 0a0a  ering quality...
+000230e0: 2020 2020 2020 2020 5468 6520 4361 6c69          The Cali
+000230f0: 6e73 6b69 2d48 6172 6162 6173 7a20 7363  nski-Harabasz sc
+00023100: 6f72 6520 6973 2061 206d 6561 7375 7265  ore is a measure
+00023110: 206f 6620 636c 7573 7465 7220 7365 7061   of cluster sepa
+00023120: 7261 7469 6f6e 2061 6e64 2063 6f6d 7061  ration and compa
+00023130: 6374 6e65 7373 2e0a 2020 2020 2020 2020  ctness..        
+00023140: 4974 2069 7320 6361 6c63 756c 6174 6564  It is calculated
+00023150: 2061 7320 7468 6520 7261 7469 6f20 6f66   as the ratio of
+00023160: 2074 6865 2062 6574 7765 656e 2d63 6c75   the between-clu
+00023170: 7374 6572 2064 6973 7065 7273 696f 6e20  ster dispersion 
+00023180: 746f 2074 6865 0a20 2020 2020 2020 2077  to the.        w
+00023190: 6974 6869 6e2d 636c 7573 7465 7220 6469  ithin-cluster di
+000231a0: 7370 6572 7369 6f6e 2e20 4120 6869 6768  spersion. A high
+000231b0: 6572 2073 636f 7265 2069 6e64 6963 6174  er score indicat
+000231c0: 6573 2062 6574 7465 7220 636c 7573 7465  es better cluste
+000231d0: 7269 6e67 2e0a 0a20 2020 2020 2020 203a  ring...        :
+000231e0: 7061 7261 6d20 783a 2032 4420 6172 7261  param x: 2D arra
+000231f0: 7920 7265 7072 6573 656e 7469 6e67 2074  y representing t
+00023200: 6865 2064 6174 6120 706f 696e 7473 2e20  he data points. 
+00023210: 5368 6170 6520 286e 5f73 616d 706c 6573  Shape (n_samples
+00023220: 2c20 6e5f 6665 6174 7572 6573 2f6e 5f64  , n_features/n_d
+00023230: 696d 656e 7369 6f6e 292e 0a20 2020 2020  imension)..     
+00023240: 2020 203a 7061 7261 6d20 793a 2032 4420     :param y: 2D 
+00023250: 6172 7261 7920 7265 7072 6573 656e 7469  array representi
+00023260: 6e67 2063 6c75 7374 6572 206c 6162 656c  ng cluster label
+00023270: 7320 666f 7220 6561 6368 2064 6174 6120  s for each data 
+00023280: 706f 696e 742e 2053 6861 7065 2028 6e5f  point. Shape (n_
+00023290: 7361 6d70 6c65 732c 292e 0a20 2020 2020  samples,)..     
+000232a0: 2020 203a 7265 7475 726e 2066 6c6f 6174     :return float
+000232b0: 3a20 4361 6c69 6e73 6b69 2d48 6172 6162  : Calinski-Harab
+000232c0: 6173 7a20 7363 6f72 652e 0a0a 2020 2020  asz score...    
+000232d0: 2020 2020 3a65 7861 6d70 6c65 3a0a 2020      :example:.  
+000232e0: 2020 2020 2020 3e3e 3e20 7820 3d20 6e70        >>> x = np
+000232f0: 2e72 616e 646f 6d2e 7261 6e64 6f6d 2828  .random.random((
+00023300: 3130 302c 2032 2929 2e61 7374 7970 6528  100, 2)).astype(
+00023310: 6e70 2e66 6c6f 6174 3332 290a 2020 2020  np.float32).    
+00023320: 2020 2020 3e3e 3e20 7920 3d20 6e70 2e72      >>> y = np.r
+00023330: 616e 646f 6d2e 7261 6e64 696e 7428 302c  andom.randint(0,
+00023340: 2031 3030 2c20 2831 3030 2c29 292e 6173   100, (100,)).as
+00023350: 7479 7065 286e 702e 696e 7436 3429 0a20  type(np.int64). 
+00023360: 2020 2020 2020 203e 3e3e 2053 7461 7469         >>> Stati
+00023370: 7374 6963 732e 6361 6c69 6e73 6b69 5f68  stics.calinski_h
+00023380: 6172 6162 6173 7a28 783d 782c 2079 3d79  arabasz(x=x, y=y
+00023390: 290a 2020 2020 2020 2020 2222 220a 0a20  ).        """.. 
+000233a0: 2020 2020 2020 206e 5f6c 6162 656c 7320         n_labels 
+000233b0: 3d20 6e70 2e75 6e69 7175 6528 7929 2e73  = np.unique(y).s
+000233c0: 6861 7065 5b30 5d0a 2020 2020 2020 2020  hape[0].        
+000233d0: 6c61 6265 6c73 203d 206e 702e 756e 6971  labels = np.uniq
+000233e0: 7565 2879 290a 2020 2020 2020 2020 6578  ue(y).        ex
+000233f0: 7472 615f 6469 7370 6572 7369 6f6e 2c20  tra_dispersion, 
+00023400: 696e 7472 615f 6469 7370 6572 7369 6f6e  intra_dispersion
+00023410: 203d 2030 2e30 2c20 302e 300a 2020 2020   = 0.0, 0.0.    
+00023420: 2020 2020 676c 6f62 616c 5f6d 6561 6e20      global_mean 
+00023430: 3d20 6e70 2e66 756c 6c28 2878 2e73 6861  = np.full((x.sha
+00023440: 7065 5b31 5d29 2c20 6e70 2e6e 616e 290a  pe[1]), np.nan).
+00023450: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+00023460: 2072 616e 6765 2878 2e73 6861 7065 5b31   range(x.shape[1
+00023470: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
+00023480: 676c 6f62 616c 5f6d 6561 6e5b 695d 203d  global_mean[i] =
+00023490: 206e 702e 6d65 616e 2878 5b3a 2c20 695d   np.mean(x[:, i]
+000234a0: 2e66 6c61 7474 656e 2829 290a 2020 2020  .flatten()).    
+000234b0: 2020 2020 666f 7220 6b20 696e 2072 616e      for k in ran
+000234c0: 6765 286e 5f6c 6162 656c 7329 3a0a 2020  ge(n_labels):.  
+000234d0: 2020 2020 2020 2020 2020 636c 7573 7465            cluste
+000234e0: 725f 6b20 3d20 785b 6e70 2e61 7267 7768  r_k = x[np.argwh
+000234f0: 6572 6528 7920 3d3d 206c 6162 656c 735b  ere(y == labels[
+00023500: 6b5d 292e 666c 6174 7465 6e28 292c 203a  k]).flatten(), :
+00023510: 5d0a 2020 2020 2020 2020 2020 2020 6d65  ].            me
+00023520: 616e 5f6b 203d 206e 702e 6675 6c6c 2828  an_k = np.full((
+00023530: 636c 7573 7465 725f 6b2e 7368 6170 655b  cluster_k.shape[
+00023540: 315d 292c 206e 702e 6e61 6e29 0a20 2020  1]), np.nan).   
+00023550: 2020 2020 2020 2020 2066 6f72 2069 2069           for i i
+00023560: 6e20 7261 6e67 6528 636c 7573 7465 725f  n range(cluster_
+00023570: 6b2e 7368 6170 655b 315d 293a 0a20 2020  k.shape[1]):.   
+00023580: 2020 2020 2020 2020 2020 2020 206d 6561               mea
+00023590: 6e5f 6b5b 695d 203d 206e 702e 6d65 616e  n_k[i] = np.mean
+000235a0: 2863 6c75 7374 6572 5f6b 5b3a 2c20 695d  (cluster_k[:, i]
+000235b0: 2e66 6c61 7474 656e 2829 290a 2020 2020  .flatten()).    
+000235c0: 2020 2020 2020 2020 6578 7472 615f 6469          extra_di
+000235d0: 7370 6572 7369 6f6e 202b 3d20 6c65 6e28  spersion += len(
+000235e0: 636c 7573 7465 725f 6b29 202a 206e 702e  cluster_k) * np.
+000235f0: 7375 6d28 286d 6561 6e5f 6b20 2d20 676c  sum((mean_k - gl
+00023600: 6f62 616c 5f6d 6561 6e29 202a 2a20 3229  obal_mean) ** 2)
+00023610: 0a20 2020 2020 2020 2020 2020 2069 6e74  .            int
+00023620: 7261 5f64 6973 7065 7273 696f 6e20 2b3d  ra_dispersion +=
+00023630: 206e 702e 7375 6d28 2863 6c75 7374 6572   np.sum((cluster
+00023640: 5f6b 202d 206d 6561 6e5f 6b29 202a 2a20  _k - mean_k) ** 
+00023650: 3229 0a0a 2020 2020 2020 2020 6465 6e6f  2)..        deno
+00023660: 6d69 6e61 746f 7220 3d20 696e 7472 615f  minator = intra_
+00023670: 6469 7370 6572 7369 6f6e 202a 2028 6e5f  dispersion * (n_
+00023680: 6c61 6265 6c73 202d 2031 2e30 290a 2020  labels - 1.0).  
+00023690: 2020 2020 2020 6966 2064 656e 6f6d 696e        if denomin
+000236a0: 6174 6f72 203d 3d20 302e 303a 0a20 2020  ator == 0.0:.   
+000236b0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000236c0: 302e 300a 2020 2020 2020 2020 656c 7365  0.0.        else
+000236d0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+000236e0: 7475 726e 2065 7874 7261 5f64 6973 7065  turn extra_dispe
+000236f0: 7273 696f 6e20 2a20 2878 2e73 6861 7065  rsion * (x.shape
+00023700: 5b30 5d20 2d20 6e5f 6c61 6265 6c73 2920  [0] - n_labels) 
+00023710: 2f20 6465 6e6f 6d69 6e61 746f 720a 0a20  / denominator.. 
+00023720: 2020 2040 7374 6174 6963 6d65 7468 6f64     @staticmethod
+00023730: 0a20 2020 2064 6566 2061 646a 7573 7465  .    def adjuste
+00023740: 645f 7261 6e64 2878 3a20 6e70 2e6e 6461  d_rand(x: np.nda
+00023750: 7272 6179 2c20 793a 206e 702e 6e64 6172  rray, y: np.ndar
+00023760: 7261 7929 202d 3e20 666c 6f61 743a 0a20  ray) -> float:. 
+00023770: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00023780: 2020 2043 616c 6375 6c61 7465 2074 6865     Calculate the
+00023790: 2041 646a 7573 7465 6420 5261 6e64 2049   Adjusted Rand I
+000237a0: 6e64 6578 2028 4152 4929 2062 6574 7765  ndex (ARI) betwe
+000237b0: 656e 2074 776f 2063 6c75 7374 6572 696e  en two clusterin
+000237c0: 6773 2e0a 0a20 2020 2020 2020 203a 7061  gs...        :pa
+000237d0: 7261 6d20 6e70 2e6e 6461 7272 6179 2078  ram np.ndarray x
+000237e0: 3a20 3144 2061 7272 6179 2072 6570 7265  : 1D array repre
+000237f0: 7365 6e74 696e 6720 7468 6520 6c61 6265  senting the labe
+00023800: 6c73 206f 6620 7468 6520 6669 7273 7420  ls of the first 
+00023810: 6d6f 6465 6c2e 0a20 2020 2020 2020 203a  model..        :
+00023820: 7061 7261 6d20 6e70 2e6e 6461 7272 6179  param np.ndarray
+00023830: 2079 3a20 3144 2061 7272 6179 2072 6570   y: 1D array rep
+00023840: 7265 7365 6e74 696e 6720 7468 6520 6c61  resenting the la
+00023850: 6265 6c73 206f 6620 7468 6520 7365 636f  bels of the seco
+00023860: 6e64 206d 6f64 656c 2e0a 2020 2020 2020  nd model..      
+00023870: 2020 3a72 6574 7572 6e20 666c 6f61 743a    :return float:
+00023880: 2031 2069 6e64 6963 6174 6573 2070 6572   1 indicates per
+00023890: 6665 6374 2063 6c75 7374 6572 696e 6720  fect clustering 
+000238a0: 6167 7265 656d 656e 742c 2030 2069 6e64  agreement, 0 ind
+000238b0: 6963 6174 6573 2072 616e 646f 6d20 636c  icates random cl
+000238c0: 7573 7465 7269 6e67 2c20 616e 6420 6e65  ustering, and ne
+000238d0: 6761 7469 7665 2076 616c 7565 7320 696e  gative values in
+000238e0: 6469 6361 7465 2064 6973 6167 7265 656d  dicate disagreem
+000238f0: 656e 7420 6265 7477 6565 6e20 7468 6520  ent between the 
+00023900: 636c 7573 7465 7269 6e67 732e 0a0a 2020  clusterings...  
+00023910: 2020 2020 2020 3a65 7861 6d70 6c65 3a0a        :example:.
+00023920: 2020 2020 2020 2020 3e3e 3e20 7820 3d20          >>> x = 
+00023930: 6e70 2e61 7272 6179 285b 302c 2030 2c20  np.array([0, 0, 
+00023940: 302c 2030 2c20 305d 290a 2020 2020 2020  0, 0, 0]).      
+00023950: 2020 3e3e 3e20 7920 3d20 6e70 2e61 7272    >>> y = np.arr
+00023960: 6179 285b 312c 2031 2c20 312c 2031 2c20  ay([1, 1, 1, 1, 
+00023970: 315d 290a 2020 2020 2020 2020 3e3e 3e20  1]).        >>> 
+00023980: 5374 6174 6973 7469 6373 2e61 646a 7573  Statistics.adjus
+00023990: 7465 645f 7261 6e64 2878 3d78 2c20 793d  ted_rand(x=x, y=
+000239a0: 7929 0a20 2020 2020 2020 203e 3e3e 2031  y).        >>> 1
+000239b0: 2e30 0a20 2020 2020 2020 2022 2222 0a0a  .0.        """..
+000239c0: 2020 2020 2020 2020 6368 6563 6b5f 7661          check_va
+000239d0: 6c69 645f 6172 7261 7928 0a20 2020 2020  lid_array(.     
+000239e0: 2020 2020 2020 2064 6174 613d 782c 0a20         data=x,. 
+000239f0: 2020 2020 2020 2020 2020 2073 6f75 7263             sourc
+00023a00: 653d 5374 6174 6973 7469 6373 2e61 646a  e=Statistics.adj
+00023a10: 7573 7465 645f 7261 6e64 2e5f 5f6e 616d  usted_rand.__nam
+00023a20: 655f 5f2c 0a20 2020 2020 2020 2020 2020  e__,.           
+00023a30: 2061 6363 6570 7465 645f 6e64 696d 733d   accepted_ndims=
+00023a40: 2831 2c29 2c0a 2020 2020 2020 2020 2020  (1,),.          
+00023a50: 2020 6163 6365 7074 6564 5f64 7479 7065    accepted_dtype
+00023a60: 733d 286e 702e 696e 7436 342c 206e 702e  s=(np.int64, np.
+00023a70: 696e 7433 322c 2069 6e74 292c 0a20 2020  int32, int),.   
+00023a80: 2020 2020 2020 2020 206d 696e 5f61 7869           min_axi
+00023a90: 735f 303d 312c 0a20 2020 2020 2020 2029  s_0=1,.        )
+00023aa0: 0a20 2020 2020 2020 2063 6865 636b 5f76  .        check_v
+00023ab0: 616c 6964 5f61 7272 6179 280a 2020 2020  alid_array(.    
+00023ac0: 2020 2020 2020 2020 6461 7461 3d79 2c0a          data=y,.
+00023ad0: 2020 2020 2020 2020 2020 2020 736f 7572              sour
+00023ae0: 6365 3d53 7461 7469 7374 6963 732e 6164  ce=Statistics.ad
+00023af0: 6a75 7374 6564 5f72 616e 642e 5f5f 6e61  justed_rand.__na
+00023b00: 6d65 5f5f 2c0a 2020 2020 2020 2020 2020  me__,.          
+00023b10: 2020 6163 6365 7074 6564 5f6e 6469 6d73    accepted_ndims
+00023b20: 3d28 312c 292c 0a20 2020 2020 2020 2020  =(1,),.         
+00023b30: 2020 2061 6363 6570 7465 645f 6474 7970     accepted_dtyp
+00023b40: 6573 3d28 6e70 2e69 6e74 3634 2c20 6e70  es=(np.int64, np
+00023b50: 2e69 6e74 3332 2c20 696e 7429 2c0a 2020  .int32, int),.  
+00023b60: 2020 2020 2020 2020 2020 6163 6365 7074            accept
+00023b70: 6564 5f73 6861 7065 733d 5b28 782e 7368  ed_shapes=[(x.sh
+00023b80: 6170 655b 305d 2c29 5d2c 0a20 2020 2020  ape[0],)],.     
+00023b90: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
+00023ba0: 7572 6e20 6164 6a75 7374 6564 5f72 616e  urn adjusted_ran
+00023bb0: 645f 7363 6f72 6528 6c61 6265 6c73 5f74  d_score(labels_t
+00023bc0: 7275 653d 782c 206c 6162 656c 735f 7072  rue=x, labels_pr
+00023bd0: 6564 3d79 290a 0a20 2020 2040 7374 6174  ed=y)..    @stat
+00023be0: 6963 6d65 7468 6f64 0a20 2020 2064 6566  icmethod.    def
+00023bf0: 2066 6f77 6c6b 6573 5f6d 616c 6c6f 7773   fowlkes_mallows
+00023c00: 2878 3a20 6e70 2e6e 6461 7272 6179 2c20  (x: np.ndarray, 
+00023c10: 793a 206e 702e 6e64 6172 7261 7929 202d  y: np.ndarray) -
+00023c20: 3e20 666c 6f61 743a 0a20 2020 2020 2020  > float:.       
+00023c30: 2022 2222 0a20 2020 2020 2020 2043 616c   """.        Cal
+00023c40: 6375 6c61 7465 2074 6865 2046 6f77 6c6b  culate the Fowlk
+00023c50: 6573 2d4d 616c 6c6f 7773 2049 6e64 6578  es-Mallows Index
+00023c60: 2028 464d 4929 2062 6574 7765 656e 2074   (FMI) between t
+00023c70: 776f 2063 6c75 7374 6572 696e 6773 2e0a  wo clusterings..
+00023c80: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00023c90: 6e70 2e6e 6461 7272 6179 2078 3a20 3144  np.ndarray x: 1D
+00023ca0: 2061 7272 6179 2072 6570 7265 7365 6e74   array represent
+00023cb0: 696e 6720 7468 6520 6c61 6265 6c73 206f  ing the labels o
+00023cc0: 6620 7468 6520 6669 7273 7420 6d6f 6465  f the first mode
+00023cd0: 6c2e 0a20 2020 2020 2020 203a 7061 7261  l..        :para
+00023ce0: 6d20 6e70 2e6e 6461 7272 6179 2079 3a20  m np.ndarray y: 
+00023cf0: 3144 2061 7272 6179 2072 6570 7265 7365  1D array represe
+00023d00: 6e74 696e 6720 7468 6520 6c61 6265 6c73  nting the labels
+00023d10: 206f 6620 7468 6520 7365 636f 6e64 206d   of the second m
+00023d20: 6f64 656c 2e0a 2020 2020 2020 2020 3a72  odel..        :r
+00023d30: 6574 7572 6e20 666c 6f61 743a 2053 636f  eturn float: Sco
+00023d40: 7265 2062 6574 7765 656e 2030 2061 6e64  re between 0 and
+00023d50: 2031 2e20 3120 696e 6469 6361 7465 7320   1. 1 indicates 
+00023d60: 7065 7266 6563 7420 636c 7573 7465 7269  perfect clusteri
+00023d70: 6e67 2061 6772 6565 6d65 6e74 2c20 3020  ng agreement, 0 
+00023d80: 696e 6469 6361 7465 7320 7261 6e64 6f6d  indicates random
+00023d90: 2063 6c75 7374 6572 696e 672e 0a20 2020   clustering..   
+00023da0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00023db0: 2063 6865 636b 5f76 616c 6964 5f61 7272   check_valid_arr
+00023dc0: 6179 280a 2020 2020 2020 2020 2020 2020  ay(.            
+00023dd0: 6461 7461 3d78 2c0a 2020 2020 2020 2020  data=x,.        
+00023de0: 2020 2020 736f 7572 6365 3d53 7461 7469      source=Stati
+00023df0: 7374 6963 732e 666f 776c 6b65 735f 6d61  stics.fowlkes_ma
+00023e00: 6c6c 6f77 732e 5f5f 6e61 6d65 5f5f 2c0a  llows.__name__,.
+00023e10: 2020 2020 2020 2020 2020 2020 6163 6365              acce
+00023e20: 7074 6564 5f6e 6469 6d73 3d28 312c 292c  pted_ndims=(1,),
+00023e30: 0a20 2020 2020 2020 2020 2020 2061 6363  .            acc
+00023e40: 6570 7465 645f 6474 7970 6573 3d28 6e70  epted_dtypes=(np
+00023e50: 2e69 6e74 3634 2c20 6e70 2e69 6e74 3332  .int64, np.int32
+00023e60: 2c20 696e 7429 2c0a 2020 2020 2020 2020  , int),.        
+00023e70: 2020 2020 6d69 6e5f 6178 6973 5f30 3d31      min_axis_0=1
+00023e80: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+00023e90: 2020 2020 6368 6563 6b5f 7661 6c69 645f      check_valid_
+00023ea0: 6172 7261 7928 0a20 2020 2020 2020 2020  array(.         
+00023eb0: 2020 2064 6174 613d 792c 0a20 2020 2020     data=y,.     
+00023ec0: 2020 2020 2020 2073 6f75 7263 653d 5374         source=St
+00023ed0: 6174 6973 7469 6373 2e66 6f77 6c6b 6573  atistics.fowlkes
+00023ee0: 5f6d 616c 6c6f 7773 2e5f 5f6e 616d 655f  _mallows.__name_
+00023ef0: 5f2c 0a20 2020 2020 2020 2020 2020 2061  _,.            a
+00023f00: 6363 6570 7465 645f 6e64 696d 733d 2831  ccepted_ndims=(1
+00023f10: 2c29 2c0a 2020 2020 2020 2020 2020 2020  ,),.            
+00023f20: 6163 6365 7074 6564 5f64 7479 7065 733d  accepted_dtypes=
+00023f30: 286e 702e 696e 7436 342c 206e 702e 696e  (np.int64, np.in
+00023f40: 7433 322c 2069 6e74 292c 0a20 2020 2020  t32, int),.     
+00023f50: 2020 2020 2020 2061 6363 6570 7465 645f         accepted_
+00023f60: 7368 6170 6573 3d5b 2878 2e73 6861 7065  shapes=[(x.shape
+00023f70: 5b30 5d2c 295d 2c0a 2020 2020 2020 2020  [0],)],.        
+00023f80: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00023f90: 2066 6f77 6c6b 6573 5f6d 616c 6c6f 7773   fowlkes_mallows
+00023fa0: 5f73 636f 7265 286c 6162 656c 735f 7472  _score(labels_tr
+00023fb0: 7565 3d78 2c20 6c61 6265 6c73 5f70 7265  ue=x, labels_pre
+00023fc0: 643d 7929 0a0a 2020 2020 4073 7461 7469  d=y)..    @stati
+00023fd0: 636d 6574 686f 640a 2020 2020 6465 6620  cmethod.    def 
+00023fe0: 6164 6a75 7374 6564 5f6d 7574 7561 6c5f  adjusted_mutual_
+00023ff0: 696e 666f 2878 3a20 6e70 2e6e 6461 7272  info(x: np.ndarr
+00024000: 6179 2c20 793a 206e 702e 6e64 6172 7261  ay, y: np.ndarra
+00024010: 7929 202d 3e20 666c 6f61 743a 0a20 2020  y) -> float:.   
+00024020: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00024030: 2043 616c 6375 6c61 7465 2074 6865 2041   Calculate the A
+00024040: 646a 7573 7465 6420 4d75 7475 616c 2049  djusted Mutual I
+00024050: 6e66 6f72 6d61 7469 6f6e 2028 414d 4929  nformation (AMI)
+00024060: 2062 6574 7765 656e 2074 776f 2063 6c75   between two clu
+00024070: 7374 6572 696e 6773 2061 7320 6120 6d65  sterings as a me
+00024080: 6173 7375 7265 206f 6620 7369 6d69 6c61  assure of simila
+00024090: 7269 7479 2e0a 2020 2020 2020 2020 636c  rity..        cl
+000240a0: 7573 7465 7269 6e67 732e 0a0a 2020 2020  usterings...    
+000240b0: 2020 2020 3a70 6172 616d 206e 702e 6e64      :param np.nd
+000240c0: 6172 7261 7920 783a 2031 4420 6172 7261  array x: 1D arra
+000240d0: 7920 7265 7072 6573 656e 7469 6e67 2074  y representing t
+000240e0: 6865 206c 6162 656c 7320 6f66 2074 6865  he labels of the
+000240f0: 2066 6972 7374 206d 6f64 656c 2e0a 2020   first model..  
+00024100: 2020 2020 2020 3a70 6172 616d 206e 702e        :param np.
+00024110: 6e64 6172 7261 7920 793a 2031 4420 6172  ndarray y: 1D ar
+00024120: 7261 7920 7265 7072 6573 656e 7469 6e67  ray representing
+00024130: 2074 6865 206c 6162 656c 7320 6f66 2074   the labels of t
+00024140: 6865 2073 6563 6f6e 6420 6d6f 6465 6c2e  he second model.
+00024150: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+00024160: 2066 6c6f 6174 3a20 5363 6f72 6520 6265   float: Score be
+00024170: 7477 6565 6e20 3020 616e 6420 312c 2077  tween 0 and 1, w
+00024180: 6865 7265 2031 2069 6e64 6963 6174 6573  here 1 indicates
+00024190: 2070 6572 6665 6374 2063 6c75 7374 6572   perfect cluster
+000241a0: 696e 6720 6167 7265 656d 656e 742e 0a0a  ing agreement...
+000241b0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000241c0: 2020 2020 6368 6563 6b5f 7661 6c69 645f      check_valid_
+000241d0: 6172 7261 7928 0a20 2020 2020 2020 2020  array(.         
+000241e0: 2020 2064 6174 613d 782c 0a20 2020 2020     data=x,.     
+000241f0: 2020 2020 2020 2073 6f75 7263 653d 5374         source=St
+00024200: 6174 6973 7469 6373 2e61 646a 7573 7465  atistics.adjuste
+00024210: 645f 6d75 7475 616c 5f69 6e66 6f2e 5f5f  d_mutual_info.__
+00024220: 6e61 6d65 5f5f 2c0a 2020 2020 2020 2020  name__,.        
+00024230: 2020 2020 6163 6365 7074 6564 5f6e 6469      accepted_ndi
+00024240: 6d73 3d28 312c 292c 0a20 2020 2020 2020  ms=(1,),.       
+00024250: 2020 2020 2061 6363 6570 7465 645f 6474       accepted_dt
+00024260: 7970 6573 3d28 6e70 2e69 6e74 3634 2c20  ypes=(np.int64, 
+00024270: 6e70 2e69 6e74 3332 2c20 696e 7429 2c0a  np.int32, int),.
+00024280: 2020 2020 2020 2020 2020 2020 6d69 6e5f              min_
+00024290: 6178 6973 5f30 3d31 2c0a 2020 2020 2020  axis_0=1,.      
+000242a0: 2020 290a 2020 2020 2020 2020 6368 6563    ).        chec
+000242b0: 6b5f 7661 6c69 645f 6172 7261 7928 0a20  k_valid_array(. 
+000242c0: 2020 2020 2020 2020 2020 2064 6174 613d             data=
+000242d0: 792c 0a20 2020 2020 2020 2020 2020 2073  y,.            s
+000242e0: 6f75 7263 653d 5374 6174 6973 7469 6373  ource=Statistics
+000242f0: 2e61 646a 7573 7465 645f 6d75 7475 616c  .adjusted_mutual
+00024300: 5f69 6e66 6f2e 5f5f 6e61 6d65 5f5f 2c0a  _info.__name__,.
+00024310: 2020 2020 2020 2020 2020 2020 6163 6365              acce
+00024320: 7074 6564 5f6e 6469 6d73 3d28 312c 292c  pted_ndims=(1,),
+00024330: 0a20 2020 2020 2020 2020 2020 2061 6363  .            acc
+00024340: 6570 7465 645f 6474 7970 6573 3d28 6e70  epted_dtypes=(np
+00024350: 2e69 6e74 3634 2c20 6e70 2e69 6e74 3332  .int64, np.int32
+00024360: 2c20 696e 7429 2c0a 2020 2020 2020 2020  , int),.        
+00024370: 2020 2020 6163 6365 7074 6564 5f73 6861      accepted_sha
+00024380: 7065 733d 5b28 782e 7368 6170 655b 305d  pes=[(x.shape[0]
+00024390: 2c29 5d2c 0a20 2020 2020 2020 2029 0a20  ,)],.        ). 
+000243a0: 2020 2020 2020 2072 6574 7572 6e20 6164         return ad
+000243b0: 6a75 7374 6564 5f6d 7574 7561 6c5f 696e  justed_mutual_in
+000243c0: 666f 5f73 636f 7265 286c 6162 656c 735f  fo_score(labels_
+000243d0: 7472 7565 3d78 2c20 6c61 6265 6c73 5f70  true=x, labels_p
+000243e0: 7265 643d 7929 0a0a 0a23 2073 616d 706c  red=y)...# sampl
+000243f0: 655f 3120 3d20 6e70 2e72 616e 646f 6d2e  e_1 = np.random.
+00024400: 7261 6e64 6f6d 5f69 6e74 6567 6572 7328  random_integers(
+00024410: 6c6f 773d 312c 2068 6967 683d 322c 2073  low=1, high=2, s
+00024420: 697a 653d 2831 302c 2035 3029 292e 6173  ize=(10, 50)).as
+00024430: 7479 7065 286e 702e 666c 6f61 7436 3429  type(np.float64)
+00024440: 0a23 2073 616d 706c 655f 3220 3d20 6e70  .# sample_2 = np
+00024450: 2e72 616e 646f 6d2e 7261 6e64 6f6d 5f69  .random.random_i
+00024460: 6e74 6567 6572 7328 6c6f 773d 372c 2068  ntegers(low=7, h
+00024470: 6967 683d 3230 2c20 7369 7a65 3d28 3130  igh=20, size=(10
+00024480: 2c20 3530 2929 2e61 7374 7970 6528 6e70  , 50)).astype(np
+00024490: 2e66 6c6f 6174 3634 290a 2320 6461 7461  .float64).# data
+000244a0: 203d 206e 702e 7673 7461 636b 285b 7361   = np.vstack([sa
+000244b0: 6d70 6c65 5f31 2c20 7361 6d70 6c65 5f32  mple_1, sample_2
+000244c0: 5d29 0a23 2053 7461 7469 7374 6963 7328  ]).# Statistics(
+000244d0: 292e 6862 6f73 2864 6174 613d 6461 7461  ).hbos(data=data
+000244e0: 290a 0a23 2073 616d 706c 655f 3120 3d20  )..# sample_1 = 
+000244f0: 6e70 2e72 616e 646f 6d2e 6e6f 726d 616c  np.random.normal
+00024500: 286c 6f63 3d31 302c 2073 6361 6c65 3d32  (loc=10, scale=2
+00024510: 2c20 7369 7a65 3d31 3030 3029 2e61 7374  , size=1000).ast
+00024520: 7970 6528 6e70 2e66 6c6f 6174 3634 290a  ype(np.float64).
+00024530: 2320 7361 6d70 6c65 5f32 203d 206e 702e  # sample_2 = np.
+00024540: 7261 6e64 6f6d 2e6e 6f72 6d61 6c28 6c6f  random.normal(lo
+00024550: 633d 3132 2c20 7363 616c 653d 322c 2073  c=12, scale=2, s
+00024560: 697a 653d 3130 3030 3029 2e61 7374 7970  ize=10000).astyp
+00024570: 6528 6e70 2e66 6c6f 6174 3634 290a 0a23  e(np.float64)..#
+00024580: 2073 616d 706c 655f 3120 3d20 6e70 2e72   sample_1 = np.r
+00024590: 616e 646f 6d2e 7261 6e64 696e 7428 302c  andom.randint(0,
+000245a0: 2031 3030 2c20 2831 3030 2c20 2929 2e61   100, (100, )).a
+000245b0: 7374 7970 6528 6e70 2e66 6c6f 6174 3634  stype(np.float64
+000245c0: 290a 2320 7361 6d70 6c65 5f32 203d 206e  ).# sample_2 = n
+000245d0: 702e 7261 6e64 6f6d 2e72 616e 6469 6e74  p.random.randint
+000245e0: 2831 3130 2c20 3230 302c 2028 3130 302c  (110, 200, (100,
+000245f0: 2029 292e 6173 7479 7065 286e 702e 666c   )).astype(np.fl
+00024600: 6f61 7436 3429 0a23 0a23 2053 7461 7469  oat64).#.# Stati
+00024610: 7374 6963 7328 292e 6a65 6e73 656e 5f73  stics().jensen_s
+00024620: 6861 6e6e 6f6e 5f64 6976 6572 6765 6e63  hannon_divergenc
+00024630: 6528 7361 6d70 6c65 5f31 3d73 616d 706c  e(sample_1=sampl
+00024640: 655f 312c 2073 616d 706c 655f 323d 7361  e_1, sample_2=sa
+00024650: 6d70 6c65 5f32 290a                      mple_2).
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/mixins/feature_extraction_mixin.py` & `Simba-UW-tf-dev-1.89.5/simba/mixins/feature_extraction_mixin.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/mixins/plotting_mixin.py` & `Simba-UW-tf-dev-1.89.5/simba/mixins/plotting_mixin.py`

 * *Files 3% similar despite different names*

```diff
@@ -10,18 +10,21 @@
 import cv2
 import imutils
 import matplotlib
 import matplotlib.pyplot as plt
 import numpy as np
 import pandas as pd
 import PIL
+import plotly.graph_objs as go
+import plotly.io as pio
 import seaborn as sns
 from matplotlib import cm
 from matplotlib.backends.backend_agg import FigureCanvasAgg as FigureCanvas
 from numba import njit
+from PIL import Image
 
 try:
     from typing import Literal
 except:
     from typing_extensions import Literal
 
 import simba
@@ -1790,14 +1793,15 @@
     def continuous_scatter(
         data: Union[np.ndarray, pd.DataFrame],
         columns: Optional[List[str]] = ("X", "Y", "Cluster"),
         palette: Optional[str] = "magma",
         show_box: Optional[bool] = False,
         size: Optional[int] = 10,
         title: Optional[str] = None,
+        bg_clr: Optional[str] = None,
         save_path: Optional[Union[str, os.PathLike]] = None,
     ):
         """Create a 2D scatterplot with a continuous legend"""
 
         check_instance(
             source=f"{PlottingMixin.continuous_scatter.__name__} data",
             instance=data,
@@ -1817,14 +1821,21 @@
                 accepted_ndims=(2,),
                 max_axis_1=len(columns),
                 min_axis_1=len(columns),
             )
             data = pd.DataFrame(data, columns=list(columns))
 
         fig, ax = plt.subplots()
+        if bg_clr is not None:
+            if bg_clr not in get_named_colors():
+                raise InvalidInputError(
+                    msg=f"bg_clr {bg_clr} is not a valid named color. Options: {get_named_colors()}",
+                    source=PlottingMixin.continuous_scatter.__name__,
+                )
+            fig.set_facecolor(bg_clr)
         if not show_box:
             plt.axis("off")
         plt.xlabel(columns[0])
         plt.ylabel(columns[1])
         plot = ax.scatter(
             data[columns[0]], data[columns[1]], c=data[columns[2]], s=size, cmap=palette
         )
@@ -2041,7 +2052,213 @@
                 name=f"{PlottingMixin.line_plot.__name__} save_path", value=save_path
             )
             check_if_dir_exists(in_dir=os.path.dirname(save_path))
             plot.figure.savefig(save_path)
             plt.close("all")
         else:
             return plot
+
+    @staticmethod
+    def make_line_plot(
+        data: List[np.ndarray],
+        colors: List[str],
+        show_box: Optional[bool] = True,
+        width: Optional[int] = 640,
+        height: Optional[int] = 480,
+        line_width: Optional[int] = 6,
+        font_size: Optional[int] = 8,
+        bg_clr: Optional[str] = None,
+        x_lbl_divisor: Optional[float] = None,
+        title: Optional[str] = None,
+        y_lbl: Optional[str] = None,
+        x_lbl: Optional[str] = None,
+        y_max: Optional[int] = -1,
+        line_opacity: Optional[int] = 0.0,
+        save_path: Optional[Union[str, os.PathLike]] = None,
+    ):
+
+        check_valid_lst(
+            data=data,
+            source=PlottingMixin.make_line_plot.__name__,
+            valid_dtypes=(
+                np.ndarray,
+                list,
+            ),
+        )
+        check_valid_lst(
+            data=colors,
+            source=PlottingMixin.make_line_plot.__name__,
+            valid_dtypes=(str,),
+            exact_len=len(data),
+        )
+        clr_dict = get_color_dict()
+        matplotlib.font_manager._get_font.cache_clear()
+        plt.close("all")
+        fig, ax = plt.subplots()
+        if bg_clr is not None:
+            fig.set_facecolor(bg_clr)
+        if not show_box:
+            plt.axis("off")
+        for i in range(len(data)):
+            line_clr = clr_dict[colors[i]][::-1]
+            line_clr = tuple(x / 255 for x in line_clr)
+            flat_data = data[i].flatten()
+            plt.plot(
+                flat_data, color=line_clr, linewidth=line_width, alpha=line_opacity
+            )
+        max_x = max([len(x) for x in data])
+        if y_max == -1:
+            y_max = max([np.max(x) for x in data])
+        y_ticks_locs = y_lbls = np.round(np.linspace(0, y_max, 10), 2)
+        x_ticks_locs = x_lbls = np.linspace(0, max_x, 5)
+        if x_lbl_divisor is not None:
+            x_lbls = np.round((x_lbls / x_lbl_divisor), 1)
+        if y_lbl is not None:
+            plt.ylabel(y_lbl)
+        if x_lbl is not None:
+            plt.xlabel(x_lbl)
+        plt.xticks(x_ticks_locs, x_lbls, rotation="horizontal", fontsize=font_size)
+        plt.yticks(y_ticks_locs, y_lbls, fontsize=font_size)
+        plt.ylim(0, y_max)
+        if title is not None:
+            plt.suptitle(title, x=0.5, y=0.92, fontsize=font_size + 4)
+        buffer_ = io.BytesIO()
+        plt.savefig(buffer_, format="png")
+        buffer_.seek(0)
+        img = PIL.Image.open(buffer_)
+        img = np.uint8(cv2.cvtColor(np.asarray(img), cv2.COLOR_RGB2BGR))
+        buffer_.close()
+        plt.close()
+        img = cv2.resize(img, (width, height))
+        if save_path is not None:
+            cv2.imwrite(save_path, img)
+            stdout_success(msg=f"Line plot saved at {save_path}")
+        else:
+            return img
+
+    @staticmethod
+    def make_line_plot_plotly(
+        data: List[np.ndarray],
+        colors: List[str],
+        show_box: Optional[bool] = True,
+        show_grid: Optional[bool] = False,
+        width: Optional[int] = 640,
+        height: Optional[int] = 480,
+        line_width: Optional[int] = 6,
+        font_size: Optional[int] = 8,
+        bg_clr: Optional[str] = "white",
+        x_lbl_divisor: Optional[float] = None,
+        title: Optional[str] = None,
+        y_lbl: Optional[str] = None,
+        x_lbl: Optional[str] = None,
+        y_max: Optional[int] = -1,
+        line_opacity: Optional[int] = 0.5,
+        save_path: Optional[Union[str, os.PathLike]] = None,
+    ):
+        """
+        Create a line plot using Plotly.
+
+        .. note::
+           Plotly can be more reliable than matplotlib on some systems when accessed through multprocessing calls.
+
+           If **not** called though multiprocessing, consider using ``simba.mixins.plotting_mixin.PlottingMixin.make_line_plot()``
+
+           Uses ``kaleido`` for transform image to numpy array or save to disk.
+
+        :param List[np.ndarray] data: List of 1D numpy arrays representing lines.
+        :param List[str] colors: List of named colors of size len(data).
+        :param bool show_box: Whether to show the plot box (axes, title, etc.).
+        :param bool show_grid: Whether to show gridlines on the plot.
+        :param int width: Width of the plot in pixels.
+        :param int height: Height of the plot in pixels.
+        :param int line_width: Width of the lines in the plot.
+        :param int font_size: Font size for axis labels and tick labels.
+        :param str bg_clr: Background color of the plot.
+        :param float x_lbl_divisor: Divisor for adjusting the tick spacing on the x-axis.
+        :param str title: Title of the plot.
+        :param str y_lbl: Label for the y-axis.
+        :param str x_lbl: Label for the x-axis.
+        :param int y_max: Maximum value for the y-axis.
+        :param float line_opacity: Opacity of the lines in the plot.
+        :param Union[str, os.PathLike] save_path: Path to save the plot image. If None, returns a numpy array of the plot.
+        :return: If save_path is None, returns a numpy array representing the plot image.
+
+        :example:
+        >>> p = np.random.randint(0, 50, (100,))
+        >>> y = np.random.randint(0, 50, (200,))
+        >>> img = PlottingMixin.make_line_plot_plotly(data=[p, y], show_box=False, font_size=20, bg_clr='white', show_grid=False, x_lbl_divisor=30, colors=['Red', 'Green'], save_path='/Users/simon/Desktop/envs/simba/troubleshooting/beepboop174/project_folder/frames/output/line_plot/Trial     3_final_img.png')
+        """
+
+        def tick_formatter(x):
+            if x_lbl_divisor is not None:
+                return str(round(x / x_lbl_divisor, 2))
+            else:
+                return str(x)
+
+        fig = go.Figure()
+        clr_dict = get_color_dict()
+        if y_max == -1:
+            y_max = max([np.max(i) for i in data])
+        for i in range(len(data)):
+            line_clr = clr_dict[colors[i]]
+            line_clr = (
+                f"rgba({line_clr[0]}, {line_clr[1]}, {line_clr[2]}, {line_opacity})"
+            )
+            fig.add_trace(
+                go.Scatter(
+                    y=data[i].flatten(),
+                    mode="lines",
+                    line=dict(color=line_clr, width=line_width),
+                )
+            )
+
+        if not show_box:
+            fig.update_layout(
+                width=width,
+                height=height,
+                title=title,
+                xaxis_visible=False,
+                yaxis_visible=False,
+                showlegend=False,
+            )
+        else:
+            if fig["layout"]["xaxis"]["tickvals"] is None:
+                tickvals = [i for i in range(data[0].shape[0])]
+            else:
+                tickvals = fig["layout"]["xaxis"]["tickvals"]
+            if x_lbl_divisor is not None:
+                ticktext = [tick_formatter(x) for x in tickvals]
+            else:
+                ticktext = tickvals
+            fig.update_layout(
+                width=width,
+                height=height,
+                title=title,
+                xaxis=dict(
+                    title=x_lbl,
+                    tickvals=tickvals,
+                    ticktext=ticktext,
+                    tickmode="auto",
+                    tick0=0,
+                    dtick=10,
+                    tickfont=dict(size=font_size),
+                    showgrid=show_grid,
+                ),
+                yaxis=dict(
+                    title=y_lbl,
+                    tickfont=dict(size=font_size),
+                    range=[0, y_max],
+                    showgrid=show_grid,
+                ),
+                showlegend=False,
+            )
+
+        if bg_clr is not None:
+            fig.update_layout(plot_bgcolor=bg_clr)
+        if save_path is not None:
+            pio.write_image(fig, save_path)
+            stdout_success(msg=f"Line plot saved at {save_path}")
+        else:
+            img_bytes = fig.to_image(format="png")
+            img = PIL.Image.open(io.BytesIO(img_bytes))
+            fig = None
+            return np.array(img).astype(np.uint8)
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/mixins/image_mixin.py` & `Simba-UW-tf-dev-1.89.5/simba/mixins/image_mixin.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/mixins/unsupervised_mixin.py` & `Simba-UW-tf-dev-1.89.5/simba/mixins/unsupervised_mixin.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/mixins/train_model_mixin.py` & `Simba-UW-tf-dev-1.89.5/simba/mixins/train_model_mixin.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/mixins/geometry_mixin.py` & `Simba-UW-tf-dev-1.89.5/simba/mixins/geometry_mixin.py`

 * *Files 0% similar despite different names*

```diff
@@ -7862,2530 +7862,2516 @@
 0001eb50: 2e0a 0a20 2020 2020 2020 203a 6578 616d  ...        :exam
 0001eb60: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
 0001eb70: 2073 6861 7065 7320 3d20 4765 6f6d 6574   shapes = Geomet
 0001eb80: 7279 4d69 7869 6e28 292e 6164 6a75 7374  ryMixin().adjust
 0001eb90: 5f67 656f 6d65 7472 6965 7328 6765 6f6d  _geometries(geom
 0001eba0: 6574 7269 6573 3d73 6861 7065 732c 2073  etries=shapes, s
 0001ebb0: 6869 6674 3d28 302c 2033 3333 2929 0a20  hift=(0, 333)). 
-0001ebc0: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-0001ebd0: 2020 2020 6368 6563 6b5f 696e 7374 616e      check_instan
-0001ebe0: 6365 280a 2020 2020 2020 2020 2020 2020  ce(.            
-0001ebf0: 736f 7572 6365 3d66 227b 4765 6f6d 6574  source=f"{Geomet
-0001ec00: 7279 4d69 7869 6e28 292e 6164 6a75 7374  ryMixin().adjust
-0001ec10: 5f67 656f 6d65 7472 6965 732e 5f5f 6e61  _geometries.__na
-0001ec20: 6d65 5f5f 7d20 6765 6f6d 6574 7269 6573  me__} geometries
-0001ec30: 222c 0a20 2020 2020 2020 2020 2020 2069  ",.            i
-0001ec40: 6e73 7461 6e63 653d 6765 6f6d 6574 7269  nstance=geometri
-0001ec50: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
-0001ec60: 6163 6365 7074 6564 5f74 7970 6573 3d6c  accepted_types=l
-0001ec70: 6973 742c 0a20 2020 2020 2020 2029 0a20  ist,.        ). 
-0001ec80: 2020 2020 2020 2069 6620 6c65 6e28 6765         if len(ge
-0001ec90: 6f6d 6574 7269 6573 2920 3d3d 2030 3a0a  ometries) == 0:.
-0001eca0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0001ecb0: 6520 436f 756e 7445 7272 6f72 280a 2020  e CountError(.  
-0001ecc0: 2020 2020 2020 2020 2020 2020 2020 6d73                ms
-0001ecd0: 673d 2247 656f 6d65 7472 7920 6c69 7374  g="Geometry list
-0001ece0: 2069 7320 656d 7074 7922 2c0a 2020 2020   is empty",.    
-0001ecf0: 2020 2020 2020 2020 2020 2020 736f 7572              sour
-0001ed00: 6365 3d47 656f 6d65 7472 794d 6978 696e  ce=GeometryMixin
-0001ed10: 2829 2e61 646a 7573 745f 6765 6f6d 6574  ().adjust_geomet
-0001ed20: 7269 6573 2e5f 5f6e 616d 655f 5f2c 0a20  ries.__name__,. 
-0001ed30: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0001ed40: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
-0001ed50: 6e67 6528 6c65 6e28 6765 6f6d 6574 7269  nge(len(geometri
-0001ed60: 6573 2929 3a0a 2020 2020 2020 2020 2020  es)):.          
-0001ed70: 2020 6368 6563 6b5f 696e 7374 616e 6365    check_instance
-0001ed80: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0001ed90: 2020 736f 7572 6365 3d66 227b 4765 6f6d    source=f"{Geom
-0001eda0: 6574 7279 4d69 7869 6e28 292e 6164 6a75  etryMixin().adju
-0001edb0: 7374 5f67 656f 6d65 7472 6965 732e 5f5f  st_geometries.__
-0001edc0: 6e61 6d65 5f5f 7d20 6765 6f6d 6574 7269  name__} geometri
-0001edd0: 6573 207b 697d 222c 0a20 2020 2020 2020  es {i}",.       
-0001ede0: 2020 2020 2020 2020 2069 6e73 7461 6e63           instanc
-0001edf0: 653d 6765 6f6d 6574 7269 6573 5b69 5d2c  e=geometries[i],
-0001ee00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ee10: 2061 6363 6570 7465 645f 7479 7065 733d   accepted_types=
-0001ee20: 506f 6c79 676f 6e2c 0a20 2020 2020 2020  Polygon,.       
-0001ee30: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
-0001ee40: 6573 756c 7473 203d 205b 5d0a 2020 2020  esults = [].    
-0001ee50: 2020 2020 666f 7220 7368 6170 655f 636e      for shape_cn
-0001ee60: 742c 2073 6861 7065 2069 6e20 656e 756d  t, shape in enum
-0001ee70: 6572 6174 6528 6765 6f6d 6574 7269 6573  erate(geometries
-0001ee80: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-0001ee90: 6573 756c 7473 2e61 7070 656e 6428 0a20  esults.append(. 
-0001eea0: 2020 2020 2020 2020 2020 2020 2020 2050                 P
-0001eeb0: 6f6c 7967 6f6e 280a 2020 2020 2020 2020  olygon(.        
-0001eec0: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
-0001eed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001eee0: 2020 2020 2020 2869 6e74 2861 6273 2878        (int(abs(x
-0001eef0: 202b 2073 6869 6674 5b30 5d29 292c 2069   + shift[0])), i
-0001ef00: 6e74 2861 6273 2879 202b 2073 6869 6674  nt(abs(y + shift
-0001ef10: 5b31 5d29 2929 0a20 2020 2020 2020 2020  [1]))).         
-0001ef20: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0001ef30: 6f72 2078 2c20 7920 696e 206c 6973 7428  or x, y in list(
-0001ef40: 7368 6170 652e 6578 7465 7269 6f72 2e63  shape.exterior.c
-0001ef50: 6f6f 7264 7329 0a20 2020 2020 2020 2020  oords).         
-0001ef60: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
-0001ef70: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-0001ef80: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0001ef90: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
-0001efa0: 6c74 730a 0a20 2020 2040 7374 6174 6963  lts..    @static
-0001efb0: 6d65 7468 6f64 0a20 2020 2064 6566 2062  method.    def b
-0001efc0: 7563 6b65 745f 696d 675f 696e 746f 5f67  ucket_img_into_g
-0001efd0: 7269 645f 706f 696e 7473 280a 2020 2020  rid_points(.    
-0001efe0: 2020 2020 706f 696e 745f 6469 7374 616e      point_distan
-0001eff0: 6365 3a20 696e 742c 0a20 2020 2020 2020  ce: int,.       
-0001f000: 2070 785f 7065 725f 6d6d 3a20 666c 6f61   px_per_mm: floa
-0001f010: 742c 0a20 2020 2020 2020 2069 6d67 5f73  t,.        img_s
-0001f020: 697a 653a 2054 7570 6c65 5b69 6e74 2c20  ize: Tuple[int, 
-0001f030: 696e 745d 2c0a 2020 2020 2020 2020 626f  int],.        bo
-0001f040: 7264 6572 5f73 6974 6573 3a20 4f70 7469  rder_sites: Opti
-0001f050: 6f6e 616c 5b62 6f6f 6c5d 203d 2054 7275  onal[bool] = Tru
-0001f060: 652c 0a20 2020 2029 202d 3e20 4469 6374  e,.    ) -> Dict
-0001f070: 5b54 7570 6c65 5b69 6e74 2c20 696e 745d  [Tuple[int, int]
-0001f080: 2c20 506f 696e 745d 3a0a 2020 2020 2020  , Point]:.      
-0001f090: 2020 2222 220a 2020 2020 2020 2020 4765    """.        Ge
-0001f0a0: 6e65 7261 7465 2061 2067 7269 6420 6f66  nerate a grid of
-0001f0b0: 2065 7665 6e6c 7920 7370 6163 6564 2070   evenly spaced p
-0001f0c0: 6f69 6e74 7320 7769 7468 696e 2061 6e20  oints within an 
-0001f0d0: 696d 6167 652e 2055 7365 2066 6f72 2063  image. Use for c
-0001f0e0: 7265 6174 696e 6720 7370 6174 6961 6c20  reating spatial 
-0001f0f0: 6d61 726b 6572 7320 7769 7468 696e 2061  markers within a
-0001f100: 6e20 6172 656e 612e 0a0a 2020 2020 2020  n arena...      
-0001f110: 2020 2e2e 2069 6d61 6765 3a3a 205f 7374    .. image:: _st
-0001f120: 6174 6963 2f69 6d67 2f62 7563 6b65 745f  atic/img/bucket_
-0001f130: 696d 675f 696e 746f 5f67 7269 645f 706f  img_into_grid_po
-0001f140: 696e 7473 2e70 6e67 0a20 2020 2020 2020  ints.png.       
-0001f150: 2020 2020 3a77 6964 7468 3a20 3530 300a      :width: 500.
-0001f160: 2020 2020 2020 2020 2020 203a 616c 6967             :alig
-0001f170: 6e3a 2063 656e 7465 720a 0a20 2020 2020  n: center..     
-0001f180: 2020 203a 7061 7261 6d20 696e 7420 706f     :param int po
-0001f190: 696e 745f 6469 7374 616e 6365 3a20 4469  int_distance: Di
-0001f1a0: 7374 616e 6365 2062 6574 7765 656e 2061  stance between a
-0001f1b0: 646a 6163 656e 7420 706f 696e 7473 2069  djacent points i
-0001f1c0: 6e20 6d69 6c6c 696d 6574 6572 732e 0a20  n millimeters.. 
-0001f1d0: 2020 2020 2020 203a 7061 7261 6d20 666c         :param fl
-0001f1e0: 6f61 7420 7078 5f70 6572 5f6d 6d3a 2050  oat px_per_mm: P
-0001f1f0: 6978 656c 7320 7065 7220 6d69 6c6c 696d  ixels per millim
-0001f200: 6574 6572 2063 6f6e 7665 7273 696f 6e20  eter conversion 
-0001f210: 6661 6374 6f72 2e0a 2020 2020 2020 2020  factor..        
-0001f220: 3a70 6172 616d 2054 7570 6c65 5b69 6e74  :param Tuple[int
-0001f230: 2c20 696e 745d 2069 6d67 5f73 697a 653a  , int] img_size:
-0001f240: 2053 697a 6520 6f66 2074 6865 2069 6d61   Size of the ima
-0001f250: 6765 2069 6e20 7069 7865 6c73 2028 7769  ge in pixels (wi
-0001f260: 6474 682c 2068 6569 6768 7429 2e0a 2020  dth, height)..  
-0001f270: 2020 2020 2020 3a70 6172 616d 204f 7074        :param Opt
-0001f280: 696f 6e61 6c5b 626f 6f6c 5d20 626f 7264  ional[bool] bord
-0001f290: 6572 5f73 6974 6573 3a20 4966 2054 7275  er_sites: If Tru
-0001f2a0: 652c 2069 6e63 6c75 6465 7320 706f 696e  e, includes poin
-0001f2b0: 7473 206f 6e20 7468 6520 626f 7264 6572  ts on the border
-0001f2c0: 206f 6620 7468 6520 696d 6167 652e 2044   of the image. D
-0001f2d0: 6566 6175 6c74 2069 7320 5472 7565 2e0a  efault is True..
-0001f2e0: 2020 2020 2020 2020 3a72 6574 7572 6e73          :returns
-0001f2f0: 2044 6963 745b 5475 706c 655b 696e 742c   Dict[Tuple[int,
-0001f300: 2069 6e74 5d2c 2050 6f69 6e74 5d3a 2044   int], Point]: D
-0001f310: 6963 7469 6f6e 6172 7920 7768 6572 6520  ictionary where 
-0001f320: 6b65 7973 2061 7265 2028 726f 772c 2063  keys are (row, c
-0001f330: 6f6c 756d 6e29 2069 6e64 6963 6573 206f  olumn) indices o
-0001f340: 6620 7468 6520 706f 696e 742c 2061 6e64  f the point, and
-0001f350: 2076 616c 7565 7320 6172 6520 5368 6170   values are Shap
-0001f360: 656c 7920 506f 696e 7420 6f62 6a65 6374  ely Point object
-0001f370: 732e 0a0a 2020 2020 2020 2020 3a65 7861  s...        :exa
-0001f380: 6d70 6c65 3a0a 2020 2020 2020 2020 3e3e  mple:.        >>
-0001f390: 3e20 706f 696e 745f 6772 6964 2870 6f69  > point_grid(poi
-0001f3a0: 6e74 5f64 6973 7461 6e63 653d 3230 2c20  nt_distance=20, 
-0001f3b0: 7078 5f70 6572 5f6d 6d3d 342c 2069 6d67  px_per_mm=4, img
-0001f3c0: 5f73 697a 653d 696d 672e 7368 6170 652c  _size=img.shape,
-0001f3d0: 2062 6f72 6465 725f 7369 7465 733d 4661   border_sites=Fa
-0001f3e0: 6c73 6529 0a20 2020 2020 2020 2022 2222  lse).        """
-0001f3f0: 0a0a 2020 2020 2020 2020 706f 696e 745f  ..        point_
-0001f400: 6469 7374 616e 6365 203d 2069 6e74 2870  distance = int(p
-0001f410: 6f69 6e74 5f64 6973 7461 6e63 6520 2a20  oint_distance * 
-0001f420: 7078 5f70 6572 5f6d 6d29 0a20 2020 2020  px_per_mm).     
-0001f430: 2020 2076 5f62 696e 5f63 6e74 2c20 685f     v_bin_cnt, h_
-0001f440: 6269 6e5f 636e 7420 3d20 6469 766d 6f64  bin_cnt = divmod
-0001f450: 2869 6d67 5f73 697a 655b 305d 2c20 706f  (img_size[0], po
-0001f460: 696e 745f 6469 7374 616e 6365 292c 2064  int_distance), d
-0001f470: 6976 6d6f 6428 0a20 2020 2020 2020 2020  ivmod(.         
-0001f480: 2020 2069 6d67 5f73 697a 655b 315d 2c20     img_size[1], 
-0001f490: 706f 696e 745f 6469 7374 616e 6365 0a20  point_distance. 
-0001f4a0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001f4b0: 2069 6620 685f 6269 6e5f 636e 745b 315d   if h_bin_cnt[1]
-0001f4c0: 2021 3d20 303a 0a20 2020 2020 2020 2020   != 0:.         
-0001f4d0: 2020 2068 5f62 696e 5f63 6e74 203d 2028     h_bin_cnt = (
-0001f4e0: 685f 6269 6e5f 636e 745b 305d 202b 2031  h_bin_cnt[0] + 1
-0001f4f0: 2c20 685f 6269 6e5f 636e 745b 315d 290a  , h_bin_cnt[1]).
-0001f500: 2020 2020 2020 2020 6966 2076 5f62 696e          if v_bin
-0001f510: 5f63 6e74 5b31 5d20 213d 2030 3a0a 2020  _cnt[1] != 0:.  
-0001f520: 2020 2020 2020 2020 2020 765f 6269 6e5f            v_bin_
-0001f530: 636e 7420 3d20 2876 5f62 696e 5f63 6e74  cnt = (v_bin_cnt
-0001f540: 5b30 5d20 2b20 312c 2076 5f62 696e 5f63  [0] + 1, v_bin_c
-0001f550: 6e74 5b31 5d29 0a0a 2020 2020 2020 2020  nt[1])..        
-0001f560: 706f 696e 7473 203d 207b 7d0a 2020 2020  points = {}.    
-0001f570: 2020 2020 666f 7220 685f 636e 742c 2069      for h_cnt, i
-0001f580: 2069 6e20 656e 756d 6572 6174 6528 7261   in enumerate(ra
-0001f590: 6e67 6528 685f 6269 6e5f 636e 745b 305d  nge(h_bin_cnt[0]
-0001f5a0: 202b 2031 2929 3a0a 2020 2020 2020 2020   + 1)):.        
-0001f5b0: 2020 2020 666f 7220 765f 636e 742c 206a      for v_cnt, j
-0001f5c0: 2069 6e20 656e 756d 6572 6174 6528 7261   in enumerate(ra
-0001f5d0: 6e67 6528 765f 6269 6e5f 636e 745b 305d  nge(v_bin_cnt[0]
-0001f5e0: 202b 2031 2929 3a0a 2020 2020 2020 2020   + 1)):.        
-0001f5f0: 2020 2020 2020 2020 782c 2079 203d 2069          x, y = i
-0001f600: 202a 2070 6f69 6e74 5f64 6973 7461 6e63   * point_distanc
-0001f610: 652c 206a 202a 2070 6f69 6e74 5f64 6973  e, j * point_dis
-0001f620: 7461 6e63 650a 2020 2020 2020 2020 2020  tance.          
-0001f630: 2020 2020 2020 782c 2079 203d 206d 696e        x, y = min
-0001f640: 2878 2c20 696d 675f 7369 7a65 5b31 5d29  (x, img_size[1])
-0001f650: 2c20 6d69 6e28 792c 2069 6d67 5f73 697a  , min(y, img_siz
-0001f660: 655b 305d 290a 2020 2020 2020 2020 2020  e[0]).          
-0001f670: 2020 2020 2020 6966 206e 6f74 2062 6f72        if not bor
-0001f680: 6465 725f 7369 7465 7320 616e 6420 280a  der_sites and (.
-0001f690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f6a0: 2020 2020 2878 203d 3d20 3029 206f 7220      (x == 0) or 
-0001f6b0: 2879 203d 3d20 3029 206f 7220 2879 203d  (y == 0) or (y =
-0001f6c0: 3d20 696d 675f 7369 7a65 5b30 5d29 206f  = img_size[0]) o
-0001f6d0: 7220 2878 203d 3d20 696d 675f 7369 7a65  r (x == img_size
-0001f6e0: 5b31 5d29 0a20 2020 2020 2020 2020 2020  [1]).           
-0001f6f0: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
-0001f700: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
-0001f710: 696e 7565 0a20 2020 2020 2020 2020 2020  inue.           
-0001f720: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0001f730: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0001f740: 6f69 6e74 203d 2050 6f69 6e74 2878 2c20  oint = Point(x, 
-0001f750: 7929 0a20 2020 2020 2020 2020 2020 2020  y).             
-0001f760: 2020 2020 2020 2069 6620 706f 696e 7420         if point 
-0001f770: 6e6f 7420 696e 2070 6f69 6e74 732e 7661  not in points.va
-0001f780: 6c75 6573 2829 3a0a 2020 2020 2020 2020  lues():.        
-0001f790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f7a0: 706f 696e 7473 5b28 685f 636e 742c 2076  points[(h_cnt, v
-0001f7b0: 5f63 6e74 295d 203d 2050 6f69 6e74 2878  _cnt)] = Point(x
-0001f7c0: 2c20 7929 0a20 2020 2020 2020 2072 6574  , y).        ret
-0001f7d0: 7572 6e20 706f 696e 7473 0a0a 2020 2020  urn points..    
-0001f7e0: 4073 7461 7469 636d 6574 686f 640a 2020  @staticmethod.  
-0001f7f0: 2020 6465 6620 6275 636b 6574 5f69 6d67    def bucket_img
-0001f800: 5f69 6e74 6f5f 6772 6964 5f73 7175 6172  _into_grid_squar
-0001f810: 6528 0a20 2020 2020 2020 2069 6d67 5f73  e(.        img_s
-0001f820: 697a 653a 2049 7465 7261 626c 655b 696e  ize: Iterable[in
-0001f830: 745d 2c0a 2020 2020 2020 2020 6275 636b  t],.        buck
-0001f840: 6574 5f67 7269 645f 7369 7a65 5f6d 6d3a  et_grid_size_mm:
-0001f850: 204f 7074 696f 6e61 6c5b 666c 6f61 745d   Optional[float]
-0001f860: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-0001f870: 2062 7563 6b65 745f 6772 6964 5f73 697a   bucket_grid_siz
-0001f880: 653a 204f 7074 696f 6e61 6c5b 4974 6572  e: Optional[Iter
-0001f890: 6162 6c65 5b69 6e74 5d5d 203d 204e 6f6e  able[int]] = Non
-0001f8a0: 652c 0a20 2020 2020 2020 2070 785f 7065  e,.        px_pe
-0001f8b0: 725f 6d6d 3a20 4f70 7469 6f6e 616c 5b66  r_mm: Optional[f
-0001f8c0: 6c6f 6174 5d20 3d20 4e6f 6e65 2c0a 2020  loat] = None,.  
-0001f8d0: 2020 2020 2020 6164 645f 636f 7272 6563        add_correc
-0001f8e0: 7469 6f6e 3a20 4f70 7469 6f6e 616c 5b62  tion: Optional[b
-0001f8f0: 6f6f 6c5d 203d 2054 7275 652c 0a20 2020  ool] = True,.   
-0001f900: 2029 202d 3e20 5475 706c 655b 4469 6374   ) -> Tuple[Dict
-0001f910: 5b54 7570 6c65 5b69 6e74 2c20 696e 745d  [Tuple[int, int]
-0001f920: 2c20 506f 6c79 676f 6e5d 2c20 666c 6f61  , Polygon], floa
-0001f930: 745d 3a0a 2020 2020 2020 2020 2222 220a  t]:.        """.
-0001f940: 2020 2020 2020 2020 4275 636b 6574 697a          Bucketiz
-0001f950: 6520 616e 2069 6d61 6765 2069 6e74 6f20  e an image into 
-0001f960: 7371 7561 7265 7320 616e 6420 7265 7475  squares and retu
-0001f970: 726e 2061 2064 6963 7469 6f6e 6172 7920  rn a dictionary 
-0001f980: 6f66 2070 6f6c 7967 6f6e 7320 7265 7072  of polygons repr
-0001f990: 6573 656e 7469 6e67 2074 6865 2062 7563  esenting the buc
-0001f9a0: 6b65 7420 6c6f 6361 7469 6f6e 732e 0a0a  ket locations...
-0001f9b0: 2020 2020 2020 2020 3a70 6172 616d 2049          :param I
-0001f9c0: 7465 7261 626c 655b 696e 745d 2069 6d67  terable[int] img
-0001f9d0: 5f73 697a 653a 2032 2d76 616c 7565 2074  _size: 2-value t
-0001f9e0: 7570 6c65 2c20 6c69 7374 206f 7220 6172  uple, list or ar
-0001f9f0: 7261 7920 7265 7072 6573 656e 7469 6e67  ray representing
-0001fa00: 2074 6865 2077 6964 7468 2061 6e64 2068   the width and h
-0001fa10: 6569 6768 7420 6f66 2074 6865 2069 6d61  eight of the ima
-0001fa20: 6765 2069 6e20 7069 7865 6c73 2e0a 2020  ge in pixels..  
-0001fa30: 2020 2020 2020 3a70 6172 616d 204f 7074        :param Opt
-0001fa40: 696f 6e61 6c5b 666c 6f61 745d 2062 7563  ional[float] buc
-0001fa50: 6b65 745f 6772 6964 5f73 697a 655f 6d6d  ket_grid_size_mm
-0001fa60: 3a20 5468 6520 7769 6474 682f 6865 6967  : The width/heig
-0001fa70: 6874 206f 6620 6561 6368 2073 7175 6172  ht of each squar
-0001fa80: 6520 6275 636b 6574 2069 6e20 6d69 6c6c  e bucket in mill
-0001fa90: 696d 6574 6572 732e 2045 2e67 2e2c 2035  imeters. E.g., 5
-0001faa0: 3020 7769 6c6c 2063 7265 6174 6520 3563  0 will create 5c
-0001fab0: 6d20 6279 2035 636d 2073 7175 6172 6573  m by 5cm squares
-0001fac0: 2e20 4966 204e 6f6e 652c 2074 6865 6e20  . If None, then 
-0001fad0: 6275 636b 6574 7320 7769 6c6c 2062 7920  buckets will by 
-0001fae0: 6465 6669 6e65 6420 6279 2060 6062 7563  defined by ``buc
-0001faf0: 6b65 745f 6772 6964 5f73 697a 6560 6020  ket_grid_size`` 
-0001fb00: 6172 6775 6d65 6e74 2e0a 2020 2020 2020  argument..      
-0001fb10: 2020 3a70 6172 616d 204f 7074 696f 6e61    :param Optiona
-0001fb20: 6c5b 4974 6572 6162 6c65 5b69 6e74 5d5d  l[Iterable[int]]
-0001fb30: 2062 7563 6b65 745f 6772 6964 5f73 697a   bucket_grid_siz
-0001fb40: 653a 2032 2d76 616c 7565 2074 7570 6c65  e: 2-value tuple
-0001fb50: 2c20 6c69 7374 206f 7220 6172 7261 7920  , list or array 
-0001fb60: 7265 7072 6573 656e 7469 6e67 2074 6865  representing the
-0001fb70: 2067 7269 6420 7371 7561 7265 2069 6e20   grid square in 
-0001fb80: 6e75 6d62 6572 206f 6620 686f 7269 7a6f  number of horizo
-0001fb90: 6e74 616c 2073 7175 6172 6573 2078 206e  ntal squares x n
-0001fba0: 756d 6265 7220 6f66 2076 6572 7469 6361  umber of vertica
-0001fbb0: 6c20 7371 7561 7265 732e 2049 6620 4e6f  l squares. If No
-0001fbc0: 6e65 2c20 7468 656e 2062 7563 6b65 7473  ne, then buckets
-0001fbd0: 2077 696c 6c20 6265 2064 6566 696e 6564   will be defined
-0001fbe0: 2062 7920 7468 6520 6060 6275 636b 6574   by the ``bucket
-0001fbf0: 5f73 697a 655f 6d6d 6060 2061 7267 756d  _size_mm`` argum
-0001fc00: 656e 742e 0a20 2020 2020 2020 203a 7061  ent..        :pa
-0001fc10: 7261 6d20 4f70 7469 6f6e 616c 5b66 6c6f  ram Optional[flo
-0001fc20: 6174 5d20 7078 5f70 6572 5f6d 6d3a 2050  at] px_per_mm: P
-0001fc30: 6978 656c 7320 7065 7220 6d69 6c6c 696d  ixels per millim
-0001fc40: 6574 6572 2063 6f6e 7665 7273 696f 6e20  eter conversion 
-0001fc50: 6661 6374 6f72 2e20 4e65 6365 7373 6572  factor. Necesser
-0001fc60: 7920 6966 2062 7563 6b65 7473 2061 7265  y if buckets are
-0001fc70: 2064 6566 696e 6564 2062 7920 6060 6275   defined by ``bu
-0001fc80: 636b 6574 5f73 697a 655f 6d6d 6060 2061  cket_size_mm`` a
-0001fc90: 7267 756d 656e 742e 0a20 2020 2020 2020  rgument..       
-0001fca0: 203a 7061 7261 6d20 4f70 7469 6f6e 616c   :param Optional
-0001fcb0: 5b62 6f6f 6c5d 2061 6464 5f63 6f72 7265  [bool] add_corre
-0001fcc0: 6374 696f 6e3a 2049 6620 5472 7565 2c20  ction: If True, 
-0001fcd0: 7065 7266 6f72 6d73 2063 6f72 7265 6374  performs correct
-0001fce0: 696f 6e20 6279 2061 6464 696e 6720 6578  ion by adding ex
-0001fcf0: 7472 6120 636f 6c75 6d6e 7320 6f72 2072  tra columns or r
-0001fd00: 6f77 7320 746f 2063 6f76 6572 2061 6e79  ows to cover any
-0001fd10: 2072 656d 6169 6e69 6e67 2073 7061 6365   remaining space
-0001fd20: 2069 6620 7573 696e 6720 6060 6275 636b   if using ``buck
-0001fd30: 6574 5f73 697a 655f 6d6d 6060 2e20 4465  et_size_mm``. De
-0001fd40: 6661 756c 7420 5472 7565 2e0a 0a20 2020  fault True...   
-0001fd50: 2020 2020 203a 6578 616d 706c 653a 0a20       :example:. 
-0001fd60: 2020 2020 2020 203e 3e3e 2069 6d67 203d         >>> img =
-0001fd70: 2063 7632 2e69 6d72 6561 6428 272f 5573   cv2.imread('/Us
-0001fd80: 6572 732f 7369 6d6f 6e2f 4465 736b 746f  ers/simon/Deskto
-0001fd90: 702f 5363 7265 656e 7368 6f74 2032 3032  p/Screenshot 202
-0001fda0: 342d 3031 2d32 3120 6174 2031 302e 3135  4-01-21 at 10.15
-0001fdb0: 2e35 3520 414d 2e70 6e67 272c 2031 290a  .55 AM.png', 1).
-0001fdc0: 2020 2020 2020 2020 3e3e 3e20 706f 6c79          >>> poly
-0001fdd0: 676f 6e73 203d 2047 656f 6d65 7472 794d  gons = GeometryM
-0001fde0: 6978 696e 2829 2e62 7563 6b65 745f 696d  ixin().bucket_im
-0001fdf0: 675f 696e 746f 5f67 7269 645f 7371 7561  g_into_grid_squa
-0001fe00: 7265 2862 7563 6b65 745f 6772 6964 5f73  re(bucket_grid_s
-0001fe10: 697a 653d 2831 302c 2035 292c 2062 7563  ize=(10, 5), buc
-0001fe20: 6b65 745f 6772 6964 5f73 697a 655f 6d6d  ket_grid_size_mm
-0001fe30: 3d4e 6f6e 652c 2069 6d67 5f73 697a 653d  =None, img_size=
-0001fe40: 2869 6d67 2e73 6861 7065 5b31 5d2c 2069  (img.shape[1], i
-0001fe50: 6d67 2e73 6861 7065 5b30 5d29 2c20 7078  mg.shape[0]), px
-0001fe60: 5f70 6572 5f6d 6d3d 352e 3029 0a20 2020  _per_mm=5.0).   
-0001fe70: 2020 2020 203e 3e3e 2066 6f72 206b 2c20       >>> for k, 
-0001fe80: 7620 696e 2070 6f6c 7967 6f6e 735b 305d  v in polygons[0]
-0001fe90: 2e69 7465 6d73 2829 3a20 6376 322e 706f  .items(): cv2.po
-0001fea0: 6c79 6c69 6e65 7328 696d 672c 205b 6e70  lylines(img, [np
-0001feb0: 2e61 7272 6179 2876 2e65 7874 6572 696f  .array(v.exterio
-0001fec0: 722e 636f 6f72 6473 292e 6173 7479 7065  r.coords).astype
-0001fed0: 2869 6e74 295d 2c20 5472 7565 2c20 2832  (int)], True, (2
-0001fee0: 3535 2c20 302c 2031 3333 292c 2032 290a  55, 0, 133), 2).
-0001fef0: 2020 2020 2020 2020 3e3e 3e20 6376 322e          >>> cv2.
-0001ff00: 696d 7368 6f77 2827 696d 6727 2c20 696d  imshow('img', im
-0001ff10: 6729 0a20 2020 2020 2020 203e 3e3e 2063  g).        >>> c
-0001ff20: 7632 2e77 6169 744b 6579 2829 0a20 2020  v2.waitKey().   
-0001ff30: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-0001ff40: 2020 7469 6d65 7220 3d20 5369 6d62 6154    timer = SimbaT
-0001ff50: 696d 6572 2873 7461 7274 3d54 7275 6529  imer(start=True)
-0001ff60: 0a20 2020 2020 2020 2069 6620 6275 636b  .        if buck
-0001ff70: 6574 5f67 7269 645f 7369 7a65 2069 7320  et_grid_size is 
-0001ff80: 6e6f 7420 4e6f 6e65 2061 6e64 2062 7563  not None and buc
-0001ff90: 6b65 745f 6772 6964 5f73 697a 655f 6d6d  ket_grid_size_mm
-0001ffa0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0001ffb0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0001ffc0: 496e 7661 6c69 6449 6e70 7574 4572 726f  InvalidInputErro
-0001ffd0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-0001ffe0: 2020 206d 7367 3d22 6275 636b 6574 5f73     msg="bucket_s
-0001fff0: 697a 655f 6d6d 2061 6e64 2062 7563 6b65  ize_mm and bucke
-00020000: 745f 6772 6964 5f73 697a 6520 6172 6520  t_grid_size are 
-00020010: 626f 7468 206e 6f74 204e 6f6e 652e 2045  both not None. E
-00020020: 6974 6865 7220 7072 6f76 6964 6520 6275  ither provide bu
-00020030: 636b 6574 2073 697a 6520 696e 206d 696c  cket size in mil
-00020040: 6c69 6d65 7465 7273 2c20 4f52 2070 726f  limeters, OR pro
-00020050: 7669 6465 2074 6865 2067 7269 6420 7369  vide the grid si
-00020060: 7a65 222c 0a20 2020 2020 2020 2020 2020  ze",.           
-00020070: 2020 2020 2073 6f75 7263 653d 4765 6f6d       source=Geom
-00020080: 6574 7279 4d69 7869 6e28 292e 6275 636b  etryMixin().buck
-00020090: 6574 5f69 6d67 5f69 6e74 6f5f 6772 6964  et_img_into_grid
-000200a0: 5f73 7175 6172 652e 5f5f 6e61 6d65 5f5f  _square.__name__
-000200b0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-000200c0: 2020 2020 2020 2020 6368 6563 6b5f 696e          check_in
-000200d0: 7374 616e 6365 280a 2020 2020 2020 2020  stance(.        
-000200e0: 2020 2020 736f 7572 6365 3d66 227b 4765      source=f"{Ge
-000200f0: 6f6d 6574 7279 4d69 7869 6e2e 6275 636b  ometryMixin.buck
-00020100: 6574 5f69 6d67 5f69 6e74 6f5f 6772 6964  et_img_into_grid
-00020110: 5f73 7175 6172 652e 5f5f 6e61 6d65 5f5f  _square.__name__
-00020120: 7d20 696d 675f 7369 7a65 222c 0a20 2020  } img_size",.   
-00020130: 2020 2020 2020 2020 2069 6e73 7461 6e63           instanc
-00020140: 653d 696d 675f 7369 7a65 2c0a 2020 2020  e=img_size,.    
-00020150: 2020 2020 2020 2020 6163 6365 7074 6564          accepted
-00020160: 5f74 7970 6573 3d28 7475 706c 652c 206e  _types=(tuple, n
-00020170: 702e 6e64 6172 7261 7929 2c0a 2020 2020  p.ndarray),.    
-00020180: 2020 2020 290a 2020 2020 2020 2020 6368      ).        ch
-00020190: 6563 6b5f 6974 6572 6162 6c65 5f6c 656e  eck_iterable_len
-000201a0: 6774 6828 0a20 2020 2020 2020 2020 2020  gth(.           
-000201b0: 2073 6f75 7263 653d 6622 7b47 656f 6d65   source=f"{Geome
-000201c0: 7472 794d 6978 696e 2e62 7563 6b65 745f  tryMixin.bucket_
-000201d0: 696d 675f 696e 746f 5f67 7269 645f 7371  img_into_grid_sq
-000201e0: 7561 7265 2e5f 5f6e 616d 655f 5f7d 2069  uare.__name__} i
-000201f0: 6d67 5f73 697a 6522 2c0a 2020 2020 2020  mg_size",.      
-00020200: 2020 2020 2020 7661 6c3d 6c65 6e28 696d        val=len(im
-00020210: 675f 7369 7a65 292c 0a20 2020 2020 2020  g_size),.       
-00020220: 2020 2020 2065 7861 6374 5f61 6363 6570       exact_accep
-00020230: 7465 645f 6c65 6e67 7468 3d32 2c0a 2020  ted_length=2,.  
-00020240: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00020250: 6368 6563 6b5f 696e 7428 0a20 2020 2020  check_int(.     
-00020260: 2020 2020 2020 206e 616d 653d 6622 7b47         name=f"{G
-00020270: 656f 6d65 7472 794d 6978 696e 2e62 7563  eometryMixin.buc
-00020280: 6b65 745f 696d 675f 696e 746f 5f67 7269  ket_img_into_gri
-00020290: 645f 7371 7561 7265 2e5f 5f6e 616d 655f  d_square.__name_
-000202a0: 5f7d 2069 6d67 5f73 697a 6520 6865 6967  _} img_size heig
-000202b0: 6874 222c 0a20 2020 2020 2020 2020 2020  ht",.           
-000202c0: 2076 616c 7565 3d69 6d67 5f73 697a 655b   value=img_size[
-000202d0: 305d 2c0a 2020 2020 2020 2020 290a 2020  0],.        ).  
-000202e0: 2020 2020 2020 6368 6563 6b5f 696e 7428        check_int(
-000202f0: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
-00020300: 653d 6622 7b47 656f 6d65 7472 794d 6978  e=f"{GeometryMix
-00020310: 696e 2e62 7563 6b65 745f 696d 675f 696e  in.bucket_img_in
-00020320: 746f 5f67 7269 645f 7371 7561 7265 2e5f  to_grid_square._
-00020330: 5f6e 616d 655f 5f7d 2069 6d67 5f73 697a  _name__} img_siz
-00020340: 6520 7769 6474 6822 2c0a 2020 2020 2020  e width",.      
-00020350: 2020 2020 2020 7661 6c75 653d 696d 675f        value=img_
-00020360: 7369 7a65 5b31 5d2c 0a20 2020 2020 2020  size[1],.       
-00020370: 2029 0a20 2020 2020 2020 2070 6f6c 7967   ).        polyg
-00020380: 6f6e 7320 3d20 7b7d 0a20 2020 2020 2020  ons = {}.       
-00020390: 2069 6620 6275 636b 6574 5f67 7269 645f   if bucket_grid_
-000203a0: 7369 7a65 5f6d 6d20 6973 206e 6f74 204e  size_mm is not N
-000203b0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-000203c0: 2063 6865 636b 5f66 6c6f 6174 280a 2020   check_float(.  
-000203d0: 2020 2020 2020 2020 2020 2020 2020 6e61                na
-000203e0: 6d65 3d66 227b 4765 6f6d 6574 7279 4d69  me=f"{GeometryMi
-000203f0: 7869 6e2e 6275 636b 6574 5f69 6d67 5f69  xin.bucket_img_i
-00020400: 6e74 6f5f 6772 6964 5f73 7175 6172 652e  nto_grid_square.
-00020410: 5f5f 6e61 6d65 5f5f 7d20 6275 636b 6574  __name__} bucket
-00020420: 5f73 697a 655f 6d6d 222c 0a20 2020 2020  _size_mm",.     
-00020430: 2020 2020 2020 2020 2020 2076 616c 7565             value
-00020440: 3d62 7563 6b65 745f 6772 6964 5f73 697a  =bucket_grid_siz
-00020450: 655f 6d6d 2c0a 2020 2020 2020 2020 2020  e_mm,.          
-00020460: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00020470: 6269 6e5f 7369 7a65 5f70 7820 3d20 696e  bin_size_px = in
-00020480: 7428 7078 5f70 6572 5f6d 6d20 2a20 6275  t(px_per_mm * bu
-00020490: 636b 6574 5f67 7269 645f 7369 7a65 5f6d  cket_grid_size_m
-000204a0: 6d29 0a20 2020 2020 2020 2020 2020 2068  m).            h
-000204b0: 5f62 696e 5f63 6e74 2c20 765f 6269 6e5f  _bin_cnt, v_bin_
-000204c0: 636e 7420 3d20 6469 766d 6f64 2869 6d67  cnt = divmod(img
-000204d0: 5f73 697a 655b 305d 2c20 6269 6e5f 7369  _size[0], bin_si
-000204e0: 7a65 5f70 7829 2c20 6469 766d 6f64 280a  ze_px), divmod(.
-000204f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020500: 696d 675f 7369 7a65 5b31 5d2c 2062 696e  img_size[1], bin
-00020510: 5f73 697a 655f 7078 0a20 2020 2020 2020  _size_px.       
-00020520: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00020530: 2020 2069 6620 2869 6d67 5f73 697a 655b     if (img_size[
-00020540: 305d 203c 2062 696e 5f73 697a 655f 7078  0] < bin_size_px
-00020550: 2920 6f72 2028 696d 675f 7369 7a65 5b31  ) or (img_size[1
-00020560: 5d20 3c20 6269 6e5f 7369 7a65 5f70 7829  ] < bin_size_px)
-00020570: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00020580: 2020 7261 6973 6520 496e 7661 6c69 6449    raise InvalidI
-00020590: 6e70 7574 4572 726f 7228 0a20 2020 2020  nputError(.     
-000205a0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-000205b0: 7367 3d66 2254 6865 2062 7563 6b65 7420  sg=f"The bucket 
-000205c0: 7371 7561 7265 2073 697a 6520 7b62 696e  square size {bin
-000205d0: 5f73 697a 655f 7078 7d20 6973 206c 6172  _size_px} is lar
-000205e0: 6765 7220 7468 616e 2074 6865 2076 6964  ger than the vid
-000205f0: 656f 2073 697a 6520 696e 2070 6978 656c  eo size in pixel
-00020600: 7320 7b69 6d67 5f73 697a 657d 220a 2020  s {img_size}".  
-00020610: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00020620: 2020 2020 2020 2020 2020 2020 6966 2061              if a
-00020630: 6464 5f63 6f72 7265 6374 696f 6e3a 0a20  dd_correction:. 
-00020640: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00020650: 6620 685f 6269 6e5f 636e 745b 315d 2021  f h_bin_cnt[1] !
-00020660: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
-00020670: 2020 2020 2020 2020 2068 5f62 696e 5f63           h_bin_c
-00020680: 6e74 203d 2028 685f 6269 6e5f 636e 745b  nt = (h_bin_cnt[
-00020690: 305d 202b 2031 2c20 685f 6269 6e5f 636e  0] + 1, h_bin_cn
-000206a0: 745b 315d 290a 2020 2020 2020 2020 2020  t[1]).          
-000206b0: 2020 2020 2020 6966 2076 5f62 696e 5f63        if v_bin_c
-000206c0: 6e74 5b31 5d20 213d 2030 3a0a 2020 2020  nt[1] != 0:.    
-000206d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000206e0: 765f 6269 6e5f 636e 7420 3d20 2876 5f62  v_bin_cnt = (v_b
-000206f0: 696e 5f63 6e74 5b30 5d20 2b20 312c 2076  in_cnt[0] + 1, v
-00020700: 5f62 696e 5f63 6e74 5b31 5d29 0a20 2020  _bin_cnt[1]).   
-00020710: 2020 2020 2020 2020 2066 6f72 2069 2069           for i i
-00020720: 6e20 7261 6e67 6528 685f 6269 6e5f 636e  n range(h_bin_cn
-00020730: 745b 305d 293a 0a20 2020 2020 2020 2020  t[0]):.         
-00020740: 2020 2020 2020 2066 6f72 206a 2069 6e20         for j in 
-00020750: 7261 6e67 6528 765f 6269 6e5f 636e 745b  range(v_bin_cnt[
-00020760: 305d 293a 0a20 2020 2020 2020 2020 2020  0]):.           
-00020770: 2020 2020 2020 2020 2078 312c 2079 3120           x1, y1 
-00020780: 3d20 6920 2a20 6269 6e5f 7369 7a65 5f70  = i * bin_size_p
-00020790: 782c 206a 202a 2062 696e 5f73 697a 655f  x, j * bin_size_
-000207a0: 7078 0a20 2020 2020 2020 2020 2020 2020  px.             
-000207b0: 2020 2020 2020 2078 322c 2079 3220 3d20         x2, y2 = 
-000207c0: 7831 202b 2062 696e 5f73 697a 655f 7078  x1 + bin_size_px
-000207d0: 2c20 7931 202b 2062 696e 5f73 697a 655f  , y1 + bin_size_
-000207e0: 7078 0a20 2020 2020 2020 2020 2020 2020  px.             
-000207f0: 2020 2020 2020 2070 6f6c 7967 6f6e 735b         polygons[
-00020800: 2869 2c20 6a29 5d20 3d20 506f 6c79 676f  (i, j)] = Polygo
-00020810: 6e28 5b28 7831 2c20 7931 292c 2028 7832  n([(x1, y1), (x2
-00020820: 2c20 7931 292c 2028 7832 2c20 7932 292c  , y1), (x2, y2),
-00020830: 2028 7831 2c20 7932 295d 290a 2020 2020   (x1, y2)]).    
-00020840: 2020 2020 2020 2020 7469 6d65 722e 7374          timer.st
-00020850: 6f70 5f74 696d 6572 2829 0a20 2020 2020  op_timer().     
-00020860: 2020 2020 2020 2073 7464 6f75 745f 7375         stdout_su
-00020870: 6363 6573 7328 0a20 2020 2020 2020 2020  ccess(.         
-00020880: 2020 2020 2020 206d 7367 3d22 4275 636b         msg="Buck
-00020890: 6574 2069 6d61 6765 2069 6e74 6f20 6772  et image into gr
-000208a0: 6964 2073 7175 6172 6573 2063 6f6d 706c  id squares compl
-000208b0: 6574 6522 2c0a 2020 2020 2020 2020 2020  ete",.          
-000208c0: 2020 2020 2020 656c 6170 7365 645f 7469        elapsed_ti
-000208d0: 6d65 3d74 696d 6572 2e65 6c61 7073 6564  me=timer.elapsed
-000208e0: 5f74 696d 655f 7374 722c 0a20 2020 2020  _time_str,.     
-000208f0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00020900: 2020 2020 2072 6574 7572 6e20 706f 6c79       return poly
-00020910: 676f 6e73 2c20 726f 756e 6428 2876 5f62  gons, round((v_b
-00020920: 696e 5f63 6e74 5b30 5d20 2f20 685f 6269  in_cnt[0] / h_bi
-00020930: 6e5f 636e 745b 305d 292c 2033 290a 0a20  n_cnt[0]), 3).. 
-00020940: 2020 2020 2020 2069 6620 6275 636b 6574         if bucket
-00020950: 5f67 7269 645f 7369 7a65 2069 7320 6e6f  _grid_size is no
-00020960: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00020970: 2020 2020 6368 6563 6b5f 696e 7374 616e      check_instan
-00020980: 6365 280a 2020 2020 2020 2020 2020 2020  ce(.            
-00020990: 2020 2020 736f 7572 6365 3d66 227b 4765      source=f"{Ge
-000209a0: 6f6d 6574 7279 4d69 7869 6e2e 5f5f 6e61  ometryMixin.__na
-000209b0: 6d65 5f5f 7d20 6275 636b 6574 5f67 7269  me__} bucket_gri
-000209c0: 645f 7369 7a65 222c 0a20 2020 2020 2020  d_size",.       
-000209d0: 2020 2020 2020 2020 2069 6e73 7461 6e63           instanc
-000209e0: 653d 6275 636b 6574 5f67 7269 645f 7369  e=bucket_grid_si
-000209f0: 7a65 2c0a 2020 2020 2020 2020 2020 2020  ze,.            
-00020a00: 2020 2020 6163 6365 7074 6564 5f74 7970      accepted_typ
-00020a10: 6573 3d28 7475 706c 652c 206e 702e 6e64  es=(tuple, np.nd
-00020a20: 6172 7261 792c 206c 6973 7429 2c0a 2020  array, list),.  
-00020a30: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00020a40: 2020 2020 2020 2020 6368 6563 6b5f 6974          check_it
-00020a50: 6572 6162 6c65 5f6c 656e 6774 6828 0a20  erable_length(. 
-00020a60: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00020a70: 6f75 7263 653d 6622 7b47 656f 6d65 7472  ource=f"{Geometr
-00020a80: 794d 6978 696e 2e5f 5f6e 616d 655f 5f7d  yMixin.__name__}
-00020a90: 2062 7563 6b65 745f 6772 6964 5f73 697a   bucket_grid_siz
-00020aa0: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
-00020ab0: 2020 2020 7661 6c3d 6c65 6e28 6275 636b      val=len(buck
-00020ac0: 6574 5f67 7269 645f 7369 7a65 292c 0a20  et_grid_size),. 
-00020ad0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00020ae0: 7861 6374 5f61 6363 6570 7465 645f 6c65  xact_accepted_le
-00020af0: 6e67 7468 3d32 2c0a 2020 2020 2020 2020  ngth=2,.        
-00020b00: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00020b10: 2020 6368 6563 6b5f 696e 7428 0a20 2020    check_int(.   
-00020b20: 2020 2020 2020 2020 2020 2020 206e 616d               nam
-00020b30: 653d 6622 7b47 656f 6d65 7472 794d 6978  e=f"{GeometryMix
-00020b40: 696e 2e62 7563 6b65 745f 696d 675f 696e  in.bucket_img_in
-00020b50: 746f 5f67 7269 645f 7371 7561 7265 2e5f  to_grid_square._
-00020b60: 5f6e 616d 655f 5f7d 2062 7563 6b65 745f  _name__} bucket_
-00020b70: 6772 6964 5f73 697a 6522 2c0a 2020 2020  grid_size",.    
-00020b80: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
-00020b90: 653d 6275 636b 6574 5f67 7269 645f 7369  e=bucket_grid_si
-00020ba0: 7a65 5b30 5d2c 0a20 2020 2020 2020 2020  ze[0],.         
-00020bb0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00020bc0: 2063 6865 636b 5f69 6e74 280a 2020 2020   check_int(.    
-00020bd0: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-00020be0: 3d66 227b 4765 6f6d 6574 7279 4d69 7869  =f"{GeometryMixi
-00020bf0: 6e2e 6275 636b 6574 5f69 6d67 5f69 6e74  n.bucket_img_int
-00020c00: 6f5f 6772 6964 5f73 7175 6172 652e 5f5f  o_grid_square.__
-00020c10: 6e61 6d65 5f5f 7d20 6275 636b 6574 5f67  name__} bucket_g
-00020c20: 7269 645f 7369 7a65 222c 0a20 2020 2020  rid_size",.     
-00020c30: 2020 2020 2020 2020 2020 2076 616c 7565             value
-00020c40: 3d62 7563 6b65 745f 6772 6964 5f73 697a  =bucket_grid_siz
-00020c50: 655b 315d 2c0a 2020 2020 2020 2020 2020  e[1],.          
-00020c60: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00020c70: 6275 636b 6574 5f77 6964 7468 2c20 6275  bucket_width, bu
-00020c80: 636b 6574 5f68 6569 6768 7420 3d20 696e  cket_height = in
-00020c90: 7428 696d 675f 7369 7a65 5b30 5d20 2f20  t(img_size[0] / 
-00020ca0: 6275 636b 6574 5f67 7269 645f 7369 7a65  bucket_grid_size
-00020cb0: 5b30 5d29 2c20 696e 7428 0a20 2020 2020  [0]), int(.     
-00020cc0: 2020 2020 2020 2020 2020 2069 6d67 5f73             img_s
-00020cd0: 697a 655b 315d 202f 2062 7563 6b65 745f  ize[1] / bucket_
-00020ce0: 6772 6964 5f73 697a 655b 315d 0a20 2020  grid_size[1].   
-00020cf0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00020d00: 2020 2020 2020 2069 6620 2869 6d67 5f73         if (img_s
-00020d10: 697a 655b 305d 203c 2062 7563 6b65 745f  ize[0] < bucket_
-00020d20: 7769 6474 6829 206f 7220 2869 6d67 5f73  width) or (img_s
-00020d30: 697a 655b 315d 203c 2062 7563 6b65 745f  ize[1] < bucket_
-00020d40: 6865 6967 6874 293a 0a20 2020 2020 2020  height):.       
-00020d50: 2020 2020 2020 2020 2072 6169 7365 2049           raise I
-00020d60: 6e76 616c 6964 496e 7075 7445 7272 6f72  nvalidInputError
-00020d70: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00020d80: 2020 2020 2020 6d73 673d 6622 5468 6520        msg=f"The 
-00020d90: 6275 636b 6574 2073 7175 6172 6520 7369  bucket square si
-00020da0: 7a65 2028 7b62 7563 6b65 745f 7769 6474  ze ({bucket_widt
-00020db0: 687d 2078 207b 6275 636b 6574 5f68 6569  h} x {bucket_hei
-00020dc0: 6768 747d 2920 6973 206c 6172 6765 7220  ght}) is larger 
-00020dd0: 7468 616e 2074 6865 2076 6964 656f 2073  than the video s
-00020de0: 697a 6520 696e 2070 6978 656c 7320 7b69  ize in pixels {i
-00020df0: 6d67 5f73 697a 657d 220a 2020 2020 2020  mg_size}".      
-00020e00: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00020e10: 2020 2020 2020 2020 2066 6f72 2068 5f63           for h_c
-00020e20: 6e74 2069 6e20 7261 6e67 6528 6275 636b  nt in range(buck
-00020e30: 6574 5f67 7269 645f 7369 7a65 5b30 5d29  et_grid_size[0])
-00020e40: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00020e50: 2020 666f 7220 775f 636e 7420 696e 2072    for w_cnt in r
-00020e60: 616e 6765 2862 7563 6b65 745f 6772 6964  ange(bucket_grid
-00020e70: 5f73 697a 655b 315d 293a 0a20 2020 2020  _size[1]):.     
-00020e80: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-00020e90: 6f70 5f6c 6566 7420 3d20 2828 685f 636e  op_left = ((h_cn
-00020ea0: 7420 2a20 6275 636b 6574 5f77 6964 7468  t * bucket_width
-00020eb0: 292c 2028 775f 636e 7420 2a20 6275 636b  ), (w_cnt * buck
-00020ec0: 6574 5f68 6569 6768 7429 290a 2020 2020  et_height)).    
-00020ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020ee0: 746f 705f 7269 6768 7420 3d20 2828 746f  top_right = ((to
-00020ef0: 705f 6c65 6674 5b30 5d20 2b20 6275 636b  p_left[0] + buck
-00020f00: 6574 5f77 6964 7468 292c 2074 6f70 5f6c  et_width), top_l
-00020f10: 6566 745b 315d 290a 2020 2020 2020 2020  eft[1]).        
-00020f20: 2020 2020 2020 2020 2020 2020 626f 7474              bott
-00020f30: 6f6d 5f6c 6566 7420 3d20 2874 6f70 5f6c  om_left = (top_l
-00020f40: 6566 745b 305d 2c20 746f 705f 6c65 6674  eft[0], top_left
-00020f50: 5b31 5d20 2b20 6275 636b 6574 5f68 6569  [1] + bucket_hei
-00020f60: 6768 7429 0a20 2020 2020 2020 2020 2020  ght).           
-00020f70: 2020 2020 2020 2020 2062 6f74 746f 6d5f           bottom_
-00020f80: 7269 6768 7420 3d20 2874 6f70 5f72 6967  right = (top_rig
-00020f90: 6874 5b30 5d2c 2074 6f70 5f72 6967 6874  ht[0], top_right
-00020fa0: 5b31 5d20 2b20 6275 636b 6574 5f68 6569  [1] + bucket_hei
-00020fb0: 6768 7429 0a20 2020 2020 2020 2020 2020  ght).           
-00020fc0: 2020 2020 2020 2020 2070 6f6c 7967 6f6e           polygon
-00020fd0: 735b 2868 5f63 6e74 2c20 775f 636e 7429  s[(h_cnt, w_cnt)
-00020fe0: 5d20 3d20 506f 6c79 676f 6e28 0a20 2020  ] = Polygon(.   
-00020ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021000: 2020 2020 205b 746f 705f 6c65 6674 2c20       [top_left, 
-00021010: 626f 7474 6f6d 5f6c 6566 742c 2062 6f74  bottom_left, bot
-00021020: 746f 6d5f 7269 6768 742c 2074 6f70 5f72  tom_right, top_r
-00021030: 6967 6874 5d0a 2020 2020 2020 2020 2020  ight].          
-00021040: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00021050: 2020 2020 2020 2020 7469 6d65 722e 7374          timer.st
-00021060: 6f70 5f74 696d 6572 2829 0a20 2020 2020  op_timer().     
-00021070: 2020 2020 2020 2073 7464 6f75 745f 7375         stdout_su
-00021080: 6363 6573 7328 0a20 2020 2020 2020 2020  ccess(.         
-00021090: 2020 2020 2020 206d 7367 3d22 4275 636b         msg="Buck
-000210a0: 6574 2069 6d61 6765 2069 6e74 6f20 6772  et image into gr
-000210b0: 6964 2073 7175 6172 6573 2063 6f6d 706c  id squares compl
-000210c0: 6574 6522 2c0a 2020 2020 2020 2020 2020  ete",.          
-000210d0: 2020 2020 2020 656c 6170 7365 645f 7469        elapsed_ti
-000210e0: 6d65 3d74 696d 6572 2e65 6c61 7073 6564  me=timer.elapsed
-000210f0: 5f74 696d 655f 7374 722c 0a20 2020 2020  _time_str,.     
-00021100: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00021110: 2020 2020 2072 6574 7572 6e20 706f 6c79       return poly
-00021120: 676f 6e73 2c20 726f 756e 6428 2862 7563  gons, round((buc
-00021130: 6b65 745f 6772 6964 5f73 697a 655b 315d  ket_grid_size[1]
-00021140: 202f 2062 7563 6b65 745f 6772 6964 5f73   / bucket_grid_s
-00021150: 697a 655b 305d 292c 2033 290a 0a20 2020  ize[0]), 3)..   
-00021160: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
-00021170: 2020 2064 6566 2062 7563 6b65 745f 696d     def bucket_im
-00021180: 675f 696e 746f 5f67 7269 645f 6865 7861  g_into_grid_hexa
-00021190: 676f 6e28 0a20 2020 2020 2020 2062 7563  gon(.        buc
-000211a0: 6b65 745f 7369 7a65 5f6d 6d3a 2066 6c6f  ket_size_mm: flo
-000211b0: 6174 2c20 696d 675f 7369 7a65 3a20 5475  at, img_size: Tu
-000211c0: 706c 655b 696e 742c 2069 6e74 5d2c 2070  ple[int, int], p
-000211d0: 785f 7065 725f 6d6d 3a20 666c 6f61 740a  x_per_mm: float.
-000211e0: 2020 2020 2920 2d3e 2054 7570 6c65 5b44      ) -> Tuple[D
-000211f0: 6963 745b 5475 706c 655b 696e 742c 2069  ict[Tuple[int, i
-00021200: 6e74 5d2c 2050 6f6c 7967 6f6e 5d2c 2066  nt], Polygon], f
-00021210: 6c6f 6174 5d3a 0a20 2020 2020 2020 2022  loat]:.        "
-00021220: 2222 0a20 2020 2020 2020 2042 7563 6b65  "".        Bucke
-00021230: 7469 7a65 2061 6e20 696d 6167 6520 696e  tize an image in
-00021240: 746f 2068 6578 6167 6f6e 7320 616e 6420  to hexagons and 
-00021250: 7265 7475 726e 2061 2064 6963 7469 6f6e  return a diction
-00021260: 6172 7920 6f66 2070 6f6c 7967 6f6e 7320  ary of polygons 
-00021270: 7265 7072 6573 656e 7469 6e67 2074 6865  representing the
-00021280: 2068 6578 6167 6f6e 206c 6f63 6174 696f   hexagon locatio
-00021290: 6e73 2e0a 0a20 2020 2020 2020 202e 2e20  ns...        .. 
-000212a0: 696d 6167 653a 3a20 5f73 7461 7469 632f  image:: _static/
-000212b0: 696d 672f 6275 636b 6574 5f69 6d67 5f69  img/bucket_img_i
-000212c0: 6e74 6f5f 6772 6964 5f68 6578 6167 6f6e  nto_grid_hexagon
-000212d0: 2e70 6e67 0a20 2020 2020 2020 2020 2020  .png.           
-000212e0: 3a77 6964 7468 3a20 3530 300a 2020 2020  :width: 500.    
-000212f0: 2020 2020 2020 203a 616c 6967 6e3a 2063         :align: c
-00021300: 656e 7465 720a 0a20 2020 2020 2020 203a  enter..        :
-00021310: 7061 7261 6d20 666c 6f61 7420 6275 636b  param float buck
-00021320: 6574 5f73 697a 655f 6d6d 3a20 5468 6520  et_size_mm: The 
-00021330: 7769 6474 682f 6865 6967 6874 206f 6620  width/height of 
-00021340: 6561 6368 2068 6578 6167 6f6e 2062 7563  each hexagon buc
-00021350: 6b65 7420 696e 206d 696c 6c69 6d65 7465  ket in millimete
-00021360: 7273 2e0a 2020 2020 2020 2020 3a70 6172  rs..        :par
-00021370: 616d 2054 7570 6c65 5b69 6e74 2c20 696e  am Tuple[int, in
-00021380: 745d 2069 6d67 5f73 697a 653a 2054 7570  t] img_size: Tup
-00021390: 6c65 2072 6570 7265 7365 6e74 696e 6720  le representing 
-000213a0: 7468 6520 7769 6474 6820 616e 6420 6865  the width and he
-000213b0: 6967 6874 206f 6620 7468 6520 696d 6167  ight of the imag
-000213c0: 6520 696e 2070 6978 656c 732e 0a20 2020  e in pixels..   
-000213d0: 2020 2020 203a 7061 7261 6d20 666c 6f61       :param floa
-000213e0: 7420 7078 5f70 6572 5f6d 6d3a 2050 6978  t px_per_mm: Pix
-000213f0: 656c 7320 7065 7220 6d69 6c6c 696d 6574  els per millimet
-00021400: 6572 2063 6f6e 7665 7273 696f 6e20 6661  er conversion fa
-00021410: 6374 6f72 2e0a 2020 2020 2020 2020 3a72  ctor..        :r
-00021420: 6574 7572 6e20 5475 706c 655b 4469 6374  eturn Tuple[Dict
-00021430: 5b54 7570 6c65 5b69 6e74 2c20 696e 745d  [Tuple[int, int]
-00021440: 2c20 506f 6c79 676f 6e5d 2c20 666c 6f61  , Polygon], floa
-00021450: 745d 3a20 4669 7273 7420 7661 6c75 6520  t]: First value 
-00021460: 6973 2061 2064 6963 7469 6f6e 6172 7920  is a dictionary 
-00021470: 7768 6572 6520 6b65 7973 2061 7265 2028  where keys are (
-00021480: 726f 772c 2063 6f6c 756d 6e29 2069 6e64  row, column) ind
-00021490: 6963 6573 206f 6620 7468 6520 6275 636b  ices of the buck
-000214a0: 6574 2c20 616e 6420 7661 6c75 6573 2061  et, and values a
-000214b0: 7265 2053 6861 7065 6c79 2050 6f6c 7967  re Shapely Polyg
-000214c0: 6f6e 206f 626a 6563 7473 2072 6570 7265  on objects repre
-000214d0: 7365 6e74 696e 6720 7468 6520 636f 7272  senting the corr
-000214e0: 6573 706f 6e64 696e 6720 6865 7861 676f  esponding hexago
-000214f0: 6e20 6275 636b 6574 732e 2053 6563 6f6e  n buckets. Secon
-00021500: 6420 7661 6c75 6520 6973 2074 6865 2061  d value is the a
-00021510: 7370 6563 7420 7261 7469 6f20 6f66 2074  spect ratio of t
-00021520: 6865 2068 6578 6167 6f6e 616c 2067 7269  he hexagonal gri
-00021530: 642e 0a0a 2020 2020 2020 2020 3a65 7861  d...        :exa
-00021540: 6d70 6c65 3a0a 2020 2020 2020 2020 3e3e  mple:.        >>
-00021550: 3e20 706f 6c79 676f 6e73 2c20 6173 7065  > polygons, aspe
-00021560: 6374 5f72 6174 696f 203d 2047 656f 6d65  ct_ratio = Geome
-00021570: 7472 794d 6978 696e 2829 2e62 7563 6b65  tryMixin().bucke
-00021580: 745f 696d 675f 696e 746f 5f67 7269 645f  t_img_into_grid_
-00021590: 6865 7861 676f 6e28 6275 636b 6574 5f73  hexagon(bucket_s
-000215a0: 697a 655f 6d6d 3d31 302c 2069 6d67 5f73  ize_mm=10, img_s
-000215b0: 697a 653d 2838 3030 2c20 3630 3029 2c20  ize=(800, 600), 
-000215c0: 7078 5f70 6572 5f6d 6d3d 352e 302c 2061  px_per_mm=5.0, a
-000215d0: 6464 5f63 6f72 7265 6374 696f 6e3d 5472  dd_correction=Tr
-000215e0: 7565 290a 2020 2020 2020 2020 2222 220a  ue).        """.
-000215f0: 0a20 2020 2020 2020 2074 696d 6572 203d  .        timer =
-00021600: 2053 696d 6261 5469 6d65 7228 7374 6172   SimbaTimer(star
-00021610: 743d 5472 7565 290a 2020 2020 2020 2020  t=True).        
-00021620: 6368 6563 6b5f 666c 6f61 7428 0a20 2020  check_float(.   
-00021630: 2020 2020 2020 2020 206e 616d 653d 6622           name=f"
-00021640: 6275 636b 6574 5f69 6d67 5f69 6e74 6f5f  bucket_img_into_
-00021650: 6772 6964 5f68 6578 6167 6f6e 2062 7563  grid_hexagon buc
-00021660: 6b65 745f 7369 7a65 5f6d 6d22 2c20 7661  ket_size_mm", va
-00021670: 6c75 653d 6275 636b 6574 5f73 697a 655f  lue=bucket_size_
-00021680: 6d6d 0a20 2020 2020 2020 2029 0a20 2020  mm.        ).   
-00021690: 2020 2020 2063 6865 636b 5f69 6e74 280a       check_int(.
-000216a0: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-000216b0: 3d66 2262 7563 6b65 745f 696d 675f 696e  =f"bucket_img_in
-000216c0: 746f 5f67 7269 645f 6865 7861 676f 6e20  to_grid_hexagon 
-000216d0: 696d 675f 7369 7a65 2068 6569 6768 7422  img_size height"
-000216e0: 2c20 7661 6c75 653d 696d 675f 7369 7a65  , value=img_size
-000216f0: 5b30 5d0a 2020 2020 2020 2020 290a 2020  [0].        ).  
-00021700: 2020 2020 2020 6368 6563 6b5f 696e 7428        check_int(
-00021710: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
-00021720: 653d 6622 6275 636b 6574 5f69 6d67 5f69  e=f"bucket_img_i
-00021730: 6e74 6f5f 6772 6964 5f68 6578 6167 6f6e  nto_grid_hexagon
-00021740: 2069 6d67 5f73 697a 6520 7769 6474 6822   img_size width"
-00021750: 2c20 7661 6c75 653d 696d 675f 7369 7a65  , value=img_size
-00021760: 5b31 5d0a 2020 2020 2020 2020 290a 2020  [1].        ).  
-00021770: 2020 2020 2020 6368 6563 6b5f 666c 6f61        check_floa
-00021780: 7428 6e61 6d65 3d66 2262 7563 6b65 745f  t(name=f"bucket_
-00021790: 696d 675f 696e 746f 5f67 7269 645f 6865  img_into_grid_he
-000217a0: 7861 676f 6e20 7078 5f70 6572 5f6d 6d22  xagon px_per_mm"
-000217b0: 2c20 7661 6c75 653d 7078 5f70 6572 5f6d  , value=px_per_m
-000217c0: 6d29 0a0a 2020 2020 2020 2020 7371 7274  m)..        sqrt
-000217d0: 5f33 203d 206d 6174 682e 7371 7274 2833  _3 = math.sqrt(3
-000217e0: 290a 2020 2020 2020 2020 6865 785f 7769  ).        hex_wi
-000217f0: 6474 6820 3d20 3320 2f20 3220 2a20 6275  dth = 3 / 2 * bu
-00021800: 636b 6574 5f73 697a 655f 6d6d 202a 2070  cket_size_mm * p
-00021810: 785f 7065 725f 6d6d 0a20 2020 2020 2020  x_per_mm.       
-00021820: 2068 6578 5f68 6569 6768 7420 3d20 7371   hex_height = sq
-00021830: 7274 5f33 202a 2062 7563 6b65 745f 7369  rt_3 * bucket_si
-00021840: 7a65 5f6d 6d20 2a20 7078 5f70 6572 5f6d  ze_mm * px_per_m
-00021850: 6d0a 0a20 2020 2020 2020 2068 5f68 6578  m..        h_hex
-00021860: 5f63 6e74 2c20 765f 6865 785f 636e 7420  _cnt, v_hex_cnt 
-00021870: 3d20 6469 766d 6f64 2869 6d67 5f73 697a  = divmod(img_siz
-00021880: 655b 305d 2c20 696e 7428 6865 785f 6865  e[0], int(hex_he
-00021890: 6967 6874 2929 2c20 6469 766d 6f64 280a  ight)), divmod(.
-000218a0: 2020 2020 2020 2020 2020 2020 696d 675f              img_
-000218b0: 7369 7a65 5b31 5d2c 2069 6e74 2868 6578  size[1], int(hex
-000218c0: 5f77 6964 7468 290a 2020 2020 2020 2020  _width).        
-000218d0: 290a 2020 2020 2020 2020 6966 2068 5f68  ).        if h_h
-000218e0: 6578 5f63 6e74 5b31 5d20 213d 2030 3a0a  ex_cnt[1] != 0:.
-000218f0: 2020 2020 2020 2020 2020 2020 685f 6865              h_he
-00021900: 785f 636e 7420 3d20 2868 5f68 6578 5f63  x_cnt = (h_hex_c
-00021910: 6e74 5b30 5d20 2b20 312c 2068 5f68 6578  nt[0] + 1, h_hex
-00021920: 5f63 6e74 5b31 5d29 0a20 2020 2020 2020  _cnt[1]).       
-00021930: 2069 6620 765f 6865 785f 636e 745b 315d   if v_hex_cnt[1]
-00021940: 2021 3d20 303a 0a20 2020 2020 2020 2020   != 0:.         
-00021950: 2020 2076 5f68 6578 5f63 6e74 203d 2028     v_hex_cnt = (
-00021960: 765f 6865 785f 636e 745b 305d 202b 2031  v_hex_cnt[0] + 1
-00021970: 2c20 765f 6865 785f 636e 745b 315d 290a  , v_hex_cnt[1]).
-00021980: 0a20 2020 2020 2020 2070 6f6c 7967 6f6e  .        polygon
-00021990: 7320 3d20 7b7d 0a20 2020 2020 2020 2066  s = {}.        f
-000219a0: 6f72 2069 2069 6e20 7261 6e67 6528 685f  or i in range(h_
-000219b0: 6865 785f 636e 745b 305d 293a 0a20 2020  hex_cnt[0]):.   
-000219c0: 2020 2020 2020 2020 2066 6f72 206a 2069           for j i
-000219d0: 6e20 7261 6e67 6528 765f 6865 785f 636e  n range(v_hex_cn
-000219e0: 745b 305d 202b 2028 6920 2520 3229 202a  t[0] + (i % 2) *
-000219f0: 2031 293a 0a20 2020 2020 2020 2020 2020   1):.           
-00021a00: 2020 2020 2078 203d 2069 202a 2033 202f       x = i * 3 /
-00021a10: 2032 202a 2068 6578 5f77 6964 7468 0a20   2 * hex_width. 
-00021a20: 2020 2020 2020 2020 2020 2020 2020 2079                 y
-00021a30: 203d 206a 202a 2073 7172 745f 3320 2a20   = j * sqrt_3 * 
-00021a40: 6865 785f 6865 6967 6874 202b 2028 6920  hex_height + (i 
-00021a50: 2520 3229 202a 2073 7172 745f 3320 2a20  % 2) * sqrt_3 * 
-00021a60: 6865 785f 6865 6967 6874 202f 2032 0a20  hex_height / 2. 
-00021a70: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-00021a80: 6572 7469 6365 7320 3d20 5b5d 0a20 2020  ertices = [].   
-00021a90: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00021aa0: 206b 2069 6e20 7261 6e67 6528 3629 3a0a   k in range(6):.
-00021ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021ac0: 2020 2020 616e 676c 6520 3d20 286d 6174      angle = (mat
-00021ad0: 682e 7069 202f 2033 2920 2a20 6b0a 2020  h.pi / 3) * k.  
-00021ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021af0: 2020 7665 7274 6963 6573 2e61 7070 656e    vertices.appen
-00021b00: 6428 0a20 2020 2020 2020 2020 2020 2020  d(.             
-00021b10: 2020 2020 2020 2020 2020 2028 0a20 2020             (.   
-00021b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021b30: 2020 2020 2020 2020 2078 202b 2068 6578           x + hex
-00021b40: 5f77 6964 7468 202a 206d 6174 682e 636f  _width * math.co
-00021b50: 7328 616e 676c 6529 2c0a 2020 2020 2020  s(angle),.      
-00021b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021b70: 2020 2020 2020 7920 2b20 6865 785f 6865        y + hex_he
-00021b80: 6967 6874 202a 206d 6174 682e 7369 6e28  ight * math.sin(
-00021b90: 616e 676c 6529 2c0a 2020 2020 2020 2020  angle),.        
-00021ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021bb0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00021bc0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00021bd0: 2020 2020 2020 2020 2070 6f6c 7967 6f6e           polygon
-00021be0: 735b 2869 2c20 6a29 5d20 3d20 506f 6c79  s[(i, j)] = Poly
-00021bf0: 676f 6e28 7665 7274 6963 6573 290a 0a20  gon(vertices).. 
-00021c00: 2020 2020 2020 2074 696d 6572 2e73 746f         timer.sto
-00021c10: 705f 7469 6d65 7228 290a 2020 2020 2020  p_timer().      
-00021c20: 2020 7374 646f 7574 5f73 7563 6365 7373    stdout_success
-00021c30: 280a 2020 2020 2020 2020 2020 2020 6d73  (.            ms
-00021c40: 673d 2242 7563 6b65 7420 696d 6167 6520  g="Bucket image 
-00021c50: 696e 746f 2068 6578 6167 6f6e 2067 7269  into hexagon gri
-00021c60: 6420 636f 6d70 6c65 7465 222c 0a20 2020  d complete",.   
-00021c70: 2020 2020 2020 2020 2065 6c61 7073 6564           elapsed
-00021c80: 5f74 696d 653d 7469 6d65 722e 656c 6170  _time=timer.elap
-00021c90: 7365 645f 7469 6d65 5f73 7472 2c0a 2020  sed_time_str,.  
-00021ca0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00021cb0: 7265 7475 726e 2070 6f6c 7967 6f6e 732c  return polygons,
-00021cc0: 2072 6f75 6e64 2828 765f 6865 785f 636e   round((v_hex_cn
-00021cd0: 745b 305d 202f 2068 5f68 6578 5f63 6e74  t[0] / h_hex_cnt
-00021ce0: 5b30 5d29 2c20 3329 0a0a 2020 2020 4073  [0]), 3)..    @s
-00021cf0: 7461 7469 636d 6574 686f 640a 2020 2020  taticmethod.    
-00021d00: 6465 6620 5f63 756d 7375 6d5f 636f 6f72  def _cumsum_coor
-00021d10: 645f 6765 6f6d 6574 7269 6573 5f68 656c  d_geometries_hel
-00021d20: 7065 7228 0a20 2020 2020 2020 2064 6174  per(.        dat
-00021d30: 613a 206e 702e 6e64 6172 7261 792c 2067  a: np.ndarray, g
-00021d40: 656f 6d65 7472 6965 733a 2044 6963 745b  eometries: Dict[
-00021d50: 5475 706c 655b 696e 742c 2069 6e74 5d2c  Tuple[int, int],
-00021d60: 2050 6f6c 7967 6f6e 5d2c 2076 6572 626f   Polygon], verbo
-00021d70: 7365 3a20 626f 6f6c 0a20 2020 2029 3a0a  se: bool.    ):.
-00021d80: 2020 2020 2020 2020 6461 7461 5f70 6f69          data_poi
-00021d90: 6e74 203d 2050 6f69 6e74 2864 6174 615b  nt = Point(data[
-00021da0: 313a 5d29 0a20 2020 2020 2020 2069 6620  1:]).        if 
-00021db0: 7665 7262 6f73 653a 0a20 2020 2020 2020  verbose:.       
-00021dc0: 2020 2020 2070 7269 6e74 2866 2250 726f       print(f"Pro
-00021dd0: 6365 7373 696e 6720 616e 696d 616c 2067  cessing animal g
-00021de0: 7269 6420 7371 7561 7265 206c 6f63 6174  rid square locat
-00021df0: 696f 6e20 696e 2066 7261 6d65 207b 696e  ion in frame {in
-00021e00: 7428 6461 7461 5b30 5d29 7d2e 2e2e 2229  t(data[0])}...")
-00021e10: 0a20 2020 2020 2020 2066 6f72 206b 2c20  .        for k, 
-00021e20: 7220 696e 2067 656f 6d65 7472 6965 732e  r in geometries.
-00021e30: 6974 656d 7328 293a 0a20 2020 2020 2020  items():.       
-00021e40: 2020 2020 2069 6620 722e 636f 6e74 6169       if r.contai
-00021e50: 6e73 2864 6174 615f 706f 696e 7429 3a0a  ns(data_point):.
-00021e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021e70: 7265 7475 726e 2028 696e 7428 6461 7461  return (int(data
-00021e80: 5b30 5d29 2c20 6b5b 305d 2c20 6b5b 315d  [0]), k[0], k[1]
-00021e90: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00021ea0: 2028 696e 7428 6461 7461 5b30 5d29 2c20   (int(data[0]), 
-00021eb0: 2d31 2c20 2d31 290a 0a20 2020 2064 6566  -1, -1)..    def
-00021ec0: 2063 756d 7375 6d5f 636f 6f72 645f 6765   cumsum_coord_ge
-00021ed0: 6f6d 6574 7269 6573 280a 2020 2020 2020  ometries(.      
-00021ee0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00021ef0: 6461 7461 3a20 6e70 2e6e 6461 7272 6179  data: np.ndarray
-00021f00: 2c0a 2020 2020 2020 2020 6765 6f6d 6574  ,.        geomet
-00021f10: 7269 6573 3a20 4469 6374 5b54 7570 6c65  ries: Dict[Tuple
-00021f20: 5b69 6e74 2c20 696e 745d 2c20 506f 6c79  [int, int], Poly
-00021f30: 676f 6e5d 2c0a 2020 2020 2020 2020 6670  gon],.        fp
-00021f40: 733a 204f 7074 696f 6e61 6c5b 696e 745d  s: Optional[int]
-00021f50: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00021f60: 2063 6f72 655f 636e 743a 204f 7074 696f   core_cnt: Optio
-00021f70: 6e61 6c5b 696e 745d 203d 202d 312c 0a20  nal[int] = -1,. 
-00021f80: 2020 2020 2020 2076 6572 626f 7365 3a20         verbose: 
-00021f90: 4f70 7469 6f6e 616c 5b62 6f6f 6c5d 203d  Optional[bool] =
-00021fa0: 2054 7275 652c 0a20 2020 2029 3a0a 2020   True,.    ):.  
-00021fb0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00021fc0: 2020 436f 6d70 7574 6520 7468 6520 6375    Compute the cu
-00021fd0: 6d75 6c61 7469 7665 2074 696d 6520 6120  mulative time a 
-00021fe0: 626f 6479 2d70 6172 7420 6861 7320 7370  body-part has sp
-00021ff0: 656e 7420 696e 7369 6465 2061 2067 7269  ent inside a gri
-00022000: 6420 6f66 2067 656f 6d65 7472 6965 7320  d of geometries 
-00022010: 7573 696e 6720 6d75 6c74 6970 726f 6365  using multiproce
-00022020: 7373 696e 672e 0a0a 2020 2020 2020 2020  ssing...        
-00022030: 3a70 6172 616d 206e 702e 6e64 6172 7261  :param np.ndarra
-00022040: 7920 6461 7461 3a20 496e 7075 7420 6461  y data: Input da
-00022050: 7461 2061 7272 6179 2077 6865 7265 2072  ta array where r
-00022060: 6f77 7320 7265 7072 6573 656e 7420 6672  ows represent fr
-00022070: 616d 6573 2061 6e64 2063 6f6c 756d 6e73  ames and columns
-00022080: 2072 6570 7265 7365 6e74 2062 6f64 792d   represent body-
-00022090: 7061 7274 2078 2061 6e64 2079 2063 6f6f  part x and y coo
-000220a0: 7264 696e 6174 6573 2e0a 2020 2020 2020  rdinates..      
-000220b0: 2020 3a70 6172 616d 2044 6963 745b 5475    :param Dict[Tu
-000220c0: 706c 655b 696e 742c 2069 6e74 5d2c 2050  ple[int, int], P
-000220d0: 6f6c 7967 6f6e 5d20 6765 6f6d 6574 7269  olygon] geometri
-000220e0: 6573 3a20 4469 6374 696f 6e61 7279 206f  es: Dictionary o
-000220f0: 6620 706f 6c79 676f 6e73 2072 6570 7265  f polygons repre
-00022100: 7365 6e74 696e 6720 7370 6174 6961 6c20  senting spatial 
-00022110: 7265 6769 6f6e 732e 2043 7265 6174 6564  regions. Created
-00022120: 2062 7920 6060 4765 6f6d 6574 7279 4d69   by ``GeometryMi
-00022130: 7869 6e2e 6275 636b 6574 5f69 6d67 5f69  xin.bucket_img_i
-00022140: 6e74 6f5f 7371 7561 7265 7360 602e 0a20  nto_squares``.. 
-00022150: 2020 2020 2020 203a 7061 7261 6d20 4f70         :param Op
-00022160: 7469 6f6e 616c 5b69 6e74 5d20 6670 733a  tional[int] fps:
-00022170: 2046 7261 6d65 7320 7065 7220 7365 636f   Frames per seco
-00022180: 6e64 2028 6670 7329 2066 6f72 2074 696d  nd (fps) for tim
-00022190: 6520 6e6f 726d 616c 697a 6174 696f 6e2e  e normalization.
-000221a0: 2049 6620 4e6f 6e65 2c20 6375 6d75 6c61   If None, cumula
-000221b0: 7469 7665 2073 756d 206f 6620 6672 616d  tive sum of fram
-000221c0: 6520 636f 756e 7420 6973 2072 6574 7572  e count is retur
-000221d0: 6e65 642e 0a0a 2020 2020 2020 2020 3a65  ned...        :e
-000221e0: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
-000221f0: 3e3e 3e20 696d 675f 6765 6f6d 6574 7269  >>> img_geometri
-00022200: 6573 203d 2047 656f 6d65 7472 794d 6978  es = GeometryMix
-00022210: 696e 2e62 7563 6b65 745f 696d 675f 696e  in.bucket_img_in
-00022220: 746f 5f67 7269 645f 7371 7561 7265 2869  to_grid_square(i
-00022230: 6d67 5f73 697a 653d 2836 3430 2c20 3634  mg_size=(640, 64
-00022240: 3029 2c20 6275 636b 6574 5f67 7269 645f  0), bucket_grid_
-00022250: 7369 7a65 3d28 3130 2c20 3130 292c 2070  size=(10, 10), p
-00022260: 785f 7065 725f 6d6d 3d31 290a 2020 2020  x_per_mm=1).    
-00022270: 2020 2020 3e3e 3e20 6270 5f61 7272 203d      >>> bp_arr =
-00022280: 206e 702e 7261 6e64 6f6d 2e72 616e 6469   np.random.randi
-00022290: 6e74 2830 2c20 3634 302c 2028 3530 3030  nt(0, 640, (5000
-000222a0: 2c20 3229 290a 2020 2020 2020 2020 3e3e  , 2)).        >>
-000222b0: 3e20 6765 6f5f 6461 7461 203d 2047 656f  > geo_data = Geo
-000222c0: 6d65 7472 794d 6978 696e 2829 2e63 756d  metryMixin().cum
-000222d0: 7375 6d5f 636f 6f72 645f 6765 6f6d 6574  sum_coord_geomet
-000222e0: 7269 6573 2864 6174 613d 6270 5f61 7272  ries(data=bp_arr
-000222f0: 2c20 6765 6f6d 6574 7269 6573 3d69 6d67  , geometries=img
-00022300: 5f67 656f 6d65 7472 6965 735b 305d 2c20  _geometries[0], 
-00022310: 7665 7262 6f73 653d 4661 6c73 652c 2066  verbose=False, f
-00022320: 7073 3d31 290a 2020 2020 2020 2020 2222  ps=1).        ""
-00022330: 220a 0a20 2020 2020 2020 2074 696d 6572  "..        timer
-00022340: 203d 2053 696d 6261 5469 6d65 7228 7374   = SimbaTimer(st
-00022350: 6172 743d 5472 7565 290a 2020 2020 2020  art=True).      
-00022360: 2020 6368 6563 6b5f 696e 7374 616e 6365    check_instance
-00022370: 280a 2020 2020 2020 2020 2020 2020 736f  (.            so
-00022380: 7572 6365 3d66 227b 7365 6c66 2e5f 5f63  urce=f"{self.__c
-00022390: 6c61 7373 5f5f 2e5f 5f6e 616d 655f 5f7d  lass__.__name__}
-000223a0: 2064 6174 6122 2c0a 2020 2020 2020 2020   data",.        
-000223b0: 2020 2020 696e 7374 616e 6365 3d64 6174      instance=dat
-000223c0: 612c 0a20 2020 2020 2020 2020 2020 2061  a,.            a
-000223d0: 6363 6570 7465 645f 7479 7065 733d 6e70  ccepted_types=np
-000223e0: 2e6e 6461 7272 6179 2c0a 2020 2020 2020  .ndarray,.      
-000223f0: 2020 290a 2020 2020 2020 2020 6966 2028    ).        if (
-00022400: 6461 7461 2e73 6861 7065 5b31 5d20 213d  data.shape[1] !=
-00022410: 2032 2920 6f72 2028 6461 7461 2e6e 6469   2) or (data.ndi
-00022420: 6d20 213d 2032 293a 0a20 2020 2020 2020  m != 2):.       
-00022430: 2020 2020 2072 6169 7365 2043 6f75 6e74       raise Count
-00022440: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-00022450: 2020 2020 2020 206d 7367 3d66 2241 204e         msg=f"A N
-00022460: 2078 2032 2061 7272 6179 2069 7320 7265   x 2 array is re
-00022470: 7175 6972 6564 2028 676f 7420 7b64 6174  quired (got {dat
-00022480: 612e 7368 6170 657d 2922 2c0a 2020 2020  a.shape})",.    
-00022490: 2020 2020 2020 2020 2020 2020 736f 7572              sour
-000224a0: 6365 3d73 656c 662e 5f5f 636c 6173 735f  ce=self.__class_
-000224b0: 5f2e 5f5f 6e61 6d65 5f5f 2c0a 2020 2020  _.__name__,.    
-000224c0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-000224d0: 2020 6966 2066 7073 2069 7320 6e6f 7420    if fps is not 
-000224e0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-000224f0: 2020 6368 6563 6b5f 696e 7428 6e61 6d65    check_int(name
-00022500: 3d22 6670 7322 2c20 7661 6c75 653d 6670  ="fps", value=fp
-00022510: 732c 206d 696e 5f76 616c 7565 3d31 290a  s, min_value=1).
-00022520: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00022530: 2020 2020 2020 2020 2020 6670 7320 3d20            fps = 
-00022540: 310a 2020 2020 2020 2020 6368 6563 6b5f  1.        check_
-00022550: 696e 7428 6e61 6d65 3d22 636f 7265 5f63  int(name="core_c
-00022560: 6e74 222c 2076 616c 7565 3d63 6f72 655f  nt", value=core_
-00022570: 636e 742c 206d 696e 5f76 616c 7565 3d2d  cnt, min_value=-
-00022580: 3129 0a20 2020 2020 2020 2069 6620 636f  1).        if co
-00022590: 7265 5f63 6e74 203d 3d20 2d31 3a0a 2020  re_cnt == -1:.  
-000225a0: 2020 2020 2020 2020 2020 636f 7265 5f63            core_c
-000225b0: 6e74 203d 2066 696e 645f 636f 7265 5f63  nt = find_core_c
-000225c0: 6e74 2829 5b30 5d0a 2020 2020 2020 2020  nt()[0].        
-000225d0: 772c 2068 203d 2030 2c20 300a 2020 2020  w, h = 0, 0.    
-000225e0: 2020 2020 666f 7220 6b20 696e 2067 656f      for k in geo
-000225f0: 6d65 7472 6965 732e 6b65 7973 2829 3a0a  metries.keys():.
-00022600: 2020 2020 2020 2020 2020 2020 772c 2068              w, h
-00022610: 203d 206d 6178 2877 2c20 6b5b 305d 292c   = max(w, k[0]),
-00022620: 206d 6178 2868 2c20 6b5b 315d 290a 2020   max(h, k[1]).  
-00022630: 2020 2020 2020 6672 6d5f 6964 203d 206e        frm_id = n
-00022640: 702e 6172 616e 6765 2830 2c20 6461 7461  p.arange(0, data
-00022650: 2e73 6861 7065 5b30 5d29 2e72 6573 6861  .shape[0]).resha
-00022660: 7065 282d 312c 2031 290a 2020 2020 2020  pe(-1, 1).      
-00022670: 2020 6461 7461 203d 206e 702e 6873 7461    data = np.hsta
-00022680: 636b 2828 6672 6d5f 6964 2c20 6461 7461  ck((frm_id, data
-00022690: 2929 0a20 2020 2020 2020 2069 6d67 5f61  )).        img_a
-000226a0: 7272 203d 206e 702e 7a65 726f 7328 2864  rr = np.zeros((d
-000226b0: 6174 612e 7368 6170 655b 305d 2c20 6820  ata.shape[0], h 
-000226c0: 2b20 312c 2077 202b 2031 2929 0a20 2020  + 1, w + 1)).   
-000226d0: 2020 2020 2077 6974 6820 6d75 6c74 6970       with multip
-000226e0: 726f 6365 7373 696e 672e 506f 6f6c 280a  rocessing.Pool(.
-000226f0: 2020 2020 2020 2020 2020 2020 636f 7265              core
-00022700: 5f63 6e74 2c20 6d61 7874 6173 6b73 7065  _cnt, maxtaskspe
-00022710: 7263 6869 6c64 3d44 6566 6175 6c74 732e  rchild=Defaults.
-00022720: 4c41 5247 455f 4d41 585f 5441 534b 5f50  LARGE_MAX_TASK_P
-00022730: 4552 5f43 4849 4c44 2e76 616c 7565 0a20  ER_CHILD.value. 
-00022740: 2020 2020 2020 2029 2061 7320 706f 6f6c         ) as pool
-00022750: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
-00022760: 6e73 7461 6e74 7320 3d20 6675 6e63 746f  nstants = functo
-00022770: 6f6c 732e 7061 7274 6961 6c28 0a20 2020  ols.partial(.   
-00022780: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00022790: 662e 5f63 756d 7375 6d5f 636f 6f72 645f  f._cumsum_coord_
-000227a0: 6765 6f6d 6574 7269 6573 5f68 656c 7065  geometries_helpe
-000227b0: 722c 0a20 2020 2020 2020 2020 2020 2020  r,.             
-000227c0: 2020 2067 656f 6d65 7472 6965 733d 6765     geometries=ge
-000227d0: 6f6d 6574 7269 6573 2c0a 2020 2020 2020  ometries,.      
-000227e0: 2020 2020 2020 2020 2020 7665 7262 6f73            verbos
-000227f0: 653d 7665 7262 6f73 652c 0a20 2020 2020  e=verbose,.     
-00022800: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00022810: 2020 2020 2066 6f72 2063 6e74 2c20 7265       for cnt, re
-00022820: 7375 6c74 2069 6e20 656e 756d 6572 6174  sult in enumerat
-00022830: 6528 706f 6f6c 2e69 6d61 7028 636f 6e73  e(pool.imap(cons
-00022840: 7461 6e74 732c 2064 6174 612c 2063 6875  tants, data, chu
-00022850: 6e6b 7369 7a65 3d31 2929 3a0a 2020 2020  nksize=1)):.    
-00022860: 2020 2020 2020 2020 2020 2020 6966 2072              if r
-00022870: 6573 756c 745b 315d 2021 3d20 2d31 3a0a  esult[1] != -1:.
-00022880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022890: 2020 2020 696d 675f 6172 725b 7265 7375      img_arr[resu
-000228a0: 6c74 5b30 5d2c 2072 6573 756c 745b 325d  lt[0], result[2]
-000228b0: 202d 2031 2c20 7265 7375 6c74 5b31 5d20   - 1, result[1] 
-000228c0: 2d20 315d 203d 2031 0a20 2020 2020 2020  - 1] = 1.       
-000228d0: 2070 6f6f 6c2e 6a6f 696e 2829 0a20 2020   pool.join().   
-000228e0: 2020 2020 2070 6f6f 6c2e 7465 726d 696e       pool.termin
-000228f0: 6174 6528 290a 2020 2020 2020 2020 7469  ate().        ti
-00022900: 6d65 722e 7374 6f70 5f74 696d 6572 2829  mer.stop_timer()
-00022910: 0a20 2020 2020 2020 2073 7464 6f75 745f  .        stdout_
-00022920: 7375 6363 6573 7328 0a20 2020 2020 2020  success(.       
-00022930: 2020 2020 206d 7367 3d22 4375 6d75 6c61       msg="Cumula
-00022940: 7469 7665 2063 6f6f 7264 696e 6174 6573  tive coordinates
-00022950: 2069 6e20 6765 6f6d 6574 7269 6573 2063   in geometries c
-00022960: 6f6d 706c 6574 6522 2c0a 2020 2020 2020  omplete",.      
-00022970: 2020 2020 2020 656c 6170 7365 645f 7469        elapsed_ti
-00022980: 6d65 3d74 696d 6572 2e65 6c61 7073 6564  me=timer.elapsed
-00022990: 5f74 696d 655f 7374 722c 0a20 2020 2020  _time_str,.     
-000229a0: 2020 2029 0a20 2020 2020 2020 2069 6620     ).        if 
-000229b0: 6670 7320 6973 204e 6f6e 653a 0a20 2020  fps is None:.   
-000229c0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-000229d0: 6e70 2e63 756d 7375 6d28 696d 675f 6172  np.cumsum(img_ar
-000229e0: 722c 2061 7869 733d 3029 0a20 2020 2020  r, axis=0).     
-000229f0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00022a00: 2020 2020 2072 6574 7572 6e20 6e70 2e63       return np.c
-00022a10: 756d 7375 6d28 696d 675f 6172 722c 2061  umsum(img_arr, a
-00022a20: 7869 733d 3029 202f 2066 7073 0a0a 2020  xis=0) / fps..  
-00022a30: 2020 4073 7461 7469 636d 6574 686f 640a    @staticmethod.
-00022a40: 2020 2020 6465 6620 5f63 756d 7375 6d5f      def _cumsum_
-00022a50: 626f 6f6c 5f68 656c 7065 7228 0a20 2020  bool_helper(.   
-00022a60: 2020 2020 2064 6174 613a 206e 702e 6e64       data: np.nd
-00022a70: 6172 7261 792c 2067 656f 6d65 7472 6965  array, geometrie
-00022a80: 733a 2044 6963 745b 5475 706c 655b 696e  s: Dict[Tuple[in
-00022a90: 742c 2069 6e74 5d2c 2050 6f6c 7967 6f6e  t, int], Polygon
-00022aa0: 5d0a 2020 2020 293a 0a20 2020 2020 2020  ].    ):.       
-00022ab0: 2064 6174 615f 706f 696e 7420 3d20 506f   data_point = Po
-00022ac0: 696e 7428 6461 7461 5b31 3a33 5d29 0a20  int(data[1:3]). 
-00022ad0: 2020 2020 2020 2070 7269 6e74 280a 2020         print(.  
-00022ae0: 2020 2020 2020 2020 2020 6622 5072 6f63            f"Proc
-00022af0: 6573 7369 6e67 2061 6e69 6d61 6c20 6772  essing animal gr
-00022b00: 6964 2073 7175 6172 6520 6c6f 6361 7469  id square locati
-00022b10: 6f6e 2066 6f72 2062 6f6f 6c65 616e 2069  on for boolean i
-00022b20: 6e20 6672 616d 6520 7b69 6e74 2864 6174  n frame {int(dat
-00022b30: 615b 305d 297d 2e2e 2e22 0a20 2020 2020  a[0])}...".     
-00022b40: 2020 2029 0a20 2020 2020 2020 2066 6f72     ).        for
-00022b50: 206b 2c20 7220 696e 2067 656f 6d65 7472   k, r in geometr
-00022b60: 6965 732e 6974 656d 7328 293a 0a20 2020  ies.items():.   
-00022b70: 2020 2020 2020 2020 2069 6620 722e 636f           if r.co
-00022b80: 6e74 6169 6e73 2864 6174 615f 706f 696e  ntains(data_poin
-00022b90: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
-00022ba0: 2020 2020 7265 7475 726e 2028 696e 7428      return (int(
-00022bb0: 6461 7461 5b30 5d29 2c20 6b5b 305d 2c20  data[0]), k[0], 
-00022bc0: 6b5b 315d 290a 2020 2020 2020 2020 7265  k[1]).        re
-00022bd0: 7475 726e 2028 696e 7428 6461 7461 5b30  turn (int(data[0
-00022be0: 5d29 2c20 2d31 2c20 2d31 290a 0a20 2020  ]), -1, -1)..   
-00022bf0: 2064 6566 2063 756d 7375 6d5f 626f 6f6c   def cumsum_bool
-00022c00: 5f67 656f 6d65 7472 6965 7328 0a20 2020  _geometries(.   
-00022c10: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00022c20: 2020 2064 6174 613a 206e 702e 6e64 6172     data: np.ndar
-00022c30: 7261 792c 0a20 2020 2020 2020 2067 656f  ray,.        geo
-00022c40: 6d65 7472 6965 733a 2044 6963 745b 5475  metries: Dict[Tu
-00022c50: 706c 655b 696e 742c 2069 6e74 5d2c 2050  ple[int, int], P
-00022c60: 6f6c 7967 6f6e 5d2c 0a20 2020 2020 2020  olygon],.       
-00022c70: 2062 6f6f 6c5f 6461 7461 3a20 6e70 2e6e   bool_data: np.n
-00022c80: 6461 7272 6179 2c0a 2020 2020 2020 2020  darray,.        
-00022c90: 6670 733a 204f 7074 696f 6e61 6c5b 666c  fps: Optional[fl
-00022ca0: 6f61 745d 203d 204e 6f6e 652c 0a20 2020  oat] = None,.   
-00022cb0: 2020 2020 2063 6f72 655f 636e 743a 204f       core_cnt: O
-00022cc0: 7074 696f 6e61 6c5b 696e 745d 203d 202d  ptional[int] = -
-00022cd0: 312c 0a20 2020 2029 202d 3e20 6e70 2e6e  1,.    ) -> np.n
-00022ce0: 6461 7272 6179 3a0a 2020 2020 2020 2020  darray:.        
-00022cf0: 2222 220a 2020 2020 2020 2020 436f 6d70  """.        Comp
-00022d00: 7574 6520 7468 6520 6375 6d75 6c61 7469  ute the cumulati
-00022d10: 7665 2073 756d 7320 6f66 2062 6f6f 6c65  ve sums of boole
-00022d20: 616e 2065 7665 6e74 7320 7769 7468 696e  an events within
-00022d30: 2070 6f6c 7967 6f6e 2067 656f 6d65 7472   polygon geometr
-00022d40: 6965 7320 6f76 6572 2074 696d 6520 7573  ies over time us
-00022d50: 696e 6720 6d75 6c74 6970 726f 6365 7373  ing multiprocess
-00022d60: 696e 672e 0a0a 2020 2020 2020 2020 452e  ing...        E.
-00022d70: 672e 2c20 636f 6d70 7574 6520 7468 6520  g., compute the 
-00022d80: 6375 6d75 6c61 7469 7665 2074 696d 6520  cumulative time 
-00022d90: 6f66 2063 6c61 7373 6966 6965 6420 6576  of classified ev
-00022da0: 656e 7473 2077 6974 6869 6e20 7370 6174  ents within spat
-00022db0: 6961 6c20 6c6f 6361 7469 6f6e 7320 6174  ial locations at
-00022dc0: 2061 6c6c 2074 696d 652d 706f 696e 7473   all time-points
-00022dd0: 206f 6620 7468 6520 7669 6465 6f2e 0a0a   of the video...
-00022de0: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
-00022df0: 702e 6e64 6172 7261 7920 6461 7461 3a20  p.ndarray data: 
-00022e00: 4172 7261 7920 636f 6e74 6169 6e69 6e67  Array containing
-00022e10: 2073 7061 7469 616c 2064 6174 6120 7769   spatial data wi
-00022e20: 7468 2073 6861 7065 2028 6e2c 2032 292e  th shape (n, 2).
-00022e30: 2045 2e67 2e2c 2032 442d 6172 7261 7920   E.g., 2D-array 
-00022e40: 7769 7468 2062 6f64 792d 7061 7274 2063  with body-part c
-00022e50: 6f6f 7264 696e 6174 6573 2e0a 2020 2020  oordinates..    
-00022e60: 2020 2020 3a70 6172 616d 2044 6963 745b      :param Dict[
-00022e70: 5475 706c 655b 696e 742c 2069 6e74 5d2c  Tuple[int, int],
-00022e80: 2050 6f6c 7967 6f6e 5d20 6765 6f6d 6574   Polygon] geomet
-00022e90: 7269 6573 3a20 4469 6374 696f 6e61 7279  ries: Dictionary
-00022ea0: 206f 6620 706f 6c79 676f 6e73 2072 6570   of polygons rep
-00022eb0: 7265 7365 6e74 696e 6720 7370 6174 6961  resenting spatia
-00022ec0: 6c20 7265 6769 6f6e 732e 2043 7265 6174  l regions. Creat
-00022ed0: 6564 2062 7920 6060 4765 6f6d 6574 7279  ed by ``Geometry
-00022ee0: 4d69 7869 6e2e 6275 636b 6574 5f69 6d67  Mixin.bucket_img
-00022ef0: 5f69 6e74 6f5f 7371 7561 7265 7360 602e  _into_squares``.
-00022f00: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00022f10: 6e70 2e6e 6461 7272 6179 2062 6f6f 6c5f  np.ndarray bool_
-00022f20: 6461 7461 3a20 426f 6f6c 6561 6e20 6172  data: Boolean ar
-00022f30: 7261 7920 7769 7468 2073 6861 7065 2028  ray with shape (
-00022f40: 6461 7461 2e73 6861 7065 5b30 5d2c 2920  data.shape[0],) 
-00022f50: 6f72 2028 6461 7461 2e73 6861 7065 5b30  or (data.shape[0
-00022f60: 5d2c 2031 2920 696e 6469 6361 7469 6e67  ], 1) indicating
-00022f70: 2074 6865 2070 7265 7365 6e63 6520 6f72   the presence or
-00022f80: 2061 6273 656e 6365 2069 6e20 6561 6368   absence in each
-00022f90: 2066 7261 6d65 2e0a 2020 2020 2020 2020   frame..        
-00022fa0: 3a70 6172 616d 204f 7074 696f 6e61 6c5b  :param Optional[
-00022fb0: 666c 6f61 745d 2066 7073 3a20 4672 616d  float] fps: Fram
-00022fc0: 6573 2070 6572 2073 6563 6f6e 642e 2049  es per second. I
-00022fd0: 6620 7072 6f76 6964 6564 2c20 7468 6520  f provided, the 
-00022fe0: 7265 7375 6c74 2069 7320 6e6f 726d 616c  result is normal
-00022ff0: 697a 6564 2062 7920 7468 6520 6672 616d  ized by the fram
-00023000: 6520 7261 7465 2e0a 2020 2020 2020 2020  e rate..        
-00023010: 3a70 6172 616d 204f 7074 696f 6e61 6c5b  :param Optional[
-00023020: 666c 6f61 745d 2063 6f72 655f 636e 743a  float] core_cnt:
-00023030: 204e 756d 6265 7220 6f66 2043 5055 2063   Number of CPU c
-00023040: 6f72 6573 2074 6f20 7573 6520 666f 7220  ores to use for 
-00023050: 7061 7261 6c6c 656c 2070 726f 6365 7373  parallel process
-00023060: 696e 672e 2044 6566 6175 6c74 2069 7320  ing. Default is 
-00023070: 2d31 2c20 7768 6963 6820 6d65 616e 7320  -1, which means 
-00023080: 7573 696e 6720 616c 6c20 6176 6169 6c61  using all availa
-00023090: 626c 6520 636f 7265 732e 0a20 2020 2020  ble cores..     
-000230a0: 2020 203a 7265 7475 726e 7320 6e70 2e6e     :returns np.n
-000230b0: 6461 7272 6179 3a20 4172 7261 7920 6f66  darray: Array of
-000230c0: 2073 697a 6520 2866 7261 6d65 7320 7820   size (frames x 
-000230d0: 686f 7269 7a6f 6e74 616c 2062 696e 7320  horizontal bins 
-000230e0: 7820 7665 7269 6361 6c20 6269 6e73 2920  x verical bins) 
-000230f0: 7769 7468 2074 696d 6573 2069 6e20 7365  with times in se
-00023100: 636f 6e64 7320 2869 6620 6670 7320 7061  conds (if fps pa
-00023110: 7373 6564 2920 6f72 2066 7261 6d65 7320  ssed) or frames 
-00023120: 2869 6620 6670 7320 6e6f 7420 7061 7373  (if fps not pass
-00023130: 6564 290a 0a20 2020 2020 2020 203a 6578  ed)..        :ex
-00023140: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
-00023150: 3e3e 2067 656f 6d65 7472 6965 7320 3d20  >> geometries = 
-00023160: 4765 6f6d 6574 7279 4d69 7869 6e2e 6275  GeometryMixin.bu
-00023170: 636b 6574 5f69 6d67 5f69 6e74 6f5f 6772  cket_img_into_gr
-00023180: 6964 5f73 7175 6172 6528 6275 636b 6574  id_square(bucket
-00023190: 5f73 697a 655f 6d6d 3d35 302c 2069 6d67  _size_mm=50, img
-000231a0: 5f73 697a 653d 2838 3030 2c20 3830 3029  _size=(800, 800)
-000231b0: 202c 2070 785f 7065 725f 6d6d 3d35 2e30   , px_per_mm=5.0
-000231c0: 295b 305d 0a20 2020 2020 2020 203e 3e3e  )[0].        >>>
-000231d0: 2063 6f6f 7264 5f64 6174 6120 3d20 6e70   coord_data = np
-000231e0: 2e72 616e 646f 6d2e 7261 6e64 696e 7428  .random.randint(
-000231f0: 302c 2038 3030 2c20 2835 3030 2c20 3229  0, 800, (500, 2)
-00023200: 290a 2020 2020 2020 2020 3e3e 3e20 626f  ).        >>> bo
-00023210: 6f6c 5f64 6174 6120 3d20 6e70 2e72 616e  ol_data = np.ran
-00023220: 646f 6d2e 7261 6e64 696e 7428 302c 2032  dom.randint(0, 2
-00023230: 2c20 2835 3030 2c29 290a 2020 2020 2020  , (500,)).      
-00023240: 2020 3e3e 3e20 7820 3d20 4765 6f6d 6574    >>> x = Geomet
-00023250: 7279 4d69 7869 6e28 292e 6375 6d73 756d  ryMixin().cumsum
-00023260: 5f62 6f6f 6c5f 6765 6f6d 6574 7269 6573  _bool_geometries
-00023270: 2864 6174 613d 636f 6f72 645f 6461 7461  (data=coord_data
-00023280: 2c20 6765 6f6d 6574 7269 6573 3d67 656f  , geometries=geo
-00023290: 6d65 7472 6965 732c 2062 6f6f 6c5f 6461  metries, bool_da
-000232a0: 7461 3d62 6f6f 6c5f 6461 7461 2c20 6670  ta=bool_data, fp
-000232b0: 733d 3135 290a 2020 2020 2020 2020 3e3e  s=15).        >>
-000232c0: 3e20 782e 7368 6170 650a 2020 2020 2020  > x.shape.      
-000232d0: 2020 3e3e 3e20 2835 3030 2c20 342c 2034    >>> (500, 4, 4
-000232e0: 290a 2020 2020 2020 2020 2222 220a 0a20  ).        """.. 
-000232f0: 2020 2020 2020 2063 6865 636b 5f76 616c         check_val
-00023300: 6964 5f61 7272 6179 280a 2020 2020 2020  id_array(.      
-00023310: 2020 2020 2020 6461 7461 3d64 6174 612c        data=data,
-00023320: 0a20 2020 2020 2020 2020 2020 2061 6363  .            acc
-00023330: 6570 7465 645f 7369 7a65 733d 5b32 5d2c  epted_sizes=[2],
-00023340: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
-00023350: 7263 653d 6622 7b47 656f 6d65 7472 794d  rce=f"{GeometryM
-00023360: 6978 696e 2e63 756d 7375 6d5f 626f 6f6c  ixin.cumsum_bool
-00023370: 5f67 656f 6d65 7472 6965 732e 5f5f 6e61  _geometries.__na
-00023380: 6d65 5f5f 7d20 6461 7461 222c 0a20 2020  me__} data",.   
-00023390: 2020 2020 2029 0a20 2020 2020 2020 2063       ).        c
-000233a0: 6865 636b 5f69 6e73 7461 6e63 6528 0a20  heck_instance(. 
-000233b0: 2020 2020 2020 2020 2020 2073 6f75 7263             sourc
-000233c0: 653d 6622 7b47 656f 6d65 7472 794d 6978  e=f"{GeometryMix
-000233d0: 696e 2e63 756d 7375 6d5f 626f 6f6c 5f67  in.cumsum_bool_g
-000233e0: 656f 6d65 7472 6965 732e 5f5f 6e61 6d65  eometries.__name
-000233f0: 5f5f 7d20 6765 6f6d 6574 7269 6573 222c  __} geometries",
-00023400: 0a20 2020 2020 2020 2020 2020 2069 6e73  .            ins
-00023410: 7461 6e63 653d 6765 6f6d 6574 7269 6573  tance=geometries
-00023420: 2c0a 2020 2020 2020 2020 2020 2020 6163  ,.            ac
-00023430: 6365 7074 6564 5f74 7970 6573 3d64 6963  cepted_types=dic
-00023440: 742c 0a20 2020 2020 2020 2029 0a20 2020  t,.        ).   
-00023450: 2020 2020 2063 6865 636b 5f76 616c 6964       check_valid
-00023460: 5f61 7272 6179 280a 2020 2020 2020 2020  _array(.        
-00023470: 2020 2020 6461 7461 3d62 6f6f 6c5f 6461      data=bool_da
-00023480: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
-00023490: 6163 6365 7074 6564 5f73 6861 7065 733d  accepted_shapes=
-000234a0: 5b28 6461 7461 2e73 6861 7065 5b30 5d2c  [(data.shape[0],
-000234b0: 2031 292c 2028 6461 7461 2e73 6861 7065   1), (data.shape
-000234c0: 5b30 5d2c 295d 2c0a 2020 2020 2020 2020  [0],)],.        
-000234d0: 2020 2020 736f 7572 6365 3d66 227b 4765      source=f"{Ge
-000234e0: 6f6d 6574 7279 4d69 7869 6e2e 6375 6d73  ometryMixin.cums
-000234f0: 756d 5f62 6f6f 6c5f 6765 6f6d 6574 7269  um_bool_geometri
-00023500: 6573 2e5f 5f6e 616d 655f 5f7d 2062 6f6f  es.__name__} boo
-00023510: 6c5f 6461 7461 222c 0a20 2020 2020 2020  l_data",.       
-00023520: 2029 0a20 2020 2020 2020 2069 6620 6670   ).        if fp
-00023530: 7320 6973 206e 6f74 204e 6f6e 653a 0a20  s is not None:. 
-00023540: 2020 2020 2020 2020 2020 2063 6865 636b             check
-00023550: 5f66 6c6f 6174 280a 2020 2020 2020 2020  _float(.        
-00023560: 2020 2020 2020 2020 6e61 6d65 3d66 227b          name=f"{
-00023570: 4765 6f6d 6574 7279 4d69 7869 6e2e 6375  GeometryMixin.cu
-00023580: 6d73 756d 5f62 6f6f 6c5f 6765 6f6d 6574  msum_bool_geomet
-00023590: 7269 6573 2e5f 5f6e 616d 655f 5f7d 2066  ries.__name__} f
-000235a0: 7073 222c 0a20 2020 2020 2020 2020 2020  ps",.           
-000235b0: 2020 2020 2076 616c 7565 3d66 7073 2c0a       value=fps,.
-000235c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000235d0: 6d69 6e5f 7661 6c75 653d 312e 302c 0a20  min_value=1.0,. 
-000235e0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-000235f0: 2020 2020 2063 6865 636b 5f69 6e74 280a       check_int(.
-00023600: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-00023610: 3d66 227b 4765 6f6d 6574 7279 4d69 7869  =f"{GeometryMixi
-00023620: 6e2e 6375 6d73 756d 5f62 6f6f 6c5f 6765  n.cumsum_bool_ge
-00023630: 6f6d 6574 7269 6573 2e5f 5f6e 616d 655f  ometries.__name_
-00023640: 5f7d 2063 6f72 655f 636e 7422 2c0a 2020  _} core_cnt",.  
-00023650: 2020 2020 2020 2020 2020 7661 6c75 653d            value=
-00023660: 636f 7265 5f63 6e74 2c0a 2020 2020 2020  core_cnt,.      
-00023670: 2020 2020 2020 6d69 6e5f 7661 6c75 653d        min_value=
-00023680: 2d31 2c0a 2020 2020 2020 2020 290a 2020  -1,.        ).  
-00023690: 2020 2020 2020 6966 206e 6f74 206e 702e        if not np.
-000236a0: 6172 7261 795f 6571 7561 6c28 0a20 2020  array_equal(.   
-000236b0: 2020 2020 2020 2020 206e 702e 736f 7274           np.sort
-000236c0: 286e 702e 756e 6971 7565 2862 6f6f 6c5f  (np.unique(bool_
-000236d0: 6461 7461 2929 2e61 7374 7970 6528 696e  data)).astype(in
-000236e0: 7429 2c20 6e70 2e61 7272 6179 285b 302c  t), np.array([0,
-000236f0: 2031 5d29 0a20 2020 2020 2020 2029 3a0a   1]).        ):.
-00023700: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00023710: 6520 496e 7661 6c69 6449 6e70 7574 4572  e InvalidInputEr
-00023720: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-00023730: 2020 2020 206d 7367 3d66 2249 6e76 616c       msg=f"Inval
-00023740: 6964 2062 6f6f 6c65 616e 2064 6174 612e  id boolean data.
-00023750: 2045 7870 6563 7465 6420 7b6e 702e 6172   Expected {np.ar
-00023760: 7261 7928 5b30 2c20 315d 297d 2062 7574  ray([0, 1])} but
-00023770: 2066 6f75 6e64 207b 6e70 2e73 6f72 7428   found {np.sort(
-00023780: 6e70 2e75 6e69 7175 6528 626f 6f6c 5f64  np.unique(bool_d
-00023790: 6174 6129 292e 6173 7479 7065 2869 6e74  ata)).astype(int
-000237a0: 297d 222c 0a20 2020 2020 2020 2020 2020  )}",.           
-000237b0: 2020 2020 2073 6f75 7263 653d 4765 6f6d       source=Geom
-000237c0: 6574 7279 4d69 7869 6e2e 6375 6d73 756d  etryMixin.cumsum
-000237d0: 5f62 6f6f 6c5f 6765 6f6d 6574 7269 6573  _bool_geometries
-000237e0: 2e5f 5f6e 616d 655f 5f2c 0a20 2020 2020  .__name__,.     
-000237f0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00023800: 2069 6620 636f 7265 5f63 6e74 203d 3d20   if core_cnt == 
-00023810: 2d31 3a0a 2020 2020 2020 2020 2020 2020  -1:.            
-00023820: 636f 7265 5f63 6e74 203d 2066 696e 645f  core_cnt = find_
-00023830: 636f 7265 5f63 6e74 2829 5b30 5d0a 2020  core_cnt()[0].  
-00023840: 2020 2020 2020 772c 2068 203d 2030 2c20        w, h = 0, 
-00023850: 300a 2020 2020 2020 2020 666f 7220 6b20  0.        for k 
-00023860: 696e 2067 656f 6d65 7472 6965 732e 6b65  in geometries.ke
-00023870: 7973 2829 3a0a 2020 2020 2020 2020 2020  ys():.          
-00023880: 2020 772c 2068 203d 206d 6178 2877 2c20    w, h = max(w, 
-00023890: 6b5b 305d 292c 206d 6178 2868 2c20 6b5b  k[0]), max(h, k[
-000238a0: 315d 290a 2020 2020 2020 2020 6672 6d5f  1]).        frm_
-000238b0: 6964 203d 206e 702e 6172 616e 6765 2830  id = np.arange(0
-000238c0: 2c20 6461 7461 2e73 6861 7065 5b30 5d29  , data.shape[0])
-000238d0: 2e72 6573 6861 7065 282d 312c 2031 290a  .reshape(-1, 1).
-000238e0: 2020 2020 2020 2020 6966 2062 6f6f 6c5f          if bool_
-000238f0: 6461 7461 2e6e 6469 6d20 3d3d 2031 3a0a  data.ndim == 1:.
-00023900: 2020 2020 2020 2020 2020 2020 626f 6f6c              bool
-00023910: 5f64 6174 6120 3d20 626f 6f6c 5f64 6174  _data = bool_dat
-00023920: 612e 7265 7368 6170 6528 2d31 2c20 3129  a.reshape(-1, 1)
-00023930: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
-00023940: 6e70 2e68 7374 6163 6b28 2864 6174 612c  np.hstack((data,
-00023950: 2062 6f6f 6c5f 6461 7461 2929 0a20 2020   bool_data)).   
-00023960: 2020 2020 2064 6174 6120 3d20 6e70 2e68       data = np.h
-00023970: 7374 6163 6b28 2866 726d 5f69 642c 2064  stack((frm_id, d
-00023980: 6174 6129 290a 2020 2020 2020 2020 696d  ata)).        im
-00023990: 675f 6172 7220 3d20 6e70 2e7a 6572 6f73  g_arr = np.zeros
-000239a0: 2828 6461 7461 2e73 6861 7065 5b30 5d2c  ((data.shape[0],
-000239b0: 2068 202b 2031 2c20 7720 2b20 3129 290a   h + 1, w + 1)).
-000239c0: 2020 2020 2020 2020 6461 7461 203d 2064          data = d
-000239d0: 6174 615b 6e70 2e61 7267 7768 6572 6528  ata[np.argwhere(
-000239e0: 2864 6174 615b 3a2c 2033 5d20 3d3d 2031  (data[:, 3] == 1
-000239f0: 2929 5d2e 7265 7368 6170 6528 2d31 2c20  ))].reshape(-1, 
-00023a00: 3429 0a20 2020 2020 2020 2077 6974 6820  4).        with 
-00023a10: 6d75 6c74 6970 726f 6365 7373 696e 672e  multiprocessing.
-00023a20: 506f 6f6c 280a 2020 2020 2020 2020 2020  Pool(.          
-00023a30: 2020 636f 7265 5f63 6e74 2c20 6d61 7874    core_cnt, maxt
-00023a40: 6173 6b73 7065 7263 6869 6c64 3d44 6566  asksperchild=Def
-00023a50: 6175 6c74 732e 4c41 5247 455f 4d41 585f  aults.LARGE_MAX_
-00023a60: 5441 534b 5f50 4552 5f43 4849 4c44 2e76  TASK_PER_CHILD.v
-00023a70: 616c 7565 0a20 2020 2020 2020 2029 2061  alue.        ) a
-00023a80: 7320 706f 6f6c 3a0a 2020 2020 2020 2020  s pool:.        
-00023a90: 2020 2020 636f 6e73 7461 6e74 7320 3d20      constants = 
-00023aa0: 6675 6e63 746f 6f6c 732e 7061 7274 6961  functools.partia
-00023ab0: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
-00023ac0: 2020 2073 656c 662e 5f63 756d 7375 6d5f     self._cumsum_
-00023ad0: 626f 6f6c 5f68 656c 7065 722c 2067 656f  bool_helper, geo
-00023ae0: 6d65 7472 6965 733d 6765 6f6d 6574 7269  metries=geometri
-00023af0: 6573 0a20 2020 2020 2020 2020 2020 2029  es.            )
-00023b00: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-00023b10: 2063 6e74 2c20 7265 7375 6c74 2069 6e20   cnt, result in 
-00023b20: 656e 756d 6572 6174 6528 706f 6f6c 2e69  enumerate(pool.i
-00023b30: 6d61 7028 636f 6e73 7461 6e74 732c 2064  map(constants, d
-00023b40: 6174 612c 2063 6875 6e6b 7369 7a65 3d31  ata, chunksize=1
-00023b50: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
-00023b60: 2020 2020 6966 2072 6573 756c 745b 315d      if result[1]
-00023b70: 2021 3d20 2d31 3a0a 2020 2020 2020 2020   != -1:.        
-00023b80: 2020 2020 2020 2020 2020 2020 696d 675f              img_
-00023b90: 6172 725b 7265 7375 6c74 5b30 5d2c 2072  arr[result[0], r
-00023ba0: 6573 756c 745b 325d 202d 2031 2c20 7265  esult[2] - 1, re
-00023bb0: 7375 6c74 5b31 5d20 2d20 315d 203d 2031  sult[1] - 1] = 1
-00023bc0: 0a20 2020 2020 2020 2070 6f6f 6c2e 6a6f  .        pool.jo
-00023bd0: 696e 2829 0a20 2020 2020 2020 2070 6f6f  in().        poo
-00023be0: 6c2e 7465 726d 696e 6174 6528 290a 2020  l.terminate().  
-00023bf0: 2020 2020 2020 6966 2066 7073 2069 7320        if fps is 
-00023c00: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00023c10: 2020 7265 7475 726e 206e 702e 6375 6d73    return np.cums
-00023c20: 756d 2869 6d67 5f61 7272 2c20 6178 6973  um(img_arr, axis
-00023c30: 3d30 290a 2020 2020 2020 2020 656c 7365  =0).        else
-00023c40: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00023c50: 7475 726e 206e 702e 6375 6d73 756d 2869  turn np.cumsum(i
-00023c60: 6d67 5f61 7272 2c20 6178 6973 3d30 2920  mg_arr, axis=0) 
-00023c70: 2f20 6670 730a 0a20 2020 2040 7374 6174  / fps..    @stat
-00023c80: 6963 6d65 7468 6f64 0a20 2020 2064 6566  icmethod.    def
-00023c90: 205f 6375 6d73 756d 5f61 6e69 6d61 6c5f   _cumsum_animal_
-00023ca0: 6765 6f6d 6574 7269 6573 5f67 7269 645f  geometries_grid_
-00023cb0: 6865 6c70 6572 280a 2020 2020 2020 2020  helper(.        
-00023cc0: 6461 7461 3a20 6e70 2e6e 6461 7272 6179  data: np.ndarray
-00023cd0: 2c0a 2020 2020 2020 2020 6772 6964 3a20  ,.        grid: 
-00023ce0: 4469 6374 5b54 7570 6c65 5b69 6e74 2c20  Dict[Tuple[int, 
-00023cf0: 696e 745d 2c20 506f 6c79 676f 6e5d 2c0a  int], Polygon],.
-00023d00: 2020 2020 2020 2020 7369 7a65 3a20 5475          size: Tu
-00023d10: 706c 655b 696e 745d 2c0a 2020 2020 2020  ple[int],.      
-00023d20: 2020 7665 7262 6f73 653a 2062 6f6f 6c2c    verbose: bool,
-00023d30: 0a20 2020 2029 3a0a 0a20 2020 2020 2020  .    ):..       
-00023d40: 2073 6861 7065 2c20 7265 7375 6c74 7320   shape, results 
-00023d50: 3d20 6461 7461 5b31 5d2c 206e 702e 7a65  = data[1], np.ze
-00023d60: 726f 7328 2873 697a 655b 305d 202b 2031  ros((size[0] + 1
-00023d70: 2c20 7369 7a65 5b31 5d20 2b20 3129 290a  , size[1] + 1)).
-00023d80: 2020 2020 2020 2020 6966 2076 6572 626f          if verbo
-00023d90: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00023da0: 7072 696e 7428 6622 5072 6f63 6573 7369  print(f"Processi
-00023db0: 6e67 2061 6e69 6d61 6c20 6772 6964 2073  ng animal grid s
-00023dc0: 7175 6172 6520 6c6f 6361 7469 6f6e 2069  quare location i
-00023dd0: 6e20 6672 616d 6520 7b69 6e74 2864 6174  n frame {int(dat
-00023de0: 615b 305d 297d 2e2e 2e22 290a 2020 2020  a[0])}...").    
-00023df0: 2020 2020 666f 7220 6b2c 2072 2069 6e20      for k, r in 
-00023e00: 6772 6964 2e69 7465 6d73 2829 3a0a 2020  grid.items():.  
-00023e10: 2020 2020 2020 2020 2020 6966 2072 2e69            if r.i
-00023e20: 6e74 6572 7365 6374 7328 7368 6170 6529  ntersects(shape)
-00023e30: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00023e40: 2020 7265 7375 6c74 735b 6b5b 305d 2c20    results[k[0], 
-00023e50: 6b5b 315d 5d20 3d20 310a 2020 2020 2020  k[1]] = 1.      
-00023e60: 2020 7265 7475 726e 2072 6573 756c 7473    return results
-00023e70: 0a0a 2020 2020 6465 6620 6375 6d73 756d  ..    def cumsum
-00023e80: 5f61 6e69 6d61 6c5f 6765 6f6d 6574 7269  _animal_geometri
-00023e90: 6573 5f67 7269 6428 0a20 2020 2020 2020  es_grid(.       
-00023ea0: 2073 656c 662c 0a20 2020 2020 2020 2064   self,.        d
-00023eb0: 6174 613a 204c 6973 745b 506f 6c79 676f  ata: List[Polygo
-00023ec0: 6e5d 2c0a 2020 2020 2020 2020 6772 6964  n],.        grid
-00023ed0: 3a20 4469 6374 5b54 7570 6c65 5b69 6e74  : Dict[Tuple[int
-00023ee0: 2c20 696e 745d 2c20 506f 6c79 676f 6e5d  , int], Polygon]
-00023ef0: 2c0a 2020 2020 2020 2020 6670 733a 204f  ,.        fps: O
-00023f00: 7074 696f 6e61 6c5b 696e 745d 203d 204e  ptional[int] = N
-00023f10: 6f6e 652c 0a20 2020 2020 2020 2063 6f72  one,.        cor
-00023f20: 655f 636e 743a 204f 7074 696f 6e61 6c5b  e_cnt: Optional[
-00023f30: 696e 745d 203d 202d 312c 0a20 2020 2020  int] = -1,.     
-00023f40: 2020 2076 6572 626f 7365 3a20 4f70 7469     verbose: Opti
-00023f50: 6f6e 616c 5b62 6f6f 6c5d 203d 2054 7275  onal[bool] = Tru
-00023f60: 652c 0a20 2020 2029 3a0a 0a20 2020 2020  e,.    ):..     
-00023f70: 2020 2074 696d 6572 203d 2053 696d 6261     timer = Simba
-00023f80: 5469 6d65 7228 7374 6172 743d 5472 7565  Timer(start=True
-00023f90: 290a 2020 2020 2020 2020 6368 6563 6b5f  ).        check_
-00023fa0: 7661 6c69 645f 6c73 7428 0a20 2020 2020  valid_lst(.     
-00023fb0: 2020 2020 2020 2064 6174 613d 6461 7461         data=data
-00023fc0: 2c0a 2020 2020 2020 2020 2020 2020 736f  ,.            so
-00023fd0: 7572 6365 3d47 656f 6d65 7472 794d 6978  urce=GeometryMix
-00023fe0: 696e 2e63 756d 7375 6d5f 616e 696d 616c  in.cumsum_animal
-00023ff0: 5f67 656f 6d65 7472 6965 735f 6772 6964  _geometries_grid
-00024000: 2e5f 5f6e 616d 655f 5f2c 0a20 2020 2020  .__name__,.     
-00024010: 2020 2020 2020 2076 616c 6964 5f64 7479         valid_dty
-00024020: 7065 733d 2850 6f6c 7967 6f6e 2c29 2c0a  pes=(Polygon,),.
-00024030: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00024040: 2020 6368 6563 6b5f 696e 7374 616e 6365    check_instance
-00024050: 280a 2020 2020 2020 2020 2020 2020 736f  (.            so
-00024060: 7572 6365 3d47 656f 6d65 7472 794d 6978  urce=GeometryMix
-00024070: 696e 2e63 756d 7375 6d5f 616e 696d 616c  in.cumsum_animal
-00024080: 5f67 656f 6d65 7472 6965 735f 6772 6964  _geometries_grid
-00024090: 2e5f 5f6e 616d 655f 5f2c 0a20 2020 2020  .__name__,.     
-000240a0: 2020 2020 2020 2069 6e73 7461 6e63 653d         instance=
-000240b0: 6772 6964 2c0a 2020 2020 2020 2020 2020  grid,.          
-000240c0: 2020 6163 6365 7074 6564 5f74 7970 6573    accepted_types
-000240d0: 3d28 6469 6374 2c29 2c0a 2020 2020 2020  =(dict,),.      
-000240e0: 2020 290a 2020 2020 2020 2020 6966 2066    ).        if f
-000240f0: 7073 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ps is not None:.
-00024100: 2020 2020 2020 2020 2020 2020 6368 6563              chec
-00024110: 6b5f 696e 7428 6e61 6d65 3d22 6670 7322  k_int(name="fps"
-00024120: 2c20 7661 6c75 653d 6670 732c 206d 696e  , value=fps, min
-00024130: 5f76 616c 7565 3d31 290a 2020 2020 2020  _value=1).      
-00024140: 2020 6368 6563 6b5f 696e 7428 6e61 6d65    check_int(name
-00024150: 3d22 636f 7265 5f63 6e74 222c 2076 616c  ="core_cnt", val
-00024160: 7565 3d63 6f72 655f 636e 742c 206d 696e  ue=core_cnt, min
-00024170: 5f76 616c 7565 3d2d 3129 0a20 2020 2020  _value=-1).     
-00024180: 2020 2069 6620 636f 7265 5f63 6e74 203d     if core_cnt =
-00024190: 3d20 2d31 3a0a 2020 2020 2020 2020 2020  = -1:.          
-000241a0: 2020 636f 7265 5f63 6e74 203d 2066 696e    core_cnt = fin
-000241b0: 645f 636f 7265 5f63 6e74 2829 5b30 5d0a  d_core_cnt()[0].
-000241c0: 2020 2020 2020 2020 772c 2068 203d 2030          w, h = 0
-000241d0: 2c20 300a 2020 2020 2020 2020 666f 7220  , 0.        for 
-000241e0: 6b20 696e 2067 7269 642e 6b65 7973 2829  k in grid.keys()
-000241f0: 3a0a 2020 2020 2020 2020 2020 2020 772c  :.            w,
-00024200: 2068 203d 206d 6178 2877 2c20 6b5b 305d   h = max(w, k[0]
-00024210: 292c 206d 6178 2868 2c20 6b5b 315d 290a  ), max(h, k[1]).
-00024220: 2020 2020 2020 2020 6672 6d5f 6964 203d          frm_id =
-00024230: 206e 702e 6172 616e 6765 2830 2c20 6c65   np.arange(0, le
-00024240: 6e28 6461 7461 2929 2e72 6573 6861 7065  n(data)).reshape
-00024250: 282d 312c 2031 290a 2020 2020 2020 2020  (-1, 1).        
-00024260: 6461 7461 203d 206e 702e 6873 7461 636b  data = np.hstack
-00024270: 2828 6672 6d5f 6964 2c20 6e70 2e61 7272  ((frm_id, np.arr
-00024280: 6179 2864 6174 6129 2e72 6573 6861 7065  ay(data).reshape
-00024290: 282d 312c 2031 2929 290a 2020 2020 2020  (-1, 1))).      
-000242a0: 2020 696d 675f 6172 7220 3d20 6e70 2e7a    img_arr = np.z
-000242b0: 6572 6f73 2828 6461 7461 2e73 6861 7065  eros((data.shape
-000242c0: 5b30 5d2c 2068 202b 2031 2c20 7720 2b20  [0], h + 1, w + 
-000242d0: 3129 290a 2020 2020 2020 2020 7769 7468  1)).        with
-000242e0: 206d 756c 7469 7072 6f63 6573 7369 6e67   multiprocessing
-000242f0: 2e50 6f6f 6c28 0a20 2020 2020 2020 2020  .Pool(.         
-00024300: 2020 2063 6f72 655f 636e 742c 206d 6178     core_cnt, max
-00024310: 7461 736b 7370 6572 6368 696c 643d 4465  tasksperchild=De
-00024320: 6661 756c 7473 2e4c 4152 4745 5f4d 4158  faults.LARGE_MAX
-00024330: 5f54 4153 4b5f 5045 525f 4348 494c 442e  _TASK_PER_CHILD.
-00024340: 7661 6c75 650a 2020 2020 2020 2020 2920  value.        ) 
-00024350: 6173 2070 6f6f 6c3a 0a20 2020 2020 2020  as pool:.       
-00024360: 2020 2020 2063 6f6e 7374 616e 7473 203d       constants =
-00024370: 2066 756e 6374 6f6f 6c73 2e70 6172 7469   functools.parti
-00024380: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
-00024390: 2020 2020 7365 6c66 2e5f 6375 6d73 756d      self._cumsum
-000243a0: 5f61 6e69 6d61 6c5f 6765 6f6d 6574 7269  _animal_geometri
-000243b0: 6573 5f67 7269 645f 6865 6c70 6572 2c0a  es_grid_helper,.
-000243c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000243d0: 6772 6964 3d67 7269 642c 0a20 2020 2020  grid=grid,.     
-000243e0: 2020 2020 2020 2020 2020 2073 697a 653d             size=
-000243f0: 2868 2c20 7729 2c0a 2020 2020 2020 2020  (h, w),.        
-00024400: 2020 2020 2020 2020 7665 7262 6f73 653d          verbose=
-00024410: 7665 7262 6f73 652c 0a20 2020 2020 2020  verbose,.       
-00024420: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00024430: 2020 2066 6f72 2063 6e74 2c20 7265 7375     for cnt, resu
-00024440: 6c74 2069 6e20 656e 756d 6572 6174 6528  lt in enumerate(
-00024450: 706f 6f6c 2e69 6d61 7028 636f 6e73 7461  pool.imap(consta
-00024460: 6e74 732c 2064 6174 612c 2063 6875 6e6b  nts, data, chunk
-00024470: 7369 7a65 3d31 2929 3a0a 2020 2020 2020  size=1)):.      
-00024480: 2020 2020 2020 2020 2020 696d 675f 6172            img_ar
-00024490: 725b 636e 745d 203d 2072 6573 756c 740a  r[cnt] = result.
-000244a0: 0a20 2020 2020 2020 2074 696d 6572 2e73  .        timer.s
-000244b0: 746f 705f 7469 6d65 7228 290a 2020 2020  top_timer().    
-000244c0: 2020 2020 7374 646f 7574 5f73 7563 6365      stdout_succe
-000244d0: 7373 280a 2020 2020 2020 2020 2020 2020  ss(.            
-000244e0: 6d73 673d 2243 756d 756c 6174 6976 6520  msg="Cumulative 
-000244f0: 616e 696d 616c 2067 656f 6d65 7472 6965  animal geometrie
-00024500: 7320 696e 2067 7269 6420 636f 6d70 6c65  s in grid comple
-00024510: 7465 222c 0a20 2020 2020 2020 2020 2020  te",.           
-00024520: 2065 6c61 7073 6564 5f74 696d 653d 7469   elapsed_time=ti
-00024530: 6d65 722e 656c 6170 7365 645f 7469 6d65  mer.elapsed_time
-00024540: 5f73 7472 2c0a 2020 2020 2020 2020 290a  _str,.        ).
-00024550: 2020 2020 2020 2020 6966 2066 7073 2069          if fps i
-00024560: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00024570: 2020 2020 7265 7475 726e 206e 702e 6375      return np.cu
-00024580: 6d73 756d 2869 6d67 5f61 7272 2c20 6178  msum(img_arr, ax
-00024590: 6973 3d30 290a 2020 2020 2020 2020 656c  is=0).        el
-000245a0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-000245b0: 7265 7475 726e 206e 702e 6375 6d73 756d  return np.cumsum
-000245c0: 2869 6d67 5f61 7272 2c20 6178 6973 3d30  (img_arr, axis=0
-000245d0: 2920 2f20 6670 730a 0a20 2020 2040 7374  ) / fps..    @st
-000245e0: 6174 6963 6d65 7468 6f64 0a20 2020 2064  aticmethod.    d
-000245f0: 6566 2068 6175 7364 6f72 6666 5f64 6973  ef hausdorff_dis
-00024600: 7461 6e63 6528 0a20 2020 2020 2020 2067  tance(.        g
-00024610: 656f 6d65 7472 6965 733a 204c 6973 745b  eometries: List[
-00024620: 4c69 7374 5b55 6e69 6f6e 5b50 6f6c 7967  List[Union[Polyg
-00024630: 6f6e 2c20 4c69 6e65 5374 7269 6e67 5d5d  on, LineString]]
-00024640: 5d0a 2020 2020 2920 2d3e 206e 702e 6e64  ].    ) -> np.nd
-00024650: 6172 7261 793a 0a20 2020 2020 2020 2022  array:.        "
-00024660: 2222 0a20 2020 2020 2020 2054 6865 2048  "".        The H
-00024670: 6175 7364 6f72 6666 2064 6973 7461 6e63  ausdorff distanc
-00024680: 6520 6d65 6173 7572 6520 6f66 2074 6865  e measure of the
-00024690: 2073 696d 696c 6172 6974 7920 6265 7477   similarity betw
-000246a0: 6565 6e20 7469 6d65 2d73 6572 6965 7320  een time-series 
-000246b0: 7365 7175 656e 7469 616c 2067 656f 6d65  sequential geome
-000246c0: 7472 6965 732e 2049 7420 6973 2064 6566  tries. It is def
-000246d0: 696e 6564 2061 7320 7468 6520 6d61 7869  ined as the maxi
-000246e0: 6d75 6d20 6f66 2074 6865 2064 6973 7461  mum of the dista
-000246f0: 6e63 6573 0a20 2020 2020 2020 2066 726f  nces.        fro
-00024700: 6d20 6561 6368 2070 6f69 6e74 2069 6e20  m each point in 
-00024710: 6f6e 6520 7365 7420 746f 2074 6865 206e  one set to the n
-00024720: 6561 7265 7374 2070 6f69 6e74 2069 6e20  earest point in 
-00024730: 7468 6520 6f74 6865 7220 7365 742e 0a0a  the other set...
-00024740: 2020 2020 2020 2020 4861 7573 646f 7266          Hausdorf
-00024750: 6620 6469 7374 616e 6365 2063 616e 2062  f distance can b
-00024760: 6520 7573 6564 2074 6f20 6d65 6173 7572  e used to measur
-00024770: 6520 7468 6520 7369 6d69 6c61 7269 7479  e the similarity
-00024780: 206f 6620 7468 6520 6765 6f6d 6574 7279   of the geometry
-00024790: 2069 6e20 6f6e 6520 6672 616d 6520 7265   in one frame re
-000247a0: 6c61 7469 7665 2074 6f20 7468 6520 6765  lative to the ge
-000247b0: 6f6d 6574 7279 2069 6e20 7468 6520 6e65  ometry in the ne
-000247c0: 7874 2066 7261 6d65 2e0a 2020 2020 2020  xt frame..      
-000247d0: 2020 4c61 7267 6520 7661 6c75 6573 2069    Large values i
-000247e0: 6e64 6963 6174 6520 7468 6174 2074 6865  ndicate that the
-000247f0: 2061 6e69 6d61 6c20 6861 7320 6120 6469   animal has a di
-00024800: 6666 6572 656e 7420 7368 6170 6520 7468  fferent shape th
-00024810: 616e 2069 6e20 7468 6520 7072 6563 6564  an in the preced
-00024820: 696e 6720 7368 6170 652e 0a0a 2020 2020  ing shape...    
-00024830: 2020 2020 3a70 6172 616d 204c 6973 745b      :param List[
-00024840: 4c69 7374 5b55 6e69 6f6e 5b50 6f6c 7967  List[Union[Polyg
-00024850: 6f6e 2c20 4c69 6e65 5374 7269 6e67 5d5d  on, LineString]]
-00024860: 5d20 6765 6f6d 6574 7269 6573 3a20 4c69  ] geometries: Li
-00024870: 7374 206f 6620 6c69 7374 2077 6865 7265  st of list where
-00024880: 2065 6163 6820 6c69 7374 2068 6173 2074   each list has t
-00024890: 776f 2067 656f 6d65 7472 6965 732e 0a20  wo geometries.. 
-000248a0: 2020 2020 2020 203a 7265 7475 726e 206e         :return n
-000248b0: 702e 6e64 6172 7261 793a 2031 4420 6172  p.ndarray: 1D ar
-000248c0: 7261 7920 6f66 2068 6175 7364 6f72 6666  ray of hausdorff
-000248d0: 2064 6973 7461 6e63 6573 206f 6620 6765   distances of ge
-000248e0: 6f6d 6574 7269 6573 2069 6e20 6561 6368  ometries in each
-000248f0: 206c 6973 742e 0a20 2020 2020 2020 2022   list..        "
-00024900: 2222 0a0a 2020 2020 2020 2020 6368 6563  ""..        chec
-00024910: 6b5f 696e 7374 616e 6365 280a 2020 2020  k_instance(.    
-00024920: 2020 2020 2020 2020 736f 7572 6365 3d47          source=G
-00024930: 656f 6d65 7472 794d 6978 696e 2e68 6175  eometryMixin.hau
-00024940: 7364 6f72 6666 5f64 6973 7461 6e63 652e  sdorff_distance.
-00024950: 5f5f 6e61 6d65 5f5f 2c0a 2020 2020 2020  __name__,.      
-00024960: 2020 2020 2020 696e 7374 616e 6365 3d67        instance=g
-00024970: 656f 6d65 7472 6965 732c 0a20 2020 2020  eometries,.     
-00024980: 2020 2020 2020 2061 6363 6570 7465 645f         accepted_
-00024990: 7479 7065 733d 286c 6973 742c 292c 0a20  types=(list,),. 
-000249a0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000249b0: 2066 6f72 2069 2069 6e20 6765 6f6d 6574   for i in geomet
-000249c0: 7269 6573 3a0a 2020 2020 2020 2020 2020  ries:.          
-000249d0: 2020 6368 6563 6b5f 7661 6c69 645f 6c73    check_valid_ls
-000249e0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-000249f0: 2020 2073 6f75 7263 653d 4765 6f6d 6574     source=Geomet
-00024a00: 7279 4d69 7869 6e2e 6861 7573 646f 7266  ryMixin.hausdorf
-00024a10: 665f 6469 7374 616e 6365 2e5f 5f6e 616d  f_distance.__nam
-00024a20: 655f 5f2c 0a20 2020 2020 2020 2020 2020  e__,.           
-00024a30: 2020 2020 2064 6174 613d 692c 0a20 2020       data=i,.   
-00024a40: 2020 2020 2020 2020 2020 2020 2076 616c               val
-00024a50: 6964 5f64 7479 7065 733d 280a 2020 2020  id_dtypes=(.    
-00024a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024a70: 506f 6c79 676f 6e2c 0a20 2020 2020 2020  Polygon,.       
-00024a80: 2020 2020 2020 2020 2020 2020 204c 696e               Lin
-00024a90: 6553 7472 696e 672c 0a20 2020 2020 2020  eString,.       
-00024aa0: 2020 2020 2020 2020 2029 2c0a 2020 2020           ),.    
-00024ab0: 2020 2020 2020 2020 2020 2020 6578 6163              exac
-00024ac0: 745f 6c65 6e3d 322c 0a20 2020 2020 2020  t_len=2,.       
-00024ad0: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
-00024ae0: 6573 756c 7473 203d 206e 702e 6675 6c6c  esults = np.full
-00024af0: 2828 6c65 6e28 6765 6f6d 6574 7269 6573  ((len(geometries
-00024b00: 2929 2c20 6e70 2e6e 616e 290a 2020 2020  )), np.nan).    
-00024b10: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
-00024b20: 6765 286c 656e 2867 656f 6d65 7472 6965  ge(len(geometrie
-00024b30: 7329 293a 0a20 2020 2020 2020 2020 2020  s)):.           
-00024b40: 2072 6573 756c 7473 5b69 5d20 3d20 6765   results[i] = ge
-00024b50: 6f6d 6574 7269 6573 5b69 5d5b 305d 2e68  ometries[i][0].h
-00024b60: 6175 7364 6f72 6666 5f64 6973 7461 6e63  ausdorff_distanc
-00024b70: 6528 6765 6f6d 6574 7269 6573 5b69 5d5b  e(geometries[i][
-00024b80: 315d 290a 2020 2020 2020 2020 7265 7475  1]).        retu
-00024b90: 726e 2072 6573 756c 7473 0a0a 2020 2020  rn results..    
-00024ba0: 6465 6620 6d75 6c74 6966 7261 6d65 5f68  def multiframe_h
-00024bb0: 6175 7364 6f72 6666 5f64 6973 7461 6e63  ausdorff_distanc
-00024bc0: 6528 0a20 2020 2020 2020 2073 656c 662c  e(.        self,
-00024bd0: 0a20 2020 2020 2020 2067 656f 6d65 7472  .        geometr
-00024be0: 6965 733a 204c 6973 745b 556e 696f 6e5b  ies: List[Union[
-00024bf0: 506f 6c79 676f 6e2c 204c 696e 6553 7472  Polygon, LineStr
-00024c00: 696e 675d 5d2c 0a20 2020 2020 2020 206c  ing]],.        l
-00024c10: 6167 3a20 4f70 7469 6f6e 616c 5b69 6e74  ag: Optional[int
-00024c20: 5d20 3d20 312c 0a20 2020 2020 2020 2063  ] = 1,.        c
-00024c30: 6f72 655f 636e 743a 204f 7074 696f 6e61  ore_cnt: Optiona
-00024c40: 6c5b 696e 745d 203d 202d 312c 0a20 2020  l[int] = -1,.   
-00024c50: 2029 202d 3e20 4c69 7374 5b66 6c6f 6174   ) -> List[float
-00024c60: 5d3a 0a20 2020 2020 2020 2022 2222 0a20  ]:.        """. 
-00024c70: 2020 2020 2020 2054 6865 2048 6175 7364         The Hausd
-00024c80: 6f72 6666 2064 6973 7461 6e63 6520 6d65  orff distance me
-00024c90: 6173 7572 6520 6f66 2074 6865 2073 696d  asure of the sim
-00024ca0: 696c 6172 6974 7920 6265 7477 6565 6e20  ilarity between 
-00024cb0: 7365 7175 656e 7469 616c 2074 696d 652d  sequential time-
-00024cc0: 7365 7269 6573 2020 6765 6f6d 6574 7269  series  geometri
-00024cd0: 6573 2e0a 0a20 2020 2020 2020 203a 6578  es...        :ex
-00024ce0: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
-00024cf0: 3e3e 2064 6620 3d20 7265 6164 5f64 6628  >> df = read_df(
-00024d00: 6669 6c65 5f70 6174 683d 272f 5573 6572  file_path='/User
-00024d10: 732f 7369 6d6f 6e2f 4465 736b 746f 702f  s/simon/Desktop/
-00024d20: 656e 7673 2f73 696d 6261 2f74 726f 7562  envs/simba/troub
-00024d30: 6c65 7368 6f6f 7469 6e67 2f6d 6f75 7365  leshooting/mouse
-00024d40: 5f6f 7065 6e5f 6669 656c 642f 7072 6f6a  _open_field/proj
-00024d50: 6563 745f 666f 6c64 6572 2f63 7376 2f6f  ect_folder/csv/o
-00024d60: 7574 6c69 6572 5f63 6f72 7265 6374 6564  utlier_corrected
-00024d70: 5f6d 6f76 656d 656e 745f 6c6f 6361 7469  _movement_locati
-00024d80: 6f6e 2f53 495f 4441 5933 5f33 3038 5f43  on/SI_DAY3_308_C
-00024d90: 4431 5f50 5245 5345 4e54 2e63 7376 272c  D1_PRESENT.csv',
-00024da0: 2066 696c 655f 7479 7065 3d27 6373 7627   file_type='csv'
-00024db0: 290a 2020 2020 2020 2020 3e3e 3e20 636f  ).        >>> co
-00024dc0: 6c73 203d 205b 7820 666f 7220 7820 696e  ls = [x for x in
-00024dd0: 2064 662e 636f 6c75 6d6e 7320 6966 206e   df.columns if n
-00024de0: 6f74 2078 2e65 6e64 7377 6974 6828 275f  ot x.endswith('_
-00024df0: 7027 295d 0a20 2020 2020 2020 203e 3e3e  p')].        >>>
-00024e00: 2064 6174 6120 3d20 6466 5b63 6f6c 735d   data = df[cols]
-00024e10: 2e76 616c 7565 732e 7265 7368 6170 6528  .values.reshape(
-00024e20: 6c65 6e28 6466 292c 202d 3120 2c20 3229  len(df), -1 , 2)
-00024e30: 2e61 7374 7970 6528 6e70 2e69 6e74 290a  .astype(np.int).
-00024e40: 2020 2020 2020 2020 3e3e 3e20 6765 6f6d          >>> geom
-00024e50: 6574 7269 6573 203d 2047 656f 6d65 7472  etries = Geometr
-00024e60: 794d 6978 696e 2829 2e6d 756c 7469 6672  yMixin().multifr
-00024e70: 616d 655f 626f 6479 7061 7274 735f 746f  ame_bodyparts_to
-00024e80: 5f70 6f6c 7967 6f6e 2864 6174 613d 6461  _polygon(data=da
-00024e90: 7461 2c20 7069 7865 6c73 5f70 6572 5f6d  ta, pixels_per_m
-00024ea0: 6d3d 312c 2070 6172 616c 6c65 6c5f 6f66  m=1, parallel_of
-00024eb0: 6673 6574 3d31 2c20 7665 7262 6f73 653d  fset=1, verbose=
-00024ec0: 4661 6c73 652c 2063 6f72 655f 636e 743d  False, core_cnt=
-00024ed0: 2d31 290a 2020 2020 2020 2020 3e3e 3e20  -1).        >>> 
-00024ee0: 6861 7573 646f 7266 665f 6469 7374 616e  hausdorff_distan
-00024ef0: 6365 7320 3d20 4765 6f6d 6574 7279 4d69  ces = GeometryMi
-00024f00: 7869 6e2e 6d75 6c74 6966 7261 6d65 5f68  xin.multiframe_h
-00024f10: 6175 7364 6f72 6666 5f64 6973 7461 6e63  ausdorff_distanc
-00024f20: 6528 6765 6f6d 6574 7269 6573 3d67 656f  e(geometries=geo
-00024f30: 6d65 7472 6965 7329 0a20 2020 2020 2020  metries).       
-00024f40: 2022 2222 0a0a 2020 2020 2020 2020 6368   """..        ch
-00024f50: 6563 6b5f 7661 6c69 645f 6c73 7428 0a20  eck_valid_lst(. 
-00024f60: 2020 2020 2020 2020 2020 2073 6f75 7263             sourc
-00024f70: 653d 4765 6f6d 6574 7279 4d69 7869 6e2e  e=GeometryMixin.
-00024f80: 6d75 6c74 6966 7261 6d65 5f68 6175 7364  multiframe_hausd
-00024f90: 6f72 6666 5f64 6973 7461 6e63 652e 5f5f  orff_distance.__
-00024fa0: 6e61 6d65 5f5f 2c0a 2020 2020 2020 2020  name__,.        
-00024fb0: 2020 2020 6461 7461 3d67 656f 6d65 7472      data=geometr
-00024fc0: 6965 732c 0a20 2020 2020 2020 2020 2020  ies,.           
-00024fd0: 2076 616c 6964 5f64 7479 7065 733d 280a   valid_dtypes=(.
-00024fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024ff0: 506f 6c79 676f 6e2c 0a20 2020 2020 2020  Polygon,.       
-00025000: 2020 2020 2020 2020 204c 696e 6553 7472           LineStr
-00025010: 696e 672c 0a20 2020 2020 2020 2020 2020  ing,.           
-00025020: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
-00025030: 6d69 6e5f 6c65 6e3d 312c 0a20 2020 2020  min_len=1,.     
-00025040: 2020 2029 0a20 2020 2020 2020 2063 6865     ).        che
-00025050: 636b 5f69 6e74 280a 2020 2020 2020 2020  ck_int(.        
-00025060: 2020 2020 6e61 6d65 3d66 227b 4765 6f6d      name=f"{Geom
-00025070: 6574 7279 4d69 7869 6e2e 6d75 6c74 6966  etryMixin.multif
-00025080: 7261 6d65 5f68 6175 7364 6f72 6666 5f64  rame_hausdorff_d
-00025090: 6973 7461 6e63 652e 5f5f 6e61 6d65 5f5f  istance.__name__
-000250a0: 7d20 434f 5245 2043 4f55 4e54 222c 0a20  } CORE COUNT",. 
-000250b0: 2020 2020 2020 2020 2020 2076 616c 7565             value
-000250c0: 3d63 6f72 655f 636e 742c 0a20 2020 2020  =core_cnt,.     
-000250d0: 2020 2020 2020 206d 696e 5f76 616c 7565         min_value
-000250e0: 3d2d 312c 0a20 2020 2020 2020 2020 2020  =-1,.           
-000250f0: 206d 6178 5f76 616c 7565 3d66 696e 645f   max_value=find_
-00025100: 636f 7265 5f63 6e74 2829 5b30 5d2c 0a20  core_cnt()[0],. 
-00025110: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00025120: 5f65 7272 6f72 3d54 7275 652c 0a20 2020  _error=True,.   
-00025130: 2020 2020 2029 0a20 2020 2020 2020 2063       ).        c
-00025140: 6865 636b 5f69 6e74 280a 2020 2020 2020  heck_int(.      
-00025150: 2020 2020 2020 6e61 6d65 3d66 227b 4765        name=f"{Ge
-00025160: 6f6d 6574 7279 4d69 7869 6e2e 6d75 6c74  ometryMixin.mult
-00025170: 6966 7261 6d65 5f68 6175 7364 6f72 6666  iframe_hausdorff
-00025180: 5f64 6973 7461 6e63 652e 5f5f 6e61 6d65  _distance.__name
-00025190: 5f5f 7d20 4c41 4722 2c0a 2020 2020 2020  __} LAG",.      
-000251a0: 2020 2020 2020 7661 6c75 653d 6c61 672c        value=lag,
-000251b0: 0a20 2020 2020 2020 2020 2020 206d 696e  .            min
-000251c0: 5f76 616c 7565 3d2d 312c 0a20 2020 2020  _value=-1,.     
-000251d0: 2020 2020 2020 206d 6178 5f76 616c 7565         max_value
-000251e0: 3d6c 656e 2867 656f 6d65 7472 6965 7329  =len(geometries)
-000251f0: 202d 2031 2c0a 2020 2020 2020 2020 2020   - 1,.          
-00025200: 2020 7261 6973 655f 6572 726f 723d 5472    raise_error=Tr
-00025210: 7565 2c0a 2020 2020 2020 2020 290a 2020  ue,.        ).  
-00025220: 2020 2020 2020 6966 2063 6f72 655f 636e        if core_cn
-00025230: 7420 3d3d 202d 313a 0a20 2020 2020 2020  t == -1:.       
-00025240: 2020 2020 2063 6f72 655f 636e 7420 3d20       core_cnt = 
-00025250: 6669 6e64 5f63 6f72 655f 636e 7428 295b  find_core_cnt()[
-00025260: 305d 0a20 2020 2020 2020 2072 6573 6861  0].        resha
-00025270: 7065 645f 6765 6f6d 6574 7269 6573 203d  ped_geometries =
-00025280: 205b 5d0a 2020 2020 2020 2020 666f 7220   [].        for 
-00025290: 6920 696e 2072 616e 6765 286c 6167 293a  i in range(lag):
-000252a0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-000252b0: 6861 7065 645f 6765 6f6d 6574 7269 6573  haped_geometries
-000252c0: 2e61 7070 656e 6428 5b5b 6765 6f6d 6574  .append([[geomet
-000252d0: 7269 6573 5b69 5d2c 2067 656f 6d65 7472  ries[i], geometr
-000252e0: 6965 735b 695d 5d5d 290a 2020 2020 2020  ies[i]]]).      
-000252f0: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
-00025300: 286c 6167 2c20 6c65 6e28 6765 6f6d 6574  (lag, len(geomet
-00025310: 7269 6573 2929 3a0a 2020 2020 2020 2020  ries)):.        
-00025320: 2020 2020 7265 7368 6170 6564 5f67 656f      reshaped_geo
-00025330: 6d65 7472 6965 732e 6170 7065 6e64 285b  metries.append([
-00025340: 5b67 656f 6d65 7472 6965 735b 6920 2d20  [geometries[i - 
-00025350: 6c61 675d 2c20 6765 6f6d 6574 7269 6573  lag], geometries
-00025360: 5b69 5d5d 5d29 0a20 2020 2020 2020 2072  [i]]]).        r
-00025370: 6573 756c 7473 203d 205b 5d0a 2020 2020  esults = [].    
-00025380: 2020 2020 7769 7468 206d 756c 7469 7072      with multipr
-00025390: 6f63 6573 7369 6e67 2e50 6f6f 6c28 0a20  ocessing.Pool(. 
-000253a0: 2020 2020 2020 2020 2020 2063 6f72 655f             core_
-000253b0: 636e 742c 206d 6178 7461 736b 7370 6572  cnt, maxtasksper
-000253c0: 6368 696c 643d 4465 6661 756c 7473 2e4c  child=Defaults.L
-000253d0: 4152 4745 5f4d 4158 5f54 4153 4b5f 5045  ARGE_MAX_TASK_PE
-000253e0: 525f 4348 494c 442e 7661 6c75 650a 2020  R_CHILD.value.  
-000253f0: 2020 2020 2020 2920 6173 2070 6f6f 6c3a        ) as pool:
-00025400: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-00025410: 2063 6e74 2c20 6d70 5f72 6574 7572 6e20   cnt, mp_return 
-00025420: 696e 2065 6e75 6d65 7261 7465 280a 2020  in enumerate(.  
-00025430: 2020 2020 2020 2020 2020 2020 2020 706f                po
-00025440: 6f6c 2e69 6d61 7028 0a20 2020 2020 2020  ol.imap(.       
-00025450: 2020 2020 2020 2020 2020 2020 2047 656f               Geo
-00025460: 6d65 7472 794d 6978 696e 2e68 6175 7364  metryMixin.hausd
-00025470: 6f72 6666 5f64 6973 7461 6e63 652c 2072  orff_distance, r
-00025480: 6573 6861 7065 645f 6765 6f6d 6574 7269  eshaped_geometri
-00025490: 6573 2c20 6368 756e 6b73 697a 653d 310a  es, chunksize=1.
-000254a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000254b0: 290a 2020 2020 2020 2020 2020 2020 293a  ).            ):
-000254c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000254d0: 2072 6573 756c 7473 2e61 7070 656e 6428   results.append(
-000254e0: 6d70 5f72 6574 7572 6e5b 305d 290a 2020  mp_return[0]).  
-000254f0: 2020 2020 2020 7265 7475 726e 2072 6573        return res
-00025500: 756c 7473 0a0a 2020 2020 4073 7461 7469  ults..    @stati
-00025510: 636d 6574 686f 640a 2020 2020 6465 6620  cmethod.    def 
-00025520: 6c6f 6361 7465 5f6c 696e 655f 706f 696e  locate_line_poin
-00025530: 7428 0a20 2020 2020 2020 2070 6174 683a  t(.        path:
-00025540: 2055 6e69 6f6e 5b4c 696e 6553 7472 696e   Union[LineStrin
-00025550: 672c 206e 702e 6e64 6172 7261 795d 2c0a  g, np.ndarray],.
-00025560: 2020 2020 2020 2020 6765 6f6d 6574 7279          geometry
-00025570: 3a20 556e 696f 6e5b 4c69 6e65 5374 7269  : Union[LineStri
-00025580: 6e67 2c20 506f 6c79 676f 6e2c 2050 6f69  ng, Polygon, Poi
-00025590: 6e74 5d2c 0a20 2020 2020 2020 2070 785f  nt],.        px_
-000255a0: 7065 725f 6d6d 3a20 4f70 7469 6f6e 616c  per_mm: Optional
-000255b0: 5b66 6c6f 6174 5d20 3d20 312c 0a20 2020  [float] = 1,.   
-000255c0: 2020 2020 2066 7073 3a20 4f70 7469 6f6e       fps: Option
-000255d0: 616c 5b66 6c6f 6174 5d20 3d20 312c 0a20  al[float] = 1,. 
-000255e0: 2020 2020 2020 2063 6f72 655f 636e 743a         core_cnt:
-000255f0: 204f 7074 696f 6e61 6c5b 696e 745d 203d   Optional[int] =
-00025600: 202d 312c 0a20 2020 2020 2020 2064 6973   -1,.        dis
-00025610: 7461 6e63 655f 6d69 6e3a 204f 7074 696f  tance_min: Optio
-00025620: 6e61 6c5b 626f 6f6c 5d20 3d20 5472 7565  nal[bool] = True
-00025630: 2c0a 2020 2020 2020 2020 7469 6d65 5f70  ,.        time_p
-00025640: 7269 6f72 3a20 4f70 7469 6f6e 616c 5b62  rior: Optional[b
-00025650: 6f6f 6c5d 203d 2054 7275 652c 0a20 2020  ool] = True,.   
-00025660: 2029 202d 3e20 4469 6374 5b73 7472 2c20   ) -> Dict[str, 
-00025670: 666c 6f61 745d 3a0a 2020 2020 2020 2020  float]:.        
-00025680: 2222 220a 2020 2020 2020 2020 436f 6d70  """.        Comp
-00025690: 7574 6520 7468 6520 7469 6d65 2061 6e64  ute the time and
-000256a0: 2064 6973 7461 6e63 6520 7472 6176 656c   distance travel
-000256b0: 6c65 6420 616c 6f6e 6720 6120 7061 7468  led along a path
-000256c0: 2074 6f20 7265 6163 6820 7468 6520 6d6f   to reach the mo
-000256d0: 7374 2070 726f 7869 6d61 6c20 706f 696e  st proximal poin
-000256e0: 7420 696e 2072 6566 6572 656e 6365 2074  t in reference t
-000256f0: 6f20 6120 7365 636f 6e64 2067 656f 6d65  o a second geome
-00025700: 7472 792e 0a0a 2020 2020 2020 2020 2e2e  try...        ..
-00025710: 206e 6f74 653a 3a0a 2020 2020 2020 2020   note::.        
-00025720: 2020 2028 6929 2054 6f20 636f 6d70 7574     (i) To comput
-00025730: 6520 7468 6520 7469 6d65 2061 6e64 2064  e the time and d
-00025740: 6973 7461 6e63 6520 7472 6176 656c 6c65  istance travelle
-00025750: 6420 746f 2061 6c6f 6e67 2061 2070 6174  d to along a pat
-00025760: 6820 746f 2072 6561 6368 2074 6865 206d  h to reach the m
-00025770: 6f73 7420 6469 7374 616c 2070 6f69 6e74  ost distal point
-00025780: 2074 6f20 6120 7365 636f 6e64 2067 656f   to a second geo
-00025790: 6d65 7472 792c 2070 6173 7320 6060 6469  metry, pass ``di
-000257a0: 7374 616e 6365 5f6d 696e 203d 2046 616c  stance_min = Fal
-000257b0: 7365 6060 2e0a 0a20 2020 2020 2020 2020  se``...         
-000257c0: 2020 2869 6929 2054 6f20 636f 6d70 7574    (ii) To comput
-000257d0: 6520 7468 6520 7469 6d65 2061 6e64 2064  e the time and d
-000257e0: 6973 7461 6e63 6520 7472 6176 656c 6c65  istance travelle
-000257f0: 6420 616c 6f6e 6720 6120 7061 7468 202a  d along a path *
-00025800: 2a61 6674 6572 2a2a 2072 6561 6368 696e  *after** reachin
-00025810: 6720 7468 6520 6d6f 7374 2064 6973 7461  g the most dista
-00025820: 6c20 6f72 2070 726f 7869 6d61 6c20 706f  l or proximal po
-00025830: 696e 7420 746f 2061 2073 6563 6f6e 6420  int to a second 
-00025840: 6765 6f6d 6574 7279 2c20 7061 7373 2060  geometry, pass `
-00025850: 6074 696d 655f 7072 696f 7220 3d20 4661  `time_prior = Fa
-00025860: 6c73 6560 602e 0a0a 2020 2020 2020 2020  lse``...        
-00025870: 2e2e 2069 6d61 6765 3a3a 205f 7374 6174  .. image:: _stat
-00025880: 6963 2f69 6d67 2f6c 6f63 6174 655f 6c69  ic/img/locate_li
-00025890: 6e65 5f70 6f69 6e74 2e70 6e67 0a20 2020  ne_point.png.   
-000258a0: 2020 2020 2020 2020 3a77 6964 7468 3a20          :width: 
-000258b0: 3630 300a 2020 2020 2020 2020 2020 203a  600.           :
-000258c0: 616c 6967 6e3a 2063 656e 7465 720a 0a20  align: center.. 
-000258d0: 2020 2020 2020 203a 6578 616d 706c 653a         :example:
-000258e0: 0a20 2020 2020 2020 203e 3e3e 206c 696e  .        >>> lin
-000258f0: 6520 3d20 4c69 6e65 5374 7269 6e67 285b  e = LineString([
-00025900: 5b31 302c 2031 305d 2c20 5b37 2e35 2c20  [10, 10], [7.5, 
-00025910: 372e 355d 2c20 5b31 352c 2031 355d 2c20  7.5], [15, 15], 
-00025920: 5b37 2e35 2c20 372e 355d 5d29 0a20 2020  [7.5, 7.5]]).   
-00025930: 2020 2020 203e 3e3e 2070 6f6c 7967 6f6e       >>> polygon
-00025940: 203d 2050 6f6c 7967 6f6e 285b 5b30 2c20   = Polygon([[0, 
-00025950: 355d 2c20 5b30 2c20 305d 2c20 5b35 2c20  5], [0, 0], [5, 
-00025960: 305d 2c20 5b35 2c20 355d 5d29 0a20 2020  0], [5, 5]]).   
-00025970: 2020 2020 203e 3e3e 2047 656f 6d65 7472       >>> Geometr
-00025980: 794d 6978 696e 2e6c 6f63 6174 655f 6c69  yMixin.locate_li
-00025990: 6e65 5f70 6f69 6e74 2870 6174 683d 6c69  ne_point(path=li
-000259a0: 6e65 2c20 6765 6f6d 6574 7279 3d70 6f6c  ne, geometry=pol
-000259b0: 7967 6f6e 290a 2020 2020 2020 2020 3e3e  ygon).        >>
-000259c0: 3e20 7b27 6469 7374 616e 6365 5f76 616c  > {'distance_val
-000259d0: 7565 273a 2033 2e35 3335 3533 3339 3035  ue': 3.535533905
-000259e0: 3933 3237 3337 382c 2027 6469 7374 616e  9327378, 'distan
-000259f0: 6365 5f74 7261 7665 6c6c 6564 273a 2033  ce_travelled': 3
-00025a00: 2e35 3335 3533 3339 3035 3933 3237 3337  .535533905932737
-00025a10: 382c 2027 7469 6d65 5f74 7261 7665 6c6c  8, 'time_travell
-00025a20: 6564 273a 2031 2e30 2c20 2764 6973 7461  ed': 1.0, 'dista
-00025a30: 6e63 655f 696e 6465 7827 3a20 317d 0a20  nce_index': 1}. 
-00025a40: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-00025a50: 2020 2020 6368 6563 6b5f 696e 7374 616e      check_instan
-00025a60: 6365 280a 2020 2020 2020 2020 2020 2020  ce(.            
-00025a70: 736f 7572 6365 3d47 656f 6d65 7472 794d  source=GeometryM
-00025a80: 6978 696e 2e6c 6f63 6174 655f 6c69 6e65  ixin.locate_line
-00025a90: 5f70 6f69 6e74 2e5f 5f6e 616d 655f 5f2c  _point.__name__,
-00025aa0: 0a20 2020 2020 2020 2020 2020 2069 6e73  .            ins
-00025ab0: 7461 6e63 653d 7061 7468 2c0a 2020 2020  tance=path,.    
-00025ac0: 2020 2020 2020 2020 6163 6365 7074 6564          accepted
-00025ad0: 5f74 7970 6573 3d28 4c69 6e65 5374 7269  _types=(LineStri
-00025ae0: 6e67 2c20 6e70 2e6e 6461 7272 6179 292c  ng, np.ndarray),
-00025af0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00025b00: 2020 2063 6865 636b 5f69 6e73 7461 6e63     check_instanc
-00025b10: 6528 0a20 2020 2020 2020 2020 2020 2073  e(.            s
-00025b20: 6f75 7263 653d 4765 6f6d 6574 7279 4d69  ource=GeometryMi
-00025b30: 7869 6e2e 6c6f 6361 7465 5f6c 696e 655f  xin.locate_line_
-00025b40: 706f 696e 742e 5f5f 6e61 6d65 5f5f 2c0a  point.__name__,.
-00025b50: 2020 2020 2020 2020 2020 2020 696e 7374              inst
-00025b60: 616e 6365 3d67 656f 6d65 7472 792c 0a20  ance=geometry,. 
-00025b70: 2020 2020 2020 2020 2020 2061 6363 6570             accep
-00025b80: 7465 645f 7479 7065 733d 284c 696e 6553  ted_types=(LineS
-00025b90: 7472 696e 672c 2050 6f6c 7967 6f6e 2c20  tring, Polygon, 
-00025ba0: 506f 696e 7429 2c0a 2020 2020 2020 2020  Point),.        
-00025bb0: 290a 2020 2020 2020 2020 6368 6563 6b5f  ).        check_
-00025bc0: 696e 7428 0a20 2020 2020 2020 2020 2020  int(.           
-00025bd0: 206e 616d 653d 2243 4f52 4520 434f 554e   name="CORE COUN
-00025be0: 5422 2c0a 2020 2020 2020 2020 2020 2020  T",.            
-00025bf0: 7661 6c75 653d 636f 7265 5f63 6e74 2c0a  value=core_cnt,.
-00025c00: 2020 2020 2020 2020 2020 2020 6d69 6e5f              min_
-00025c10: 7661 6c75 653d 2d31 2c0a 2020 2020 2020  value=-1,.      
-00025c20: 2020 2020 2020 6d61 785f 7661 6c75 653d        max_value=
-00025c30: 6669 6e64 5f63 6f72 655f 636e 7428 295b  find_core_cnt()[
-00025c40: 305d 2c0a 2020 2020 2020 2020 2020 2020  0],.            
-00025c50: 7261 6973 655f 6572 726f 723d 5472 7565  raise_error=True
-00025c60: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00025c70: 2020 2020 6368 6563 6b5f 666c 6f61 7428      check_float(
-00025c80: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
-00025c90: 653d 2250 4958 454c 5320 5045 5220 4d4d  e="PIXELS PER MM
-00025ca0: 222c 2076 616c 7565 3d70 785f 7065 725f  ", value=px_per_
-00025cb0: 6d6d 2c20 6d69 6e5f 7661 6c75 653d 302e  mm, min_value=0.
-00025cc0: 312c 2072 6169 7365 5f65 7272 6f72 3d54  1, raise_error=T
-00025cd0: 7275 650a 2020 2020 2020 2020 290a 2020  rue.        ).  
-00025ce0: 2020 2020 2020 6368 6563 6b5f 666c 6f61        check_floa
-00025cf0: 7428 6e61 6d65 3d22 4650 5322 2c20 7661  t(name="FPS", va
-00025d00: 6c75 653d 6670 732c 206d 696e 5f76 616c  lue=fps, min_val
-00025d10: 7565 3d31 2c20 7261 6973 655f 6572 726f  ue=1, raise_erro
-00025d20: 723d 5472 7565 290a 2020 2020 2020 2020  r=True).        
-00025d30: 6966 2063 6f72 655f 636e 7420 3d3d 202d  if core_cnt == -
-00025d40: 313a 0a20 2020 2020 2020 2020 2020 2063  1:.            c
-00025d50: 6f72 655f 636e 7420 3d20 6669 6e64 5f63  ore_cnt = find_c
-00025d60: 6f72 655f 636e 7428 295b 305d 0a0a 2020  ore_cnt()[0]..  
-00025d70: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-00025d80: 6e63 6528 7061 7468 2c20 6e70 2e6e 6461  nce(path, np.nda
-00025d90: 7272 6179 293a 0a20 2020 2020 2020 2020  rray):.         
-00025da0: 2020 2063 6865 636b 5f76 616c 6964 5f61     check_valid_a
-00025db0: 7272 6179 280a 2020 2020 2020 2020 2020  rray(.          
-00025dc0: 2020 2020 2020 6461 7461 3d70 6174 682c        data=path,
-00025dd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00025de0: 2061 6363 6570 7465 645f 6178 6973 5f31   accepted_axis_1
-00025df0: 5f73 6861 7065 3d28 322c 292c 0a20 2020  _shape=(2,),.   
-00025e00: 2020 2020 2020 2020 2020 2020 2061 6363               acc
-00025e10: 6570 7465 645f 6474 7970 6573 3d28 6e70  epted_dtypes=(np
-00025e20: 2e66 6c6f 6174 3332 2c20 6e70 2e66 6c6f  .float32, np.flo
-00025e30: 6174 3634 2c20 6e70 2e69 6e74 3634 2c20  at64, np.int64, 
-00025e40: 6e70 2e69 6e74 3332 292c 0a20 2020 2020  np.int32),.     
-00025e50: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00025e60: 2020 2020 2070 6174 6820 3d20 4c69 6e65       path = Line
-00025e70: 5374 7269 6e67 2870 6174 6829 0a20 2020  String(path).   
-00025e80: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-00025e90: 6365 2867 656f 6d65 7472 792c 2050 6f69  ce(geometry, Poi
-00025ea0: 6e74 293a 0a20 2020 2020 2020 2020 2020  nt):.           
-00025eb0: 2067 656f 6d65 7472 7920 3d20 6e70 2e61   geometry = np.a
-00025ec0: 7272 6179 2867 656f 6d65 7472 792e 636f  rray(geometry.co
-00025ed0: 6f72 6473 290a 2020 2020 2020 2020 2020  ords).          
-00025ee0: 2020 6469 7374 616e 6365 7320 3d20 4665    distances = Fe
-00025ef0: 6174 7572 6545 7874 7261 6374 696f 6e4d  atureExtractionM
-00025f00: 6978 696e 2e66 7261 6d65 7769 7365 5f65  ixin.framewise_e
-00025f10: 7563 6c69 6465 616e 5f64 6973 7461 6e63  uclidean_distanc
-00025f20: 655f 726f 6928 0a20 2020 2020 2020 2020  e_roi(.         
-00025f30: 2020 2020 2020 206c 6f63 6174 696f 6e5f         location_
-00025f40: 313d 6e70 2e61 7272 6179 2870 6174 682e  1=np.array(path.
-00025f50: 636f 6f72 6473 292c 0a20 2020 2020 2020  coords),.       
-00025f60: 2020 2020 2020 2020 206c 6f63 6174 696f           locatio
-00025f70: 6e5f 323d 6765 6f6d 6574 7279 2c0a 2020  n_2=geometry,.  
-00025f80: 2020 2020 2020 2020 2020 2020 2020 7078                px
-00025f90: 5f70 6572 5f6d 6d3d 7078 5f70 6572 5f6d  _per_mm=px_per_m
-00025fa0: 6d2c 0a20 2020 2020 2020 2020 2020 2029  m,.            )
-00025fb0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00025fc0: 2020 2020 2020 2020 2020 2070 6f69 6e74             point
-00025fd0: 7320 3d20 5b50 6f69 6e74 2878 2920 666f  s = [Point(x) fo
-00025fe0: 7220 7820 696e 206e 702e 6172 7261 7928  r x in np.array(
-00025ff0: 7061 7468 2e63 6f6f 7264 7329 5d0a 2020  path.coords)].  
-00026000: 2020 2020 2020 2020 2020 6765 6f6d 6574            geomet
-00026010: 7279 203d 205b 6765 6f6d 6574 7279 2066  ry = [geometry f
-00026020: 6f72 2078 2069 6e20 7261 6e67 6528 6c65  or x in range(le
-00026030: 6e28 706f 696e 7473 2929 5d0a 2020 2020  n(points))].    
-00026040: 2020 2020 2020 2020 6469 7374 616e 6365          distance
-00026050: 7320 3d20 4765 6f6d 6574 7279 4d69 7869  s = GeometryMixi
-00026060: 6e28 292e 6d75 6c74 6966 7261 6d65 5f73  n().multiframe_s
-00026070: 6861 7065 5f64 6973 7461 6e63 6528 0a20  hape_distance(. 
-00026080: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00026090: 6861 7065 5f31 3d70 6f69 6e74 732c 0a20  hape_1=points,. 
-000260a0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000260b0: 6861 7065 5f32 3d67 656f 6d65 7472 792c  hape_2=geometry,
-000260c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000260d0: 2070 6978 656c 735f 7065 725f 6d6d 3d70   pixels_per_mm=p
-000260e0: 785f 7065 725f 6d6d 2c0a 2020 2020 2020  x_per_mm,.      
-000260f0: 2020 2020 2020 2020 2020 636f 7265 5f63            core_c
-00026100: 6e74 3d63 6f72 655f 636e 742c 0a20 2020  nt=core_cnt,.   
-00026110: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00026120: 2020 2020 6966 2064 6973 7461 6e63 655f      if distance_
-00026130: 6d69 6e3a 0a20 2020 2020 2020 2020 2020  min:.           
-00026140: 2064 6973 7461 6e63 655f 6964 7820 3d20   distance_idx = 
-00026150: 6e70 2e61 7267 6d69 6e28 6469 7374 616e  np.argmin(distan
-00026160: 6365 7329 0a20 2020 2020 2020 2065 6c73  ces).        els
-00026170: 653a 0a20 2020 2020 2020 2020 2020 2064  e:.            d
-00026180: 6973 7461 6e63 655f 6964 7820 3d20 6e70  istance_idx = np
-00026190: 2e61 7267 6d61 7828 6469 7374 616e 6365  .argmax(distance
-000261a0: 7329 0a20 2020 2020 2020 2069 6620 7469  s).        if ti
-000261b0: 6d65 5f70 7269 6f72 3a0a 2020 2020 2020  me_prior:.      
-000261c0: 2020 2020 2020 6469 7374 5f74 7261 7665        dist_trave
-000261d0: 6c6c 6564 203d 2028 0a20 2020 2020 2020  lled = (.       
-000261e0: 2020 2020 2020 2020 206e 702e 7375 6d28           np.sum(
-000261f0: 6e70 2e61 6273 286e 702e 6469 6666 2864  np.abs(np.diff(d
-00026200: 6973 7461 6e63 6573 5b3a 2064 6973 7461  istances[: dista
-00026210: 6e63 655f 6964 7820 2b20 315d 2929 2920  nce_idx + 1]))) 
-00026220: 2f20 7078 5f70 6572 5f6d 6d0a 2020 2020  / px_per_mm.    
-00026230: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00026240: 2020 2020 2020 7469 6d65 5f74 7261 7665        time_trave
-00026250: 6c6c 6564 203d 2064 6973 7461 6e63 655f  lled = distance_
-00026260: 6964 7820 2f20 6670 730a 2020 2020 2020  idx / fps.      
-00026270: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00026280: 2020 2020 6469 7374 5f74 7261 7665 6c6c      dist_travell
-00026290: 6564 203d 2028 0a20 2020 2020 2020 2020  ed = (.         
-000262a0: 2020 2020 2020 206e 702e 7375 6d28 6e70         np.sum(np
-000262b0: 2e61 6273 286e 702e 6469 6666 2864 6973  .abs(np.diff(dis
-000262c0: 7461 6e63 6573 5b64 6973 7461 6e63 655f  tances[distance_
-000262d0: 6964 783a 5d29 2929 202f 2070 785f 7065  idx:]))) / px_pe
-000262e0: 725f 6d6d 0a20 2020 2020 2020 2020 2020  r_mm.           
-000262f0: 2029 0a20 2020 2020 2020 2020 2020 2074   ).            t
-00026300: 696d 655f 7472 6176 656c 6c65 6420 3d20  ime_travelled = 
-00026310: 2864 6973 7461 6e63 6573 202d 2064 6973  (distances - dis
-00026320: 7461 6e63 655f 6964 7829 202f 2066 7073  tance_idx) / fps
-00026330: 0a20 2020 2020 2020 2064 6973 745f 7661  .        dist_va
-00026340: 6c20 3d20 6469 7374 616e 6365 735b 6469  l = distances[di
-00026350: 7374 616e 6365 5f69 6478 5d20 2f20 7078  stance_idx] / px
-00026360: 5f70 6572 5f6d 6d0a 0a20 2020 2020 2020  _per_mm..       
-00026370: 2072 6574 7572 6e20 7b0a 2020 2020 2020   return {.      
-00026380: 2020 2020 2020 2264 6973 7461 6e63 655f        "distance_
-00026390: 7661 6c75 6522 3a20 6469 7374 5f76 616c  value": dist_val
-000263a0: 2c0a 2020 2020 2020 2020 2020 2020 2264  ,.            "d
-000263b0: 6973 7461 6e63 655f 7472 6176 656c 6c65  istance_travelle
-000263c0: 6422 3a20 6469 7374 5f74 7261 7665 6c6c  d": dist_travell
-000263d0: 6564 2c0a 2020 2020 2020 2020 2020 2020  ed,.            
-000263e0: 2274 696d 655f 7472 6176 656c 6c65 6422  "time_travelled"
-000263f0: 3a20 7469 6d65 5f74 7261 7665 6c6c 6564  : time_travelled
-00026400: 2c0a 2020 2020 2020 2020 2020 2020 2264  ,.            "d
-00026410: 6973 7461 6e63 655f 696e 6465 7822 3a20  istance_index": 
-00026420: 6469 7374 616e 6365 5f69 6478 2c0a 2020  distance_idx,.  
-00026430: 2020 2020 2020 7d0a 0a20 2020 2040 7374        }..    @st
-00026440: 6174 6963 6d65 7468 6f64 0a20 2020 2040  aticmethod.    @
-00026450: 6e6a 6974 2822 2866 6c6f 6174 3332 5b3a  njit("(float32[:
-00026460: 2c3a 5d2c 2066 6c6f 6174 3332 5b3a 2c3a  ,:], float32[:,:
-00026470: 5d2c 2069 6e74 3634 2922 290a 2020 2020  ], int64)").    
-00026480: 6465 6620 6c69 6e65 6172 5f66 7265 6368  def linear_frech
-00026490: 6574 5f64 6973 7461 6e63 6528 0a20 2020  et_distance(.   
-000264a0: 2020 2020 2078 3a20 6e70 2e6e 6461 7272       x: np.ndarr
-000264b0: 6179 2c20 793a 206e 702e 6e64 6172 7261  ay, y: np.ndarra
-000264c0: 792c 2073 616d 706c 653a 2069 6e74 203d  y, sample: int =
-000264d0: 2031 3030 0a20 2020 2029 202d 3e20 666c   100.    ) -> fl
-000264e0: 6f61 743a 0a20 2020 2020 2020 2022 2222  oat:.        """
-000264f0: 0a20 2020 2020 2020 2043 6f6d 7075 7465  .        Compute
-00026500: 2074 6865 204c 696e 6561 7220 4672 c3a9   the Linear Fr..
-00026510: 6368 6574 2044 6973 7461 6e63 6520 6265  chet Distance be
-00026520: 7477 6565 6e20 7477 6f20 7472 616a 6563  tween two trajec
-00026530: 746f 7269 6573 2e0a 0a20 2020 2020 2020  tories...       
-00026540: 2054 6865 2046 72c3 a963 6865 7420 4469   The Fr..chet Di
-00026550: 7374 616e 6365 206d 6561 7375 7265 7320  stance measures 
-00026560: 7468 6520 6469 7373 696d 696c 6172 6974  the dissimilarit
-00026570: 7920 6265 7477 6565 6e20 7477 6f20 636f  y between two co
-00026580: 6e74 696e 756f 7573 0a20 2020 2020 2020  ntinuous.       
-00026590: 2063 7572 7665 7320 6f72 2074 7261 6a65   curves or traje
-000265a0: 6374 6f72 6965 7320 7265 7072 6573 656e  ctories represen
-000265b0: 7465 6420 6173 2073 6571 7565 6e63 6573  ted as sequences
-000265c0: 206f 6620 706f 696e 7473 2069 6e20 6120   of points in a 
-000265d0: 322d 6469 6d65 6e73 696f 6e61 6c0a 2020  2-dimensional.  
-000265e0: 2020 2020 2020 7370 6163 652e 0a0a 2020        space...  
-000265f0: 2020 2020 2020 3a70 6172 616d 206e 6461        :param nda
-00026600: 7272 6179 2064 6174 613a 2046 6972 7374  rray data: First
-00026610: 2032 4420 6172 7261 7920 6f66 2073 697a   2D array of siz
-00026620: 6520 6c65 6e28 6672 616d 6573 2920 7265  e len(frames) re
-00026630: 7072 6573 656e 7469 6e67 2062 6f64 792d  presenting body-
-00026640: 7061 7274 2063 6f6f 7264 696e 6174 6573  part coordinates
-00026650: 2078 2061 6e64 2079 2e0a 2020 2020 2020   x and y..      
-00026660: 2020 3a70 6172 616d 206e 6461 7272 6179    :param ndarray
-00026670: 2064 6174 613a 2053 6563 6f6e 6420 3244   data: Second 2D
-00026680: 2061 7272 6179 206f 6620 7369 7a65 206c   array of size l
-00026690: 656e 2866 7261 6d65 7329 2072 6570 7265  en(frames) repre
-000266a0: 7365 6e74 696e 6720 626f 6479 2d70 6172  senting body-par
-000266b0: 7420 636f 6f72 6469 6e61 7465 7320 7820  t coordinates x 
-000266c0: 616e 6420 792e 0a20 2020 2020 2020 203a  and y..        :
-000266d0: 7061 7261 6d20 696e 7420 7361 6d70 6c65  param int sample
-000266e0: 3a20 5468 6520 646f 776e 7361 6d70 6c69  : The downsampli
-000266f0: 6e67 2066 6163 746f 7220 666f 7220 7468  ng factor for th
-00026700: 6520 7472 616a 6563 746f 7269 6573 2028  e trajectories (
-00026710: 6465 6661 756c 7420 6973 2031 3030 4966  default is 100If
-00026720: 2073 616d 706c 6520 3e20 312c 2074 6865   sample > 1, the
-00026730: 2074 7261 6a65 6374 6f72 6965 7320 6172   trajectories ar
-00026740: 6520 646f 776e 7361 6d70 6c65 6420 6279  e downsampled by
-00026750: 2073 656c 6563 7469 6e67 2065 7665 7279   selecting every
-00026760: 2073 616d 706c 652d 7468 2070 6f69 6e74   sample-th point
-00026770: 2e0a 0a20 2020 2020 2020 202e 2e20 6e6f  ...        .. no
-00026780: 7465 3a3a 0a20 2020 2020 2020 2020 2020  te::.           
-00026790: 536c 6967 6874 6c79 206d 6f64 6966 6965  Slightly modifie
-000267a0: 6420 6672 6f6d 2060 4a6f c3a3 6f20 5061  d from `Jo..o Pa
-000267b0: 756c 6f20 4669 6775 6569 7261 203c 6874  ulo Figueira <ht
-000267c0: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
-000267d0: 2f6a 6f61 6f66 6967 2f64 6973 6372 6574  /joaofig/discret
-000267e0: 652d 6672 6563 6865 742f 626c 6f62 2f66  e-frechet/blob/f
-000267f0: 6635 3632 3965 3561 3433 6366 6164 3434  f5629e5a43cfad44
-00026800: 6435 6539 3632 6634 3130 3564 6432 3563  d5e962f4105dd25c
-00026810: 3930 6239 3238 392f 6469 7374 616e 6365  90b9289/distance
-00026820: 732f 6469 7363 7265 7465 2e70 7923 4c36  s/discrete.py#L6
-00026830: 373e 605f 0a0a 2020 2020 2020 2020 3a65  7>`_..        :e
-00026840: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
-00026850: 3e3e 3e20 7820 3d20 6e70 2e72 616e 646f  >>> x = np.rando
-00026860: 6d2e 7261 6e64 696e 7428 302c 2031 3030  m.randint(0, 100
-00026870: 2c20 2831 3030 3030 2c20 3229 292e 6173  , (10000, 2)).as
-00026880: 7479 7065 286e 702e 666c 6f61 7433 3229  type(np.float32)
-00026890: 0a20 2020 2020 2020 203e 3e3e 2079 203d  .        >>> y =
-000268a0: 206e 702e 7261 6e64 6f6d 2e72 616e 6469   np.random.randi
-000268b0: 6e74 2830 2c20 3130 302c 2028 3130 3030  nt(0, 100, (1000
-000268c0: 302c 2032 2929 2e61 7374 7970 6528 6e70  0, 2)).astype(np
-000268d0: 2e66 6c6f 6174 3332 290a 2020 2020 2020  .float32).      
-000268e0: 2020 3e3e 3e20 6469 7374 616e 6365 203d    >>> distance =
-000268f0: 2047 656f 6d65 7472 794d 6978 696e 2e6c   GeometryMixin.l
-00026900: 696e 6561 725f 6672 6563 6865 745f 6469  inear_frechet_di
-00026910: 7374 616e 6365 2878 3d78 2c20 793d 792c  stance(x=x, y=y,
-00026920: 2073 616d 706c 653d 3130 3029 0a0a 2020   sample=100)..  
-00026930: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00026940: 2020 6966 2073 616d 706c 6520 3e20 313a    if sample > 1:
-00026950: 0a20 2020 2020 2020 2020 2020 2078 2c20  .            x, 
-00026960: 7920 3d20 785b 3a3a 7361 6d70 6c65 5d2c  y = x[::sample],
-00026970: 2079 5b3a 3a73 616d 706c 655d 0a20 2020   y[::sample].   
-00026980: 2020 2020 206e 5f70 2c20 6e5f 7120 3d20       n_p, n_q = 
-00026990: 782e 7368 6170 655b 305d 2c20 792e 7368  x.shape[0], y.sh
-000269a0: 6170 655b 305d 0a20 2020 2020 2020 2063  ape[0].        c
-000269b0: 6120 3d20 6e70 2e66 756c 6c28 286e 5f70  a = np.full((n_p
-000269c0: 2c20 6e5f 7129 2c20 302e 3029 0a20 2020  , n_q), 0.0).   
-000269d0: 2020 2020 2066 6f72 2069 2069 6e20 7072       for i in pr
-000269e0: 616e 6765 286e 5f70 293a 0a20 2020 2020  ange(n_p):.     
-000269f0: 2020 2020 2020 2066 6f72 206a 2069 6e20         for j in 
-00026a00: 7261 6e67 6528 6e5f 7129 3a0a 2020 2020  range(n_q):.    
-00026a10: 2020 2020 2020 2020 2020 2020 6420 3d20              d = 
-00026a20: 785b 695d 202d 2079 5b6a 5d0a 2020 2020  x[i] - y[j].    
-00026a30: 2020 2020 2020 2020 2020 2020 6420 3d20              d = 
-00026a40: 6e70 2e73 7172 7428 6e70 2e64 6f74 2864  np.sqrt(np.dot(d
-00026a50: 2c20 6429 290a 2020 2020 2020 2020 2020  , d)).          
-00026a60: 2020 2020 2020 6966 2069 203e 2030 2061        if i > 0 a
-00026a70: 6e64 206a 203e 2030 3a0a 2020 2020 2020  nd j > 0:.      
-00026a80: 2020 2020 2020 2020 2020 2020 2020 6361                ca
-00026a90: 5b69 2c20 6a5d 203d 206d 6178 286d 696e  [i, j] = max(min
-00026aa0: 2863 615b 6920 2d20 312c 206a 5d2c 2063  (ca[i - 1, j], c
-00026ab0: 615b 6920 2d20 312c 206a 202d 2031 5d2c  a[i - 1, j - 1],
-00026ac0: 2063 615b 692c 206a 202d 2031 5d29 2c20   ca[i, j - 1]), 
-00026ad0: 6429 0a20 2020 2020 2020 2020 2020 2020  d).             
-00026ae0: 2020 2065 6c69 6620 6920 3e20 3020 616e     elif i > 0 an
-00026af0: 6420 6a20 3d3d 2030 3a0a 2020 2020 2020  d j == 0:.      
-00026b00: 2020 2020 2020 2020 2020 2020 2020 6361                ca
-00026b10: 5b69 2c20 6a5d 203d 206d 6178 2863 615b  [i, j] = max(ca[
-00026b20: 6920 2d20 312c 2030 5d2c 2064 290a 2020  i - 1, 0], d).  
-00026b30: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00026b40: 6966 2069 203d 3d20 3020 616e 6420 6a20  if i == 0 and j 
-00026b50: 3e20 303a 0a20 2020 2020 2020 2020 2020  > 0:.           
-00026b60: 2020 2020 2020 2020 2063 615b 692c 206a           ca[i, j
-00026b70: 5d20 3d20 6d61 7828 6361 5b30 2c20 6a20  ] = max(ca[0, j 
-00026b80: 2d20 315d 2c20 6429 0a20 2020 2020 2020  - 1], d).       
-00026b90: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00026ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026bb0: 2020 2063 615b 692c 206a 5d20 3d20 640a     ca[i, j] = d.
-00026bc0: 2020 2020 2020 2020 7265 7475 726e 2063          return c
-00026bd0: 615b 6e5f 7020 2d20 312c 206e 5f71 202d  a[n_p - 1, n_q -
-00026be0: 2031 5d0a 0a20 2020 2040 7374 6174 6963   1]..    @static
-00026bf0: 6d65 7468 6f64 0a20 2020 2064 6566 2073  method.    def s
-00026c00: 696d 6261 5f72 6f69 5f74 6f5f 6765 6f6d  imba_roi_to_geom
-00026c10: 6574 7269 6573 280a 2020 2020 2020 2020  etries(.        
-00026c20: 7265 6374 616e 676c 6573 5f64 663a 2070  rectangles_df: p
-00026c30: 642e 4461 7461 4672 616d 652c 0a20 2020  d.DataFrame,.   
-00026c40: 2020 2020 2063 6972 636c 6573 5f64 663a       circles_df:
-00026c50: 2070 642e 4461 7461 4672 616d 652c 0a20   pd.DataFrame,. 
-00026c60: 2020 2020 2020 2070 6f6c 7967 6f6e 735f         polygons_
-00026c70: 6466 3a20 7064 2e44 6174 6146 7261 6d65  df: pd.DataFrame
-00026c80: 2c0a 2020 2020 2020 2020 636f 6c6f 723a  ,.        color:
-00026c90: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
-00026ca0: 3d20 4661 6c73 652c 0a20 2020 2029 202d  = False,.    ) -
-00026cb0: 3e20 6469 6374 3a0a 2020 2020 2020 2020  > dict:.        
-00026cc0: 2222 220a 2020 2020 2020 2020 436f 6e76  """.        Conv
-00026cd0: 6572 7420 5369 6d42 4120 6461 7461 6672  ert SimBA datafr
-00026ce0: 616d 6573 2068 6f6c 6469 6e67 2052 4f49  ames holding ROI
-00026cf0: 2067 656f 6d65 7472 6965 7320 746f 206e   geometries to n
-00026d00: 6573 7465 6420 6469 6374 696f 6e61 7279  ested dictionary
-00026d10: 2068 6f6c 6469 6e67 2053 6861 706c 6579   holding Shapley
-00026d20: 2070 6f6c 7967 6f6e 732e 0a0a 2020 2020   polygons...    
-00026d30: 2020 2020 3a65 7861 6d70 6c65 3a0a 2020      :example:.  
-00026d40: 2020 2020 2020 3e3e 3e20 2363 6f6e 6669        >>> #confi
-00026d50: 675f 7061 7468 203d 2027 2f55 7365 7273  g_path = '/Users
-00026d60: 2f73 696d 6f6e 2f44 6573 6b74 6f70 2f65  /simon/Desktop/e
-00026d70: 6e76 732f 7369 6d62 612f 7472 6f75 626c  nvs/simba/troubl
-00026d80: 6573 686f 6f74 696e 672f 7370 6f6e 7465  eshooting/sponte
-00026d90: 6e6f 7573 5f61 6c74 6572 6e61 7469 6f6e  nous_alternation
-00026da0: 2f70 726f 6a65 6374 5f66 6f6c 6465 722f  /project_folder/
-00026db0: 7072 6f6a 6563 745f 636f 6e66 6967 2e69  project_config.i
-00026dc0: 6e69 270a 2020 2020 2020 2020 3e3e 3e20  ni'.        >>> 
-00026dd0: 2363 6f6e 6669 6720 3d20 436f 6e66 6967  #config = Config
-00026de0: 5265 6164 6572 2863 6f6e 6669 675f 7061  Reader(config_pa
-00026df0: 7468 3d63 6f6e 6669 675f 7061 7468 290a  th=config_path).
-00026e00: 2020 2020 2020 2020 3e3e 3e20 2363 6f6e          >>> #con
-00026e10: 6669 672e 7265 6164 5f72 6f69 5f64 6174  fig.read_roi_dat
-00026e20: 6128 290a 2020 2020 2020 2020 3e3e 3e20  a().        >>> 
-00026e30: 2347 656f 6d65 7472 794d 6978 696e 2e73  #GeometryMixin.s
-00026e40: 696d 6261 5f72 6f69 5f74 6f5f 6765 6f6d  imba_roi_to_geom
-00026e50: 6574 7269 6573 2872 6563 7461 6e67 6c65  etries(rectangle
-00026e60: 735f 6466 3d63 6f6e 6669 672e 7265 6374  s_df=config.rect
-00026e70: 616e 676c 6573 5f64 662c 2063 6972 636c  angles_df, circl
-00026e80: 6573 5f64 663d 636f 6e66 6967 2e63 6972  es_df=config.cir
-00026e90: 636c 6573 5f64 662c 2070 6f6c 7967 6f6e  cles_df, polygon
-00026ea0: 735f 6466 3d63 6f6e 6669 672e 706f 6c79  s_df=config.poly
-00026eb0: 676f 6e5f 6466 290a 2020 2020 2020 2020  gon_df).        
-00026ec0: 2222 220a 0a20 2020 2020 2020 2063 6865  """..        che
-00026ed0: 636b 5f69 6e73 7461 6e63 6528 0a20 2020  ck_instance(.   
-00026ee0: 2020 2020 2020 2020 2073 6f75 7263 653d           source=
-00026ef0: 4765 6f6d 6574 7279 4d69 7869 6e2e 7369  GeometryMixin.si
-00026f00: 6d62 615f 726f 695f 746f 5f67 656f 6d65  mba_roi_to_geome
-00026f10: 7472 6965 732e 5f5f 6e61 6d65 5f5f 2c0a  tries.__name__,.
-00026f20: 2020 2020 2020 2020 2020 2020 696e 7374              inst
-00026f30: 616e 6365 3d72 6563 7461 6e67 6c65 735f  ance=rectangles_
-00026f40: 6466 2c0a 2020 2020 2020 2020 2020 2020  df,.            
-00026f50: 6163 6365 7074 6564 5f74 7970 6573 3d28  accepted_types=(
-00026f60: 7064 2e44 6174 6146 7261 6d65 2c29 2c0a  pd.DataFrame,),.
-00026f70: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00026f80: 2020 6368 6563 6b5f 696e 7374 616e 6365    check_instance
-00026f90: 280a 2020 2020 2020 2020 2020 2020 736f  (.            so
-00026fa0: 7572 6365 3d47 656f 6d65 7472 794d 6978  urce=GeometryMix
-00026fb0: 696e 2e73 696d 6261 5f72 6f69 5f74 6f5f  in.simba_roi_to_
-00026fc0: 6765 6f6d 6574 7269 6573 2e5f 5f6e 616d  geometries.__nam
-00026fd0: 655f 5f2c 0a20 2020 2020 2020 2020 2020  e__,.           
-00026fe0: 2069 6e73 7461 6e63 653d 6369 7263 6c65   instance=circle
-00026ff0: 735f 6466 2c0a 2020 2020 2020 2020 2020  s_df,.          
-00027000: 2020 6163 6365 7074 6564 5f74 7970 6573    accepted_types
-00027010: 3d28 7064 2e44 6174 6146 7261 6d65 2c29  =(pd.DataFrame,)
-00027020: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00027030: 2020 2020 6368 6563 6b5f 696e 7374 616e      check_instan
-00027040: 6365 280a 2020 2020 2020 2020 2020 2020  ce(.            
-00027050: 736f 7572 6365 3d47 656f 6d65 7472 794d  source=GeometryM
-00027060: 6978 696e 2e73 696d 6261 5f72 6f69 5f74  ixin.simba_roi_t
-00027070: 6f5f 6765 6f6d 6574 7269 6573 2e5f 5f6e  o_geometries.__n
-00027080: 616d 655f 5f2c 0a20 2020 2020 2020 2020  ame__,.         
-00027090: 2020 2069 6e73 7461 6e63 653d 706f 6c79     instance=poly
-000270a0: 676f 6e73 5f64 662c 0a20 2020 2020 2020  gons_df,.       
-000270b0: 2020 2020 2061 6363 6570 7465 645f 7479       accepted_ty
-000270c0: 7065 733d 2870 642e 4461 7461 4672 616d  pes=(pd.DataFram
-000270d0: 652c 292c 0a20 2020 2020 2020 2029 0a20  e,),.        ). 
-000270e0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-000270f0: 5b72 6563 7461 6e67 6c65 735f 6466 2c20  [rectangles_df, 
-00027100: 6369 7263 6c65 735f 6466 2c20 706f 6c79  circles_df, poly
-00027110: 676f 6e73 5f64 665d 3a0a 2020 2020 2020  gons_df]:.      
-00027120: 2020 2020 2020 6368 6563 6b5f 7468 6174        check_that
-00027130: 5f63 6f6c 756d 6e5f 6578 6973 7428 0a20  _column_exist(. 
-00027140: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00027150: 663d 692c 2063 6f6c 756d 6e5f 6e61 6d65  f=i, column_name
-00027160: 3d5b 2256 6964 656f 222c 2022 4e61 6d65  =["Video", "Name
-00027170: 222c 2022 5461 6773 222c 2022 436f 6c6f  ", "Tags", "Colo
-00027180: 7220 4247 5222 5d2c 2066 696c 655f 6e61  r BGR"], file_na
-00027190: 6d65 3d22 220a 2020 2020 2020 2020 2020  me="".          
-000271a0: 2020 290a 2020 2020 2020 2020 7265 7375    ).        resu
-000271b0: 6c74 735f 726f 692c 2072 6573 756c 7473  lts_roi, results
-000271c0: 5f63 6c72 203d 207b 7d2c 207b 7d0a 2020  _clr = {}, {}.  
-000271d0: 2020 2020 2020 666f 7220 7669 6465 6f5f        for video_
-000271e0: 6e61 6d65 2069 6e20 7265 6374 616e 676c  name in rectangl
-000271f0: 6573 5f64 665b 2256 6964 656f 225d 2e75  es_df["Video"].u
-00027200: 6e69 7175 6528 293a 0a20 2020 2020 2020  nique():.       
-00027210: 2020 2020 2069 6620 7669 6465 6f5f 6e61       if video_na
-00027220: 6d65 206e 6f74 2069 6e20 7265 7375 6c74  me not in result
-00027230: 735f 726f 692e 6b65 7973 2829 3a0a 2020  s_roi.keys():.  
-00027240: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00027250: 7375 6c74 735f 726f 695b 7669 6465 6f5f  sults_roi[video_
-00027260: 6e61 6d65 5d20 3d20 7b7d 0a20 2020 2020  name] = {}.     
-00027270: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-00027280: 7473 5f63 6c72 5b76 6964 656f 5f6e 616d  ts_clr[video_nam
-00027290: 655d 203d 207b 7d0a 2020 2020 2020 2020  e] = {}.        
-000272a0: 2020 2020 7669 6465 6f5f 7368 6170 6573      video_shapes
-000272b0: 203d 2072 6563 7461 6e67 6c65 735f 6466   = rectangles_df
-000272c0: 5b5b 2254 6167 7322 2c20 224e 616d 6522  [["Tags", "Name"
-000272d0: 2c20 2243 6f6c 6f72 2042 4752 225d 5d5b  , "Color BGR"]][
-000272e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000272f0: 2072 6563 7461 6e67 6c65 735f 6466 5b22   rectangles_df["
-00027300: 5669 6465 6f22 5d20 3d3d 2076 6964 656f  Video"] == video
-00027310: 5f6e 616d 650a 2020 2020 2020 2020 2020  _name.          
-00027320: 2020 5d0a 2020 2020 2020 2020 2020 2020    ].            
-00027330: 666f 7220 7368 6170 655f 6e61 6d65 2069  for shape_name i
-00027340: 6e20 7669 6465 6f5f 7368 6170 6573 5b22  n video_shapes["
-00027350: 4e61 6d65 225d 2e75 6e69 7175 6528 293a  Name"].unique():
-00027360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027370: 2073 6861 7065 5f64 6174 6120 3d20 7669   shape_data = vi
-00027380: 6465 6f5f 7368 6170 6573 5b0a 2020 2020  deo_shapes[.    
-00027390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000273a0: 7669 6465 6f5f 7368 6170 6573 5b22 4e61  video_shapes["Na
-000273b0: 6d65 225d 203d 3d20 7368 6170 655f 6e61  me"] == shape_na
-000273c0: 6d65 0a20 2020 2020 2020 2020 2020 2020  me.             
-000273d0: 2020 205d 2e72 6573 6574 5f69 6e64 6578     ].reset_index
-000273e0: 2864 726f 703d 5472 7565 290a 2020 2020  (drop=True).    
-000273f0: 2020 2020 2020 2020 2020 2020 7461 6773              tags
-00027400: 2c20 6e61 6d65 203d 2028 0a20 2020 2020  , name = (.     
-00027410: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00027420: 6973 7428 7368 6170 655f 6461 7461 5b22  ist(shape_data["
-00027430: 5461 6773 225d 2e76 616c 7565 735b 305d  Tags"].values[0]
-00027440: 2e76 616c 7565 7328 2929 2c0a 2020 2020  .values()),.    
-00027450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027460: 7368 6170 655f 6461 7461 5b22 4e61 6d65  shape_data["Name
-00027470: 225d 2e76 616c 7565 735b 305d 2c0a 2020  "].values[0],.  
-00027480: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00027490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000274a0: 7265 7375 6c74 735f 726f 695b 7669 6465  results_roi[vide
-000274b0: 6f5f 6e61 6d65 5d5b 6e61 6d65 5d20 3d20  o_name][name] = 
-000274c0: 506f 6c79 676f 6e28 0a20 2020 2020 2020  Polygon(.       
-000274d0: 2020 2020 2020 2020 2020 2020 2050 6f6c               Pol
-000274e0: 7967 6f6e 2874 6167 7329 2e63 6f6e 7665  ygon(tags).conve
-000274f0: 785f 6875 6c6c 2e65 7874 6572 696f 722e  x_hull.exterior.
-00027500: 636f 6f72 6473 0a20 2020 2020 2020 2020  coords.         
-00027510: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00027520: 2020 2020 2020 2020 2072 6573 756c 7473           results
-00027530: 5f63 6c72 5b76 6964 656f 5f6e 616d 655d  _clr[video_name]
-00027540: 5b6e 616d 655d 203d 2073 6861 7065 5f64  [name] = shape_d
-00027550: 6174 615b 2243 6f6c 6f72 2042 4752 225d  ata["Color BGR"]
-00027560: 2e76 616c 7565 735b 305d 0a20 2020 2020  .values[0].     
-00027570: 2020 2066 6f72 2076 6964 656f 5f6e 616d     for video_nam
-00027580: 6520 696e 2070 6f6c 7967 6f6e 735f 6466  e in polygons_df
-00027590: 5b22 5669 6465 6f22 5d2e 756e 6971 7565  ["Video"].unique
-000275a0: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-000275b0: 6966 2076 6964 656f 5f6e 616d 6520 6e6f  if video_name no
-000275c0: 7420 696e 2072 6573 756c 7473 5f72 6f69  t in results_roi
-000275d0: 2e6b 6579 7328 293a 0a20 2020 2020 2020  .keys():.       
-000275e0: 2020 2020 2020 2020 2072 6573 756c 7473           results
-000275f0: 5f72 6f69 5b76 6964 656f 5f6e 616d 655d  _roi[video_name]
-00027600: 203d 207b 7d0a 2020 2020 2020 2020 2020   = {}.          
-00027610: 2020 2020 2020 7265 7375 6c74 735f 636c        results_cl
-00027620: 725b 7669 6465 6f5f 6e61 6d65 5d20 3d20  r[video_name] = 
-00027630: 7b7d 0a20 2020 2020 2020 2020 2020 2076  {}.            v
-00027640: 6964 656f 5f73 6861 7065 7320 3d20 706f  ideo_shapes = po
-00027650: 6c79 676f 6e73 5f64 665b 5b22 5461 6773  lygons_df[["Tags
-00027660: 222c 2022 4e61 6d65 222c 2022 436f 6c6f  ", "Name", "Colo
-00027670: 7220 4247 5222 5d5d 5b0a 2020 2020 2020  r BGR"]][.      
-00027680: 2020 2020 2020 2020 2020 706f 6c79 676f            polygo
-00027690: 6e73 5f64 665b 2256 6964 656f 225d 203d  ns_df["Video"] =
-000276a0: 3d20 7669 6465 6f5f 6e61 6d65 0a20 2020  = video_name.   
-000276b0: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
-000276c0: 2020 2020 2020 2066 6f72 2073 6861 7065         for shape
-000276d0: 5f6e 616d 6520 696e 2076 6964 656f 5f73  _name in video_s
-000276e0: 6861 7065 735b 224e 616d 6522 5d2e 756e  hapes["Name"].un
-000276f0: 6971 7565 2829 3a0a 2020 2020 2020 2020  ique():.        
-00027700: 2020 2020 2020 2020 7368 6170 655f 6461          shape_da
-00027710: 7461 203d 2076 6964 656f 5f73 6861 7065  ta = video_shape
-00027720: 735b 0a20 2020 2020 2020 2020 2020 2020  s[.             
-00027730: 2020 2020 2020 2076 6964 656f 5f73 6861         video_sha
-00027740: 7065 735b 224e 616d 6522 5d20 3d3d 2073  pes["Name"] == s
-00027750: 6861 7065 5f6e 616d 650a 2020 2020 2020  hape_name.      
-00027760: 2020 2020 2020 2020 2020 5d2e 7265 7365            ].rese
-00027770: 745f 696e 6465 7828 6472 6f70 3d54 7275  t_index(drop=Tru
-00027780: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
-00027790: 2020 2074 6167 732c 206e 616d 6520 3d20     tags, name = 
-000277a0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000277b0: 2020 2020 2020 6c69 7374 2873 6861 7065        list(shape
-000277c0: 5f64 6174 615b 2254 6167 7322 5d2e 7661  _data["Tags"].va
-000277d0: 6c75 6573 5b30 5d2e 7661 6c75 6573 2829  lues[0].values()
-000277e0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-000277f0: 2020 2020 2020 2073 6861 7065 5f64 6174         shape_dat
-00027800: 615b 224e 616d 6522 5d2e 7661 6c75 6573  a["Name"].values
-00027810: 5b30 5d2c 0a20 2020 2020 2020 2020 2020  [0],.           
-00027820: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00027830: 2020 2020 2020 2072 6573 756c 7473 5f72         results_r
-00027840: 6f69 5b76 6964 656f 5f6e 616d 655d 5b6e  oi[video_name][n
-00027850: 616d 655d 203d 2050 6f6c 7967 6f6e 280a  ame] = Polygon(.
-00027860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027870: 2020 2020 506f 6c79 676f 6e28 7461 6773      Polygon(tags
-00027880: 292e 636f 6e76 6578 5f68 756c 6c2e 6578  ).convex_hull.ex
-00027890: 7465 7269 6f72 2e63 6f6f 7264 730a 2020  terior.coords.  
-000278a0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-000278b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000278c0: 7265 7375 6c74 735f 636c 725b 7669 6465  results_clr[vide
-000278d0: 6f5f 6e61 6d65 5d5b 6e61 6d65 5d20 3d20  o_name][name] = 
-000278e0: 7368 6170 655f 6461 7461 5b22 436f 6c6f  shape_data["Colo
-000278f0: 7220 4247 5222 5d2e 7661 6c75 6573 5b30  r BGR"].values[0
-00027900: 5d0a 2020 2020 2020 2020 666f 7220 7669  ].        for vi
-00027910: 6465 6f5f 6e61 6d65 2069 6e20 6369 7263  deo_name in circ
-00027920: 6c65 735f 6466 5b22 5669 6465 6f22 5d2e  les_df["Video"].
-00027930: 756e 6971 7565 2829 3a0a 2020 2020 2020  unique():.      
-00027940: 2020 2020 2020 6966 2076 6964 656f 5f6e        if video_n
-00027950: 616d 6520 6e6f 7420 696e 2072 6573 756c  ame not in resul
-00027960: 7473 5f72 6f69 2e6b 6579 7328 293a 0a20  ts_roi.keys():. 
-00027970: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00027980: 6573 756c 7473 5f72 6f69 5b76 6964 656f  esults_roi[video
-00027990: 5f6e 616d 655d 203d 207b 7d0a 2020 2020  _name] = {}.    
-000279a0: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-000279b0: 6c74 735f 636c 725b 7669 6465 6f5f 6e61  lts_clr[video_na
-000279c0: 6d65 5d20 3d20 7b7d 0a20 2020 2020 2020  me] = {}.       
-000279d0: 2020 2020 2076 6964 656f 5f73 6861 7065       video_shape
-000279e0: 7320 3d20 6369 7263 6c65 735f 6466 5b5b  s = circles_df[[
-000279f0: 2254 6167 7322 2c20 224e 616d 6522 2c20  "Tags", "Name", 
-00027a00: 2243 6f6c 6f72 2042 4752 225d 5d5b 0a20  "Color BGR"]][. 
-00027a10: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00027a20: 6972 636c 6573 5f64 665b 2256 6964 656f  ircles_df["Video
-00027a30: 225d 203d 3d20 7669 6465 6f5f 6e61 6d65  "] == video_name
-00027a40: 0a20 2020 2020 2020 2020 2020 205d 0a20  .            ]. 
-00027a50: 2020 2020 2020 2020 2020 2066 6f72 2073             for s
-00027a60: 6861 7065 5f6e 616d 6520 696e 2076 6964  hape_name in vid
-00027a70: 656f 5f73 6861 7065 735b 224e 616d 6522  eo_shapes["Name"
-00027a80: 5d2e 756e 6971 7565 2829 3a0a 2020 2020  ].unique():.    
-00027a90: 2020 2020 2020 2020 2020 2020 7368 6170              shap
-00027aa0: 655f 6461 7461 203d 2076 6964 656f 5f73  e_data = video_s
-00027ab0: 6861 7065 735b 0a20 2020 2020 2020 2020  hapes[.         
-00027ac0: 2020 2020 2020 2020 2020 2076 6964 656f             video
-00027ad0: 5f73 6861 7065 735b 224e 616d 6522 5d20  _shapes["Name"] 
-00027ae0: 3d3d 2073 6861 7065 5f6e 616d 650a 2020  == shape_name.  
-00027af0: 2020 2020 2020 2020 2020 2020 2020 5d2e                ].
-00027b00: 7265 7365 745f 696e 6465 7828 6472 6f70  reset_index(drop
-00027b10: 3d54 7275 6529 0a20 2020 2020 2020 2020  =True).         
-00027b20: 2020 2020 2020 2074 6167 732c 206e 616d         tags, nam
-00027b30: 652c 2072 6164 6975 7320 3d20 280a 2020  e, radius = (.  
-00027b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027b50: 2020 6c69 7374 2873 6861 7065 5f64 6174    list(shape_dat
-00027b60: 615b 2254 6167 7322 5d2e 7661 6c75 6573  a["Tags"].values
-00027b70: 5b30 5d2e 7661 6c75 6573 2829 292c 0a20  [0].values()),. 
-00027b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027b90: 2020 2073 6861 7065 5f64 6174 615b 224e     shape_data["N
-00027ba0: 616d 6522 5d2e 7661 6c75 6573 5b30 5d2c  ame"].values[0],
-00027bb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027bc0: 2020 2020 2073 6861 7065 5f64 6174 615b       shape_data[
-00027bd0: 2272 6164 6975 7322 5d2e 7661 6c75 6573  "radius"].values
-00027be0: 5b30 5d2c 0a20 2020 2020 2020 2020 2020  [0],.           
-00027bf0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00027c00: 2020 2020 2020 2072 6573 756c 7473 5f72         results_r
-00027c10: 6f69 5b76 6964 656f 5f6e 616d 655d 5b6e  oi[video_name][n
-00027c20: 616d 655d 203d 2050 6f69 6e74 2874 6167  ame] = Point(tag
-00027c30: 735b 2243 656e 7465 7220 7461 6722 5d29  s["Center tag"])
-00027c40: 2e62 7566 6665 7228 0a20 2020 2020 2020  .buffer(.       
-00027c50: 2020 2020 2020 2020 2020 2020 2064 6973               dis
-00027c60: 7461 6e63 653d 7261 6469 7573 0a20 2020  tance=radius.   
-00027c70: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-00027c80: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00027c90: 6573 756c 7473 5f63 6c72 5b76 6964 656f  esults_clr[video
-00027ca0: 5f6e 616d 655d 5b6e 616d 655d 203d 2073  _name][name] = s
-00027cb0: 6861 7065 5f64 6174 615b 2243 6f6c 6f72  hape_data["Color
-00027cc0: 2042 4752 225d 2e76 616c 7565 735b 305d   BGR"].values[0]
-00027cd0: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00027ce0: 636f 6c6f 723a 0a20 2020 2020 2020 2020  color:.         
-00027cf0: 2020 2072 6574 7572 6e20 7265 7375 6c74     return result
-00027d00: 735f 726f 692c 204e 6f6e 650a 2020 2020  s_roi, None.    
-00027d10: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00027d20: 2020 2020 2020 7265 7475 726e 2072 6573        return res
-00027d30: 756c 7473 5f72 6f69 2c20 7265 7375 6c74  ults_roi, result
-00027d40: 735f 636c 720a 0a20 2020 2040 7374 6174  s_clr..    @stat
-00027d50: 6963 6d65 7468 6f64 0a20 2020 2064 6566  icmethod.    def
-00027d60: 2066 696c 7465 725f 6c6f 775f 705f 6270   filter_low_p_bp
-00027d70: 735f 666f 725f 7368 6170 6573 2878 3a20  s_for_shapes(x: 
-00027d80: 6e70 2e6e 6461 7272 6179 2c20 703a 206e  np.ndarray, p: n
-00027d90: 702e 6e64 6172 7261 792c 2074 6872 6573  p.ndarray, thres
-00027da0: 686f 6c64 3a20 666c 6f61 7429 3a0a 2020  hold: float):.  
-00027db0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00027dc0: 2020 4669 6c74 6572 2062 6f64 792d 7061    Filter body-pa
-00027dd0: 7274 2064 6174 6120 666f 7220 6765 6f6d  rt data for geom
-00027de0: 6574 7279 2063 6f6e 7374 7275 6374 696f  etry constructio
-00027df0: 6e20 7768 696c 6520 6d61 696e 7461 696e  n while maintain
-00027e00: 696e 6720 7661 6c69 6420 6765 6f6d 6574  ing valid geomet
-00027e10: 7279 2061 7272 6179 732e 0a0a 2020 2020  ry arrays...    
-00027e20: 2020 2020 4861 7669 6e67 2061 2033 4420      Having a 3D 
-00027e30: 6172 7261 7920 7265 7072 6573 656e 7469  array representi
-00027e40: 6e67 2062 6f64 792d 7061 7274 7320 6163  ng body-parts ac
-00027e50: 726f 7373 2074 696d 652c 2061 6e64 2061  ross time, and a
-00027e60: 2073 6563 6f6e 6420 3344 2061 7272 6179   second 3D array
-00027e70: 2072 6570 7265 7365 6e74 696e 6720 7072   representing pr
-00027e80: 6f62 6162 696c 6974 6965 7320 6f66 2074  obabilities of t
-00027e90: 686f 7365 0a20 2020 2020 2020 2062 6f64  hose.        bod
-00027ea0: 792d 7061 7274 7320 6163 726f 7373 2074  y-parts across t
-00027eb0: 696d 652c 2077 6520 7761 6e74 2074 6f20  ime, we want to 
-00027ec0: 2272 656d 6f76 6522 2062 6f64 792d 7061  "remove" body-pa
-00027ed0: 7274 7320 7769 7468 206c 6f77 2064 6574  rts with low det
-00027ee0: 6563 7469 6f6e 2070 726f 6261 6269 6c69  ection probabili
-00027ef0: 7469 6573 2077 6869 6c73 7420 616c 736f  ties whilst also
-00027f00: 206b 6565 7069 6e67 2074 6865 2061 7272   keeping the arr
-00027f10: 6179 2073 697a 6573 0a20 2020 2020 2020  ay sizes.       
-00027f20: 2069 6e74 6163 7420 616e 6420 7375 6974   intact and suit
-00027f30: 6162 6c65 2066 6f72 2067 656f 6d65 7472  able for geometr
-00027f40: 7920 636f 6e73 7472 7563 7469 6f6e 2e20  y construction. 
-00027f50: 546f 2064 6f20 7468 6973 2c20 7765 2066  To do this, we f
-00027f60: 696e 6420 626f 6479 2d70 6172 7473 2077  ind body-parts w
-00027f70: 6974 6820 6465 7465 6374 696f 6e20 7072  ith detection pr
-00027f80: 6f62 6162 696c 6974 6965 7320 6265 6c6f  obabilities belo
-00027f90: 7720 7468 6520 7468 7265 7368 6f6c 642c  w the threshold,
-00027fa0: 2061 6e64 2072 6570 6c61 6365 2074 6865   and replace the
-00027fb0: 7365 2077 6974 6820 6120 626f 6479 2d70  se with a body-p
-00027fc0: 6172 740a 2020 2020 2020 2020 7468 6174  art.        that
-00027fd0: 2064 6f65 736e 2774 2066 616c 6c20 6265   doesn't fall be
-00027fe0: 6c6f 7720 7468 6520 6465 7465 6374 696f  low the detectio
-00027ff0: 6e20 7072 6f62 6162 696c 6974 7920 7468  n probability th
-00028000: 7265 7368 6f6c 6420 7769 7468 696e 2074  reshold within t
-00028010: 6865 2073 616d 6520 6672 616d 652e 2048  he same frame. H
-00028020: 6f77 6576 6572 2c20 746f 2063 6f6e 7374  owever, to const
-00028030: 7275 6374 2061 2067 656f 6d65 7472 792c  ruct a geometry,
-00028040: 2077 6520 6e65 6564 203e 3d20 3320 756e   we need >= 3 un
-00028050: 6971 7565 206b 6579 2d70 6f69 6e74 206c  ique key-point l
-00028060: 6f63 6174 696f 6e73 2e0a 2020 2020 2020  ocations..      
-00028070: 2020 5468 7573 2c20 6e6f 2073 7562 7374    Thus, no subst
-00028080: 6974 7574 696f 6e20 6361 6e20 6265 206d  itution can be m
-00028090: 6164 6520 746f 2077 6865 6e20 7468 6572  ade to when ther
-000280a0: 6520 6172 6520 6c65 7373 2074 6861 6e20  e are less than 
-000280b0: 7468 7265 6520 756e 6971 7565 2062 6f64  three unique bod
-000280c0: 792d 7061 7274 206c 6f63 6174 696f 6e73  y-part locations
-000280d0: 2077 6974 6869 6e20 6120 6672 616d 6520   within a frame 
-000280e0: 7468 6174 2066 616c 6c73 2061 626f 7665  that falls above
-000280f0: 2074 6865 2074 6872 6573 686f 6c64 2e0a   the threshold..
-00028100: 0a20 2020 2020 2020 203a 6578 616d 706c  .        :exampl
-00028110: 653a 0a20 2020 2020 2020 203e 3e3e 2078  e:.        >>> x
-00028120: 203d 206e 702e 7261 6e64 6f6d 2e72 616e   = np.random.ran
-00028130: 6469 6e74 2830 2c20 3530 302c 2028 3138  dint(0, 500, (18
-00028140: 3030 302c 2037 2c20 3229 290a 2020 2020  000, 7, 2)).    
-00028150: 2020 2020 3e3e 3e20 7020 3d20 6e70 2e72      >>> p = np.r
-00028160: 616e 646f 6d2e 7261 6e64 6f6d 2873 697a  andom.random(siz
-00028170: 653d 2831 3830 3030 2c20 372c 2031 2929  e=(18000, 7, 1))
-00028180: 0a20 2020 2020 2020 203e 3e3e 2078 203d  .        >>> x =
-00028190: 2047 656f 6d65 7472 794d 6978 696e 2e66   GeometryMixin.f
-000281a0: 696c 7465 725f 6c6f 775f 705f 6270 735f  ilter_low_p_bps_
-000281b0: 666f 725f 7368 6170 6573 2878 3d78 2c20  for_shapes(x=x, 
-000281c0: 703d 702c 2074 6872 6573 686f 6c64 3d30  p=p, threshold=0
-000281d0: 2e31 290a 2020 2020 2020 2020 3e3e 3e20  .1).        >>> 
-000281e0: 7820 3d20 782e 7265 7368 6170 6528 782e  x = x.reshape(x.
-000281f0: 7368 6170 655b 305d 2c20 696e 7428 782e  shape[0], int(x.
-00028200: 7368 6170 655b 315d 202a 2032 2929 0a20  shape[1] * 2)). 
-00028210: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-00028220: 2020 2020 7265 7375 6c74 7320 3d20 6e70      results = np
-00028230: 2e63 6f70 7928 7829 0a20 2020 2020 2020  .copy(x).       
-00028240: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-00028250: 782e 7368 6170 655b 305d 293a 0a20 2020  x.shape[0]):.   
-00028260: 2020 2020 2020 2020 2062 656c 6f77 5f70           below_p
-00028270: 5f69 6478 203d 206e 702e 6172 6777 6865  _idx = np.argwhe
-00028280: 7265 2870 5b69 5d2e 666c 6174 7465 6e28  re(p[i].flatten(
-00028290: 2920 3c20 7468 7265 7368 6f6c 6429 2e66  ) < threshold).f
-000282a0: 6c61 7474 656e 2829 0a20 2020 2020 2020  latten().       
-000282b0: 2020 2020 2061 626f 7665 5f70 5f69 6478       above_p_idx
-000282c0: 203d 206e 702e 6172 6777 6865 7265 2870   = np.argwhere(p
-000282d0: 5b69 5d2e 666c 6174 7465 6e28 2920 3e3d  [i].flatten() >=
-000282e0: 2074 6872 6573 686f 6c64 292e 666c 6174   threshold).flat
-000282f0: 7465 6e28 290a 2020 2020 2020 2020 2020  ten().          
-00028300: 2020 6966 2028 6265 6c6f 775f 705f 6964    if (below_p_id
-00028310: 782e 7368 6170 655b 305d 203e 2030 2920  x.shape[0] > 0) 
-00028320: 616e 6420 2861 626f 7665 5f70 5f69 6478  and (above_p_idx
-00028330: 2e73 6861 7065 5b30 5d20 3e3d 2033 293a  .shape[0] >= 3):
-00028340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028350: 2066 6f72 206a 2069 6e20 6265 6c6f 775f   for j in below_
-00028360: 705f 6964 783a 0a20 2020 2020 2020 2020  p_idx:.         
-00028370: 2020 2020 2020 2020 2020 206e 6577 5f76             new_v
-00028380: 616c 203d 2078 5b69 5d5b 6162 6f76 655f  al = x[i][above_
-00028390: 705f 6964 785b 305d 5d0a 2020 2020 2020  p_idx[0]].      
-000283a0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-000283b0: 7375 6c74 735b 695d 5b6a 5d20 3d20 6e65  sults[i][j] = ne
-000283c0: 775f 7661 6c0a 2020 2020 2020 2020 7265  w_val.        re
-000283d0: 7475 726e 2072 6573 756c 7473 0a0a 0a23  turn results...#
-000283e0: 2064 6174 6120 3d20 6e70 2e61 7272 6179   data = np.array
-000283f0: 285b 5b5b 3336 342c 2033 3038 5d2c 205b  ([[[364, 308], [
-00028400: 3338 332c 2033 3233 5d2c 205b 3430 332c  383, 323], [403,
-00028410: 2033 3335 5d2c 205b 3432 332c 2033 3531   335], [423, 351
-00028420: 5d5d 2c0a 2320 2020 2020 2020 2020 2020  ]],.#           
-00028430: 2020 2020 2020 205b 5b33 3536 2c20 3330         [[356, 30
-00028440: 375d 2c20 5b33 3736 2c20 3331 395d 2c20  7], [376, 319], 
-00028450: 5b33 3936 2c20 3333 315d 2c20 5b34 3139  [396, 331], [419
-00028460: 2c20 3334 375d 5d2c 0a23 2020 2020 2020  , 347]],.#      
-00028470: 2020 2020 2020 2020 2020 2020 5b5b 3336              [[36
-00028480: 342c 2033 3038 5d2c 205b 3338 332c 2033  4, 308], [383, 3
-00028490: 3233 5d2c 205b 3430 332c 2033 3335 5d2c  23], [403, 335],
-000284a0: 205b 3432 332c 2033 3531 5d5d 2c0a 2320   [423, 351]],.# 
-000284b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000284c0: 205b 5b33 3634 2c20 3330 385d 2c20 5b33   [[364, 308], [3
-000284d0: 2c20 3332 335d 2c20 5b34 3033 2c20 3333  , 323], [403, 33
-000284e0: 355d 2c20 5b34 3233 2c20 3335 315d 5d2c  5], [423, 351]],
-000284f0: 0a23 2020 2020 2020 2020 2020 2020 2020  .#              
-00028500: 2020 2020 5b5b 3336 342c 2033 3038 5d2c      [[364, 308],
-00028510: 205b 3338 332c 2033 3233 5d2c 205b 3534   [383, 323], [54
-00028520: 2c20 3333 355d 2c20 5b34 3233 2c20 3335  , 335], [423, 35
-00028530: 315d 5d2c 0a23 2020 2020 2020 2020 2020  1]],.#          
-00028540: 2020 2020 2020 2020 5b5b 3132 2c20 3330          [[12, 30
-00028550: 385d 2c20 5b33 3833 2c20 3334 5d2c 205b  8], [383, 34], [
-00028560: 3430 332c 2033 3335 5d2c 205b 3432 332c  403, 335], [423,
-00028570: 2033 3531 5d5d 2c0a 2320 2020 2020 2020   351]],.#       
-00028580: 2020 2020 2020 2020 2020 205b 5b33 3634             [[364
-00028590: 2c20 3330 385d 2c20 5b33 3833 2c20 3332  , 308], [383, 32
-000285a0: 335d 2c20 5b34 3033 2c20 3333 355d 2c20  3], [403, 335], 
-000285b0: 5b31 3030 2c20 3335 315d 5d5d 290a 2320  [100, 351]]]).# 
-000285c0: 4765 6f6d 6574 7279 4d69 7869 6e28 292e  GeometryMixin().
-000285d0: 6d75 6c74 6966 7261 6d65 5f62 6f64 7970  multiframe_bodyp
-000285e0: 6172 7473 5f74 6f5f 706f 6c79 676f 6e28  arts_to_polygon(
-000285f0: 6461 7461 3d64 6174 6129 0a0a 230a 2320  data=data)..#.# 
-00028600: 706f 6c79 676f 6e5f 3120 3d20 4765 6f6d  polygon_1 = Geom
-00028610: 6574 7279 4d69 7869 6e28 292e 626f 6479  etryMixin().body
-00028620: 7061 7274 735f 746f 5f70 6f6c 7967 6f6e  parts_to_polygon
-00028630: 286e 702e 6172 7261 7928 5b5b 3336 342c  (np.array([[364,
-00028640: 2033 3038 5d2c 5b33 3833 2c20 3332 335d   308],[383, 323]
-00028650: 2c5b 3430 332c 2033 3335 5d2c 5b34 3233  ,[403, 335],[423
-00028660: 2c20 3335 315d 5d29 290a 2320 706f 6c79  , 351]])).# poly
-00028670: 676f 6e5f 3220 3d20 4765 6f6d 6574 7279  gon_2 = Geometry
-00028680: 4d69 7869 6e28 292e 626f 6479 7061 7274  Mixin().bodypart
-00028690: 735f 746f 5f70 6f6c 7967 6f6e 286e 702e  s_to_polygon(np.
-000286a0: 6172 7261 7928 5b5b 3335 362c 2033 3037  array([[356, 307
-000286b0: 5d2c 5b33 3736 2c20 3331 395d 2c5b 3339  ],[376, 319],[39
-000286c0: 362c 2033 3331 5d2c 5b34 3139 2c20 3334  6, 331],[419, 34
-000286d0: 375d 5d29 290a 2320 706f 6c79 676f 6e5f  7]])).# polygon_
-000286e0: 3120 3d20 5b70 6f6c 7967 6f6e 5f31 2066  1 = [polygon_1 f
-000286f0: 6f72 2078 2069 6e20 7261 6e67 6528 3130  or x in range(10
-00028700: 3029 5d0a 2320 706f 6c79 676f 6e5f 3220  0)].# polygon_2 
-00028710: 3d20 5b70 6f6c 7967 6f6e 5f32 2066 6f72  = [polygon_2 for
-00028720: 2078 2069 6e20 7261 6e67 6528 3130 3029   x in range(100)
-00028730: 5d0a 2320 6461 7461 203d 206e 702e 636f  ].# data = np.co
-00028740: 6c75 6d6e 5f73 7461 636b 2828 706f 6c79  lumn_stack((poly
-00028750: 676f 6e5f 312c 2070 6f6c 7967 6f6e 5f32  gon_1, polygon_2
-00028760: 2929 0a23 2047 656f 6d65 7472 794d 6978  )).# GeometryMix
-00028770: 696e 2e63 6f6d 7075 7465 5f70 6374 5f73  in.compute_pct_s
-00028780: 6861 7065 5f6f 7665 726c 6170 2873 6861  hape_overlap(sha
-00028790: 7065 733d 6461 7461 290a 230a 230a 230a  pes=data).#.#.#.
-000287a0: 2320 6461 7461 203d 206e 702e 6172 7261  # data = np.arra
-000287b0: 795f 7370 6c69 7428 6461 7461 2c20 3829  y_split(data, 8)
-000287c0: 0a23 0a23 0a23 0a23 2072 6573 756c 7473  .#.#.#.# results
-000287d0: 203d 2047 656f 6d65 7472 794d 6978 696e   = GeometryMixin
-000287e0: 2829 2e6d 756c 7469 6672 616d 655f 636f  ().multiframe_co
-000287f0: 6d70 7574 655f 7063 745f 7368 6170 655f  mpute_pct_shape_
-00028800: 6f76 6572 6c61 7028 7368 6170 655f 313d  overlap(shape_1=
-00028810: 706f 6c79 676f 6e5f 312c 2073 6861 7065  polygon_1, shape
-00028820: 5f32 3d70 6f6c 7967 6f6e 5f32 2c29 0a23  _2=polygon_2,).#
-00028830: 0a23 206e 702e 0a0a 2320 706f 6c79 676f  .# np...# polygo
-00028840: 6e5f 3120 3d20 4765 6f6d 6574 7279 4d69  n_1 = GeometryMi
-00028850: 7869 6e28 292e 626f 6479 7061 7274 735f  xin().bodyparts_
-00028860: 746f 5f70 6f6c 7967 6f6e 286e 702e 6172  to_polygon(np.ar
-00028870: 7261 7928 5b5b 302c 2031 3030 5d2c 5b31  ray([[0, 100],[1
-00028880: 3030 2c20 3130 305d 2c5b 302c 2030 5d2c  00, 100],[0, 0],
-00028890: 5b31 3030 2c20 305d 5d29 290a 2320 706f  [100, 0]])).# po
-000288a0: 6c79 676f 6e5f 3220 3d20 4765 6f6d 6574  lygon_2 = Geomet
-000288b0: 7279 4d69 7869 6e28 292e 626f 6479 7061  ryMixin().bodypa
-000288c0: 7274 735f 746f 5f70 6f6c 7967 6f6e 286e  rts_to_polygon(n
-000288d0: 702e 6172 7261 7928 5b5b 3235 2c20 3735  p.array([[25, 75
-000288e0: 5d2c 5b37 352c 2037 355d 2c5b 3235 2c20  ],[75, 75],[25, 
-000288f0: 3235 5d2c 5b37 352c 2032 355d 5d29 290a  25],[75, 25]])).
-00028900: 2320 7920 3d20 4765 6f6d 6574 7279 4d69  # y = GeometryMi
-00028910: 7869 6e28 292e 636f 6d70 7574 655f 7063  xin().compute_pc
-00028920: 745f 7368 6170 655f 6f76 6572 6c61 7028  t_shape_overlap(
-00028930: 7368 6170 6573 3d5b 706f 6c79 676f 6e5f  shapes=[polygon_
-00028940: 312c 2070 6f6c 7967 6f6e 5f32 5d2c 2064  1, polygon_2], d
-00028950: 656e 6f6d 696e 6174 6f72 3d27 7368 6170  enominator='shap
-00028960: 655f 3227 290a                           e_2').
+0001ebc0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0001ebd0: 2020 2063 6865 636b 5f76 616c 6964 5f6c     check_valid_l
+0001ebe0: 7374 280a 2020 2020 2020 2020 2020 2020  st(.            
+0001ebf0: 6461 7461 3d67 656f 6d65 7472 6965 732c  data=geometries,
+0001ec00: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
+0001ec10: 7263 653d 6622 7b47 656f 6d65 7472 794d  rce=f"{GeometryM
+0001ec20: 6978 696e 2829 2e61 646a 7573 745f 6765  ixin().adjust_ge
+0001ec30: 6f6d 6574 7269 6573 2e5f 5f6e 616d 655f  ometries.__name_
+0001ec40: 5f7d 2067 656f 6d65 7472 6965 7322 2c0a  _} geometries",.
+0001ec50: 2020 2020 2020 2020 2020 2020 7661 6c69              vali
+0001ec60: 645f 6474 7970 6573 3d28 506f 6c79 676f  d_dtypes=(Polygo
+0001ec70: 6e2c 292c 0a20 2020 2020 2020 2020 2020  n,),.           
+0001ec80: 206d 696e 5f6c 656e 3d31 2c0a 2020 2020   min_len=1,.    
+0001ec90: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
+0001eca0: 7375 6c74 7320 3d20 5b5d 0a20 2020 2020  sults = [].     
+0001ecb0: 2020 2066 6f72 2073 6861 7065 5f63 6e74     for shape_cnt
+0001ecc0: 2c20 7368 6170 6520 696e 2065 6e75 6d65  , shape in enume
+0001ecd0: 7261 7465 2867 656f 6d65 7472 6965 7329  rate(geometries)
+0001ece0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0001ecf0: 7375 6c74 732e 6170 7065 6e64 280a 2020  sults.append(.  
+0001ed00: 2020 2020 2020 2020 2020 2020 2020 506f                Po
+0001ed10: 6c79 676f 6e28 0a20 2020 2020 2020 2020  lygon(.         
+0001ed20: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
+0001ed30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ed40: 2020 2020 2028 696e 7428 6162 7328 7820       (int(abs(x 
+0001ed50: 2b20 7368 6966 745b 305d 2929 2c20 696e  + shift[0])), in
+0001ed60: 7428 6162 7328 7920 2b20 7368 6966 745b  t(abs(y + shift[
+0001ed70: 315d 2929 290a 2020 2020 2020 2020 2020  1]))).          
+0001ed80: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0001ed90: 7220 782c 2079 2069 6e20 6c69 7374 2873  r x, y in list(s
+0001eda0: 6861 7065 2e65 7874 6572 696f 722e 636f  hape.exterior.co
+0001edb0: 6f72 6473 290a 2020 2020 2020 2020 2020  ords).          
+0001edc0: 2020 2020 2020 2020 2020 5d0a 2020 2020            ].    
+0001edd0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0001ede0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0001edf0: 2020 2020 7265 7475 726e 2072 6573 756c      return resul
+0001ee00: 7473 0a0a 2020 2020 4073 7461 7469 636d  ts..    @staticm
+0001ee10: 6574 686f 640a 2020 2020 6465 6620 6275  ethod.    def bu
+0001ee20: 636b 6574 5f69 6d67 5f69 6e74 6f5f 6772  cket_img_into_gr
+0001ee30: 6964 5f70 6f69 6e74 7328 0a20 2020 2020  id_points(.     
+0001ee40: 2020 2070 6f69 6e74 5f64 6973 7461 6e63     point_distanc
+0001ee50: 653a 2069 6e74 2c0a 2020 2020 2020 2020  e: int,.        
+0001ee60: 7078 5f70 6572 5f6d 6d3a 2066 6c6f 6174  px_per_mm: float
+0001ee70: 2c0a 2020 2020 2020 2020 696d 675f 7369  ,.        img_si
+0001ee80: 7a65 3a20 5475 706c 655b 696e 742c 2069  ze: Tuple[int, i
+0001ee90: 6e74 5d2c 0a20 2020 2020 2020 2062 6f72  nt],.        bor
+0001eea0: 6465 725f 7369 7465 733a 204f 7074 696f  der_sites: Optio
+0001eeb0: 6e61 6c5b 626f 6f6c 5d20 3d20 5472 7565  nal[bool] = True
+0001eec0: 2c0a 2020 2020 2920 2d3e 2044 6963 745b  ,.    ) -> Dict[
+0001eed0: 5475 706c 655b 696e 742c 2069 6e74 5d2c  Tuple[int, int],
+0001eee0: 2050 6f69 6e74 5d3a 0a20 2020 2020 2020   Point]:.       
+0001eef0: 2022 2222 0a20 2020 2020 2020 2047 656e   """.        Gen
+0001ef00: 6572 6174 6520 6120 6772 6964 206f 6620  erate a grid of 
+0001ef10: 6576 656e 6c79 2073 7061 6365 6420 706f  evenly spaced po
+0001ef20: 696e 7473 2077 6974 6869 6e20 616e 2069  ints within an i
+0001ef30: 6d61 6765 2e20 5573 6520 666f 7220 6372  mage. Use for cr
+0001ef40: 6561 7469 6e67 2073 7061 7469 616c 206d  eating spatial m
+0001ef50: 6172 6b65 7273 2077 6974 6869 6e20 616e  arkers within an
+0001ef60: 2061 7265 6e61 2e0a 0a20 2020 2020 2020   arena...       
+0001ef70: 202e 2e20 696d 6167 653a 3a20 5f73 7461   .. image:: _sta
+0001ef80: 7469 632f 696d 672f 6275 636b 6574 5f69  tic/img/bucket_i
+0001ef90: 6d67 5f69 6e74 6f5f 6772 6964 5f70 6f69  mg_into_grid_poi
+0001efa0: 6e74 732e 706e 670a 2020 2020 2020 2020  nts.png.        
+0001efb0: 2020 203a 7769 6474 683a 2035 3030 0a20     :width: 500. 
+0001efc0: 2020 2020 2020 2020 2020 3a61 6c69 676e            :align
+0001efd0: 3a20 6365 6e74 6572 0a0a 2020 2020 2020  : center..      
+0001efe0: 2020 3a70 6172 616d 2069 6e74 2070 6f69    :param int poi
+0001eff0: 6e74 5f64 6973 7461 6e63 653a 2044 6973  nt_distance: Dis
+0001f000: 7461 6e63 6520 6265 7477 6565 6e20 6164  tance between ad
+0001f010: 6a61 6365 6e74 2070 6f69 6e74 7320 696e  jacent points in
+0001f020: 206d 696c 6c69 6d65 7465 7273 2e0a 2020   millimeters..  
+0001f030: 2020 2020 2020 3a70 6172 616d 2066 6c6f        :param flo
+0001f040: 6174 2070 785f 7065 725f 6d6d 3a20 5069  at px_per_mm: Pi
+0001f050: 7865 6c73 2070 6572 206d 696c 6c69 6d65  xels per millime
+0001f060: 7465 7220 636f 6e76 6572 7369 6f6e 2066  ter conversion f
+0001f070: 6163 746f 722e 0a20 2020 2020 2020 203a  actor..        :
+0001f080: 7061 7261 6d20 5475 706c 655b 696e 742c  param Tuple[int,
+0001f090: 2069 6e74 5d20 696d 675f 7369 7a65 3a20   int] img_size: 
+0001f0a0: 5369 7a65 206f 6620 7468 6520 696d 6167  Size of the imag
+0001f0b0: 6520 696e 2070 6978 656c 7320 2877 6964  e in pixels (wid
+0001f0c0: 7468 2c20 6865 6967 6874 292e 0a20 2020  th, height)..   
+0001f0d0: 2020 2020 203a 7061 7261 6d20 4f70 7469       :param Opti
+0001f0e0: 6f6e 616c 5b62 6f6f 6c5d 2062 6f72 6465  onal[bool] borde
+0001f0f0: 725f 7369 7465 733a 2049 6620 5472 7565  r_sites: If True
+0001f100: 2c20 696e 636c 7564 6573 2070 6f69 6e74  , includes point
+0001f110: 7320 6f6e 2074 6865 2062 6f72 6465 7220  s on the border 
+0001f120: 6f66 2074 6865 2069 6d61 6765 2e20 4465  of the image. De
+0001f130: 6661 756c 7420 6973 2054 7275 652e 0a20  fault is True.. 
+0001f140: 2020 2020 2020 203a 7265 7475 726e 7320         :returns 
+0001f150: 4469 6374 5b54 7570 6c65 5b69 6e74 2c20  Dict[Tuple[int, 
+0001f160: 696e 745d 2c20 506f 696e 745d 3a20 4469  int], Point]: Di
+0001f170: 6374 696f 6e61 7279 2077 6865 7265 206b  ctionary where k
+0001f180: 6579 7320 6172 6520 2872 6f77 2c20 636f  eys are (row, co
+0001f190: 6c75 6d6e 2920 696e 6469 6365 7320 6f66  lumn) indices of
+0001f1a0: 2074 6865 2070 6f69 6e74 2c20 616e 6420   the point, and 
+0001f1b0: 7661 6c75 6573 2061 7265 2053 6861 7065  values are Shape
+0001f1c0: 6c79 2050 6f69 6e74 206f 626a 6563 7473  ly Point objects
+0001f1d0: 2e0a 0a20 2020 2020 2020 203a 6578 616d  ...        :exam
+0001f1e0: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
+0001f1f0: 2070 6f69 6e74 5f67 7269 6428 706f 696e   point_grid(poin
+0001f200: 745f 6469 7374 616e 6365 3d32 302c 2070  t_distance=20, p
+0001f210: 785f 7065 725f 6d6d 3d34 2c20 696d 675f  x_per_mm=4, img_
+0001f220: 7369 7a65 3d69 6d67 2e73 6861 7065 2c20  size=img.shape, 
+0001f230: 626f 7264 6572 5f73 6974 6573 3d46 616c  border_sites=Fal
+0001f240: 7365 290a 2020 2020 2020 2020 2222 220a  se).        """.
+0001f250: 0a20 2020 2020 2020 2070 6f69 6e74 5f64  .        point_d
+0001f260: 6973 7461 6e63 6520 3d20 696e 7428 706f  istance = int(po
+0001f270: 696e 745f 6469 7374 616e 6365 202a 2070  int_distance * p
+0001f280: 785f 7065 725f 6d6d 290a 2020 2020 2020  x_per_mm).      
+0001f290: 2020 765f 6269 6e5f 636e 742c 2068 5f62    v_bin_cnt, h_b
+0001f2a0: 696e 5f63 6e74 203d 2064 6976 6d6f 6428  in_cnt = divmod(
+0001f2b0: 696d 675f 7369 7a65 5b30 5d2c 2070 6f69  img_size[0], poi
+0001f2c0: 6e74 5f64 6973 7461 6e63 6529 2c20 6469  nt_distance), di
+0001f2d0: 766d 6f64 280a 2020 2020 2020 2020 2020  vmod(.          
+0001f2e0: 2020 696d 675f 7369 7a65 5b31 5d2c 2070    img_size[1], p
+0001f2f0: 6f69 6e74 5f64 6973 7461 6e63 650a 2020  oint_distance.  
+0001f300: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0001f310: 6966 2068 5f62 696e 5f63 6e74 5b31 5d20  if h_bin_cnt[1] 
+0001f320: 213d 2030 3a0a 2020 2020 2020 2020 2020  != 0:.          
+0001f330: 2020 685f 6269 6e5f 636e 7420 3d20 2868    h_bin_cnt = (h
+0001f340: 5f62 696e 5f63 6e74 5b30 5d20 2b20 312c  _bin_cnt[0] + 1,
+0001f350: 2068 5f62 696e 5f63 6e74 5b31 5d29 0a20   h_bin_cnt[1]). 
+0001f360: 2020 2020 2020 2069 6620 765f 6269 6e5f         if v_bin_
+0001f370: 636e 745b 315d 2021 3d20 303a 0a20 2020  cnt[1] != 0:.   
+0001f380: 2020 2020 2020 2020 2076 5f62 696e 5f63           v_bin_c
+0001f390: 6e74 203d 2028 765f 6269 6e5f 636e 745b  nt = (v_bin_cnt[
+0001f3a0: 305d 202b 2031 2c20 765f 6269 6e5f 636e  0] + 1, v_bin_cn
+0001f3b0: 745b 315d 290a 0a20 2020 2020 2020 2070  t[1])..        p
+0001f3c0: 6f69 6e74 7320 3d20 7b7d 0a20 2020 2020  oints = {}.     
+0001f3d0: 2020 2066 6f72 2068 5f63 6e74 2c20 6920     for h_cnt, i 
+0001f3e0: 696e 2065 6e75 6d65 7261 7465 2872 616e  in enumerate(ran
+0001f3f0: 6765 2868 5f62 696e 5f63 6e74 5b30 5d20  ge(h_bin_cnt[0] 
+0001f400: 2b20 3129 293a 0a20 2020 2020 2020 2020  + 1)):.         
+0001f410: 2020 2066 6f72 2076 5f63 6e74 2c20 6a20     for v_cnt, j 
+0001f420: 696e 2065 6e75 6d65 7261 7465 2872 616e  in enumerate(ran
+0001f430: 6765 2876 5f62 696e 5f63 6e74 5b30 5d20  ge(v_bin_cnt[0] 
+0001f440: 2b20 3129 293a 0a20 2020 2020 2020 2020  + 1)):.         
+0001f450: 2020 2020 2020 2078 2c20 7920 3d20 6920         x, y = i 
+0001f460: 2a20 706f 696e 745f 6469 7374 616e 6365  * point_distance
+0001f470: 2c20 6a20 2a20 706f 696e 745f 6469 7374  , j * point_dist
+0001f480: 616e 6365 0a20 2020 2020 2020 2020 2020  ance.           
+0001f490: 2020 2020 2078 2c20 7920 3d20 6d69 6e28       x, y = min(
+0001f4a0: 782c 2069 6d67 5f73 697a 655b 315d 292c  x, img_size[1]),
+0001f4b0: 206d 696e 2879 2c20 696d 675f 7369 7a65   min(y, img_size
+0001f4c0: 5b30 5d29 0a20 2020 2020 2020 2020 2020  [0]).           
+0001f4d0: 2020 2020 2069 6620 6e6f 7420 626f 7264       if not bord
+0001f4e0: 6572 5f73 6974 6573 2061 6e64 2028 0a20  er_sites and (. 
+0001f4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f500: 2020 2028 7820 3d3d 2030 2920 6f72 2028     (x == 0) or (
+0001f510: 7920 3d3d 2030 2920 6f72 2028 7920 3d3d  y == 0) or (y ==
+0001f520: 2069 6d67 5f73 697a 655b 305d 2920 6f72   img_size[0]) or
+0001f530: 2028 7820 3d3d 2069 6d67 5f73 697a 655b   (x == img_size[
+0001f540: 315d 290a 2020 2020 2020 2020 2020 2020  1]).            
+0001f550: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
+0001f560: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
+0001f570: 6e75 650a 2020 2020 2020 2020 2020 2020  nue.            
+0001f580: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0001f590: 2020 2020 2020 2020 2020 2020 2020 706f                po
+0001f5a0: 696e 7420 3d20 506f 696e 7428 782c 2079  int = Point(x, y
+0001f5b0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0001f5c0: 2020 2020 2020 6966 2070 6f69 6e74 206e        if point n
+0001f5d0: 6f74 2069 6e20 706f 696e 7473 2e76 616c  ot in points.val
+0001f5e0: 7565 7328 293a 0a20 2020 2020 2020 2020  ues():.         
+0001f5f0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0001f600: 6f69 6e74 735b 2868 5f63 6e74 2c20 765f  oints[(h_cnt, v_
+0001f610: 636e 7429 5d20 3d20 506f 696e 7428 782c  cnt)] = Point(x,
+0001f620: 2079 290a 2020 2020 2020 2020 7265 7475   y).        retu
+0001f630: 726e 2070 6f69 6e74 730a 0a20 2020 2040  rn points..    @
+0001f640: 7374 6174 6963 6d65 7468 6f64 0a20 2020  staticmethod.   
+0001f650: 2064 6566 2062 7563 6b65 745f 696d 675f   def bucket_img_
+0001f660: 696e 746f 5f67 7269 645f 7371 7561 7265  into_grid_square
+0001f670: 280a 2020 2020 2020 2020 696d 675f 7369  (.        img_si
+0001f680: 7a65 3a20 4974 6572 6162 6c65 5b69 6e74  ze: Iterable[int
+0001f690: 5d2c 0a20 2020 2020 2020 2062 7563 6b65  ],.        bucke
+0001f6a0: 745f 6772 6964 5f73 697a 655f 6d6d 3a20  t_grid_size_mm: 
+0001f6b0: 4f70 7469 6f6e 616c 5b66 6c6f 6174 5d20  Optional[float] 
+0001f6c0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+0001f6d0: 6275 636b 6574 5f67 7269 645f 7369 7a65  bucket_grid_size
+0001f6e0: 3a20 4f70 7469 6f6e 616c 5b49 7465 7261  : Optional[Itera
+0001f6f0: 626c 655b 696e 745d 5d20 3d20 4e6f 6e65  ble[int]] = None
+0001f700: 2c0a 2020 2020 2020 2020 7078 5f70 6572  ,.        px_per
+0001f710: 5f6d 6d3a 204f 7074 696f 6e61 6c5b 666c  _mm: Optional[fl
+0001f720: 6f61 745d 203d 204e 6f6e 652c 0a20 2020  oat] = None,.   
+0001f730: 2020 2020 2061 6464 5f63 6f72 7265 6374       add_correct
+0001f740: 696f 6e3a 204f 7074 696f 6e61 6c5b 626f  ion: Optional[bo
+0001f750: 6f6c 5d20 3d20 5472 7565 2c0a 2020 2020  ol] = True,.    
+0001f760: 2920 2d3e 2054 7570 6c65 5b44 6963 745b  ) -> Tuple[Dict[
+0001f770: 5475 706c 655b 696e 742c 2069 6e74 5d2c  Tuple[int, int],
+0001f780: 2050 6f6c 7967 6f6e 5d2c 2066 6c6f 6174   Polygon], float
+0001f790: 5d3a 0a20 2020 2020 2020 2022 2222 0a20  ]:.        """. 
+0001f7a0: 2020 2020 2020 2042 7563 6b65 7469 7a65         Bucketize
+0001f7b0: 2061 6e20 696d 6167 6520 696e 746f 2073   an image into s
+0001f7c0: 7175 6172 6573 2061 6e64 2072 6574 7572  quares and retur
+0001f7d0: 6e20 6120 6469 6374 696f 6e61 7279 206f  n a dictionary o
+0001f7e0: 6620 706f 6c79 676f 6e73 2072 6570 7265  f polygons repre
+0001f7f0: 7365 6e74 696e 6720 7468 6520 6275 636b  senting the buck
+0001f800: 6574 206c 6f63 6174 696f 6e73 2e0a 0a20  et locations... 
+0001f810: 2020 2020 2020 203a 7061 7261 6d20 4974         :param It
+0001f820: 6572 6162 6c65 5b69 6e74 5d20 696d 675f  erable[int] img_
+0001f830: 7369 7a65 3a20 322d 7661 6c75 6520 7475  size: 2-value tu
+0001f840: 706c 652c 206c 6973 7420 6f72 2061 7272  ple, list or arr
+0001f850: 6179 2072 6570 7265 7365 6e74 696e 6720  ay representing 
+0001f860: 7468 6520 7769 6474 6820 616e 6420 6865  the width and he
+0001f870: 6967 6874 206f 6620 7468 6520 696d 6167  ight of the imag
+0001f880: 6520 696e 2070 6978 656c 732e 0a20 2020  e in pixels..   
+0001f890: 2020 2020 203a 7061 7261 6d20 4f70 7469       :param Opti
+0001f8a0: 6f6e 616c 5b66 6c6f 6174 5d20 6275 636b  onal[float] buck
+0001f8b0: 6574 5f67 7269 645f 7369 7a65 5f6d 6d3a  et_grid_size_mm:
+0001f8c0: 2054 6865 2077 6964 7468 2f68 6569 6768   The width/heigh
+0001f8d0: 7420 6f66 2065 6163 6820 7371 7561 7265  t of each square
+0001f8e0: 2062 7563 6b65 7420 696e 206d 696c 6c69   bucket in milli
+0001f8f0: 6d65 7465 7273 2e20 452e 672e 2c20 3530  meters. E.g., 50
+0001f900: 2077 696c 6c20 6372 6561 7465 2035 636d   will create 5cm
+0001f910: 2062 7920 3563 6d20 7371 7561 7265 732e   by 5cm squares.
+0001f920: 2049 6620 4e6f 6e65 2c20 7468 656e 2062   If None, then b
+0001f930: 7563 6b65 7473 2077 696c 6c20 6279 2064  uckets will by d
+0001f940: 6566 696e 6564 2062 7920 6060 6275 636b  efined by ``buck
+0001f950: 6574 5f67 7269 645f 7369 7a65 6060 2061  et_grid_size`` a
+0001f960: 7267 756d 656e 742e 0a20 2020 2020 2020  rgument..       
+0001f970: 203a 7061 7261 6d20 4f70 7469 6f6e 616c   :param Optional
+0001f980: 5b49 7465 7261 626c 655b 696e 745d 5d20  [Iterable[int]] 
+0001f990: 6275 636b 6574 5f67 7269 645f 7369 7a65  bucket_grid_size
+0001f9a0: 3a20 322d 7661 6c75 6520 7475 706c 652c  : 2-value tuple,
+0001f9b0: 206c 6973 7420 6f72 2061 7272 6179 2072   list or array r
+0001f9c0: 6570 7265 7365 6e74 696e 6720 7468 6520  epresenting the 
+0001f9d0: 6772 6964 2073 7175 6172 6520 696e 206e  grid square in n
+0001f9e0: 756d 6265 7220 6f66 2068 6f72 697a 6f6e  umber of horizon
+0001f9f0: 7461 6c20 7371 7561 7265 7320 7820 6e75  tal squares x nu
+0001fa00: 6d62 6572 206f 6620 7665 7274 6963 616c  mber of vertical
+0001fa10: 2073 7175 6172 6573 2e20 4966 204e 6f6e   squares. If Non
+0001fa20: 652c 2074 6865 6e20 6275 636b 6574 7320  e, then buckets 
+0001fa30: 7769 6c6c 2062 6520 6465 6669 6e65 6420  will be defined 
+0001fa40: 6279 2074 6865 2060 6062 7563 6b65 745f  by the ``bucket_
+0001fa50: 7369 7a65 5f6d 6d60 6020 6172 6775 6d65  size_mm`` argume
+0001fa60: 6e74 2e0a 2020 2020 2020 2020 3a70 6172  nt..        :par
+0001fa70: 616d 204f 7074 696f 6e61 6c5b 666c 6f61  am Optional[floa
+0001fa80: 745d 2070 785f 7065 725f 6d6d 3a20 5069  t] px_per_mm: Pi
+0001fa90: 7865 6c73 2070 6572 206d 696c 6c69 6d65  xels per millime
+0001faa0: 7465 7220 636f 6e76 6572 7369 6f6e 2066  ter conversion f
+0001fab0: 6163 746f 722e 204e 6563 6573 7365 7279  actor. Necessery
+0001fac0: 2069 6620 6275 636b 6574 7320 6172 6520   if buckets are 
+0001fad0: 6465 6669 6e65 6420 6279 2060 6062 7563  defined by ``buc
+0001fae0: 6b65 745f 7369 7a65 5f6d 6d60 6020 6172  ket_size_mm`` ar
+0001faf0: 6775 6d65 6e74 2e0a 2020 2020 2020 2020  gument..        
+0001fb00: 3a70 6172 616d 204f 7074 696f 6e61 6c5b  :param Optional[
+0001fb10: 626f 6f6c 5d20 6164 645f 636f 7272 6563  bool] add_correc
+0001fb20: 7469 6f6e 3a20 4966 2054 7275 652c 2070  tion: If True, p
+0001fb30: 6572 666f 726d 7320 636f 7272 6563 7469  erforms correcti
+0001fb40: 6f6e 2062 7920 6164 6469 6e67 2065 7874  on by adding ext
+0001fb50: 7261 2063 6f6c 756d 6e73 206f 7220 726f  ra columns or ro
+0001fb60: 7773 2074 6f20 636f 7665 7220 616e 7920  ws to cover any 
+0001fb70: 7265 6d61 696e 696e 6720 7370 6163 6520  remaining space 
+0001fb80: 6966 2075 7369 6e67 2060 6062 7563 6b65  if using ``bucke
+0001fb90: 745f 7369 7a65 5f6d 6d60 602e 2044 6566  t_size_mm``. Def
+0001fba0: 6175 6c74 2054 7275 652e 0a0a 2020 2020  ault True...    
+0001fbb0: 2020 2020 3a65 7861 6d70 6c65 3a0a 2020      :example:.  
+0001fbc0: 2020 2020 2020 3e3e 3e20 696d 6720 3d20        >>> img = 
+0001fbd0: 6376 322e 696d 7265 6164 2827 2f55 7365  cv2.imread('/Use
+0001fbe0: 7273 2f73 696d 6f6e 2f44 6573 6b74 6f70  rs/simon/Desktop
+0001fbf0: 2f53 6372 6565 6e73 686f 7420 3230 3234  /Screenshot 2024
+0001fc00: 2d30 312d 3231 2061 7420 3130 2e31 352e  -01-21 at 10.15.
+0001fc10: 3535 2041 4d2e 706e 6727 2c20 3129 0a20  55 AM.png', 1). 
+0001fc20: 2020 2020 2020 203e 3e3e 2070 6f6c 7967         >>> polyg
+0001fc30: 6f6e 7320 3d20 4765 6f6d 6574 7279 4d69  ons = GeometryMi
+0001fc40: 7869 6e28 292e 6275 636b 6574 5f69 6d67  xin().bucket_img
+0001fc50: 5f69 6e74 6f5f 6772 6964 5f73 7175 6172  _into_grid_squar
+0001fc60: 6528 6275 636b 6574 5f67 7269 645f 7369  e(bucket_grid_si
+0001fc70: 7a65 3d28 3130 2c20 3529 2c20 6275 636b  ze=(10, 5), buck
+0001fc80: 6574 5f67 7269 645f 7369 7a65 5f6d 6d3d  et_grid_size_mm=
+0001fc90: 4e6f 6e65 2c20 696d 675f 7369 7a65 3d28  None, img_size=(
+0001fca0: 696d 672e 7368 6170 655b 315d 2c20 696d  img.shape[1], im
+0001fcb0: 672e 7368 6170 655b 305d 292c 2070 785f  g.shape[0]), px_
+0001fcc0: 7065 725f 6d6d 3d35 2e30 290a 2020 2020  per_mm=5.0).    
+0001fcd0: 2020 2020 3e3e 3e20 666f 7220 6b2c 2076      >>> for k, v
+0001fce0: 2069 6e20 706f 6c79 676f 6e73 5b30 5d2e   in polygons[0].
+0001fcf0: 6974 656d 7328 293a 2063 7632 2e70 6f6c  items(): cv2.pol
+0001fd00: 796c 696e 6573 2869 6d67 2c20 5b6e 702e  ylines(img, [np.
+0001fd10: 6172 7261 7928 762e 6578 7465 7269 6f72  array(v.exterior
+0001fd20: 2e63 6f6f 7264 7329 2e61 7374 7970 6528  .coords).astype(
+0001fd30: 696e 7429 5d2c 2054 7275 652c 2028 3235  int)], True, (25
+0001fd40: 352c 2030 2c20 3133 3329 2c20 3229 0a20  5, 0, 133), 2). 
+0001fd50: 2020 2020 2020 203e 3e3e 2063 7632 2e69         >>> cv2.i
+0001fd60: 6d73 686f 7728 2769 6d67 272c 2069 6d67  mshow('img', img
+0001fd70: 290a 2020 2020 2020 2020 3e3e 3e20 6376  ).        >>> cv
+0001fd80: 322e 7761 6974 4b65 7928 290a 2020 2020  2.waitKey().    
+0001fd90: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+0001fda0: 2074 696d 6572 203d 2053 696d 6261 5469   timer = SimbaTi
+0001fdb0: 6d65 7228 7374 6172 743d 5472 7565 290a  mer(start=True).
+0001fdc0: 2020 2020 2020 2020 6966 2062 7563 6b65          if bucke
+0001fdd0: 745f 6772 6964 5f73 697a 6520 6973 206e  t_grid_size is n
+0001fde0: 6f74 204e 6f6e 6520 616e 6420 6275 636b  ot None and buck
+0001fdf0: 6574 5f67 7269 645f 7369 7a65 5f6d 6d20  et_grid_size_mm 
+0001fe00: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0001fe10: 2020 2020 2020 2020 2072 6169 7365 2049           raise I
+0001fe20: 6e76 616c 6964 496e 7075 7445 7272 6f72  nvalidInputError
+0001fe30: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001fe40: 2020 6d73 673d 2262 7563 6b65 745f 7369    msg="bucket_si
+0001fe50: 7a65 5f6d 6d20 616e 6420 6275 636b 6574  ze_mm and bucket
+0001fe60: 5f67 7269 645f 7369 7a65 2061 7265 2062  _grid_size are b
+0001fe70: 6f74 6820 6e6f 7420 4e6f 6e65 2e20 4569  oth not None. Ei
+0001fe80: 7468 6572 2070 726f 7669 6465 2062 7563  ther provide buc
+0001fe90: 6b65 7420 7369 7a65 2069 6e20 6d69 6c6c  ket size in mill
+0001fea0: 696d 6574 6572 732c 204f 5220 7072 6f76  imeters, OR prov
+0001feb0: 6964 6520 7468 6520 6772 6964 2073 697a  ide the grid siz
+0001fec0: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+0001fed0: 2020 2020 736f 7572 6365 3d47 656f 6d65      source=Geome
+0001fee0: 7472 794d 6978 696e 2829 2e62 7563 6b65  tryMixin().bucke
+0001fef0: 745f 696d 675f 696e 746f 5f67 7269 645f  t_img_into_grid_
+0001ff00: 7371 7561 7265 2e5f 5f6e 616d 655f 5f2c  square.__name__,
+0001ff10: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0001ff20: 2020 2020 2020 2063 6865 636b 5f69 6e73         check_ins
+0001ff30: 7461 6e63 6528 0a20 2020 2020 2020 2020  tance(.         
+0001ff40: 2020 2073 6f75 7263 653d 6622 7b47 656f     source=f"{Geo
+0001ff50: 6d65 7472 794d 6978 696e 2e62 7563 6b65  metryMixin.bucke
+0001ff60: 745f 696d 675f 696e 746f 5f67 7269 645f  t_img_into_grid_
+0001ff70: 7371 7561 7265 2e5f 5f6e 616d 655f 5f7d  square.__name__}
+0001ff80: 2069 6d67 5f73 697a 6522 2c0a 2020 2020   img_size",.    
+0001ff90: 2020 2020 2020 2020 696e 7374 616e 6365          instance
+0001ffa0: 3d69 6d67 5f73 697a 652c 0a20 2020 2020  =img_size,.     
+0001ffb0: 2020 2020 2020 2061 6363 6570 7465 645f         accepted_
+0001ffc0: 7479 7065 733d 2874 7570 6c65 2c20 6e70  types=(tuple, np
+0001ffd0: 2e6e 6461 7272 6179 292c 0a20 2020 2020  .ndarray),.     
+0001ffe0: 2020 2029 0a20 2020 2020 2020 2063 6865     ).        che
+0001fff0: 636b 5f69 7465 7261 626c 655f 6c65 6e67  ck_iterable_leng
+00020000: 7468 280a 2020 2020 2020 2020 2020 2020  th(.            
+00020010: 736f 7572 6365 3d66 227b 4765 6f6d 6574  source=f"{Geomet
+00020020: 7279 4d69 7869 6e2e 6275 636b 6574 5f69  ryMixin.bucket_i
+00020030: 6d67 5f69 6e74 6f5f 6772 6964 5f73 7175  mg_into_grid_squ
+00020040: 6172 652e 5f5f 6e61 6d65 5f5f 7d20 696d  are.__name__} im
+00020050: 675f 7369 7a65 222c 0a20 2020 2020 2020  g_size",.       
+00020060: 2020 2020 2076 616c 3d6c 656e 2869 6d67       val=len(img
+00020070: 5f73 697a 6529 2c0a 2020 2020 2020 2020  _size),.        
+00020080: 2020 2020 6578 6163 745f 6163 6365 7074      exact_accept
+00020090: 6564 5f6c 656e 6774 683d 322c 0a20 2020  ed_length=2,.   
+000200a0: 2020 2020 2029 0a20 2020 2020 2020 2063       ).        c
+000200b0: 6865 636b 5f69 6e74 280a 2020 2020 2020  heck_int(.      
+000200c0: 2020 2020 2020 6e61 6d65 3d66 227b 4765        name=f"{Ge
+000200d0: 6f6d 6574 7279 4d69 7869 6e2e 6275 636b  ometryMixin.buck
+000200e0: 6574 5f69 6d67 5f69 6e74 6f5f 6772 6964  et_img_into_grid
+000200f0: 5f73 7175 6172 652e 5f5f 6e61 6d65 5f5f  _square.__name__
+00020100: 7d20 696d 675f 7369 7a65 2068 6569 6768  } img_size heigh
+00020110: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
+00020120: 7661 6c75 653d 696d 675f 7369 7a65 5b30  value=img_size[0
+00020130: 5d2c 0a20 2020 2020 2020 2029 0a20 2020  ],.        ).   
+00020140: 2020 2020 2063 6865 636b 5f69 6e74 280a       check_int(.
+00020150: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+00020160: 3d66 227b 4765 6f6d 6574 7279 4d69 7869  =f"{GeometryMixi
+00020170: 6e2e 6275 636b 6574 5f69 6d67 5f69 6e74  n.bucket_img_int
+00020180: 6f5f 6772 6964 5f73 7175 6172 652e 5f5f  o_grid_square.__
+00020190: 6e61 6d65 5f5f 7d20 696d 675f 7369 7a65  name__} img_size
+000201a0: 2077 6964 7468 222c 0a20 2020 2020 2020   width",.       
+000201b0: 2020 2020 2076 616c 7565 3d69 6d67 5f73       value=img_s
+000201c0: 697a 655b 315d 2c0a 2020 2020 2020 2020  ize[1],.        
+000201d0: 290a 2020 2020 2020 2020 706f 6c79 676f  ).        polygo
+000201e0: 6e73 203d 207b 7d0a 2020 2020 2020 2020  ns = {}.        
+000201f0: 6966 2062 7563 6b65 745f 6772 6964 5f73  if bucket_grid_s
+00020200: 697a 655f 6d6d 2069 7320 6e6f 7420 4e6f  ize_mm is not No
+00020210: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00020220: 6368 6563 6b5f 666c 6f61 7428 0a20 2020  check_float(.   
+00020230: 2020 2020 2020 2020 2020 2020 206e 616d               nam
+00020240: 653d 6622 7b47 656f 6d65 7472 794d 6978  e=f"{GeometryMix
+00020250: 696e 2e62 7563 6b65 745f 696d 675f 696e  in.bucket_img_in
+00020260: 746f 5f67 7269 645f 7371 7561 7265 2e5f  to_grid_square._
+00020270: 5f6e 616d 655f 5f7d 2062 7563 6b65 745f  _name__} bucket_
+00020280: 7369 7a65 5f6d 6d22 2c0a 2020 2020 2020  size_mm",.      
+00020290: 2020 2020 2020 2020 2020 7661 6c75 653d            value=
+000202a0: 6275 636b 6574 5f67 7269 645f 7369 7a65  bucket_grid_size
+000202b0: 5f6d 6d2c 0a20 2020 2020 2020 2020 2020  _mm,.           
+000202c0: 2029 0a20 2020 2020 2020 2020 2020 2062   ).            b
+000202d0: 696e 5f73 697a 655f 7078 203d 2069 6e74  in_size_px = int
+000202e0: 2870 785f 7065 725f 6d6d 202a 2062 7563  (px_per_mm * buc
+000202f0: 6b65 745f 6772 6964 5f73 697a 655f 6d6d  ket_grid_size_mm
+00020300: 290a 2020 2020 2020 2020 2020 2020 685f  ).            h_
+00020310: 6269 6e5f 636e 742c 2076 5f62 696e 5f63  bin_cnt, v_bin_c
+00020320: 6e74 203d 2064 6976 6d6f 6428 696d 675f  nt = divmod(img_
+00020330: 7369 7a65 5b30 5d2c 2062 696e 5f73 697a  size[0], bin_siz
+00020340: 655f 7078 292c 2064 6976 6d6f 6428 0a20  e_px), divmod(. 
+00020350: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00020360: 6d67 5f73 697a 655b 315d 2c20 6269 6e5f  mg_size[1], bin_
+00020370: 7369 7a65 5f70 780a 2020 2020 2020 2020  size_px.        
+00020380: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00020390: 2020 6966 2028 696d 675f 7369 7a65 5b30    if (img_size[0
+000203a0: 5d20 3c20 6269 6e5f 7369 7a65 5f70 7829  ] < bin_size_px)
+000203b0: 206f 7220 2869 6d67 5f73 697a 655b 315d   or (img_size[1]
+000203c0: 203c 2062 696e 5f73 697a 655f 7078 293a   < bin_size_px):
+000203d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000203e0: 2072 6169 7365 2049 6e76 616c 6964 496e   raise InvalidIn
+000203f0: 7075 7445 7272 6f72 280a 2020 2020 2020  putError(.      
+00020400: 2020 2020 2020 2020 2020 2020 2020 6d73                ms
+00020410: 673d 6622 5468 6520 6275 636b 6574 2073  g=f"The bucket s
+00020420: 7175 6172 6520 7369 7a65 207b 6269 6e5f  quare size {bin_
+00020430: 7369 7a65 5f70 787d 2069 7320 6c61 7267  size_px} is larg
+00020440: 6572 2074 6861 6e20 7468 6520 7669 6465  er than the vide
+00020450: 6f20 7369 7a65 2069 6e20 7069 7865 6c73  o size in pixels
+00020460: 207b 696d 675f 7369 7a65 7d22 0a20 2020   {img_size}".   
+00020470: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00020480: 2020 2020 2020 2020 2020 2069 6620 6164             if ad
+00020490: 645f 636f 7272 6563 7469 6f6e 3a0a 2020  d_correction:.  
+000204a0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000204b0: 2068 5f62 696e 5f63 6e74 5b31 5d20 213d   h_bin_cnt[1] !=
+000204c0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+000204d0: 2020 2020 2020 2020 685f 6269 6e5f 636e          h_bin_cn
+000204e0: 7420 3d20 2868 5f62 696e 5f63 6e74 5b30  t = (h_bin_cnt[0
+000204f0: 5d20 2b20 312c 2068 5f62 696e 5f63 6e74  ] + 1, h_bin_cnt
+00020500: 5b31 5d29 0a20 2020 2020 2020 2020 2020  [1]).           
+00020510: 2020 2020 2069 6620 765f 6269 6e5f 636e       if v_bin_cn
+00020520: 745b 315d 2021 3d20 303a 0a20 2020 2020  t[1] != 0:.     
+00020530: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00020540: 5f62 696e 5f63 6e74 203d 2028 765f 6269  _bin_cnt = (v_bi
+00020550: 6e5f 636e 745b 305d 202b 2031 2c20 765f  n_cnt[0] + 1, v_
+00020560: 6269 6e5f 636e 745b 315d 290a 2020 2020  bin_cnt[1]).    
+00020570: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+00020580: 2072 616e 6765 2868 5f62 696e 5f63 6e74   range(h_bin_cnt
+00020590: 5b30 5d29 3a0a 2020 2020 2020 2020 2020  [0]):.          
+000205a0: 2020 2020 2020 666f 7220 6a20 696e 2072        for j in r
+000205b0: 616e 6765 2876 5f62 696e 5f63 6e74 5b30  ange(v_bin_cnt[0
+000205c0: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
+000205d0: 2020 2020 2020 2020 7831 2c20 7931 203d          x1, y1 =
+000205e0: 2069 202a 2062 696e 5f73 697a 655f 7078   i * bin_size_px
+000205f0: 2c20 6a20 2a20 6269 6e5f 7369 7a65 5f70  , j * bin_size_p
+00020600: 780a 2020 2020 2020 2020 2020 2020 2020  x.              
+00020610: 2020 2020 2020 7832 2c20 7932 203d 2078        x2, y2 = x
+00020620: 3120 2b20 6269 6e5f 7369 7a65 5f70 782c  1 + bin_size_px,
+00020630: 2079 3120 2b20 6269 6e5f 7369 7a65 5f70   y1 + bin_size_p
+00020640: 780a 2020 2020 2020 2020 2020 2020 2020  x.              
+00020650: 2020 2020 2020 706f 6c79 676f 6e73 5b28        polygons[(
+00020660: 692c 206a 295d 203d 2050 6f6c 7967 6f6e  i, j)] = Polygon
+00020670: 285b 2878 312c 2079 3129 2c20 2878 322c  ([(x1, y1), (x2,
+00020680: 2079 3129 2c20 2878 322c 2079 3229 2c20   y1), (x2, y2), 
+00020690: 2878 312c 2079 3229 5d29 0a20 2020 2020  (x1, y2)]).     
+000206a0: 2020 2020 2020 2074 696d 6572 2e73 746f         timer.sto
+000206b0: 705f 7469 6d65 7228 290a 2020 2020 2020  p_timer().      
+000206c0: 2020 2020 2020 7374 646f 7574 5f73 7563        stdout_suc
+000206d0: 6365 7373 280a 2020 2020 2020 2020 2020  cess(.          
+000206e0: 2020 2020 2020 6d73 673d 2242 7563 6b65        msg="Bucke
+000206f0: 7420 696d 6167 6520 696e 746f 2067 7269  t image into gri
+00020700: 6420 7371 7561 7265 7320 636f 6d70 6c65  d squares comple
+00020710: 7465 222c 0a20 2020 2020 2020 2020 2020  te",.           
+00020720: 2020 2020 2065 6c61 7073 6564 5f74 696d       elapsed_tim
+00020730: 653d 7469 6d65 722e 656c 6170 7365 645f  e=timer.elapsed_
+00020740: 7469 6d65 5f73 7472 2c0a 2020 2020 2020  time_str,.      
+00020750: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00020760: 2020 2020 7265 7475 726e 2070 6f6c 7967      return polyg
+00020770: 6f6e 732c 2072 6f75 6e64 2828 765f 6269  ons, round((v_bi
+00020780: 6e5f 636e 745b 305d 202f 2068 5f62 696e  n_cnt[0] / h_bin
+00020790: 5f63 6e74 5b30 5d29 2c20 3329 0a0a 2020  _cnt[0]), 3)..  
+000207a0: 2020 2020 2020 6966 2062 7563 6b65 745f        if bucket_
+000207b0: 6772 6964 5f73 697a 6520 6973 206e 6f74  grid_size is not
+000207c0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+000207d0: 2020 2063 6865 636b 5f69 6e73 7461 6e63     check_instanc
+000207e0: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+000207f0: 2020 2073 6f75 7263 653d 6622 7b47 656f     source=f"{Geo
+00020800: 6d65 7472 794d 6978 696e 2e5f 5f6e 616d  metryMixin.__nam
+00020810: 655f 5f7d 2062 7563 6b65 745f 6772 6964  e__} bucket_grid
+00020820: 5f73 697a 6522 2c0a 2020 2020 2020 2020  _size",.        
+00020830: 2020 2020 2020 2020 696e 7374 616e 6365          instance
+00020840: 3d62 7563 6b65 745f 6772 6964 5f73 697a  =bucket_grid_siz
+00020850: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00020860: 2020 2061 6363 6570 7465 645f 7479 7065     accepted_type
+00020870: 733d 2874 7570 6c65 2c20 6e70 2e6e 6461  s=(tuple, np.nda
+00020880: 7272 6179 2c20 6c69 7374 292c 0a20 2020  rray, list),.   
+00020890: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+000208a0: 2020 2020 2020 2063 6865 636b 5f69 7465         check_ite
+000208b0: 7261 626c 655f 6c65 6e67 7468 280a 2020  rable_length(.  
+000208c0: 2020 2020 2020 2020 2020 2020 2020 736f                so
+000208d0: 7572 6365 3d66 227b 4765 6f6d 6574 7279  urce=f"{Geometry
+000208e0: 4d69 7869 6e2e 5f5f 6e61 6d65 5f5f 7d20  Mixin.__name__} 
+000208f0: 6275 636b 6574 5f67 7269 645f 7369 7a65  bucket_grid_size
+00020900: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00020910: 2020 2076 616c 3d6c 656e 2862 7563 6b65     val=len(bucke
+00020920: 745f 6772 6964 5f73 697a 6529 2c0a 2020  t_grid_size),.  
+00020930: 2020 2020 2020 2020 2020 2020 2020 6578                ex
+00020940: 6163 745f 6163 6365 7074 6564 5f6c 656e  act_accepted_len
+00020950: 6774 683d 322c 0a20 2020 2020 2020 2020  gth=2,.         
+00020960: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00020970: 2063 6865 636b 5f69 6e74 280a 2020 2020   check_int(.    
+00020980: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+00020990: 3d66 227b 4765 6f6d 6574 7279 4d69 7869  =f"{GeometryMixi
+000209a0: 6e2e 6275 636b 6574 5f69 6d67 5f69 6e74  n.bucket_img_int
+000209b0: 6f5f 6772 6964 5f73 7175 6172 652e 5f5f  o_grid_square.__
+000209c0: 6e61 6d65 5f5f 7d20 6275 636b 6574 5f67  name__} bucket_g
+000209d0: 7269 645f 7369 7a65 222c 0a20 2020 2020  rid_size",.     
+000209e0: 2020 2020 2020 2020 2020 2076 616c 7565             value
+000209f0: 3d62 7563 6b65 745f 6772 6964 5f73 697a  =bucket_grid_siz
+00020a00: 655b 305d 2c0a 2020 2020 2020 2020 2020  e[0],.          
+00020a10: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00020a20: 6368 6563 6b5f 696e 7428 0a20 2020 2020  check_int(.     
+00020a30: 2020 2020 2020 2020 2020 206e 616d 653d             name=
+00020a40: 6622 7b47 656f 6d65 7472 794d 6978 696e  f"{GeometryMixin
+00020a50: 2e62 7563 6b65 745f 696d 675f 696e 746f  .bucket_img_into
+00020a60: 5f67 7269 645f 7371 7561 7265 2e5f 5f6e  _grid_square.__n
+00020a70: 616d 655f 5f7d 2062 7563 6b65 745f 6772  ame__} bucket_gr
+00020a80: 6964 5f73 697a 6522 2c0a 2020 2020 2020  id_size",.      
+00020a90: 2020 2020 2020 2020 2020 7661 6c75 653d            value=
+00020aa0: 6275 636b 6574 5f67 7269 645f 7369 7a65  bucket_grid_size
+00020ab0: 5b31 5d2c 0a20 2020 2020 2020 2020 2020  [1],.           
+00020ac0: 2029 0a20 2020 2020 2020 2020 2020 2062   ).            b
+00020ad0: 7563 6b65 745f 7769 6474 682c 2062 7563  ucket_width, buc
+00020ae0: 6b65 745f 6865 6967 6874 203d 2069 6e74  ket_height = int
+00020af0: 2869 6d67 5f73 697a 655b 305d 202f 2062  (img_size[0] / b
+00020b00: 7563 6b65 745f 6772 6964 5f73 697a 655b  ucket_grid_size[
+00020b10: 305d 292c 2069 6e74 280a 2020 2020 2020  0]), int(.      
+00020b20: 2020 2020 2020 2020 2020 696d 675f 7369            img_si
+00020b30: 7a65 5b31 5d20 2f20 6275 636b 6574 5f67  ze[1] / bucket_g
+00020b40: 7269 645f 7369 7a65 5b31 5d0a 2020 2020  rid_size[1].    
+00020b50: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00020b60: 2020 2020 2020 6966 2028 696d 675f 7369        if (img_si
+00020b70: 7a65 5b30 5d20 3c20 6275 636b 6574 5f77  ze[0] < bucket_w
+00020b80: 6964 7468 2920 6f72 2028 696d 675f 7369  idth) or (img_si
+00020b90: 7a65 5b31 5d20 3c20 6275 636b 6574 5f68  ze[1] < bucket_h
+00020ba0: 6569 6768 7429 3a0a 2020 2020 2020 2020  eight):.        
+00020bb0: 2020 2020 2020 2020 7261 6973 6520 496e          raise In
+00020bc0: 7661 6c69 6449 6e70 7574 4572 726f 7228  validInputError(
+00020bd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020be0: 2020 2020 206d 7367 3d66 2254 6865 2062       msg=f"The b
+00020bf0: 7563 6b65 7420 7371 7561 7265 2073 697a  ucket square siz
+00020c00: 6520 287b 6275 636b 6574 5f77 6964 7468  e ({bucket_width
+00020c10: 7d20 7820 7b62 7563 6b65 745f 6865 6967  } x {bucket_heig
+00020c20: 6874 7d29 2069 7320 6c61 7267 6572 2074  ht}) is larger t
+00020c30: 6861 6e20 7468 6520 7669 6465 6f20 7369  han the video si
+00020c40: 7a65 2069 6e20 7069 7865 6c73 207b 696d  ze in pixels {im
+00020c50: 675f 7369 7a65 7d22 0a20 2020 2020 2020  g_size}".       
+00020c60: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+00020c70: 2020 2020 2020 2020 666f 7220 685f 636e          for h_cn
+00020c80: 7420 696e 2072 616e 6765 2862 7563 6b65  t in range(bucke
+00020c90: 745f 6772 6964 5f73 697a 655b 305d 293a  t_grid_size[0]):
+00020ca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020cb0: 2066 6f72 2077 5f63 6e74 2069 6e20 7261   for w_cnt in ra
+00020cc0: 6e67 6528 6275 636b 6574 5f67 7269 645f  nge(bucket_grid_
+00020cd0: 7369 7a65 5b31 5d29 3a0a 2020 2020 2020  size[1]):.      
+00020ce0: 2020 2020 2020 2020 2020 2020 2020 746f                to
+00020cf0: 705f 6c65 6674 203d 2028 2868 5f63 6e74  p_left = ((h_cnt
+00020d00: 202a 2062 7563 6b65 745f 7769 6474 6829   * bucket_width)
+00020d10: 2c20 2877 5f63 6e74 202a 2062 7563 6b65  , (w_cnt * bucke
+00020d20: 745f 6865 6967 6874 2929 0a20 2020 2020  t_height)).     
+00020d30: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00020d40: 6f70 5f72 6967 6874 203d 2028 2874 6f70  op_right = ((top
+00020d50: 5f6c 6566 745b 305d 202b 2062 7563 6b65  _left[0] + bucke
+00020d60: 745f 7769 6474 6829 2c20 746f 705f 6c65  t_width), top_le
+00020d70: 6674 5b31 5d29 0a20 2020 2020 2020 2020  ft[1]).         
+00020d80: 2020 2020 2020 2020 2020 2062 6f74 746f             botto
+00020d90: 6d5f 6c65 6674 203d 2028 746f 705f 6c65  m_left = (top_le
+00020da0: 6674 5b30 5d2c 2074 6f70 5f6c 6566 745b  ft[0], top_left[
+00020db0: 315d 202b 2062 7563 6b65 745f 6865 6967  1] + bucket_heig
+00020dc0: 6874 290a 2020 2020 2020 2020 2020 2020  ht).            
+00020dd0: 2020 2020 2020 2020 626f 7474 6f6d 5f72          bottom_r
+00020de0: 6967 6874 203d 2028 746f 705f 7269 6768  ight = (top_righ
+00020df0: 745b 305d 2c20 746f 705f 7269 6768 745b  t[0], top_right[
+00020e00: 315d 202b 2062 7563 6b65 745f 6865 6967  1] + bucket_heig
+00020e10: 6874 290a 2020 2020 2020 2020 2020 2020  ht).            
+00020e20: 2020 2020 2020 2020 706f 6c79 676f 6e73          polygons
+00020e30: 5b28 685f 636e 742c 2077 5f63 6e74 295d  [(h_cnt, w_cnt)]
+00020e40: 203d 2050 6f6c 7967 6f6e 280a 2020 2020   = Polygon(.    
+00020e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020e60: 2020 2020 5b74 6f70 5f6c 6566 742c 2062      [top_left, b
+00020e70: 6f74 746f 6d5f 6c65 6674 2c20 626f 7474  ottom_left, bott
+00020e80: 6f6d 5f72 6967 6874 2c20 746f 705f 7269  om_right, top_ri
+00020e90: 6768 745d 0a20 2020 2020 2020 2020 2020  ght].           
+00020ea0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00020eb0: 2020 2020 2020 2074 696d 6572 2e73 746f         timer.sto
+00020ec0: 705f 7469 6d65 7228 290a 2020 2020 2020  p_timer().      
+00020ed0: 2020 2020 2020 7374 646f 7574 5f73 7563        stdout_suc
+00020ee0: 6365 7373 280a 2020 2020 2020 2020 2020  cess(.          
+00020ef0: 2020 2020 2020 6d73 673d 2242 7563 6b65        msg="Bucke
+00020f00: 7420 696d 6167 6520 696e 746f 2067 7269  t image into gri
+00020f10: 6420 7371 7561 7265 7320 636f 6d70 6c65  d squares comple
+00020f20: 7465 222c 0a20 2020 2020 2020 2020 2020  te",.           
+00020f30: 2020 2020 2065 6c61 7073 6564 5f74 696d       elapsed_tim
+00020f40: 653d 7469 6d65 722e 656c 6170 7365 645f  e=timer.elapsed_
+00020f50: 7469 6d65 5f73 7472 2c0a 2020 2020 2020  time_str,.      
+00020f60: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00020f70: 2020 2020 7265 7475 726e 2070 6f6c 7967      return polyg
+00020f80: 6f6e 732c 2072 6f75 6e64 2828 6275 636b  ons, round((buck
+00020f90: 6574 5f67 7269 645f 7369 7a65 5b31 5d20  et_grid_size[1] 
+00020fa0: 2f20 6275 636b 6574 5f67 7269 645f 7369  / bucket_grid_si
+00020fb0: 7a65 5b30 5d29 2c20 3329 0a0a 2020 2020  ze[0]), 3)..    
+00020fc0: 4073 7461 7469 636d 6574 686f 640a 2020  @staticmethod.  
+00020fd0: 2020 6465 6620 6275 636b 6574 5f69 6d67    def bucket_img
+00020fe0: 5f69 6e74 6f5f 6772 6964 5f68 6578 6167  _into_grid_hexag
+00020ff0: 6f6e 280a 2020 2020 2020 2020 6275 636b  on(.        buck
+00021000: 6574 5f73 697a 655f 6d6d 3a20 666c 6f61  et_size_mm: floa
+00021010: 742c 2069 6d67 5f73 697a 653a 2054 7570  t, img_size: Tup
+00021020: 6c65 5b69 6e74 2c20 696e 745d 2c20 7078  le[int, int], px
+00021030: 5f70 6572 5f6d 6d3a 2066 6c6f 6174 0a20  _per_mm: float. 
+00021040: 2020 2029 202d 3e20 5475 706c 655b 4469     ) -> Tuple[Di
+00021050: 6374 5b54 7570 6c65 5b69 6e74 2c20 696e  ct[Tuple[int, in
+00021060: 745d 2c20 506f 6c79 676f 6e5d 2c20 666c  t], Polygon], fl
+00021070: 6f61 745d 3a0a 2020 2020 2020 2020 2222  oat]:.        ""
+00021080: 220a 2020 2020 2020 2020 4275 636b 6574  ".        Bucket
+00021090: 697a 6520 616e 2069 6d61 6765 2069 6e74  ize an image int
+000210a0: 6f20 6865 7861 676f 6e73 2061 6e64 2072  o hexagons and r
+000210b0: 6574 7572 6e20 6120 6469 6374 696f 6e61  eturn a dictiona
+000210c0: 7279 206f 6620 706f 6c79 676f 6e73 2072  ry of polygons r
+000210d0: 6570 7265 7365 6e74 696e 6720 7468 6520  epresenting the 
+000210e0: 6865 7861 676f 6e20 6c6f 6361 7469 6f6e  hexagon location
+000210f0: 732e 0a0a 2020 2020 2020 2020 2e2e 2069  s...        .. i
+00021100: 6d61 6765 3a3a 205f 7374 6174 6963 2f69  mage:: _static/i
+00021110: 6d67 2f62 7563 6b65 745f 696d 675f 696e  mg/bucket_img_in
+00021120: 746f 5f67 7269 645f 6865 7861 676f 6e2e  to_grid_hexagon.
+00021130: 706e 670a 2020 2020 2020 2020 2020 203a  png.           :
+00021140: 7769 6474 683a 2035 3030 0a20 2020 2020  width: 500.     
+00021150: 2020 2020 2020 3a61 6c69 676e 3a20 6365        :align: ce
+00021160: 6e74 6572 0a0a 2020 2020 2020 2020 3a70  nter..        :p
+00021170: 6172 616d 2066 6c6f 6174 2062 7563 6b65  aram float bucke
+00021180: 745f 7369 7a65 5f6d 6d3a 2054 6865 2077  t_size_mm: The w
+00021190: 6964 7468 2f68 6569 6768 7420 6f66 2065  idth/height of e
+000211a0: 6163 6820 6865 7861 676f 6e20 6275 636b  ach hexagon buck
+000211b0: 6574 2069 6e20 6d69 6c6c 696d 6574 6572  et in millimeter
+000211c0: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
+000211d0: 6d20 5475 706c 655b 696e 742c 2069 6e74  m Tuple[int, int
+000211e0: 5d20 696d 675f 7369 7a65 3a20 5475 706c  ] img_size: Tupl
+000211f0: 6520 7265 7072 6573 656e 7469 6e67 2074  e representing t
+00021200: 6865 2077 6964 7468 2061 6e64 2068 6569  he width and hei
+00021210: 6768 7420 6f66 2074 6865 2069 6d61 6765  ght of the image
+00021220: 2069 6e20 7069 7865 6c73 2e0a 2020 2020   in pixels..    
+00021230: 2020 2020 3a70 6172 616d 2066 6c6f 6174      :param float
+00021240: 2070 785f 7065 725f 6d6d 3a20 5069 7865   px_per_mm: Pixe
+00021250: 6c73 2070 6572 206d 696c 6c69 6d65 7465  ls per millimete
+00021260: 7220 636f 6e76 6572 7369 6f6e 2066 6163  r conversion fac
+00021270: 746f 722e 0a20 2020 2020 2020 203a 7265  tor..        :re
+00021280: 7475 726e 2054 7570 6c65 5b44 6963 745b  turn Tuple[Dict[
+00021290: 5475 706c 655b 696e 742c 2069 6e74 5d2c  Tuple[int, int],
+000212a0: 2050 6f6c 7967 6f6e 5d2c 2066 6c6f 6174   Polygon], float
+000212b0: 5d3a 2046 6972 7374 2076 616c 7565 2069  ]: First value i
+000212c0: 7320 6120 6469 6374 696f 6e61 7279 2077  s a dictionary w
+000212d0: 6865 7265 206b 6579 7320 6172 6520 2872  here keys are (r
+000212e0: 6f77 2c20 636f 6c75 6d6e 2920 696e 6469  ow, column) indi
+000212f0: 6365 7320 6f66 2074 6865 2062 7563 6b65  ces of the bucke
+00021300: 742c 2061 6e64 2076 616c 7565 7320 6172  t, and values ar
+00021310: 6520 5368 6170 656c 7920 506f 6c79 676f  e Shapely Polygo
+00021320: 6e20 6f62 6a65 6374 7320 7265 7072 6573  n objects repres
+00021330: 656e 7469 6e67 2074 6865 2063 6f72 7265  enting the corre
+00021340: 7370 6f6e 6469 6e67 2068 6578 6167 6f6e  sponding hexagon
+00021350: 2062 7563 6b65 7473 2e20 5365 636f 6e64   buckets. Second
+00021360: 2076 616c 7565 2069 7320 7468 6520 6173   value is the as
+00021370: 7065 6374 2072 6174 696f 206f 6620 7468  pect ratio of th
+00021380: 6520 6865 7861 676f 6e61 6c20 6772 6964  e hexagonal grid
+00021390: 2e0a 0a20 2020 2020 2020 203a 6578 616d  ...        :exam
+000213a0: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
+000213b0: 2070 6f6c 7967 6f6e 732c 2061 7370 6563   polygons, aspec
+000213c0: 745f 7261 7469 6f20 3d20 4765 6f6d 6574  t_ratio = Geomet
+000213d0: 7279 4d69 7869 6e28 292e 6275 636b 6574  ryMixin().bucket
+000213e0: 5f69 6d67 5f69 6e74 6f5f 6772 6964 5f68  _img_into_grid_h
+000213f0: 6578 6167 6f6e 2862 7563 6b65 745f 7369  exagon(bucket_si
+00021400: 7a65 5f6d 6d3d 3130 2c20 696d 675f 7369  ze_mm=10, img_si
+00021410: 7a65 3d28 3830 302c 2036 3030 292c 2070  ze=(800, 600), p
+00021420: 785f 7065 725f 6d6d 3d35 2e30 2c20 6164  x_per_mm=5.0, ad
+00021430: 645f 636f 7272 6563 7469 6f6e 3d54 7275  d_correction=Tru
+00021440: 6529 0a20 2020 2020 2020 2022 2222 0a0a  e).        """..
+00021450: 2020 2020 2020 2020 7469 6d65 7220 3d20          timer = 
+00021460: 5369 6d62 6154 696d 6572 2873 7461 7274  SimbaTimer(start
+00021470: 3d54 7275 6529 0a20 2020 2020 2020 2063  =True).        c
+00021480: 6865 636b 5f66 6c6f 6174 280a 2020 2020  heck_float(.    
+00021490: 2020 2020 2020 2020 6e61 6d65 3d66 2262          name=f"b
+000214a0: 7563 6b65 745f 696d 675f 696e 746f 5f67  ucket_img_into_g
+000214b0: 7269 645f 6865 7861 676f 6e20 6275 636b  rid_hexagon buck
+000214c0: 6574 5f73 697a 655f 6d6d 222c 2076 616c  et_size_mm", val
+000214d0: 7565 3d62 7563 6b65 745f 7369 7a65 5f6d  ue=bucket_size_m
+000214e0: 6d0a 2020 2020 2020 2020 290a 2020 2020  m.        ).    
+000214f0: 2020 2020 6368 6563 6b5f 696e 7428 0a20      check_int(. 
+00021500: 2020 2020 2020 2020 2020 206e 616d 653d             name=
+00021510: 6622 6275 636b 6574 5f69 6d67 5f69 6e74  f"bucket_img_int
+00021520: 6f5f 6772 6964 5f68 6578 6167 6f6e 2069  o_grid_hexagon i
+00021530: 6d67 5f73 697a 6520 6865 6967 6874 222c  mg_size height",
+00021540: 2076 616c 7565 3d69 6d67 5f73 697a 655b   value=img_size[
+00021550: 305d 0a20 2020 2020 2020 2029 0a20 2020  0].        ).   
+00021560: 2020 2020 2063 6865 636b 5f69 6e74 280a       check_int(.
+00021570: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+00021580: 3d66 2262 7563 6b65 745f 696d 675f 696e  =f"bucket_img_in
+00021590: 746f 5f67 7269 645f 6865 7861 676f 6e20  to_grid_hexagon 
+000215a0: 696d 675f 7369 7a65 2077 6964 7468 222c  img_size width",
+000215b0: 2076 616c 7565 3d69 6d67 5f73 697a 655b   value=img_size[
+000215c0: 315d 0a20 2020 2020 2020 2029 0a20 2020  1].        ).   
+000215d0: 2020 2020 2063 6865 636b 5f66 6c6f 6174       check_float
+000215e0: 286e 616d 653d 6622 6275 636b 6574 5f69  (name=f"bucket_i
+000215f0: 6d67 5f69 6e74 6f5f 6772 6964 5f68 6578  mg_into_grid_hex
+00021600: 6167 6f6e 2070 785f 7065 725f 6d6d 222c  agon px_per_mm",
+00021610: 2076 616c 7565 3d70 785f 7065 725f 6d6d   value=px_per_mm
+00021620: 290a 0a20 2020 2020 2020 2073 7172 745f  )..        sqrt_
+00021630: 3320 3d20 6d61 7468 2e73 7172 7428 3329  3 = math.sqrt(3)
+00021640: 0a20 2020 2020 2020 2068 6578 5f77 6964  .        hex_wid
+00021650: 7468 203d 2033 202f 2032 202a 2062 7563  th = 3 / 2 * buc
+00021660: 6b65 745f 7369 7a65 5f6d 6d20 2a20 7078  ket_size_mm * px
+00021670: 5f70 6572 5f6d 6d0a 2020 2020 2020 2020  _per_mm.        
+00021680: 6865 785f 6865 6967 6874 203d 2073 7172  hex_height = sqr
+00021690: 745f 3320 2a20 6275 636b 6574 5f73 697a  t_3 * bucket_siz
+000216a0: 655f 6d6d 202a 2070 785f 7065 725f 6d6d  e_mm * px_per_mm
+000216b0: 0a0a 2020 2020 2020 2020 685f 6865 785f  ..        h_hex_
+000216c0: 636e 742c 2076 5f68 6578 5f63 6e74 203d  cnt, v_hex_cnt =
+000216d0: 2064 6976 6d6f 6428 696d 675f 7369 7a65   divmod(img_size
+000216e0: 5b30 5d2c 2069 6e74 2868 6578 5f68 6569  [0], int(hex_hei
+000216f0: 6768 7429 292c 2064 6976 6d6f 6428 0a20  ght)), divmod(. 
+00021700: 2020 2020 2020 2020 2020 2069 6d67 5f73             img_s
+00021710: 697a 655b 315d 2c20 696e 7428 6865 785f  ize[1], int(hex_
+00021720: 7769 6474 6829 0a20 2020 2020 2020 2029  width).        )
+00021730: 0a20 2020 2020 2020 2069 6620 685f 6865  .        if h_he
+00021740: 785f 636e 745b 315d 2021 3d20 303a 0a20  x_cnt[1] != 0:. 
+00021750: 2020 2020 2020 2020 2020 2068 5f68 6578             h_hex
+00021760: 5f63 6e74 203d 2028 685f 6865 785f 636e  _cnt = (h_hex_cn
+00021770: 745b 305d 202b 2031 2c20 685f 6865 785f  t[0] + 1, h_hex_
+00021780: 636e 745b 315d 290a 2020 2020 2020 2020  cnt[1]).        
+00021790: 6966 2076 5f68 6578 5f63 6e74 5b31 5d20  if v_hex_cnt[1] 
+000217a0: 213d 2030 3a0a 2020 2020 2020 2020 2020  != 0:.          
+000217b0: 2020 765f 6865 785f 636e 7420 3d20 2876    v_hex_cnt = (v
+000217c0: 5f68 6578 5f63 6e74 5b30 5d20 2b20 312c  _hex_cnt[0] + 1,
+000217d0: 2076 5f68 6578 5f63 6e74 5b31 5d29 0a0a   v_hex_cnt[1])..
+000217e0: 2020 2020 2020 2020 706f 6c79 676f 6e73          polygons
+000217f0: 203d 207b 7d0a 2020 2020 2020 2020 666f   = {}.        fo
+00021800: 7220 6920 696e 2072 616e 6765 2868 5f68  r i in range(h_h
+00021810: 6578 5f63 6e74 5b30 5d29 3a0a 2020 2020  ex_cnt[0]):.    
+00021820: 2020 2020 2020 2020 666f 7220 6a20 696e          for j in
+00021830: 2072 616e 6765 2876 5f68 6578 5f63 6e74   range(v_hex_cnt
+00021840: 5b30 5d20 2b20 2869 2025 2032 2920 2a20  [0] + (i % 2) * 
+00021850: 3129 3a0a 2020 2020 2020 2020 2020 2020  1):.            
+00021860: 2020 2020 7820 3d20 6920 2a20 3320 2f20      x = i * 3 / 
+00021870: 3220 2a20 6865 785f 7769 6474 680a 2020  2 * hex_width.  
+00021880: 2020 2020 2020 2020 2020 2020 2020 7920                y 
+00021890: 3d20 6a20 2a20 7371 7274 5f33 202a 2068  = j * sqrt_3 * h
+000218a0: 6578 5f68 6569 6768 7420 2b20 2869 2025  ex_height + (i %
+000218b0: 2032 2920 2a20 7371 7274 5f33 202a 2068   2) * sqrt_3 * h
+000218c0: 6578 5f68 6569 6768 7420 2f20 320a 2020  ex_height / 2.  
+000218d0: 2020 2020 2020 2020 2020 2020 2020 7665                ve
+000218e0: 7274 6963 6573 203d 205b 5d0a 2020 2020  rtices = [].    
+000218f0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00021900: 6b20 696e 2072 616e 6765 2836 293a 0a20  k in range(6):. 
+00021910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021920: 2020 2061 6e67 6c65 203d 2028 6d61 7468     angle = (math
+00021930: 2e70 6920 2f20 3329 202a 206b 0a20 2020  .pi / 3) * k.   
+00021940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021950: 2076 6572 7469 6365 732e 6170 7065 6e64   vertices.append
+00021960: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00021970: 2020 2020 2020 2020 2020 280a 2020 2020            (.    
+00021980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021990: 2020 2020 2020 2020 7820 2b20 6865 785f          x + hex_
+000219a0: 7769 6474 6820 2a20 6d61 7468 2e63 6f73  width * math.cos
+000219b0: 2861 6e67 6c65 292c 0a20 2020 2020 2020  (angle),.       
+000219c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000219d0: 2020 2020 2079 202b 2068 6578 5f68 6569       y + hex_hei
+000219e0: 6768 7420 2a20 6d61 7468 2e73 696e 2861  ght * math.sin(a
+000219f0: 6e67 6c65 292c 0a20 2020 2020 2020 2020  ngle),.         
+00021a00: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00021a10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00021a20: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00021a30: 2020 2020 2020 2020 706f 6c79 676f 6e73          polygons
+00021a40: 5b28 692c 206a 295d 203d 2050 6f6c 7967  [(i, j)] = Polyg
+00021a50: 6f6e 2876 6572 7469 6365 7329 0a0a 2020  on(vertices)..  
+00021a60: 2020 2020 2020 7469 6d65 722e 7374 6f70        timer.stop
+00021a70: 5f74 696d 6572 2829 0a20 2020 2020 2020  _timer().       
+00021a80: 2073 7464 6f75 745f 7375 6363 6573 7328   stdout_success(
+00021a90: 0a20 2020 2020 2020 2020 2020 206d 7367  .            msg
+00021aa0: 3d22 4275 636b 6574 2069 6d61 6765 2069  ="Bucket image i
+00021ab0: 6e74 6f20 6865 7861 676f 6e20 6772 6964  nto hexagon grid
+00021ac0: 2063 6f6d 706c 6574 6522 2c0a 2020 2020   complete",.    
+00021ad0: 2020 2020 2020 2020 656c 6170 7365 645f          elapsed_
+00021ae0: 7469 6d65 3d74 696d 6572 2e65 6c61 7073  time=timer.elaps
+00021af0: 6564 5f74 696d 655f 7374 722c 0a20 2020  ed_time_str,.   
+00021b00: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
+00021b10: 6574 7572 6e20 706f 6c79 676f 6e73 2c20  eturn polygons, 
+00021b20: 726f 756e 6428 2876 5f68 6578 5f63 6e74  round((v_hex_cnt
+00021b30: 5b30 5d20 2f20 685f 6865 785f 636e 745b  [0] / h_hex_cnt[
+00021b40: 305d 292c 2033 290a 0a20 2020 2040 7374  0]), 3)..    @st
+00021b50: 6174 6963 6d65 7468 6f64 0a20 2020 2064  aticmethod.    d
+00021b60: 6566 205f 6375 6d73 756d 5f63 6f6f 7264  ef _cumsum_coord
+00021b70: 5f67 656f 6d65 7472 6965 735f 6865 6c70  _geometries_help
+00021b80: 6572 280a 2020 2020 2020 2020 6461 7461  er(.        data
+00021b90: 3a20 6e70 2e6e 6461 7272 6179 2c20 6765  : np.ndarray, ge
+00021ba0: 6f6d 6574 7269 6573 3a20 4469 6374 5b54  ometries: Dict[T
+00021bb0: 7570 6c65 5b69 6e74 2c20 696e 745d 2c20  uple[int, int], 
+00021bc0: 506f 6c79 676f 6e5d 2c20 7665 7262 6f73  Polygon], verbos
+00021bd0: 653a 2062 6f6f 6c0a 2020 2020 293a 0a20  e: bool.    ):. 
+00021be0: 2020 2020 2020 2064 6174 615f 706f 696e         data_poin
+00021bf0: 7420 3d20 506f 696e 7428 6461 7461 5b31  t = Point(data[1
+00021c00: 3a5d 290a 2020 2020 2020 2020 6966 2076  :]).        if v
+00021c10: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
+00021c20: 2020 2020 7072 696e 7428 6622 5072 6f63      print(f"Proc
+00021c30: 6573 7369 6e67 2061 6e69 6d61 6c20 6772  essing animal gr
+00021c40: 6964 2073 7175 6172 6520 6c6f 6361 7469  id square locati
+00021c50: 6f6e 2069 6e20 6672 616d 6520 7b69 6e74  on in frame {int
+00021c60: 2864 6174 615b 305d 297d 2e2e 2e22 290a  (data[0])}...").
+00021c70: 2020 2020 2020 2020 666f 7220 6b2c 2072          for k, r
+00021c80: 2069 6e20 6765 6f6d 6574 7269 6573 2e69   in geometries.i
+00021c90: 7465 6d73 2829 3a0a 2020 2020 2020 2020  tems():.        
+00021ca0: 2020 2020 6966 2072 2e63 6f6e 7461 696e      if r.contain
+00021cb0: 7328 6461 7461 5f70 6f69 6e74 293a 0a20  s(data_point):. 
+00021cc0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00021cd0: 6574 7572 6e20 2869 6e74 2864 6174 615b  eturn (int(data[
+00021ce0: 305d 292c 206b 5b30 5d2c 206b 5b31 5d29  0]), k[0], k[1])
+00021cf0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00021d00: 2869 6e74 2864 6174 615b 305d 292c 202d  (int(data[0]), -
+00021d10: 312c 202d 3129 0a0a 2020 2020 6465 6620  1, -1)..    def 
+00021d20: 6375 6d73 756d 5f63 6f6f 7264 5f67 656f  cumsum_coord_geo
+00021d30: 6d65 7472 6965 7328 0a20 2020 2020 2020  metries(.       
+00021d40: 2073 656c 662c 0a20 2020 2020 2020 2064   self,.        d
+00021d50: 6174 613a 206e 702e 6e64 6172 7261 792c  ata: np.ndarray,
+00021d60: 0a20 2020 2020 2020 2067 656f 6d65 7472  .        geometr
+00021d70: 6965 733a 2044 6963 745b 5475 706c 655b  ies: Dict[Tuple[
+00021d80: 696e 742c 2069 6e74 5d2c 2050 6f6c 7967  int, int], Polyg
+00021d90: 6f6e 5d2c 0a20 2020 2020 2020 2066 7073  on],.        fps
+00021da0: 3a20 4f70 7469 6f6e 616c 5b69 6e74 5d20  : Optional[int] 
+00021db0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+00021dc0: 636f 7265 5f63 6e74 3a20 4f70 7469 6f6e  core_cnt: Option
+00021dd0: 616c 5b69 6e74 5d20 3d20 2d31 2c0a 2020  al[int] = -1,.  
+00021de0: 2020 2020 2020 7665 7262 6f73 653a 204f        verbose: O
+00021df0: 7074 696f 6e61 6c5b 626f 6f6c 5d20 3d20  ptional[bool] = 
+00021e00: 5472 7565 2c0a 2020 2020 293a 0a20 2020  True,.    ):.   
+00021e10: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00021e20: 2043 6f6d 7075 7465 2074 6865 2063 756d   Compute the cum
+00021e30: 756c 6174 6976 6520 7469 6d65 2061 2062  ulative time a b
+00021e40: 6f64 792d 7061 7274 2068 6173 2073 7065  ody-part has spe
+00021e50: 6e74 2069 6e73 6964 6520 6120 6772 6964  nt inside a grid
+00021e60: 206f 6620 6765 6f6d 6574 7269 6573 2075   of geometries u
+00021e70: 7369 6e67 206d 756c 7469 7072 6f63 6573  sing multiproces
+00021e80: 7369 6e67 2e0a 0a20 2020 2020 2020 203a  sing...        :
+00021e90: 7061 7261 6d20 6e70 2e6e 6461 7272 6179  param np.ndarray
+00021ea0: 2064 6174 613a 2049 6e70 7574 2064 6174   data: Input dat
+00021eb0: 6120 6172 7261 7920 7768 6572 6520 726f  a array where ro
+00021ec0: 7773 2072 6570 7265 7365 6e74 2066 7261  ws represent fra
+00021ed0: 6d65 7320 616e 6420 636f 6c75 6d6e 7320  mes and columns 
+00021ee0: 7265 7072 6573 656e 7420 626f 6479 2d70  represent body-p
+00021ef0: 6172 7420 7820 616e 6420 7920 636f 6f72  art x and y coor
+00021f00: 6469 6e61 7465 732e 0a20 2020 2020 2020  dinates..       
+00021f10: 203a 7061 7261 6d20 4469 6374 5b54 7570   :param Dict[Tup
+00021f20: 6c65 5b69 6e74 2c20 696e 745d 2c20 506f  le[int, int], Po
+00021f30: 6c79 676f 6e5d 2067 656f 6d65 7472 6965  lygon] geometrie
+00021f40: 733a 2044 6963 7469 6f6e 6172 7920 6f66  s: Dictionary of
+00021f50: 2070 6f6c 7967 6f6e 7320 7265 7072 6573   polygons repres
+00021f60: 656e 7469 6e67 2073 7061 7469 616c 2072  enting spatial r
+00021f70: 6567 696f 6e73 2e20 4372 6561 7465 6420  egions. Created 
+00021f80: 6279 2060 6047 656f 6d65 7472 794d 6978  by ``GeometryMix
+00021f90: 696e 2e62 7563 6b65 745f 696d 675f 696e  in.bucket_img_in
+00021fa0: 746f 5f73 7175 6172 6573 6060 2e0a 2020  to_squares``..  
+00021fb0: 2020 2020 2020 3a70 6172 616d 204f 7074        :param Opt
+00021fc0: 696f 6e61 6c5b 696e 745d 2066 7073 3a20  ional[int] fps: 
+00021fd0: 4672 616d 6573 2070 6572 2073 6563 6f6e  Frames per secon
+00021fe0: 6420 2866 7073 2920 666f 7220 7469 6d65  d (fps) for time
+00021ff0: 206e 6f72 6d61 6c69 7a61 7469 6f6e 2e20   normalization. 
+00022000: 4966 204e 6f6e 652c 2063 756d 756c 6174  If None, cumulat
+00022010: 6976 6520 7375 6d20 6f66 2066 7261 6d65  ive sum of frame
+00022020: 2063 6f75 6e74 2069 7320 7265 7475 726e   count is return
+00022030: 6564 2e0a 0a20 2020 2020 2020 203a 6578  ed...        :ex
+00022040: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
+00022050: 3e3e 2069 6d67 5f67 656f 6d65 7472 6965  >> img_geometrie
+00022060: 7320 3d20 4765 6f6d 6574 7279 4d69 7869  s = GeometryMixi
+00022070: 6e2e 6275 636b 6574 5f69 6d67 5f69 6e74  n.bucket_img_int
+00022080: 6f5f 6772 6964 5f73 7175 6172 6528 696d  o_grid_square(im
+00022090: 675f 7369 7a65 3d28 3634 302c 2036 3430  g_size=(640, 640
+000220a0: 292c 2062 7563 6b65 745f 6772 6964 5f73  ), bucket_grid_s
+000220b0: 697a 653d 2831 302c 2031 3029 2c20 7078  ize=(10, 10), px
+000220c0: 5f70 6572 5f6d 6d3d 3129 0a20 2020 2020  _per_mm=1).     
+000220d0: 2020 203e 3e3e 2062 705f 6172 7220 3d20     >>> bp_arr = 
+000220e0: 6e70 2e72 616e 646f 6d2e 7261 6e64 696e  np.random.randin
+000220f0: 7428 302c 2036 3430 2c20 2835 3030 302c  t(0, 640, (5000,
+00022100: 2032 2929 0a20 2020 2020 2020 203e 3e3e   2)).        >>>
+00022110: 2067 656f 5f64 6174 6120 3d20 4765 6f6d   geo_data = Geom
+00022120: 6574 7279 4d69 7869 6e28 292e 6375 6d73  etryMixin().cums
+00022130: 756d 5f63 6f6f 7264 5f67 656f 6d65 7472  um_coord_geometr
+00022140: 6965 7328 6461 7461 3d62 705f 6172 722c  ies(data=bp_arr,
+00022150: 2067 656f 6d65 7472 6965 733d 696d 675f   geometries=img_
+00022160: 6765 6f6d 6574 7269 6573 5b30 5d2c 2076  geometries[0], v
+00022170: 6572 626f 7365 3d46 616c 7365 2c20 6670  erbose=False, fp
+00022180: 733d 3129 0a20 2020 2020 2020 2022 2222  s=1).        """
+00022190: 0a0a 2020 2020 2020 2020 7469 6d65 7220  ..        timer 
+000221a0: 3d20 5369 6d62 6154 696d 6572 2873 7461  = SimbaTimer(sta
+000221b0: 7274 3d54 7275 6529 0a20 2020 2020 2020  rt=True).       
+000221c0: 2063 6865 636b 5f69 6e73 7461 6e63 6528   check_instance(
+000221d0: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
+000221e0: 7263 653d 6622 7b73 656c 662e 5f5f 636c  rce=f"{self.__cl
+000221f0: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 7d20  ass__.__name__} 
+00022200: 6461 7461 222c 0a20 2020 2020 2020 2020  data",.         
+00022210: 2020 2069 6e73 7461 6e63 653d 6461 7461     instance=data
+00022220: 2c0a 2020 2020 2020 2020 2020 2020 6163  ,.            ac
+00022230: 6365 7074 6564 5f74 7970 6573 3d6e 702e  cepted_types=np.
+00022240: 6e64 6172 7261 792c 0a20 2020 2020 2020  ndarray,.       
+00022250: 2029 0a20 2020 2020 2020 2069 6620 2864   ).        if (d
+00022260: 6174 612e 7368 6170 655b 315d 2021 3d20  ata.shape[1] != 
+00022270: 3229 206f 7220 2864 6174 612e 6e64 696d  2) or (data.ndim
+00022280: 2021 3d20 3229 3a0a 2020 2020 2020 2020   != 2):.        
+00022290: 2020 2020 7261 6973 6520 436f 756e 7445      raise CountE
+000222a0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+000222b0: 2020 2020 2020 6d73 673d 6622 4120 4e20        msg=f"A N 
+000222c0: 7820 3220 6172 7261 7920 6973 2072 6571  x 2 array is req
+000222d0: 7569 7265 6420 2867 6f74 207b 6461 7461  uired (got {data
+000222e0: 2e73 6861 7065 7d29 222c 0a20 2020 2020  .shape})",.     
+000222f0: 2020 2020 2020 2020 2020 2073 6f75 7263             sourc
+00022300: 653d 7365 6c66 2e5f 5f63 6c61 7373 5f5f  e=self.__class__
+00022310: 2e5f 5f6e 616d 655f 5f2c 0a20 2020 2020  .__name__,.     
+00022320: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00022330: 2069 6620 6670 7320 6973 206e 6f74 204e   if fps is not N
+00022340: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00022350: 2063 6865 636b 5f69 6e74 286e 616d 653d   check_int(name=
+00022360: 2266 7073 222c 2076 616c 7565 3d66 7073  "fps", value=fps
+00022370: 2c20 6d69 6e5f 7661 6c75 653d 3129 0a20  , min_value=1). 
+00022380: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00022390: 2020 2020 2020 2020 2066 7073 203d 2031           fps = 1
+000223a0: 0a20 2020 2020 2020 2063 6865 636b 5f69  .        check_i
+000223b0: 6e74 286e 616d 653d 2263 6f72 655f 636e  nt(name="core_cn
+000223c0: 7422 2c20 7661 6c75 653d 636f 7265 5f63  t", value=core_c
+000223d0: 6e74 2c20 6d69 6e5f 7661 6c75 653d 2d31  nt, min_value=-1
+000223e0: 290a 2020 2020 2020 2020 6966 2063 6f72  ).        if cor
+000223f0: 655f 636e 7420 3d3d 202d 313a 0a20 2020  e_cnt == -1:.   
+00022400: 2020 2020 2020 2020 2063 6f72 655f 636e           core_cn
+00022410: 7420 3d20 6669 6e64 5f63 6f72 655f 636e  t = find_core_cn
+00022420: 7428 295b 305d 0a20 2020 2020 2020 2077  t()[0].        w
+00022430: 2c20 6820 3d20 302c 2030 0a20 2020 2020  , h = 0, 0.     
+00022440: 2020 2066 6f72 206b 2069 6e20 6765 6f6d     for k in geom
+00022450: 6574 7269 6573 2e6b 6579 7328 293a 0a20  etries.keys():. 
+00022460: 2020 2020 2020 2020 2020 2077 2c20 6820             w, h 
+00022470: 3d20 6d61 7828 772c 206b 5b30 5d29 2c20  = max(w, k[0]), 
+00022480: 6d61 7828 682c 206b 5b31 5d29 0a20 2020  max(h, k[1]).   
+00022490: 2020 2020 2066 726d 5f69 6420 3d20 6e70       frm_id = np
+000224a0: 2e61 7261 6e67 6528 302c 2064 6174 612e  .arange(0, data.
+000224b0: 7368 6170 655b 305d 292e 7265 7368 6170  shape[0]).reshap
+000224c0: 6528 2d31 2c20 3129 0a20 2020 2020 2020  e(-1, 1).       
+000224d0: 2064 6174 6120 3d20 6e70 2e68 7374 6163   data = np.hstac
+000224e0: 6b28 2866 726d 5f69 642c 2064 6174 6129  k((frm_id, data)
+000224f0: 290a 2020 2020 2020 2020 696d 675f 6172  ).        img_ar
+00022500: 7220 3d20 6e70 2e7a 6572 6f73 2828 6461  r = np.zeros((da
+00022510: 7461 2e73 6861 7065 5b30 5d2c 2068 202b  ta.shape[0], h +
+00022520: 2031 2c20 7720 2b20 3129 290a 2020 2020   1, w + 1)).    
+00022530: 2020 2020 7769 7468 206d 756c 7469 7072      with multipr
+00022540: 6f63 6573 7369 6e67 2e50 6f6f 6c28 0a20  ocessing.Pool(. 
+00022550: 2020 2020 2020 2020 2020 2063 6f72 655f             core_
+00022560: 636e 742c 206d 6178 7461 736b 7370 6572  cnt, maxtasksper
+00022570: 6368 696c 643d 4465 6661 756c 7473 2e4c  child=Defaults.L
+00022580: 4152 4745 5f4d 4158 5f54 4153 4b5f 5045  ARGE_MAX_TASK_PE
+00022590: 525f 4348 494c 442e 7661 6c75 650a 2020  R_CHILD.value.  
+000225a0: 2020 2020 2020 2920 6173 2070 6f6f 6c3a        ) as pool:
+000225b0: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
+000225c0: 7374 616e 7473 203d 2066 756e 6374 6f6f  stants = functoo
+000225d0: 6c73 2e70 6172 7469 616c 280a 2020 2020  ls.partial(.    
+000225e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000225f0: 2e5f 6375 6d73 756d 5f63 6f6f 7264 5f67  ._cumsum_coord_g
+00022600: 656f 6d65 7472 6965 735f 6865 6c70 6572  eometries_helper
+00022610: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00022620: 2020 6765 6f6d 6574 7269 6573 3d67 656f    geometries=geo
+00022630: 6d65 7472 6965 732c 0a20 2020 2020 2020  metries,.       
+00022640: 2020 2020 2020 2020 2076 6572 626f 7365           verbose
+00022650: 3d76 6572 626f 7365 2c0a 2020 2020 2020  =verbose,.      
+00022660: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00022670: 2020 2020 666f 7220 636e 742c 2072 6573      for cnt, res
+00022680: 756c 7420 696e 2065 6e75 6d65 7261 7465  ult in enumerate
+00022690: 2870 6f6f 6c2e 696d 6170 2863 6f6e 7374  (pool.imap(const
+000226a0: 616e 7473 2c20 6461 7461 2c20 6368 756e  ants, data, chun
+000226b0: 6b73 697a 653d 3129 293a 0a20 2020 2020  ksize=1)):.     
+000226c0: 2020 2020 2020 2020 2020 2069 6620 7265             if re
+000226d0: 7375 6c74 5b31 5d20 213d 202d 313a 0a20  sult[1] != -1:. 
+000226e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000226f0: 2020 2069 6d67 5f61 7272 5b72 6573 756c     img_arr[resul
+00022700: 745b 305d 2c20 7265 7375 6c74 5b32 5d20  t[0], result[2] 
+00022710: 2d20 312c 2072 6573 756c 745b 315d 202d  - 1, result[1] -
+00022720: 2031 5d20 3d20 310a 2020 2020 2020 2020   1] = 1.        
+00022730: 706f 6f6c 2e6a 6f69 6e28 290a 2020 2020  pool.join().    
+00022740: 2020 2020 706f 6f6c 2e74 6572 6d69 6e61      pool.termina
+00022750: 7465 2829 0a20 2020 2020 2020 2074 696d  te().        tim
+00022760: 6572 2e73 746f 705f 7469 6d65 7228 290a  er.stop_timer().
+00022770: 2020 2020 2020 2020 7374 646f 7574 5f73          stdout_s
+00022780: 7563 6365 7373 280a 2020 2020 2020 2020  uccess(.        
+00022790: 2020 2020 6d73 673d 2243 756d 756c 6174      msg="Cumulat
+000227a0: 6976 6520 636f 6f72 6469 6e61 7465 7320  ive coordinates 
+000227b0: 696e 2067 656f 6d65 7472 6965 7320 636f  in geometries co
+000227c0: 6d70 6c65 7465 222c 0a20 2020 2020 2020  mplete",.       
+000227d0: 2020 2020 2065 6c61 7073 6564 5f74 696d       elapsed_tim
+000227e0: 653d 7469 6d65 722e 656c 6170 7365 645f  e=timer.elapsed_
+000227f0: 7469 6d65 5f73 7472 2c0a 2020 2020 2020  time_str,.      
+00022800: 2020 290a 2020 2020 2020 2020 6966 2066    ).        if f
+00022810: 7073 2069 7320 4e6f 6e65 3a0a 2020 2020  ps is None:.    
+00022820: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+00022830: 702e 6375 6d73 756d 2869 6d67 5f61 7272  p.cumsum(img_arr
+00022840: 2c20 6178 6973 3d30 290a 2020 2020 2020  , axis=0).      
+00022850: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00022860: 2020 2020 7265 7475 726e 206e 702e 6375      return np.cu
+00022870: 6d73 756d 2869 6d67 5f61 7272 2c20 6178  msum(img_arr, ax
+00022880: 6973 3d30 2920 2f20 6670 730a 0a20 2020  is=0) / fps..   
+00022890: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
+000228a0: 2020 2064 6566 205f 6375 6d73 756d 5f62     def _cumsum_b
+000228b0: 6f6f 6c5f 6865 6c70 6572 280a 2020 2020  ool_helper(.    
+000228c0: 2020 2020 6461 7461 3a20 6e70 2e6e 6461      data: np.nda
+000228d0: 7272 6179 2c20 6765 6f6d 6574 7269 6573  rray, geometries
+000228e0: 3a20 4469 6374 5b54 7570 6c65 5b69 6e74  : Dict[Tuple[int
+000228f0: 2c20 696e 745d 2c20 506f 6c79 676f 6e5d  , int], Polygon]
+00022900: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+00022910: 6461 7461 5f70 6f69 6e74 203d 2050 6f69  data_point = Poi
+00022920: 6e74 2864 6174 615b 313a 335d 290a 2020  nt(data[1:3]).  
+00022930: 2020 2020 2020 7072 696e 7428 0a20 2020        print(.   
+00022940: 2020 2020 2020 2020 2066 2250 726f 6365           f"Proce
+00022950: 7373 696e 6720 616e 696d 616c 2067 7269  ssing animal gri
+00022960: 6420 7371 7561 7265 206c 6f63 6174 696f  d square locatio
+00022970: 6e20 666f 7220 626f 6f6c 6561 6e20 696e  n for boolean in
+00022980: 2066 7261 6d65 207b 696e 7428 6461 7461   frame {int(data
+00022990: 5b30 5d29 7d2e 2e2e 220a 2020 2020 2020  [0])}...".      
+000229a0: 2020 290a 2020 2020 2020 2020 666f 7220    ).        for 
+000229b0: 6b2c 2072 2069 6e20 6765 6f6d 6574 7269  k, r in geometri
+000229c0: 6573 2e69 7465 6d73 2829 3a0a 2020 2020  es.items():.    
+000229d0: 2020 2020 2020 2020 6966 2072 2e63 6f6e          if r.con
+000229e0: 7461 696e 7328 6461 7461 5f70 6f69 6e74  tains(data_point
+000229f0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00022a00: 2020 2072 6574 7572 6e20 2869 6e74 2864     return (int(d
+00022a10: 6174 615b 305d 292c 206b 5b30 5d2c 206b  ata[0]), k[0], k
+00022a20: 5b31 5d29 0a20 2020 2020 2020 2072 6574  [1]).        ret
+00022a30: 7572 6e20 2869 6e74 2864 6174 615b 305d  urn (int(data[0]
+00022a40: 292c 202d 312c 202d 3129 0a0a 2020 2020  ), -1, -1)..    
+00022a50: 6465 6620 6375 6d73 756d 5f62 6f6f 6c5f  def cumsum_bool_
+00022a60: 6765 6f6d 6574 7269 6573 280a 2020 2020  geometries(.    
+00022a70: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+00022a80: 2020 6461 7461 3a20 6e70 2e6e 6461 7272    data: np.ndarr
+00022a90: 6179 2c0a 2020 2020 2020 2020 6765 6f6d  ay,.        geom
+00022aa0: 6574 7269 6573 3a20 4469 6374 5b54 7570  etries: Dict[Tup
+00022ab0: 6c65 5b69 6e74 2c20 696e 745d 2c20 506f  le[int, int], Po
+00022ac0: 6c79 676f 6e5d 2c0a 2020 2020 2020 2020  lygon],.        
+00022ad0: 626f 6f6c 5f64 6174 613a 206e 702e 6e64  bool_data: np.nd
+00022ae0: 6172 7261 792c 0a20 2020 2020 2020 2066  array,.        f
+00022af0: 7073 3a20 4f70 7469 6f6e 616c 5b66 6c6f  ps: Optional[flo
+00022b00: 6174 5d20 3d20 4e6f 6e65 2c0a 2020 2020  at] = None,.    
+00022b10: 2020 2020 636f 7265 5f63 6e74 3a20 4f70      core_cnt: Op
+00022b20: 7469 6f6e 616c 5b69 6e74 5d20 3d20 2d31  tional[int] = -1
+00022b30: 2c0a 2020 2020 2920 2d3e 206e 702e 6e64  ,.    ) -> np.nd
+00022b40: 6172 7261 793a 0a20 2020 2020 2020 2022  array:.        "
+00022b50: 2222 0a20 2020 2020 2020 2043 6f6d 7075  "".        Compu
+00022b60: 7465 2074 6865 2063 756d 756c 6174 6976  te the cumulativ
+00022b70: 6520 7375 6d73 206f 6620 626f 6f6c 6561  e sums of boolea
+00022b80: 6e20 6576 656e 7473 2077 6974 6869 6e20  n events within 
+00022b90: 706f 6c79 676f 6e20 6765 6f6d 6574 7269  polygon geometri
+00022ba0: 6573 206f 7665 7220 7469 6d65 2075 7369  es over time usi
+00022bb0: 6e67 206d 756c 7469 7072 6f63 6573 7369  ng multiprocessi
+00022bc0: 6e67 2e0a 0a20 2020 2020 2020 2045 2e67  ng...        E.g
+00022bd0: 2e2c 2063 6f6d 7075 7465 2074 6865 2063  ., compute the c
+00022be0: 756d 756c 6174 6976 6520 7469 6d65 206f  umulative time o
+00022bf0: 6620 636c 6173 7369 6669 6564 2065 7665  f classified eve
+00022c00: 6e74 7320 7769 7468 696e 2073 7061 7469  nts within spati
+00022c10: 616c 206c 6f63 6174 696f 6e73 2061 7420  al locations at 
+00022c20: 616c 6c20 7469 6d65 2d70 6f69 6e74 7320  all time-points 
+00022c30: 6f66 2074 6865 2076 6964 656f 2e0a 0a20  of the video... 
+00022c40: 2020 2020 2020 203a 7061 7261 6d20 6e70         :param np
+00022c50: 2e6e 6461 7272 6179 2064 6174 613a 2041  .ndarray data: A
+00022c60: 7272 6179 2063 6f6e 7461 696e 696e 6720  rray containing 
+00022c70: 7370 6174 6961 6c20 6461 7461 2077 6974  spatial data wit
+00022c80: 6820 7368 6170 6520 286e 2c20 3229 2e20  h shape (n, 2). 
+00022c90: 452e 672e 2c20 3244 2d61 7272 6179 2077  E.g., 2D-array w
+00022ca0: 6974 6820 626f 6479 2d70 6172 7420 636f  ith body-part co
+00022cb0: 6f72 6469 6e61 7465 732e 0a20 2020 2020  ordinates..     
+00022cc0: 2020 203a 7061 7261 6d20 4469 6374 5b54     :param Dict[T
+00022cd0: 7570 6c65 5b69 6e74 2c20 696e 745d 2c20  uple[int, int], 
+00022ce0: 506f 6c79 676f 6e5d 2067 656f 6d65 7472  Polygon] geometr
+00022cf0: 6965 733a 2044 6963 7469 6f6e 6172 7920  ies: Dictionary 
+00022d00: 6f66 2070 6f6c 7967 6f6e 7320 7265 7072  of polygons repr
+00022d10: 6573 656e 7469 6e67 2073 7061 7469 616c  esenting spatial
+00022d20: 2072 6567 696f 6e73 2e20 4372 6561 7465   regions. Create
+00022d30: 6420 6279 2060 6047 656f 6d65 7472 794d  d by ``GeometryM
+00022d40: 6978 696e 2e62 7563 6b65 745f 696d 675f  ixin.bucket_img_
+00022d50: 696e 746f 5f73 7175 6172 6573 6060 2e0a  into_squares``..
+00022d60: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
+00022d70: 702e 6e64 6172 7261 7920 626f 6f6c 5f64  p.ndarray bool_d
+00022d80: 6174 613a 2042 6f6f 6c65 616e 2061 7272  ata: Boolean arr
+00022d90: 6179 2077 6974 6820 7368 6170 6520 2864  ay with shape (d
+00022da0: 6174 612e 7368 6170 655b 305d 2c29 206f  ata.shape[0],) o
+00022db0: 7220 2864 6174 612e 7368 6170 655b 305d  r (data.shape[0]
+00022dc0: 2c20 3129 2069 6e64 6963 6174 696e 6720  , 1) indicating 
+00022dd0: 7468 6520 7072 6573 656e 6365 206f 7220  the presence or 
+00022de0: 6162 7365 6e63 6520 696e 2065 6163 6820  absence in each 
+00022df0: 6672 616d 652e 0a20 2020 2020 2020 203a  frame..        :
+00022e00: 7061 7261 6d20 4f70 7469 6f6e 616c 5b66  param Optional[f
+00022e10: 6c6f 6174 5d20 6670 733a 2046 7261 6d65  loat] fps: Frame
+00022e20: 7320 7065 7220 7365 636f 6e64 2e20 4966  s per second. If
+00022e30: 2070 726f 7669 6465 642c 2074 6865 2072   provided, the r
+00022e40: 6573 756c 7420 6973 206e 6f72 6d61 6c69  esult is normali
+00022e50: 7a65 6420 6279 2074 6865 2066 7261 6d65  zed by the frame
+00022e60: 2072 6174 652e 0a20 2020 2020 2020 203a   rate..        :
+00022e70: 7061 7261 6d20 4f70 7469 6f6e 616c 5b66  param Optional[f
+00022e80: 6c6f 6174 5d20 636f 7265 5f63 6e74 3a20  loat] core_cnt: 
+00022e90: 4e75 6d62 6572 206f 6620 4350 5520 636f  Number of CPU co
+00022ea0: 7265 7320 746f 2075 7365 2066 6f72 2070  res to use for p
+00022eb0: 6172 616c 6c65 6c20 7072 6f63 6573 7369  arallel processi
+00022ec0: 6e67 2e20 4465 6661 756c 7420 6973 202d  ng. Default is -
+00022ed0: 312c 2077 6869 6368 206d 6561 6e73 2075  1, which means u
+00022ee0: 7369 6e67 2061 6c6c 2061 7661 696c 6162  sing all availab
+00022ef0: 6c65 2063 6f72 6573 2e0a 2020 2020 2020  le cores..      
+00022f00: 2020 3a72 6574 7572 6e73 206e 702e 6e64    :returns np.nd
+00022f10: 6172 7261 793a 2041 7272 6179 206f 6620  array: Array of 
+00022f20: 7369 7a65 2028 6672 616d 6573 2078 2068  size (frames x h
+00022f30: 6f72 697a 6f6e 7461 6c20 6269 6e73 2078  orizontal bins x
+00022f40: 2076 6572 6963 616c 2062 696e 7329 2077   verical bins) w
+00022f50: 6974 6820 7469 6d65 7320 696e 2073 6563  ith times in sec
+00022f60: 6f6e 6473 2028 6966 2066 7073 2070 6173  onds (if fps pas
+00022f70: 7365 6429 206f 7220 6672 616d 6573 2028  sed) or frames (
+00022f80: 6966 2066 7073 206e 6f74 2070 6173 7365  if fps not passe
+00022f90: 6429 0a0a 2020 2020 2020 2020 3a65 7861  d)..        :exa
+00022fa0: 6d70 6c65 3a0a 2020 2020 2020 2020 3e3e  mple:.        >>
+00022fb0: 3e20 6765 6f6d 6574 7269 6573 203d 2047  > geometries = G
+00022fc0: 656f 6d65 7472 794d 6978 696e 2e62 7563  eometryMixin.buc
+00022fd0: 6b65 745f 696d 675f 696e 746f 5f67 7269  ket_img_into_gri
+00022fe0: 645f 7371 7561 7265 2862 7563 6b65 745f  d_square(bucket_
+00022ff0: 7369 7a65 5f6d 6d3d 3530 2c20 696d 675f  size_mm=50, img_
+00023000: 7369 7a65 3d28 3830 302c 2038 3030 2920  size=(800, 800) 
+00023010: 2c20 7078 5f70 6572 5f6d 6d3d 352e 3029  , px_per_mm=5.0)
+00023020: 5b30 5d0a 2020 2020 2020 2020 3e3e 3e20  [0].        >>> 
+00023030: 636f 6f72 645f 6461 7461 203d 206e 702e  coord_data = np.
+00023040: 7261 6e64 6f6d 2e72 616e 6469 6e74 2830  random.randint(0
+00023050: 2c20 3830 302c 2028 3530 302c 2032 2929  , 800, (500, 2))
+00023060: 0a20 2020 2020 2020 203e 3e3e 2062 6f6f  .        >>> boo
+00023070: 6c5f 6461 7461 203d 206e 702e 7261 6e64  l_data = np.rand
+00023080: 6f6d 2e72 616e 6469 6e74 2830 2c20 322c  om.randint(0, 2,
+00023090: 2028 3530 302c 2929 0a20 2020 2020 2020   (500,)).       
+000230a0: 203e 3e3e 2078 203d 2047 656f 6d65 7472   >>> x = Geometr
+000230b0: 794d 6978 696e 2829 2e63 756d 7375 6d5f  yMixin().cumsum_
+000230c0: 626f 6f6c 5f67 656f 6d65 7472 6965 7328  bool_geometries(
+000230d0: 6461 7461 3d63 6f6f 7264 5f64 6174 612c  data=coord_data,
+000230e0: 2067 656f 6d65 7472 6965 733d 6765 6f6d   geometries=geom
+000230f0: 6574 7269 6573 2c20 626f 6f6c 5f64 6174  etries, bool_dat
+00023100: 613d 626f 6f6c 5f64 6174 612c 2066 7073  a=bool_data, fps
+00023110: 3d31 3529 0a20 2020 2020 2020 203e 3e3e  =15).        >>>
+00023120: 2078 2e73 6861 7065 0a20 2020 2020 2020   x.shape.       
+00023130: 203e 3e3e 2028 3530 302c 2034 2c20 3429   >>> (500, 4, 4)
+00023140: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+00023150: 2020 2020 2020 6368 6563 6b5f 7661 6c69        check_vali
+00023160: 645f 6172 7261 7928 0a20 2020 2020 2020  d_array(.       
+00023170: 2020 2020 2064 6174 613d 6461 7461 2c0a       data=data,.
+00023180: 2020 2020 2020 2020 2020 2020 6163 6365              acce
+00023190: 7074 6564 5f73 697a 6573 3d5b 325d 2c0a  pted_sizes=[2],.
+000231a0: 2020 2020 2020 2020 2020 2020 736f 7572              sour
+000231b0: 6365 3d66 227b 4765 6f6d 6574 7279 4d69  ce=f"{GeometryMi
+000231c0: 7869 6e2e 6375 6d73 756d 5f62 6f6f 6c5f  xin.cumsum_bool_
+000231d0: 6765 6f6d 6574 7269 6573 2e5f 5f6e 616d  geometries.__nam
+000231e0: 655f 5f7d 2064 6174 6122 2c0a 2020 2020  e__} data",.    
+000231f0: 2020 2020 290a 2020 2020 2020 2020 6368      ).        ch
+00023200: 6563 6b5f 696e 7374 616e 6365 280a 2020  eck_instance(.  
+00023210: 2020 2020 2020 2020 2020 736f 7572 6365            source
+00023220: 3d66 227b 4765 6f6d 6574 7279 4d69 7869  =f"{GeometryMixi
+00023230: 6e2e 6375 6d73 756d 5f62 6f6f 6c5f 6765  n.cumsum_bool_ge
+00023240: 6f6d 6574 7269 6573 2e5f 5f6e 616d 655f  ometries.__name_
+00023250: 5f7d 2067 656f 6d65 7472 6965 7322 2c0a  _} geometries",.
+00023260: 2020 2020 2020 2020 2020 2020 696e 7374              inst
+00023270: 616e 6365 3d67 656f 6d65 7472 6965 732c  ance=geometries,
+00023280: 0a20 2020 2020 2020 2020 2020 2061 6363  .            acc
+00023290: 6570 7465 645f 7479 7065 733d 6469 6374  epted_types=dict
+000232a0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+000232b0: 2020 2020 6368 6563 6b5f 7661 6c69 645f      check_valid_
+000232c0: 6172 7261 7928 0a20 2020 2020 2020 2020  array(.         
+000232d0: 2020 2064 6174 613d 626f 6f6c 5f64 6174     data=bool_dat
+000232e0: 612c 0a20 2020 2020 2020 2020 2020 2061  a,.            a
+000232f0: 6363 6570 7465 645f 7368 6170 6573 3d5b  ccepted_shapes=[
+00023300: 2864 6174 612e 7368 6170 655b 305d 2c20  (data.shape[0], 
+00023310: 3129 2c20 2864 6174 612e 7368 6170 655b  1), (data.shape[
+00023320: 305d 2c29 5d2c 0a20 2020 2020 2020 2020  0],)],.         
+00023330: 2020 2073 6f75 7263 653d 6622 7b47 656f     source=f"{Geo
+00023340: 6d65 7472 794d 6978 696e 2e63 756d 7375  metryMixin.cumsu
+00023350: 6d5f 626f 6f6c 5f67 656f 6d65 7472 6965  m_bool_geometrie
+00023360: 732e 5f5f 6e61 6d65 5f5f 7d20 626f 6f6c  s.__name__} bool
+00023370: 5f64 6174 6122 2c0a 2020 2020 2020 2020  _data",.        
+00023380: 290a 2020 2020 2020 2020 6966 2066 7073  ).        if fps
+00023390: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+000233a0: 2020 2020 2020 2020 2020 6368 6563 6b5f            check_
+000233b0: 666c 6f61 7428 0a20 2020 2020 2020 2020  float(.         
+000233c0: 2020 2020 2020 206e 616d 653d 6622 7b47         name=f"{G
+000233d0: 656f 6d65 7472 794d 6978 696e 2e63 756d  eometryMixin.cum
+000233e0: 7375 6d5f 626f 6f6c 5f67 656f 6d65 7472  sum_bool_geometr
+000233f0: 6965 732e 5f5f 6e61 6d65 5f5f 7d20 6670  ies.__name__} fp
+00023400: 7322 2c0a 2020 2020 2020 2020 2020 2020  s",.            
+00023410: 2020 2020 7661 6c75 653d 6670 732c 0a20      value=fps,. 
+00023420: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00023430: 696e 5f76 616c 7565 3d31 2e30 2c0a 2020  in_value=1.0,.  
+00023440: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00023450: 2020 2020 6368 6563 6b5f 696e 7428 0a20      check_int(. 
+00023460: 2020 2020 2020 2020 2020 206e 616d 653d             name=
+00023470: 6622 7b47 656f 6d65 7472 794d 6978 696e  f"{GeometryMixin
+00023480: 2e63 756d 7375 6d5f 626f 6f6c 5f67 656f  .cumsum_bool_geo
+00023490: 6d65 7472 6965 732e 5f5f 6e61 6d65 5f5f  metries.__name__
+000234a0: 7d20 636f 7265 5f63 6e74 222c 0a20 2020  } core_cnt",.   
+000234b0: 2020 2020 2020 2020 2076 616c 7565 3d63           value=c
+000234c0: 6f72 655f 636e 742c 0a20 2020 2020 2020  ore_cnt,.       
+000234d0: 2020 2020 206d 696e 5f76 616c 7565 3d2d       min_value=-
+000234e0: 312c 0a20 2020 2020 2020 2029 0a20 2020  1,.        ).   
+000234f0: 2020 2020 2069 6620 6e6f 7420 6e70 2e61       if not np.a
+00023500: 7272 6179 5f65 7175 616c 280a 2020 2020  rray_equal(.    
+00023510: 2020 2020 2020 2020 6e70 2e73 6f72 7428          np.sort(
+00023520: 6e70 2e75 6e69 7175 6528 626f 6f6c 5f64  np.unique(bool_d
+00023530: 6174 6129 292e 6173 7479 7065 2869 6e74  ata)).astype(int
+00023540: 292c 206e 702e 6172 7261 7928 5b30 2c20  ), np.array([0, 
+00023550: 315d 290a 2020 2020 2020 2020 293a 0a20  1]).        ):. 
+00023560: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00023570: 2049 6e76 616c 6964 496e 7075 7445 7272   InvalidInputErr
+00023580: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00023590: 2020 2020 6d73 673d 6622 496e 7661 6c69      msg=f"Invali
+000235a0: 6420 626f 6f6c 6561 6e20 6461 7461 2e20  d boolean data. 
+000235b0: 4578 7065 6374 6564 207b 6e70 2e61 7272  Expected {np.arr
+000235c0: 6179 285b 302c 2031 5d29 7d20 6275 7420  ay([0, 1])} but 
+000235d0: 666f 756e 6420 7b6e 702e 736f 7274 286e  found {np.sort(n
+000235e0: 702e 756e 6971 7565 2862 6f6f 6c5f 6461  p.unique(bool_da
+000235f0: 7461 2929 2e61 7374 7970 6528 696e 7429  ta)).astype(int)
+00023600: 7d22 2c0a 2020 2020 2020 2020 2020 2020  }",.            
+00023610: 2020 2020 736f 7572 6365 3d47 656f 6d65      source=Geome
+00023620: 7472 794d 6978 696e 2e63 756d 7375 6d5f  tryMixin.cumsum_
+00023630: 626f 6f6c 5f67 656f 6d65 7472 6965 732e  bool_geometries.
+00023640: 5f5f 6e61 6d65 5f5f 2c0a 2020 2020 2020  __name__,.      
+00023650: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00023660: 6966 2063 6f72 655f 636e 7420 3d3d 202d  if core_cnt == -
+00023670: 313a 0a20 2020 2020 2020 2020 2020 2063  1:.            c
+00023680: 6f72 655f 636e 7420 3d20 6669 6e64 5f63  ore_cnt = find_c
+00023690: 6f72 655f 636e 7428 295b 305d 0a20 2020  ore_cnt()[0].   
+000236a0: 2020 2020 2077 2c20 6820 3d20 302c 2030       w, h = 0, 0
+000236b0: 0a20 2020 2020 2020 2066 6f72 206b 2069  .        for k i
+000236c0: 6e20 6765 6f6d 6574 7269 6573 2e6b 6579  n geometries.key
+000236d0: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
+000236e0: 2077 2c20 6820 3d20 6d61 7828 772c 206b   w, h = max(w, k
+000236f0: 5b30 5d29 2c20 6d61 7828 682c 206b 5b31  [0]), max(h, k[1
+00023700: 5d29 0a20 2020 2020 2020 2066 726d 5f69  ]).        frm_i
+00023710: 6420 3d20 6e70 2e61 7261 6e67 6528 302c  d = np.arange(0,
+00023720: 2064 6174 612e 7368 6170 655b 305d 292e   data.shape[0]).
+00023730: 7265 7368 6170 6528 2d31 2c20 3129 0a20  reshape(-1, 1). 
+00023740: 2020 2020 2020 2069 6620 626f 6f6c 5f64         if bool_d
+00023750: 6174 612e 6e64 696d 203d 3d20 313a 0a20  ata.ndim == 1:. 
+00023760: 2020 2020 2020 2020 2020 2062 6f6f 6c5f             bool_
+00023770: 6461 7461 203d 2062 6f6f 6c5f 6461 7461  data = bool_data
+00023780: 2e72 6573 6861 7065 282d 312c 2031 290a  .reshape(-1, 1).
+00023790: 2020 2020 2020 2020 6461 7461 203d 206e          data = n
+000237a0: 702e 6873 7461 636b 2828 6461 7461 2c20  p.hstack((data, 
+000237b0: 626f 6f6c 5f64 6174 6129 290a 2020 2020  bool_data)).    
+000237c0: 2020 2020 6461 7461 203d 206e 702e 6873      data = np.hs
+000237d0: 7461 636b 2828 6672 6d5f 6964 2c20 6461  tack((frm_id, da
+000237e0: 7461 2929 0a20 2020 2020 2020 2069 6d67  ta)).        img
+000237f0: 5f61 7272 203d 206e 702e 7a65 726f 7328  _arr = np.zeros(
+00023800: 2864 6174 612e 7368 6170 655b 305d 2c20  (data.shape[0], 
+00023810: 6820 2b20 312c 2077 202b 2031 2929 0a20  h + 1, w + 1)). 
+00023820: 2020 2020 2020 2064 6174 6120 3d20 6461         data = da
+00023830: 7461 5b6e 702e 6172 6777 6865 7265 2828  ta[np.argwhere((
+00023840: 6461 7461 5b3a 2c20 335d 203d 3d20 3129  data[:, 3] == 1)
+00023850: 295d 2e72 6573 6861 7065 282d 312c 2034  )].reshape(-1, 4
+00023860: 290a 2020 2020 2020 2020 7769 7468 206d  ).        with m
+00023870: 756c 7469 7072 6f63 6573 7369 6e67 2e50  ultiprocessing.P
+00023880: 6f6f 6c28 0a20 2020 2020 2020 2020 2020  ool(.           
+00023890: 2063 6f72 655f 636e 742c 206d 6178 7461   core_cnt, maxta
+000238a0: 736b 7370 6572 6368 696c 643d 4465 6661  sksperchild=Defa
+000238b0: 756c 7473 2e4c 4152 4745 5f4d 4158 5f54  ults.LARGE_MAX_T
+000238c0: 4153 4b5f 5045 525f 4348 494c 442e 7661  ASK_PER_CHILD.va
+000238d0: 6c75 650a 2020 2020 2020 2020 2920 6173  lue.        ) as
+000238e0: 2070 6f6f 6c3a 0a20 2020 2020 2020 2020   pool:.         
+000238f0: 2020 2063 6f6e 7374 616e 7473 203d 2066     constants = f
+00023900: 756e 6374 6f6f 6c73 2e70 6172 7469 616c  unctools.partial
+00023910: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00023920: 2020 7365 6c66 2e5f 6375 6d73 756d 5f62    self._cumsum_b
+00023930: 6f6f 6c5f 6865 6c70 6572 2c20 6765 6f6d  ool_helper, geom
+00023940: 6574 7269 6573 3d67 656f 6d65 7472 6965  etries=geometrie
+00023950: 730a 2020 2020 2020 2020 2020 2020 290a  s.            ).
+00023960: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00023970: 636e 742c 2072 6573 756c 7420 696e 2065  cnt, result in e
+00023980: 6e75 6d65 7261 7465 2870 6f6f 6c2e 696d  numerate(pool.im
+00023990: 6170 2863 6f6e 7374 616e 7473 2c20 6461  ap(constants, da
+000239a0: 7461 2c20 6368 756e 6b73 697a 653d 3129  ta, chunksize=1)
+000239b0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+000239c0: 2020 2069 6620 7265 7375 6c74 5b31 5d20     if result[1] 
+000239d0: 213d 202d 313a 0a20 2020 2020 2020 2020  != -1:.         
+000239e0: 2020 2020 2020 2020 2020 2069 6d67 5f61             img_a
+000239f0: 7272 5b72 6573 756c 745b 305d 2c20 7265  rr[result[0], re
+00023a00: 7375 6c74 5b32 5d20 2d20 312c 2072 6573  sult[2] - 1, res
+00023a10: 756c 745b 315d 202d 2031 5d20 3d20 310a  ult[1] - 1] = 1.
+00023a20: 2020 2020 2020 2020 706f 6f6c 2e6a 6f69          pool.joi
+00023a30: 6e28 290a 2020 2020 2020 2020 706f 6f6c  n().        pool
+00023a40: 2e74 6572 6d69 6e61 7465 2829 0a20 2020  .terminate().   
+00023a50: 2020 2020 2069 6620 6670 7320 6973 204e       if fps is N
+00023a60: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00023a70: 2072 6574 7572 6e20 6e70 2e63 756d 7375   return np.cumsu
+00023a80: 6d28 696d 675f 6172 722c 2061 7869 733d  m(img_arr, axis=
+00023a90: 3029 0a20 2020 2020 2020 2065 6c73 653a  0).        else:
+00023aa0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00023ab0: 7572 6e20 6e70 2e63 756d 7375 6d28 696d  urn np.cumsum(im
+00023ac0: 675f 6172 722c 2061 7869 733d 3029 202f  g_arr, axis=0) /
+00023ad0: 2066 7073 0a0a 2020 2020 4073 7461 7469   fps..    @stati
+00023ae0: 636d 6574 686f 640a 2020 2020 6465 6620  cmethod.    def 
+00023af0: 5f63 756d 7375 6d5f 616e 696d 616c 5f67  _cumsum_animal_g
+00023b00: 656f 6d65 7472 6965 735f 6772 6964 5f68  eometries_grid_h
+00023b10: 656c 7065 7228 0a20 2020 2020 2020 2064  elper(.        d
+00023b20: 6174 613a 206e 702e 6e64 6172 7261 792c  ata: np.ndarray,
+00023b30: 0a20 2020 2020 2020 2067 7269 643a 2044  .        grid: D
+00023b40: 6963 745b 5475 706c 655b 696e 742c 2069  ict[Tuple[int, i
+00023b50: 6e74 5d2c 2050 6f6c 7967 6f6e 5d2c 0a20  nt], Polygon],. 
+00023b60: 2020 2020 2020 2073 697a 653a 2054 7570         size: Tup
+00023b70: 6c65 5b69 6e74 5d2c 0a20 2020 2020 2020  le[int],.       
+00023b80: 2076 6572 626f 7365 3a20 626f 6f6c 2c0a   verbose: bool,.
+00023b90: 2020 2020 293a 0a0a 2020 2020 2020 2020      ):..        
+00023ba0: 7368 6170 652c 2072 6573 756c 7473 203d  shape, results =
+00023bb0: 2064 6174 615b 315d 2c20 6e70 2e7a 6572   data[1], np.zer
+00023bc0: 6f73 2828 7369 7a65 5b30 5d20 2b20 312c  os((size[0] + 1,
+00023bd0: 2073 697a 655b 315d 202b 2031 2929 0a20   size[1] + 1)). 
+00023be0: 2020 2020 2020 2069 6620 7665 7262 6f73         if verbos
+00023bf0: 653a 0a20 2020 2020 2020 2020 2020 2070  e:.            p
+00023c00: 7269 6e74 2866 2250 726f 6365 7373 696e  rint(f"Processin
+00023c10: 6720 616e 696d 616c 2067 7269 6420 7371  g animal grid sq
+00023c20: 7561 7265 206c 6f63 6174 696f 6e20 696e  uare location in
+00023c30: 2066 7261 6d65 207b 696e 7428 6461 7461   frame {int(data
+00023c40: 5b30 5d29 7d2e 2e2e 2229 0a20 2020 2020  [0])}...").     
+00023c50: 2020 2066 6f72 206b 2c20 7220 696e 2067     for k, r in g
+00023c60: 7269 642e 6974 656d 7328 293a 0a20 2020  rid.items():.   
+00023c70: 2020 2020 2020 2020 2069 6620 722e 696e           if r.in
+00023c80: 7465 7273 6563 7473 2873 6861 7065 293a  tersects(shape):
+00023c90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023ca0: 2072 6573 756c 7473 5b6b 5b30 5d2c 206b   results[k[0], k
+00023cb0: 5b31 5d5d 203d 2031 0a20 2020 2020 2020  [1]] = 1.       
+00023cc0: 2072 6574 7572 6e20 7265 7375 6c74 730a   return results.
+00023cd0: 0a20 2020 2064 6566 2063 756d 7375 6d5f  .    def cumsum_
+00023ce0: 616e 696d 616c 5f67 656f 6d65 7472 6965  animal_geometrie
+00023cf0: 735f 6772 6964 280a 2020 2020 2020 2020  s_grid(.        
+00023d00: 7365 6c66 2c0a 2020 2020 2020 2020 6461  self,.        da
+00023d10: 7461 3a20 4c69 7374 5b50 6f6c 7967 6f6e  ta: List[Polygon
+00023d20: 5d2c 0a20 2020 2020 2020 2067 7269 643a  ],.        grid:
+00023d30: 2044 6963 745b 5475 706c 655b 696e 742c   Dict[Tuple[int,
+00023d40: 2069 6e74 5d2c 2050 6f6c 7967 6f6e 5d2c   int], Polygon],
+00023d50: 0a20 2020 2020 2020 2066 7073 3a20 4f70  .        fps: Op
+00023d60: 7469 6f6e 616c 5b69 6e74 5d20 3d20 4e6f  tional[int] = No
+00023d70: 6e65 2c0a 2020 2020 2020 2020 636f 7265  ne,.        core
+00023d80: 5f63 6e74 3a20 4f70 7469 6f6e 616c 5b69  _cnt: Optional[i
+00023d90: 6e74 5d20 3d20 2d31 2c0a 2020 2020 2020  nt] = -1,.      
+00023da0: 2020 7665 7262 6f73 653a 204f 7074 696f    verbose: Optio
+00023db0: 6e61 6c5b 626f 6f6c 5d20 3d20 5472 7565  nal[bool] = True
+00023dc0: 2c0a 2020 2020 293a 0a0a 2020 2020 2020  ,.    ):..      
+00023dd0: 2020 7469 6d65 7220 3d20 5369 6d62 6154    timer = SimbaT
+00023de0: 696d 6572 2873 7461 7274 3d54 7275 6529  imer(start=True)
+00023df0: 0a20 2020 2020 2020 2063 6865 636b 5f76  .        check_v
+00023e00: 616c 6964 5f6c 7374 280a 2020 2020 2020  alid_lst(.      
+00023e10: 2020 2020 2020 6461 7461 3d64 6174 612c        data=data,
+00023e20: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
+00023e30: 7263 653d 4765 6f6d 6574 7279 4d69 7869  rce=GeometryMixi
+00023e40: 6e2e 6375 6d73 756d 5f61 6e69 6d61 6c5f  n.cumsum_animal_
+00023e50: 6765 6f6d 6574 7269 6573 5f67 7269 642e  geometries_grid.
+00023e60: 5f5f 6e61 6d65 5f5f 2c0a 2020 2020 2020  __name__,.      
+00023e70: 2020 2020 2020 7661 6c69 645f 6474 7970        valid_dtyp
+00023e80: 6573 3d28 506f 6c79 676f 6e2c 292c 0a20  es=(Polygon,),. 
+00023e90: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00023ea0: 2063 6865 636b 5f69 6e73 7461 6e63 6528   check_instance(
+00023eb0: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
+00023ec0: 7263 653d 4765 6f6d 6574 7279 4d69 7869  rce=GeometryMixi
+00023ed0: 6e2e 6375 6d73 756d 5f61 6e69 6d61 6c5f  n.cumsum_animal_
+00023ee0: 6765 6f6d 6574 7269 6573 5f67 7269 642e  geometries_grid.
+00023ef0: 5f5f 6e61 6d65 5f5f 2c0a 2020 2020 2020  __name__,.      
+00023f00: 2020 2020 2020 696e 7374 616e 6365 3d67        instance=g
+00023f10: 7269 642c 0a20 2020 2020 2020 2020 2020  rid,.           
+00023f20: 2061 6363 6570 7465 645f 7479 7065 733d   accepted_types=
+00023f30: 2864 6963 742c 292c 0a20 2020 2020 2020  (dict,),.       
+00023f40: 2029 0a20 2020 2020 2020 2069 6620 6670   ).        if fp
+00023f50: 7320 6973 206e 6f74 204e 6f6e 653a 0a20  s is not None:. 
+00023f60: 2020 2020 2020 2020 2020 2063 6865 636b             check
+00023f70: 5f69 6e74 286e 616d 653d 2266 7073 222c  _int(name="fps",
+00023f80: 2076 616c 7565 3d66 7073 2c20 6d69 6e5f   value=fps, min_
+00023f90: 7661 6c75 653d 3129 0a20 2020 2020 2020  value=1).       
+00023fa0: 2063 6865 636b 5f69 6e74 286e 616d 653d   check_int(name=
+00023fb0: 2263 6f72 655f 636e 7422 2c20 7661 6c75  "core_cnt", valu
+00023fc0: 653d 636f 7265 5f63 6e74 2c20 6d69 6e5f  e=core_cnt, min_
+00023fd0: 7661 6c75 653d 2d31 290a 2020 2020 2020  value=-1).      
+00023fe0: 2020 6966 2063 6f72 655f 636e 7420 3d3d    if core_cnt ==
+00023ff0: 202d 313a 0a20 2020 2020 2020 2020 2020   -1:.           
+00024000: 2063 6f72 655f 636e 7420 3d20 6669 6e64   core_cnt = find
+00024010: 5f63 6f72 655f 636e 7428 295b 305d 0a20  _core_cnt()[0]. 
+00024020: 2020 2020 2020 2077 2c20 6820 3d20 302c         w, h = 0,
+00024030: 2030 0a20 2020 2020 2020 2066 6f72 206b   0.        for k
+00024040: 2069 6e20 6772 6964 2e6b 6579 7328 293a   in grid.keys():
+00024050: 0a20 2020 2020 2020 2020 2020 2077 2c20  .            w, 
+00024060: 6820 3d20 6d61 7828 772c 206b 5b30 5d29  h = max(w, k[0])
+00024070: 2c20 6d61 7828 682c 206b 5b31 5d29 0a20  , max(h, k[1]). 
+00024080: 2020 2020 2020 2066 726d 5f69 6420 3d20         frm_id = 
+00024090: 6e70 2e61 7261 6e67 6528 302c 206c 656e  np.arange(0, len
+000240a0: 2864 6174 6129 292e 7265 7368 6170 6528  (data)).reshape(
+000240b0: 2d31 2c20 3129 0a20 2020 2020 2020 2064  -1, 1).        d
+000240c0: 6174 6120 3d20 6e70 2e68 7374 6163 6b28  ata = np.hstack(
+000240d0: 2866 726d 5f69 642c 206e 702e 6172 7261  (frm_id, np.arra
+000240e0: 7928 6461 7461 292e 7265 7368 6170 6528  y(data).reshape(
+000240f0: 2d31 2c20 3129 2929 0a20 2020 2020 2020  -1, 1))).       
+00024100: 2069 6d67 5f61 7272 203d 206e 702e 7a65   img_arr = np.ze
+00024110: 726f 7328 2864 6174 612e 7368 6170 655b  ros((data.shape[
+00024120: 305d 2c20 6820 2b20 312c 2077 202b 2031  0], h + 1, w + 1
+00024130: 2929 0a20 2020 2020 2020 2077 6974 6820  )).        with 
+00024140: 6d75 6c74 6970 726f 6365 7373 696e 672e  multiprocessing.
+00024150: 506f 6f6c 280a 2020 2020 2020 2020 2020  Pool(.          
+00024160: 2020 636f 7265 5f63 6e74 2c20 6d61 7874    core_cnt, maxt
+00024170: 6173 6b73 7065 7263 6869 6c64 3d44 6566  asksperchild=Def
+00024180: 6175 6c74 732e 4c41 5247 455f 4d41 585f  aults.LARGE_MAX_
+00024190: 5441 534b 5f50 4552 5f43 4849 4c44 2e76  TASK_PER_CHILD.v
+000241a0: 616c 7565 0a20 2020 2020 2020 2029 2061  alue.        ) a
+000241b0: 7320 706f 6f6c 3a0a 2020 2020 2020 2020  s pool:.        
+000241c0: 2020 2020 636f 6e73 7461 6e74 7320 3d20      constants = 
+000241d0: 6675 6e63 746f 6f6c 732e 7061 7274 6961  functools.partia
+000241e0: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
+000241f0: 2020 2073 656c 662e 5f63 756d 7375 6d5f     self._cumsum_
+00024200: 616e 696d 616c 5f67 656f 6d65 7472 6965  animal_geometrie
+00024210: 735f 6772 6964 5f68 656c 7065 722c 0a20  s_grid_helper,. 
+00024220: 2020 2020 2020 2020 2020 2020 2020 2067                 g
+00024230: 7269 643d 6772 6964 2c0a 2020 2020 2020  rid=grid,.      
+00024240: 2020 2020 2020 2020 2020 7369 7a65 3d28            size=(
+00024250: 682c 2077 292c 0a20 2020 2020 2020 2020  h, w),.         
+00024260: 2020 2020 2020 2076 6572 626f 7365 3d76         verbose=v
+00024270: 6572 626f 7365 2c0a 2020 2020 2020 2020  erbose,.        
+00024280: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00024290: 2020 666f 7220 636e 742c 2072 6573 756c    for cnt, resul
+000242a0: 7420 696e 2065 6e75 6d65 7261 7465 2870  t in enumerate(p
+000242b0: 6f6f 6c2e 696d 6170 2863 6f6e 7374 616e  ool.imap(constan
+000242c0: 7473 2c20 6461 7461 2c20 6368 756e 6b73  ts, data, chunks
+000242d0: 697a 653d 3129 293a 0a20 2020 2020 2020  ize=1)):.       
+000242e0: 2020 2020 2020 2020 2069 6d67 5f61 7272           img_arr
+000242f0: 5b63 6e74 5d20 3d20 7265 7375 6c74 0a0a  [cnt] = result..
+00024300: 2020 2020 2020 2020 7469 6d65 722e 7374          timer.st
+00024310: 6f70 5f74 696d 6572 2829 0a20 2020 2020  op_timer().     
+00024320: 2020 2073 7464 6f75 745f 7375 6363 6573     stdout_succes
+00024330: 7328 0a20 2020 2020 2020 2020 2020 206d  s(.            m
+00024340: 7367 3d22 4375 6d75 6c61 7469 7665 2061  sg="Cumulative a
+00024350: 6e69 6d61 6c20 6765 6f6d 6574 7269 6573  nimal geometries
+00024360: 2069 6e20 6772 6964 2063 6f6d 706c 6574   in grid complet
+00024370: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+00024380: 656c 6170 7365 645f 7469 6d65 3d74 696d  elapsed_time=tim
+00024390: 6572 2e65 6c61 7073 6564 5f74 696d 655f  er.elapsed_time_
+000243a0: 7374 722c 0a20 2020 2020 2020 2029 0a20  str,.        ). 
+000243b0: 2020 2020 2020 2069 6620 6670 7320 6973         if fps is
+000243c0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+000243d0: 2020 2072 6574 7572 6e20 6e70 2e63 756d     return np.cum
+000243e0: 7375 6d28 696d 675f 6172 722c 2061 7869  sum(img_arr, axi
+000243f0: 733d 3029 0a20 2020 2020 2020 2065 6c73  s=0).        els
+00024400: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+00024410: 6574 7572 6e20 6e70 2e63 756d 7375 6d28  eturn np.cumsum(
+00024420: 696d 675f 6172 722c 2061 7869 733d 3029  img_arr, axis=0)
+00024430: 202f 2066 7073 0a0a 2020 2020 4073 7461   / fps..    @sta
+00024440: 7469 636d 6574 686f 640a 2020 2020 6465  ticmethod.    de
+00024450: 6620 6861 7573 646f 7266 665f 6469 7374  f hausdorff_dist
+00024460: 616e 6365 280a 2020 2020 2020 2020 6765  ance(.        ge
+00024470: 6f6d 6574 7269 6573 3a20 4c69 7374 5b4c  ometries: List[L
+00024480: 6973 745b 556e 696f 6e5b 506f 6c79 676f  ist[Union[Polygo
+00024490: 6e2c 204c 696e 6553 7472 696e 675d 5d5d  n, LineString]]]
+000244a0: 0a20 2020 2029 202d 3e20 6e70 2e6e 6461  .    ) -> np.nda
+000244b0: 7272 6179 3a0a 2020 2020 2020 2020 2222  rray:.        ""
+000244c0: 220a 2020 2020 2020 2020 5468 6520 4861  ".        The Ha
+000244d0: 7573 646f 7266 6620 6469 7374 616e 6365  usdorff distance
+000244e0: 206d 6561 7375 7265 206f 6620 7468 6520   measure of the 
+000244f0: 7369 6d69 6c61 7269 7479 2062 6574 7765  similarity betwe
+00024500: 656e 2074 696d 652d 7365 7269 6573 2073  en time-series s
+00024510: 6571 7565 6e74 6961 6c20 6765 6f6d 6574  equential geomet
+00024520: 7269 6573 2e20 4974 2069 7320 6465 6669  ries. It is defi
+00024530: 6e65 6420 6173 2074 6865 206d 6178 696d  ned as the maxim
+00024540: 756d 206f 6620 7468 6520 6469 7374 616e  um of the distan
+00024550: 6365 730a 2020 2020 2020 2020 6672 6f6d  ces.        from
+00024560: 2065 6163 6820 706f 696e 7420 696e 206f   each point in o
+00024570: 6e65 2073 6574 2074 6f20 7468 6520 6e65  ne set to the ne
+00024580: 6172 6573 7420 706f 696e 7420 696e 2074  arest point in t
+00024590: 6865 206f 7468 6572 2073 6574 2e0a 0a20  he other set... 
+000245a0: 2020 2020 2020 2048 6175 7364 6f72 6666         Hausdorff
+000245b0: 2064 6973 7461 6e63 6520 6361 6e20 6265   distance can be
+000245c0: 2075 7365 6420 746f 206d 6561 7375 7265   used to measure
+000245d0: 2074 6865 2073 696d 696c 6172 6974 7920   the similarity 
+000245e0: 6f66 2074 6865 2067 656f 6d65 7472 7920  of the geometry 
+000245f0: 696e 206f 6e65 2066 7261 6d65 2072 656c  in one frame rel
+00024600: 6174 6976 6520 746f 2074 6865 2067 656f  ative to the geo
+00024610: 6d65 7472 7920 696e 2074 6865 206e 6578  metry in the nex
+00024620: 7420 6672 616d 652e 0a20 2020 2020 2020  t frame..       
+00024630: 204c 6172 6765 7220 7661 6c75 6573 2069   Larger values i
+00024640: 6e64 6963 6174 6520 7468 6174 2074 6865  ndicate that the
+00024650: 2061 6e69 6d61 6c20 6861 7320 6120 6469   animal has a di
+00024660: 6666 6572 656e 7420 7368 6170 6520 7468  fferent shape th
+00024670: 616e 2069 6e20 7468 6520 7072 6563 6564  an in the preced
+00024680: 696e 6720 7368 6170 652e 0a0a 2020 2020  ing shape...    
+00024690: 2020 2020 3a70 6172 616d 204c 6973 745b      :param List[
+000246a0: 4c69 7374 5b55 6e69 6f6e 5b50 6f6c 7967  List[Union[Polyg
+000246b0: 6f6e 2c20 4c69 6e65 5374 7269 6e67 5d5d  on, LineString]]
+000246c0: 5d20 6765 6f6d 6574 7269 6573 3a20 4c69  ] geometries: Li
+000246d0: 7374 206f 6620 6c69 7374 2077 6865 7265  st of list where
+000246e0: 2065 6163 6820 6c69 7374 2068 6173 2074   each list has t
+000246f0: 776f 2067 656f 6d65 7472 6965 732e 0a20  wo geometries.. 
+00024700: 2020 2020 2020 203a 7265 7475 726e 206e         :return n
+00024710: 702e 6e64 6172 7261 793a 2031 4420 6172  p.ndarray: 1D ar
+00024720: 7261 7920 6f66 2068 6175 7364 6f72 6666  ray of hausdorff
+00024730: 2064 6973 7461 6e63 6573 206f 6620 6765   distances of ge
+00024740: 6f6d 6574 7269 6573 2069 6e20 6561 6368  ometries in each
+00024750: 206c 6973 742e 0a0a 2020 2020 2020 2020   list...        
+00024760: 3a65 7861 6d70 6c65 3a0a 2020 2020 2020  :example:.      
+00024770: 2020 3e3e 3e20 7820 3d20 506f 6c79 676f    >>> x = Polygo
+00024780: 6e28 5b5b 302c 315d 2c20 5b30 2c20 325d  n([[0,1], [0, 2]
+00024790: 2c20 5b31 2c31 5d5d 290a 2020 2020 2020  , [1,1]]).      
+000247a0: 2020 3e3e 3e20 7920 3d20 506f 6c79 676f    >>> y = Polygo
+000247b0: 6e28 5b5b 302c 315d 2c20 5b30 2c20 325d  n([[0,1], [0, 2]
+000247c0: 2c20 5b30 2c31 5d5d 290a 2020 2020 2020  , [0,1]]).      
+000247d0: 2020 3e3e 3e20 4765 6f6d 6574 7279 4d69    >>> GeometryMi
+000247e0: 7869 6e2e 6861 7573 646f 7266 665f 6469  xin.hausdorff_di
+000247f0: 7374 616e 6365 2867 656f 6d65 7472 6965  stance(geometrie
+00024800: 733d 5b5b 782c 2079 5d5d 290a 2020 2020  s=[[x, y]]).    
+00024810: 2020 2020 3e3e 3e20 5b31 2e5d 0a20 2020      >>> [1.].   
+00024820: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+00024830: 2020 6368 6563 6b5f 696e 7374 616e 6365    check_instance
+00024840: 280a 2020 2020 2020 2020 2020 2020 736f  (.            so
+00024850: 7572 6365 3d47 656f 6d65 7472 794d 6978  urce=GeometryMix
+00024860: 696e 2e68 6175 7364 6f72 6666 5f64 6973  in.hausdorff_dis
+00024870: 7461 6e63 652e 5f5f 6e61 6d65 5f5f 2c0a  tance.__name__,.
+00024880: 2020 2020 2020 2020 2020 2020 696e 7374              inst
+00024890: 616e 6365 3d67 656f 6d65 7472 6965 732c  ance=geometries,
+000248a0: 0a20 2020 2020 2020 2020 2020 2061 6363  .            acc
+000248b0: 6570 7465 645f 7479 7065 733d 286c 6973  epted_types=(lis
+000248c0: 742c 292c 0a20 2020 2020 2020 2029 0a20  t,),.        ). 
+000248d0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+000248e0: 6765 6f6d 6574 7269 6573 3a0a 2020 2020  geometries:.    
+000248f0: 2020 2020 2020 2020 6368 6563 6b5f 7661          check_va
+00024900: 6c69 645f 6c73 7428 0a20 2020 2020 2020  lid_lst(.       
+00024910: 2020 2020 2020 2020 2073 6f75 7263 653d           source=
+00024920: 4765 6f6d 6574 7279 4d69 7869 6e2e 6861  GeometryMixin.ha
+00024930: 7573 646f 7266 665f 6469 7374 616e 6365  usdorff_distance
+00024940: 2e5f 5f6e 616d 655f 5f2c 0a20 2020 2020  .__name__,.     
+00024950: 2020 2020 2020 2020 2020 2064 6174 613d             data=
+00024960: 692c 0a20 2020 2020 2020 2020 2020 2020  i,.             
+00024970: 2020 2076 616c 6964 5f64 7479 7065 733d     valid_dtypes=
+00024980: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00024990: 2020 2020 2020 506f 6c79 676f 6e2c 0a20        Polygon,. 
+000249a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000249b0: 2020 204c 696e 6553 7472 696e 672c 0a20     LineString,. 
+000249c0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+000249d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000249e0: 2020 6578 6163 745f 6c65 6e3d 322c 0a20    exact_len=2,. 
+000249f0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00024a00: 2020 2020 2072 6573 756c 7473 203d 206e       results = n
+00024a10: 702e 6675 6c6c 2828 6c65 6e28 6765 6f6d  p.full((len(geom
+00024a20: 6574 7269 6573 2929 2c20 6e70 2e6e 616e  etries)), np.nan
+00024a30: 290a 2020 2020 2020 2020 666f 7220 6920  ).        for i 
+00024a40: 696e 2072 616e 6765 286c 656e 2867 656f  in range(len(geo
+00024a50: 6d65 7472 6965 7329 293a 0a20 2020 2020  metries)):.     
+00024a60: 2020 2020 2020 2072 6573 756c 7473 5b69         results[i
+00024a70: 5d20 3d20 6765 6f6d 6574 7269 6573 5b69  ] = geometries[i
+00024a80: 5d5b 305d 2e68 6175 7364 6f72 6666 5f64  ][0].hausdorff_d
+00024a90: 6973 7461 6e63 6528 6765 6f6d 6574 7269  istance(geometri
+00024aa0: 6573 5b69 5d5b 315d 290a 2020 2020 2020  es[i][1]).      
+00024ab0: 2020 7265 7475 726e 2072 6573 756c 7473    return results
+00024ac0: 0a0a 2020 2020 6465 6620 6d75 6c74 6966  ..    def multif
+00024ad0: 7261 6d65 5f68 6175 7364 6f72 6666 5f64  rame_hausdorff_d
+00024ae0: 6973 7461 6e63 6528 0a20 2020 2020 2020  istance(.       
+00024af0: 2073 656c 662c 0a20 2020 2020 2020 2067   self,.        g
+00024b00: 656f 6d65 7472 6965 733a 204c 6973 745b  eometries: List[
+00024b10: 556e 696f 6e5b 506f 6c79 676f 6e2c 204c  Union[Polygon, L
+00024b20: 696e 6553 7472 696e 675d 5d2c 0a20 2020  ineString]],.   
+00024b30: 2020 2020 206c 6167 3a20 4f70 7469 6f6e       lag: Option
+00024b40: 616c 5b69 6e74 5d20 3d20 312c 0a20 2020  al[int] = 1,.   
+00024b50: 2020 2020 2063 6f72 655f 636e 743a 204f       core_cnt: O
+00024b60: 7074 696f 6e61 6c5b 696e 745d 203d 202d  ptional[int] = -
+00024b70: 312c 0a20 2020 2029 202d 3e20 4c69 7374  1,.    ) -> List
+00024b80: 5b66 6c6f 6174 5d3a 0a20 2020 2020 2020  [float]:.       
+00024b90: 2022 2222 0a20 2020 2020 2020 2054 6865   """.        The
+00024ba0: 2048 6175 7364 6f72 6666 2064 6973 7461   Hausdorff dista
+00024bb0: 6e63 6520 6d65 6173 7572 6520 6f66 2074  nce measure of t
+00024bc0: 6865 2073 696d 696c 6172 6974 7920 6265  he similarity be
+00024bd0: 7477 6565 6e20 7365 7175 656e 7469 616c  tween sequential
+00024be0: 2074 696d 652d 7365 7269 6573 2020 6765   time-series  ge
+00024bf0: 6f6d 6574 7269 6573 2e0a 0a20 2020 2020  ometries...     
+00024c00: 2020 203a 6578 616d 706c 653a 0a20 2020     :example:.   
+00024c10: 2020 2020 203e 3e3e 2064 6620 3d20 7265       >>> df = re
+00024c20: 6164 5f64 6628 6669 6c65 5f70 6174 683d  ad_df(file_path=
+00024c30: 272f 5573 6572 732f 7369 6d6f 6e2f 4465  '/Users/simon/De
+00024c40: 736b 746f 702f 656e 7673 2f73 696d 6261  sktop/envs/simba
+00024c50: 2f74 726f 7562 6c65 7368 6f6f 7469 6e67  /troubleshooting
+00024c60: 2f6d 6f75 7365 5f6f 7065 6e5f 6669 656c  /mouse_open_fiel
+00024c70: 642f 7072 6f6a 6563 745f 666f 6c64 6572  d/project_folder
+00024c80: 2f63 7376 2f6f 7574 6c69 6572 5f63 6f72  /csv/outlier_cor
+00024c90: 7265 6374 6564 5f6d 6f76 656d 656e 745f  rected_movement_
+00024ca0: 6c6f 6361 7469 6f6e 2f53 495f 4441 5933  location/SI_DAY3
+00024cb0: 5f33 3038 5f43 4431 5f50 5245 5345 4e54  _308_CD1_PRESENT
+00024cc0: 2e63 7376 272c 2066 696c 655f 7479 7065  .csv', file_type
+00024cd0: 3d27 6373 7627 290a 2020 2020 2020 2020  ='csv').        
+00024ce0: 3e3e 3e20 636f 6c73 203d 205b 7820 666f  >>> cols = [x fo
+00024cf0: 7220 7820 696e 2064 662e 636f 6c75 6d6e  r x in df.column
+00024d00: 7320 6966 206e 6f74 2078 2e65 6e64 7377  s if not x.endsw
+00024d10: 6974 6828 275f 7027 295d 0a20 2020 2020  ith('_p')].     
+00024d20: 2020 203e 3e3e 2064 6174 6120 3d20 6466     >>> data = df
+00024d30: 5b63 6f6c 735d 2e76 616c 7565 732e 7265  [cols].values.re
+00024d40: 7368 6170 6528 6c65 6e28 6466 292c 202d  shape(len(df), -
+00024d50: 3120 2c20 3229 2e61 7374 7970 6528 6e70  1 , 2).astype(np
+00024d60: 2e69 6e74 290a 2020 2020 2020 2020 3e3e  .int).        >>
+00024d70: 3e20 6765 6f6d 6574 7269 6573 203d 2047  > geometries = G
+00024d80: 656f 6d65 7472 794d 6978 696e 2829 2e6d  eometryMixin().m
+00024d90: 756c 7469 6672 616d 655f 626f 6479 7061  ultiframe_bodypa
+00024da0: 7274 735f 746f 5f70 6f6c 7967 6f6e 2864  rts_to_polygon(d
+00024db0: 6174 613d 6461 7461 2c20 7069 7865 6c73  ata=data, pixels
+00024dc0: 5f70 6572 5f6d 6d3d 312c 2070 6172 616c  _per_mm=1, paral
+00024dd0: 6c65 6c5f 6f66 6673 6574 3d31 2c20 7665  lel_offset=1, ve
+00024de0: 7262 6f73 653d 4661 6c73 652c 2063 6f72  rbose=False, cor
+00024df0: 655f 636e 743d 2d31 290a 2020 2020 2020  e_cnt=-1).      
+00024e00: 2020 3e3e 3e20 6861 7573 646f 7266 665f    >>> hausdorff_
+00024e10: 6469 7374 616e 6365 7320 3d20 4765 6f6d  distances = Geom
+00024e20: 6574 7279 4d69 7869 6e2e 6d75 6c74 6966  etryMixin.multif
+00024e30: 7261 6d65 5f68 6175 7364 6f72 6666 5f64  rame_hausdorff_d
+00024e40: 6973 7461 6e63 6528 6765 6f6d 6574 7269  istance(geometri
+00024e50: 6573 3d67 656f 6d65 7472 6965 7329 0a20  es=geometries). 
+00024e60: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+00024e70: 2020 2020 6368 6563 6b5f 7661 6c69 645f      check_valid_
+00024e80: 6c73 7428 0a20 2020 2020 2020 2020 2020  lst(.           
+00024e90: 2073 6f75 7263 653d 4765 6f6d 6574 7279   source=Geometry
+00024ea0: 4d69 7869 6e2e 6d75 6c74 6966 7261 6d65  Mixin.multiframe
+00024eb0: 5f68 6175 7364 6f72 6666 5f64 6973 7461  _hausdorff_dista
+00024ec0: 6e63 652e 5f5f 6e61 6d65 5f5f 2c0a 2020  nce.__name__,.  
+00024ed0: 2020 2020 2020 2020 2020 6461 7461 3d67            data=g
+00024ee0: 656f 6d65 7472 6965 732c 0a20 2020 2020  eometries,.     
+00024ef0: 2020 2020 2020 2076 616c 6964 5f64 7479         valid_dty
+00024f00: 7065 733d 280a 2020 2020 2020 2020 2020  pes=(.          
+00024f10: 2020 2020 2020 506f 6c79 676f 6e2c 0a20        Polygon,. 
+00024f20: 2020 2020 2020 2020 2020 2020 2020 204c                 L
+00024f30: 696e 6553 7472 696e 672c 0a20 2020 2020  ineString,.     
+00024f40: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
+00024f50: 2020 2020 2020 6d69 6e5f 6c65 6e3d 312c        min_len=1,
+00024f60: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00024f70: 2020 2063 6865 636b 5f69 6e74 280a 2020     check_int(.  
+00024f80: 2020 2020 2020 2020 2020 6e61 6d65 3d66            name=f
+00024f90: 227b 4765 6f6d 6574 7279 4d69 7869 6e2e  "{GeometryMixin.
+00024fa0: 6d75 6c74 6966 7261 6d65 5f68 6175 7364  multiframe_hausd
+00024fb0: 6f72 6666 5f64 6973 7461 6e63 652e 5f5f  orff_distance.__
+00024fc0: 6e61 6d65 5f5f 7d20 434f 5245 2043 4f55  name__} CORE COU
+00024fd0: 4e54 222c 0a20 2020 2020 2020 2020 2020  NT",.           
+00024fe0: 2076 616c 7565 3d63 6f72 655f 636e 742c   value=core_cnt,
+00024ff0: 0a20 2020 2020 2020 2020 2020 206d 696e  .            min
+00025000: 5f76 616c 7565 3d2d 312c 0a20 2020 2020  _value=-1,.     
+00025010: 2020 2020 2020 206d 6178 5f76 616c 7565         max_value
+00025020: 3d66 696e 645f 636f 7265 5f63 6e74 2829  =find_core_cnt()
+00025030: 5b30 5d2c 0a20 2020 2020 2020 2020 2020  [0],.           
+00025040: 2072 6169 7365 5f65 7272 6f72 3d54 7275   raise_error=Tru
+00025050: 652c 0a20 2020 2020 2020 2029 0a20 2020  e,.        ).   
+00025060: 2020 2020 2063 6865 636b 5f69 6e74 280a       check_int(.
+00025070: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+00025080: 3d66 227b 4765 6f6d 6574 7279 4d69 7869  =f"{GeometryMixi
+00025090: 6e2e 6d75 6c74 6966 7261 6d65 5f68 6175  n.multiframe_hau
+000250a0: 7364 6f72 6666 5f64 6973 7461 6e63 652e  sdorff_distance.
+000250b0: 5f5f 6e61 6d65 5f5f 7d20 4c41 4722 2c0a  __name__} LAG",.
+000250c0: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+000250d0: 653d 6c61 672c 0a20 2020 2020 2020 2020  e=lag,.         
+000250e0: 2020 206d 696e 5f76 616c 7565 3d2d 312c     min_value=-1,
+000250f0: 0a20 2020 2020 2020 2020 2020 206d 6178  .            max
+00025100: 5f76 616c 7565 3d6c 656e 2867 656f 6d65  _value=len(geome
+00025110: 7472 6965 7329 202d 2031 2c0a 2020 2020  tries) - 1,.    
+00025120: 2020 2020 2020 2020 7261 6973 655f 6572          raise_er
+00025130: 726f 723d 5472 7565 2c0a 2020 2020 2020  ror=True,.      
+00025140: 2020 290a 2020 2020 2020 2020 6966 2063    ).        if c
+00025150: 6f72 655f 636e 7420 3d3d 202d 313a 0a20  ore_cnt == -1:. 
+00025160: 2020 2020 2020 2020 2020 2063 6f72 655f             core_
+00025170: 636e 7420 3d20 6669 6e64 5f63 6f72 655f  cnt = find_core_
+00025180: 636e 7428 295b 305d 0a20 2020 2020 2020  cnt()[0].       
+00025190: 2072 6573 6861 7065 645f 6765 6f6d 6574   reshaped_geomet
+000251a0: 7269 6573 203d 205b 5d0a 2020 2020 2020  ries = [].      
+000251b0: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
+000251c0: 286c 6167 293a 0a20 2020 2020 2020 2020  (lag):.         
+000251d0: 2020 2072 6573 6861 7065 645f 6765 6f6d     reshaped_geom
+000251e0: 6574 7269 6573 2e61 7070 656e 6428 5b5b  etries.append([[
+000251f0: 6765 6f6d 6574 7269 6573 5b69 5d2c 2067  geometries[i], g
+00025200: 656f 6d65 7472 6965 735b 695d 5d5d 290a  eometries[i]]]).
+00025210: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+00025220: 2072 616e 6765 286c 6167 2c20 6c65 6e28   range(lag, len(
+00025230: 6765 6f6d 6574 7269 6573 2929 3a0a 2020  geometries)):.  
+00025240: 2020 2020 2020 2020 2020 7265 7368 6170            reshap
+00025250: 6564 5f67 656f 6d65 7472 6965 732e 6170  ed_geometries.ap
+00025260: 7065 6e64 285b 5b67 656f 6d65 7472 6965  pend([[geometrie
+00025270: 735b 6920 2d20 6c61 675d 2c20 6765 6f6d  s[i - lag], geom
+00025280: 6574 7269 6573 5b69 5d5d 5d29 0a20 2020  etries[i]]]).   
+00025290: 2020 2020 2072 6573 756c 7473 203d 205b       results = [
+000252a0: 5d0a 2020 2020 2020 2020 7769 7468 206d  ].        with m
+000252b0: 756c 7469 7072 6f63 6573 7369 6e67 2e50  ultiprocessing.P
+000252c0: 6f6f 6c28 0a20 2020 2020 2020 2020 2020  ool(.           
+000252d0: 2063 6f72 655f 636e 742c 206d 6178 7461   core_cnt, maxta
+000252e0: 736b 7370 6572 6368 696c 643d 4465 6661  sksperchild=Defa
+000252f0: 756c 7473 2e4c 4152 4745 5f4d 4158 5f54  ults.LARGE_MAX_T
+00025300: 4153 4b5f 5045 525f 4348 494c 442e 7661  ASK_PER_CHILD.va
+00025310: 6c75 650a 2020 2020 2020 2020 2920 6173  lue.        ) as
+00025320: 2070 6f6f 6c3a 0a20 2020 2020 2020 2020   pool:.         
+00025330: 2020 2066 6f72 2063 6e74 2c20 6d70 5f72     for cnt, mp_r
+00025340: 6574 7572 6e20 696e 2065 6e75 6d65 7261  eturn in enumera
+00025350: 7465 280a 2020 2020 2020 2020 2020 2020  te(.            
+00025360: 2020 2020 706f 6f6c 2e69 6d61 7028 0a20      pool.imap(. 
+00025370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025380: 2020 2047 656f 6d65 7472 794d 6978 696e     GeometryMixin
+00025390: 2e68 6175 7364 6f72 6666 5f64 6973 7461  .hausdorff_dista
+000253a0: 6e63 652c 2072 6573 6861 7065 645f 6765  nce, reshaped_ge
+000253b0: 6f6d 6574 7269 6573 2c20 6368 756e 6b73  ometries, chunks
+000253c0: 697a 653d 310a 2020 2020 2020 2020 2020  ize=1.          
+000253d0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000253e0: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
+000253f0: 2020 2020 2020 2072 6573 756c 7473 2e61         results.a
+00025400: 7070 656e 6428 6d70 5f72 6574 7572 6e5b  ppend(mp_return[
+00025410: 305d 290a 2020 2020 2020 2020 7265 7475  0]).        retu
+00025420: 726e 2072 6573 756c 7473 0a0a 2020 2020  rn results..    
+00025430: 4073 7461 7469 636d 6574 686f 640a 2020  @staticmethod.  
+00025440: 2020 6465 6620 6c6f 6361 7465 5f6c 696e    def locate_lin
+00025450: 655f 706f 696e 7428 0a20 2020 2020 2020  e_point(.       
+00025460: 2070 6174 683a 2055 6e69 6f6e 5b4c 696e   path: Union[Lin
+00025470: 6553 7472 696e 672c 206e 702e 6e64 6172  eString, np.ndar
+00025480: 7261 795d 2c0a 2020 2020 2020 2020 6765  ray],.        ge
+00025490: 6f6d 6574 7279 3a20 556e 696f 6e5b 4c69  ometry: Union[Li
+000254a0: 6e65 5374 7269 6e67 2c20 506f 6c79 676f  neString, Polygo
+000254b0: 6e2c 2050 6f69 6e74 5d2c 0a20 2020 2020  n, Point],.     
+000254c0: 2020 2070 785f 7065 725f 6d6d 3a20 4f70     px_per_mm: Op
+000254d0: 7469 6f6e 616c 5b66 6c6f 6174 5d20 3d20  tional[float] = 
+000254e0: 312c 0a20 2020 2020 2020 2066 7073 3a20  1,.        fps: 
+000254f0: 4f70 7469 6f6e 616c 5b66 6c6f 6174 5d20  Optional[float] 
+00025500: 3d20 312c 0a20 2020 2020 2020 2063 6f72  = 1,.        cor
+00025510: 655f 636e 743a 204f 7074 696f 6e61 6c5b  e_cnt: Optional[
+00025520: 696e 745d 203d 202d 312c 0a20 2020 2020  int] = -1,.     
+00025530: 2020 2064 6973 7461 6e63 655f 6d69 6e3a     distance_min:
+00025540: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
+00025550: 3d20 5472 7565 2c0a 2020 2020 2020 2020  = True,.        
+00025560: 7469 6d65 5f70 7269 6f72 3a20 4f70 7469  time_prior: Opti
+00025570: 6f6e 616c 5b62 6f6f 6c5d 203d 2054 7275  onal[bool] = Tru
+00025580: 652c 0a20 2020 2029 202d 3e20 4469 6374  e,.    ) -> Dict
+00025590: 5b73 7472 2c20 666c 6f61 745d 3a0a 2020  [str, float]:.  
+000255a0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000255b0: 2020 436f 6d70 7574 6520 7468 6520 7469    Compute the ti
+000255c0: 6d65 2061 6e64 2064 6973 7461 6e63 6520  me and distance 
+000255d0: 7472 6176 656c 6c65 6420 616c 6f6e 6720  travelled along 
+000255e0: 6120 7061 7468 2074 6f20 7265 6163 6820  a path to reach 
+000255f0: 7468 6520 6d6f 7374 2070 726f 7869 6d61  the most proxima
+00025600: 6c20 706f 696e 7420 696e 2072 6566 6572  l point in refer
+00025610: 656e 6365 2074 6f20 6120 7365 636f 6e64  ence to a second
+00025620: 2067 656f 6d65 7472 792e 0a0a 2020 2020   geometry...    
+00025630: 2020 2020 2e2e 206e 6f74 653a 3a0a 2020      .. note::.  
+00025640: 2020 2020 2020 2020 2028 6929 2054 6f20           (i) To 
+00025650: 636f 6d70 7574 6520 7468 6520 7469 6d65  compute the time
+00025660: 2061 6e64 2064 6973 7461 6e63 6520 7472   and distance tr
+00025670: 6176 656c 6c65 6420 746f 2061 6c6f 6e67  avelled to along
+00025680: 2061 2070 6174 6820 746f 2072 6561 6368   a path to reach
+00025690: 2074 6865 206d 6f73 7420 6469 7374 616c   the most distal
+000256a0: 2070 6f69 6e74 2074 6f20 6120 7365 636f   point to a seco
+000256b0: 6e64 2067 656f 6d65 7472 792c 2070 6173  nd geometry, pas
+000256c0: 7320 6060 6469 7374 616e 6365 5f6d 696e  s ``distance_min
+000256d0: 203d 2046 616c 7365 6060 2e0a 0a20 2020   = False``...   
+000256e0: 2020 2020 2020 2020 2869 6929 2054 6f20          (ii) To 
+000256f0: 636f 6d70 7574 6520 7468 6520 7469 6d65  compute the time
+00025700: 2061 6e64 2064 6973 7461 6e63 6520 7472   and distance tr
+00025710: 6176 656c 6c65 6420 616c 6f6e 6720 6120  avelled along a 
+00025720: 7061 7468 202a 2a61 6674 6572 2a2a 2072  path **after** r
+00025730: 6561 6368 696e 6720 7468 6520 6d6f 7374  eaching the most
+00025740: 2064 6973 7461 6c20 6f72 2070 726f 7869   distal or proxi
+00025750: 6d61 6c20 706f 696e 7420 746f 2061 2073  mal point to a s
+00025760: 6563 6f6e 6420 6765 6f6d 6574 7279 2c20  econd geometry, 
+00025770: 7061 7373 2060 6074 696d 655f 7072 696f  pass ``time_prio
+00025780: 7220 3d20 4661 6c73 6560 602e 0a0a 2020  r = False``...  
+00025790: 2020 2020 2020 2e2e 2069 6d61 6765 3a3a        .. image::
+000257a0: 205f 7374 6174 6963 2f69 6d67 2f6c 6f63   _static/img/loc
+000257b0: 6174 655f 6c69 6e65 5f70 6f69 6e74 2e70  ate_line_point.p
+000257c0: 6e67 0a20 2020 2020 2020 2020 2020 3a77  ng.           :w
+000257d0: 6964 7468 3a20 3630 300a 2020 2020 2020  idth: 600.      
+000257e0: 2020 2020 203a 616c 6967 6e3a 2063 656e       :align: cen
+000257f0: 7465 720a 0a20 2020 2020 2020 203a 6578  ter..        :ex
+00025800: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
+00025810: 3e3e 206c 696e 6520 3d20 4c69 6e65 5374  >> line = LineSt
+00025820: 7269 6e67 285b 5b31 302c 2031 305d 2c20  ring([[10, 10], 
+00025830: 5b37 2e35 2c20 372e 355d 2c20 5b31 352c  [7.5, 7.5], [15,
+00025840: 2031 355d 2c20 5b37 2e35 2c20 372e 355d   15], [7.5, 7.5]
+00025850: 5d29 0a20 2020 2020 2020 203e 3e3e 2070  ]).        >>> p
+00025860: 6f6c 7967 6f6e 203d 2050 6f6c 7967 6f6e  olygon = Polygon
+00025870: 285b 5b30 2c20 355d 2c20 5b30 2c20 305d  ([[0, 5], [0, 0]
+00025880: 2c20 5b35 2c20 305d 2c20 5b35 2c20 355d  , [5, 0], [5, 5]
+00025890: 5d29 0a20 2020 2020 2020 203e 3e3e 2047  ]).        >>> G
+000258a0: 656f 6d65 7472 794d 6978 696e 2e6c 6f63  eometryMixin.loc
+000258b0: 6174 655f 6c69 6e65 5f70 6f69 6e74 2870  ate_line_point(p
+000258c0: 6174 683d 6c69 6e65 2c20 6765 6f6d 6574  ath=line, geomet
+000258d0: 7279 3d70 6f6c 7967 6f6e 290a 2020 2020  ry=polygon).    
+000258e0: 2020 2020 3e3e 3e20 7b27 6469 7374 616e      >>> {'distan
+000258f0: 6365 5f76 616c 7565 273a 2033 2e35 3335  ce_value': 3.535
+00025900: 3533 3339 3035 3933 3237 3337 382c 2027  5339059327378, '
+00025910: 6469 7374 616e 6365 5f74 7261 7665 6c6c  distance_travell
+00025920: 6564 273a 2033 2e35 3335 3533 3339 3035  ed': 3.535533905
+00025930: 3933 3237 3337 382c 2027 7469 6d65 5f74  9327378, 'time_t
+00025940: 7261 7665 6c6c 6564 273a 2031 2e30 2c20  ravelled': 1.0, 
+00025950: 2764 6973 7461 6e63 655f 696e 6465 7827  'distance_index'
+00025960: 3a20 317d 0a20 2020 2020 2020 2022 2222  : 1}.        """
+00025970: 0a0a 2020 2020 2020 2020 6368 6563 6b5f  ..        check_
+00025980: 696e 7374 616e 6365 280a 2020 2020 2020  instance(.      
+00025990: 2020 2020 2020 736f 7572 6365 3d47 656f        source=Geo
+000259a0: 6d65 7472 794d 6978 696e 2e6c 6f63 6174  metryMixin.locat
+000259b0: 655f 6c69 6e65 5f70 6f69 6e74 2e5f 5f6e  e_line_point.__n
+000259c0: 616d 655f 5f2c 0a20 2020 2020 2020 2020  ame__,.         
+000259d0: 2020 2069 6e73 7461 6e63 653d 7061 7468     instance=path
+000259e0: 2c0a 2020 2020 2020 2020 2020 2020 6163  ,.            ac
+000259f0: 6365 7074 6564 5f74 7970 6573 3d28 4c69  cepted_types=(Li
+00025a00: 6e65 5374 7269 6e67 2c20 6e70 2e6e 6461  neString, np.nda
+00025a10: 7272 6179 292c 0a20 2020 2020 2020 2029  rray),.        )
+00025a20: 0a20 2020 2020 2020 2063 6865 636b 5f69  .        check_i
+00025a30: 6e73 7461 6e63 6528 0a20 2020 2020 2020  nstance(.       
+00025a40: 2020 2020 2073 6f75 7263 653d 4765 6f6d       source=Geom
+00025a50: 6574 7279 4d69 7869 6e2e 6c6f 6361 7465  etryMixin.locate
+00025a60: 5f6c 696e 655f 706f 696e 742e 5f5f 6e61  _line_point.__na
+00025a70: 6d65 5f5f 2c0a 2020 2020 2020 2020 2020  me__,.          
+00025a80: 2020 696e 7374 616e 6365 3d67 656f 6d65    instance=geome
+00025a90: 7472 792c 0a20 2020 2020 2020 2020 2020  try,.           
+00025aa0: 2061 6363 6570 7465 645f 7479 7065 733d   accepted_types=
+00025ab0: 284c 696e 6553 7472 696e 672c 2050 6f6c  (LineString, Pol
+00025ac0: 7967 6f6e 2c20 506f 696e 7429 2c0a 2020  ygon, Point),.  
+00025ad0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00025ae0: 6368 6563 6b5f 696e 7428 0a20 2020 2020  check_int(.     
+00025af0: 2020 2020 2020 206e 616d 653d 2243 4f52         name="COR
+00025b00: 4520 434f 554e 5422 2c0a 2020 2020 2020  E COUNT",.      
+00025b10: 2020 2020 2020 7661 6c75 653d 636f 7265        value=core
+00025b20: 5f63 6e74 2c0a 2020 2020 2020 2020 2020  _cnt,.          
+00025b30: 2020 6d69 6e5f 7661 6c75 653d 2d31 2c0a    min_value=-1,.
+00025b40: 2020 2020 2020 2020 2020 2020 6d61 785f              max_
+00025b50: 7661 6c75 653d 6669 6e64 5f63 6f72 655f  value=find_core_
+00025b60: 636e 7428 295b 305d 2c0a 2020 2020 2020  cnt()[0],.      
+00025b70: 2020 2020 2020 7261 6973 655f 6572 726f        raise_erro
+00025b80: 723d 5472 7565 2c0a 2020 2020 2020 2020  r=True,.        
+00025b90: 290a 2020 2020 2020 2020 6368 6563 6b5f  ).        check_
+00025ba0: 666c 6f61 7428 0a20 2020 2020 2020 2020  float(.         
+00025bb0: 2020 206e 616d 653d 2250 4958 454c 5320     name="PIXELS 
+00025bc0: 5045 5220 4d4d 222c 2076 616c 7565 3d70  PER MM", value=p
+00025bd0: 785f 7065 725f 6d6d 2c20 6d69 6e5f 7661  x_per_mm, min_va
+00025be0: 6c75 653d 302e 312c 2072 6169 7365 5f65  lue=0.1, raise_e
+00025bf0: 7272 6f72 3d54 7275 650a 2020 2020 2020  rror=True.      
+00025c00: 2020 290a 2020 2020 2020 2020 6368 6563    ).        chec
+00025c10: 6b5f 666c 6f61 7428 6e61 6d65 3d22 4650  k_float(name="FP
+00025c20: 5322 2c20 7661 6c75 653d 6670 732c 206d  S", value=fps, m
+00025c30: 696e 5f76 616c 7565 3d31 2c20 7261 6973  in_value=1, rais
+00025c40: 655f 6572 726f 723d 5472 7565 290a 2020  e_error=True).  
+00025c50: 2020 2020 2020 6966 2063 6f72 655f 636e        if core_cn
+00025c60: 7420 3d3d 202d 313a 0a20 2020 2020 2020  t == -1:.       
+00025c70: 2020 2020 2063 6f72 655f 636e 7420 3d20       core_cnt = 
+00025c80: 6669 6e64 5f63 6f72 655f 636e 7428 295b  find_core_cnt()[
+00025c90: 305d 0a0a 2020 2020 2020 2020 6966 2069  0]..        if i
+00025ca0: 7369 6e73 7461 6e63 6528 7061 7468 2c20  sinstance(path, 
+00025cb0: 6e70 2e6e 6461 7272 6179 293a 0a20 2020  np.ndarray):.   
+00025cc0: 2020 2020 2020 2020 2063 6865 636b 5f76           check_v
+00025cd0: 616c 6964 5f61 7272 6179 280a 2020 2020  alid_array(.    
+00025ce0: 2020 2020 2020 2020 2020 2020 6461 7461              data
+00025cf0: 3d70 6174 682c 0a20 2020 2020 2020 2020  =path,.         
+00025d00: 2020 2020 2020 2061 6363 6570 7465 645f         accepted_
+00025d10: 6178 6973 5f31 5f73 6861 7065 3d28 322c  axis_1_shape=(2,
+00025d20: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00025d30: 2020 2061 6363 6570 7465 645f 6474 7970     accepted_dtyp
+00025d40: 6573 3d28 6e70 2e66 6c6f 6174 3332 2c20  es=(np.float32, 
+00025d50: 6e70 2e66 6c6f 6174 3634 2c20 6e70 2e69  np.float64, np.i
+00025d60: 6e74 3634 2c20 6e70 2e69 6e74 3332 292c  nt64, np.int32),
+00025d70: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00025d80: 2020 2020 2020 2020 2020 2070 6174 6820             path 
+00025d90: 3d20 4c69 6e65 5374 7269 6e67 2870 6174  = LineString(pat
+00025da0: 6829 0a20 2020 2020 2020 2069 6620 6973  h).        if is
+00025db0: 696e 7374 616e 6365 2867 656f 6d65 7472  instance(geometr
+00025dc0: 792c 2050 6f69 6e74 293a 0a20 2020 2020  y, Point):.     
+00025dd0: 2020 2020 2020 2067 656f 6d65 7472 7920         geometry 
+00025de0: 3d20 6e70 2e61 7272 6179 2867 656f 6d65  = np.array(geome
+00025df0: 7472 792e 636f 6f72 6473 290a 2020 2020  try.coords).    
+00025e00: 2020 2020 2020 2020 6469 7374 616e 6365          distance
+00025e10: 7320 3d20 4665 6174 7572 6545 7874 7261  s = FeatureExtra
+00025e20: 6374 696f 6e4d 6978 696e 2e66 7261 6d65  ctionMixin.frame
+00025e30: 7769 7365 5f65 7563 6c69 6465 616e 5f64  wise_euclidean_d
+00025e40: 6973 7461 6e63 655f 726f 6928 0a20 2020  istance_roi(.   
+00025e50: 2020 2020 2020 2020 2020 2020 206c 6f63               loc
+00025e60: 6174 696f 6e5f 313d 6e70 2e61 7272 6179  ation_1=np.array
+00025e70: 2870 6174 682e 636f 6f72 6473 292c 0a20  (path.coords),. 
+00025e80: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00025e90: 6f63 6174 696f 6e5f 323d 6765 6f6d 6574  ocation_2=geomet
+00025ea0: 7279 2c0a 2020 2020 2020 2020 2020 2020  ry,.            
+00025eb0: 2020 2020 7078 5f70 6572 5f6d 6d3d 7078      px_per_mm=px
+00025ec0: 5f70 6572 5f6d 6d2c 0a20 2020 2020 2020  _per_mm,.       
+00025ed0: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
+00025ee0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00025ef0: 2070 6f69 6e74 7320 3d20 5b50 6f69 6e74   points = [Point
+00025f00: 2878 2920 666f 7220 7820 696e 206e 702e  (x) for x in np.
+00025f10: 6172 7261 7928 7061 7468 2e63 6f6f 7264  array(path.coord
+00025f20: 7329 5d0a 2020 2020 2020 2020 2020 2020  s)].            
+00025f30: 6765 6f6d 6574 7279 203d 205b 6765 6f6d  geometry = [geom
+00025f40: 6574 7279 2066 6f72 2078 2069 6e20 7261  etry for x in ra
+00025f50: 6e67 6528 6c65 6e28 706f 696e 7473 2929  nge(len(points))
+00025f60: 5d0a 2020 2020 2020 2020 2020 2020 6469  ].            di
+00025f70: 7374 616e 6365 7320 3d20 4765 6f6d 6574  stances = Geomet
+00025f80: 7279 4d69 7869 6e28 292e 6d75 6c74 6966  ryMixin().multif
+00025f90: 7261 6d65 5f73 6861 7065 5f64 6973 7461  rame_shape_dista
+00025fa0: 6e63 6528 0a20 2020 2020 2020 2020 2020  nce(.           
+00025fb0: 2020 2020 2073 6861 7065 5f31 3d70 6f69       shape_1=poi
+00025fc0: 6e74 732c 0a20 2020 2020 2020 2020 2020  nts,.           
+00025fd0: 2020 2020 2073 6861 7065 5f32 3d67 656f       shape_2=geo
+00025fe0: 6d65 7472 792c 0a20 2020 2020 2020 2020  metry,.         
+00025ff0: 2020 2020 2020 2070 6978 656c 735f 7065         pixels_pe
+00026000: 725f 6d6d 3d70 785f 7065 725f 6d6d 2c0a  r_mm=px_per_mm,.
+00026010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026020: 636f 7265 5f63 6e74 3d63 6f72 655f 636e  core_cnt=core_cn
+00026030: 742c 0a20 2020 2020 2020 2020 2020 2029  t,.            )
+00026040: 0a0a 2020 2020 2020 2020 6966 2064 6973  ..        if dis
+00026050: 7461 6e63 655f 6d69 6e3a 0a20 2020 2020  tance_min:.     
+00026060: 2020 2020 2020 2064 6973 7461 6e63 655f         distance_
+00026070: 6964 7820 3d20 6e70 2e61 7267 6d69 6e28  idx = np.argmin(
+00026080: 6469 7374 616e 6365 7329 0a20 2020 2020  distances).     
+00026090: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+000260a0: 2020 2020 2064 6973 7461 6e63 655f 6964       distance_id
+000260b0: 7820 3d20 6e70 2e61 7267 6d61 7828 6469  x = np.argmax(di
+000260c0: 7374 616e 6365 7329 0a20 2020 2020 2020  stances).       
+000260d0: 2069 6620 7469 6d65 5f70 7269 6f72 3a0a   if time_prior:.
+000260e0: 2020 2020 2020 2020 2020 2020 6469 7374              dist
+000260f0: 5f74 7261 7665 6c6c 6564 203d 2028 0a20  _travelled = (. 
+00026100: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00026110: 702e 7375 6d28 6e70 2e61 6273 286e 702e  p.sum(np.abs(np.
+00026120: 6469 6666 2864 6973 7461 6e63 6573 5b3a  diff(distances[:
+00026130: 2064 6973 7461 6e63 655f 6964 7820 2b20   distance_idx + 
+00026140: 315d 2929 2920 2f20 7078 5f70 6572 5f6d  1]))) / px_per_m
+00026150: 6d0a 2020 2020 2020 2020 2020 2020 290a  m.            ).
+00026160: 2020 2020 2020 2020 2020 2020 7469 6d65              time
+00026170: 5f74 7261 7665 6c6c 6564 203d 2064 6973  _travelled = dis
+00026180: 7461 6e63 655f 6964 7820 2f20 6670 730a  tance_idx / fps.
+00026190: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+000261a0: 2020 2020 2020 2020 2020 6469 7374 5f74            dist_t
+000261b0: 7261 7665 6c6c 6564 203d 2028 0a20 2020  ravelled = (.   
+000261c0: 2020 2020 2020 2020 2020 2020 206e 702e               np.
+000261d0: 7375 6d28 6e70 2e61 6273 286e 702e 6469  sum(np.abs(np.di
+000261e0: 6666 2864 6973 7461 6e63 6573 5b64 6973  ff(distances[dis
+000261f0: 7461 6e63 655f 6964 783a 5d29 2929 202f  tance_idx:]))) /
+00026200: 2070 785f 7065 725f 6d6d 0a20 2020 2020   px_per_mm.     
+00026210: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00026220: 2020 2020 2074 696d 655f 7472 6176 656c       time_travel
+00026230: 6c65 6420 3d20 2864 6973 7461 6e63 6573  led = (distances
+00026240: 202d 2064 6973 7461 6e63 655f 6964 7829   - distance_idx)
+00026250: 202f 2066 7073 0a20 2020 2020 2020 2064   / fps.        d
+00026260: 6973 745f 7661 6c20 3d20 6469 7374 616e  ist_val = distan
+00026270: 6365 735b 6469 7374 616e 6365 5f69 6478  ces[distance_idx
+00026280: 5d20 2f20 7078 5f70 6572 5f6d 6d0a 0a20  ] / px_per_mm.. 
+00026290: 2020 2020 2020 2072 6574 7572 6e20 7b0a         return {.
+000262a0: 2020 2020 2020 2020 2020 2020 2264 6973              "dis
+000262b0: 7461 6e63 655f 7661 6c75 6522 3a20 6469  tance_value": di
+000262c0: 7374 5f76 616c 2c0a 2020 2020 2020 2020  st_val,.        
+000262d0: 2020 2020 2264 6973 7461 6e63 655f 7472      "distance_tr
+000262e0: 6176 656c 6c65 6422 3a20 6469 7374 5f74  avelled": dist_t
+000262f0: 7261 7665 6c6c 6564 2c0a 2020 2020 2020  ravelled,.      
+00026300: 2020 2020 2020 2274 696d 655f 7472 6176        "time_trav
+00026310: 656c 6c65 6422 3a20 7469 6d65 5f74 7261  elled": time_tra
+00026320: 7665 6c6c 6564 2c0a 2020 2020 2020 2020  velled,.        
+00026330: 2020 2020 2264 6973 7461 6e63 655f 696e      "distance_in
+00026340: 6465 7822 3a20 6469 7374 616e 6365 5f69  dex": distance_i
+00026350: 6478 2c0a 2020 2020 2020 2020 7d0a 0a20  dx,.        }.. 
+00026360: 2020 2040 7374 6174 6963 6d65 7468 6f64     @staticmethod
+00026370: 0a20 2020 2040 6e6a 6974 2822 2866 6c6f  .    @njit("(flo
+00026380: 6174 3332 5b3a 2c3a 5d2c 2066 6c6f 6174  at32[:,:], float
+00026390: 3332 5b3a 2c3a 5d2c 2069 6e74 3634 2922  32[:,:], int64)"
+000263a0: 290a 2020 2020 6465 6620 6c69 6e65 6172  ).    def linear
+000263b0: 5f66 7265 6368 6574 5f64 6973 7461 6e63  _frechet_distanc
+000263c0: 6528 0a20 2020 2020 2020 2078 3a20 6e70  e(.        x: np
+000263d0: 2e6e 6461 7272 6179 2c20 793a 206e 702e  .ndarray, y: np.
+000263e0: 6e64 6172 7261 792c 2073 616d 706c 653a  ndarray, sample:
+000263f0: 2069 6e74 203d 2031 3030 0a20 2020 2029   int = 100.    )
+00026400: 202d 3e20 666c 6f61 743a 0a20 2020 2020   -> float:.     
+00026410: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
+00026420: 6f6d 7075 7465 2074 6865 204c 696e 6561  ompute the Linea
+00026430: 7220 4672 c3a9 6368 6574 2044 6973 7461  r Fr..chet Dista
+00026440: 6e63 6520 6265 7477 6565 6e20 7477 6f20  nce between two 
+00026450: 7472 616a 6563 746f 7269 6573 2e0a 0a20  trajectories... 
+00026460: 2020 2020 2020 2054 6865 2046 72c3 a963         The Fr..c
+00026470: 6865 7420 4469 7374 616e 6365 206d 6561  het Distance mea
+00026480: 7375 7265 7320 7468 6520 6469 7373 696d  sures the dissim
+00026490: 696c 6172 6974 7920 6265 7477 6565 6e20  ilarity between 
+000264a0: 7477 6f20 636f 6e74 696e 756f 7573 0a20  two continuous. 
+000264b0: 2020 2020 2020 2063 7572 7665 7320 6f72         curves or
+000264c0: 2074 7261 6a65 6374 6f72 6965 7320 7265   trajectories re
+000264d0: 7072 6573 656e 7465 6420 6173 2073 6571  presented as seq
+000264e0: 7565 6e63 6573 206f 6620 706f 696e 7473  uences of points
+000264f0: 2069 6e20 6120 322d 6469 6d65 6e73 696f   in a 2-dimensio
+00026500: 6e61 6c0a 2020 2020 2020 2020 7370 6163  nal.        spac
+00026510: 652e 0a0a 2020 2020 2020 2020 3a70 6172  e...        :par
+00026520: 616d 206e 6461 7272 6179 2064 6174 613a  am ndarray data:
+00026530: 2046 6972 7374 2032 4420 6172 7261 7920   First 2D array 
+00026540: 6f66 2073 697a 6520 6c65 6e28 6672 616d  of size len(fram
+00026550: 6573 2920 7265 7072 6573 656e 7469 6e67  es) representing
+00026560: 2062 6f64 792d 7061 7274 2063 6f6f 7264   body-part coord
+00026570: 696e 6174 6573 2078 2061 6e64 2079 2e0a  inates x and y..
+00026580: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
+00026590: 6461 7272 6179 2064 6174 613a 2053 6563  darray data: Sec
+000265a0: 6f6e 6420 3244 2061 7272 6179 206f 6620  ond 2D array of 
+000265b0: 7369 7a65 206c 656e 2866 7261 6d65 7329  size len(frames)
+000265c0: 2072 6570 7265 7365 6e74 696e 6720 626f   representing bo
+000265d0: 6479 2d70 6172 7420 636f 6f72 6469 6e61  dy-part coordina
+000265e0: 7465 7320 7820 616e 6420 792e 0a20 2020  tes x and y..   
+000265f0: 2020 2020 203a 7061 7261 6d20 696e 7420       :param int 
+00026600: 7361 6d70 6c65 3a20 5468 6520 646f 776e  sample: The down
+00026610: 7361 6d70 6c69 6e67 2066 6163 746f 7220  sampling factor 
+00026620: 666f 7220 7468 6520 7472 616a 6563 746f  for the trajecto
+00026630: 7269 6573 2028 6465 6661 756c 7420 6973  ries (default is
+00026640: 2031 3030 4966 2073 616d 706c 6520 3e20   100If sample > 
+00026650: 312c 2074 6865 2074 7261 6a65 6374 6f72  1, the trajector
+00026660: 6965 7320 6172 6520 646f 776e 7361 6d70  ies are downsamp
+00026670: 6c65 6420 6279 2073 656c 6563 7469 6e67  led by selecting
+00026680: 2065 7665 7279 2073 616d 706c 652d 7468   every sample-th
+00026690: 2070 6f69 6e74 2e0a 0a20 2020 2020 2020   point...       
+000266a0: 202e 2e20 6e6f 7465 3a3a 0a20 2020 2020   .. note::.     
+000266b0: 2020 2020 2020 536c 6967 6874 6c79 206d        Slightly m
+000266c0: 6f64 6966 6965 6420 6672 6f6d 2060 4a6f  odified from `Jo
+000266d0: c3a3 6f20 5061 756c 6f20 4669 6775 6569  ..o Paulo Figuei
+000266e0: 7261 203c 6874 7470 733a 2f2f 6769 7468  ra <https://gith
+000266f0: 7562 2e63 6f6d 2f6a 6f61 6f66 6967 2f64  ub.com/joaofig/d
+00026700: 6973 6372 6574 652d 6672 6563 6865 742f  iscrete-frechet/
+00026710: 626c 6f62 2f66 6635 3632 3965 3561 3433  blob/ff5629e5a43
+00026720: 6366 6164 3434 6435 6539 3632 6634 3130  cfad44d5e962f410
+00026730: 3564 6432 3563 3930 6239 3238 392f 6469  5dd25c90b9289/di
+00026740: 7374 616e 6365 732f 6469 7363 7265 7465  stances/discrete
+00026750: 2e70 7923 4c36 373e 605f 0a0a 2020 2020  .py#L67>`_..    
+00026760: 2020 2020 3a65 7861 6d70 6c65 3a0a 2020      :example:.  
+00026770: 2020 2020 2020 3e3e 3e20 7820 3d20 6e70        >>> x = np
+00026780: 2e72 616e 646f 6d2e 7261 6e64 696e 7428  .random.randint(
+00026790: 302c 2031 3030 2c20 2831 3030 3030 2c20  0, 100, (10000, 
+000267a0: 3229 292e 6173 7479 7065 286e 702e 666c  2)).astype(np.fl
+000267b0: 6f61 7433 3229 0a20 2020 2020 2020 203e  oat32).        >
+000267c0: 3e3e 2079 203d 206e 702e 7261 6e64 6f6d  >> y = np.random
+000267d0: 2e72 616e 6469 6e74 2830 2c20 3130 302c  .randint(0, 100,
+000267e0: 2028 3130 3030 302c 2032 2929 2e61 7374   (10000, 2)).ast
+000267f0: 7970 6528 6e70 2e66 6c6f 6174 3332 290a  ype(np.float32).
+00026800: 2020 2020 2020 2020 3e3e 3e20 6469 7374          >>> dist
+00026810: 616e 6365 203d 2047 656f 6d65 7472 794d  ance = GeometryM
+00026820: 6978 696e 2e6c 696e 6561 725f 6672 6563  ixin.linear_frec
+00026830: 6865 745f 6469 7374 616e 6365 2878 3d78  het_distance(x=x
+00026840: 2c20 793d 792c 2073 616d 706c 653d 3130  , y=y, sample=10
+00026850: 3029 0a0a 2020 2020 2020 2020 2222 220a  0)..        """.
+00026860: 2020 2020 2020 2020 6966 2073 616d 706c          if sampl
+00026870: 6520 3e20 313a 0a20 2020 2020 2020 2020  e > 1:.         
+00026880: 2020 2078 2c20 7920 3d20 785b 3a3a 7361     x, y = x[::sa
+00026890: 6d70 6c65 5d2c 2079 5b3a 3a73 616d 706c  mple], y[::sampl
+000268a0: 655d 0a20 2020 2020 2020 206e 5f70 2c20  e].        n_p, 
+000268b0: 6e5f 7120 3d20 782e 7368 6170 655b 305d  n_q = x.shape[0]
+000268c0: 2c20 792e 7368 6170 655b 305d 0a20 2020  , y.shape[0].   
+000268d0: 2020 2020 2063 6120 3d20 6e70 2e66 756c       ca = np.ful
+000268e0: 6c28 286e 5f70 2c20 6e5f 7129 2c20 302e  l((n_p, n_q), 0.
+000268f0: 3029 0a20 2020 2020 2020 2066 6f72 2069  0).        for i
+00026900: 2069 6e20 7072 616e 6765 286e 5f70 293a   in prange(n_p):
+00026910: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00026920: 206a 2069 6e20 7261 6e67 6528 6e5f 7129   j in range(n_q)
+00026930: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00026940: 2020 6420 3d20 785b 695d 202d 2079 5b6a    d = x[i] - y[j
+00026950: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00026960: 2020 6420 3d20 6e70 2e73 7172 7428 6e70    d = np.sqrt(np
+00026970: 2e64 6f74 2864 2c20 6429 290a 2020 2020  .dot(d, d)).    
+00026980: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00026990: 203e 2030 2061 6e64 206a 203e 2030 3a0a   > 0 and j > 0:.
+000269a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000269b0: 2020 2020 6361 5b69 2c20 6a5d 203d 206d      ca[i, j] = m
+000269c0: 6178 286d 696e 2863 615b 6920 2d20 312c  ax(min(ca[i - 1,
+000269d0: 206a 5d2c 2063 615b 6920 2d20 312c 206a   j], ca[i - 1, j
+000269e0: 202d 2031 5d2c 2063 615b 692c 206a 202d   - 1], ca[i, j -
+000269f0: 2031 5d29 2c20 6429 0a20 2020 2020 2020   1]), d).       
+00026a00: 2020 2020 2020 2020 2065 6c69 6620 6920           elif i 
+00026a10: 3e20 3020 616e 6420 6a20 3d3d 2030 3a0a  > 0 and j == 0:.
+00026a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026a30: 2020 2020 6361 5b69 2c20 6a5d 203d 206d      ca[i, j] = m
+00026a40: 6178 2863 615b 6920 2d20 312c 2030 5d2c  ax(ca[i - 1, 0],
+00026a50: 2064 290a 2020 2020 2020 2020 2020 2020   d).            
+00026a60: 2020 2020 656c 6966 2069 203d 3d20 3020      elif i == 0 
+00026a70: 616e 6420 6a20 3e20 303a 0a20 2020 2020  and j > 0:.     
+00026a80: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00026a90: 615b 692c 206a 5d20 3d20 6d61 7828 6361  a[i, j] = max(ca
+00026aa0: 5b30 2c20 6a20 2d20 315d 2c20 6429 0a20  [0, j - 1], d). 
+00026ab0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00026ac0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00026ad0: 2020 2020 2020 2020 2063 615b 692c 206a           ca[i, j
+00026ae0: 5d20 3d20 640a 2020 2020 2020 2020 7265  ] = d.        re
+00026af0: 7475 726e 2063 615b 6e5f 7020 2d20 312c  turn ca[n_p - 1,
+00026b00: 206e 5f71 202d 2031 5d0a 0a20 2020 2040   n_q - 1]..    @
+00026b10: 7374 6174 6963 6d65 7468 6f64 0a20 2020  staticmethod.   
+00026b20: 2064 6566 2073 696d 6261 5f72 6f69 5f74   def simba_roi_t
+00026b30: 6f5f 6765 6f6d 6574 7269 6573 280a 2020  o_geometries(.  
+00026b40: 2020 2020 2020 7265 6374 616e 676c 6573        rectangles
+00026b50: 5f64 663a 2070 642e 4461 7461 4672 616d  _df: pd.DataFram
+00026b60: 652c 0a20 2020 2020 2020 2063 6972 636c  e,.        circl
+00026b70: 6573 5f64 663a 2070 642e 4461 7461 4672  es_df: pd.DataFr
+00026b80: 616d 652c 0a20 2020 2020 2020 2070 6f6c  ame,.        pol
+00026b90: 7967 6f6e 735f 6466 3a20 7064 2e44 6174  ygons_df: pd.Dat
+00026ba0: 6146 7261 6d65 2c0a 2020 2020 2020 2020  aFrame,.        
+00026bb0: 636f 6c6f 723a 204f 7074 696f 6e61 6c5b  color: Optional[
+00026bc0: 626f 6f6c 5d20 3d20 4661 6c73 652c 0a20  bool] = False,. 
+00026bd0: 2020 2029 202d 3e20 6469 6374 3a0a 2020     ) -> dict:.  
+00026be0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00026bf0: 2020 436f 6e76 6572 7420 5369 6d42 4120    Convert SimBA 
+00026c00: 6461 7461 6672 616d 6573 2068 6f6c 6469  dataframes holdi
+00026c10: 6e67 2052 4f49 2067 656f 6d65 7472 6965  ng ROI geometrie
+00026c20: 7320 746f 206e 6573 7465 6420 6469 6374  s to nested dict
+00026c30: 696f 6e61 7279 2068 6f6c 6469 6e67 2053  ionary holding S
+00026c40: 6861 706c 6579 2070 6f6c 7967 6f6e 732e  hapley polygons.
+00026c50: 0a0a 2020 2020 2020 2020 3a65 7861 6d70  ..        :examp
+00026c60: 6c65 3a0a 2020 2020 2020 2020 3e3e 3e20  le:.        >>> 
+00026c70: 2363 6f6e 6669 675f 7061 7468 203d 2027  #config_path = '
+00026c80: 2f55 7365 7273 2f73 696d 6f6e 2f44 6573  /Users/simon/Des
+00026c90: 6b74 6f70 2f65 6e76 732f 7369 6d62 612f  ktop/envs/simba/
+00026ca0: 7472 6f75 626c 6573 686f 6f74 696e 672f  troubleshooting/
+00026cb0: 7370 6f6e 7465 6e6f 7573 5f61 6c74 6572  spontenous_alter
+00026cc0: 6e61 7469 6f6e 2f70 726f 6a65 6374 5f66  nation/project_f
+00026cd0: 6f6c 6465 722f 7072 6f6a 6563 745f 636f  older/project_co
+00026ce0: 6e66 6967 2e69 6e69 270a 2020 2020 2020  nfig.ini'.      
+00026cf0: 2020 3e3e 3e20 2363 6f6e 6669 6720 3d20    >>> #config = 
+00026d00: 436f 6e66 6967 5265 6164 6572 2863 6f6e  ConfigReader(con
+00026d10: 6669 675f 7061 7468 3d63 6f6e 6669 675f  fig_path=config_
+00026d20: 7061 7468 290a 2020 2020 2020 2020 3e3e  path).        >>
+00026d30: 3e20 2363 6f6e 6669 672e 7265 6164 5f72  > #config.read_r
+00026d40: 6f69 5f64 6174 6128 290a 2020 2020 2020  oi_data().      
+00026d50: 2020 3e3e 3e20 2347 656f 6d65 7472 794d    >>> #GeometryM
+00026d60: 6978 696e 2e73 696d 6261 5f72 6f69 5f74  ixin.simba_roi_t
+00026d70: 6f5f 6765 6f6d 6574 7269 6573 2872 6563  o_geometries(rec
+00026d80: 7461 6e67 6c65 735f 6466 3d63 6f6e 6669  tangles_df=confi
+00026d90: 672e 7265 6374 616e 676c 6573 5f64 662c  g.rectangles_df,
+00026da0: 2063 6972 636c 6573 5f64 663d 636f 6e66   circles_df=conf
+00026db0: 6967 2e63 6972 636c 6573 5f64 662c 2070  ig.circles_df, p
+00026dc0: 6f6c 7967 6f6e 735f 6466 3d63 6f6e 6669  olygons_df=confi
+00026dd0: 672e 706f 6c79 676f 6e5f 6466 290a 2020  g.polygon_df).  
+00026de0: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+00026df0: 2020 2063 6865 636b 5f69 6e73 7461 6e63     check_instanc
+00026e00: 6528 0a20 2020 2020 2020 2020 2020 2073  e(.            s
+00026e10: 6f75 7263 653d 4765 6f6d 6574 7279 4d69  ource=GeometryMi
+00026e20: 7869 6e2e 7369 6d62 615f 726f 695f 746f  xin.simba_roi_to
+00026e30: 5f67 656f 6d65 7472 6965 732e 5f5f 6e61  _geometries.__na
+00026e40: 6d65 5f5f 2c0a 2020 2020 2020 2020 2020  me__,.          
+00026e50: 2020 696e 7374 616e 6365 3d72 6563 7461    instance=recta
+00026e60: 6e67 6c65 735f 6466 2c0a 2020 2020 2020  ngles_df,.      
+00026e70: 2020 2020 2020 6163 6365 7074 6564 5f74        accepted_t
+00026e80: 7970 6573 3d28 7064 2e44 6174 6146 7261  ypes=(pd.DataFra
+00026e90: 6d65 2c29 2c0a 2020 2020 2020 2020 290a  me,),.        ).
+00026ea0: 2020 2020 2020 2020 6368 6563 6b5f 696e          check_in
+00026eb0: 7374 616e 6365 280a 2020 2020 2020 2020  stance(.        
+00026ec0: 2020 2020 736f 7572 6365 3d47 656f 6d65      source=Geome
+00026ed0: 7472 794d 6978 696e 2e73 696d 6261 5f72  tryMixin.simba_r
+00026ee0: 6f69 5f74 6f5f 6765 6f6d 6574 7269 6573  oi_to_geometries
+00026ef0: 2e5f 5f6e 616d 655f 5f2c 0a20 2020 2020  .__name__,.     
+00026f00: 2020 2020 2020 2069 6e73 7461 6e63 653d         instance=
+00026f10: 6369 7263 6c65 735f 6466 2c0a 2020 2020  circles_df,.    
+00026f20: 2020 2020 2020 2020 6163 6365 7074 6564          accepted
+00026f30: 5f74 7970 6573 3d28 7064 2e44 6174 6146  _types=(pd.DataF
+00026f40: 7261 6d65 2c29 2c0a 2020 2020 2020 2020  rame,),.        
+00026f50: 290a 2020 2020 2020 2020 6368 6563 6b5f  ).        check_
+00026f60: 696e 7374 616e 6365 280a 2020 2020 2020  instance(.      
+00026f70: 2020 2020 2020 736f 7572 6365 3d47 656f        source=Geo
+00026f80: 6d65 7472 794d 6978 696e 2e73 696d 6261  metryMixin.simba
+00026f90: 5f72 6f69 5f74 6f5f 6765 6f6d 6574 7269  _roi_to_geometri
+00026fa0: 6573 2e5f 5f6e 616d 655f 5f2c 0a20 2020  es.__name__,.   
+00026fb0: 2020 2020 2020 2020 2069 6e73 7461 6e63           instanc
+00026fc0: 653d 706f 6c79 676f 6e73 5f64 662c 0a20  e=polygons_df,. 
+00026fd0: 2020 2020 2020 2020 2020 2061 6363 6570             accep
+00026fe0: 7465 645f 7479 7065 733d 2870 642e 4461  ted_types=(pd.Da
+00026ff0: 7461 4672 616d 652c 292c 0a20 2020 2020  taFrame,),.     
+00027000: 2020 2029 0a20 2020 2020 2020 2066 6f72     ).        for
+00027010: 2069 2069 6e20 5b72 6563 7461 6e67 6c65   i in [rectangle
+00027020: 735f 6466 2c20 6369 7263 6c65 735f 6466  s_df, circles_df
+00027030: 2c20 706f 6c79 676f 6e73 5f64 665d 3a0a  , polygons_df]:.
+00027040: 2020 2020 2020 2020 2020 2020 6368 6563              chec
+00027050: 6b5f 7468 6174 5f63 6f6c 756d 6e5f 6578  k_that_column_ex
+00027060: 6973 7428 0a20 2020 2020 2020 2020 2020  ist(.           
+00027070: 2020 2020 2064 663d 692c 2063 6f6c 756d       df=i, colum
+00027080: 6e5f 6e61 6d65 3d5b 2256 6964 656f 222c  n_name=["Video",
+00027090: 2022 4e61 6d65 222c 2022 5461 6773 222c   "Name", "Tags",
+000270a0: 2022 436f 6c6f 7220 4247 5222 5d2c 2066   "Color BGR"], f
+000270b0: 696c 655f 6e61 6d65 3d22 220a 2020 2020  ile_name="".    
+000270c0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000270d0: 2020 7265 7375 6c74 735f 726f 692c 2072    results_roi, r
+000270e0: 6573 756c 7473 5f63 6c72 203d 207b 7d2c  esults_clr = {},
+000270f0: 207b 7d0a 2020 2020 2020 2020 666f 7220   {}.        for 
+00027100: 7669 6465 6f5f 6e61 6d65 2069 6e20 7265  video_name in re
+00027110: 6374 616e 676c 6573 5f64 665b 2256 6964  ctangles_df["Vid
+00027120: 656f 225d 2e75 6e69 7175 6528 293a 0a20  eo"].unique():. 
+00027130: 2020 2020 2020 2020 2020 2069 6620 7669             if vi
+00027140: 6465 6f5f 6e61 6d65 206e 6f74 2069 6e20  deo_name not in 
+00027150: 7265 7375 6c74 735f 726f 692e 6b65 7973  results_roi.keys
+00027160: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+00027170: 2020 2020 7265 7375 6c74 735f 726f 695b      results_roi[
+00027180: 7669 6465 6f5f 6e61 6d65 5d20 3d20 7b7d  video_name] = {}
+00027190: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000271a0: 2072 6573 756c 7473 5f63 6c72 5b76 6964   results_clr[vid
+000271b0: 656f 5f6e 616d 655d 203d 207b 7d0a 2020  eo_name] = {}.  
+000271c0: 2020 2020 2020 2020 2020 7669 6465 6f5f            video_
+000271d0: 7368 6170 6573 203d 2072 6563 7461 6e67  shapes = rectang
+000271e0: 6c65 735f 6466 5b5b 2254 6167 7322 2c20  les_df[["Tags", 
+000271f0: 224e 616d 6522 2c20 2243 6f6c 6f72 2042  "Name", "Color B
+00027200: 4752 225d 5d5b 0a20 2020 2020 2020 2020  GR"]][.         
+00027210: 2020 2020 2020 2072 6563 7461 6e67 6c65         rectangle
+00027220: 735f 6466 5b22 5669 6465 6f22 5d20 3d3d  s_df["Video"] ==
+00027230: 2076 6964 656f 5f6e 616d 650a 2020 2020   video_name.    
+00027240: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
+00027250: 2020 2020 2020 666f 7220 7368 6170 655f        for shape_
+00027260: 6e61 6d65 2069 6e20 7669 6465 6f5f 7368  name in video_sh
+00027270: 6170 6573 5b22 4e61 6d65 225d 2e75 6e69  apes["Name"].uni
+00027280: 7175 6528 293a 0a20 2020 2020 2020 2020  que():.         
+00027290: 2020 2020 2020 2073 6861 7065 5f64 6174         shape_dat
+000272a0: 6120 3d20 7669 6465 6f5f 7368 6170 6573  a = video_shapes
+000272b0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+000272c0: 2020 2020 2020 7669 6465 6f5f 7368 6170        video_shap
+000272d0: 6573 5b22 4e61 6d65 225d 203d 3d20 7368  es["Name"] == sh
+000272e0: 6170 655f 6e61 6d65 0a20 2020 2020 2020  ape_name.       
+000272f0: 2020 2020 2020 2020 205d 2e72 6573 6574           ].reset
+00027300: 5f69 6e64 6578 2864 726f 703d 5472 7565  _index(drop=True
+00027310: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00027320: 2020 7461 6773 2c20 6e61 6d65 203d 2028    tags, name = (
+00027330: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027340: 2020 2020 206c 6973 7428 7368 6170 655f       list(shape_
+00027350: 6461 7461 5b22 5461 6773 225d 2e76 616c  data["Tags"].val
+00027360: 7565 735b 305d 2e76 616c 7565 7328 2929  ues[0].values())
+00027370: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00027380: 2020 2020 2020 7368 6170 655f 6461 7461        shape_data
+00027390: 5b22 4e61 6d65 225d 2e76 616c 7565 735b  ["Name"].values[
+000273a0: 305d 2c0a 2020 2020 2020 2020 2020 2020  0],.            
+000273b0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+000273c0: 2020 2020 2020 7265 7375 6c74 735f 726f        results_ro
+000273d0: 695b 7669 6465 6f5f 6e61 6d65 5d5b 6e61  i[video_name][na
+000273e0: 6d65 5d20 3d20 506f 6c79 676f 6e28 0a20  me] = Polygon(. 
+000273f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027400: 2020 2050 6f6c 7967 6f6e 2874 6167 7329     Polygon(tags)
+00027410: 2e63 6f6e 7665 785f 6875 6c6c 2e65 7874  .convex_hull.ext
+00027420: 6572 696f 722e 636f 6f72 6473 0a20 2020  erior.coords.   
+00027430: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00027440: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00027450: 6573 756c 7473 5f63 6c72 5b76 6964 656f  esults_clr[video
+00027460: 5f6e 616d 655d 5b6e 616d 655d 203d 2073  _name][name] = s
+00027470: 6861 7065 5f64 6174 615b 2243 6f6c 6f72  hape_data["Color
+00027480: 2042 4752 225d 2e76 616c 7565 735b 305d   BGR"].values[0]
+00027490: 0a20 2020 2020 2020 2066 6f72 2076 6964  .        for vid
+000274a0: 656f 5f6e 616d 6520 696e 2070 6f6c 7967  eo_name in polyg
+000274b0: 6f6e 735f 6466 5b22 5669 6465 6f22 5d2e  ons_df["Video"].
+000274c0: 756e 6971 7565 2829 3a0a 2020 2020 2020  unique():.      
+000274d0: 2020 2020 2020 6966 2076 6964 656f 5f6e        if video_n
+000274e0: 616d 6520 6e6f 7420 696e 2072 6573 756c  ame not in resul
+000274f0: 7473 5f72 6f69 2e6b 6579 7328 293a 0a20  ts_roi.keys():. 
+00027500: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00027510: 6573 756c 7473 5f72 6f69 5b76 6964 656f  esults_roi[video
+00027520: 5f6e 616d 655d 203d 207b 7d0a 2020 2020  _name] = {}.    
+00027530: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+00027540: 6c74 735f 636c 725b 7669 6465 6f5f 6e61  lts_clr[video_na
+00027550: 6d65 5d20 3d20 7b7d 0a20 2020 2020 2020  me] = {}.       
+00027560: 2020 2020 2076 6964 656f 5f73 6861 7065       video_shape
+00027570: 7320 3d20 706f 6c79 676f 6e73 5f64 665b  s = polygons_df[
+00027580: 5b22 5461 6773 222c 2022 4e61 6d65 222c  ["Tags", "Name",
+00027590: 2022 436f 6c6f 7220 4247 5222 5d5d 5b0a   "Color BGR"]][.
+000275a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000275b0: 706f 6c79 676f 6e73 5f64 665b 2256 6964  polygons_df["Vid
+000275c0: 656f 225d 203d 3d20 7669 6465 6f5f 6e61  eo"] == video_na
+000275d0: 6d65 0a20 2020 2020 2020 2020 2020 205d  me.            ]
+000275e0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+000275f0: 2073 6861 7065 5f6e 616d 6520 696e 2076   shape_name in v
+00027600: 6964 656f 5f73 6861 7065 735b 224e 616d  ideo_shapes["Nam
+00027610: 6522 5d2e 756e 6971 7565 2829 3a0a 2020  e"].unique():.  
+00027620: 2020 2020 2020 2020 2020 2020 2020 7368                sh
+00027630: 6170 655f 6461 7461 203d 2076 6964 656f  ape_data = video
+00027640: 5f73 6861 7065 735b 0a20 2020 2020 2020  _shapes[.       
+00027650: 2020 2020 2020 2020 2020 2020 2076 6964               vid
+00027660: 656f 5f73 6861 7065 735b 224e 616d 6522  eo_shapes["Name"
+00027670: 5d20 3d3d 2073 6861 7065 5f6e 616d 650a  ] == shape_name.
+00027680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027690: 5d2e 7265 7365 745f 696e 6465 7828 6472  ].reset_index(dr
+000276a0: 6f70 3d54 7275 6529 0a20 2020 2020 2020  op=True).       
+000276b0: 2020 2020 2020 2020 2074 6167 732c 206e           tags, n
+000276c0: 616d 6520 3d20 280a 2020 2020 2020 2020  ame = (.        
+000276d0: 2020 2020 2020 2020 2020 2020 6c69 7374              list
+000276e0: 2873 6861 7065 5f64 6174 615b 2254 6167  (shape_data["Tag
+000276f0: 7322 5d2e 7661 6c75 6573 5b30 5d2e 7661  s"].values[0].va
+00027700: 6c75 6573 2829 292c 0a20 2020 2020 2020  lues()),.       
+00027710: 2020 2020 2020 2020 2020 2020 2073 6861               sha
+00027720: 7065 5f64 6174 615b 224e 616d 6522 5d2e  pe_data["Name"].
+00027730: 7661 6c75 6573 5b30 5d2c 0a20 2020 2020  values[0],.     
+00027740: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00027750: 2020 2020 2020 2020 2020 2020 2072 6573               res
+00027760: 756c 7473 5f72 6f69 5b76 6964 656f 5f6e  ults_roi[video_n
+00027770: 616d 655d 5b6e 616d 655d 203d 2050 6f6c  ame][name] = Pol
+00027780: 7967 6f6e 280a 2020 2020 2020 2020 2020  ygon(.          
+00027790: 2020 2020 2020 2020 2020 506f 6c79 676f            Polygo
+000277a0: 6e28 7461 6773 292e 636f 6e76 6578 5f68  n(tags).convex_h
+000277b0: 756c 6c2e 6578 7465 7269 6f72 2e63 6f6f  ull.exterior.coo
+000277c0: 7264 730a 2020 2020 2020 2020 2020 2020  rds.            
+000277d0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+000277e0: 2020 2020 2020 7265 7375 6c74 735f 636c        results_cl
+000277f0: 725b 7669 6465 6f5f 6e61 6d65 5d5b 6e61  r[video_name][na
+00027800: 6d65 5d20 3d20 7368 6170 655f 6461 7461  me] = shape_data
+00027810: 5b22 436f 6c6f 7220 4247 5222 5d2e 7661  ["Color BGR"].va
+00027820: 6c75 6573 5b30 5d0a 2020 2020 2020 2020  lues[0].        
+00027830: 666f 7220 7669 6465 6f5f 6e61 6d65 2069  for video_name i
+00027840: 6e20 6369 7263 6c65 735f 6466 5b22 5669  n circles_df["Vi
+00027850: 6465 6f22 5d2e 756e 6971 7565 2829 3a0a  deo"].unique():.
+00027860: 2020 2020 2020 2020 2020 2020 6966 2076              if v
+00027870: 6964 656f 5f6e 616d 6520 6e6f 7420 696e  ideo_name not in
+00027880: 2072 6573 756c 7473 5f72 6f69 2e6b 6579   results_roi.key
+00027890: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
+000278a0: 2020 2020 2072 6573 756c 7473 5f72 6f69       results_roi
+000278b0: 5b76 6964 656f 5f6e 616d 655d 203d 207b  [video_name] = {
+000278c0: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
+000278d0: 2020 7265 7375 6c74 735f 636c 725b 7669    results_clr[vi
+000278e0: 6465 6f5f 6e61 6d65 5d20 3d20 7b7d 0a20  deo_name] = {}. 
+000278f0: 2020 2020 2020 2020 2020 2076 6964 656f             video
+00027900: 5f73 6861 7065 7320 3d20 6369 7263 6c65  _shapes = circle
+00027910: 735f 6466 5b5b 2254 6167 7322 2c20 224e  s_df[["Tags", "N
+00027920: 616d 6522 2c20 2243 6f6c 6f72 2042 4752  ame", "Color BGR
+00027930: 225d 5d5b 0a20 2020 2020 2020 2020 2020  "]][.           
+00027940: 2020 2020 2063 6972 636c 6573 5f64 665b       circles_df[
+00027950: 2256 6964 656f 225d 203d 3d20 7669 6465  "Video"] == vide
+00027960: 6f5f 6e61 6d65 0a20 2020 2020 2020 2020  o_name.         
+00027970: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
+00027980: 2066 6f72 2073 6861 7065 5f6e 616d 6520   for shape_name 
+00027990: 696e 2076 6964 656f 5f73 6861 7065 735b  in video_shapes[
+000279a0: 224e 616d 6522 5d2e 756e 6971 7565 2829  "Name"].unique()
+000279b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000279c0: 2020 7368 6170 655f 6461 7461 203d 2076    shape_data = v
+000279d0: 6964 656f 5f73 6861 7065 735b 0a20 2020  ideo_shapes[.   
+000279e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000279f0: 2076 6964 656f 5f73 6861 7065 735b 224e   video_shapes["N
+00027a00: 616d 6522 5d20 3d3d 2073 6861 7065 5f6e  ame"] == shape_n
+00027a10: 616d 650a 2020 2020 2020 2020 2020 2020  ame.            
+00027a20: 2020 2020 5d2e 7265 7365 745f 696e 6465      ].reset_inde
+00027a30: 7828 6472 6f70 3d54 7275 6529 0a20 2020  x(drop=True).   
+00027a40: 2020 2020 2020 2020 2020 2020 2074 6167               tag
+00027a50: 732c 206e 616d 652c 2072 6164 6975 7320  s, name, radius 
+00027a60: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+00027a70: 2020 2020 2020 2020 6c69 7374 2873 6861          list(sha
+00027a80: 7065 5f64 6174 615b 2254 6167 7322 5d2e  pe_data["Tags"].
+00027a90: 7661 6c75 6573 5b30 5d2e 7661 6c75 6573  values[0].values
+00027aa0: 2829 292c 0a20 2020 2020 2020 2020 2020  ()),.           
+00027ab0: 2020 2020 2020 2020 2073 6861 7065 5f64           shape_d
+00027ac0: 6174 615b 224e 616d 6522 5d2e 7661 6c75  ata["Name"].valu
+00027ad0: 6573 5b30 5d2c 0a20 2020 2020 2020 2020  es[0],.         
+00027ae0: 2020 2020 2020 2020 2020 2073 6861 7065             shape
+00027af0: 5f64 6174 615b 2272 6164 6975 7322 5d2e  _data["radius"].
+00027b00: 7661 6c75 6573 5b30 5d2c 0a20 2020 2020  values[0],.     
+00027b10: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00027b20: 2020 2020 2020 2020 2020 2020 2072 6573               res
+00027b30: 756c 7473 5f72 6f69 5b76 6964 656f 5f6e  ults_roi[video_n
+00027b40: 616d 655d 5b6e 616d 655d 203d 2050 6f69  ame][name] = Poi
+00027b50: 6e74 2874 6167 735b 2243 656e 7465 7220  nt(tags["Center 
+00027b60: 7461 6722 5d29 2e62 7566 6665 7228 0a20  tag"]).buffer(. 
+00027b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027b80: 2020 2064 6973 7461 6e63 653d 7261 6469     distance=radi
+00027b90: 7573 0a20 2020 2020 2020 2020 2020 2020  us.             
+00027ba0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00027bb0: 2020 2020 2072 6573 756c 7473 5f63 6c72       results_clr
+00027bc0: 5b76 6964 656f 5f6e 616d 655d 5b6e 616d  [video_name][nam
+00027bd0: 655d 203d 2073 6861 7065 5f64 6174 615b  e] = shape_data[
+00027be0: 2243 6f6c 6f72 2042 4752 225d 2e76 616c  "Color BGR"].val
+00027bf0: 7565 735b 305d 0a20 2020 2020 2020 2069  ues[0].        i
+00027c00: 6620 6e6f 7420 636f 6c6f 723a 0a20 2020  f not color:.   
+00027c10: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00027c20: 7265 7375 6c74 735f 726f 692c 204e 6f6e  results_roi, Non
+00027c30: 650a 2020 2020 2020 2020 656c 7365 3a0a  e.        else:.
+00027c40: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00027c50: 726e 2072 6573 756c 7473 5f72 6f69 2c20  rn results_roi, 
+00027c60: 7265 7375 6c74 735f 636c 720a 0a20 2020  results_clr..   
+00027c70: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
+00027c80: 2020 2064 6566 2066 696c 7465 725f 6c6f     def filter_lo
+00027c90: 775f 705f 6270 735f 666f 725f 7368 6170  w_p_bps_for_shap
+00027ca0: 6573 2878 3a20 6e70 2e6e 6461 7272 6179  es(x: np.ndarray
+00027cb0: 2c20 703a 206e 702e 6e64 6172 7261 792c  , p: np.ndarray,
+00027cc0: 2074 6872 6573 686f 6c64 3a20 666c 6f61   threshold: floa
+00027cd0: 7429 3a0a 2020 2020 2020 2020 2222 220a  t):.        """.
+00027ce0: 2020 2020 2020 2020 4669 6c74 6572 2062          Filter b
+00027cf0: 6f64 792d 7061 7274 2064 6174 6120 666f  ody-part data fo
+00027d00: 7220 6765 6f6d 6574 7279 2063 6f6e 7374  r geometry const
+00027d10: 7275 6374 696f 6e20 7768 696c 6520 6d61  ruction while ma
+00027d20: 696e 7461 696e 696e 6720 7661 6c69 6420  intaining valid 
+00027d30: 6765 6f6d 6574 7279 2061 7272 6179 732e  geometry arrays.
+00027d40: 0a0a 2020 2020 2020 2020 4861 7669 6e67  ..        Having
+00027d50: 2061 2033 4420 6172 7261 7920 7265 7072   a 3D array repr
+00027d60: 6573 656e 7469 6e67 2062 6f64 792d 7061  esenting body-pa
+00027d70: 7274 7320 6163 726f 7373 2074 696d 652c  rts across time,
+00027d80: 2061 6e64 2061 2073 6563 6f6e 6420 3344   and a second 3D
+00027d90: 2061 7272 6179 2072 6570 7265 7365 6e74   array represent
+00027da0: 696e 6720 7072 6f62 6162 696c 6974 6965  ing probabilitie
+00027db0: 7320 6f66 2074 686f 7365 0a20 2020 2020  s of those.     
+00027dc0: 2020 2062 6f64 792d 7061 7274 7320 6163     body-parts ac
+00027dd0: 726f 7373 2074 696d 652c 2077 6520 7761  ross time, we wa
+00027de0: 6e74 2074 6f20 2272 656d 6f76 6522 2062  nt to "remove" b
+00027df0: 6f64 792d 7061 7274 7320 7769 7468 206c  ody-parts with l
+00027e00: 6f77 2064 6574 6563 7469 6f6e 2070 726f  ow detection pro
+00027e10: 6261 6269 6c69 7469 6573 2077 6869 6c73  babilities whils
+00027e20: 7420 616c 736f 206b 6565 7069 6e67 2074  t also keeping t
+00027e30: 6865 2061 7272 6179 2073 697a 6573 0a20  he array sizes. 
+00027e40: 2020 2020 2020 2069 6e74 6163 7420 616e         intact an
+00027e50: 6420 7375 6974 6162 6c65 2066 6f72 2067  d suitable for g
+00027e60: 656f 6d65 7472 7920 636f 6e73 7472 7563  eometry construc
+00027e70: 7469 6f6e 2e20 546f 2064 6f20 7468 6973  tion. To do this
+00027e80: 2c20 7765 2066 696e 6420 626f 6479 2d70  , we find body-p
+00027e90: 6172 7473 2077 6974 6820 6465 7465 6374  arts with detect
+00027ea0: 696f 6e20 7072 6f62 6162 696c 6974 6965  ion probabilitie
+00027eb0: 7320 6265 6c6f 7720 7468 6520 7468 7265  s below the thre
+00027ec0: 7368 6f6c 642c 2061 6e64 2072 6570 6c61  shold, and repla
+00027ed0: 6365 2074 6865 7365 2077 6974 6820 6120  ce these with a 
+00027ee0: 626f 6479 2d70 6172 740a 2020 2020 2020  body-part.      
+00027ef0: 2020 7468 6174 2064 6f65 736e 2774 2066    that doesn't f
+00027f00: 616c 6c20 6265 6c6f 7720 7468 6520 6465  all below the de
+00027f10: 7465 6374 696f 6e20 7072 6f62 6162 696c  tection probabil
+00027f20: 6974 7920 7468 7265 7368 6f6c 6420 7769  ity threshold wi
+00027f30: 7468 696e 2074 6865 2073 616d 6520 6672  thin the same fr
+00027f40: 616d 652e 2048 6f77 6576 6572 2c20 746f  ame. However, to
+00027f50: 2063 6f6e 7374 7275 6374 2061 2067 656f   construct a geo
+00027f60: 6d65 7472 792c 2077 6520 6e65 6564 203e  metry, we need >
+00027f70: 3d20 3320 756e 6971 7565 206b 6579 2d70  = 3 unique key-p
+00027f80: 6f69 6e74 206c 6f63 6174 696f 6e73 2e0a  oint locations..
+00027f90: 2020 2020 2020 2020 5468 7573 2c20 6e6f          Thus, no
+00027fa0: 2073 7562 7374 6974 7574 696f 6e20 6361   substitution ca
+00027fb0: 6e20 6265 206d 6164 6520 746f 2077 6865  n be made to whe
+00027fc0: 6e20 7468 6572 6520 6172 6520 6c65 7373  n there are less
+00027fd0: 2074 6861 6e20 7468 7265 6520 756e 6971   than three uniq
+00027fe0: 7565 2062 6f64 792d 7061 7274 206c 6f63  ue body-part loc
+00027ff0: 6174 696f 6e73 2077 6974 6869 6e20 6120  ations within a 
+00028000: 6672 616d 6520 7468 6174 2066 616c 6c73  frame that falls
+00028010: 2061 626f 7665 2074 6865 2074 6872 6573   above the thres
+00028020: 686f 6c64 2e0a 0a20 2020 2020 2020 203a  hold...        :
+00028030: 6578 616d 706c 653a 0a20 2020 2020 2020  example:.       
+00028040: 203e 3e3e 2078 203d 206e 702e 7261 6e64   >>> x = np.rand
+00028050: 6f6d 2e72 616e 6469 6e74 2830 2c20 3530  om.randint(0, 50
+00028060: 302c 2028 3138 3030 302c 2037 2c20 3229  0, (18000, 7, 2)
+00028070: 290a 2020 2020 2020 2020 3e3e 3e20 7020  ).        >>> p 
+00028080: 3d20 6e70 2e72 616e 646f 6d2e 7261 6e64  = np.random.rand
+00028090: 6f6d 2873 697a 653d 2831 3830 3030 2c20  om(size=(18000, 
+000280a0: 372c 2031 2929 0a20 2020 2020 2020 203e  7, 1)).        >
+000280b0: 3e3e 2078 203d 2047 656f 6d65 7472 794d  >> x = GeometryM
+000280c0: 6978 696e 2e66 696c 7465 725f 6c6f 775f  ixin.filter_low_
+000280d0: 705f 6270 735f 666f 725f 7368 6170 6573  p_bps_for_shapes
+000280e0: 2878 3d78 2c20 703d 702c 2074 6872 6573  (x=x, p=p, thres
+000280f0: 686f 6c64 3d30 2e31 290a 2020 2020 2020  hold=0.1).      
+00028100: 2020 3e3e 3e20 7820 3d20 782e 7265 7368    >>> x = x.resh
+00028110: 6170 6528 782e 7368 6170 655b 305d 2c20  ape(x.shape[0], 
+00028120: 696e 7428 782e 7368 6170 655b 315d 202a  int(x.shape[1] *
+00028130: 2032 2929 0a20 2020 2020 2020 2022 2222   2)).        """
+00028140: 0a0a 2020 2020 2020 2020 7265 7375 6c74  ..        result
+00028150: 7320 3d20 6e70 2e63 6f70 7928 7829 0a20  s = np.copy(x). 
+00028160: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+00028170: 7261 6e67 6528 782e 7368 6170 655b 305d  range(x.shape[0]
+00028180: 293a 0a20 2020 2020 2020 2020 2020 2062  ):.            b
+00028190: 656c 6f77 5f70 5f69 6478 203d 206e 702e  elow_p_idx = np.
+000281a0: 6172 6777 6865 7265 2870 5b69 5d2e 666c  argwhere(p[i].fl
+000281b0: 6174 7465 6e28 2920 3c20 7468 7265 7368  atten() < thresh
+000281c0: 6f6c 6429 2e66 6c61 7474 656e 2829 0a20  old).flatten(). 
+000281d0: 2020 2020 2020 2020 2020 2061 626f 7665             above
+000281e0: 5f70 5f69 6478 203d 206e 702e 6172 6777  _p_idx = np.argw
+000281f0: 6865 7265 2870 5b69 5d2e 666c 6174 7465  here(p[i].flatte
+00028200: 6e28 2920 3e3d 2074 6872 6573 686f 6c64  n() >= threshold
+00028210: 292e 666c 6174 7465 6e28 290a 2020 2020  ).flatten().    
+00028220: 2020 2020 2020 2020 6966 2028 6265 6c6f          if (belo
+00028230: 775f 705f 6964 782e 7368 6170 655b 305d  w_p_idx.shape[0]
+00028240: 203e 2030 2920 616e 6420 2861 626f 7665   > 0) and (above
+00028250: 5f70 5f69 6478 2e73 6861 7065 5b30 5d20  _p_idx.shape[0] 
+00028260: 3e3d 2033 293a 0a20 2020 2020 2020 2020  >= 3):.         
+00028270: 2020 2020 2020 2066 6f72 206a 2069 6e20         for j in 
+00028280: 6265 6c6f 775f 705f 6964 783a 0a20 2020  below_p_idx:.   
+00028290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000282a0: 206e 6577 5f76 616c 203d 2078 5b69 5d5b   new_val = x[i][
+000282b0: 6162 6f76 655f 705f 6964 785b 305d 5d0a  above_p_idx[0]].
+000282c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000282d0: 2020 2020 7265 7375 6c74 735b 695d 5b6a      results[i][j
+000282e0: 5d20 3d20 6e65 775f 7661 6c0a 2020 2020  ] = new_val.    
+000282f0: 2020 2020 7265 7475 726e 2072 6573 756c      return resul
+00028300: 7473 0a0a 0a23 2064 6174 6120 3d20 6e70  ts...# data = np
+00028310: 2e61 7272 6179 285b 5b5b 3336 342c 2033  .array([[[364, 3
+00028320: 3038 5d2c 205b 3338 332c 2033 3233 5d2c  08], [383, 323],
+00028330: 205b 3430 332c 2033 3335 5d2c 205b 3432   [403, 335], [42
+00028340: 332c 2033 3531 5d5d 2c0a 2320 2020 2020  3, 351]],.#     
+00028350: 2020 2020 2020 2020 2020 2020 205b 5b33               [[3
+00028360: 3536 2c20 3330 375d 2c20 5b33 3736 2c20  56, 307], [376, 
+00028370: 3331 395d 2c20 5b33 3936 2c20 3333 315d  319], [396, 331]
+00028380: 2c20 5b34 3139 2c20 3334 375d 5d2c 0a23  , [419, 347]],.#
+00028390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000283a0: 2020 5b5b 3336 342c 2033 3038 5d2c 205b    [[364, 308], [
+000283b0: 3338 332c 2033 3233 5d2c 205b 3430 332c  383, 323], [403,
+000283c0: 2033 3335 5d2c 205b 3432 332c 2033 3531   335], [423, 351
+000283d0: 5d5d 2c0a 2320 2020 2020 2020 2020 2020  ]],.#           
+000283e0: 2020 2020 2020 205b 5b33 3634 2c20 3330         [[364, 30
+000283f0: 385d 2c20 5b33 2c20 3332 335d 2c20 5b34  8], [3, 323], [4
+00028400: 3033 2c20 3333 355d 2c20 5b34 3233 2c20  03, 335], [423, 
+00028410: 3335 315d 5d2c 0a23 2020 2020 2020 2020  351]],.#        
+00028420: 2020 2020 2020 2020 2020 5b5b 3336 342c            [[364,
+00028430: 2033 3038 5d2c 205b 3338 332c 2033 3233   308], [383, 323
+00028440: 5d2c 205b 3534 2c20 3333 355d 2c20 5b34  ], [54, 335], [4
+00028450: 3233 2c20 3335 315d 5d2c 0a23 2020 2020  23, 351]],.#    
+00028460: 2020 2020 2020 2020 2020 2020 2020 5b5b                [[
+00028470: 3132 2c20 3330 385d 2c20 5b33 3833 2c20  12, 308], [383, 
+00028480: 3334 5d2c 205b 3430 332c 2033 3335 5d2c  34], [403, 335],
+00028490: 205b 3432 332c 2033 3531 5d5d 2c0a 2320   [423, 351]],.# 
+000284a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000284b0: 205b 5b33 3634 2c20 3330 385d 2c20 5b33   [[364, 308], [3
+000284c0: 3833 2c20 3332 335d 2c20 5b34 3033 2c20  83, 323], [403, 
+000284d0: 3333 355d 2c20 5b31 3030 2c20 3335 315d  335], [100, 351]
+000284e0: 5d5d 290a 2320 4765 6f6d 6574 7279 4d69  ]]).# GeometryMi
+000284f0: 7869 6e28 292e 6d75 6c74 6966 7261 6d65  xin().multiframe
+00028500: 5f62 6f64 7970 6172 7473 5f74 6f5f 706f  _bodyparts_to_po
+00028510: 6c79 676f 6e28 6461 7461 3d64 6174 6129  lygon(data=data)
+00028520: 0a0a 230a 2320 706f 6c79 676f 6e5f 3120  ..#.# polygon_1 
+00028530: 3d20 4765 6f6d 6574 7279 4d69 7869 6e28  = GeometryMixin(
+00028540: 292e 626f 6479 7061 7274 735f 746f 5f70  ).bodyparts_to_p
+00028550: 6f6c 7967 6f6e 286e 702e 6172 7261 7928  olygon(np.array(
+00028560: 5b5b 3336 342c 2033 3038 5d2c 5b33 3833  [[364, 308],[383
+00028570: 2c20 3332 335d 2c5b 3430 332c 2033 3335  , 323],[403, 335
+00028580: 5d2c 5b34 3233 2c20 3335 315d 5d29 290a  ],[423, 351]])).
+00028590: 2320 706f 6c79 676f 6e5f 3220 3d20 4765  # polygon_2 = Ge
+000285a0: 6f6d 6574 7279 4d69 7869 6e28 292e 626f  ometryMixin().bo
+000285b0: 6479 7061 7274 735f 746f 5f70 6f6c 7967  dyparts_to_polyg
+000285c0: 6f6e 286e 702e 6172 7261 7928 5b5b 3335  on(np.array([[35
+000285d0: 362c 2033 3037 5d2c 5b33 3736 2c20 3331  6, 307],[376, 31
+000285e0: 395d 2c5b 3339 362c 2033 3331 5d2c 5b34  9],[396, 331],[4
+000285f0: 3139 2c20 3334 375d 5d29 290a 2320 706f  19, 347]])).# po
+00028600: 6c79 676f 6e5f 3120 3d20 5b70 6f6c 7967  lygon_1 = [polyg
+00028610: 6f6e 5f31 2066 6f72 2078 2069 6e20 7261  on_1 for x in ra
+00028620: 6e67 6528 3130 3029 5d0a 2320 706f 6c79  nge(100)].# poly
+00028630: 676f 6e5f 3220 3d20 5b70 6f6c 7967 6f6e  gon_2 = [polygon
+00028640: 5f32 2066 6f72 2078 2069 6e20 7261 6e67  _2 for x in rang
+00028650: 6528 3130 3029 5d0a 2320 6461 7461 203d  e(100)].# data =
+00028660: 206e 702e 636f 6c75 6d6e 5f73 7461 636b   np.column_stack
+00028670: 2828 706f 6c79 676f 6e5f 312c 2070 6f6c  ((polygon_1, pol
+00028680: 7967 6f6e 5f32 2929 0a23 2047 656f 6d65  ygon_2)).# Geome
+00028690: 7472 794d 6978 696e 2e63 6f6d 7075 7465  tryMixin.compute
+000286a0: 5f70 6374 5f73 6861 7065 5f6f 7665 726c  _pct_shape_overl
+000286b0: 6170 2873 6861 7065 733d 6461 7461 290a  ap(shapes=data).
+000286c0: 230a 230a 230a 2320 6461 7461 203d 206e  #.#.#.# data = n
+000286d0: 702e 6172 7261 795f 7370 6c69 7428 6461  p.array_split(da
+000286e0: 7461 2c20 3829 0a23 0a23 0a23 0a23 2072  ta, 8).#.#.#.# r
+000286f0: 6573 756c 7473 203d 2047 656f 6d65 7472  esults = Geometr
+00028700: 794d 6978 696e 2829 2e6d 756c 7469 6672  yMixin().multifr
+00028710: 616d 655f 636f 6d70 7574 655f 7063 745f  ame_compute_pct_
+00028720: 7368 6170 655f 6f76 6572 6c61 7028 7368  shape_overlap(sh
+00028730: 6170 655f 313d 706f 6c79 676f 6e5f 312c  ape_1=polygon_1,
+00028740: 2073 6861 7065 5f32 3d70 6f6c 7967 6f6e   shape_2=polygon
+00028750: 5f32 2c29 0a23 0a23 206e 702e 0a0a 2320  _2,).#.# np...# 
+00028760: 706f 6c79 676f 6e5f 3120 3d20 4765 6f6d  polygon_1 = Geom
+00028770: 6574 7279 4d69 7869 6e28 292e 626f 6479  etryMixin().body
+00028780: 7061 7274 735f 746f 5f70 6f6c 7967 6f6e  parts_to_polygon
+00028790: 286e 702e 6172 7261 7928 5b5b 302c 2031  (np.array([[0, 1
+000287a0: 3030 5d2c 5b31 3030 2c20 3130 305d 2c5b  00],[100, 100],[
+000287b0: 302c 2030 5d2c 5b31 3030 2c20 305d 5d29  0, 0],[100, 0]])
+000287c0: 290a 2320 706f 6c79 676f 6e5f 3220 3d20  ).# polygon_2 = 
+000287d0: 4765 6f6d 6574 7279 4d69 7869 6e28 292e  GeometryMixin().
+000287e0: 626f 6479 7061 7274 735f 746f 5f70 6f6c  bodyparts_to_pol
+000287f0: 7967 6f6e 286e 702e 6172 7261 7928 5b5b  ygon(np.array([[
+00028800: 3235 2c20 3735 5d2c 5b37 352c 2037 355d  25, 75],[75, 75]
+00028810: 2c5b 3235 2c20 3235 5d2c 5b37 352c 2032  ,[25, 25],[75, 2
+00028820: 355d 5d29 290a 2320 7920 3d20 4765 6f6d  5]])).# y = Geom
+00028830: 6574 7279 4d69 7869 6e28 292e 636f 6d70  etryMixin().comp
+00028840: 7574 655f 7063 745f 7368 6170 655f 6f76  ute_pct_shape_ov
+00028850: 6572 6c61 7028 7368 6170 6573 3d5b 706f  erlap(shapes=[po
+00028860: 6c79 676f 6e5f 312c 2070 6f6c 7967 6f6e  lygon_1, polygon
+00028870: 5f32 5d2c 2064 656e 6f6d 696e 6174 6f72  _2], denominator
+00028880: 3d27 7368 6170 655f 3227 290a            ='shape_2').
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/mixins/feature_extraction_circular_mixin.py` & `Simba-UW-tf-dev-1.89.5/simba/mixins/feature_extraction_circular_mixin.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/third_party_label_appenders/deepethogram_importer.py` & `Simba-UW-tf-dev-1.89.5/simba/third_party_label_appenders/deepethogram_importer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/third_party_label_appenders/BORIS_appender.py` & `Simba-UW-tf-dev-1.89.5/simba/third_party_label_appenders/BORIS_appender.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/third_party_label_appenders/observer_importer.py` & `Simba-UW-tf-dev-1.89.5/simba/third_party_label_appenders/observer_importer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/third_party_label_appenders/.DS_Store` & `Simba-UW-tf-dev-1.89.5/simba/third_party_label_appenders/.DS_Store`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/third_party_label_appenders/boris_source_cleaner.py` & `Simba-UW-tf-dev-1.89.5/simba/third_party_label_appenders/boris_source_cleaner.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/third_party_label_appenders/tools.py` & `Simba-UW-tf-dev-1.89.5/simba/third_party_label_appenders/tools.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/third_party_label_appenders/third_party_appender.py` & `Simba-UW-tf-dev-1.89.5/simba/third_party_label_appenders/third_party_appender.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/third_party_label_appenders/ethovision_import.py` & `Simba-UW-tf-dev-1.89.5/simba/third_party_label_appenders/ethovision_import.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/third_party_label_appenders/BENTO_appender.py` & `Simba-UW-tf-dev-1.89.5/simba/third_party_label_appenders/BENTO_appender.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/third_party_label_appenders/solomon_importer.py` & `Simba-UW-tf-dev-1.89.5/simba/third_party_label_appenders/solomon_importer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/cue_light_tools/cue_light_clf_statistics.py` & `Simba-UW-tf-dev-1.89.5/simba/cue_light_tools/cue_light_clf_statistics.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/cue_light_tools/cue_light_analyzer.py` & `Simba-UW-tf-dev-1.89.5/simba/cue_light_tools/cue_light_analyzer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/cue_light_tools/cue_light_menues.py` & `Simba-UW-tf-dev-1.89.5/simba/cue_light_tools/cue_light_menues.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/cue_light_tools/cue_light_tools.py` & `Simba-UW-tf-dev-1.89.5/simba/cue_light_tools/cue_light_tools.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/cue_light_tools/cue_light_visualizer.py` & `Simba-UW-tf-dev-1.89.5/simba/cue_light_tools/cue_light_visualizer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/cue_light_tools/cue_light_movement_statistics.py` & `Simba-UW-tf-dev-1.89.5/simba/cue_light_tools/cue_light_movement_statistics.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/utils/config_creator.py` & `Simba-UW-tf-dev-1.89.5/simba/utils/config_creator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/utils/enums.py` & `Simba-UW-tf-dev-1.89.5/simba/utils/enums.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/utils/custom_feature_extractor.py` & `Simba-UW-tf-dev-1.89.5/simba/utils/custom_feature_extractor.py`

 * *Files 1% similar despite different names*

```diff
@@ -207,15 +207,15 @@
             command = f'python "{self.extractor_file_path}" --config_path "{self.config_path}"'
             print(
                 "Follow feature extraction progress in the operating system terminal window..."
             )
             subprocess.call(command, shell=True)
 
         else:
-            print(has_abstract_inheritance)
+            print("Running user-defined feature extraction class...")
             spec = importlib.util.spec_from_file_location(
                 class_name, self.extractor_file_path
             )
             user_module = importlib.util.module_from_spec(spec)
             sys.modules[class_name] = user_module
             spec.loader.exec_module(user_module)
             user_class = getattr(user_module, class_name)
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/utils/.DS_Store` & `Simba-UW-tf-dev-1.89.5/simba/utils/.DS_Store`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/utils/warnings.py` & `Simba-UW-tf-dev-1.89.5/simba/utils/warnings.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/utils/checks.py` & `Simba-UW-tf-dev-1.89.5/simba/utils/checks.py`

 * *Files 2% similar despite different names*

```diff
@@ -11,16 +11,16 @@
 import numpy as np
 import pandas as pd
 import trafaret as t
 
 from simba.utils.enums import Keys, Options, UMAPParam
 from simba.utils.errors import (ArrayError, ColumnNotFoundError,
                                 CorruptedFileError, CountError,
-                                DirectoryNotEmptyError, FloatError,
-                                IntegerError, InvalidFilepathError,
+                                DirectoryNotEmptyError, FFMPEGNotFoundError,
+                                FloatError, IntegerError, InvalidFilepathError,
                                 InvalidInputError, NoDataError,
                                 NoFilesFoundError, NoROIDataError,
                                 NotDirectoryError, ParametersFileError,
                                 StringError)
 from simba.utils.warnings import NoDataFoundWarning
 
 
@@ -300,26 +300,35 @@
             missing_videos.append(video_name)
     if len(missing_videos) > 0:
         raise ParametersFileError(
             msg=f"SimBA could not find {len(missing_videos)} video(s) in the video_info.csv file. Make sure all videos analyzed are represented in the project_folder/logs/video_info.csv file. MISSING VIDEOS: {missing_videos}"
         )
 
 
-def check_if_dir_exists(in_dir: Union[str, os.PathLike]) -> None:
+def check_if_dir_exists(
+    in_dir: Union[str, os.PathLike], source: Optional[str] = None
+) -> None:
     """
     Check if a directory path exists.
 
-    :param str in_dir: Putative directory path.
+    :param Union[str, os.PathLike] in_dir: Putative directory path.
+    :param str source: String source for interpretable error messaging.
     :raise NotDirectoryError: The directory does not exist.
     """
+
     if not os.path.isdir(in_dir):
-        raise NotDirectoryError(
-            msg=f"{in_dir} is not a valid directory",
-            source=check_if_dir_exists.__name__,
-        )
+        if source is None:
+            raise NotDirectoryError(
+                msg=f"{in_dir} is not a valid directory",
+                source=check_if_dir_exists.__name__,
+            )
+        else:
+            raise NotDirectoryError(
+                msg=f"{in_dir} is not a valid directory", source=source
+            )
 
 
 def check_that_column_exist(
     df: pd.DataFrame, column_name: Union[str, os.PathLike, List[str]], file_name: str
 ) -> None:
     """
     Check if single named field or a list of fields exist within a dataframe.
@@ -503,25 +512,32 @@
     try:
         subprocess.check_output("nvidia-smi")
         return True
     except Exception:
         return False
 
 
-def check_ffmpeg_available() -> bool:
+def check_ffmpeg_available(raise_error: Optional[bool] = False) -> Union[bool, None]:
     """
     Helper to check of FFMpeg is available via subprocess ``ffmpeg``.
 
-    returns bool: True if ``ffmpeg`` returns not None. Else False.
+    :param Optional[bool] raise_error: If True, raises ``FFMPEGNotFoundError`` if FFmpeg can't be found. Else return False. Default False.
+    :returns bool: True if ``ffmpeg`` returns not None and raise_error is False. Else False.
     """
+
     try:
         subprocess.call("ffmpeg", stderr=subprocess.DEVNULL, stdout=subprocess.DEVNULL)
         return True
     except Exception:
-        return False
+        if raise_error:
+            raise FFMPEGNotFoundError(
+                msg="FFMpeg could not be found on the instance (as evaluated via subprocess ffmpeg). Please make sure FFMpeg is installed."
+            )
+        else:
+            return False
 
 
 def check_if_valid_rgb_str(
     input: str,
     delimiter: str = ",",
     return_cleaned_rgb_tuple: bool = True,
     reverse_returned: bool = True,
@@ -865,15 +881,15 @@
         check_int(name=f"{source} max_axis_1", value=max_axis_1)
         if data.shape[1] > max_axis_1:
             raise ArrayError(
                 msg=f"Array not of acceptable shape. Found  {data.shape[1]} columns, maximum columns accepted: {max_axis_1}, {source}",
                 source=check_valid_array.__name__,
             )
     if min_axis_1 is not None:
-        check_int(name=f"{source} min_axis_1", value=max_axis_1)
+        check_int(name=f"{source} min_axis_1", value=min_axis_1)
         if data.shape[1] < min_axis_1:
             raise ArrayError(
                 msg=f"Array not of acceptable shape. Found  {data.shape[1]} columns, minimum columns accepted: {min_axis_1}, {source}",
                 source=check_valid_array.__name__,
             )
 
 
@@ -1173,27 +1189,28 @@
     return True
 
 
 def check_valid_dataframe(
     df: pd.DataFrame,
     source: Optional[str] = "",
     valid_dtypes: Optional[Tuple[Any]] = None,
+    required_fields: Optional[List[str]] = None,
     min_axis_0: Optional[int] = None,
     min_axis_1: Optional[int] = None,
     max_axis_0: Optional[int] = None,
     max_axis_1: Optional[int] = None,
 ):
     """Helper to check if a dataframe is valid"""
     check_instance(source=source, instance=df, accepted_types=(pd.DataFrame,))
     if valid_dtypes is not None:
         dtypes = list(set(df.dtypes))
         additional = [x for x in dtypes if x not in valid_dtypes]
         if len(additional) > 0:
             raise InvalidInputError(
-                msg=f"The dataframe {source} has invalid data format(s) {additional}.",
+                msg=f"The dataframe {source} has invalid data format(s) {additional}. Valid: {valid_dtypes}",
                 source=source,
             )
     if min_axis_1 is not None:
         check_int(name=f"{source} min_axis_1", value=min_axis_1, min_value=1)
         if len(df.columns) < min_axis_1:
             raise InvalidInputError(
                 msg=f"The dataframe {source} has less than ({df.columns}) the required minimum number of columns ({min_axis_1}).",
@@ -1216,7 +1233,46 @@
     if max_axis_1 is not None:
         check_int(name=f"{source} max_axis_1", value=min_axis_1, min_value=1)
         if len(df.columns) > max_axis_1:
             raise InvalidInputError(
                 msg=f"The dataframe {source} has more than ({df.columns}) the required maximum number of columns ({max_axis_1}).",
                 source=source,
             )
+    if required_fields is not None:
+        check_valid_lst(
+            data=required_fields,
+            source=check_valid_dataframe.__name__,
+            valid_dtypes=(str,),
+        )
+        missing = list(set(required_fields) - set(df.columns))
+        if len(missing) > 0:
+            raise InvalidInputError(
+                msg=f"The dataframe {source} are missing required columns {missing}.",
+                source=source,
+            )
+
+
+def check_valid_tuple(
+    x: tuple,
+    source: Optional[str] = "",
+    accepted_lengths: Optional[Tuple[int]] = None,
+    valid_dtypes: Optional[Tuple[Any]] = None,
+):
+    if not isinstance(x, (tuple)):
+        raise InvalidInputError(
+            msg=f"{check_valid_tuple.__name__} {source} is not a valid tuple",
+            source=source,
+        )
+    if accepted_lengths is not None:
+        if len(x) not in accepted_lengths:
+            raise InvalidInputError(
+                msg=f"Tuple is not of valid lengths. Found {len(x)}. Accepted: {accepted_lengths}",
+                source=source,
+            )
+    if valid_dtypes is not None:
+        dtypes = list(set([type(v) for v in x]))
+        additional = [x for x in dtypes if x not in valid_dtypes]
+        if len(additional) > 0:
+            raise InvalidInputError(
+                msg=f"The tuple {source} has invalid data format(s) {additional}. Valid: {valid_dtypes}",
+                source=source,
+            )
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/utils/read_write.py` & `Simba-UW-tf-dev-1.89.5/simba/utils/read_write.py`

 * *Files 1% similar despite different names*

```diff
@@ -4,14 +4,15 @@
 import glob
 import multiprocessing
 import os
 import pickle
 import platform
 import re
 import shutil
+import subprocess
 import threading
 import webbrowser
 from configparser import ConfigParser
 from datetime import datetime, timedelta
 from pathlib import Path
 from typing import Any, Dict, Iterable, List, Optional, Tuple, Union
 from urllib.parse import urlparse
@@ -629,19 +630,20 @@
         if i.lower().endswith(video_formats):
             video_lst.append(i)
     if not video_lst:
         if raise_error:
             raise NoFilesFoundError(
                 f"No videos found in directory {directory} in formats {video_formats}."
             )
-        video_lst.append("No videos found")
-        NoFileFoundWarning(
-            msg=f"No videos found in directory ({directory})",
-            source=find_all_videos_in_directory.__name__,
-        )
+        else:
+            video_lst.append("No videos found")
+            NoFileFoundWarning(
+                msg=f"No videos found in directory ({directory})",
+                source=find_all_videos_in_directory.__name__,
+            )
 
     if video_lst and as_dict:
         video_dict = {}
         for video_name in video_lst:
             video_path = os.path.join(directory, video_name)
             _, name, _ = get_fn_ext(filepath=video_path)
             video_dict[name] = video_path
@@ -1890,12 +1892,49 @@
             raise IntegerError(
                 msg=f"{name} has {cnt} unique observations, but no more than {max} unique observations is allowed for the operation.",
                 source=get_unique_values_in_iterable.__name__,
             )
     return cnt
 
 
-# def kbd_listener() -> KeyboardListener:
-#     kbd_listener = KeyboardListener()
-#     monitor_thread = threading.Thread(target=kbd_listener.start)
-#     monitor_thread.start()
-#     return kbd_listener
+def copy_files_to_directory(
+    file_paths: List[Union[str, os.PathLike]],
+    dir: Union[str, os.PathLike],
+    verbose: Optional[bool] = True,
+    integer_save_names: Optional[bool] = False,
+) -> List[Union[str, os.PathLike]]:
+    """
+    Copy a list of files to a specified directory.
+
+    :param List[Union[str, os.PathLike]] file_paths: List of paths to the files to be copied.
+    :param Union[str, os.PathLike] dir: Path to the directory where files will be copied.
+    :param Optional[bool] verbose: If True, prints progress information. Default True.
+    :param Optional[bool] integer_save_names: If True, saves files with integer names. E.g., file one in ``file_paths`` will be saved as dir/0.
+    :return List[Union[str, os.PathLike]]: List of paths to the copied files
+    """
+
+    check_valid_lst(data=file_paths, source=copy_files_to_directory.__name__, min_len=1)
+    _ = [check_file_exist_and_readable(x) for x in file_paths]
+    check_if_dir_exists(in_dir=dir, source=copy_files_to_directory)
+    destinations = []
+    for cnt, file_path in enumerate(file_paths):
+        if verbose:
+            print(
+                f"Copying file {os.path.basename(file_path)} ({cnt+1}/{len(file_paths)})..."
+            )
+        if not integer_save_names:
+            destination = os.path.join(dir, os.path.basename(file_path))
+        else:
+            _, file_name, ext = get_fn_ext(filepath=file_path)
+            destination = os.path.join(dir, f"{cnt}{ext}")
+        try:
+            if os.path.isfile(destination):
+                os.remove(destination)
+        except Exception as e:
+            print(e.args)
+            raise PermissionError(
+                msg=f"Not allowed to overwrite file {destination}. Try running SimBA in terminal opened in admin mode or delete existing file before copying.",
+                source=copy_files_to_directory.__name__,
+            )
+        destinations.append(destination)
+        shutil.copy(file_path, destination)
+    return destinations
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/utils/lookups.py` & `Simba-UW-tf-dev-1.89.5/simba/utils/lookups.py`

 * *Files 0% similar despite different names*

```diff
@@ -336,14 +336,15 @@
         "coral",
         "lavender",
         "sienna",
         "tomato",
         "grey",
         "azure",
         "crimson",
+        "lightgrey",
         "aqua",
         "plum",
         "blue",
         "teal",
         "maroon",
         "green",
         "black",
@@ -351,15 +352,16 @@
         "darkgoldenrod",
         "purple",
         "olive",
         "seagreen",
         "dodgerblue",
         "springgreen",
         "firebrick",
-        "indigo" "white",
+        "indigo",
+        "white",
     ]
 
 
 def create_color_palettes(no_animals: int, map_size: int) -> List[List[int]]:
     """
     Create list of lists of bgr colors, one for each animal. Each list is pulled from a different palette
     matplotlib color map.
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/utils/cli/cli_tools.py` & `Simba-UW-tf-dev-1.89.5/simba/utils/cli/cli_tools.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/utils/errors.py` & `Simba-UW-tf-dev-1.89.5/simba/utils/errors.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/utils/data.py` & `Simba-UW-tf-dev-1.89.5/simba/utils/data.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/utils/keyboard_listener.py` & `Simba-UW-tf-dev-1.89.5/simba/utils/keyboard_listener.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/utils/printing.py` & `Simba-UW-tf-dev-1.89.5/simba/utils/printing.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/SimBA_logo.ico` & `Simba-UW-tf-dev-1.89.5/simba/SimBA_logo.ico`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/pose_processors/reorganize_keypoint.py` & `Simba-UW-tf-dev-1.89.5/simba/pose_processors/reorganize_keypoint.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/pose_processors/remove_keypoints.py` & `Simba-UW-tf-dev-1.89.5/simba/pose_processors/remove_keypoints.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/pose_processors/pose_reset.py` & `Simba-UW-tf-dev-1.89.5/simba/pose_processors/pose_reset.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/pose_processors/reverse_pose.py` & `Simba-UW-tf-dev-1.89.5/simba/pose_processors/reverse_pose.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/doctests.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/doctests.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/fish_feature_extractor_2023_version_3.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/fish_feature_extractor_2023_version_3.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/dprime.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/dprime.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/linear_fretchet.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/linear_fretchet.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/read_in_mp.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/read_in_mp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/two_fish_feature_extractor_040324.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/fish_feature_extractor_2023_version_5.py`

 * *Files 14% similar despite different names*

```diff
@@ -1,836 +1,878 @@
 from __future__ import division
-from copy import deepcopy
+
+import glob
+import math
+import os
+from itertools import combinations
+
 import numpy as np
-from numba import typed
+import pandas as pd
+from joblib import Parallel, delayed
+from numba import jit, prange
+from scipy import stats
+from scipy.signal import find_peaks
+from scipy.spatial import ConvexHull
+from scipy.spatial.qhull import QhullError
+from scipy.stats import zscore
+from statsmodels.stats.diagnostic import lilliefors
 
-from simba.utils.checks import check_if_filepath_list_is_empty, check_all_file_names_are_represented_in_video_log
 from simba.mixins.config_reader import ConfigReader
 from simba.mixins.feature_extraction_mixin import FeatureExtractionMixin
-from simba.mixins.feature_extraction_supplement_mixin import FeatureExtractionSupplemental
-from simba.mixins.timeseries_features_mixin import TimeseriesFeatureMixin
-from simba.mixins.circular_statistics import CircularStatisticsMixin
-from simba.utils.printing import SimbaTimer, stdout_success
-from simba.utils.read_write import get_fn_ext, read_df, read_video_info
-from simba.utils.lookups import cardinality_to_integer_lookup
+from simba.utils.enums import Paths
+from simba.utils.printing import SimbaTimer
+from simba.utils.read_write import (check_if_filepath_list_is_empty,
+                                    get_fn_ext, read_config_file, read_df,
+                                    read_project_path_and_file_type,
+                                    read_video_info, write_df)
 
 TAIL_BP_NAMES = ["objectA", "peduncle_base"]
 CENTER_BP_NAMES = ["midpoint"]
 MOUTH = ["mouth"]
 
 ANGULAR_DISPERSION_S = [10, 5, 2, 1, 0.5, 0.25]
-ROLL_WINDOWS_VALUES = np.array([75, 50, 25, 20, 15, 10, 4, 2])
 
 
-class TwoFishFeatureExtractor(ConfigReader, FeatureExtractionMixin):
+class FishFeatureExtractor(ConfigReader, FeatureExtractionMixin):
     def __init__(self, config_path: str):
-        ConfigReader.__init__(self, config_path=config_path, read_video_info=True)
-        check_if_filepath_list_is_empty(filepaths=self.outlier_corrected_paths, error_msg=f'No data files found in {self.outlier_corrected_dir} directory')
-        check_all_file_names_are_represented_in_video_log(video_info_df=self.video_info_df, data_paths=self.outlier_corrected_paths)
-        print(f"Extracting features from {len(self.outlier_corrected_paths)} file(s)...")
+        ConfigReader.__init__(self, config_path=config_path)
+        FeatureExtractionMixin.__init__(self, config_path=config_path)
+        self.timer = SimbaTimer()
+        self.timer.start_timer()
+        self.compass_brackets = ["N", "NE", "E", "SE", "S", "SW", "W", "NW", "N"]
+        self.compass_brackets_long = [
+            "Direction_N",
+            "Direction_NE",
+            "Direction_E",
+            "Direction_SE",
+            "Direction_S",
+            "Direction_SW",
+            "Direction_W",
+            "Direction_NW",
+        ]
+        self.compass_brackets_digits = ["0", "1", "2", "3", "4", "5", "6", "7", "0"]
+        self.config = read_config_file(config_path=config_path)
+        self.project_path, self.file_type = read_project_path_and_file_type(
+            config=self.config
+        )
+        self.input_file_dir = os.path.join(
+            self.project_path, Paths.OUTLIER_CORRECTED.value
+        )
+        self.save_dir = os.path.join(
+            self.project_path, Paths.FEATURES_EXTRACTED_DIR.value
+        )
+        self.video_info_path = os.path.join(self.project_path, Paths.VIDEO_INFO.value)
+        self.video_info_df = pd.read_csv(self.video_info_path)
+        bp_names_path = os.path.join(self.project_path, Paths.BP_NAMES.value)
+        self.bp_names = list(pd.read_csv(bp_names_path, header=None)[0])
+        self.col_headers_shifted = []
+        for bp in self.bp_names:
+            self.col_headers_shifted.extend(
+                (bp + "_x_shifted", bp + "_y_shifted", bp + "_p_shifted")
+            )
+        self.x_y_cols = []
+        self.x_cols_shifted, self.y_cols_shifted = [], []
+        for x_name, y_name in zip(self.x_cols, self.y_cols):
+            self.x_y_cols.extend((x_name, y_name))
+            self.x_cols_shifted.append(x_name + "_shifted")
+            self.y_cols_shifted.append(y_name + "_shifted")
+
+        self.roll_windows_values = [
+            75,
+            50,
+            25,
+            20,
+            15,
+            10,
+            4,
+            2,
+        ]
+        self.files_found = glob.glob(
+            self.input_file_dir + "/*.{}".format(self.file_type)
+        )
+        check_if_filepath_list_is_empty(
+            filepaths=self.files_found,
+            error_msg="SIMBA ERROR: No file in {} directory".format(
+                self.input_file_dir
+            ),
+        )
+        print(
+            "Extracting features from {} {}...".format(
+                str(len(self.files_found)), "file(s)"
+            )
+        )
 
-    def run(self):
-        for file_cnt, file_path in enumerate(self.outlier_corrected_paths):
+        for file_path in self.files_found:
             video_timer = SimbaTimer(start=True)
-            _, file_name, _ = get_fn_ext(file_path)
-            self.data = read_df(file_path=file_path, file_type=self.file_type)
-            self.results = deepcopy(self.data)
-            video_info, self.px_per_mm, self.fps = read_video_info(self.video_info_df, file_name)
+            video_timer.start_timer()
+            dir_name, file_name, ext = get_fn_ext(file_path)
+            self.save_path = os.path.join(self.save_dir, os.path.basename(file_path))
+            video_info, self.px_per_mm, self.fps = read_video_info(
+                self.video_info_df, file_name
+            )
+            self.video_width, self.video_height = (
+                video_info["Resolution_width"].values,
+                video_info["Resolution_height"].values,
+            )
             self.angular_dispersion_windows = []
-            for i in range(len(ANGULAR_DISPERSION_S)): self.angular_dispersion_windows.append(int(self.fps * ANGULAR_DISPERSION_S[i]))
-            self.data.columns = self.bp_headers
-            #cleaner_x_relative_to_y_movement = FeatureExtractionSupplemental.rolling_horizontal_vs_vertical_movement(data=self.data[['Cleaner_BodyMid_1_x', 'Cleaner_BodyMid_1_y']].values, pixels_per_mm=self.px_per_mm, time_windows=ROLL_WINDOWS_VALUES, fps=self.fps)
-            #client_x_relative_to_y_movement = FeatureExtractionSupplemental.rolling_horizontal_vs_vertical_movement(data=self.data[['Client_BodyMid_2_x', 'Client_BodyMid_2_y']].values, pixels_per_mm=self.px_per_mm, time_windows=ROLL_WINDOWS_VALUES, fps=self.fps)
-
-            # for i in [['Cleaner_BodyMid_1_x', 'Cleaner_BodyMid_1_y'], ['Client_BodyMid_2_x', 'Client_BodyMid_2_y']]:
-            #     shifted_ = self.create_shifted_df(df=self.data[i])
-            #     x = self.framewise_euclidean_distance(location_1=shifted_.values[:, [0, 1]], location_2=shifted_.values[:, [2, 3]], px_per_mm=self.px_per_mm).astype(np.float32)
-            #     velocity = TimeseriesFeatureMixin.sliding_descriptive_statistics(data=x, window_sizes=ROLL_WINDOWS_VALUES.astype(np.float64), sample_rate=int(self.fps), statistics=typed.List(['sum']))
-            #     acceleration = TimeseriesFeatureMixin.acceleration(data=x, pixels_per_mm=self.px_per_mm, fps=int(self.fps))
-
-            for i in [['Cleaner_HeadTerminalMouth_1', 'Cleaner_HeadMid_1'], ['Client_HeadTerminalMouth_2', 'Client_HeadMid_2']]:
-                bp_1, bp_2 = self.data[[f'{i[0]}_x', f'{i[0]}_y']].values, self.data[[f'{i[1]}_x', f'{i[1]}_y']].values
-                angle = CircularStatisticsMixin.direction_two_bps(anterior_loc=bp_1, posterior_loc=bp_2).astype(np.float32)
-                compass_direction = [cardinality_to_integer_lookup()[d] for d in CircularStatisticsMixin.degrees_to_cardinal(data=angle)]
-                sliding_circular_mean = CircularStatisticsMixin.sliding_circular_mean(data=angle, time_windows=ROLL_WINDOWS_VALUES.astype(np.float64), fps=float(self.fps))
-
-
-
-
-
-    #
-    #
-    #         video_timer = SimbaTimer(start=True)
-    #         video_timer.start_timer()
-    #         dir_name, file_name, ext = get_fn_ext(file_path)
-    #         self.save_path = os.path.join(self.save_dir, os.path.basename(file_path))
-    #         video_info, self.px_per_mm, self.fps = read_video_info(
-    #             self.video_info_df, file_name
-    #         )
-    #         self.video_width, self.video_height = (
-    #             video_info["Resolution_width"].values,
-    #             video_info["Resolution_height"].values,
-    #         )
-    #         self.angular_dispersion_windows = []
-    #         for i in range(len(ANGULAR_DISPERSION_S)):
-    #             self.angular_dispersion_windows.append(
-    #                 int(self.fps * ANGULAR_DISPERSION_S[i])
-    #             )
-    #
-    #         self.csv_df = (
-    #             read_df(file_path, self.file_type).fillna(0).apply(pd.to_numeric)
-    #         )
-    #         try:
-    #             self.csv_df.columns = self.bp_headers
-    #         except ValueError:
-    #             msg = f"ERROR: Data contains the following fields: {self.csv_df.columns}. \n SimBA wants to use the following field names {self.bp_header_list}"
-    #             print(msg)
-    #             raise ValueError(msg)
-    #
-    #         csv_df_shifted = self.csv_df.shift(periods=1)
-    #         csv_df_shifted.columns = self.col_headers_shifted
-    #         self.csv_df_combined = pd.concat(
-    #             [self.csv_df, csv_df_shifted], axis=1, join="inner"
-    #         ).fillna(0)
-    #         self.calc_X_relative_to_Y_movement()
-    #         self.calc_movement()
-    #         self.calc_X_relative_to_Y_movement_rolling_windows()
-    #         self.calc_velocity()
-    #         self.calc_acceleration()
-    #         self.calc_rotation()
-    #         self.calc_N_degree_direction_switches()
-    #         self.bouts_in_same_direction()
-    #         self.calc_45_degree_direction_switches()
-    #         self.hot_end_encode_compass()
-    #         self.calc_directional_switches_in_rolling_windows()
-    #         self.calc_angular_dispersion()
-    #         self.calc_border_distances()
-    #         self.calc_distances_between_body_part()
-    #         self.calc_convex_hulls()
-    #         self.pose_confidence_probabilities()
-    #         self.distribution_tests()
-    #         self.save_file()
-    #         video_timer.stop_timer()
-    #         print(
-    #             f"Features extracted for video {file_name} (elapsed time {video_timer.elapsed_time_str}s)..."
-    #         )
-    #
-    #     self.timer.stop_timer()
-    #     print(
-    #         f"Features extracted for all {str(len(self.files_found))} files, data saved in project_folder/csv/features_extracted directory (elapsed time {self.timer.elapsed_time_str}s)"
-    #     )
-    #
-    # def angle2pt_degrees(self, ax, ay, bx, by):
-    #     angle_degrees = math.degrees(math.atan2(ax - bx, by - ay))
-    #     return angle_degrees + 360 if angle_degrees < 0 else angle_degrees
-    #
-    # def angle2pt_radians(self, degrees):
-    #     angle_radians = degrees * math.pi / 180
-    #     return angle_radians
-    #
-    # def angle2pt_sin(self, angle_radians):
-    #     angle_sin = math.sin(angle_radians)
-    #     return angle_sin
-    #
-    # def angle2pt_cos(self, angle_radians):
-    #     angle_cos = math.cos(angle_radians)
-    #     return angle_cos
-    #
-    # @staticmethod
-    # @jit(nopython=True)
-    # def count_values_in_range(data: np.array, ranges: np.array):
-    #     results = np.full((data.shape[0], ranges.shape[0]), 0)
-    #     for i in prange(data.shape[0]):
-    #         for j in prange(ranges.shape[0]):
-    #             lower_bound, upper_bound = ranges[j][0], ranges[j][1]
-    #             results[i][j] = data[i][
-    #                 np.logical_and(data[i] >= lower_bound, data[i] <= upper_bound)
-    #             ].shape[0]
-    #     return results
-    #
-    # @staticmethod
-    # def convex_hull_calculator_mp(arr: np.array, px_per_mm: float) -> float:
-    #     arr = np.unique(arr, axis=0).astype(int)
-    #     if arr.shape[0] < 3:
-    #         return 0
-    #     for i in range(1, arr.shape[0]):
-    #         if (arr[i] != arr[0]).all():
-    #             try:
-    #                 return ConvexHull(arr, qhull_options="En").area / px_per_mm
-    #             except QhullError:
-    #                 return 0
-    #         else:
-    #             pass
-    #     return 0
-    #
-    # @staticmethod
-    # @jit(nopython=True)
-    # def euclidian_distance_calc(bp1xVals, bp1yVals, bp2xVals, bp2yVals):
-    #     return np.sqrt((bp1xVals - bp2xVals) ** 2 + (bp1yVals - bp2yVals) ** 2)
-    #
-    # @staticmethod
-    # @jit(nopython=True)
-    # def angular_dispersion(cumsum_cos_np, cumsum_sin_np):
-    #     out_array = np.empty((cumsum_cos_np.shape))
-    #     for index in range(cumsum_cos_np.shape[0]):
-    #         X, Y = cumsum_cos_np[index] / (index + 1), cumsum_sin_np[index] / (
-    #             index + 1
-    #         )
-    #         out_array[index] = math.sqrt(X**2 + Y**2)
-    #     return out_array
-    #
-    # def windowed_frequentist_distribution_tests(
-    #     self, data: np.array, feature_name: str, fps: int
-    # ):
-    #     """
-    #     Helper to compare feature value distributions in 1s sequential time-bins: Kolmogorov-Smirnov and T-tests
-    #     Compares the feature values against a normal distribution: Lillefors, Shapiro.
-    #     Find the number of peaks in *rolling* 1s long feature window.
-    #     """
-    #
-    #     (ks_results,) = (np.full((data.shape[0]), -1.0),)
-    #     t_test_results = np.full((data.shape[0]), -1.0)
-    #     lillefors_results = np.full((data.shape[0]), -1.0)
-    #     shapiro_results = np.full((data.shape[0]), -1.0)
-    #     peak_cnt_results = np.full((data.shape[0]), -1.0)
-    #
-    #     for i in range(fps, data.shape[0] - fps, fps):
-    #         bin_1_idx, bin_2_idx = [i - fps, i], [i, i + fps]
-    #         bin_1_data, bin_2_data = (
-    #             data[bin_1_idx[0] : bin_1_idx[1]],
-    #             data[bin_2_idx[0] : bin_2_idx[1]],
-    #         )
-    #         ks_results[i : i + fps + 1] = stats.ks_2samp(
-    #             data1=bin_1_data, data2=bin_2_data
-    #         ).statistic
-    #         t_test_results[i : i + fps + 1] = stats.ttest_ind(
-    #             bin_1_data, bin_2_data
-    #         ).statistic
-    #
-    #     for i in range(0, data.shape[0] - fps, fps):
-    #         lillefors_results[i : i + fps + 1] = lilliefors(data[i : i + fps])[0]
-    #         shapiro_results[i : i + fps + 1] = stats.shapiro(data[i : i + fps])[0]
-    #
-    #     rolling_idx = np.arange(fps)[None, :] + 1 * np.arange(data.shape[0])[:, None]
-    #     for i in range(rolling_idx.shape[0]):
-    #         bin_start_idx, bin_end_idx = rolling_idx[i][0], rolling_idx[i][-1]
-    #         peaks, _ = find_peaks(data[bin_start_idx:bin_end_idx], height=0)
-    #         peak_cnt_results[i] = len(peaks)
-    #
-    #     columns = [
-    #         f"{feature_name}_KS",
-    #         f"{feature_name}_TTEST",
-    #         f"{feature_name}_LILLEFORS",
-    #         f"{feature_name}_SHAPIRO",
-    #         f"{feature_name}_PEAK_CNT",
-    #     ]
-    #     return pd.DataFrame(
-    #         np.column_stack(
-    #             (
-    #                 ks_results,
-    #                 t_test_results,
-    #                 lillefors_results,
-    #                 shapiro_results,
-    #                 peak_cnt_results,
-    #             )
-    #         ),
-    #         columns=columns,
-    #     ).round(4)
-    #
-    # @staticmethod
-    # @jit(nopython=True)
-    # def consecutive_frames_in_same_compass_direction(direction: np.array):
-    #     results = np.full((direction.shape[0], 1), -1)
-    #     cnt, results[0], last_direction = 0, 0, direction[0]
-    #     for i in prange(1, direction.shape[0]):
-    #         if direction[i] == last_direction:
-    #             cnt += 1
-    #         else:
-    #             cnt = 0
-    #         results[i] = cnt
-    #         last_direction = direction[i]
-    #     return results.flatten()
-    #
-    # @staticmethod
-    # @jit(nopython=True, fastmath=True)
-    # def framewise_degree_shift(clockwise_angle: np.array):
-    #     degree_shift = np.full((clockwise_angle.shape[0], 1), np.nan)
-    #     cnt, degree_shift[0], last_angle = 0, 0, clockwise_angle[0]
-    #     for i in prange(1, clockwise_angle.shape[0]):
-    #         degree_shift[i] = math.atan2(
-    #             math.sin(clockwise_angle[i] - last_angle),
-    #             math.cos(clockwise_angle[i] - last_angle),
-    #         )
-    #     return np.absolute(degree_shift.flatten())
-    #
-    # def bouts_in_same_direction(self):
-    #     self.csv_df_combined["Consecutive_ms_in_same_compass_direction"] = (
-    #         self.consecutive_frames_in_same_compass_direction(
-    #             direction=self.csv_df_combined["Compass_digit"].values.astype(int)
-    #         )
-    #         / self.fps
-    #     )
-    #     self.csv_df_combined["Consecutive_ms_in_same_compass_direction_zscore"] = (
-    #         zscore(
-    #             self.csv_df_combined["Consecutive_ms_in_same_compass_direction"].values
-    #         )
-    #     )
-    #     for window in self.roll_windows_values:
-    #         self.csv_df_combined[f"Unique_compass_directions_in_{window}_window"] = (
-    #             self.csv_df_combined["Compass_digit"]
-    #             .astype(int)
-    #             .rolling(window, min_periods=1)
-    #             .apply(lambda x: len(np.unique(x)))
-    #             .astype(int)
-    #         )
-    #     framewise_degree_shift = pd.Series(
-    #         self.framewise_degree_shift(
-    #             clockwise_angle=self.csv_df_combined["Clockwise_angle_degrees"].values
-    #         )
-    #     )
-    #     for window in self.roll_windows_values:
-    #         self.csv_df_combined[f"Degree_shift_{window}_mean"] = (
-    #             framewise_degree_shift.rolling(window, min_periods=1).mean()
-    #         )
-    #         self.csv_df_combined[f"Degree_shift_{window}_median"] = (
-    #             framewise_degree_shift.rolling(window, min_periods=1).median()
-    #         )
-    #         self.csv_df_combined[f"Degree_shift_{window}_sum"] = (
-    #             framewise_degree_shift.rolling(window, min_periods=1).sum()
-    #         )
-    #         self.csv_df_combined[f"Degree_shift_{window}_std"] = (
-    #             framewise_degree_shift.rolling(window, min_periods=1).std()
-    #         )
-    #
-    # def calc_angular_dispersion(self):
-    #     dispersion_array = self.angular_dispersion(
-    #         self.csv_df_combined["Angle_cos_cumsum"].values,
-    #         self.csv_df_combined["Angle_sin_cumsum"].values,
-    #     )
-    #     self.csv_df_combined["Angular_dispersion"] = dispersion_array
-    #
-    #     for win in range(len(self.angular_dispersion_windows)):
-    #         col_name = "Angular_dispersion_window_" + str(
-    #             self.angular_dispersion_windows[win]
-    #         )
-    #         self.csv_df_combined[col_name] = (
-    #             self.csv_df_combined["Angular_dispersion"]
-    #             .rolling(self.angular_dispersion_windows[win], min_periods=1)
-    #             .mean()
-    #         )
-    #
-    # def calc_X_relative_to_Y_movement(self):
-    #     temp_df = pd.DataFrame()
-    #     for bp in range(len(self.x_cols)):
-    #         curr_x_col, curr_x_shifted_col, curr_y_col, curr_y_shifted_col = (
-    #             self.x_cols[bp],
-    #             self.x_cols_shifted[bp],
-    #             self.y_cols[bp],
-    #             self.y_cols_shifted[bp],
-    #         )
-    #         temp_df["x"] = (
-    #             self.csv_df_combined[curr_x_col]
-    #             - self.csv_df_combined[curr_x_shifted_col]
-    #         )
-    #         temp_df["y"] = (
-    #             self.csv_df_combined[curr_y_col]
-    #             - self.csv_df_combined[curr_y_shifted_col]
-    #         )
-    #         temp_df["Movement_{}_X_relative_2_Y".format(bp)] = (
-    #             temp_df["x"] - temp_df["y"]
-    #         )
-    #         temp_df.drop(["x", "y"], axis=1, inplace=True)
-    #     self.csv_df_combined["Movement_X_axis_relative_to_Y_axis"] = temp_df.sum(axis=1)
-    #
-    # def calc_movement(self):
-    #     movement_cols = []
-    #     for bp in self.bp_names:
-    #         self.csv_df_combined[f"{bp}_movement"] = (
-    #             self.euclidian_distance_calc(
-    #                 self.csv_df_combined[f"{bp}_x"].values,
-    #                 self.csv_df_combined[f"{bp}_y"].values,
-    #                 self.csv_df_combined[f"{bp}_x_shifted"].values,
-    #                 self.csv_df_combined[f"{bp}_y_shifted"].values,
-    #             )
-    #             / self.px_per_mm
-    #         )
-    #         movement_cols.append(f"{bp}_movement")
-    #     self.csv_df_combined["Summed_movement"] = self.csv_df_combined[
-    #         movement_cols
-    #     ].sum(axis=1)
-    #
-    #     for bp in self.bp_names:
-    #         for window in self.roll_windows_values:
-    #             self.csv_df_combined[f"{bp}_movement_{window}_mean"] = (
-    #                 self.csv_df_combined[f"{bp}_movement"]
-    #                 .rolling(window, min_periods=1)
-    #                 .mean()
-    #             )
-    #             self.csv_df_combined[f"{bp}_movement_{window}_sum"] = (
-    #                 self.csv_df_combined[f"{bp}_movement"]
-    #                 .rolling(window, min_periods=1)
-    #                 .sum()
-    #             )
-    #
-    # def calc_X_relative_to_Y_movement_rolling_windows(self):
-    #     for i in self.roll_windows_values:
-    #         currentColName = f"Movement_X_axis_relative_to_Y_axis_mean_{i}"
-    #         self.csv_df_combined[currentColName] = (
-    #             self.csv_df_combined["Movement_X_axis_relative_to_Y_axis"]
-    #             .rolling(i, min_periods=1)
-    #             .mean()
-    #         )
-    #         currentColName = f"Movement_X_axis_relative_to_Y_axis_sum_{i}"
-    #         self.csv_df_combined[currentColName] = (
-    #             self.csv_df_combined["Movement_X_axis_relative_to_Y_axis"]
-    #             .rolling(i, min_periods=1)
-    #             .sum()
-    #         )
-    #
-    # def calc_directional_switches_in_rolling_windows(self):
-    #     for i in self.roll_windows_values:
-    #         currentColName = f"Number_of_direction_switches_{i}"
-    #         self.csv_df_combined[currentColName] = (
-    #             self.csv_df_combined["Direction_switch"].rolling(i, min_periods=1).sum()
-    #         )
-    #         currentColName = f"Directionality_of_switches_switches_{i}"
-    #         self.csv_df_combined[currentColName] = (
-    #             self.csv_df_combined["Switch_direction_value"]
-    #             .rolling(i, min_periods=1)
-    #             .sum()
-    #         )
-    #
-    # def calc_velocity(self):
-    #     self.velocity_fields = []
-    #     for bp in self.bp_names:
-    #         self.csv_df_combined[f"{bp}_velocity"] = (
-    #             self.csv_df_combined[bp + "_movement"]
-    #             .rolling(int(self.fps), min_periods=1)
-    #             .sum()
-    #         )
-    #         self.velocity_fields.append(bp + "_velocity")
-    #     self.csv_df_combined["Bp_velocity_mean"] = self.csv_df_combined[
-    #         self.velocity_fields
-    #     ].mean(axis=1)
-    #     self.csv_df_combined["Bp_velocity_stdev"] = self.csv_df_combined[
-    #         self.velocity_fields
-    #     ].std(axis=1)
-    #     for i in self.roll_windows_values:
-    #         self.csv_df_combined[f"Minimum_avg_bp_velocity_{i}_window"] = (
-    #             self.csv_df_combined["Bp_velocity_mean"].rolling(i, min_periods=1).min()
-    #         )
-    #         self.csv_df_combined[f"Max_avg_bp_velocity_{i}_window"] = (
-    #             self.csv_df_combined["Bp_velocity_mean"].rolling(i, min_periods=1).max()
-    #         )
-    #         self.csv_df_combined[
-    #             f"Absolute_diff_min_max_avg_bp_velocity_{i}_window"
-    #         ] = abs(
-    #             self.csv_df_combined[f"Minimum_avg_bp_velocity_{i}_window"]
-    #             - self.csv_df_combined[f"Max_avg_bp_velocity_{i}_window"]
-    #         )
-    #
-    # def calc_acceleration(self):
-    #     for i in self.roll_windows_values:
-    #         acceleration_fields = []
-    #         for bp in self.bp_names:
-    #             self.csv_df_combined[f"{bp}_velocity_shifted"] = (
-    #                 self.csv_df_combined[f"{bp}_velocity"]
-    #                 .shift(i)
-    #                 .fillna(self.csv_df_combined[f"{bp}_velocity"])
-    #             )
-    #             self.csv_df_combined[f"{bp}_acceleration_{i}_window"] = (
-    #                 self.csv_df_combined[f"{bp}_velocity"]
-    #                 - self.csv_df_combined[f"{bp}_velocity_shifted"]
-    #             )
-    #             self.csv_df_combined = self.csv_df_combined.drop(
-    #                 [f"{bp}_velocity_shifted"], axis=1
-    #             )
-    #             acceleration_fields.append(f"{bp}_acceleration_{i}_window")
-    #         self.csv_df_combined[f"Bp_acceleration_mean_{i}_window"] = (
-    #             self.csv_df_combined[acceleration_fields].mean(axis=1)
-    #         )
-    #         self.csv_df_combined[f"Bp_acceleration_stdev_{i}_window"] = (
-    #             self.csv_df_combined[acceleration_fields].std(axis=1)
-    #         )
-    #     for i in self.roll_windows_values:
-    #         self.csv_df_combined[f"Min_avg_bp_acceleration_{i}_window"] = (
-    #             self.csv_df_combined[f"Bp_acceleration_mean_{i}_window"]
-    #             .rolling(i, min_periods=1)
-    #             .mean()
-    #         )
-    #         self.csv_df_combined[f"Max_avg_bp_acceleration_{i}_window"] = (
-    #             self.csv_df_combined[f"Bp_acceleration_mean_{i}_window"]
-    #             .rolling(i, min_periods=1)
-    #             .mean()
-    #         )
-    #         self.csv_df_combined[
-    #             f"Absolute_diff_min_max_avg_bp_velocity_{i}_window"
-    #         ] = abs(
-    #             self.csv_df_combined[f"Min_avg_bp_acceleration_{i}_window"]
-    #             - self.csv_df_combined[f"Max_avg_bp_acceleration_{i}_window"]
-    #         )
-    #
-    # def calc_N_degree_direction_switches(self):
-    #     degree_lk_180 = {"N": ["S"], "NE": ["SW"], "E": ["W"], "SE": ["NW"]}
-    #     degree_lk_90 = {
-    #         "N": ["W", "E"],
-    #         "NE": ["NW", "SE"],
-    #         "NW": ["SW", "NE"],
-    #         "SW": ["NW", "SE"],
-    #         "SE": ["NE", "SW"],
-    #         "S": ["W", "E"],
-    #         "E": ["N", "S"],
-    #         "W": ["N", "S"],
-    #     }
-    #     dg_df = pd.DataFrame(self.csv_df_combined["Compass_direction"])
-    #     for window in self.roll_windows_values:
-    #         dg_df[f"Compass_direction_{window}"] = dg_df["Compass_direction"].shift(
-    #             window
-    #         )
-    #         dg_df[f"Compass_direction_{window}"].fillna(
-    #             dg_df["Compass_direction"], inplace=True
-    #         )
-    #         dg_df[f"180_degree_switch_{window}"] = 0
-    #         dg_df[f"90_degree_switch_{window}"] = 0
-    #         for k, v in degree_lk_180.items():
-    #             for value in v:
-    #                 dg_df.loc[
-    #                     (dg_df["Compass_direction"] == k)
-    #                     & (dg_df[f"Compass_direction_{window}"] == value),
-    #                     f"180_degree_switch_{window}",
-    #                 ] = 1
-    #                 dg_df.loc[
-    #                     (dg_df[f"Compass_direction_{window}"] == k)
-    #                     & (dg_df["Compass_direction"] == value),
-    #                     f"180_degree_switch_{window}",
-    #                 ] = 1
-    #         for k, v in degree_lk_90.items():
-    #             for value in v:
-    #                 dg_df.loc[
-    #                     (dg_df["Compass_direction"] == k)
-    #                     & (dg_df[f"Compass_direction_{window}"] == value),
-    #                     f"90_degree_switch_{window}",
-    #                 ] = 1
-    #                 dg_df.loc[
-    #                     (dg_df[f"Compass_direction_{window}"] == k)
-    #                     & (dg_df["Compass_direction"] == value),
-    #                     f"90_degree_switch_{window}",
-    #                 ] = 1
-    #         self.csv_df_combined[f"180_degree_switch_{window}"] = dg_df[
-    #             f"180_degree_switch_{window}"
-    #         ]
-    #         self.csv_df_combined[f"90_degree_switch_{window}"] = dg_df[
-    #             f"90_degree_switch_{window}"
-    #         ]
-    #
-    # def calc_rotation(self):
-    #     self.csv_df_combined["Clockwise_angle_degrees"] = self.csv_df_combined.apply(
-    #         lambda x: self.angle2pt_degrees(
-    #             x[CENTER_BP_NAMES[0] + "_x"],
-    #             x[CENTER_BP_NAMES[0] + "_y"],
-    #             x[TAIL_BP_NAMES[0] + "_x"],
-    #             x[TAIL_BP_NAMES[0] + "_y"],
-    #         ),
-    #         axis=1,
-    #     )
-    #     self.csv_df_combined["Angle_radians"] = self.angle2pt_radians(
-    #         self.csv_df_combined["Clockwise_angle_degrees"]
-    #     )
-    #     self.csv_df_combined["Angle_sin"] = self.csv_df_combined.apply(
-    #         lambda x: self.angle2pt_sin(x["Angle_radians"]), axis=1
-    #     )
-    #     self.csv_df_combined["Angle_cos"] = self.csv_df_combined.apply(
-    #         lambda x: self.angle2pt_cos(x["Angle_radians"]), axis=1
-    #     )
-    #     self.csv_df_combined["Angle_sin_cumsum"] = self.csv_df_combined[
-    #         "Angle_sin"
-    #     ].cumsum()
-    #     self.csv_df_combined["Angle_cos_cumsum"] = self.csv_df_combined[
-    #         "Angle_cos"
-    #     ].cumsum()
-    #     compass_lookup = list(
-    #         round(self.csv_df_combined["Clockwise_angle_degrees"] / 45)
-    #     )
-    #     compass_lookup = [int(i) for i in compass_lookup]
-    #     compasFaceList_bracket, compasFaceList_digit = [], []
-    #     for compasDirection in compass_lookup:
-    #         compasFaceList_bracket.append(self.compass_brackets[compasDirection])
-    #         compasFaceList_digit.append(self.compass_brackets_digits[compasDirection])
-    #     self.csv_df_combined["Compass_direction"] = compasFaceList_bracket
-    #     self.csv_df_combined["Compass_digit"] = compasFaceList_digit
-    #     for i in self.roll_windows_values:
-    #         column_name = f"Mean_angle_time_window_{i}"
-    #         self.csv_df_combined[column_name] = (
-    #             self.csv_df_combined["Clockwise_angle_degrees"]
-    #             .rolling(i, min_periods=1)
-    #             .mean()
-    #         )
-    #
-    # def hot_end_encode_compass(self):
-    #     compass_hot_end = pd.get_dummies(
-    #         self.csv_df_combined["Compass_direction"], prefix="Direction"
-    #     )
-    #     compass_hot_end = compass_hot_end.T.reindex(
-    #         self.compass_brackets_long
-    #     ).T.fillna(0)
-    #     self.csv_df_combined = pd.concat(
-    #         [self.csv_df_combined, compass_hot_end], axis=1
-    #     )
-    #
-    # def calc_45_degree_direction_switches(self):
-    #     self.grouped_df = pd.DataFrame()
-    #     v = (
-    #         self.csv_df_combined["Compass_digit"]
-    #         != self.csv_df_combined["Compass_digit"].shift()
-    #     ).cumsum()
-    #     u = self.csv_df_combined.groupby(v)["Compass_digit"].agg(["all", "count"])
-    #     m = u["all"] & u["count"].ge(1)
-    #     self.grouped_df["groups"] = self.csv_df_combined.groupby(v).apply(
-    #         lambda x: (x.index[0], x.index[-1])
-    #     )[m]
-    #     currdirectionList, DirectionSwitchIndexList, currdirectionListValue = [], [], []
-    #     for indexes, row in self.grouped_df.iterrows():
-    #         currdirectionList.append(
-    #             self.csv_df_combined.loc[row["groups"][0]]["Compass_direction"]
-    #         )
-    #         DirectionSwitchIndexList.append(row["groups"][1])
-    #         currdirectionListValue.append(
-    #             self.csv_df_combined.loc[row["groups"][0]]["Compass_digit"]
-    #         )
-    #     self.grouped_df["Direction_switch"] = currdirectionList
-    #     self.grouped_df["Direction_value"] = currdirectionListValue
-    #     self.csv_df_combined.loc[DirectionSwitchIndexList, "Direction_switch"] = 1
-    #     self.csv_df_combined["Compass_digit_shifted"] = self.csv_df_combined[
-    #         "Compass_digit"
-    #     ].shift(-1)
-    #     self.csv_df_combined = self.csv_df_combined.fillna(0)
-    #     self.csv_df_combined["Switch_direction_value"] = self.csv_df_combined.apply(
-    #         lambda x: self.calc_switch_direction(
-    #             x["Compass_digit_shifted"], x["Compass_digit"]
-    #         ),
-    #         axis=1,
-    #     )
-    #
-    # def calc_switch_direction(self, compass_digit_shifted, compass_digit):
-    #     if (compass_digit_shifted == "0") and (compass_digit == "7"):
-    #         return 1
-    #     else:
-    #         return int(compass_digit_shifted) - int(compass_digit)
-    #
-    # def calc_border_distances(self):
-    #     for bp in self.bp_names:
-    #         self.csv_df_combined[f"{bp}_distance_to_left_border"] = (
-    #             self.csv_df_combined[f"{bp}_x"] / self.px_per_mm
-    #         )
-    #         self.csv_df_combined[f"{bp}_distance_to_right_border"] = (
-    #             self.video_width - self.csv_df_combined[f"{bp}_x"]
-    #         ) / self.px_per_mm
-    #         self.csv_df_combined[f"{bp}_distance_to_top_border"] = (
-    #             self.csv_df_combined[f"{bp}_y"] / self.px_per_mm
-    #         )
-    #         self.csv_df_combined[f"{bp}_distance_to_bottom_border"] = (
-    #             self.video_height - self.csv_df_combined[f"{bp}_y"]
-    #         ) / self.px_per_mm
-    #
-    #     for side in ["left", "right", "top", "bottom"]:
-    #         side_col_names = [
-    #             c
-    #             for c in self.csv_df_combined.columns
-    #             if f"distance_to_{side}_border" in c
-    #         ]
-    #         self.csv_df_combined[f"Mean_bp_distance_to_{side}_border"] = (
-    #             self.csv_df_combined[side_col_names].mean(axis=1)
-    #         )
-    #         for window in self.roll_windows_values:
-    #             self.csv_df_combined[f"Mean_bp_distance_to_{side}_border_{window}"] = (
-    #                 self.csv_df_combined[f"Mean_bp_distance_to_{side}_border"]
-    #                 .rolling(window, min_periods=1)
-    #                 .mean()
-    #             )
-    #             self.csv_df_combined[f"Std_bp_distance_to_{side}_border_{window}"] = (
-    #                 self.csv_df_combined[f"Mean_bp_distance_to_{side}_border"]
-    #                 .rolling(window, min_periods=1)
-    #                 .std()
-    #             )
-    #             try:
-    #                 # self.csv_df_combined[f'Kurtosis_bp_distance_to_{side}_border_{window}'] = self.csv_df_combined[f'Mean_bp_distance_to_{side}_border'].rolling(window, min_periods=window).kurt()
-    #                 self.csv_df_combined[
-    #                     f"Skew_bp_distance_to_{side}_border_{window}"
-    #                 ] = (
-    #                     self.csv_df_combined[f"Mean_bp_distance_to_{side}_border"]
-    #                     .rolling(window, min_periods=window)
-    #                     .skew()
-    #                 )
-    #             except:
-    #                 # self.csv_df_combined[f'Kurtosis_bp_distance_to_{side}_border_{window}'] = -1
-    #                 self.csv_df_combined[
-    #                     f"Skew_bp_distance_to_{side}_border_{window}"
-    #                 ] = -1
-    #
-    # def calc_distances_between_body_part(self):
-    #     two_point_combs = np.array(list(combinations(self.bp_names, 2)))
-    #     distance_fields = []
-    #     for bps in two_point_combs:
-    #         self.csv_df_combined[f"Distance_{bps[0]}_{bps[1]}"] = (
-    #             self.euclidian_distance_calc(
-    #                 self.csv_df_combined[bps[0] + "_x"].values,
-    #                 self.csv_df_combined[bps[0] + "_y"].values,
-    #                 self.csv_df_combined[bps[1] + "_x"].values,
-    #                 self.csv_df_combined[bps[1] + "_y"].values,
-    #             )
-    #             / self.px_per_mm
-    #         )
-    #         distance_fields.append(f"Distance_{bps[0]}_{bps[1]}")
-    #
-    #     for distance_field in distance_fields:
-    #         for window in self.roll_windows_values:
-    #             self.csv_df_combined[f"{distance_field}_mean_{window}"] = (
-    #                 self.csv_df_combined[distance_field]
-    #                 .rolling(window, min_periods=1)
-    #                 .mean()
-    #             )
-    #             self.csv_df_combined[f"{distance_field}_std_{window}"] = (
-    #                 self.csv_df_combined[distance_field]
-    #                 .rolling(window, min_periods=1)
-    #                 .std()
-    #             )
-    #             try:
-    #                 self.csv_df_combined[f"{distance_field}_skew_{window}"] = (
-    #                     self.csv_df_combined[distance_field]
-    #                     .rolling(window, min_periods=1)
-    #                     .skew()
-    #                 )
-    #                 self.csv_df_combined[f"{distance_field}_kurtosis_{window}"] = (
-    #                     self.csv_df_combined[distance_field]
-    #                     .rolling(window, min_periods=1)
-    #                     .kurt()
-    #                 )
-    #             except:
-    #                 self.csv_df_combined[f"{distance_field}_skew_{window}"] = -1
-    #                 self.csv_df_combined[f"{distance_field}_kurtosis_{window}"] = -1
-    #
-    # def calc_convex_hulls(self):
-    #     fish_array = np.reshape(
-    #         self.csv_df[self.x_y_cols].values, (len(self.csv_df / 2), -1, 2)
-    #     )
-    #     self.csv_df_combined["Convex_hull"] = Parallel(
-    #         n_jobs=-1, verbose=0, backend="threading"
-    #     )(
-    #         delayed(self.convex_hull_calculator_mp)(x, self.px_per_mm)
-    #         for x in fish_array
-    #     )
-    #     for window in self.roll_windows_values:
-    #         self.csv_df_combined[f"Convex_hull_mean_{window}_window"] = (
-    #             self.csv_df_combined["Convex_hull"]
-    #             .rolling(window, min_periods=1)
-    #             .mean()
-    #         )
-    #         self.csv_df_combined[f"Convex_hull_std_{window}_window"] = (
-    #             self.csv_df_combined["Convex_hull"].rolling(window, min_periods=1).std()
-    #         )
-    #         self.csv_df_combined[f"Convex_hull_min_{window}_window"] = (
-    #             self.csv_df_combined["Convex_hull"].rolling(window, min_periods=1).min()
-    #         )
-    #         self.csv_df_combined[f"Convex_hull_max_{window}_window"] = (
-    #             self.csv_df_combined["Convex_hull"].rolling(window, min_periods=1).max()
-    #         )
-    #         self.csv_df_combined[
-    #             f"Absolute_diff_min_max_convex_hull_{window}_window"
-    #         ] = abs(
-    #             self.csv_df_combined[f"Convex_hull_min_{window}_window"]
-    #             - self.csv_df_combined[f"Convex_hull_max_{window}_window"]
-    #         )
-    #         try:
-    #             self.csv_df_combined[f"Convex_hull_skew_{window}"] = (
-    #                 self.csv_df_combined["Convex_hull"]
-    #                 .rolling(window, min_periods=1)
-    #                 .skew()
-    #             )
-    #             self.csv_df_combined[f"Convex_hull_kurtosis_{window}"] = (
-    #                 self.csv_df_combined["Convex_hull"]
-    #                 .rolling(window, min_periods=1)
-    #                 .kurt()
-    #             )
-    #         except:
-    #             self.csv_df_combined[f"Convex_hull_skew_{window}"] = -1
-    #             self.csv_df_combined[f"Convex_hull_kurtosis_{window}"] = -1
-    #
-    # def distribution_tests(self):
-    #     distribution_features = [
-    #         "Mean_bp_distance_to_left_border",
-    #         "Mean_bp_distance_to_right_border",
-    #         "Mean_bp_distance_to_top_border",
-    #         "Mean_bp_distance_to_bottom_border",
-    #         "Bp_velocity_mean",
-    #         "Bp_acceleration_mean_25_window",
-    #         "Clockwise_angle_degrees",
-    #         "Convex_hull",
-    #         "Sum_probabilities",
-    #         "Consecutive_ms_in_same_compass_direction",
-    #     ]
-    #
-    #     for feature_name in distribution_features:
-    #         results = self.windowed_frequentist_distribution_tests(
-    #             data=self.csv_df_combined[feature_name].values,
-    #             feature_name=feature_name,
-    #             fps=int(self.fps),
-    #         )
-    #         self.csv_df_combined = pd.concat([self.csv_df_combined, results], axis=1)
-    #
-    # def pose_confidence_probabilities(self):
-    #     self.csv_df_combined["Sum_probabilities"] = self.csv_df_combined[
-    #         self.p_cols
-    #     ].sum(axis=1)
-    #     self.csv_df_combined["Sum_probabilities_deviation"] = (
-    #         self.csv_df_combined["Sum_probabilities"].mean()
-    #         - self.csv_df_combined["Sum_probabilities"]
-    #     )
-    #     p_brackets_results = pd.DataFrame(
-    #         self.count_values_in_range(
-    #             data=self.csv_df_combined.filter(self.p_cols).values,
-    #             ranges=np.array(
-    #                 [
-    #                     [0.0, 0.1],
-    #                     [0.000000000, 0.5],
-    #                     [0.000000000, 0.75],
-    #                     [0.000000000, 0.95],
-    #                     [0.000000000, 0.99],
-    #                 ]
-    #             ),
-    #         ),
-    #         columns=[
-    #             "Low_prob_detections_0.1",
-    #             "Low_prob_detections_0.5",
-    #             "Low_prob_detections_0.75",
-    #             "Low_prob_detections_0.95",
-    #             "Low_prob_detections_0.99",
-    #         ],
-    #     )
-    #     self.csv_df_combined = (
-    #         pd.concat([self.csv_df_combined, p_brackets_results], axis=1)
-    #         .reset_index(drop=True)
-    #         .fillna(0)
-    #     )
-    #
-    # def save_file(self):
-    #     self.csv_df_combined = self.csv_df_combined.drop(
-    #         self.col_headers_shifted, axis=1
-    #     )
-    #     self.csv_df_combined = self.csv_df_combined.drop(
-    #         [
-    #             "Compass_digit_shifted",
-    #             "Direction_switch",
-    #             "Switch_direction_value",
-    #             "Compass_digit",
-    #             "Compass_direction",
-    #             "Angle_sin_cumsum",
-    #             "Angle_cos_cumsum",
-    #         ],
-    #         axis=1,
-    #     ).fillna(0)
-    #     write_df(
-    #         self.csv_df_combined.astype(np.float32), self.file_type, self.save_path
-    #     )
+            for i in range(len(ANGULAR_DISPERSION_S)):
+                self.angular_dispersion_windows.append(
+                    int(self.fps * ANGULAR_DISPERSION_S[i])
+                )
+
+            self.csv_df = (
+                read_df(file_path, self.file_type).fillna(0).apply(pd.to_numeric)
+            )
+            try:
+                self.csv_df.columns = self.bp_headers
+            except ValueError:
+                msg = f"ERROR: Data contains the following fields: {self.csv_df.columns}. \n SimBA wants to use the following field names {self.bp_header_list}"
+                print(msg)
+                raise ValueError(msg)
+
+            csv_df_shifted = self.csv_df.shift(periods=1)
+            csv_df_shifted.columns = self.col_headers_shifted
+            self.csv_df_combined = pd.concat(
+                [self.csv_df, csv_df_shifted], axis=1, join="inner"
+            ).fillna(0)
+            self.calc_X_relative_to_Y_movement()
+            self.calc_movement()
+            self.calc_X_relative_to_Y_movement_rolling_windows()
+            self.calc_velocity()
+            self.calc_acceleration()
+            self.calc_rotation()
+            self.calc_N_degree_direction_switches()
+            self.bouts_in_same_direction()
+            self.calc_45_degree_direction_switches()
+            self.hot_end_encode_compass()
+            self.calc_directional_switches_in_rolling_windows()
+            self.calc_angular_dispersion()
+            self.calc_border_distances()
+            self.calc_distances_between_body_part()
+            self.calc_convex_hulls()
+            self.pose_confidence_probabilities()
+            self.distribution_tests()
+            self.save_file()
+            video_timer.stop_timer()
+            print(
+                f"Features extracted for video {file_name} (elapsed time {video_timer.elapsed_time_str}s)..."
+            )
+
+        self.timer.stop_timer()
+        print(
+            f"Features extracted for all {str(len(self.files_found))} files, data saved in project_folder/csv/features_extracted directory (elapsed time {self.timer.elapsed_time_str}s)"
+        )
+
+    def angle2pt_degrees(self, ax, ay, bx, by):
+        angle_degrees = math.degrees(math.atan2(ax - bx, by - ay))
+        return angle_degrees + 360 if angle_degrees < 0 else angle_degrees
+
+    def angle2pt_radians(self, degrees):
+        angle_radians = degrees * math.pi / 180
+        return angle_radians
+
+    def angle2pt_sin(self, angle_radians):
+        angle_sin = math.sin(angle_radians)
+        return angle_sin
+
+    def angle2pt_cos(self, angle_radians):
+        angle_cos = math.cos(angle_radians)
+        return angle_cos
+
+    @staticmethod
+    @jit(nopython=True)
+    def count_values_in_range(data: np.array, ranges: np.array):
+        results = np.full((data.shape[0], ranges.shape[0]), 0)
+        for i in prange(data.shape[0]):
+            for j in prange(ranges.shape[0]):
+                lower_bound, upper_bound = ranges[j][0], ranges[j][1]
+                results[i][j] = data[i][
+                    np.logical_and(data[i] >= lower_bound, data[i] <= upper_bound)
+                ].shape[0]
+        return results
+
+    @staticmethod
+    def convex_hull_calculator_mp(arr: np.array, px_per_mm: float) -> float:
+        arr = np.unique(arr, axis=0).astype(int)
+        if arr.shape[0] < 3:
+            return 0
+        for i in range(1, arr.shape[0]):
+            if (arr[i] != arr[0]).all():
+                try:
+                    return ConvexHull(arr, qhull_options="En").area / px_per_mm
+                except QhullError:
+                    return 0
+            else:
+                pass
+        return 0
+
+    @staticmethod
+    @jit(nopython=True)
+    def euclidian_distance_calc(bp1xVals, bp1yVals, bp2xVals, bp2yVals):
+        return np.sqrt((bp1xVals - bp2xVals) ** 2 + (bp1yVals - bp2yVals) ** 2)
+
+    @staticmethod
+    @jit(nopython=True)
+    def angular_dispersion(cumsum_cos_np, cumsum_sin_np):
+        out_array = np.empty((cumsum_cos_np.shape))
+        for index in range(cumsum_cos_np.shape[0]):
+            X, Y = cumsum_cos_np[index] / (index + 1), cumsum_sin_np[index] / (
+                index + 1
+            )
+            out_array[index] = math.sqrt(X**2 + Y**2)
+        return out_array
+
+    def windowed_frequentist_distribution_tests(
+        self, data: np.array, feature_name: str, fps: int
+    ):
+        """
+        Helper to compare feature value distributions in 1s sequential time-bins: Kolmogorov-Smirnov and T-tests
+        Compares the feature values against a normal distribution: Lillefors, Shapiro.
+        Find the number of peaks in *rolling* 1s long feature window.
+        """
+
+        (ks_results,) = (np.full((data.shape[0]), -1.0),)
+        t_test_results = np.full((data.shape[0]), -1.0)
+        lillefors_results = np.full((data.shape[0]), -1.0)
+        shapiro_results = np.full((data.shape[0]), -1.0)
+        peak_cnt_results = np.full((data.shape[0]), -1.0)
+
+        for i in range(fps, data.shape[0] - fps, fps):
+            bin_1_idx, bin_2_idx = [i - fps, i], [i, i + fps]
+            bin_1_data, bin_2_data = (
+                data[bin_1_idx[0] : bin_1_idx[1]],
+                data[bin_2_idx[0] : bin_2_idx[1]],
+            )
+            ks_results[i : i + fps + 1] = stats.ks_2samp(
+                data1=bin_1_data, data2=bin_2_data
+            ).statistic
+            t_test_results[i : i + fps + 1] = stats.ttest_ind(
+                bin_1_data, bin_2_data
+            ).statistic
+
+        for i in range(0, data.shape[0] - fps, fps):
+            lillefors_results[i : i + fps + 1] = lilliefors(data[i : i + fps])[0]
+            shapiro_results[i : i + fps + 1] = stats.shapiro(data[i : i + fps])[0]
+
+        rolling_idx = np.arange(fps)[None, :] + 1 * np.arange(data.shape[0])[:, None]
+        for i in range(rolling_idx.shape[0]):
+            bin_start_idx, bin_end_idx = rolling_idx[i][0], rolling_idx[i][-1]
+            peaks, _ = find_peaks(data[bin_start_idx:bin_end_idx], height=0)
+            peak_cnt_results[i] = len(peaks)
+
+        columns = [
+            f"{feature_name}_KS",
+            f"{feature_name}_TTEST",
+            f"{feature_name}_LILLEFORS",
+            f"{feature_name}_SHAPIRO",
+            f"{feature_name}_PEAK_CNT",
+        ]
+        return pd.DataFrame(
+            np.column_stack(
+                (
+                    ks_results,
+                    t_test_results,
+                    lillefors_results,
+                    shapiro_results,
+                    peak_cnt_results,
+                )
+            ),
+            columns=columns,
+        ).round(4)
+
+    @staticmethod
+    @jit(nopython=True)
+    def consecutive_frames_in_same_compass_direction(direction: np.array):
+        results = np.full((direction.shape[0], 1), -1)
+        cnt, results[0], last_direction = 0, 0, direction[0]
+        for i in prange(1, direction.shape[0]):
+            if direction[i] == last_direction:
+                cnt += 1
+            else:
+                cnt = 0
+            results[i] = cnt
+            last_direction = direction[i]
+        return results.flatten()
+
+    @staticmethod
+    @jit(nopython=True, fastmath=True)
+    def framewise_degree_shift(clockwise_angle: np.array):
+        degree_shift = np.full((clockwise_angle.shape[0], 1), np.nan)
+        cnt, degree_shift[0], last_angle = 0, 0, clockwise_angle[0]
+        for i in prange(1, clockwise_angle.shape[0]):
+            degree_shift[i] = math.atan2(
+                math.sin(clockwise_angle[i] - last_angle),
+                math.cos(clockwise_angle[i] - last_angle),
+            )
+        return np.absolute(degree_shift.flatten())
+
+    def bouts_in_same_direction(self):
+        self.csv_df_combined["Consecutive_ms_in_same_compass_direction"] = (
+            self.consecutive_frames_in_same_compass_direction(
+                direction=self.csv_df_combined["Compass_digit"].values.astype(int)
+            )
+            / self.fps
+        )
+        self.csv_df_combined["Consecutive_ms_in_same_compass_direction_zscore"] = (
+            zscore(
+                self.csv_df_combined["Consecutive_ms_in_same_compass_direction"].values
+            )
+        )
+        for window in self.roll_windows_values:
+            self.csv_df_combined[f"Unique_compass_directions_in_{window}_window"] = (
+                self.csv_df_combined["Compass_digit"]
+                .astype(int)
+                .rolling(window, min_periods=1)
+                .apply(lambda x: len(np.unique(x)))
+                .astype(int)
+            )
+        framewise_degree_shift = pd.Series(
+            self.framewise_degree_shift(
+                clockwise_angle=self.csv_df_combined["Clockwise_angle_degrees"].values
+            )
+        )
+        for window in self.roll_windows_values:
+            self.csv_df_combined[f"Degree_shift_{window}_mean"] = (
+                framewise_degree_shift.rolling(window, min_periods=1).mean()
+            )
+            self.csv_df_combined[f"Degree_shift_{window}_median"] = (
+                framewise_degree_shift.rolling(window, min_periods=1).median()
+            )
+            self.csv_df_combined[f"Degree_shift_{window}_sum"] = (
+                framewise_degree_shift.rolling(window, min_periods=1).sum()
+            )
+            self.csv_df_combined[f"Degree_shift_{window}_std"] = (
+                framewise_degree_shift.rolling(window, min_periods=1).std()
+            )
+
+    def calc_angular_dispersion(self):
+        dispersion_array = self.angular_dispersion(
+            self.csv_df_combined["Angle_cos_cumsum"].values,
+            self.csv_df_combined["Angle_sin_cumsum"].values,
+        )
+        self.csv_df_combined["Angular_dispersion"] = dispersion_array
+
+        for win in range(len(self.angular_dispersion_windows)):
+            col_name = "Angular_dispersion_window_" + str(
+                self.angular_dispersion_windows[win]
+            )
+            self.csv_df_combined[col_name] = (
+                self.csv_df_combined["Angular_dispersion"]
+                .rolling(self.angular_dispersion_windows[win], min_periods=1)
+                .mean()
+            )
+
+    def calc_X_relative_to_Y_movement(self):
+        temp_df = pd.DataFrame()
+        for bp in range(len(self.x_cols)):
+            curr_x_col, curr_x_shifted_col, curr_y_col, curr_y_shifted_col = (
+                self.x_cols[bp],
+                self.x_cols_shifted[bp],
+                self.y_cols[bp],
+                self.y_cols_shifted[bp],
+            )
+            temp_df["x"] = (
+                self.csv_df_combined[curr_x_col]
+                - self.csv_df_combined[curr_x_shifted_col]
+            )
+            temp_df["y"] = (
+                self.csv_df_combined[curr_y_col]
+                - self.csv_df_combined[curr_y_shifted_col]
+            )
+            temp_df["Movement_{}_X_relative_2_Y".format(bp)] = (
+                temp_df["x"] - temp_df["y"]
+            )
+            temp_df.drop(["x", "y"], axis=1, inplace=True)
+        self.csv_df_combined["Movement_X_axis_relative_to_Y_axis"] = temp_df.sum(axis=1)
+
+    def calc_movement(self):
+        movement_cols = []
+        for bp in self.bp_names:
+            self.csv_df_combined[f"{bp}_movement"] = (
+                self.euclidian_distance_calc(
+                    self.csv_df_combined[f"{bp}_x"].values,
+                    self.csv_df_combined[f"{bp}_y"].values,
+                    self.csv_df_combined[f"{bp}_x_shifted"].values,
+                    self.csv_df_combined[f"{bp}_y_shifted"].values,
+                )
+                / self.px_per_mm
+            )
+            movement_cols.append(f"{bp}_movement")
+        self.csv_df_combined["Summed_movement"] = self.csv_df_combined[
+            movement_cols
+        ].sum(axis=1)
+
+        for bp in self.bp_names:
+            for window in self.roll_windows_values:
+                self.csv_df_combined[f"{bp}_movement_{window}_mean"] = (
+                    self.csv_df_combined[f"{bp}_movement"]
+                    .rolling(window, min_periods=1)
+                    .mean()
+                )
+                self.csv_df_combined[f"{bp}_movement_{window}_sum"] = (
+                    self.csv_df_combined[f"{bp}_movement"]
+                    .rolling(window, min_periods=1)
+                    .sum()
+                )
+
+    def calc_X_relative_to_Y_movement_rolling_windows(self):
+        for i in self.roll_windows_values:
+            currentColName = f"Movement_X_axis_relative_to_Y_axis_mean_{i}"
+            self.csv_df_combined[currentColName] = (
+                self.csv_df_combined["Movement_X_axis_relative_to_Y_axis"]
+                .rolling(i, min_periods=1)
+                .mean()
+            )
+            currentColName = f"Movement_X_axis_relative_to_Y_axis_sum_{i}"
+            self.csv_df_combined[currentColName] = (
+                self.csv_df_combined["Movement_X_axis_relative_to_Y_axis"]
+                .rolling(i, min_periods=1)
+                .sum()
+            )
+
+    def calc_directional_switches_in_rolling_windows(self):
+        for i in self.roll_windows_values:
+            currentColName = f"Number_of_direction_switches_{i}"
+            self.csv_df_combined[currentColName] = (
+                self.csv_df_combined["Direction_switch"].rolling(i, min_periods=1).sum()
+            )
+            currentColName = f"Directionality_of_switches_switches_{i}"
+            self.csv_df_combined[currentColName] = (
+                self.csv_df_combined["Switch_direction_value"]
+                .rolling(i, min_periods=1)
+                .sum()
+            )
+
+    def calc_velocity(self):
+        self.velocity_fields = []
+        for bp in self.bp_names:
+            self.csv_df_combined[f"{bp}_velocity"] = (
+                self.csv_df_combined[bp + "_movement"]
+                .rolling(int(self.fps), min_periods=1)
+                .sum()
+            )
+            self.velocity_fields.append(bp + "_velocity")
+        self.csv_df_combined["Bp_velocity_mean"] = self.csv_df_combined[
+            self.velocity_fields
+        ].mean(axis=1)
+        self.csv_df_combined["Bp_velocity_stdev"] = self.csv_df_combined[
+            self.velocity_fields
+        ].std(axis=1)
+        for i in self.roll_windows_values:
+            self.csv_df_combined[f"Minimum_avg_bp_velocity_{i}_window"] = (
+                self.csv_df_combined["Bp_velocity_mean"].rolling(i, min_periods=1).min()
+            )
+            self.csv_df_combined[f"Max_avg_bp_velocity_{i}_window"] = (
+                self.csv_df_combined["Bp_velocity_mean"].rolling(i, min_periods=1).max()
+            )
+            self.csv_df_combined[
+                f"Absolute_diff_min_max_avg_bp_velocity_{i}_window"
+            ] = abs(
+                self.csv_df_combined[f"Minimum_avg_bp_velocity_{i}_window"]
+                - self.csv_df_combined[f"Max_avg_bp_velocity_{i}_window"]
+            )
+
+    def calc_acceleration(self):
+        for i in self.roll_windows_values:
+            acceleration_fields = []
+            for bp in self.bp_names:
+                self.csv_df_combined[f"{bp}_velocity_shifted"] = (
+                    self.csv_df_combined[f"{bp}_velocity"]
+                    .shift(i)
+                    .fillna(self.csv_df_combined[f"{bp}_velocity"])
+                )
+                self.csv_df_combined[f"{bp}_acceleration_{i}_window"] = (
+                    self.csv_df_combined[f"{bp}_velocity"]
+                    - self.csv_df_combined[f"{bp}_velocity_shifted"]
+                )
+                self.csv_df_combined = self.csv_df_combined.drop(
+                    [f"{bp}_velocity_shifted"], axis=1
+                )
+                acceleration_fields.append(f"{bp}_acceleration_{i}_window")
+            self.csv_df_combined[f"Bp_acceleration_mean_{i}_window"] = (
+                self.csv_df_combined[acceleration_fields].mean(axis=1)
+            )
+            self.csv_df_combined[f"Bp_acceleration_stdev_{i}_window"] = (
+                self.csv_df_combined[acceleration_fields].std(axis=1)
+            )
+        for i in self.roll_windows_values:
+            self.csv_df_combined[f"Min_avg_bp_acceleration_{i}_window"] = (
+                self.csv_df_combined[f"Bp_acceleration_mean_{i}_window"]
+                .rolling(i, min_periods=1)
+                .mean()
+            )
+            self.csv_df_combined[f"Max_avg_bp_acceleration_{i}_window"] = (
+                self.csv_df_combined[f"Bp_acceleration_mean_{i}_window"]
+                .rolling(i, min_periods=1)
+                .mean()
+            )
+            self.csv_df_combined[
+                f"Absolute_diff_min_max_avg_bp_velocity_{i}_window"
+            ] = abs(
+                self.csv_df_combined[f"Min_avg_bp_acceleration_{i}_window"]
+                - self.csv_df_combined[f"Max_avg_bp_acceleration_{i}_window"]
+            )
+
+    def calc_N_degree_direction_switches(self):
+        degree_lk_180 = {"N": ["S"], "NE": ["SW"], "E": ["W"], "SE": ["NW"]}
+        degree_lk_90 = {
+            "N": ["W", "E"],
+            "NE": ["NW", "SE"],
+            "NW": ["SW", "NE"],
+            "SW": ["NW", "SE"],
+            "SE": ["NE", "SW"],
+            "S": ["W", "E"],
+            "E": ["N", "S"],
+            "W": ["N", "S"],
+        }
+        dg_df = pd.DataFrame(self.csv_df_combined["Compass_direction"])
+        for window in self.roll_windows_values:
+            dg_df[f"Compass_direction_{window}"] = dg_df["Compass_direction"].shift(
+                window
+            )
+            dg_df[f"Compass_direction_{window}"].fillna(
+                dg_df["Compass_direction"], inplace=True
+            )
+            dg_df[f"180_degree_switch_{window}"] = 0
+            dg_df[f"90_degree_switch_{window}"] = 0
+            for k, v in degree_lk_180.items():
+                for value in v:
+                    dg_df.loc[
+                        (dg_df["Compass_direction"] == k)
+                        & (dg_df[f"Compass_direction_{window}"] == value),
+                        f"180_degree_switch_{window}",
+                    ] = 1
+                    dg_df.loc[
+                        (dg_df[f"Compass_direction_{window}"] == k)
+                        & (dg_df["Compass_direction"] == value),
+                        f"180_degree_switch_{window}",
+                    ] = 1
+            for k, v in degree_lk_90.items():
+                for value in v:
+                    dg_df.loc[
+                        (dg_df["Compass_direction"] == k)
+                        & (dg_df[f"Compass_direction_{window}"] == value),
+                        f"90_degree_switch_{window}",
+                    ] = 1
+                    dg_df.loc[
+                        (dg_df[f"Compass_direction_{window}"] == k)
+                        & (dg_df["Compass_direction"] == value),
+                        f"90_degree_switch_{window}",
+                    ] = 1
+            self.csv_df_combined[f"180_degree_switch_{window}"] = dg_df[
+                f"180_degree_switch_{window}"
+            ]
+            self.csv_df_combined[f"90_degree_switch_{window}"] = dg_df[
+                f"90_degree_switch_{window}"
+            ]
+
+    def calc_rotation(self):
+        self.csv_df_combined["Clockwise_angle_degrees"] = self.csv_df_combined.apply(
+            lambda x: self.angle2pt_degrees(
+                x[CENTER_BP_NAMES[0] + "_x"],
+                x[CENTER_BP_NAMES[0] + "_y"],
+                x[TAIL_BP_NAMES[0] + "_x"],
+                x[TAIL_BP_NAMES[0] + "_y"],
+            ),
+            axis=1,
+        )
+        self.csv_df_combined["Angle_radians"] = self.angle2pt_radians(
+            self.csv_df_combined["Clockwise_angle_degrees"]
+        )
+        self.csv_df_combined["Angle_sin"] = self.csv_df_combined.apply(
+            lambda x: self.angle2pt_sin(x["Angle_radians"]), axis=1
+        )
+        self.csv_df_combined["Angle_cos"] = self.csv_df_combined.apply(
+            lambda x: self.angle2pt_cos(x["Angle_radians"]), axis=1
+        )
+        self.csv_df_combined["Angle_sin_cumsum"] = self.csv_df_combined[
+            "Angle_sin"
+        ].cumsum()
+        self.csv_df_combined["Angle_cos_cumsum"] = self.csv_df_combined[
+            "Angle_cos"
+        ].cumsum()
+        compass_lookup = list(
+            round(self.csv_df_combined["Clockwise_angle_degrees"] / 45)
+        )
+        compass_lookup = [int(i) for i in compass_lookup]
+        compasFaceList_bracket, compasFaceList_digit = [], []
+        for compasDirection in compass_lookup:
+            compasFaceList_bracket.append(self.compass_brackets[compasDirection])
+            compasFaceList_digit.append(self.compass_brackets_digits[compasDirection])
+        self.csv_df_combined["Compass_direction"] = compasFaceList_bracket
+        self.csv_df_combined["Compass_digit"] = compasFaceList_digit
+        for i in self.roll_windows_values:
+            column_name = f"Mean_angle_time_window_{i}"
+            self.csv_df_combined[column_name] = (
+                self.csv_df_combined["Clockwise_angle_degrees"]
+                .rolling(i, min_periods=1)
+                .mean()
+            )
+
+    def hot_end_encode_compass(self):
+        compass_hot_end = pd.get_dummies(
+            self.csv_df_combined["Compass_direction"], prefix="Direction"
+        )
+        compass_hot_end = compass_hot_end.T.reindex(
+            self.compass_brackets_long
+        ).T.fillna(0)
+        self.csv_df_combined = pd.concat(
+            [self.csv_df_combined, compass_hot_end], axis=1
+        )
+
+    def calc_45_degree_direction_switches(self):
+        self.grouped_df = pd.DataFrame()
+        v = (
+            self.csv_df_combined["Compass_digit"]
+            != self.csv_df_combined["Compass_digit"].shift()
+        ).cumsum()
+        u = self.csv_df_combined.groupby(v)["Compass_digit"].agg(["all", "count"])
+        m = u["all"] & u["count"].ge(1)
+        self.grouped_df["groups"] = self.csv_df_combined.groupby(v).apply(
+            lambda x: (x.index[0], x.index[-1])
+        )[m]
+        currdirectionList, DirectionSwitchIndexList, currdirectionListValue = [], [], []
+        for indexes, row in self.grouped_df.iterrows():
+            currdirectionList.append(
+                self.csv_df_combined.loc[row["groups"][0]]["Compass_direction"]
+            )
+            DirectionSwitchIndexList.append(row["groups"][1])
+            currdirectionListValue.append(
+                self.csv_df_combined.loc[row["groups"][0]]["Compass_digit"]
+            )
+        self.grouped_df["Direction_switch"] = currdirectionList
+        self.grouped_df["Direction_value"] = currdirectionListValue
+        self.csv_df_combined.loc[DirectionSwitchIndexList, "Direction_switch"] = 1
+        self.csv_df_combined["Compass_digit_shifted"] = self.csv_df_combined[
+            "Compass_digit"
+        ].shift(-1)
+        self.csv_df_combined = self.csv_df_combined.fillna(0)
+        self.csv_df_combined["Switch_direction_value"] = self.csv_df_combined.apply(
+            lambda x: self.calc_switch_direction(
+                x["Compass_digit_shifted"], x["Compass_digit"]
+            ),
+            axis=1,
+        )
+
+    def calc_switch_direction(self, compass_digit_shifted, compass_digit):
+        if (compass_digit_shifted == "0") and (compass_digit == "7"):
+            return 1
+        else:
+            return int(compass_digit_shifted) - int(compass_digit)
+
+    def calc_border_distances(self):
+        for bp in self.bp_names:
+            self.csv_df_combined[f"{bp}_distance_to_left_border"] = (
+                self.csv_df_combined[f"{bp}_x"] / self.px_per_mm
+            )
+            self.csv_df_combined[f"{bp}_distance_to_right_border"] = (
+                self.video_width - self.csv_df_combined[f"{bp}_x"]
+            ) / self.px_per_mm
+            self.csv_df_combined[f"{bp}_distance_to_top_border"] = (
+                self.csv_df_combined[f"{bp}_y"] / self.px_per_mm
+            )
+            self.csv_df_combined[f"{bp}_distance_to_bottom_border"] = (
+                self.video_height - self.csv_df_combined[f"{bp}_y"]
+            ) / self.px_per_mm
+
+        for side in ["left", "right", "top", "bottom"]:
+            side_col_names = [
+                c
+                for c in self.csv_df_combined.columns
+                if f"distance_to_{side}_border" in c
+            ]
+            self.csv_df_combined[f"Mean_bp_distance_to_{side}_border"] = (
+                self.csv_df_combined[side_col_names].mean(axis=1)
+            )
+            for window in self.roll_windows_values:
+                self.csv_df_combined[f"Mean_bp_distance_to_{side}_border_{window}"] = (
+                    self.csv_df_combined[f"Mean_bp_distance_to_{side}_border"]
+                    .rolling(window, min_periods=1)
+                    .mean()
+                )
+                self.csv_df_combined[f"Std_bp_distance_to_{side}_border_{window}"] = (
+                    self.csv_df_combined[f"Mean_bp_distance_to_{side}_border"]
+                    .rolling(window, min_periods=1)
+                    .std()
+                )
+                try:
+                    # self.csv_df_combined[f'Kurtosis_bp_distance_to_{side}_border_{window}'] = self.csv_df_combined[f'Mean_bp_distance_to_{side}_border'].rolling(window, min_periods=window).kurt()
+                    self.csv_df_combined[
+                        f"Skew_bp_distance_to_{side}_border_{window}"
+                    ] = (
+                        self.csv_df_combined[f"Mean_bp_distance_to_{side}_border"]
+                        .rolling(window, min_periods=window)
+                        .skew()
+                    )
+                except:
+                    # self.csv_df_combined[f'Kurtosis_bp_distance_to_{side}_border_{window}'] = -1
+                    self.csv_df_combined[
+                        f"Skew_bp_distance_to_{side}_border_{window}"
+                    ] = -1
+
+    def calc_distances_between_body_part(self):
+        two_point_combs = np.array(list(combinations(self.bp_names, 2)))
+        distance_fields = []
+        for bps in two_point_combs:
+            self.csv_df_combined[f"Distance_{bps[0]}_{bps[1]}"] = (
+                self.euclidian_distance_calc(
+                    self.csv_df_combined[bps[0] + "_x"].values,
+                    self.csv_df_combined[bps[0] + "_y"].values,
+                    self.csv_df_combined[bps[1] + "_x"].values,
+                    self.csv_df_combined[bps[1] + "_y"].values,
+                )
+                / self.px_per_mm
+            )
+            distance_fields.append(f"Distance_{bps[0]}_{bps[1]}")
+
+        for distance_field in distance_fields:
+            for window in self.roll_windows_values:
+                self.csv_df_combined[f"{distance_field}_mean_{window}"] = (
+                    self.csv_df_combined[distance_field]
+                    .rolling(window, min_periods=1)
+                    .mean()
+                )
+                self.csv_df_combined[f"{distance_field}_std_{window}"] = (
+                    self.csv_df_combined[distance_field]
+                    .rolling(window, min_periods=1)
+                    .std()
+                )
+                try:
+                    self.csv_df_combined[f"{distance_field}_skew_{window}"] = (
+                        self.csv_df_combined[distance_field]
+                        .rolling(window, min_periods=1)
+                        .skew()
+                    )
+                    self.csv_df_combined[f"{distance_field}_kurtosis_{window}"] = (
+                        self.csv_df_combined[distance_field]
+                        .rolling(window, min_periods=1)
+                        .kurt()
+                    )
+                except:
+                    self.csv_df_combined[f"{distance_field}_skew_{window}"] = -1
+                    self.csv_df_combined[f"{distance_field}_kurtosis_{window}"] = -1
+
+    def calc_convex_hulls(self):
+        fish_array = np.reshape(
+            self.csv_df[self.x_y_cols].values, (len(self.csv_df / 2), -1, 2)
+        )
+        self.csv_df_combined["Convex_hull"] = Parallel(
+            n_jobs=-1, verbose=0, backend="threading"
+        )(
+            delayed(self.convex_hull_calculator_mp)(x, self.px_per_mm)
+            for x in fish_array
+        )
+        for window in self.roll_windows_values:
+            self.csv_df_combined[f"Convex_hull_mean_{window}_window"] = (
+                self.csv_df_combined["Convex_hull"]
+                .rolling(window, min_periods=1)
+                .mean()
+            )
+            self.csv_df_combined[f"Convex_hull_std_{window}_window"] = (
+                self.csv_df_combined["Convex_hull"].rolling(window, min_periods=1).std()
+            )
+            self.csv_df_combined[f"Convex_hull_min_{window}_window"] = (
+                self.csv_df_combined["Convex_hull"].rolling(window, min_periods=1).min()
+            )
+            self.csv_df_combined[f"Convex_hull_max_{window}_window"] = (
+                self.csv_df_combined["Convex_hull"].rolling(window, min_periods=1).max()
+            )
+            self.csv_df_combined[
+                f"Absolute_diff_min_max_convex_hull_{window}_window"
+            ] = abs(
+                self.csv_df_combined[f"Convex_hull_min_{window}_window"]
+                - self.csv_df_combined[f"Convex_hull_max_{window}_window"]
+            )
+            try:
+                self.csv_df_combined[f"Convex_hull_skew_{window}"] = (
+                    self.csv_df_combined["Convex_hull"]
+                    .rolling(window, min_periods=1)
+                    .skew()
+                )
+                self.csv_df_combined[f"Convex_hull_kurtosis_{window}"] = (
+                    self.csv_df_combined["Convex_hull"]
+                    .rolling(window, min_periods=1)
+                    .kurt()
+                )
+            except:
+                self.csv_df_combined[f"Convex_hull_skew_{window}"] = -1
+                self.csv_df_combined[f"Convex_hull_kurtosis_{window}"] = -1
+
+    def distribution_tests(self):
+        distribution_features = [
+            "Mean_bp_distance_to_left_border",
+            "Mean_bp_distance_to_right_border",
+            "Mean_bp_distance_to_top_border",
+            "Mean_bp_distance_to_bottom_border",
+            "Bp_velocity_mean",
+            "Bp_acceleration_mean_25_window",
+            "Clockwise_angle_degrees",
+            "Convex_hull",
+            "Sum_probabilities",
+            "Consecutive_ms_in_same_compass_direction",
+        ]
+
+        for feature_name in distribution_features:
+            results = self.windowed_frequentist_distribution_tests(
+                data=self.csv_df_combined[feature_name].values,
+                feature_name=feature_name,
+                fps=int(self.fps),
+            )
+            self.csv_df_combined = pd.concat([self.csv_df_combined, results], axis=1)
+
+    def pose_confidence_probabilities(self):
+        self.csv_df_combined["Sum_probabilities"] = self.csv_df_combined[
+            self.p_cols
+        ].sum(axis=1)
+        self.csv_df_combined["Sum_probabilities_deviation"] = (
+            self.csv_df_combined["Sum_probabilities"].mean()
+            - self.csv_df_combined["Sum_probabilities"]
+        )
+        p_brackets_results = pd.DataFrame(
+            self.count_values_in_range(
+                data=self.csv_df_combined.filter(self.p_cols).values,
+                ranges=np.array(
+                    [
+                        [0.0, 0.1],
+                        [0.000000000, 0.5],
+                        [0.000000000, 0.75],
+                        [0.000000000, 0.95],
+                        [0.000000000, 0.99],
+                    ]
+                ),
+            ),
+            columns=[
+                "Low_prob_detections_0.1",
+                "Low_prob_detections_0.5",
+                "Low_prob_detections_0.75",
+                "Low_prob_detections_0.95",
+                "Low_prob_detections_0.99",
+            ],
+        )
+        self.csv_df_combined = (
+            pd.concat([self.csv_df_combined, p_brackets_results], axis=1)
+            .reset_index(drop=True)
+            .fillna(0)
+        )
+
+    def save_file(self):
+        self.csv_df_combined = self.csv_df_combined.drop(
+            self.col_headers_shifted, axis=1
+        )
+        self.csv_df_combined = self.csv_df_combined.drop(
+            [
+                "Compass_digit_shifted",
+                "Direction_switch",
+                "Switch_direction_value",
+                "Compass_digit",
+                "Compass_direction",
+                "Angle_sin_cumsum",
+                "Angle_cos_cumsum",
+            ],
+            axis=1,
+        ).fillna(0)
+        write_df(
+            self.csv_df_combined.astype(np.float32), self.file_type, self.save_path
+        )
 
 
-feature_extractor = TwoFishFeatureExtractor(config_path='/Users/simon/Desktop/envs/simba/troubleshooting/two_fish/project_folder/project_config.ini')
-feature_extractor.run()
+# test = FishFeatureExtractor(config_path='/Users/simon/Desktop/envs/troubleshooting/naresh/project_folder/project_config.ini')
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/piotr_120324 3.py.zip` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/piotr_120324 3.py.zip`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/dunn_index.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/dunn_index.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/hausdorff.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/hausdorff.py`

 * *Files 4% similar despite different names*

```diff
@@ -14,14 +14,20 @@
     from each point in one set to the nearest point in the other set.
 
     Hausdorff distance can be used to measure the similarity of the geometry in one frame relative to the geometry in the next frame.
     Large values indicate that the animal has a different shape than in the preceding shape.
 
     :param List[List[Union[Polygon, LineString]]] geometries: List of list where each list has two geometries.
     :return np.ndarray: 1D array of hausdorff distances of geometries in each list.
+
+    :example:
+    >>> x = Polygon([[0,1], [0, 2], [1,1]])
+    >>> y = Polygon([[0,1], [0, 2], [0,1]])
+    >>> hausdorff_distance(geometries=[[x, y]])
+    >>> [1.]
     """
 
     check_instance(source=hausdorff_distance.__name__, instance=geometries, accepted_types=(list,))
     for i in geometries:
         check_valid_lst(source=hausdorff_distance.__name__, data=i, valid_dtypes=(Polygon, LineString,), exact_len=2)
     results = np.full((len(geometries)), np.nan)
     for i in range(len(geometries)):
@@ -59,18 +65,17 @@
 
 
 
 
 
 #
 #
-# x = Polygon([[0,1], [0, 2], [1,1]])
-# y = Polygon([[0,1], [0, 2], [0,1]])
+
+#
 #
-# data = [[x, y]]
 # hausdorff(geometries=data)
 #
 #
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/peaks.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/peaks.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/fish_feature_extractor_2022.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/fish_feature_extractor_2022.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/colinear_features.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/colinear_features.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/spontaneous_alternation_calculator.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/spontaneous_alternation_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/convex_hull_3_scratch_3.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/convex_hull_3_scratch_3.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/silhouette_score.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/silhouette_score.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/cuda_jit.ipynb` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/cuda_jit.ipynb`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/convex_hull_scratch_1.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/convex_hull_scratch_1.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/directed_hausdorff.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/directed_hausdorff.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/shannon_diversity_index.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/shannon_diversity_index.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/sequential_lag_analysis.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/sequential_lag_analysis.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/wilcoxon.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/wilcoxon.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/.DS_Store` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/.DS_Store`

 * *Files 3% similar despite different names*

```diff
@@ -15,18 +15,18 @@
 000000e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000100: 0000 0000 0000 0000 0000 0004 0000 000b  ................
 00000110: 005f 005f 0070 0079 0063 0061 0063 0068  ._._.p.y.c.a.c.h
 00000120: 0065 005f 005f 6c67 3153 636f 6d70 0000  .e._._lg1Scomp..
 00000130: 0000 0001 1263 0000 000b 005f 005f 0070  .....c....._._.p
 00000140: 0079 0063 0061 0063 0068 0065 005f 005f  .y.c.a.c.h.e._._
-00000150: 6d6f 4444 626c 6f62 0000 0008 cf22 c416  moDDblob....."..
-00000160: dcda c541 0000 000b 005f 005f 0070 0079  ...A....._._.p.y
+00000150: 6d6f 4444 626c 6f62 0000 0008 acfd 3341  moDDblob......3A
+00000160: c3e2 c541 0000 000b 005f 005f 0070 0079  ...A....._._.p.y
 00000170: 0063 0061 0063 0068 0065 005f 005f 6d6f  .c.a.c.h.e._._mo
-00000180: 6444 626c 6f62 0000 0008 cf22 c416 dcda  dDblob....."....
+00000180: 6444 626c 6f62 0000 0008 acfd 3341 c3e2  dDblob......3A..
 00000190: c541 0000 000b 005f 005f 0070 0079 0063  .A....._._.p.y.c
 000001a0: 0061 0063 0068 0065 005f 005f 7068 3153  .a.c.h.e._._ph1S
 000001b0: 636f 6d70 0000 0000 0001 5000 0000 0000  comp......P.....
 000001c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/data.npy` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/data.npy`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/distances.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/distances.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/fish_feature_extractor_2023_version_2.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/fish_feature_extractor_2023_version_2.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/cohens_kappa.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/cohens_kappa.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/paths.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/paths.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/outliers_tietjen.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/outliers_tietjen.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/train_model.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/train_model.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/amber_tests.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/amber_tests.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/line_locate_point.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/line_locate_point.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/multifrm_to_points.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/multifrm_to_points.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/egocentrical_aligner.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/egocentrical_aligner.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/add_body_part.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/add_body_part.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/grubbs_test.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/grubbs_test.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/slide_circ_mean.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/slide_circ_mean.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/calinski_harabasz.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/calinski_harabasz.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/roi_feature_visualizer_example.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/roi_feature_visualizer_example.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/spontaneuous_alternation_plotter.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/spontaneuous_alternation_plotter.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/runs_test.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/runs_test.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/total_variation_distance.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/total_variation_distance.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/crop_single_polygon.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/crop_single_polygon.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/joint_plotter.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/joint_plotter.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/elliptic_envelope.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/elliptic_envelope.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/roi_definition_csvs_to_h5.py.zip` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/roi_definition_csvs_to_h5.py.zip`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/add_body_part.py.zip` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/add_body_part.py.zip`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/roi_feature_visualizer_example.py.zip` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/roi_feature_visualizer_example.py.zip`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/count_values_in_range.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/count_values_in_range.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/roi_definition_csvs_to_h5.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/roi_definition_csvs_to_h5.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/distance_velocity.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/distance_velocity.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/graph_creator.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/graph_creator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/termite_rois.csv` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/termite_rois.csv`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/unsupervised_lof.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/unsupervised_lof.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/siegel_tukey.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/siegel_tukey.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/berger_parker.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/berger_parker.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/davis_bouldin.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/davis_bouldin.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/crop_circles_pop_up.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/crop_circles_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/heading.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/heading.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/piotr_120324 2.py.zip` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/piotr_120324 2.py.zip`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/mutual_exclusive.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/mutual_exclusive.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/grangercausalitytests.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/grangercausalitytests.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/multiframe_is_shape_covered.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/multiframe_is_shape_covered.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/redis.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/redis.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/video_color.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/video_color.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/graph_3d_plotter.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/graph_3d_plotter.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/piotr_120324.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/piotr_120324.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/video_rotator.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/video_rotator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/hartley_fmax.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/hartley_fmax.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/fix_clahe.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/fix_clahe.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/cochran_q.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/cochran_q.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/menhinicks_index.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/menhinicks_index.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/add_probability_cnt_features.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/add_probability_cnt_features.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/spontanous_alternations.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/spontanous_alternations.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/piotr_120324.py.zip` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/piotr_120324.py.zip`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/velocity_aggregator.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/velocity_aggregator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/make_splash.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/make_splash.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/fish_feature_extractor_2023_version_5.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/fish_feature_extractor_2023_version_4.py`

 * *Files 0% similar despite different names*

```diff
@@ -12,21 +12,21 @@
 from scipy import stats
 from scipy.signal import find_peaks
 from scipy.spatial import ConvexHull
 from scipy.spatial.qhull import QhullError
 from scipy.stats import zscore
 from statsmodels.stats.diagnostic import lilliefors
 
+from simba.enums import Paths
 from simba.mixins.config_reader import ConfigReader
 from simba.mixins.feature_extraction_mixin import FeatureExtractionMixin
-from simba.utils.enums import Paths
+from simba.read_config_unit_tests import (check_if_filepath_list_is_empty,
+                                          read_project_path_and_file_type)
 from simba.utils.printing import SimbaTimer
-from simba.utils.read_write import (check_if_filepath_list_is_empty,
-                                    get_fn_ext, read_config_file, read_df,
-                                    read_project_path_and_file_type,
+from simba.utils.read_write import (get_fn_ext, read_config_file, read_df,
                                     read_video_info, write_df)
 
 TAIL_BP_NAMES = ["objectA", "peduncle_base"]
 CENTER_BP_NAMES = ["midpoint"]
 MOUTH = ["mouth"]
 
 ANGULAR_DISPERSION_S = [10, 5, 2, 1, 0.5, 0.25]
@@ -98,15 +98,15 @@
         print(
             "Extracting features from {} {}...".format(
                 str(len(self.files_found)), "file(s)"
             )
         )
 
         for file_path in self.files_found:
-            video_timer = SimbaTimer(start=True)
+            video_timer = SimbaTimer()
             video_timer.start_timer()
             dir_name, file_name, ext = get_fn_ext(file_path)
             self.save_path = os.path.join(self.save_dir, os.path.basename(file_path))
             video_info, self.px_per_mm, self.fps = read_video_info(
                 self.video_info_df, file_name
             )
             self.video_width, self.video_height = (
@@ -119,15 +119,15 @@
                     int(self.fps * ANGULAR_DISPERSION_S[i])
                 )
 
             self.csv_df = (
                 read_df(file_path, self.file_type).fillna(0).apply(pd.to_numeric)
             )
             try:
-                self.csv_df.columns = self.bp_headers
+                self.csv_df.columns = self.bp_col_names
             except ValueError:
                 msg = f"ERROR: Data contains the following fields: {self.csv_df.columns}. \n SimBA wants to use the following field names {self.bp_header_list}"
                 print(msg)
                 raise ValueError(msg)
 
             csv_df_shifted = self.csv_df.shift(periods=1)
             csv_df_shifted.columns = self.col_headers_shifted
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/simpson_diversity_index.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/simpson_diversity_index.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/piotr_120324 4.py.zip` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/piotr_120324 4.py.zip`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/geometry_ex.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/geometry_ex.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/time_stamp_calculator.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/time_stamp_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/line_plot.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/line_plot.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/video_rotator_mp.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/video_rotator_mp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/statistics_ex.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/statistics_ex.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/sliding_displacement.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/sliding_displacement.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/wald_wolfowitz.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/wald_wolfowitz.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/linestring_path.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/linestring_path.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/cronbach_alpha.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/cronbach_alpha.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/mcnamar.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/mcnamar.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/AmberFeatureExtractor.py.zip` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/AmberFeatureExtractor.py.zip`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/amber_featurizer.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/amber_featurizer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/margalef_diversification_index.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/margalef_diversification_index.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/biweight_midcorrelation.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/biweight_midcorrelation.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/madmedianrule.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/madmedianrule.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/adjusted_rand_score.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/adjusted_rand_score.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/sandbox/convex_hull_scratch_2.py` & `Simba-UW-tf-dev-1.89.5/simba/sandbox/convex_hull_scratch_2.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/directing_animals_to_bodypart_visualizer.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/directing_animals_to_bodypart_visualizer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/gantt_creator.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/gantt_creator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/tools/tkinter_tools.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/tools/tkinter_tools.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/ROI_plotter_mp.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/ROI_plotter_mp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/.DS_Store` & `Simba-UW-tf-dev-1.89.5/simba/plotting/.DS_Store`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/shap_agg_stats_visualizer.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/shap_agg_stats_visualizer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/gantt_creator_mp.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/gantt_creator_mp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/heat_mapper_clf_mp.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/heat_mapper_clf_mp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/probability_plot_creator.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/probability_plot_creator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/circular_plotting.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/circular_plotting.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/plot_clf_results.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/plot_clf_results.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/plot_clf_results_mp.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/plot_clf_results_mp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/ROI_feature_visualizer.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/ROI_feature_visualizer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/heat_mapper_location.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/heat_mapper_location.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/probability_plot_creator_mp.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/probability_plot_creator_mp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/interactive_probability_grapher.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/interactive_probability_grapher.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/plot_pose_in_dir.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/plot_pose_in_dir.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/single_run_model_validation_video.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/single_run_model_validation_video.py`

 * *Files 0% similar despite different names*

```diff
@@ -335,15 +335,14 @@
         stdout_success(
             msg=f"Validation video saved at {self.vid_output_path}",
             elapsed_time=self.timer.elapsed_time_str,
             source=self.__class__.__name__,
         )
 
 
-
 # test = ValidateModelOneVideo(config_path=r'/Users/simon/Desktop/envs/simba/troubleshooting/mouse_open_field/project_folder/project_config.ini',
 #                              feature_file_path='/Users/simon/Desktop/envs/simba/troubleshooting/mouse_open_field/project_folder/csv/features_extracted/SI_DAY3_308_CD1_PRESENT.csv',
 #                              model_path='/Users/simon/Desktop/envs/simba/troubleshooting/mouse_open_field/models/generated_models/Running.sav',
 #                              discrimination_threshold=0.6,
 #                              shortest_bout=50,
 #                              settings={'pose': True, 'animal_names': True, 'styles': None},
 #                              create_gantt=None)
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/frame_mergerer_ffmpeg.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/heat_mapper_location_mp.py`

 * *Files 26% similar despite different names*

```diff
@@ -1,354 +1,322 @@
-__author__ = "Simon Nilsson"
-
+import functools
+import multiprocessing
 import os
-import shutil
-import subprocess
-from datetime import datetime
-from typing import Dict, Optional
-
-try:
-    from typing import Literal
-except ImportError:
-    from typing_extensions import Literal
+import platform
+from typing import Dict, List, Tuple
+
+import cv2
+import matplotlib.pyplot as plt
+import numpy as np
+import pandas as pd
+from numba import jit, prange
 
 from simba.mixins.config_reader import ConfigReader
-from simba.utils.checks import check_nvidea_gpu_available
-from simba.utils.enums import Paths, TagNames
-from simba.utils.errors import FFMPEGCodecGPUError
+from simba.mixins.geometry_mixin import GeometryMixin
+from simba.mixins.plotting_mixin import PlottingMixin
+from simba.utils.enums import Defaults, Formats, TagNames
+from simba.utils.errors import NoSpecifiedOutputError
 from simba.utils.printing import SimbaTimer, log_event, stdout_success
-from simba.utils.read_write import (get_fn_ext, get_video_meta_data,
-                                    read_config_entry, read_config_file,
+from simba.utils.read_write import (concatenate_videos_in_folder,
+                                    find_core_cnt, get_fn_ext, read_df,
                                     remove_a_folder)
 
 
-class FrameMergererFFmpeg(ConfigReader):
+def _heatmap_location(
+    data: np.array,
+    video_setting: bool,
+    frame_setting: bool,
+    video_temp_dir: str,
+    video_name: str,
+    frame_dir: str,
+    fps: int,
+    style_attr: dict,
+    max_scale: float,
+    aspect_ratio: float,
+    size: tuple,
+    make_location_heatmap_plot: PlottingMixin.make_location_heatmap_plot,
+):
+
+    group = int(data[0][0][1])
+    if video_setting:
+        fourcc = cv2.VideoWriter_fourcc(*Formats.MP4_CODEC.value)
+        video_save_path = os.path.join(video_temp_dir, "{}.mp4".format(str(group)))
+        video_writer = cv2.VideoWriter(video_save_path, fourcc, fps, size)
+
+    for i in range(data.shape[0]):
+        frame_id = int(data[i, 0, 0])
+        frm_data = data[i, :, 2:]
+
+        img = make_location_heatmap_plot(
+            frm_data=frm_data,
+            max_scale=float(max_scale),
+            palette=style_attr["palette"],
+            aspect_ratio=aspect_ratio,
+            shading=style_attr["shading"],
+            img_size=size,
+            file_name=None,
+            final_img=False,
+        )
+
+        print(
+            "Heatmap frame created: {}, Video: {}, Processing core: {}".format(
+                str(frame_id + 1), video_name, str(group + 1)
+            )
+        )
+
+        if video_setting:
+            video_writer.write(img)
+
+        if frame_setting:
+            file_path = os.path.join(frame_dir, "{}.png".format(frame_id))
+            cv2.imwrite(file_path, img)
+
+    if video_setting:
+        video_writer.release()
+
+    return group
+
+
+class HeatMapperLocationMultiprocess(ConfigReader, PlottingMixin):
     """
-    Merge separate visualizations of classifications, descriptive statistics etc., into  single video mosaic.
+    Create heatmaps representing the location where animals spend time.
 
-    .. note::
-       `GitHub tutorial <https://github.com/sgoldenlab/simba/blob/master/docs/tutorial.md#step-12-merge-frames>`_.
+    ..note::
+       `GitHub visualizations tutorial <https://github.com/sgoldenlab/simba/blob/master/docs/tutorial.md#step-11-visualizations>`__.
 
-        .. image:: _static/img/mosaic_videos.gif
-          :width: 600
-          :align: center
-
-    :parameter str config_path: path to SimBA project config file in Configparser format
-    :parameter str concat_type: Type of concatenation. OPTIONS: 'horizontal', 'vertical', 'mosaic', 'mixed_mosaic'.
-    :parameter dict frame_types: Dict holding video path to videos to concatenate. E.g., {'Video 1': path, 'Video 2': path}
-    :parameter int video_height: Output video height.
-    :parameter int video_width: Output video width.
-    :parameter Optional[bool] gpu: If True, use NVIDEA FFMpeg GPU codecs. Default False.
-
-    Example
-    ----------
-    >>> frame_types={'Video 1': 'project_folder/videos/Video_1.avi', 'Video 2': 'project_folder/videos/Video_2.avi'}
-    >>> video_height, video_width, concat_type = 640, 480, 'vertical'
-    >>> FrameMergererFFmpeg(config_path='MySimBaConfigPath', frame_types=frame_types, video_height=video_height, video_width=video_width, concat_type=concat_type)
+    .. image:: _static/img/heatmap_location.gif
+       :width: 500
+       :align: center
+
+    :param str config_path: path to SimBA project config file in Configparser format
+    :param str bodypart: The name of the body-part used to infer the location of the animal.
+    :param int bin_size: The rectangular size of each heatmap location in millimeters. For example, `50` will divide the video frames into 5 centimeter rectangular spatial bins.
+    :param str palette:  Heatmap pallette. Eg. 'jet', 'magma', 'inferno','plasma', 'viridis', 'gnuplot2'
+    :param dict style_attr: Style attributes of heatmap {'palette': 'jet', 'shading': 'gouraud', 'bin_size': 100, 'max_scale': 'auto'}
+    :param bool final_img_setting: If True, create a single image representing the last frame of the input video
+    :param bool video_setting: If True, then create a video of heatmaps.
+    :param bool frame_setting: If True, then create individual heatmap frames.
+    :param int core_cnt: The number of CPU cores to use. If -1, then all available cores.
+
+    :example:
+    >>> style_attr = {'palette': 'jet', 'shading': 'gouraud', 'bin_size': 100, 'max_scale': 'auto'}
+    >>> heatmapper = HeatMapperLocationMultiprocess(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini', style_attr = style_attr, core_cnt=-1, final_img_setting=True, video_setting=True, frame_setting=False, bodypart='Nose_1', files_found=['/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/csv/machine_results/Together_1.csv'])
+    >>> heatmapper.run()
     """
 
     def __init__(
         self,
-        concat_type: Literal["horizontal", "vertical", "mosaic", "mixed_mosaic"],
-        frame_types: Dict[str, str],
-        video_height: int,
-        video_width: int,
-        config_path: Optional[str] = None,
-        gpu: Optional[bool] = False,
+        config_path: str,
+        final_img_setting: bool,
+        video_setting: bool,
+        frame_setting: bool,
+        bodypart: str,
+        files_found: List[str],
+        style_attr: dict,
+        core_cnt: int,
     ):
-        if gpu and not check_nvidea_gpu_available():
-            raise FFMPEGCodecGPUError(
-                msg="NVIDEA GPU not available (as evaluated by nvidea-smi returning None",
+
+        if (not frame_setting) and (not video_setting) and (not final_img_setting):
+            raise NoSpecifiedOutputError(
+                msg="Please choose to select either heatmap videos, frames, and/or final image.",
                 source=self.__class__.__name__,
             )
-        self.timer = SimbaTimer(start=True)
-        self.datetime = datetime.now().strftime("%Y%m%d%H%M%S")
-        if config_path is not None:
-            ConfigReader.__init__(self, config_path=config_path)
-            log_event(
-                logger_name=str(__class__.__name__),
-                log_type=TagNames.CLASS_INIT.value,
-                msg=self.create_log_msg_from_init_args(locals=locals()),
-            )
-            self.output_dir = os.path.join(
-                self.project_path, Paths.CONCAT_VIDEOS_DIR.value
-            )
-            self.temp_dir = os.path.join(
-                self.project_path, Paths.CONCAT_VIDEOS_DIR.value, "temp"
-            )
-            self.output_path = os.path.join(
-                self.project_path,
-                Paths.CONCAT_VIDEOS_DIR.value,
-                f"merged_video_{self.datetime}.mp4",
-            )
-        else:
-            self.file_path = list(frame_types.values())[0]
-            self.output_dir, ss, df = get_fn_ext(filepath=self.file_path)
-            self.temp_dir = os.path.join(self.output_dir, "temp")
-            self.output_path = os.path.join(
-                self.output_dir, f"merged_video_{self.datetime}.mp4"
-            )
+        ConfigReader.__init__(self, config_path=config_path, create_logger=False)
+        PlottingMixin.__init__(self)
+        # log_event(logger_name=str(__class__.__name__), log_type=TagNames.CLASS_INIT.value, msg=self.create_log_msg_from_init_args(locals=locals()))
+        if platform.system() == "Darwin":
+            multiprocessing.set_start_method("spawn", force=True)
+        self.frame_setting, self.video_setting = frame_setting, video_setting
+        self.final_img_setting, self.bp = final_img_setting, bodypart
+        self.style_attr, self.files_found = style_attr, files_found
+        self.bin_size, self.max_scale, self.palette, self.shading, self.core_cnt = (
+            style_attr["bin_size"],
+            style_attr["max_scale"],
+            style_attr["palette"],
+            style_attr["shading"],
+            core_cnt,
+        )
+        if not os.path.exists(self.heatmap_location_dir):
+            os.makedirs(self.heatmap_location_dir)
+        self.bp_lst = [self.bp + "_x", self.bp + "_y"]
+        print("Processing {} video(s)...".format(str(len(self.files_found))))
+
+    @staticmethod
+    @jit(nopython=True)
+    def __insert_group_idx_column(data: np.array, group: int, last_frm_idx: int):
+
+        results = np.full((data.shape[0], data.shape[1], data.shape[2] + 2), np.nan)
+        group_col = np.full((data.shape[1], 1), group)
+        for frm_idx in prange(data.shape[0]):
+            h_stack = np.hstack((group_col, data[frm_idx]))
+            frm_col = np.full((h_stack.shape[0], 1), frm_idx + last_frm_idx)
+            results[frm_idx] = np.hstack((frm_col, h_stack))
+        return results
+
+    def run(self):
+        for file_cnt, file_path in enumerate(self.files_found):
+            video_timer = SimbaTimer(start=True)
+            _, self.video_name, _ = get_fn_ext(file_path)
+            self.video_info, self.px_per_mm, self.fps = self.read_video_info(
+                video_name=self.video_name
+            )
+            self.width, self.height = int(
+                self.video_info["Resolution_width"].values[0]
+            ), int(self.video_info["Resolution_height"].values[0])
+            self.save_frame_folder_dir = os.path.join(
+                self.heatmap_location_dir, self.video_name
+            )
+            self.video_folder = os.path.join(self.heatmap_location_dir, self.video_name)
+            self.temp_folder = os.path.join(
+                self.heatmap_location_dir, self.video_name, "temp"
+            )
+            if self.frame_setting:
+                if os.path.exists(self.save_frame_folder_dir):
+                    remove_a_folder(folder_dir=self.save_frame_folder_dir)
+                if not os.path.exists(self.save_frame_folder_dir):
+                    os.makedirs(self.save_frame_folder_dir)
+            if self.video_setting:
+                if os.path.exists(self.temp_folder):
+                    remove_a_folder(folder_dir=self.temp_folder)
+                    remove_a_folder(folder_dir=self.video_folder)
+                os.makedirs(self.temp_folder)
+                self.save_video_path = os.path.join(
+                    self.heatmap_location_dir, f"{self.video_name}.mp4"
+                )
+
+            self.data_df = read_df(
+                file_path=file_path, file_type=self.file_type, usecols=self.bp_lst
+            )
+            squares, aspect_ratio = GeometryMixin().bucket_img_into_grid_square(
+                bucket_grid_size_mm=self.style_attr["bin_size"],
+                img_size=(self.width, self.height),
+                px_per_mm=self.px_per_mm,
+            )
+            cum_sum_squares = GeometryMixin().cumsum_coord_geometries(
+                data=self.data_df.values, fps=self.fps, geometries=squares
+            )
+            if self.max_scale == "auto":
+                self.max_scale = np.round(
+                    np.max(np.max(cum_sum_squares[-1], axis=0)), 3
+                )
+                if self.max_scale == 0:
+                    self.max_scale = 1
+            else:
+                self.max_scale = self.style_attr["max_scale"]
 
-        self.video_height, self.video_width, self.gpu = video_height, video_width, gpu
-        self.frame_types, self.concat_type = frame_types, concat_type
-        self.video_cnt = len(self.frame_types.keys())
-        self.even_bool = (len(self.frame_types.keys()) % 2) == 0
-        self.blank_path = os.path.join(self.temp_dir, "blank.mp4")
-        if not os.path.exists(self.output_dir):
-            os.makedirs(self.output_dir)
-        if not os.path.exists(self.temp_dir):
-            os.makedirs(self.temp_dir)
-        if concat_type == "horizontal":
-            self.__horizontal_concatenator(
-                out_path=self.output_path, frames_dict=self.frame_types, final_img=True
-            )
-        elif concat_type == "vertical":
-            self.__vertical_concatenator(
-                out_path=self.output_path, frames_dict=self.frame_types, final_img=True
-            )
-        elif concat_type == "mosaic":
-            self.__mosaic_concatenator(
-                output_path=self.output_path,
-                frames_dict=self.frame_types,
-                final_img=True,
-            )
-        elif concat_type == "mixed_mosaic":
-            self.__mixed_mosaic_concatenator()
-        remove_a_folder(folder_dir=self.temp_dir)
-
-    def __resize_height(self, new_height: int):
-        for video_cnt, (video_type, video_path) in enumerate(self.frame_types.items()):
-            video_meta_data = get_video_meta_data(video_path=video_path)
-            out_path = os.path.join(self.temp_dir, video_type + ".mp4")
-            if video_meta_data["height"] != new_height:
-                print("Resizing {}...".format(video_type))
-                if self.gpu:
-                    command = 'ffmpeg -y -hwaccel auto -c:v h264_cuvid -i "{}" -vf scale_npp=-2:{} -c:v h264_nvenc "{}" -hide_banner -loglevel error -y'.format(
-                        video_path, new_height, out_path
+            if self.final_img_setting:
+                self.make_location_heatmap_plot(
+                    frm_data=cum_sum_squares[-1, :, :],
+                    max_scale=self.max_scale,
+                    palette=self.palette,
+                    aspect_ratio=aspect_ratio,
+                    file_name=os.path.join(
+                        self.heatmap_location_dir, self.video_name + "_final_frm.png"
+                    ),
+                    shading=self.shading,
+                    img_size=(self.width, self.height),
+                    final_img=True,
+                )
+
+            if self.video_setting or self.frame_setting:
+                print("Creating video frames...")
+                frame_arrays = np.array_split(cum_sum_squares, self.core_cnt)
+                last_frm_idx = 0
+                for frm_group in range(len(frame_arrays)):
+                    split_arr = frame_arrays[frm_group]
+                    frame_arrays[frm_group] = self.__insert_group_idx_column(
+                        data=split_arr, group=frm_group, last_frm_idx=last_frm_idx
                     )
-                else:
-                    command = 'ffmpeg -y -i "{}" -vf scale=-2:{} "{}" -hide_banner -loglevel error -y'.format(
-                        video_path, new_height, out_path
+                    last_frm_idx = np.max(
+                        frame_arrays[frm_group].reshape(
+                            (frame_arrays[frm_group].shape[0], -1)
+                        )
                     )
-                subprocess.call(command, shell=True, stdout=subprocess.PIPE)
-            else:
-                shutil.copy(video_path, out_path)
 
-    def __resize_width(self, new_width: int):
-        """Helper to change the width of videos"""
-
-        for video_cnt, (video_type, video_path) in enumerate(self.frame_types.items()):
-            video_meta_data = get_video_meta_data(video_path=video_path)
-            out_path = os.path.join(self.temp_dir, video_type + ".mp4")
-            if video_meta_data["height"] != new_width:
-                print("Resizing {}...".format(video_type))
-                if self.gpu:
-                    command = 'ffmpeg -y -hwaccel auto -i "{}" -vf scale_npp={}:-2 -c:v h264_nvenc "{}" -hide_banner -loglevel error -y'.format(
-                        video_path, new_width, out_path
+                frm_per_core = frame_arrays[0].shape[0]
+                with multiprocessing.Pool(
+                    self.core_cnt, maxtasksperchild=self.maxtasksperchild
+                ) as pool:
+                    constants = functools.partial(
+                        _heatmap_location,
+                        video_setting=self.video_setting,
+                        frame_setting=self.frame_setting,
+                        style_attr=self.style_attr,
+                        fps=self.fps,
+                        video_temp_dir=self.temp_folder,
+                        frame_dir=self.save_frame_folder_dir,
+                        max_scale=self.max_scale,
+                        aspect_ratio=aspect_ratio,
+                        size=(self.width, self.height),
+                        video_name=self.video_name,
+                        make_location_heatmap_plot=self.make_location_heatmap_plot,
                     )
-                else:
-                    command = 'ffmpeg -y -i "{}" -vf scale={}:-2 "{}" -hide_banner -loglevel error -y'.format(
-                        video_path, new_width, out_path
+                    for cnt, result in enumerate(
+                        pool.imap(
+                            constants,
+                            frame_arrays,
+                            chunksize=self.multiprocess_chunksize,
+                        )
+                    ):
+                        print(
+                            "Image {}/{}, Video {}/{}...".format(
+                                str(int(frm_per_core * (result + 1))),
+                                str(len(self.data_df)),
+                                str(file_cnt + 1),
+                                str(len(self.files_found)),
+                            )
+                        )
+                    pool.terminate()
+                    pool.join()
+
+                if self.video_setting:
+                    print(
+                        "Joining {} multiprocessed heatmap location video...".format(
+                            self.video_name
+                        )
                     )
-                subprocess.call(command, shell=True, stdout=subprocess.PIPE)
-            else:
-                shutil.copy(video_path, out_path)
-
-    def __resize_width_and_height(self, new_width: int, new_height: int):
-        """Helper to change the width and height videos"""
-
-        for video_cnt, (video_type, video_path) in enumerate(self.frame_types.items()):
-            video_meta_data = get_video_meta_data(video_path=video_path)
-            out_path = os.path.join(self.temp_dir, video_type + ".mp4")
-            if video_meta_data["height"] != new_width:
-                print("Resizing {}...".format(video_type))
-                if self.gpu:
-                    command = f'ffmpeg -y -hwaccel auto -c:v h264_cuvid -i "{video_path}" -vf "scale=w={new_width}:h={new_height}:force_original_aspect_ratio=decrease:flags=bicubic" -c:v h264_nvenc "{out_path}" -hide_banner -loglevel error -y'
-                else:
-                    command = 'ffmpeg -y -i "{}" -vf scale={}:{} "{}" -hide_banner -loglevel error -y'.format(
-                        video_path, new_width, new_height, out_path
+                    concatenate_videos_in_folder(
+                        in_folder=self.temp_folder, save_path=self.save_video_path
                     )
-                subprocess.call(command, shell=True, stdout=subprocess.PIPE)
-            else:
-                shutil.copy(video_path, out_path)
-
-    def __create_blank_video(self):
-        """Helper to create a blank (black) video"""
-        video_meta_data = get_video_meta_data(list(self.frame_types.values())[0])
-        if self.gpu:
-            cmd = 'ffmpeg -y -t {} -f lavfi -i color=c=black:s={}x{} -c:v h264_nvenc -preset slow -tune stillimage -pix_fmt yuv420p "{}" -hide_banner -loglevel error -y'.format(
-                str(video_meta_data["video_length_s"]),
-                str(self.video_width),
-                str(self.video_height),
-                self.blank_path,
-            )
-        else:
-            cmd = 'ffmpeg -y -t {} -f lavfi -i color=c=black:s={}x{} -c:v libx264 -tune stillimage -pix_fmt yuv420p "{}" -hide_banner -loglevel error -y'.format(
-                str(video_meta_data["video_length_s"]),
-                str(self.video_width),
-                str(self.video_height),
-                self.blank_path,
-            )
-        subprocess.call(cmd, shell=True, stdout=subprocess.PIPE)
-        self.frame_types["blank"] = self.blank_path
 
-    def __horizontal_concatenator(
-        self, frames_dict: dict, out_path: str, include_resize=True, final_img=True
-    ):
-        """Helper to horizontally concatenate N videos"""
-
-        if include_resize:
-            self.__resize_height(new_height=self.video_height)
-        video_path_str = ""
-        for video_type in frames_dict.keys():
-            video_path_str += ' -i "{}"'.format(
-                os.path.join(self.temp_dir, video_type + ".mp4")
-            )
-        if self.gpu:
-            cmd = 'ffmpeg -y{} -filter_complex "hstack=inputs={}" -c:v h264_nvenc -vsync 2 "{}" -hide_banner -loglevel error -y'.format(
-                video_path_str, str(len(frames_dict.keys())), out_path
-            )
-        else:
-            cmd = 'ffmpeg -y{} -filter_complex hstack=inputs={} -vsync 2 "{}" -hide_banner -loglevel error -y'.format(
-                video_path_str, str(len(frames_dict.keys())), out_path
-            )
-        print(
-            "Concatenating (horizontal) {} videos...".format(
-                str(len(frames_dict.keys()))
-            )
-        )
-        subprocess.call(cmd, shell=True, stdout=subprocess.PIPE)
-        if final_img:
-            self.timer.stop_timer()
-            stdout_success(
-                msg=f"Merged video saved at {out_path}",
-                elapsed_time=self.timer.elapsed_time_str,
-                source=self.__class__.__name__,
-            )
-
-    def __vertical_concatenator(
-        self, frames_dict: dict, out_path: str, include_resize=True, final_img=True
-    ):
-        """Helper to vertically concatenate N videos"""
+                video_timer.stop_timer()
+                print(
+                    "Heatmap video {} complete (elapsed time: {}s) ...".format(
+                        self.video_name, video_timer.elapsed_time_str
+                    )
+                )
 
-        if include_resize:
-            self.__resize_width(new_width=self.video_width)
-        video_path_str = ""
-        for video_type in frames_dict.keys():
-            video_path_str += ' -i "{}"'.format(
-                os.path.join(self.temp_dir, video_type + ".mp4")
-            )
-        if self.gpu:
-            cmd = 'ffmpeg -y{} -filter_complex "vstack=inputs={}" -c:v h264_nvenc -vsync 2 "{}" -hide_banner -loglevel error -y'.format(
-                video_path_str, str(len(frames_dict.keys())), out_path
-            )
-        else:
-            cmd = 'ffmpeg -y{} -filter_complex vstack=inputs={} -vsync 2 "{}" -hide_banner -loglevel error -y'.format(
-                video_path_str, str(len(frames_dict.keys())), out_path
-            )
-        print(
-            "Concatenating (vertical) {} videos...".format(str(len(frames_dict.keys())))
-        )
-        subprocess.call(cmd, shell=True, stdout=subprocess.PIPE)
-        if final_img:
             self.timer.stop_timer()
             stdout_success(
-                msg=f"Merged video saved at {out_path}",
+                msg=f"Heatmap location videos visualizations for {len(self.files_found)} videos created in project_folder/frames/output/heatmaps_locations directory",
                 elapsed_time=self.timer.elapsed_time_str,
                 source=self.__class__.__name__,
             )
 
-    def __mosaic_concatenator(
-        self, frames_dict: dict, output_path: str, final_img: bool
-    ):
-        self.__resize_width_and_height(
-            new_width=self.video_width, new_height=self.video_height
-        )
-        if not self.even_bool:
-            self.__create_blank_video()
-        lower_dict = dict(list(frames_dict.items())[len(frames_dict) // 2 :])
-        upper_dict = dict(list(frames_dict.items())[: len(frames_dict) // 2])
-        if (len(upper_dict.keys()) == 1) & (len(lower_dict.keys()) != 1):
-            upper_dict["blank"] = self.blank_path
-        if (len(lower_dict.keys()) == 1) & (len(upper_dict.keys()) != 1):
-            lower_dict["blank"] = self.blank_path
-        self.__horizontal_concatenator(
-            frames_dict=upper_dict,
-            out_path=os.path.join(self.temp_dir, "upper.mp4"),
-            include_resize=False,
-            final_img=False,
-        )
-        self.__horizontal_concatenator(
-            frames_dict=lower_dict,
-            out_path=os.path.join(self.temp_dir, "lower.mp4"),
-            include_resize=False,
-            final_img=False,
-        )
-        frames_dict = {
-            "upper": os.path.join(self.temp_dir, "upper.mp4"),
-            "lower": os.path.join(self.temp_dir, "lower.mp4"),
-        }
-        self.__vertical_concatenator(
-            frames_dict=frames_dict,
-            out_path=output_path,
-            include_resize=False,
-            final_img=final_img,
-        )
-
-    def __mixed_mosaic_concatenator(self):
-        large_mosaic_dict = {
-            str(list(self.frame_types.keys())[0]): str(
-                list(self.frame_types.values())[0]
-            )
-        }
-        del self.frame_types[str(list(self.frame_types.keys())[0])]
-        self.even_bool = (len(self.frame_types.keys()) % 2) == 0
-        output_path = os.path.join(self.temp_dir, "mosaic.mp4")
-        self.__mosaic_concatenator(
-            frames_dict=self.frame_types, output_path=output_path, final_img=False
-        )
-        self.frame_types = large_mosaic_dict
-        self.__resize_height(
-            new_height=get_video_meta_data(video_path=output_path)["height"]
-        )
-        self.frame_types = {
-            str(list(large_mosaic_dict.keys())[0]): os.path.join(
-                self.temp_dir, str(list(large_mosaic_dict.keys())[0]) + ".mp4"
-            ),
-            "mosaic": os.path.join(self.temp_dir, "mosaic.mp4"),
-        }
-        self.__horizontal_concatenator(
-            frames_dict=self.frame_types,
-            out_path=self.output_path,
-            include_resize=False,
-            final_img=True,
-        )
-
 
-# FrameMergererFFmpeg(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini',
-#                     frame_types={'Video 1': '/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/videos/Together_1.avi',
-#                                  'Video 2': '/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/videos/Together_1.avi'},
-#                     video_height=640,
-#                     video_width=480,
-#                     concat_type='vertical') #horizontal, vertical, mosaic, mixed_mosaic
-#
-#
-# FrameMergererFFmpeg(config_path=None,
-#                     frame_types={'Video 1': '/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/videos/Together_1.avi',
-#                                  'Video 2': '/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/videos/Together_1.avi'},
-#                     video_height=640,
-#                     video_width=480,
-#                     concat_type='vertical') #horizontal, vertical, mosaic, mixed_mosaic
-#
-#
-
-
-# FrameMergererFFmpeg(config_path=None,
-#                     frame_types={'Video 1': r'C:\Users\Nape_Computer_2\Desktop\test_videos\Box1_PM2_day_5_20211104T171021.mp4',
-#                                  'Video 2': r'C:\Users\Nape_Computer_2\Desktop\test_videos\Box1_PM2_day_5_20211104T171021.mp4',
-#                                  'Video 3': r'C:\Users\Nape_Computer_2\Desktop\test_videos\Box1_PM2_day_5_20211104T171021.mp4',
-#                                  'Video 4': r'C:\Users\Nape_Computer_2\Desktop\test_videos\Box1_PM2_day_5_20211104T171021.mp4'},
-#                     video_height=640,
-#                     video_width=480,
-#                     concat_type='mixed_mosaic',
-#                     gpu=False) #horizontal, vertical, mosaic, mixed_mosaic
-#
+# test = HeatMapperLocationMultiprocess(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini',
+#                                       style_attr = {'palette': 'jet', 'shading': 'gouraud', 'bin_size': 80, 'max_scale': 'auto'},
+#                                       final_img_setting=True,
+#                                       video_setting=False,
+#                                       frame_setting=False,
+#                                       bodypart='Nose_1',
+#                                       core_cnt=5,
+#                                       files_found=['/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/csv/outlier_corrected_movement_location/Together_1.csv'])
+# test.run()
+
+# test = HeatMapperLocationMultiprocess(config_path='/Users/simon/Desktop/envs/troubleshooting/Rat_NOR/project_folder/project_config.ini',
+#                                       style_attr = {'palette': 'jet', 'shading': 'gouraud', 'bin_size': 100, 'max_scale': 'auto'},
+#                                       final_img_setting=True,
+#                                       video_setting=False,
+#                                       frame_setting=False,
+#                                       bodypart='Nose',
+#                                       core_cnt=5,
+#                                       files_found=['/Users/simon/Desktop/envs/troubleshooting/Rat_NOR/project_folder/csv/machine_results/2022-06-26_NOB_DOT_4.csv'])
+# test.run()
+
+# img = np.zeros((img_size[0], img_size[1], 3)).astype(np.uint8)
+# for i in polygons:
+#     coords = np.array(i.exterior.coords).astype(np.int)
+#     print(coords)
+#     cv2.polylines(img, [coords], True, (0, 0, 50), 2)
+# cv2.imshow('img', img)
+# cv2.waitKey()
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/pose_plotter_mp.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/pose_plotter_mp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/directing_animals_visualizer_mp.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/directing_animals_visualizer_mp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/clf_validator.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/clf_validator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/path_plotter_mp.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/path_plotter_mp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/ROI_feature_visualizer_mp.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/ROI_feature_visualizer_mp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/data_plotter.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/data_plotter.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/spontaneous_alternation_plotter.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/spontaneous_alternation_plotter.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/path_plotter.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/path_plotter.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/ez_lineplot.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/ez_lineplot.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/distance_plotter_mp.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/distance_plotter.py`

 * *Files 20% similar despite different names*

```diff
@@ -1,271 +1,250 @@
 __author__ = "Simon Nilsson"
 
-import functools
-import multiprocessing
+import matplotlib
+
+matplotlib.use("TkAgg")
 import os
-import platform
-from typing import Dict, List
+from typing import Dict, List, Optional, Union
 
+import cv2
 import numpy as np
-from numba import jit
 
 from simba.mixins.config_reader import ConfigReader
+from simba.mixins.feature_extraction_mixin import FeatureExtractionMixin
 from simba.mixins.plotting_mixin import PlottingMixin
-from simba.utils.checks import check_if_filepath_list_is_empty
-from simba.utils.errors import NoSpecifiedOutputError
+from simba.utils.checks import (
+    check_all_file_names_are_represented_in_video_log,
+    check_file_exist_and_readable, check_instance, check_valid_lst)
+from simba.utils.errors import (CountError, InvalidInputError,
+                                NoSpecifiedOutputError)
+from simba.utils.lookups import get_color_dict
 from simba.utils.printing import SimbaTimer, stdout_success
-from simba.utils.read_write import (concatenate_videos_in_folder, get_fn_ext,
-                                    read_df)
+from simba.utils.read_write import get_fn_ext, read_df
 
 
-class DistancePlotterMultiCore(ConfigReader, PlottingMixin):
+class DistancePlotterSingleCore(ConfigReader):
     """
-     Visualize the distances between pose-estimated body-parts (e.g., two animals) through line
-     charts. Results are saved as individual line charts, and/or a video of line charts.
-     Uses multiprocessing.
-
-     :param str config_path: path to SimBA project config file in Configparser format
-     :param bool frame_setting: If True, creates individual frames.
-     :param bool video_setting: If True, creates videos.
-     :param bool final_img: If True, creates a single .png representing the entire video.
-     :param dict style_attr: Video style attributes (font sizes, line opacity etc.)
-     :param dict files_found: Files to visualize.
-     :param dict line_attr: Representing the body-parts to visualize the distance between and their colors.
+    Class for visualizing the distance between two pose-estimated body-parts (e.g., two animals) through line
+    charts. Results are saved as individual line charts, and/or videos of line charts.
 
     .. note::
+       For better runtime, use :meth:`simba.plotting.distance_plotter_mp.DistancePlotterMultiCore`.
        `GitHub tutorial/documentation <https://github.com/sgoldenlab/simba/blob/master/docs/tutorial.md#step-11-visualizations>`__.
 
-    Examples
-    -----
+    .. image:: _static/img/distance_plot.png
+       :width: 300
+       :align: center
+
+    :parameter str config_path: path to SimBA project config file in Configparser format.
+    :parameter bool frame_setting: If True, creates individual frames.
+    :parameter bool video_setting: If True, creates videos
+
+    :examples:
+
     >>> style_attr = {'width': 640, 'height': 480, 'line width': 6, 'font size': 8, 'opacity': 0.5}
     >>> line_attr = {0: ['Center_1', 'Center_2', 'Green'], 1: ['Ear_left_2', 'Ear_left_1', 'Red']}
-    >>> distance_plotter = DistancePlotterMultiCore(config_path=r'/tests_/project_folder/project_config.ini', frame_setting=False, video_setting=True, final_img=True, style_attr=style_attr, line_attr=line_attr,  files_found=['/test_/project_folder/csv/machine_results/Together_1.csv'], core_cnt=5)
+    >>> distance_plotter = DistancePlotterSingleCore(config_path=r'MyProjectConfig', files_found=['test/two_c57s/project_folder/csv/outlier_corrected_movement_location/Video_1.csv'], frame_setting=False, video_setting=True, final_img=True)
     >>> distance_plotter.run()
     """
 
     def __init__(
         self,
-        config_path: str,
-        frame_setting: bool,
-        video_setting: bool,
-        final_img: bool,
-        files_found: List[str],
+        config_path: Union[str, os.PathLike],
+        data_paths: List[Union[str, os.PathLike]],
         style_attr: Dict[str, int],
-        line_attr: Dict[int, list],
-        core_cnt: int,
+        line_attr: List[List[str]],
+        frame_setting: Optional[bool] = False,
+        video_setting: Optional[bool] = False,
+        final_img: Optional[bool] = False,
     ):
-        ConfigReader.__init__(self, config_path=config_path)
-        PlottingMixin.__init__(self)
-
-        if platform.system() == "Darwin":
-            multiprocessing.set_start_method("spawn", force=True)
 
+        if (not frame_setting) and (not video_setting) and (not final_img):
+            raise NoSpecifiedOutputError(
+                msg="Please choice to create frames and/or video distance plots",
+                source=self.__class__.__name__,
+            )
+        check_instance(
+            source=f"{self.__class__.__name__} line_attr",
+            instance=line_attr,
+            accepted_types=(list,),
+        )
+        for cnt, i in enumerate(line_attr):
+            check_valid_lst(
+                source=f"{self.__class__.__name__} line_attr {cnt}",
+                data=i,
+                valid_dtypes=(str,),
+                exact_len=3,
+            )
+        check_valid_lst(data=data_paths, valid_dtypes=(str,), min_len=1)
+        _ = [check_file_exist_and_readable(i) for i in data_paths]
+        ConfigReader.__init__(self, config_path=config_path)
         (
             self.video_setting,
             self.frame_setting,
-            self.files_found,
+            self.data_paths,
             self.style_attr,
             self.line_attr,
             self.final_img,
-        ) = (
-            video_setting,
-            frame_setting,
-            files_found,
-            style_attr,
-            line_attr,
-            final_img,
-        )
-        if (not frame_setting) and (not video_setting) and (not self.final_img):
-            raise NoSpecifiedOutputError(
-                msg="Please choice to create frames and/or video distance plots"
-            )
-        self.core_cnt = core_cnt
-        if not os.path.exists(self.line_plot_dir):
-            os.makedirs(self.line_plot_dir)
-        check_if_filepath_list_is_empty(
-            filepaths=self.outlier_corrected_dir,
-            error_msg="SIMBA ERROR: Zero files found in the project_folder/csv/machine_results directory. Create classification results before visualizing distances.",
-        )
-        print(f"Processing {str(len(self.files_found))} videos...")
-
-    @staticmethod
-    @jit(nopython=True)
-    def __insert_group_idx_column(data: np.array, group: int):
-        group_col = np.full((data.shape[0], 1), group)
-        return np.hstack((group_col, data))
+        ) = (video_setting, frame_setting, data_paths, style_attr, line_attr, final_img)
+        self.color_names = get_color_dict()
 
     def run(self):
-        """
-        Creates line charts. Results are stored in the `project_folder/frames/line_plot` directory
-
-        Returns
-        ----------
-        None
-        """
-
-        for file_cnt, file_path in enumerate(self.files_found):
+        print(f"Processing {len(self.data_paths)} videos...")
+        check_all_file_names_are_represented_in_video_log(
+            video_info_df=self.video_info_df, data_paths=self.data_paths
+        )
+        for file_cnt, file_path in enumerate(self.data_paths):
             video_timer = SimbaTimer(start=True)
-            self.data_df = read_df(file_path, self.file_type)
-            distance_arr = np.full(
-                (len(self.data_df), len(self.line_attr.keys())), np.nan
+            data_df = read_df(file_path, self.file_type)
+            _, video_name, _ = get_fn_ext(file_path)
+            self.video_info, px_per_mm, fps = self.read_video_info(
+                video_name=video_name
             )
-            _, self.video_name, _ = get_fn_ext(file_path)
-            self.video_info, self.px_per_mm, self.fps = self.read_video_info(
-                video_name=self.video_name
-            )
-            self.save_video_folder = os.path.join(self.line_plot_dir, self.video_name)
-            self.temp_folder = os.path.join(self.line_plot_dir, self.video_name, "temp")
-            self.save_frame_folder_dir = os.path.join(
-                self.line_plot_dir, self.video_name
-            )
-            for distance_cnt, data in enumerate(self.line_attr.values()):
-                distance_arr[:, distance_cnt] = (
-                    np.sqrt(
-                        (self.data_df[data[0] + "_x"] - self.data_df[data[1] + "_x"])
-                        ** 2
-                        + (self.data_df[data[0] + "_y"] - self.data_df[data[1] + "_y"])
-                        ** 2
+            self.save_video_folder = os.path.join(self.line_plot_dir, video_name)
+            self.save_frame_folder_dir = os.path.join(self.line_plot_dir, video_name)
+
+            try:
+                data_df.columns = self.bp_headers
+            except ValueError:
+                raise CountError(
+                    msg=f"SimBA expects {self.bp_headers} columns but found {len(data_df)} columns in {file_path}",
+                    source=self.__class__.__name__,
+                )
+            distances = []
+            colors = []
+            for cnt, i in enumerate(self.line_attr):
+                if i[2] not in list(self.color_names.keys()):
+                    raise InvalidInputError(
+                        msg=f"{i[2]} is not a valid color. Options: {list(self.color_names.keys())}.",
+                        source=self.__class__.__name__,
+                    )
+                colors.append(i[2])
+                bp_1, bp_2 = [f"{i[0]}_x", f"{i[0]}_y"], [f"{i[1]}_x", f"{i[1]}_y"]
+                if len(list(set(bp_1) - set(data_df.columns))) > 0:
+                    raise InvalidInputError(
+                        msg=f"Could not find fields {bp_1} in {file_path}",
+                        source=self.__class__.__name__,
+                    )
+                if len(list(set(bp_2) - set(data_df.columns))) > 0:
+                    raise InvalidInputError(
+                        msg=f"Could not find fields {bp_2} in {file_path}",
+                        source=self.__class__.__name__,
+                    )
+                distances.append(
+                    FeatureExtractionMixin.framewise_euclidean_distance(
+                        location_1=data_df[bp_1].values,
+                        location_2=data_df[bp_2].values,
+                        px_per_mm=px_per_mm,
+                        centimeter=True,
                     )
-                    / self.px_per_mm
-                ) / 10
+                )
             if self.frame_setting:
                 if os.path.exists(self.save_frame_folder_dir):
                     self.remove_a_folder(self.save_frame_folder_dir)
-                if not os.path.exists(self.save_frame_folder_dir):
-                    os.makedirs(self.save_frame_folder_dir)
+                os.makedirs(self.save_frame_folder_dir)
             if self.video_setting:
-                self.video_folder = os.path.join(self.line_plot_dir, self.video_name)
-                if os.path.exists(self.temp_folder):
-                    self.remove_a_folder(self.temp_folder)
-                    self.remove_a_folder(self.video_folder)
-                os.makedirs(self.temp_folder)
-                self.save_video_path = os.path.join(
-                    self.line_plot_dir, self.video_name + ".mp4"
+                save_video_path = os.path.join(self.line_plot_dir, f"{video_name}.avi")
+                fourcc = cv2.VideoWriter_fourcc(*"DIVX")
+                video_writer = cv2.VideoWriter(
+                    save_video_path,
+                    fourcc,
+                    fps,
+                    (self.style_attr["width"], self.style_attr["height"]),
                 )
 
-            distance_arr = np.nan_to_num(distance_arr, nan=0.0)
-
             if self.final_img:
-                self.make_distance_plot(
-                    data=distance_arr,
-                    line_attr=self.line_attr,
-                    style_attr=self.style_attr,
-                    fps=self.fps,
+                _ = PlottingMixin.make_line_plot(
+                    data=distances,
+                    colors=colors,
+                    width=self.style_attr["width"],
+                    height=self.style_attr["height"],
+                    line_width=self.style_attr["line width"],
+                    font_size=self.style_attr["font size"],
+                    title="Animal distances",
+                    y_lbl="distance (cm)",
+                    x_lbl="time (s)",
+                    x_lbl_divisor=fps,
+                    y_max=self.style_attr["y_max"],
+                    line_opacity=self.style_attr["opacity"],
                     save_path=os.path.join(
-                        self.line_plot_dir, self.video_name + "_final_img.png"
+                        self.line_plot_dir, f"{video_name}_final_distances.png"
                     ),
                 )
 
             if self.video_setting or self.frame_setting:
-                if self.style_attr["y_max"] == "auto":
-                    self.style_attr["max_y"] = np.amax(distance_arr)
-                else:
-                    self.style_attr["max_y"] = float(self.style_attr["max_y"])
-                self.style_attr["y_ticks_locs"] = np.round(
-                    np.linspace(0, self.style_attr["max_y"], 10), 2
-                )
-                self.style_attr["y_ticks_lbls"] = np.round(
-                    (self.style_attr["y_ticks_locs"] / self.fps), 1
-                )
-                index_column = list(range(0, distance_arr.shape[0]))
-                distance_arr = np.column_stack((index_column, distance_arr))
-
-                distance_arr = np.array_split(distance_arr, self.core_cnt)
-
-                data = []
-                for cnt, i in enumerate(distance_arr):
-                    data.append(self.__insert_group_idx_column(data=i, group=cnt))
-                frm_per_core = data[0].shape[0]
-
-                print(
-                    "Creating distance plots, multiprocessing (chunksize: {}, cores: {})...".format(
-                        str(self.multiprocess_chunksize), str(self.core_cnt)
-                    )
-                )
-                with multiprocessing.Pool(
-                    self.core_cnt, maxtasksperchild=self.maxtasksperchild
-                ) as pool:
-                    constants = functools.partial(
-                        self.distance_plotter_mp,
-                        video_setting=self.video_setting,
-                        video_name=self.video_name,
-                        frame_setting=self.frame_setting,
-                        video_save_dir=self.temp_folder,
-                        frame_folder_dir=self.save_frame_folder_dir,
-                        style_attr=self.style_attr,
-                        line_attr=self.line_attr,
-                        fps=self.fps,
-                    )
-                    for cnt, result in enumerate(
-                        pool.imap(
-                            constants, data, chunksize=self.multiprocess_chunksize
+                if self.style_attr["y_max"] == -1:
+                    self.style_attr["y_max"] = max([np.max(x) for x in distances])
+                for frm_cnt in range(distances[0].shape[0]):
+                    line_data = [x[:frm_cnt] for x in distances]
+                    img = PlottingMixin.make_line_plot_plotly(
+                        data=line_data,
+                        colors=colors,
+                        width=self.style_attr["width"],
+                        height=self.style_attr["height"],
+                        line_width=self.style_attr["line width"],
+                        font_size=self.style_attr["font size"],
+                        title="Animal distances",
+                        y_lbl="distance (cm)",
+                        x_lbl="frame count",
+                        x_lbl_divisor=fps,
+                        y_max=self.style_attr["y_max"],
+                        line_opacity=self.style_attr["opacity"],
+                        save_path=None,
+                    ).astype(np.uint8)
+                    if self.video_setting:
+                        video_writer.write(img[:, :, :3])
+                    if self.frame_setting:
+                        frm_name = os.path.join(
+                            self.save_frame_folder_dir, f"{frm_cnt}.png"
                         )
-                    ):
-                        print(
-                            "Image {}/{}, Video {}/{}...".format(
-                                str(int(frm_per_core * (result + 1))),
-                                str(len(self.data_df)),
-                                str(file_cnt + 1),
-                                str(len(self.files_found)),
-                            )
-                        )
-
-                    pool.terminate()
-                    pool.join()
-
+                        cv2.imwrite(frm_name, np.uint8(img))
+                    print(f"Distance frame created: {frm_cnt}, Video: {video_name} ...")
                 if self.video_setting:
-                    print("Joining {} multiprocessed video...".format(self.video_name))
-                    concatenate_videos_in_folder(
-                        in_folder=self.temp_folder, save_path=self.save_video_path
-                    )
-
+                    video_writer.release()
                 video_timer.stop_timer()
-                print(
-                    "Distance line chart video {} complete (elapsed time: {}s) ...".format(
-                        self.video_name, video_timer.elapsed_time_str
-                    )
+                stdout_success(
+                    msg=f"Distance visualizations created for {video_name} saved at {self.line_plot_dir}",
+                    elapsed_time=video_timer.elapsed_time_str,
                 )
-
         self.timer.stop_timer()
         stdout_success(
-            f"Distance plot visualizations for {str(len(self.files_found))} video(s) created in project_folder/frames/output/line_plot directory",
+            msg=f"Distance visualizations complete for {len(self.data_paths)} video(s)",
             elapsed_time=self.timer.elapsed_time_str,
         )
 
 
-# style_attr = {'width': 640, 'height': 480, 'line width': 6, 'font size': 8, 'y_max': 'auto', 'opacity': 0.9}
-# line_attr = {0: ['Center_1', 'Center_2', 'Green'], 1: ['Ear_left_2', 'Ear_left_1', 'Red']}
-#
-# test = DistancePlotterMultiCore(config_path=r'/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini',
-#                                 frame_setting=False,
-#                                 video_setting=True,
-#                                 style_attr=style_attr,
-#                                 final_img=True,
-#                                 files_found=['/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/csv/machine_results/Together_1.csv'],
-#                                 line_attr=line_attr,
-#                                 core_cnt=3)
-# test.create_distance_plot()
-# #
-# style_attr = {'width': 640, 'height': 480, 'line width': 6, 'font size': 8}
-# line_attr = {0: ['Termite_1_Head_1', 'Termite_1_Thorax_1', 'Dark-red']}
-#
+# style_attr = {'width': 640, 'height': 480, 'line width': 6, 'font size': 12, 'y_max': -1, 'opacity': 0.5}
+# line_attr = [['Center_1', 'Center_2', 'Green'], ['Ear_left_2', 'Ear_right_2', 'Red']]
+# test = DistancePlotterSingleCore(config_path=r'/Users/simon/Desktop/envs/simba/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini',
+#                                  frame_setting=True,
+#                                  video_setting=True,
+#                                  style_attr=style_attr,
+#                                  final_img=True,
+#                                  data_paths=['/Users/simon/Desktop/envs/simba/troubleshooting/two_black_animals_14bp/project_folder/csv/outlier_corrected_movement_location/Together_1.csv'],
+#                                  line_attr=line_attr)
+# test.run()
 
 
-# style_attr = {'width': 640, 'height': 480, 'line width': 6, 'font size': 8, 'opacity': 0.5, 'y_max': 'auto'}
+#
+# style_attr = {'width': 640,
+#               'height': 480,
+#               'line width': 6,
+#               'font size': 8,
+#               'y_max': 'auto',
+#               'opacity': 0.9}
 # line_attr = {0: ['Center_1', 'Center_2', 'Green'], 1: ['Ear_left_2', 'Ear_left_1', 'Red']}
 #
-# test = DistancePlotterMultiCore(config_path=r'/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini',
-#                        frame_setting=False,
-#                        video_setting=True,
-#                        style_attr=style_attr,
-#                                  final_img=False,
-#                        files_found=['/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/csv/machine_results/Together_1.csv'],
-#                        line_attr=line_attr,
-#                                 core_cnt=5)
+# test = DistancePlotterSingleCore(config_path=r'/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini',
+#                                  frame_setting=False,
+#                                  video_setting=True,
+#                                  style_attr=style_attr,
+#                                  final_img=True,
+#                                  files_found=['/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/csv/machine_results/Together_1.csv'],
+#                                  line_attr=line_attr)
 # test.create_distance_plot()
 
 # style_attr = {'width': 640, 'height': 480, 'line width': 6, 'font size': 8}
 # line_attr = {0: ['Termite_1_Head_1', 'Termite_1_Thorax_1', 'Dark-red']}
 
 # test = DistancePlotterSingleCore(config_path=r'/Users/simon/Desktop/envs/troubleshooting/Termites_5/project_folder/project_config.ini',
 #                                  frame_setting=False,
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/ROI_plotter.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/ROI_plotter.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/geometry_plotter.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/geometry_plotter.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/clf_validator_mp.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/clf_validator_mp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/heat_mapper_clf.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/heat_mapper_clf.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/distance_plotter.py` & `Simba-UW-tf-dev-1.89.5/simba/data_processors/movement_calculator.py`

 * *Files 24% similar despite different names*

```diff
@@ -1,258 +1,229 @@
 __author__ = "Simon Nilsson"
 
-import io
 import os
-from typing import Dict, List
+from statistics import mean
+from typing import List, Optional
 
-import cv2
-import matplotlib.pyplot as plt
 import numpy as np
-import PIL
+import pandas as pd
 
+from simba.feature_extractors.perimeter_jit import jitted_centroid
 from simba.mixins.config_reader import ConfigReader
-from simba.mixins.plotting_mixin import PlottingMixin
+from simba.mixins.feature_extraction_mixin import FeatureExtractionMixin
 from simba.utils.checks import check_if_filepath_list_is_empty
-from simba.utils.enums import Formats
-from simba.utils.errors import NoSpecifiedOutputError
-from simba.utils.lookups import get_color_dict
-from simba.utils.printing import SimbaTimer, stdout_success
+from simba.utils.printing import stdout_success
 from simba.utils.read_write import get_fn_ext, read_df
 
 
-class DistancePlotterSingleCore(ConfigReader, PlottingMixin):
+class MovementCalculator(ConfigReader, FeatureExtractionMixin):
     """
-    Class for visualizing the distance between two pose-estimated body-parts (e.g., two animals) through line
-    charts. Results are saved as individual line charts, and/or videos of line charts.
+    Compute aggregate movement statistics from pose-estimation data in SimBA project.
 
-    .. note::
-       For better runtime, use :meth:`simba.plotting.distance_plotter_mp.DistancePlotterMultiCore`.
-       `GitHub tutorial/documentation <https://github.com/sgoldenlab/simba/blob/master/docs/tutorial.md#step-11-visualizations>`__.
+    :parameters str config_path: path to SimBA project config file in Configparser format
+    :param List[str] body_parts: Body-parts to use for movement calculations OR ``Animal_name CENTER OF GRAVITY``. If ``Animal_name CENTER OF GRAVITY``, then SimBA will approximate animal centroids through convex hull.
+    :param float threshold: Filter body-part detection below set threshold (Value 0-1). Default: 0.00
+    :param List[str] or None file_paths: Files to calucalte movements for. If None, then all files in ``project_folder/csv/outlier_corrected_movement_location`` directory.
 
-    .. image:: _static/img/distance_plot.png
-       :width: 300
-       :align: center
-
-    :parameter str config_path: path to SimBA project config file in Configparser format.
-    :parameter bool frame_setting: If True, creates individual frames.
-    :parameter bool video_setting: If True, creates videos
+    .. note::
+       `Tutorial <https://github.com/sgoldenlab/simba/blob/master/docs/Scenario2.md#part-4--analyze-machine-results>`__.
 
     :examples:
+    >>> body_parts=['Animal_1 CENTER OF GRAVITY']
+    >>> movement_processor = MovementCalculator(config_path='project_folder/project_config.ini', body_parts=body_parts)
+    >>> movement_processor.run()
+    >>> movement_processor.save()
 
-    >>> style_attr = {'width': 640, 'height': 480, 'line width': 6, 'font size': 8, 'opacity': 0.5}
-    >>> line_attr = {0: ['Center_1', 'Center_2', 'Green'], 1: ['Ear_left_2', 'Ear_left_1', 'Red']}
-    >>> distance_plotter = DistancePlotterSingleCore(config_path=r'MyProjectConfig', files_found=['test/two_c57s/project_folder/csv/outlier_corrected_movement_location/Video_1.csv'], frame_setting=False, video_setting=True, final_img=True)
-    >>> distance_plotter.run()
     """
 
     def __init__(
         self,
         config_path: str,
-        frame_setting: bool,
-        video_setting: bool,
-        final_img: bool,
-        files_found: List[str],
-        style_attr: Dict[str, int],
-        line_attr: Dict[int, list],
+        body_parts: List[str],
+        threshold: float = 0.00,
+        file_paths: Optional[List[str]] = None,
     ):
         ConfigReader.__init__(self, config_path=config_path)
-        PlottingMixin.__init__(self)
-        (
-            self.video_setting,
-            self.frame_setting,
-            self.files_found,
-            self.style_attr,
-            self.line_attr,
-            self.final_img,
-        ) = (
-            video_setting,
-            frame_setting,
-            files_found,
-            style_attr,
-            line_attr,
-            final_img,
+        FeatureExtractionMixin.__init__(self)
+        self.save_path = os.path.join(
+            self.logs_path, "Movement_log_{}.csv".format(self.datetime)
         )
-        if (not frame_setting) and (not video_setting) and (not self.final_img):
-            raise NoSpecifiedOutputError(
-                "Please choice to create frames and/or video distance plots"
-            )
-        self.colors_dict = get_color_dict()
-        if not os.path.exists(self.line_plot_dir):
-            os.makedirs(self.line_plot_dir)
-        check_if_filepath_list_is_empty(
-            filepaths=self.outlier_corrected_paths,
-            error_msg="SIMBA ERROR: Zero files found in the project_folder/csv/machine_results directory. Create classification results before visualizing distances.",
+        self.file_paths, self.body_parts, self.threshold = (
+            file_paths,
+            body_parts,
+            threshold,
         )
-        print(f"Processing {str(len(self.files_found))} videos...")
+        if not self.file_paths:
+            check_if_filepath_list_is_empty(
+                filepaths=self.outlier_corrected_paths,
+                error_msg=f"SIMBA ERROR: Cannot process movement. ZERO data files found in the {self.outlier_corrected_dir} directory.",
+            )
+            self.file_paths = self.outlier_corrected_paths
+        print(f"Processing {len(self.file_paths)} video(s)...")
 
-    def run(self):
-        """
-        Creates line charts. Results are stored in the `project_folder/frames/line_plot` directory
+    def __find_body_part_columns(self):
+        self.body_parts_dict, self.bp_list = {}, []
+        for bp_cnt, bp_name in enumerate(self.body_parts):
+            if not bp_name.endswith("CENTER OF GRAVITY"):
+                animal_name = self.find_animal_name_from_body_part_name(
+                    bp_name=bp_name, bp_dict=self.animal_bp_dict
+                )
+                self.body_parts_dict[bp_cnt] = {
+                    "ANIMAL NAME": animal_name,
+                    "BODY-PART": bp_name,
+                    "BODY-PART HEADERS": [
+                        f"{bp_name}_x",
+                        f"{bp_name}_y",
+                        f"{bp_name}_p",
+                    ],
+                }
+                self.bp_list.extend((self.body_parts_dict[bp_cnt]["BODY-PART HEADERS"]))
+            else:
+                pass
 
-        Returns
-        ----------
-        None
-        """
-
-        for file_cnt, file_path in enumerate(self.files_found):
-            video_timer = SimbaTimer(start=True)
-            self.data_df = read_df(file_path, self.file_type)
-            distance_arr = np.full(
-                (len(self.data_df), len(self.line_attr.keys())), np.nan
-            )
-            _, self.video_name, _ = get_fn_ext(file_path)
+    def __find_polygons(self, data):
+        print(data.shape)
+
+    def run(self):
+        self.results = pd.DataFrame(
+            columns=["VIDEO", "ANIMAL", "BODY-PART", "MEASURE", "VALUE"]
+        )
+        self.movement_dfs = {}
+        for file_path in self.file_paths:
+            self.__find_body_part_columns()
+            _, video_name, _ = get_fn_ext(file_path)
+            print("Analysing {}...".format(video_name))
+            self.data_df = read_df(file_path=file_path, file_type=self.file_type)
             self.video_info, self.px_per_mm, self.fps = self.read_video_info(
-                video_name=self.video_name
+                video_name=video_name
             )
-            for distance_cnt, data in enumerate(self.line_attr.values()):
-                distance_arr[:, distance_cnt] = (
-                    np.sqrt(
-                        (self.data_df[data[0] + "_x"] - self.data_df[data[1] + "_x"])
-                        ** 2
-                        + (self.data_df[data[0] + "_y"] - self.data_df[data[1] + "_y"])
-                        ** 2
-                    )
-                    / self.px_per_mm
-                ) / 10
-            if self.video_setting:
-                self.fourcc = cv2.VideoWriter_fourcc(*Formats.MP4_CODEC.value)
-                self.video_save_path = os.path.join(
-                    self.line_plot_dir, self.video_name + ".mp4"
-                )
-                writer = cv2.VideoWriter(
-                    self.video_save_path,
-                    self.fourcc,
-                    self.fps,
-                    (self.style_attr["width"], self.style_attr["height"]),
-                )
-            if self.frame_setting:
-                self.save_video_folder = os.path.join(
-                    self.line_plot_dir, self.video_name
-                )
-                if not os.path.exists(self.save_video_folder):
-                    os.makedirs(self.save_video_folder)
-
-            distance_arr = np.nan_to_num(distance_arr, nan=0.0)
-            if self.final_img:
-                self.final_img_path = os.path.join(
-                    self.line_plot_dir, self.video_name + "_final_img.png"
-                )
-                self.make_distance_plot(
-                    data=distance_arr,
-                    line_attr=self.line_attr,
-                    style_attr=self.style_attr,
-                    fps=self.fps,
-                    save_path=self.final_img_path,
-                    save_img=True,
-                )
-
-            if self.video_setting or self.frame_setting:
-                if self.style_attr["y_max"] == "auto":
-                    max_y = np.amax(distance_arr)
-                else:
-                    max_y = float(self.style_attr["y_max"])
-                y_ticks_locs = y_lbls = np.round(np.linspace(0, max_y, 10), 2)
-                for i in range(distance_arr.shape[0]):
-                    for j in range(distance_arr.shape[1]):
-                        color = self.colors_dict[self.line_attr[j][-1]][::-1]
-                        color = tuple(x / 255 for x in color)
-                        plt.plot(
-                            distance_arr[0:i, j],
-                            color=color,
-                            linewidth=self.style_attr["line width"],
-                            alpha=self.style_attr["opacity"],
+            self.movement_dfs[video_name] = pd.DataFrame()
+            if self.bp_list:
+                self.data_df = self.data_df[self.bp_list]
+                for animal_cnt, animal_data in self.body_parts_dict.items():
+                    animal_df = self.data_df[animal_data["BODY-PART HEADERS"]]
+                    if self.threshold > 0.00:
+                        animal_df = animal_df[
+                            animal_df[animal_data["BODY-PART HEADERS"][-1]]
+                            >= self.threshold
+                        ]
+                    animal_df = animal_df.iloc[:, 0:2].reset_index(drop=True)
+                    animal_df = self.create_shifted_df(df=animal_df)
+                    bp_time_1 = animal_df[
+                        [
+                            animal_data["BODY-PART HEADERS"][0],
+                            animal_data["BODY-PART HEADERS"][1],
+                        ]
+                    ].values.astype(float)
+                    bp_time_2 = animal_df[
+                        [
+                            animal_data["BODY-PART HEADERS"][0] + "_shifted",
+                            animal_data["BODY-PART HEADERS"][1] + "_shifted",
+                        ]
+                    ].values.astype(float)
+                    self.movement = pd.Series(
+                        self.framewise_euclidean_distance(
+                            location_1=bp_time_1,
+                            location_2=bp_time_2,
+                            px_per_mm=self.px_per_mm,
                         )
-
-                    x_ticks_locs = x_lbls = np.round(np.linspace(0, i, 5))
-                    x_lbls = np.round((x_lbls / self.fps), 1)
-                    plt.ylim(0, max_y)
-
-                    plt.xlabel("time (s)")
-                    plt.ylabel("distance (cm)")
-                    plt.xticks(
-                        x_ticks_locs,
-                        x_lbls,
-                        rotation="horizontal",
-                        fontsize=self.style_attr["font size"],
-                    )
-                    plt.yticks(
-                        y_ticks_locs, y_lbls, fontsize=self.style_attr["font size"]
-                    )
-                    plt.suptitle(
-                        "Animal distances",
-                        x=0.5,
-                        y=0.92,
-                        fontsize=self.style_attr["font size"] + 4,
-                    )
-
-                    self.buffer_ = io.BytesIO()
-                    plt.savefig(self.buffer_, format="png")
-                    self.buffer_.seek(0)
-                    img = PIL.Image.open(self.buffer_)
-                    img = np.uint8(cv2.cvtColor(np.asarray(img), cv2.COLOR_RGB2BGR))
-                    self.buffer_.close()
-                    plt.close()
-
-                    img = cv2.resize(
-                        img, (self.style_attr["width"], self.style_attr["height"])
                     )
-
-                    if self.frame_setting:
-                        frame_save_path = os.path.join(
-                            self.save_video_folder, str(i) + ".png"
-                        )
-                        cv2.imwrite(frame_save_path, img)
-                    if self.video_setting:
-                        writer.write(img)
-                    print(
-                        "Distance frame: {} / {}. Video: {} ({}/{})".format(
-                            str(i + 1),
-                            str(len(self.data_df)),
-                            self.video_name,
-                            str(file_cnt + 1),
-                            len(self.files_found),
+                    self.movement.loc[0] = 0
+                    self.movement_dfs[video_name][
+                        f'{animal_data["ANIMAL NAME"]} {animal_data["BODY-PART"]}'
+                    ] = self.movement
+                    distance = round((self.movement.sum() / 10), 4)
+                    velocity_lst = []
+                    for df in np.array_split(
+                        self.movement, int(len(self.movement) / self.fps)
+                    ):
+                        velocity_lst.append(df.sum())
+                    self.results.loc[len(self.results)] = [
+                        video_name,
+                        animal_data["ANIMAL NAME"],
+                        animal_data["BODY-PART"],
+                        "Distance (cm)",
+                        distance,
+                    ]
+                    self.results.loc[len(self.results)] = [
+                        video_name,
+                        animal_data["ANIMAL NAME"],
+                        animal_data["BODY-PART"],
+                        "Velocity (cm/s)",
+                        round((mean(velocity_lst) / 10), 4),
+                    ]
+
+            else:
+                for animal in self.body_parts:
+                    animal_name = animal.split("CENTER OF GRAVITY")[0].strip()
+                    x, y = (
+                        self.data_df[self.animal_bp_dict[animal_name]["X_bps"]],
+                        self.data_df[self.animal_bp_dict[animal_name]["Y_bps"]],
+                    )
+                    z = pd.concat([x, y], axis=1)[
+                        [item for items in zip(x.columns, y.columns) for item in items]
+                    ]
+                    df = pd.DataFrame(
+                        jitted_centroid(
+                            points=np.reshape(z.values, (len(z / 2), -1, 2)).astype(
+                                np.float32
+                            )
+                        ),
+                        columns=["X", "Y"],
+                    )
+                    df = self.dataframe_savgol_smoother(df=df, fps=self.fps).astype(int)
+                    df_shifted = df.shift(1)
+                    df_shifted = df_shifted.combine_first(df).add_suffix("_shifted")
+                    self.movement = pd.Series(
+                        self.framewise_euclidean_distance(
+                            location_1=df.values.astype(np.float32),
+                            location_2=df_shifted.values.astype(np.float32),
+                            px_per_mm=self.px_per_mm,
                         )
                     )
+                    self.movement.loc[0] = 0
+                    self.movement_dfs[video_name][
+                        f'{animal_name} {"GRAVITY CENTER"}'
+                    ] = self.movement
+                    distance = round((self.movement.sum() / 10), 4)
+                    velocity_lst = []
+                    for df in np.array_split(
+                        self.movement, int(len(self.movement) / self.fps)
+                    ):
+                        velocity_lst.append(df.sum())
+                    self.results.loc[len(self.results)] = [
+                        video_name,
+                        animal_name,
+                        "GRAVITY CENTER",
+                        "Distance (cm)",
+                        distance,
+                    ]
+                    self.results.loc[len(self.results)] = [
+                        video_name,
+                        animal_name,
+                        "GRAVITY CENTER",
+                        "Velocity (cm/s)",
+                        round((mean(velocity_lst) / 10), 4),
+                    ]
 
-                if self.video_setting:
-                    writer.release()
-                video_timer.stop_timer()
-                print(
-                    "Distance plot for video {} saved (elapsed time: {}s)...".format(
-                        self.video_name, video_timer.elapsed_time_str
-                    )
-                )
+    def save(self):
+        self.results.set_index("VIDEO").to_csv(self.save_path)
         self.timer.stop_timer()
         stdout_success(
-            msg="All distance visualizations created in project_folder/frames/output/line_plot directory",
+            msg=f"Movement log saved in {self.save_path}",
             elapsed_time=self.timer.elapsed_time_str,
         )
 
 
-#
-# style_attr = {'width': 640,
-#               'height': 480,
-#               'line width': 6,
-#               'font size': 8,
-#               'y_max': 'auto',
-#               'opacity': 0.9}
-# line_attr = {0: ['Center_1', 'Center_2', 'Green'], 1: ['Ear_left_2', 'Ear_left_1', 'Red']}
-#
-# test = DistancePlotterSingleCore(config_path=r'/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini',
-#                                  frame_setting=False,
-#                                  video_setting=True,
-#                                  style_attr=style_attr,
-#                                  final_img=True,
-#                                  files_found=['/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/csv/machine_results/Together_1.csv'],
-#                                  line_attr=line_attr)
-# test.create_distance_plot()
-
-# style_attr = {'width': 640, 'height': 480, 'line width': 6, 'font size': 8}
-# line_attr = {0: ['Termite_1_Head_1', 'Termite_1_Thorax_1', 'Dark-red']}
-
-# test = DistancePlotterSingleCore(config_path=r'/Users/simon/Desktop/envs/troubleshooting/Termites_5/project_folder/project_config.ini',
-#                                  frame_setting=False,
-#                        video_setting=True,
-#                        style_attr=style_attr,
-#                        files_found=['/Users/simon/Desktop/envs/troubleshooting/Termites_5/project_folder/csv/outlier_corrected_movement_location/termites_1.csv'],
-#                        line_attr=line_attr)
-# test.create_distance_plot()
+# test = MovementCalculator(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini',
+#                           body_parts=['Simon CENTER OF GRAVITY'], #['Simon CENTER OF GRAVITY', 'JJ CENTER OF GRAVITY']
+#                           threshold=0.00)
+# test.run()
+
+
+# test.save()
+
+# test = MovementCalculator(config_path='/Users/simon/Desktop/envs/troubleshooting/locomotion/project_folder/project_config.ini',
+#                           body_parts=['Animal_1 CENTER OF GRAVITY'], #['Simon CENTER OF GRAVITY', 'JJ CENTER OF GRAVITY']
+#                           threshold=0.00)
+# test.run()
+# test.save()
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/single_run_model_validation_video_mp.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/single_run_model_validation_video_mp.py`

 * *Files 0% similar despite different names*

```diff
@@ -424,16 +424,14 @@
         self.timer.stop_timer()
         stdout_success(
             msg=f"Video {self.feature_filename} complete",
             elapsed_time=self.timer.elapsed_time_str,
         )
 
 
-
-
 # test = ValidateModelOneVideoMultiprocess(config_path=r'/Users/simon/Desktop/envs/simba/troubleshooting/mouse_open_field/project_folder/project_config.ini',
 #                              feature_file_path='/Users/simon/Desktop/envs/simba/troubleshooting/mouse_open_field/project_folder/csv/features_extracted/SI_DAY3_308_CD1_PRESENT.csv',
 #                              model_path='/Users/simon/Desktop/envs/simba/troubleshooting/mouse_open_field/models/generated_models/Running.sav',
 #                              discrimination_threshold=0.6,
 #                              shortest_bout=50,
 #                              cores=6,
 #                              settings={'pose': True, 'animal_names': True, 'styles': None},
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/directing_animals_visualizer.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/directing_animals_visualizer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/circular_feature_overlay_plotter.py` & `Simba-UW-tf-dev-1.89.5/simba/plotting/circular_feature_overlay_plotter.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/plotting/heat_mapper_location_mp.py` & `Simba-UW-tf-dev-1.89.5/simba/pose_importers/sleap_h5_importer.py`

 * *Files 20% similar despite different names*

```diff
@@ -1,322 +1,292 @@
-import functools
-import multiprocessing
+#### MODIFIED FROM @Toshea111 - https://github.com/Toshea111/sleap/blob/develop/docs/notebooks/Convert_HDF5_to_CSV_updated.ipynb
+import io
 import os
-import platform
-from typing import Dict, List, Tuple
 
-import cv2
-import matplotlib.pyplot as plt
+import h5py
 import numpy as np
 import pandas as pd
-from numba import jit, prange
 
+from simba.data_processors.interpolation_smoothing import Interpolate, Smooth
 from simba.mixins.config_reader import ConfigReader
-from simba.mixins.geometry_mixin import GeometryMixin
-from simba.mixins.plotting_mixin import PlottingMixin
-from simba.utils.enums import Defaults, Formats, TagNames
-from simba.utils.errors import NoSpecifiedOutputError
-from simba.utils.printing import SimbaTimer, log_event, stdout_success
-from simba.utils.read_write import (concatenate_videos_in_folder,
-                                    find_core_cnt, get_fn_ext, read_df,
-                                    remove_a_folder)
-
-
-def _heatmap_location(
-    data: np.array,
-    video_setting: bool,
-    frame_setting: bool,
-    video_temp_dir: str,
-    video_name: str,
-    frame_dir: str,
-    fps: int,
-    style_attr: dict,
-    max_scale: float,
-    aspect_ratio: float,
-    size: tuple,
-    make_location_heatmap_plot: PlottingMixin.make_location_heatmap_plot,
-):
-
-    group = int(data[0][0][1])
-    if video_setting:
-        fourcc = cv2.VideoWriter_fourcc(*Formats.MP4_CODEC.value)
-        video_save_path = os.path.join(video_temp_dir, "{}.mp4".format(str(group)))
-        video_writer = cv2.VideoWriter(video_save_path, fourcc, fps, size)
-
-    for i in range(data.shape[0]):
-        frame_id = int(data[i, 0, 0])
-        frm_data = data[i, :, 2:]
-
-        img = make_location_heatmap_plot(
-            frm_data=frm_data,
-            max_scale=float(max_scale),
-            palette=style_attr["palette"],
-            aspect_ratio=aspect_ratio,
-            shading=style_attr["shading"],
-            img_size=size,
-            file_name=None,
-            final_img=False,
-        )
-
-        print(
-            "Heatmap frame created: {}, Video: {}, Processing core: {}".format(
-                str(frame_id + 1), video_name, str(group + 1)
-            )
-        )
-
-        if video_setting:
-            video_writer.write(img)
-
-        if frame_setting:
-            file_path = os.path.join(frame_dir, "{}.png".format(frame_id))
-            cv2.imwrite(file_path, img)
-
-    if video_setting:
-        video_writer.release()
+from simba.mixins.pose_importer_mixin import PoseImporterMixin
+from simba.utils.enums import Methods, TagNames
+from simba.utils.errors import BodypartColumnNotFoundError
+from simba.utils.printing import (SimbaTimer, log_event, stdout_success,
+                                  stdout_warning)
+from simba.utils.read_write import (clean_sleap_file_name,
+                                    find_all_videos_in_project, get_fn_ext,
+                                    get_video_meta_data, write_df)
 
-    return group
 
-
-class HeatMapperLocationMultiprocess(ConfigReader, PlottingMixin):
+class SLEAPImporterH5(ConfigReader, PoseImporterMixin):
     """
-    Create heatmaps representing the location where animals spend time.
+    Importing SLEAP pose-estimation data into SimBA project in ``H5`` format
 
-    ..note::
-       `GitHub visualizations tutorial <https://github.com/sgoldenlab/simba/blob/master/docs/tutorial.md#step-11-visualizations>`__.
+    :parameter str config_path: path to SimBA project config file in Configparser format
+    :parameter str data_folder: Path to folder containing SLEAP data in `csv` format.
+    :parameter List[str] id_lst: Animal names. This will be ignored in one animal projects and default to ``Animal_1``.
+    :parameter str interpolation_settings: String defining the pose-estimation interpolation method. OPTIONS: 'None', 'Animal(s): Nearest',
+        'Animal(s): Linear', 'Animal(s): Quadratic','Body-parts: Nearest', 'Body-parts: Linear',
+        'Body-parts: Quadratic'.
+    :parameter str smoothing_settings: Dictionary defining the pose estimation smoothing method. EXAMPLE: {'Method': 'Savitzky Golay',
+        'Parameters': {'Time_window': '200'}}
+
+    .. note::
+       `Multi-animal import tutorial <https://github.com/sgoldenlab/simba/blob/master/docs/Multi_animal_pose.md>`__.
+
+    References
+    ----------
+    .. [1] Pereira et al., SLEAP: A deep learning system for multi-animal pose tracking, `Nature Methods`,
+           2022.
 
-    .. image:: _static/img/heatmap_location.gif
-       :width: 500
-       :align: center
-
-    :param str config_path: path to SimBA project config file in Configparser format
-    :param str bodypart: The name of the body-part used to infer the location of the animal.
-    :param int bin_size: The rectangular size of each heatmap location in millimeters. For example, `50` will divide the video frames into 5 centimeter rectangular spatial bins.
-    :param str palette:  Heatmap pallette. Eg. 'jet', 'magma', 'inferno','plasma', 'viridis', 'gnuplot2'
-    :param dict style_attr: Style attributes of heatmap {'palette': 'jet', 'shading': 'gouraud', 'bin_size': 100, 'max_scale': 'auto'}
-    :param bool final_img_setting: If True, create a single image representing the last frame of the input video
-    :param bool video_setting: If True, then create a video of heatmaps.
-    :param bool frame_setting: If True, then create individual heatmap frames.
-    :param int core_cnt: The number of CPU cores to use. If -1, then all available cores.
-
-    :example:
-    >>> style_attr = {'palette': 'jet', 'shading': 'gouraud', 'bin_size': 100, 'max_scale': 'auto'}
-    >>> heatmapper = HeatMapperLocationMultiprocess(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini', style_attr = style_attr, core_cnt=-1, final_img_setting=True, video_setting=True, frame_setting=False, bodypart='Nose_1', files_found=['/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/csv/machine_results/Together_1.csv'])
-    >>> heatmapper.run()
+    >>> sleap_h5_importer = SLEAPImporterH5(config_path=r'project_folder/project_config.ini', data_folder=r'data_folder', actor_IDs=['Termite_1', 'Termite_2', 'Termite_3', 'Termite_4', 'Termite_5'], interpolation_settings="Body-parts: Nearest", smoothing_settings = {'Method': 'Savitzky Golay', 'Parameters': {'Time_window': '200'}})
+    >>> sleap_h5_importer.run()
     """
 
     def __init__(
         self,
         config_path: str,
-        final_img_setting: bool,
-        video_setting: bool,
-        frame_setting: bool,
-        bodypart: str,
-        files_found: List[str],
-        style_attr: dict,
-        core_cnt: int,
+        data_folder: str,
+        id_lst: list,
+        interpolation_settings: str,
+        smoothing_settings: dict,
     ):
-
-        if (not frame_setting) and (not video_setting) and (not final_img_setting):
-            raise NoSpecifiedOutputError(
-                msg="Please choose to select either heatmap videos, frames, and/or final image.",
-                source=self.__class__.__name__,
+        ConfigReader.__init__(self, config_path=config_path, read_video_info=False)
+        PoseImporterMixin.__init__(self)
+        log_event(
+            logger_name=str(__class__.__name__),
+            log_type=TagNames.CLASS_INIT.value,
+            msg=self.create_log_msg_from_init_args(locals=locals()),
+        )
+        self.interpolation_settings, self.smoothing_settings = (
+            interpolation_settings,
+            smoothing_settings,
+        )
+        self.data_folder, self.id_lst = data_folder, id_lst
+        self.import_log_path = os.path.join(
+            self.logs_path, f"data_import_log_{self.datetime}.csv"
+        )
+        self.video_paths = find_all_videos_in_project(videos_dir=self.video_dir)
+        self.input_data_paths = self.find_data_files(
+            dir=self.data_folder, extensions=[".h5"]
+        )
+        if self.pose_setting is Methods.USER_DEFINED.value:
+            self.__update_config_animal_cnt()
+        if self.animal_cnt > 1:
+            self.data_and_videos_lk = self.link_video_paths_to_data_paths(
+                data_paths=self.input_data_paths,
+                video_paths=self.video_paths,
+                filename_cleaning_func=clean_sleap_file_name,
             )
-        ConfigReader.__init__(self, config_path=config_path, create_logger=False)
-        PlottingMixin.__init__(self)
-        # log_event(logger_name=str(__class__.__name__), log_type=TagNames.CLASS_INIT.value, msg=self.create_log_msg_from_init_args(locals=locals()))
-        if platform.system() == "Darwin":
-            multiprocessing.set_start_method("spawn", force=True)
-        self.frame_setting, self.video_setting = frame_setting, video_setting
-        self.final_img_setting, self.bp = final_img_setting, bodypart
-        self.style_attr, self.files_found = style_attr, files_found
-        self.bin_size, self.max_scale, self.palette, self.shading, self.core_cnt = (
-            style_attr["bin_size"],
-            style_attr["max_scale"],
-            style_attr["palette"],
-            style_attr["shading"],
-            core_cnt,
+            self.check_multi_animal_status()
+            self.animal_bp_dict = self.create_body_part_dictionary(
+                self.multi_animal_status,
+                self.id_lst,
+                self.animal_cnt,
+                self.x_cols,
+                self.y_cols,
+                self.p_cols,
+                self.clr_lst,
+            )
+            self.update_bp_headers_file()
+        else:
+            self.data_and_videos_lk = dict(
+                [
+                    (get_fn_ext(file_path)[1], {"DATA": file_path, "VIDEO": None})
+                    for file_path in self.input_data_paths
+                ]
+            )
+        log_event(
+            logger_name=str(self.__class__.__name__),
+            log_type="info",
+            msg=f"Importing data files: {self.input_data_paths}. Interpolation: {interpolation_settings}, Smoothing: {smoothing_settings}",
         )
-        if not os.path.exists(self.heatmap_location_dir):
-            os.makedirs(self.heatmap_location_dir)
-        self.bp_lst = [self.bp + "_x", self.bp + "_y"]
-        print("Processing {} video(s)...".format(str(len(self.files_found))))
-
-    @staticmethod
-    @jit(nopython=True)
-    def __insert_group_idx_column(data: np.array, group: int, last_frm_idx: int):
-
-        results = np.full((data.shape[0], data.shape[1], data.shape[2] + 2), np.nan)
-        group_col = np.full((data.shape[1], 1), group)
-        for frm_idx in prange(data.shape[0]):
-            h_stack = np.hstack((group_col, data[frm_idx]))
-            frm_col = np.full((h_stack.shape[0], 1), frm_idx + last_frm_idx)
-            results[frm_idx] = np.hstack((frm_col, h_stack))
-        return results
+        print(f"Importing {len(list(self.data_and_videos_lk.keys()))} file(s)...")
 
     def run(self):
-        for file_cnt, file_path in enumerate(self.files_found):
+        for file_cnt, (video_name, video_data) in enumerate(
+            self.data_and_videos_lk.items()
+        ):
+            self.output_filename = clean_sleap_file_name(filename=video_name)
+            print(f"Importing {self.output_filename}...")
             video_timer = SimbaTimer(start=True)
-            _, self.video_name, _ = get_fn_ext(file_path)
-            self.video_info, self.px_per_mm, self.fps = self.read_video_info(
-                video_name=self.video_name
-            )
-            self.width, self.height = int(
-                self.video_info["Resolution_width"].values[0]
-            ), int(self.video_info["Resolution_height"].values[0])
-            self.save_frame_folder_dir = os.path.join(
-                self.heatmap_location_dir, self.video_name
-            )
-            self.video_folder = os.path.join(self.heatmap_location_dir, self.video_name)
-            self.temp_folder = os.path.join(
-                self.heatmap_location_dir, self.video_name, "temp"
-            )
-            if self.frame_setting:
-                if os.path.exists(self.save_frame_folder_dir):
-                    remove_a_folder(folder_dir=self.save_frame_folder_dir)
-                if not os.path.exists(self.save_frame_folder_dir):
-                    os.makedirs(self.save_frame_folder_dir)
-            if self.video_setting:
-                if os.path.exists(self.temp_folder):
-                    remove_a_folder(folder_dir=self.temp_folder)
-                    remove_a_folder(folder_dir=self.video_folder)
-                os.makedirs(self.temp_folder)
-                self.save_video_path = os.path.join(
-                    self.heatmap_location_dir, f"{self.video_name}.mp4"
+            self.video_name = self.output_filename
+            with h5py.File(video_data["DATA"], "r") as f:
+                missing_keys = [
+                    x
+                    for x in ["tracks", "point_scores", "node_names", "track_names"]
+                    if not x in list(f.keys())
+                ]
+                if missing_keys:
+                    stdout_warning(
+                        msg=f'{video_data["DATA"]} is not a valid SLEAP H5 file. Missing keys {missing_keys} Skipping {self.output_filename}...'
+                    )
+                    continue
+                tracks = f["tracks"][:].T
+                point_scores = f["point_scores"][:].T
+
+            csv_rows = []
+            n_frames, n_nodes, _, n_tracks = tracks.shape
+            for frame_ind in range(n_frames):
+                csv_row = []
+                for track_ind in range(n_tracks):
+                    for node_ind in range(n_nodes):
+                        for xyp in range(3):
+                            if xyp == 0 or xyp == 1:
+                                data = tracks[frame_ind, node_ind, xyp, track_ind]
+                            else:
+                                data = point_scores[frame_ind, node_ind, track_ind]
+
+                            csv_row.append(f"{data:.3f}")
+                csv_rows.append(" ".join(csv_row))
+            csv_rows = "\n".join(csv_rows)
+            self.data_df = pd.read_csv(
+                io.StringIO(csv_rows), delim_whitespace=True, header=None
+            ).fillna(0)
+            if len(self.data_df.columns) != len(self.bp_headers):
+                raise BodypartColumnNotFoundError(
+                    msg=f'The number of body-parts in data file {video_data["DATA"]} do not match the number of body-parts in your SimBA project. '
+                    f"The number of of body-parts expected by your SimBA project is {int(len(self.bp_headers) / 3)}. "
+                    f'The number of of body-parts contained in data file {video_data["DATA"]} is {int(len(self.data_df.columns) / 3)}. '
+                    f"Make sure you have specified the correct number of animals and body-parts in your project.",
+                    source=self.__class__.__name__,
+                )
+            self.data_df.columns = self.bp_headers
+            if self.animal_cnt > 1:
+                self.initialize_multi_animal_ui(
+                    animal_bp_dict=self.animal_bp_dict,
+                    video_info=get_video_meta_data(video_data["VIDEO"]),
+                    data_df=self.data_df,
+                    video_path=video_data["VIDEO"],
                 )
+                self.multianimal_identification()
 
-            self.data_df = read_df(
-                file_path=file_path, file_type=self.file_type, usecols=self.bp_lst
+            else:
+                self.out_df = self.insert_multi_idx_columns(df=self.data_df.fillna(0))
+
+            self.save_path = os.path.join(
+                os.path.join(
+                    self.input_csv_dir, f"{self.output_filename}.{self.file_type}"
+                )
             )
-            squares, aspect_ratio = GeometryMixin().bucket_img_into_grid_square(
-                bucket_grid_size_mm=self.style_attr["bin_size"],
-                img_size=(self.width, self.height),
-                px_per_mm=self.px_per_mm,
+            write_df(
+                df=self.out_df,
+                file_type=self.file_type,
+                save_path=self.save_path,
+                multi_idx_header=True,
             )
-            cum_sum_squares = GeometryMixin().cumsum_coord_geometries(
-                data=self.data_df.values, fps=self.fps, geometries=squares
+            if self.interpolation_settings != "None":
+                self.__run_interpolation()
+            if self.smoothing_settings["Method"] != "None":
+                self.__run_smoothing()
+            video_timer.stop_timer()
+            stdout_success(
+                msg=f"Video {self.output_filename} data imported...",
+                elapsed_time=video_timer.elapsed_time_str,
+                source=self.__class__.__name__,
             )
-            if self.max_scale == "auto":
-                self.max_scale = np.round(
-                    np.max(np.max(cum_sum_squares[-1], axis=0)), 3
-                )
-                if self.max_scale == 0:
-                    self.max_scale = 1
-            else:
-                self.max_scale = self.style_attr["max_scale"]
+        self.timer.stop_timer()
+        stdout_success(
+            msg="All SLEAP H5 data files imported",
+            elapsed_time=self.timer.elapsed_time_str,
+            source=self.__class__.__name__,
+        )
 
-            if self.final_img_setting:
-                self.make_location_heatmap_plot(
-                    frm_data=cum_sum_squares[-1, :, :],
-                    max_scale=self.max_scale,
-                    palette=self.palette,
-                    aspect_ratio=aspect_ratio,
-                    file_name=os.path.join(
-                        self.heatmap_location_dir, self.video_name + "_final_frm.png"
-                    ),
-                    shading=self.shading,
-                    img_size=(self.width, self.height),
-                    final_img=True,
-                )
+    def __run_interpolation(self):
+        print(
+            f"Interpolating missing values in video {self.output_filename} (Method: {self.interpolation_settings})..."
+        )
+        _ = Interpolate(
+            input_path=self.save_path,
+            config_path=self.config_path,
+            method=self.interpolation_settings,
+            initial_import_multi_index=True,
+        )
 
-            if self.video_setting or self.frame_setting:
-                print("Creating video frames...")
-                frame_arrays = np.array_split(cum_sum_squares, self.core_cnt)
-                last_frm_idx = 0
-                for frm_group in range(len(frame_arrays)):
-                    split_arr = frame_arrays[frm_group]
-                    frame_arrays[frm_group] = self.__insert_group_idx_column(
-                        data=split_arr, group=frm_group, last_frm_idx=last_frm_idx
-                    )
-                    last_frm_idx = np.max(
-                        frame_arrays[frm_group].reshape(
-                            (frame_arrays[frm_group].shape[0], -1)
-                        )
-                    )
+    def __run_smoothing(self):
+        print(
+            f'Performing {self.smoothing_settings["Method"]} smoothing on video {self.output_filename}...'
+        )
+        Smooth(
+            config_path=self.config_path,
+            input_path=self.save_path,
+            time_window=int(self.smoothing_settings["Parameters"]["Time_window"]),
+            smoothing_method=self.smoothing_settings["Method"],
+            initial_import_multi_index=True,
+        )
 
-                frm_per_core = frame_arrays[0].shape[0]
-                with multiprocessing.Pool(
-                    self.core_cnt, maxtasksperchild=self.maxtasksperchild
-                ) as pool:
-                    constants = functools.partial(
-                        _heatmap_location,
-                        video_setting=self.video_setting,
-                        frame_setting=self.frame_setting,
-                        style_attr=self.style_attr,
-                        fps=self.fps,
-                        video_temp_dir=self.temp_folder,
-                        frame_dir=self.save_frame_folder_dir,
-                        max_scale=self.max_scale,
-                        aspect_ratio=aspect_ratio,
-                        size=(self.width, self.height),
-                        video_name=self.video_name,
-                        make_location_heatmap_plot=self.make_location_heatmap_plot,
-                    )
-                    for cnt, result in enumerate(
-                        pool.imap(
-                            constants,
-                            frame_arrays,
-                            chunksize=self.multiprocess_chunksize,
-                        )
-                    ):
-                        print(
-                            "Image {}/{}, Video {}/{}...".format(
-                                str(int(frm_per_core * (result + 1))),
-                                str(len(self.data_df)),
-                                str(file_cnt + 1),
-                                str(len(self.files_found)),
-                            )
-                        )
-                    pool.terminate()
-                    pool.join()
-
-                if self.video_setting:
-                    print(
-                        "Joining {} multiprocessed heatmap location video...".format(
-                            self.video_name
-                        )
-                    )
-                    concatenate_videos_in_folder(
-                        in_folder=self.temp_folder, save_path=self.save_video_path
-                    )
 
-                video_timer.stop_timer()
-                print(
-                    "Heatmap video {} complete (elapsed time: {}s) ...".format(
-                        self.video_name, video_timer.elapsed_time_str
-                    )
-                )
+# test = SLEAPImporterH5(config_path="/Users/simon/Desktop/envs/simba/troubleshooting/sleap_two_animals/project_folder/project_config.ini",
+#                    data_folder=r'/Users/simon/Desktop/envs/simba/troubleshooting/sleap_two_animals/h5_import',
+#                    id_lst=['White', 'Black'],
+#                    interpolation_settings= "Body-parts: Nearest", #'"Body-parts: Nearest",
+#                    smoothing_settings = {'Method': 'None', 'Parameters': {'Time_window': '200'}})
+# test.run()
+
+
+# test = SLEAPImporterH5(config_path="/Users/simon/Desktop/envs/troubleshooting/sleap_import/project_folder/project_config.ini",
+#                    data_folder=r'/Users/simon/Desktop/envs/troubleshooting/sleap_import/data_h5',
+#                    id_lst=['White', 'Black'],
+#                    interpolation_settings= "Body-parts: Nearest", #'"Body-parts: Nearest",
+#                    smoothing_settings = {'Method': 'None', 'Parameters': {'Time_window': '200'}})
+# test.run()
 
-            self.timer.stop_timer()
-            stdout_success(
-                msg=f"Heatmap location videos visualizations for {len(self.files_found)} videos created in project_folder/frames/output/heatmaps_locations directory",
-                elapsed_time=self.timer.elapsed_time_str,
-                source=self.__class__.__name__,
-            )
 
+# test = SLEAPImporterH5(config_path="/Users/simon/Desktop/envs/troubleshooting/sleap_dropped_frms_2/project_folder/project_config.ini",
+#                    data_folder=r'/Users/simon/Desktop/envs/troubleshooting/sleap_dropped_frms_2/data',
+#                    id_lst=['Simon'],
+#                    interpolation_settings= 'None', #'"Body-parts: Nearest",
+#                    smoothing_settings = {'Method': 'None', 'Parameters': {'Time_window': '200'}})
+# test.run()
 
-# test = HeatMapperLocationMultiprocess(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini',
-#                                       style_attr = {'palette': 'jet', 'shading': 'gouraud', 'bin_size': 80, 'max_scale': 'auto'},
-#                                       final_img_setting=True,
-#                                       video_setting=False,
-#                                       frame_setting=False,
-#                                       bodypart='Nose_1',
-#                                       core_cnt=5,
-#                                       files_found=['/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/csv/outlier_corrected_movement_location/Together_1.csv'])
+# test = SLEAPImporterH5(config_path="/Users/simon/Desktop/envs/troubleshooting/Termites_5/project_folder/project_config.ini",
+#                    data_folder=r'/Users/simon/Desktop/envs/troubleshooting/Termites_5/import_h5',
+#                    id_lst=['Simon', 'Nastacia', 'Ben', 'John', 'JJ'],
+#                    interpolation_settings="Body-parts: Nearest",
+#                    smoothing_settings = {'Method': 'Savitzky Golay', 'Parameters': {'Time_window': '200'}})
 # test.run()
+# print('All SLEAP imports complete.')
+
 
-# test = HeatMapperLocationMultiprocess(config_path='/Users/simon/Desktop/envs/troubleshooting/Rat_NOR/project_folder/project_config.ini',
-#                                       style_attr = {'palette': 'jet', 'shading': 'gouraud', 'bin_size': 100, 'max_scale': 'auto'},
-#                                       final_img_setting=True,
-#                                       video_setting=False,
-#                                       frame_setting=False,
-#                                       bodypart='Nose',
-#                                       core_cnt=5,
-#                                       files_found=['/Users/simon/Desktop/envs/troubleshooting/Rat_NOR/project_folder/csv/machine_results/2022-06-26_NOB_DOT_4.csv'])
+#
+# test = SLEAPImporterH5(config_path="/Users/simon/Desktop/envs/troubleshooting/sleap_dropped_frms/project_folder/project_config.ini",
+#                    data_folder=r'/Users/simon/Desktop/envs/troubleshooting/sleap_dropped_frms/data',
+#                    id_lst=['Simon'],
+#                    interpolation_settings= 'None', #'"Body-parts: Nearest",
+#                    smoothing_settings = {'Method': 'None', 'Parameters': {'Time_window': '200'}})
 # test.run()
 
-# img = np.zeros((img_size[0], img_size[1], 3)).astype(np.uint8)
-# for i in polygons:
-#     coords = np.array(i.exterior.coords).astype(np.int)
-#     print(coords)
-#     cv2.polylines(img, [coords], True, (0, 0, 50), 2)
-# cv2.imshow('img', img)
-# cv2.waitKey()
+
+# test = SLEAPImporterH5(config_path="/Users/simon/Desktop/envs/troubleshooting/SLEAP_2_Animals_16_body_parts/project_folder/project_config.ini",
+#                    data_folder=r'/Users/simon/Desktop/envs/troubleshooting/SLEAP_2_Animals_16_body_parts/data/h5',
+#                    id_lst=['Simon', 'Nastacia'],
+#                    interpolation_settings="Body-parts: Nearest",
+#                    smoothing_settings = {'Method': 'Savitzky Golay', 'Parameters': {'Time_window': '200'}})
+# test.run()
+# print('All SLEAP imports complete.')
+
+
+# test = SLEAPImporterH5(config_path="/Users/simon/Desktop/envs/troubleshooting/Termites_5/project_folder/project_config.ini",
+#                    data_folder=r'/Users/simon/Desktop/envs/troubleshooting/Termites_5/import_h5',
+#                    id_lst=['Simon', 'Nastacia', 'Ben', 'John', 'JJ'],
+#                    interpolation_settings='None',
+#                    smoothing_settings = {'Method': 'None'})
+# test.run()
+# print('All SLEAP imports complete.')
+#
+# test = SLEAPImporterH5(config_path="/Users/simon/Desktop/envs/troubleshooting/sleap_cody/project_folder/project_config.ini",
+#                    data_folder=r'/Users/simon/Desktop/envs/troubleshooting/sleap_cody/import_h5',
+#                    actor_IDs=['Nastacia', 'Sam'],
+#                    interpolation_settings="Body-parts: Nearest",
+#                    smoothing_settings = {'Method': 'Savitzky Golay', 'Parameters': {'Time_window': '200'}})
+# test.import_sleap()
+# print('All SLEAP imports complete.')
+
+
+# test = SLEAPImporterH5(config_path="/Users/simon/Desktop/envs/troubleshooting/sleap_cody/project_folder/project_config.ini",
+#                    data_folder=r'/Users/simon/Desktop/envs/troubleshooting/sleap_cody/import_h5',
+#                    actor_IDs=['Nastacia'],
+#                    interpolation_settings="Body-parts: Nearest",
+#                    smoothing_settings = {'Method': 'Savitzky Golay', 'Parameters': {'Time_window': '200'}})
+# test.import_sleap()
+# # print('All SLEAP imports complete.')
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/dash_app/SimBA_dash_app.py` & `Simba-UW-tf-dev-1.89.5/simba/dash_app/SimBA_dash_app.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/dash_app/run_dash_tkinter.py` & `Simba-UW-tf-dev-1.89.5/simba/dash_app/run_dash_tkinter.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/dash_app/dash_app.py` & `Simba-UW-tf-dev-1.89.5/simba/dash_app/dash_app.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/data_processors/spontaneous_alternation_calculator.py` & `Simba-UW-tf-dev-1.89.5/simba/data_processors/spontaneous_alternation_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/data_processors/agg_clf_calculator.py` & `Simba-UW-tf-dev-1.89.5/simba/data_processors/agg_clf_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/data_processors/.DS_Store` & `Simba-UW-tf-dev-1.89.5/simba/data_processors/.DS_Store`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/data_processors/severity_bout_based_calculator.py` & `Simba-UW-tf-dev-1.89.5/simba/data_processors/severity_bout_based_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/data_processors/interpolation_smoothing.py` & `Simba-UW-tf-dev-1.89.5/simba/data_processors/interpolation_smoothing.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/data_processors/directing_animal_to_bodypart.py` & `Simba-UW-tf-dev-1.89.5/simba/data_processors/directing_animal_to_bodypart.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/data_processors/timebins_clf_calculator.py` & `Simba-UW-tf-dev-1.89.5/simba/data_processors/timebins_clf_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/data_processors/fsttc_calculator.py` & `Simba-UW-tf-dev-1.89.5/simba/data_processors/fsttc_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/data_processors/boolean_conditional_calculator.py` & `Simba-UW-tf-dev-1.89.5/simba/data_processors/boolean_conditional_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/data_processors/interpolate_pose.py` & `Simba-UW-tf-dev-1.89.5/simba/data_processors/interpolate_pose.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/data_processors/directing_other_animals_calculator.py` & `Simba-UW-tf-dev-1.89.5/simba/data_processors/directing_other_animals_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/data_processors/gibbs_sampler.py` & `Simba-UW-tf-dev-1.89.5/simba/data_processors/gibbs_sampler.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/data_processors/timebins_movement_calculator.py` & `Simba-UW-tf-dev-1.89.5/simba/data_processors/timebins_movement_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/data_processors/severity_calculator.py` & `Simba-UW-tf-dev-1.89.5/simba/data_processors/severity_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/data_processors/pup_retrieval_calculator.py` & `Simba-UW-tf-dev-1.89.5/simba/data_processors/pup_retrieval_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/data_processors/pybursts_calculator.py` & `Simba-UW-tf-dev-1.89.5/simba/data_processors/pybursts_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/data_processors/severity_frame_based_calculator.py` & `Simba-UW-tf-dev-1.89.5/simba/data_processors/severity_frame_based_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/data_processors/mutual_exclusivity_corrector.py` & `Simba-UW-tf-dev-1.89.5/simba/data_processors/mutual_exclusivity_corrector.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/data_processors/kleinberg_calculator.py` & `Simba-UW-tf-dev-1.89.5/simba/data_processors/kleinberg_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/data_processors/movement_calculator.py` & `Simba-UW-tf-dev-1.89.5/simba/outlier_tools/outlier_corrector_location.py`

 * *Files 19% similar despite different names*

```diff
@@ -1,229 +1,233 @@
 __author__ = "Simon Nilsson"
 
+import glob
 import os
-from statistics import mean
-from typing import List, Optional
 
 import numpy as np
 import pandas as pd
 
-from simba.feature_extractors.perimeter_jit import jitted_centroid
 from simba.mixins.config_reader import ConfigReader
-from simba.mixins.feature_extraction_mixin import FeatureExtractionMixin
-from simba.utils.checks import check_if_filepath_list_is_empty
-from simba.utils.printing import stdout_success
-from simba.utils.read_write import get_fn_ext, read_df
+from simba.utils.enums import ConfigKey, Dtypes
+from simba.utils.printing import SimbaTimer, stdout_success
+from simba.utils.read_write import (get_fn_ext, read_config_entry, read_df,
+                                    write_df)
 
 
-class MovementCalculator(ConfigReader, FeatureExtractionMixin):
+class OutlierCorrecterLocation(ConfigReader):
     """
-    Compute aggregate movement statistics from pose-estimation data in SimBA project.
-
-    :parameters str config_path: path to SimBA project config file in Configparser format
-    :param List[str] body_parts: Body-parts to use for movement calculations OR ``Animal_name CENTER OF GRAVITY``. If ``Animal_name CENTER OF GRAVITY``, then SimBA will approximate animal centroids through convex hull.
-    :param float threshold: Filter body-part detection below set threshold (Value 0-1). Default: 0.00
-    :param List[str] or None file_paths: Files to calucalte movements for. If None, then all files in ``project_folder/csv/outlier_corrected_movement_location`` directory.
+    Detect and amend outliers in pose-estimation data based in the location of the body-parts
+    in the current frame relative to the location of the body-part in the preceding frame. Uses critera
+    stored in the SimBA project project_config.ini under the [Outlier settings] header.
 
     .. note::
-       `Tutorial <https://github.com/sgoldenlab/simba/blob/master/docs/Scenario2.md#part-4--analyze-machine-results>`__.
+       `Documentation <https://github.com/sgoldenlab/simba/blob/master/misc/Outlier_settings.pdf>`_.
+
+    .. image:: _static/img/location_outlier.png
+       :width: 500
+       :align: center
 
-    :examples:
-    >>> body_parts=['Animal_1 CENTER OF GRAVITY']
-    >>> movement_processor = MovementCalculator(config_path='project_folder/project_config.ini', body_parts=body_parts)
-    >>> movement_processor.run()
-    >>> movement_processor.save()
+    :parameter str config_path: path to SimBA project config file in Configparser format
 
+    Examples
+    ----------
+    >>> _ = OutlierCorrecterLocation(config_path='MyProjectConfig').run()
     """
 
-    def __init__(
-        self,
-        config_path: str,
-        body_parts: List[str],
-        threshold: float = 0.00,
-        file_paths: Optional[List[str]] = None,
-    ):
-        ConfigReader.__init__(self, config_path=config_path)
-        FeatureExtractionMixin.__init__(self)
-        self.save_path = os.path.join(
-            self.logs_path, "Movement_log_{}.csv".format(self.datetime)
-        )
-        self.file_paths, self.body_parts, self.threshold = (
-            file_paths,
-            body_parts,
-            threshold,
-        )
-        if not self.file_paths:
-            check_if_filepath_list_is_empty(
-                filepaths=self.outlier_corrected_paths,
-                error_msg=f"SIMBA ERROR: Cannot process movement. ZERO data files found in the {self.outlier_corrected_dir} directory.",
-            )
-            self.file_paths = self.outlier_corrected_paths
-        print(f"Processing {len(self.file_paths)} video(s)...")
-
-    def __find_body_part_columns(self):
-        self.body_parts_dict, self.bp_list = {}, []
-        for bp_cnt, bp_name in enumerate(self.body_parts):
-            if not bp_name.endswith("CENTER OF GRAVITY"):
-                animal_name = self.find_animal_name_from_body_part_name(
-                    bp_name=bp_name, bp_dict=self.animal_bp_dict
+    def __init__(self, config_path: str):
+        super().__init__(config_path=config_path)
+        if not os.path.exists(self.outlier_corrected_dir):
+            os.makedirs(self.outlier_corrected_dir)
+        if self.animal_cnt == 1:
+            self.animal_id = read_config_entry(
+                self.config,
+                ConfigKey.MULTI_ANIMAL_ID_SETTING.value,
+                ConfigKey.MULTI_ANIMAL_IDS.value,
+                Dtypes.STR.value,
+            )
+            if self.animal_id != "None":
+                self.animal_bp_dict[self.animal_id] = self.animal_bp_dict.pop(
+                    "Animal_1"
                 )
-                self.body_parts_dict[bp_cnt] = {
-                    "ANIMAL NAME": animal_name,
-                    "BODY-PART": bp_name,
-                    "BODY-PART HEADERS": [
-                        f"{bp_name}_x",
-                        f"{bp_name}_y",
-                        f"{bp_name}_p",
-                    ],
-                }
-                self.bp_list.extend((self.body_parts_dict[bp_cnt]["BODY-PART HEADERS"]))
-            else:
-                pass
+        self.above_criterion_dict_dict = {}
+        self.below_criterion_dict_dict = {}
+        self.criterion = read_config_entry(
+            self.config,
+            ConfigKey.OUTLIER_SETTINGS.value,
+            ConfigKey.LOCATION_CRITERION.value,
+            Dtypes.FLOAT.value,
+        )
+        self.outlier_bp_dict = {}
+        for animal_name in self.animal_bp_dict.keys():
+            self.outlier_bp_dict[animal_name] = {}
+            self.outlier_bp_dict[animal_name]["bp_1"] = read_config_entry(
+                self.config,
+                ConfigKey.OUTLIER_SETTINGS.value,
+                "location_bodypart1_{}".format(animal_name.lower()),
+                "str",
+            )
+            self.outlier_bp_dict[animal_name]["bp_2"] = read_config_entry(
+                self.config,
+                ConfigKey.OUTLIER_SETTINGS.value,
+                "location_bodypart2_{}".format(animal_name.lower()),
+                "str",
+            )
 
-    def __find_polygons(self, data):
-        print(data.shape)
+    def __find_location_outliers(self):
+        for animal_name, animal_data in self.bp_dict.items():
+            animal_criterion = self.animal_criteria[animal_name]
+            self.above_criterion_dict_dict[self.video_name][animal_name] = {}
+            self.below_criterion_dict_dict[self.video_name][animal_name] = {}
+            for body_part_name, body_part_data in animal_data.items():
+                self.above_criterion_dict_dict[self.video_name][animal_name][
+                    body_part_name
+                ] = []
+                self.below_criterion_dict_dict[self.video_name][animal_name][
+                    body_part_name
+                ] = []
+                for frame in range(body_part_data.shape[0]):
+                    second_bp_names = [
+                        x for x in list(animal_data.keys()) if x != body_part_name
+                    ]
+                    first_bp_cord = body_part_data[frame]
+                    distance_above_criterion_counter = 0
+                    for second_bp in second_bp_names:
+                        second_bp_cord = animal_data[second_bp][frame]
+                        distance = np.sqrt(
+                            (first_bp_cord[0] - second_bp_cord[0]) ** 2
+                            + (first_bp_cord[1] - second_bp_cord[1]) ** 2
+                        )
+                        if distance > animal_criterion:
+                            distance_above_criterion_counter += 1
+                    if distance_above_criterion_counter > 1:
+                        self.above_criterion_dict_dict[self.video_name][animal_name][
+                            body_part_name
+                        ].append(frame)
+                    else:
+                        self.below_criterion_dict_dict[self.video_name][animal_name][
+                            body_part_name
+                        ].append(frame)
+
+    def __correct_outliers(self):
+        above_citeria_dict = self.above_criterion_dict_dict[self.video_name]
+        for animal_name, animal_bp_data in above_citeria_dict.items():
+            for bp_name, outlier_idx_lst in animal_bp_data.items():
+                body_part_x, body_part_y = bp_name + "_x", bp_name + "_y"
+                for outlier_idx in outlier_idx_lst:
+                    try:
+                        closest_idx = max(
+                            [
+                                i
+                                for i in self.below_criterion_dict_dict[
+                                    self.video_name
+                                ][animal_name][bp_name]
+                                if outlier_idx > i
+                            ]
+                        )
+                    except ValueError:
+                        closest_idx = outlier_idx
+                    self.data_df.loc[[outlier_idx], body_part_x] = self.data_df.loc[
+                        [closest_idx], body_part_x
+                    ].values[0]
+                    self.data_df.loc[[outlier_idx], body_part_y] = self.data_df.loc[
+                        [closest_idx], body_part_y
+                    ].values[0]
 
     def run(self):
-        self.results = pd.DataFrame(
-            columns=["VIDEO", "ANIMAL", "BODY-PART", "MEASURE", "VALUE"]
-        )
-        self.movement_dfs = {}
-        for file_path in self.file_paths:
-            self.__find_body_part_columns()
-            _, video_name, _ = get_fn_ext(file_path)
-            print("Analysing {}...".format(video_name))
-            self.data_df = read_df(file_path=file_path, file_type=self.file_type)
-            self.video_info, self.px_per_mm, self.fps = self.read_video_info(
-                video_name=video_name
-            )
-            self.movement_dfs[video_name] = pd.DataFrame()
-            if self.bp_list:
-                self.data_df = self.data_df[self.bp_list]
-                for animal_cnt, animal_data in self.body_parts_dict.items():
-                    animal_df = self.data_df[animal_data["BODY-PART HEADERS"]]
-                    if self.threshold > 0.00:
-                        animal_df = animal_df[
-                            animal_df[animal_data["BODY-PART HEADERS"][-1]]
-                            >= self.threshold
-                        ]
-                    animal_df = animal_df.iloc[:, 0:2].reset_index(drop=True)
-                    animal_df = self.create_shifted_df(df=animal_df)
-                    bp_time_1 = animal_df[
-                        [
-                            animal_data["BODY-PART HEADERS"][0],
-                            animal_data["BODY-PART HEADERS"][1],
-                        ]
-                    ].values.astype(float)
-                    bp_time_2 = animal_df[
-                        [
-                            animal_data["BODY-PART HEADERS"][0] + "_shifted",
-                            animal_data["BODY-PART HEADERS"][1] + "_shifted",
-                        ]
-                    ].values.astype(float)
-                    self.movement = pd.Series(
-                        self.framewise_euclidean_distance(
-                            location_1=bp_time_1,
-                            location_2=bp_time_2,
-                            px_per_mm=self.px_per_mm,
-                        )
+        """
+        Runs outlier detection and correction. Results are stored in the
+        ``project_folder/csv/outlier_corrected_movement_location`` directory of the SimBA project.
+        """
+
+        for file_cnt, file_path in enumerate(self.outlier_corrected_movement_paths):
+            video_timer = SimbaTimer(start=True)
+            _, self.video_name, _ = get_fn_ext(file_path)
+            print(
+                f"Processing video {self.video_name}. Video {file_cnt+1}/{len(self.outlier_corrected_movement_paths)}.."
+            )
+            self.above_criterion_dict_dict[self.video_name] = {}
+            self.below_criterion_dict_dict[self.video_name] = {}
+            save_path = os.path.join(
+                self.outlier_corrected_dir, self.video_name + "." + self.file_type
+            )
+            self.data_df = read_df(file_path, self.file_type)
+            self.animal_criteria = {}
+            for animal_name, animal_bps in self.outlier_bp_dict.items():
+                animal_bp_distances = np.sqrt(
+                    (
+                        self.data_df[animal_bps["bp_1"] + "_x"]
+                        - self.data_df[animal_bps["bp_2"] + "_x"]
                     )
-                    self.movement.loc[0] = 0
-                    self.movement_dfs[video_name][
-                        f'{animal_data["ANIMAL NAME"]} {animal_data["BODY-PART"]}'
-                    ] = self.movement
-                    distance = round((self.movement.sum() / 10), 4)
-                    velocity_lst = []
-                    for df in np.array_split(
-                        self.movement, int(len(self.movement) / self.fps)
-                    ):
-                        velocity_lst.append(df.sum())
-                    self.results.loc[len(self.results)] = [
-                        video_name,
-                        animal_data["ANIMAL NAME"],
-                        animal_data["BODY-PART"],
-                        "Distance (cm)",
-                        distance,
-                    ]
-                    self.results.loc[len(self.results)] = [
-                        video_name,
-                        animal_data["ANIMAL NAME"],
-                        animal_data["BODY-PART"],
-                        "Velocity (cm/s)",
-                        round((mean(velocity_lst) / 10), 4),
-                    ]
-
-            else:
-                for animal in self.body_parts:
-                    animal_name = animal.split("CENTER OF GRAVITY")[0].strip()
-                    x, y = (
-                        self.data_df[self.animal_bp_dict[animal_name]["X_bps"]],
-                        self.data_df[self.animal_bp_dict[animal_name]["Y_bps"]],
+                    ** 2
+                    + (
+                        self.data_df[animal_bps["bp_1"] + "_y"]
+                        - self.data_df[animal_bps["bp_2"] + "_y"]
                     )
-                    z = pd.concat([x, y], axis=1)[
-                        [item for items in zip(x.columns, y.columns) for item in items]
+                    ** 2
+                )
+                self.animal_criteria[animal_name] = (
+                    animal_bp_distances.mean() * self.criterion
+                )
+            self.bp_dict = {}
+            for animal_name, animal_bps in self.animal_bp_dict.items():
+                bp_col_names = np.array(
+                    [[i, j] for i, j in zip(animal_bps["X_bps"], animal_bps["Y_bps"])]
+                ).ravel()
+                animal_arr = self.data_df[bp_col_names].to_numpy()
+                self.bp_dict[animal_name] = {}
+                for bp_cnt, bp_col_start in enumerate(range(0, animal_arr.shape[1], 2)):
+                    bp_name = animal_bps["X_bps"][bp_cnt][:-2]
+                    self.bp_dict[animal_name][bp_name] = animal_arr[
+                        :, bp_col_start : bp_col_start + 2
                     ]
-                    df = pd.DataFrame(
-                        jitted_centroid(
-                            points=np.reshape(z.values, (len(z / 2), -1, 2)).astype(
-                                np.float32
-                            )
-                        ),
-                        columns=["X", "Y"],
-                    )
-                    df = self.dataframe_savgol_smoother(df=df, fps=self.fps).astype(int)
-                    df_shifted = df.shift(1)
-                    df_shifted = df_shifted.combine_first(df).add_suffix("_shifted")
-                    self.movement = pd.Series(
-                        self.framewise_euclidean_distance(
-                            location_1=df.values.astype(np.float32),
-                            location_2=df_shifted.values.astype(np.float32),
-                            px_per_mm=self.px_per_mm,
+            self.__find_location_outliers()
+            self.__correct_outliers()
+            write_df(df=self.data_df, file_type=self.file_type, save_path=save_path)
+            video_timer.stop_timer()
+            print(
+                f"Corrected location outliers for file {self.video_name} (elapsed time: {video_timer.elapsed_time_str}s)..."
+            )
+        self.__save_log_file()
+
+    def __save_log_file(self):
+        out_df_lst = []
+        for video_name, video_data in self.above_criterion_dict_dict.items():
+            for animal_name, animal_data in video_data.items():
+                for bp_name, vid_idx_lst in animal_data.items():
+                    correction_ratio = round(len(vid_idx_lst) / len(self.data_df), 6)
+                    out_df_lst.append(
+                        pd.DataFrame(
+                            [
+                                [
+                                    video_name,
+                                    animal_name,
+                                    bp_name,
+                                    len(vid_idx_lst),
+                                    correction_ratio,
+                                ]
+                            ],
+                            columns=[
+                                "Video",
+                                "Animal",
+                                "Body-part",
+                                "Corrections",
+                                "Correction ratio (%)",
+                            ],
                         )
                     )
-                    self.movement.loc[0] = 0
-                    self.movement_dfs[video_name][
-                        f'{animal_name} {"GRAVITY CENTER"}'
-                    ] = self.movement
-                    distance = round((self.movement.sum() / 10), 4)
-                    velocity_lst = []
-                    for df in np.array_split(
-                        self.movement, int(len(self.movement) / self.fps)
-                    ):
-                        velocity_lst.append(df.sum())
-                    self.results.loc[len(self.results)] = [
-                        video_name,
-                        animal_name,
-                        "GRAVITY CENTER",
-                        "Distance (cm)",
-                        distance,
-                    ]
-                    self.results.loc[len(self.results)] = [
-                        video_name,
-                        animal_name,
-                        "GRAVITY CENTER",
-                        "Velocity (cm/s)",
-                        round((mean(velocity_lst) / 10), 4),
-                    ]
-
-    def save(self):
-        self.results.set_index("VIDEO").to_csv(self.save_path)
+        out_df = pd.concat(out_df_lst, axis=0).reset_index(drop=True)
+        self.logs_path = os.path.join(
+            self.logs_path, f"Outliers_location_{self.datetime}.csv"
+        )
+        out_df.to_csv(self.logs_path)
         self.timer.stop_timer()
         stdout_success(
-            msg=f"Movement log saved in {self.save_path}",
+            msg='Log for corrected "location outliers" saved in project_folder/logs',
             elapsed_time=self.timer.elapsed_time_str,
         )
 
 
-# test = MovementCalculator(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini',
-#                           body_parts=['Simon CENTER OF GRAVITY'], #['Simon CENTER OF GRAVITY', 'JJ CENTER OF GRAVITY']
-#                           threshold=0.00)
+# test = OutlierCorrecterLocation(config_path='/Users/simon/Desktop/envs/troubleshooting/naresh/project_folder/project_config.ini')
 # test.run()
 
-
-# test.save()
-
-# test = MovementCalculator(config_path='/Users/simon/Desktop/envs/troubleshooting/locomotion/project_folder/project_config.ini',
-#                           body_parts=['Animal_1 CENTER OF GRAVITY'], #['Simon CENTER OF GRAVITY', 'JJ CENTER OF GRAVITY']
-#                           threshold=0.00)
-# test.run()
-# test.save()
+# test = OutlierCorrecterLocation(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini')
+# test.correct_location_outliers()
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/model/train_rf.py` & `Simba-UW-tf-dev-1.89.5/simba/model/train_rf.py`

 * *Files 1% similar despite different names*

```diff
@@ -499,27 +499,33 @@
         """
         Method for saving pickled RF model. The model is saved in the `models/generated_models` directory
         of the SimBA project tree.
         """
 
         self.timer.stop_timer()
         print(self.model_dir_out)
-        if not os.listdir(self.model_dir_out): os.makedirs(self.model_dir_out)
+        if not os.listdir(self.model_dir_out):
+            os.makedirs(self.model_dir_out)
         self.save_rf_model(self.rf_clf, self.clf_name, self.model_dir_out)
         stdout_success(
             msg=f"Classifier {self.clf_name} saved in models/generated_models directory",
             elapsed_time=self.timer.elapsed_time_str,
             source=self.__class__.__name__,
         )
         stdout_success(
             msg=f"Evaluation files are in models/generated_models/model_evaluations folders",
             source=self.__class__.__name__,
         )
 
 
+# test = TrainRandomForestClassifier(config_path='/Users/simon/Desktop/envs/simba/troubleshooting/beepboop174/project_folder/project_config.ini')
+# test.run()
+# test.save()
+
+
 # test = TrainRandomForestClassifier(config_path='/Users/simon/Desktop/envs/simba/troubleshooting/mouse_open_field/project_folder/project_config.ini')
 # test.run()
 # test.save()
 
 
 # test = TrainRandomForestClassifier(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini')
 # test.perform_sampling()
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/model/inference_batch.py` & `Simba-UW-tf-dev-1.89.5/simba/model/inference_batch.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/model/train_multiclass_rf.py` & `Simba-UW-tf-dev-1.89.5/simba/model/train_multiclass_rf.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/model/inference_multiclass_batch.py` & `Simba-UW-tf-dev-1.89.5/simba/model/inference_multiclass_batch.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/model/grid_search_multiclass_rf.py` & `Simba-UW-tf-dev-1.89.5/simba/model/grid_search_multiclass_rf.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/model/grid_search_rf.py` & `Simba-UW-tf-dev-1.89.5/simba/model/grid_search_rf.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/model/inference_validation.py` & `Simba-UW-tf-dev-1.89.5/simba/model/inference_validation.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/model/train_multilabel_rf.py` & `Simba-UW-tf-dev-1.89.5/simba/model/train_multilabel_rf.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_time_bin_calculator.py` & `Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_time_bin_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_movement_analyzer.py` & `Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_movement_analyzer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/roi_tools/.DS_Store` & `Simba-UW-tf-dev-1.89.5/simba/roi_tools/.DS_Store`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_define.py` & `Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_define.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_reset.py` & `Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_reset.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_size_standardizer.py` & `Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_size_standardizer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_analyzer.py` & `Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_analyzer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_feature_analyzer.py` & `Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_feature_analyzer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_multiply.py` & `Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_multiply.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_size_calculations.py` & `Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_size_calculations.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_zoom.py` & `Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_zoom.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_directing_analyzer.py` & `Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_directing_analyzer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_move_shape.py` & `Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_move_shape.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_menus.py` & `Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_menus.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_clf_calculator.py` & `Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_clf_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/roi_tools/ROI_image.py` & `Simba-UW-tf-dev-1.89.5/simba/roi_tools/ROI_image.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/pose_importers/sleap_csv_importer.py` & `Simba-UW-tf-dev-1.89.5/simba/pose_importers/sleap_csv_importer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/pose_importers/misc/apt_trk_importer.py` & `Simba-UW-tf-dev-1.89.5/simba/pose_importers/misc/apt_trk_importer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/pose_importers/read_DANNCE_mat.py` & `Simba-UW-tf-dev-1.89.5/simba/pose_importers/read_DANNCE_mat.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/pose_importers/.DS_Store` & `Simba-UW-tf-dev-1.89.5/simba/pose_importers/.DS_Store`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/pose_importers/sleap_h5_importer.py` & `Simba-UW-tf-dev-1.89.5/simba/outlier_tools/outlier_corrector_movement_advanced.py`

 * *Files 24% similar despite different names*

```diff
@@ -1,292 +1,268 @@
-#### MODIFIED FROM @Toshea111 - https://github.com/Toshea111/sleap/blob/develop/docs/notebooks/Convert_HDF5_to_CSV_updated.ipynb
-import io
+__author__ = "Simon Nilsson"
+
 import os
+from typing import Union
 
-import h5py
 import numpy as np
 import pandas as pd
 
-from simba.data_processors.interpolation_smoothing import Interpolate, Smooth
+try:
+    from typing import Literal
+except:
+    from typing_extensions import Literal
+
+from copy import deepcopy
+
 from simba.mixins.config_reader import ConfigReader
-from simba.mixins.pose_importer_mixin import PoseImporterMixin
-from simba.utils.enums import Methods, TagNames
-from simba.utils.errors import BodypartColumnNotFoundError
-from simba.utils.printing import (SimbaTimer, log_event, stdout_success,
-                                  stdout_warning)
-from simba.utils.read_write import (clean_sleap_file_name,
-                                    find_all_videos_in_project, get_fn_ext,
-                                    get_video_meta_data, write_df)
+from simba.mixins.feature_extraction_mixin import FeatureExtractionMixin
+from simba.utils.enums import TagNames
+from simba.utils.errors import InvalidInputError, NoFilesFoundError
+from simba.utils.printing import SimbaTimer, log_event, stdout_success
+from simba.utils.read_write import (find_files_of_filetypes_in_directory,
+                                    get_fn_ext, read_df, write_df)
 
 
-class SLEAPImporterH5(ConfigReader, PoseImporterMixin):
+class OutlierCorrecterMovementAdvanced(ConfigReader, FeatureExtractionMixin):
     """
-    Importing SLEAP pose-estimation data into SimBA project in ``H5`` format
-
-    :parameter str config_path: path to SimBA project config file in Configparser format
-    :parameter str data_folder: Path to folder containing SLEAP data in `csv` format.
-    :parameter List[str] id_lst: Animal names. This will be ignored in one animal projects and default to ``Animal_1``.
-    :parameter str interpolation_settings: String defining the pose-estimation interpolation method. OPTIONS: 'None', 'Animal(s): Nearest',
-        'Animal(s): Linear', 'Animal(s): Quadratic','Body-parts: Nearest', 'Body-parts: Linear',
-        'Body-parts: Quadratic'.
-    :parameter str smoothing_settings: Dictionary defining the pose estimation smoothing method. EXAMPLE: {'Method': 'Savitzky Golay',
-        'Parameters': {'Time_window': '200'}}
+    Performs outlier correction that allows different heuristic outlier criteria for different animals or body-parts.
+    For example, correct some outlier body-parts with a movement heuristic criteria of 2x above the mean movement,
+    and other body-parts with a heuristic critera of 1.5x above the mean movement.
 
     .. note::
-       `Multi-animal import tutorial <https://github.com/sgoldenlab/simba/blob/master/docs/Multi_animal_pose.md>`__.
+       See `notebook <https://simba-uw-tf-dev.readthedocs.io/en/latest/nb/advanced_outlier_correction.html>`__. for example use-case.
 
-    References
-    ----------
-    .. [1] Pereira et al., SLEAP: A deep learning system for multi-animal pose tracking, `Nature Methods`,
-           2022.
-
-    >>> sleap_h5_importer = SLEAPImporterH5(config_path=r'project_folder/project_config.ini', data_folder=r'data_folder', actor_IDs=['Termite_1', 'Termite_2', 'Termite_3', 'Termite_4', 'Termite_5'], interpolation_settings="Body-parts: Nearest", smoothing_settings = {'Method': 'Savitzky Golay', 'Parameters': {'Time_window': '200'}})
-    >>> sleap_h5_importer.run()
+    .. image:: _static/img/movement_outlier.png
+       :width: 400
+       :align: center
+
+    :parameter str config_path: path to SimBA project config file in Configparser format.
+    :parameter str input_dir: Directory containing input files. E.g., `project_folder/csv/input_csv` directory.
+    :parameter Literal['animal', 'body-part'] type: If the rules are defined on animal or body-part level. E.g., If one heuristic rule per animal then `animal`. If one heurstic rule prr body-part then `body-parts`
+    :parameter Literal['mean', 'median'] agg_method: If to use the mean or median to compute criterion.
+    :parameter dict criterion_body_parts: The body-parts used to calculate the size of the animals.
+    :parameter dict settings: The heuristic multiplier rules to use for each body part or animal.
+
+    :example:
+    >>> settings = {'Simon': 1.1, 'JJ': 1.2}
+    >>> criterion_body_parts = {'Simon': ['Nose_1', 'Tail_base_1'], 'JJ': ['Nose_2', 'Tail_base_2']}
+    >>> outlier_corrector = OutlierCorrecterMovementAdvanced(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini', input_dir='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/csv/input_csv', type='animal', agg_method='mean', criterion_body_parts=criterion_body_parts, settings=settings)
+    >>> outlier_corrector.run()
+    >>> settings = {'Simon': {'Ear_left_1': 1.1, 'Ear_right_1': 5.1, 'Nose_1': 2.1, 'Center_1': 1.5, 'Lat_left_1': 3.1, 'Lat_right_1': 1.9, 'Tail_base_1': 2.3, 'Tail_end_1': 1.4}, 'JJ': {'Ear_left_2': 1.2, 'Ear_right_2': 1.2, 'Nose_2': 2, 'Center_2': 4.1, 'Lat_left_2': 9, 'Lat_right_2': 1.2, 'Tail_base_2': 1.6, 'Tail_end_2': 2.2}}
+    >>> outlier_corrector = OutlierCorrecterMovementAdvanced(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini', input_dir='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/csv/input_csv', type='body-part', agg_method='mean', criterion_body_parts=criterion_body_parts, settings=settings)
     """
 
     def __init__(
         self,
-        config_path: str,
-        data_folder: str,
-        id_lst: list,
-        interpolation_settings: str,
-        smoothing_settings: dict,
+        config_path: Union[str, os.PathLike],
+        input_dir: Union[str, os.PathLike],
+        criterion_body_parts: dict,
+        type: Literal["animal", "body-part"],
+        agg_method: Literal["mean", "median"],
+        settings: dict,
     ):
-        ConfigReader.__init__(self, config_path=config_path, read_video_info=False)
-        PoseImporterMixin.__init__(self)
+        ConfigReader.__init__(self, config_path=config_path)
+        FeatureExtractionMixin.__init__(self)
         log_event(
-            logger_name=str(__class__.__name__),
+            logger_name=str(self.__class__.__name__),
             log_type=TagNames.CLASS_INIT.value,
             msg=self.create_log_msg_from_init_args(locals=locals()),
         )
-        self.interpolation_settings, self.smoothing_settings = (
-            interpolation_settings,
-            smoothing_settings,
-        )
-        self.data_folder, self.id_lst = data_folder, id_lst
-        self.import_log_path = os.path.join(
-            self.logs_path, f"data_import_log_{self.datetime}.csv"
-        )
-        self.video_paths = find_all_videos_in_project(videos_dir=self.video_dir)
-        self.input_data_paths = self.find_data_files(
-            dir=self.data_folder, extensions=[".h5"]
-        )
-        if self.pose_setting is Methods.USER_DEFINED.value:
-            self.__update_config_animal_cnt()
-        if self.animal_cnt > 1:
-            self.data_and_videos_lk = self.link_video_paths_to_data_paths(
-                data_paths=self.input_data_paths,
-                video_paths=self.video_paths,
-                filename_cleaning_func=clean_sleap_file_name,
+        if type not in ["animal", "body-parts"]:
+            raise InvalidInputError(
+                msg=f"Type {type} not supported. Valid options: {['animal', 'body-parts']}"
             )
-            self.check_multi_animal_status()
-            self.animal_bp_dict = self.create_body_part_dictionary(
-                self.multi_animal_status,
-                self.id_lst,
-                self.animal_cnt,
-                self.x_cols,
-                self.y_cols,
-                self.p_cols,
-                self.clr_lst,
+        if agg_method not in ["mean", "median"]:
+            raise InvalidInputError(
+                msg=f"Aggregation method {agg_method} not supported. Valid options: {['mean', 'median']}"
             )
-            self.update_bp_headers_file()
-        else:
-            self.data_and_videos_lk = dict(
-                [
-                    (get_fn_ext(file_path)[1], {"DATA": file_path, "VIDEO": None})
-                    for file_path in self.input_data_paths
-                ]
+        self.data_files = find_files_of_filetypes_in_directory(
+            directory=input_dir, extensions=["." + self.file_type]
+        )
+        if len(self.data_files) == 0:
+            raise NoFilesFoundError(
+                msg=f"No data of filetype {input_dir} for in directory {self.file_type}",
+                source=self.__class__.__name__,
             )
-        log_event(
-            logger_name=str(self.__class__.__name__),
-            log_type="info",
-            msg=f"Importing data files: {self.input_data_paths}. Interpolation: {interpolation_settings}, Smoothing: {smoothing_settings}",
+        self.settings, self.type, self.agg_method = settings, type, agg_method
+        self.save_path, self.criterion_body_parts = (
+            self.outlier_corrected_movement_dir,
+            criterion_body_parts,
         )
-        print(f"Importing {len(list(self.data_and_videos_lk.keys()))} file(s)...")
 
-    def run(self):
-        for file_cnt, (video_name, video_data) in enumerate(
-            self.data_and_videos_lk.items()
-        ):
-            self.output_filename = clean_sleap_file_name(filename=video_name)
-            print(f"Importing {self.output_filename}...")
-            video_timer = SimbaTimer(start=True)
-            self.video_name = self.output_filename
-            with h5py.File(video_data["DATA"], "r") as f:
-                missing_keys = [
-                    x
-                    for x in ["tracks", "point_scores", "node_names", "track_names"]
-                    if not x in list(f.keys())
-                ]
-                if missing_keys:
-                    stdout_warning(
-                        msg=f'{video_data["DATA"]} is not a valid SLEAP H5 file. Missing keys {missing_keys} Skipping {self.output_filename}...'
-                    )
-                    continue
-                tracks = f["tracks"][:].T
-                point_scores = f["point_scores"][:].T
-
-            csv_rows = []
-            n_frames, n_nodes, _, n_tracks = tracks.shape
-            for frame_ind in range(n_frames):
-                csv_row = []
-                for track_ind in range(n_tracks):
-                    for node_ind in range(n_nodes):
-                        for xyp in range(3):
-                            if xyp == 0 or xyp == 1:
-                                data = tracks[frame_ind, node_ind, xyp, track_ind]
-                            else:
-                                data = point_scores[frame_ind, node_ind, track_ind]
-
-                            csv_row.append(f"{data:.3f}")
-                csv_rows.append(" ".join(csv_row))
-            csv_rows = "\n".join(csv_rows)
-            self.data_df = pd.read_csv(
-                io.StringIO(csv_rows), delim_whitespace=True, header=None
-            ).fillna(0)
-            if len(self.data_df.columns) != len(self.bp_headers):
-                raise BodypartColumnNotFoundError(
-                    msg=f'The number of body-parts in data file {video_data["DATA"]} do not match the number of body-parts in your SimBA project. '
-                    f"The number of of body-parts expected by your SimBA project is {int(len(self.bp_headers) / 3)}. "
-                    f'The number of of body-parts contained in data file {video_data["DATA"]} is {int(len(self.data_df.columns) / 3)}. '
-                    f"Make sure you have specified the correct number of animals and body-parts in your project.",
-                    source=self.__class__.__name__,
-                )
-            self.data_df.columns = self.bp_headers
-            if self.animal_cnt > 1:
-                self.initialize_multi_animal_ui(
-                    animal_bp_dict=self.animal_bp_dict,
-                    video_info=get_video_meta_data(video_data["VIDEO"]),
-                    data_df=self.data_df,
-                    video_path=video_data["VIDEO"],
-                )
-                self.multianimal_identification()
-
-            else:
-                self.out_df = self.insert_multi_idx_columns(df=self.data_df.fillna(0))
+    def fix_settings_for_animal_input(self):
+        new_settings = {}
+        for animal_name, animal_bps in self.animal_bp_dict.items():
+            if animal_name in self.settings.keys():
+                if animal_name not in new_settings.keys():
+                    new_settings[animal_name] = {}
+                for body_part in animal_bps["X_bps"]:
+                    new_settings[animal_name][body_part[:-2]] = self.settings[
+                        animal_name
+                    ]
+        self.settings = new_settings
+
+    def _save_data_log(self, data_log: dict):
+        out = pd.DataFrame(
+            columns=[
+                "VIDEO",
+                "ANIMAL",
+                "BODY-PART",
+                "OUTLIER COUNT",
+                "OUTLIER RATIO (%)",
+            ]
+        )
+        save_path = os.path.join(
+            self.logs_path, f"movement_outliers_{self.datetime}.csv"
+        )
+        for video_name, video_data in data_log.items():
+            for animal_name, animal_data in video_data.items():
+                for body_part_name, body_part_data in animal_data.items():
+                    out.loc[len(out)] = [
+                        video_name,
+                        animal_name,
+                        body_part_name,
+                        body_part_data["outlier_cnt"],
+                        body_part_data["outlier_ratio"],
+                    ]
+        write_df(df=out, file_type="csv", save_path=save_path)
+        stdout_success(
+            msg=f"Movement outlier log saved at {save_path}",
+            source=self.__class__.__name__,
+        )
 
-            self.save_path = os.path.join(
-                os.path.join(
-                    self.input_csv_dir, f"{self.output_filename}.{self.file_type}"
+    def run(self):
+        data_log = {}
+        if self.type == "animal":
+            self.fix_settings_for_animal_input()
+        for file_cnt, file_path in enumerate(self.data_files):
+            video_timer, video_log = SimbaTimer(start=True), {}
+            _, self.video_name, _ = get_fn_ext(file_path)
+            print(
+                "Processing video {}. Video {}/{}...".format(
+                    self.video_name, str(file_cnt + 1), str(len(self.data_files))
                 )
             )
-            write_df(
-                df=self.out_df,
-                file_type=self.file_type,
-                save_path=self.save_path,
-                multi_idx_header=True,
+            self.data_df = read_df(file_path, self.file_type, check_multiindex=True)
+            self.data_df = self.insert_column_headers_for_outlier_correction(
+                data_df=self.data_df, new_headers=self.bp_headers, filepath=file_path
+            )
+            self.results = deepcopy(self.data_df)
+            self.data_df_combined = self.create_shifted_df(df=self.data_df)
+            animal_movement_agg = {}
+            self.movements = pd.DataFrame()
+            for animal_name, animal_bps in self.animal_bp_dict.items():
+                if animal_name in self.criterion_body_parts.keys():
+                    animal_bp_headers = np.array(
+                        [
+                            item
+                            for pair in zip(animal_bps["X_bps"], animal_bps["Y_bps"])
+                            for item in pair
+                        ]
+                    ).reshape(len(animal_bps["X_bps"]), 2)
+                    animal_criterion_bps = self.criterion_body_parts[animal_name]
+                    bp_1_headers = [
+                        animal_criterion_bps[0] + "_x",
+                        animal_criterion_bps[0] + "_y",
+                    ]
+                    bp_2_headers = [
+                        animal_criterion_bps[1] + "_x",
+                        animal_criterion_bps[1] + "_y",
+                    ]
+                    print(self.data_df.columns)
+                    distances = self.framewise_euclidean_distance(
+                        location_1=self.data_df[bp_1_headers].values,
+                        location_2=self.data_df[bp_2_headers].values,
+                        px_per_mm=1,
+                    )
+                    if self.agg_method == "mean":
+                        animal_movement_agg[animal_name] = np.mean(distances).astype(
+                            int
+                        )
+                    if self.agg_method == "median":
+                        animal_movement_agg[animal_name] = np.median(distances).astype(
+                            int
+                        )
+                    for bps in animal_bp_headers:
+                        bp_name = bps[0][:-2]
+                        shifted_bps = [bps[0] + "_shifted", bps[1] + "_shifted"]
+                        distances = self.framewise_euclidean_distance(
+                            location_1=self.data_df_combined[bps].values,
+                            location_2=self.data_df_combined[shifted_bps].values,
+                            px_per_mm=1,
+                        )
+                        self.movements[bp_name] = distances
+
+            for animal_name, animal_bps in self.settings.items():
+                video_log[animal_name] = {}
+                for bp, criterion_multiplier in animal_bps.items():
+                    if animal_name in animal_movement_agg.keys():
+                        bp_criterion = (
+                            animal_movement_agg[animal_name] * criterion_multiplier
+                        )
+                        over_criterion_idx = list(
+                            self.movements.index[self.movements[bp] > bp_criterion]
+                        )
+                        video_log[animal_name][bp] = {
+                            "outlier_cnt": len(over_criterion_idx),
+                            "outlier_ratio": len(over_criterion_idx)
+                            / len(self.movements),
+                        }
+                        self.results.loc[over_criterion_idx, [bp + "_x", bp + "_y"]] = (
+                            np.nan
+                        )
+                        self.results[[bp + "_x", bp + "_y"]] = (
+                            self.results[[bp + "_x", bp + "_y"]]
+                            .ffill()
+                            .bfill()
+                            .astype(int)
+                        )
+
+            df_save_path = os.path.join(
+                self.outlier_corrected_movement_dir,
+                self.video_name + f".{self.file_type}",
             )
-            if self.interpolation_settings != "None":
-                self.__run_interpolation()
-            if self.smoothing_settings["Method"] != "None":
-                self.__run_smoothing()
+            write_df(df=self.results, file_type=self.file_type, save_path=df_save_path)
             video_timer.stop_timer()
             stdout_success(
-                msg=f"Video {self.output_filename} data imported...",
+                msg=f"Movement outliers complete for video {self.video_name}.",
                 elapsed_time=video_timer.elapsed_time_str,
                 source=self.__class__.__name__,
             )
-        self.timer.stop_timer()
+            data_log[self.video_name] = video_log
+        self._save_data_log(data_log=data_log)
         stdout_success(
-            msg="All SLEAP H5 data files imported",
-            elapsed_time=self.timer.elapsed_time_str,
+            msg=f"{len(self.data_files)} video(s) corrected for movement outliers. Saved in {self.outlier_corrected_movement_dir}",
             source=self.__class__.__name__,
         )
 
-    def __run_interpolation(self):
-        print(
-            f"Interpolating missing values in video {self.output_filename} (Method: {self.interpolation_settings})..."
-        )
-        _ = Interpolate(
-            input_path=self.save_path,
-            config_path=self.config_path,
-            method=self.interpolation_settings,
-            initial_import_multi_index=True,
-        )
-
-    def __run_smoothing(self):
-        print(
-            f'Performing {self.smoothing_settings["Method"]} smoothing on video {self.output_filename}...'
-        )
-        Smooth(
-            config_path=self.config_path,
-            input_path=self.save_path,
-            time_window=int(self.smoothing_settings["Parameters"]["Time_window"]),
-            smoothing_method=self.smoothing_settings["Method"],
-            initial_import_multi_index=True,
-        )
-
-
-# test = SLEAPImporterH5(config_path="/Users/simon/Desktop/envs/simba/troubleshooting/sleap_two_animals/project_folder/project_config.ini",
-#                    data_folder=r'/Users/simon/Desktop/envs/simba/troubleshooting/sleap_two_animals/h5_import',
-#                    id_lst=['White', 'Black'],
-#                    interpolation_settings= "Body-parts: Nearest", #'"Body-parts: Nearest",
-#                    smoothing_settings = {'Method': 'None', 'Parameters': {'Time_window': '200'}})
-# test.run()
-
-
-# test = SLEAPImporterH5(config_path="/Users/simon/Desktop/envs/troubleshooting/sleap_import/project_folder/project_config.ini",
-#                    data_folder=r'/Users/simon/Desktop/envs/troubleshooting/sleap_import/data_h5',
-#                    id_lst=['White', 'Black'],
-#                    interpolation_settings= "Body-parts: Nearest", #'"Body-parts: Nearest",
-#                    smoothing_settings = {'Method': 'None', 'Parameters': {'Time_window': '200'}})
-# test.run()
-
-
-# test = SLEAPImporterH5(config_path="/Users/simon/Desktop/envs/troubleshooting/sleap_dropped_frms_2/project_folder/project_config.ini",
-#                    data_folder=r'/Users/simon/Desktop/envs/troubleshooting/sleap_dropped_frms_2/data',
-#                    id_lst=['Simon'],
-#                    interpolation_settings= 'None', #'"Body-parts: Nearest",
-#                    smoothing_settings = {'Method': 'None', 'Parameters': {'Time_window': '200'}})
-# test.run()
-
-# test = SLEAPImporterH5(config_path="/Users/simon/Desktop/envs/troubleshooting/Termites_5/project_folder/project_config.ini",
-#                    data_folder=r'/Users/simon/Desktop/envs/troubleshooting/Termites_5/import_h5',
-#                    id_lst=['Simon', 'Nastacia', 'Ben', 'John', 'JJ'],
-#                    interpolation_settings="Body-parts: Nearest",
-#                    smoothing_settings = {'Method': 'Savitzky Golay', 'Parameters': {'Time_window': '200'}})
-# test.run()
-# print('All SLEAP imports complete.')
-
 
 #
-# test = SLEAPImporterH5(config_path="/Users/simon/Desktop/envs/troubleshooting/sleap_dropped_frms/project_folder/project_config.ini",
-#                    data_folder=r'/Users/simon/Desktop/envs/troubleshooting/sleap_dropped_frms/data',
-#                    id_lst=['Simon'],
-#                    interpolation_settings= 'None', #'"Body-parts: Nearest",
-#                    smoothing_settings = {'Method': 'None', 'Parameters': {'Time_window': '200'}})
-# test.run()
-
-
-# test = SLEAPImporterH5(config_path="/Users/simon/Desktop/envs/troubleshooting/SLEAP_2_Animals_16_body_parts/project_folder/project_config.ini",
-#                    data_folder=r'/Users/simon/Desktop/envs/troubleshooting/SLEAP_2_Animals_16_body_parts/data/h5',
-#                    id_lst=['Simon', 'Nastacia'],
-#                    interpolation_settings="Body-parts: Nearest",
-#                    smoothing_settings = {'Method': 'Savitzky Golay', 'Parameters': {'Time_window': '200'}})
+# settings = {'Simon': 2.5} #'JJ': 1.2
+# # settings = {'Simon': {'Ear_left_1': 1.1,
+# #                       'Ear_right_1': 5.1,
+# #                       'Nose_1': 2.1,
+# #                       'Center_1': 1.5,
+# #                       'Lat_left_1': 3.1,
+# #                       'Lat_right_1': 1.9,
+# #                       'Tail_base_1': 2.3},
+# #                       #'Tail_end_1': 1.4},
+# #                'JJ': {'Ear_left_2': 1.2,
+# #                       'Ear_right_2': 1.2,
+# #                       'Nose_2': 2,
+# #                       'Center_2': 4.1,
+# #                       'Lat_left_2': 9,
+# #                       'Lat_right_2': 1.2,
+# #                       'Tail_base_2': 1.6,
+# #                       'Tail_end_2': 2.2}}
+# criterion_body_parts = {'Simon': ['Nose_1', 'Tail_base_1']} #'JJ': ['Nose_2', 'Tail_base_2']
+#
+#
+# test = OutlierCorrecterMovementAdvanced(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini',
+#                                         input_dir='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/csv/input_csv',
+#                                         criterion_body_parts=criterion_body_parts,
+#                                         type='animal',
+#                                         agg_method='mean',
+#                                         settings=settings)
 # test.run()
-# print('All SLEAP imports complete.')
-
 
-# test = SLEAPImporterH5(config_path="/Users/simon/Desktop/envs/troubleshooting/Termites_5/project_folder/project_config.ini",
-#                    data_folder=r'/Users/simon/Desktop/envs/troubleshooting/Termites_5/import_h5',
-#                    id_lst=['Simon', 'Nastacia', 'Ben', 'John', 'JJ'],
-#                    interpolation_settings='None',
-#                    smoothing_settings = {'Method': 'None'})
-# test.run()
-# print('All SLEAP imports complete.')
 #
-# test = SLEAPImporterH5(config_path="/Users/simon/Desktop/envs/troubleshooting/sleap_cody/project_folder/project_config.ini",
-#                    data_folder=r'/Users/simon/Desktop/envs/troubleshooting/sleap_cody/import_h5',
-#                    actor_IDs=['Nastacia', 'Sam'],
-#                    interpolation_settings="Body-parts: Nearest",
-#                    smoothing_settings = {'Method': 'Savitzky Golay', 'Parameters': {'Time_window': '200'}})
-# test.import_sleap()
-# print('All SLEAP imports complete.')
-
-
-# test = SLEAPImporterH5(config_path="/Users/simon/Desktop/envs/troubleshooting/sleap_cody/project_folder/project_config.ini",
-#                    data_folder=r'/Users/simon/Desktop/envs/troubleshooting/sleap_cody/import_h5',
-#                    actor_IDs=['Nastacia'],
-#                    interpolation_settings="Body-parts: Nearest",
-#                    smoothing_settings = {'Method': 'Savitzky Golay', 'Parameters': {'Time_window': '200'}})
-# test.import_sleap()
-# # print('All SLEAP imports complete.')
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/pose_importers/madlc_importer.py` & `Simba-UW-tf-dev-1.89.5/simba/pose_importers/madlc_importer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/pose_importers/sleap_slp_importer.py` & `Simba-UW-tf-dev-1.89.5/simba/pose_importers/sleap_slp_importer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/pose_importers/import_mars.py` & `Simba-UW-tf-dev-1.89.5/simba/pose_importers/import_mars.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/pose_importers/dlc_importer_csv.py` & `Simba-UW-tf-dev-1.89.5/simba/pose_importers/dlc_importer_csv.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/pose_importers/trk_importer.py` & `Simba-UW-tf-dev-1.89.5/simba/pose_importers/trk_importer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/pose_configurations/.DS_Store` & `Simba-UW-tf-dev-1.89.5/simba/pose_configurations/.DS_Store`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/pose_configurations/bp_names/bp_names.csv` & `Simba-UW-tf-dev-1.89.5/simba/pose_configurations/bp_names/bp_names.csv`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/pose_configurations/schematics/8.png` & `Simba-UW-tf-dev-1.89.5/simba/pose_configurations/schematics/8.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/pose_configurations/schematics/9.png` & `Simba-UW-tf-dev-1.89.5/simba/pose_configurations/schematics/9.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/pose_configurations/schematics/12.png` & `Simba-UW-tf-dev-1.89.5/simba/pose_configurations/schematics/12.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/pose_configurations/schematics/13.png` & `Simba-UW-tf-dev-1.89.5/simba/pose_configurations/schematics/13.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/pose_configurations/schematics/11.png` & `Simba-UW-tf-dev-1.89.5/simba/pose_configurations/schematics/11.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/pose_configurations/schematics/10.png` & `Simba-UW-tf-dev-1.89.5/simba/pose_configurations/schematics/10.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/pose_configurations/schematics/4.png` & `Simba-UW-tf-dev-1.89.5/simba/pose_configurations/schematics/4.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/pose_configurations/schematics/5.png` & `Simba-UW-tf-dev-1.89.5/simba/pose_configurations/schematics/5.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/pose_configurations/schematics/7.png` & `Simba-UW-tf-dev-1.89.5/simba/pose_configurations/schematics/7.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/pose_configurations/schematics/6.png` & `Simba-UW-tf-dev-1.89.5/simba/pose_configurations/schematics/6.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/pose_configurations/schematics/2.png` & `Simba-UW-tf-dev-1.89.5/simba/pose_configurations/schematics/2.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/pose_configurations/schematics/3.png` & `Simba-UW-tf-dev-1.89.5/simba/pose_configurations/schematics/3.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/pose_configurations/schematics/1.png` & `Simba-UW-tf-dev-1.89.5/simba/pose_configurations/schematics/1.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/video_processors/video_processing.py` & `Simba-UW-tf-dev-1.89.5/simba/video_processors/video_processing.py`

 * *Files 16% similar despite different names*

```diff
@@ -9,5118 +9,7066 @@
 00000080: 7274 2074 696d 650a 6672 6f6d 2064 6174  rt time.from dat
 00000090: 6574 696d 6520 696d 706f 7274 2064 6174  etime import dat
 000000a0: 6574 696d 650a 6672 6f6d 2070 6174 686c  etime.from pathl
 000000b0: 6962 2069 6d70 6f72 7420 5061 7468 0a66  ib import Path.f
 000000c0: 726f 6d20 746b 696e 7465 7220 696d 706f  rom tkinter impo
 000000d0: 7274 202a 0a66 726f 6d20 7479 7069 6e67  rt *.from typing
 000000e0: 2069 6d70 6f72 7420 4c69 7374 2c20 4f70   import List, Op
-000000f0: 7469 6f6e 616c 2c20 556e 696f 6e0a 0a69  tional, Union..i
-00000100: 6d70 6f72 7420 6376 320a 696d 706f 7274  mport cv2.import
-00000110: 206e 756d 7079 2061 7320 6e70 0a66 726f   numpy as np.fro
-00000120: 6d20 5049 4c20 696d 706f 7274 2049 6d61  m PIL import Ima
-00000130: 6765 2c20 496d 6167 6554 6b0a 6672 6f6d  ge, ImageTk.from
-00000140: 2073 6861 7065 6c79 2e67 656f 6d65 7472   shapely.geometr
-00000150: 7920 696d 706f 7274 2050 6f6c 7967 6f6e  y import Polygon
-00000160: 0a0a 7472 793a 0a20 2020 2066 726f 6d20  ..try:.    from 
-00000170: 7479 7069 6e67 2069 6d70 6f72 7420 4c69  typing import Li
-00000180: 7465 7261 6c0a 6578 6365 7074 3a0a 2020  teral.except:.  
-00000190: 2020 6672 6f6d 2074 7970 696e 675f 6578    from typing_ex
-000001a0: 7465 6e73 696f 6e73 2069 6d70 6f72 7420  tensions import 
-000001b0: 4c69 7465 7261 6c0a 0a69 6d70 6f72 7420  Literal..import 
-000001c0: 7369 6d62 610a 6672 6f6d 2073 696d 6261  simba.from simba
-000001d0: 2e6d 6978 696e 732e 636f 6e66 6967 5f72  .mixins.config_r
-000001e0: 6561 6465 7220 696d 706f 7274 2043 6f6e  eader import Con
-000001f0: 6669 6752 6561 6465 720a 6672 6f6d 2073  figReader.from s
-00000200: 696d 6261 2e6d 6978 696e 732e 696d 6167  imba.mixins.imag
-00000210: 655f 6d69 7869 6e20 696d 706f 7274 2049  e_mixin import I
-00000220: 6d61 6765 4d69 7869 6e0a 6672 6f6d 2073  mageMixin.from s
-00000230: 696d 6261 2e75 7469 6c73 2e63 6865 636b  imba.utils.check
-00000240: 7320 696d 706f 7274 2028 6368 6563 6b5f  s import (check_
-00000250: 6666 6d70 6567 5f61 7661 696c 6162 6c65  ffmpeg_available
-00000260: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000000f0: 7469 6f6e 616c 2c20 5475 706c 652c 2055  tional, Tuple, U
+00000100: 6e69 6f6e 0a0a 696d 706f 7274 2063 7632  nion..import cv2
+00000110: 0a69 6d70 6f72 7420 6e75 6d70 7920 6173  .import numpy as
+00000120: 206e 700a 6672 6f6d 2050 494c 2069 6d70   np.from PIL imp
+00000130: 6f72 7420 496d 6167 652c 2049 6d61 6765  ort Image, Image
+00000140: 546b 0a66 726f 6d20 7368 6170 656c 792e  Tk.from shapely.
+00000150: 6765 6f6d 6574 7279 2069 6d70 6f72 7420  geometry import 
+00000160: 506f 6c79 676f 6e0a 0a74 7279 3a0a 2020  Polygon..try:.  
+00000170: 2020 6672 6f6d 2074 7970 696e 6720 696d    from typing im
+00000180: 706f 7274 204c 6974 6572 616c 0a65 7863  port Literal.exc
+00000190: 6570 743a 0a20 2020 2066 726f 6d20 7479  ept:.    from ty
+000001a0: 7069 6e67 5f65 7874 656e 7369 6f6e 7320  ping_extensions 
+000001b0: 696d 706f 7274 204c 6974 6572 616c 0a0a  import Literal..
+000001c0: 696d 706f 7274 2073 696d 6261 0a66 726f  import simba.fro
+000001d0: 6d20 7369 6d62 612e 6d69 7869 6e73 2e63  m simba.mixins.c
+000001e0: 6f6e 6669 675f 7265 6164 6572 2069 6d70  onfig_reader imp
+000001f0: 6f72 7420 436f 6e66 6967 5265 6164 6572  ort ConfigReader
+00000200: 0a66 726f 6d20 7369 6d62 612e 6d69 7869  .from simba.mixi
+00000210: 6e73 2e69 6d61 6765 5f6d 6978 696e 2069  ns.image_mixin i
+00000220: 6d70 6f72 7420 496d 6167 654d 6978 696e  mport ImageMixin
+00000230: 0a66 726f 6d20 7369 6d62 612e 7574 696c  .from simba.util
+00000240: 732e 6368 6563 6b73 2069 6d70 6f72 7420  s.checks import 
+00000250: 2863 6865 636b 5f66 666d 7065 675f 6176  (check_ffmpeg_av
+00000260: 6169 6c61 626c 652c 0a20 2020 2020 2020  ailable,.       
 00000270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000280: 2020 6368 6563 6b5f 6669 6c65 5f65 7869    check_file_exi
-00000290: 7374 5f61 6e64 5f72 6561 6461 626c 652c  st_and_readable,
-000002a0: 2063 6865 636b 5f66 6c6f 6174 2c0a 2020   check_float,.  
-000002b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000002c0: 2020 2020 2020 2020 2020 2020 2020 6368                ch
-000002d0: 6563 6b5f 6966 5f64 6972 5f65 7869 7374  eck_if_dir_exist
-000002e0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+00000280: 2020 2020 2020 2020 2063 6865 636b 5f66           check_f
+00000290: 696c 655f 6578 6973 745f 616e 645f 7265  ile_exist_and_re
+000002a0: 6164 6162 6c65 2c20 6368 6563 6b5f 666c  adable, check_fl
+000002b0: 6f61 742c 0a20 2020 2020 2020 2020 2020  oat,.           
+000002c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000002d0: 2020 2020 2063 6865 636b 5f69 665f 6469       check_if_di
+000002e0: 725f 6578 6973 7473 2c0a 2020 2020 2020  r_exists,.      
 000002f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000300: 2020 2063 6865 636b 5f69 665f 6669 6c65     check_if_file
-00000310: 7061 7468 5f6c 6973 745f 6973 5f65 6d70  path_list_is_emp
-00000320: 7479 2c0a 2020 2020 2020 2020 2020 2020  ty,.            
+00000300: 2020 2020 2020 2020 2020 6368 6563 6b5f            check_
+00000310: 6966 5f66 696c 6570 6174 685f 6c69 7374  if_filepath_list
+00000320: 5f69 735f 656d 7074 792c 0a20 2020 2020  _is_empty,.     
 00000330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000340: 2020 2020 6368 6563 6b5f 6966 5f73 7472      check_if_str
-00000350: 696e 675f 7661 6c75 655f 6973 5f76 616c  ing_value_is_val
-00000360: 6964 5f76 6964 656f 5f74 696d 6573 7461  id_video_timesta
-00000370: 6d70 2c0a 2020 2020 2020 2020 2020 2020  mp,.            
+00000340: 2020 2020 2020 2020 2020 2063 6865 636b             check
+00000350: 5f69 665f 7374 7269 6e67 5f76 616c 7565  _if_string_value
+00000360: 5f69 735f 7661 6c69 645f 7669 6465 6f5f  _is_valid_video_
+00000370: 7469 6d65 7374 616d 702c 0a20 2020 2020  timestamp,.     
 00000380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000390: 2020 2020 6368 6563 6b5f 696e 742c 2063      check_int, c
-000003a0: 6865 636b 5f6e 7669 6465 615f 6770 755f  heck_nvidea_gpu_
-000003b0: 6176 6169 6c61 626c 652c 0a20 2020 2020  available,.     
-000003c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000003d0: 2020 2020 2020 2020 2020 2063 6865 636b             check
-000003e0: 5f74 6861 745f 6868 6d6d 7373 5f73 7461  _that_hhmmss_sta
-000003f0: 7274 5f69 735f 6265 666f 7265 5f65 6e64  rt_is_before_end
-00000400: 290a 6672 6f6d 2073 696d 6261 2e75 7469  ).from simba.uti
-00000410: 6c73 2e65 6e75 6d73 2069 6d70 6f72 7420  ls.enums import 
-00000420: 4f53 2c20 436f 6e66 6967 4b65 792c 2046  OS, ConfigKey, F
-00000430: 6f72 6d61 7473 2c20 4f70 7469 6f6e 732c  ormats, Options,
-00000440: 2050 6174 6873 0a66 726f 6d20 7369 6d62   Paths.from simb
-00000450: 612e 7574 696c 732e 6572 726f 7273 2069  a.utils.errors i
-00000460: 6d70 6f72 7420 2843 6f75 6e74 4572 726f  mport (CountErro
-00000470: 722c 2044 6972 6563 746f 7279 4578 6973  r, DirectoryExis
-00000480: 7445 7272 6f72 2c0a 2020 2020 2020 2020  tError,.        
-00000490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000004a0: 2020 2020 2020 2020 4646 4d50 4547 436f          FFMPEGCo
-000004b0: 6465 6347 5055 4572 726f 722c 2046 464d  decGPUError, FFM
-000004c0: 5045 474e 6f74 466f 756e 6445 7272 6f72  PEGNotFoundError
-000004d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00000390: 2020 2020 2020 2020 2020 2063 6865 636b             check
+000003a0: 5f69 6e74 2c20 6368 6563 6b5f 6e76 6964  _int, check_nvid
+000003b0: 6561 5f67 7075 5f61 7661 696c 6162 6c65  ea_gpu_available
+000003c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000003d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000003e0: 2020 6368 6563 6b5f 7468 6174 5f68 686d    check_that_hhm
+000003f0: 6d73 735f 7374 6172 745f 6973 5f62 6566  mss_start_is_bef
+00000400: 6f72 655f 656e 642c 0a20 2020 2020 2020  ore_end,.       
+00000410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000420: 2020 2020 2020 2020 2063 6865 636b 5f76           check_v
+00000430: 616c 6964 5f6c 7374 2c20 6368 6563 6b5f  alid_lst, check_
+00000440: 7661 6c69 645f 7475 706c 6529 0a66 726f  valid_tuple).fro
+00000450: 6d20 7369 6d62 612e 7574 696c 732e 656e  m simba.utils.en
+00000460: 756d 7320 696d 706f 7274 204f 532c 2043  ums import OS, C
+00000470: 6f6e 6669 674b 6579 2c20 466f 726d 6174  onfigKey, Format
+00000480: 732c 204f 7074 696f 6e73 2c20 5061 7468  s, Options, Path
+00000490: 730a 6672 6f6d 2073 696d 6261 2e75 7469  s.from simba.uti
+000004a0: 6c73 2e65 7272 6f72 7320 696d 706f 7274  ls.errors import
+000004b0: 2028 436f 756e 7445 7272 6f72 2c20 4469   (CountError, Di
+000004c0: 7265 6374 6f72 7945 7869 7374 4572 726f  rectoryExistErro
+000004d0: 722c 0a20 2020 2020 2020 2020 2020 2020  r,.             
 000004e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000004f0: 2020 4669 6c65 4578 6973 7445 7272 6f72    FileExistError
-00000500: 2c20 496e 7661 6c69 6446 696c 6554 7970  , InvalidFileTyp
-00000510: 6545 7272 6f72 2c0a 2020 2020 2020 2020  eError,.        
+000004f0: 2020 2046 464d 5045 4743 6f64 6563 4750     FFMPEGCodecGP
+00000500: 5545 7272 6f72 2c20 4646 4d50 4547 4e6f  UError, FFMPEGNo
+00000510: 7446 6f75 6e64 4572 726f 722c 0a20 2020  tFoundError,.   
 00000520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000530: 2020 2020 2020 2020 496e 7661 6c69 6449          InvalidI
-00000540: 6e70 7574 4572 726f 722c 204e 6f44 6174  nputError, NoDat
-00000550: 6145 7272 6f72 2c0a 2020 2020 2020 2020  aError,.        
+00000530: 2020 2020 2020 2020 2020 2020 2046 696c               Fil
+00000540: 6545 7869 7374 4572 726f 722c 2046 7261  eExistError, Fra
+00000550: 6d65 5261 6e67 6545 7272 6f72 2c0a 2020  meRangeError,.  
 00000560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000570: 2020 2020 2020 2020 4e6f 4669 6c65 7346          NoFilesF
-00000580: 6f75 6e64 4572 726f 722c 204e 6f74 4469  oundError, NotDi
-00000590: 7265 6374 6f72 7945 7272 6f72 290a 6672  rectoryError).fr
-000005a0: 6f6d 2073 696d 6261 2e75 7469 6c73 2e70  om simba.utils.p
-000005b0: 7269 6e74 696e 6720 696d 706f 7274 2053  rinting import S
-000005c0: 696d 6261 5469 6d65 722c 2073 7464 6f75  imbaTimer, stdou
-000005d0: 745f 7375 6363 6573 730a 6672 6f6d 2073  t_success.from s
-000005e0: 696d 6261 2e75 7469 6c73 2e72 6561 645f  imba.utils.read_
-000005f0: 7772 6974 6520 696d 706f 7274 2028 0a20  write import (. 
-00000600: 2020 2063 6865 636b 5f69 665f 6868 6d6d     check_if_hhmm
-00000610: 7373 5f74 696d 6573 7461 6d70 5f69 735f  ss_timestamp_is_
-00000620: 7661 6c69 645f 7061 7274 5f6f 665f 7669  valid_part_of_vi
-00000630: 6465 6f2c 0a20 2020 2066 696e 645f 616c  deo,.    find_al
-00000640: 6c5f 7669 6465 6f73 5f69 6e5f 6469 7265  l_videos_in_dire
-00000650: 6374 6f72 792c 2066 696e 645f 636f 7265  ctory, find_core
-00000660: 5f63 6e74 2c20 6765 745f 666e 5f65 7874  _cnt, get_fn_ext
-00000670: 2c0a 2020 2020 6765 745f 7669 6465 6f5f  ,.    get_video_
-00000680: 6d65 7461 5f64 6174 612c 2072 6561 645f  meta_data, read_
-00000690: 636f 6e66 6967 5f65 6e74 7279 2c20 7265  config_entry, re
-000006a0: 6164 5f63 6f6e 6669 675f 6669 6c65 290a  ad_config_file).
-000006b0: 6672 6f6d 2073 696d 6261 2e75 7469 6c73  from simba.utils
-000006c0: 2e77 6172 6e69 6e67 7320 696d 706f 7274  .warnings import
-000006d0: 2028 4669 6c65 4578 6973 7457 6172 6e69   (FileExistWarni
-000006e0: 6e67 2c20 496e 5661 6c69 6455 7365 7249  ng, InValidUserI
-000006f0: 6e70 7574 5761 726e 696e 672c 0a20 2020  nputWarning,.   
-00000700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000710: 2020 2020 2020 2020 2020 2020 2020 2053                 S
-00000720: 616d 6549 6e70 7574 416e 644f 7574 7075  ameInputAndOutpu
-00000730: 7457 6172 6e69 6e67 290a 6672 6f6d 2073  tWarning).from s
-00000740: 696d 6261 2e76 6964 656f 5f70 726f 6365  imba.video_proce
-00000750: 7373 6f72 732e 6578 7472 6163 745f 6672  ssors.extract_fr
-00000760: 616d 6573 2069 6d70 6f72 7420 7669 6465  ames import vide
-00000770: 6f5f 746f 5f66 7261 6d65 730a 6672 6f6d  o_to_frames.from
-00000780: 2073 696d 6261 2e76 6964 656f 5f70 726f   simba.video_pro
-00000790: 6365 7373 6f72 732e 726f 695f 7365 6c65  cessors.roi_sele
-000007a0: 6374 6f72 2069 6d70 6f72 7420 524f 4953  ctor import ROIS
-000007b0: 656c 6563 746f 720a 6672 6f6d 2073 696d  elector.from sim
-000007c0: 6261 2e76 6964 656f 5f70 726f 6365 7373  ba.video_process
-000007d0: 6f72 732e 726f 695f 7365 6c65 6374 6f72  ors.roi_selector
-000007e0: 5f63 6972 636c 6520 696d 706f 7274 2052  _circle import R
-000007f0: 4f49 5365 6c65 6374 6f72 4369 7263 6c65  OISelectorCircle
-00000800: 0a66 726f 6d20 7369 6d62 612e 7669 6465  .from simba.vide
-00000810: 6f5f 7072 6f63 6573 736f 7273 2e72 6f69  o_processors.roi
-00000820: 5f73 656c 6563 746f 725f 706f 6c79 676f  _selector_polygo
-00000830: 6e20 696d 706f 7274 2052 4f49 5365 6c65  n import ROISele
-00000840: 6374 6f72 506f 6c79 676f 6e0a 0a4d 4158  ctorPolygon..MAX
-00000850: 5f46 524d 5f53 495a 4520 3d20 3130 3830  _FRM_SIZE = 1080
-00000860: 2c20 3635 300a 0a0a 6465 6620 6368 616e  , 650...def chan
-00000870: 6765 5f69 6d67 5f66 6f72 6d61 7428 0a20  ge_img_format(. 
-00000880: 2020 2064 6972 6563 746f 7279 3a20 556e     directory: Un
-00000890: 696f 6e5b 7374 722c 206f 732e 5061 7468  ion[str, os.Path
-000008a0: 4c69 6b65 5d2c 2066 696c 655f 7479 7065  Like], file_type
-000008b0: 5f69 6e3a 2073 7472 2c20 6669 6c65 5f74  _in: str, file_t
-000008c0: 7970 655f 6f75 743a 2073 7472 0a29 202d  ype_out: str.) -
-000008d0: 3e20 4e6f 6e65 3a0a 2020 2020 2222 220a  > None:.    """.
-000008e0: 2020 2020 436f 6e76 6572 7420 7468 6520      Convert the 
-000008f0: 6669 6c65 2074 7970 6520 6f66 2061 6c6c  file type of all
-00000900: 2069 6d61 6765 2066 696c 6573 2077 6974   image files wit
-00000910: 6869 6e20 6120 6469 7265 6374 6f72 792e  hin a directory.
-00000920: 0a0a 2020 2020 3a70 6172 616d 6574 6572  ..    :parameter
-00000930: 2055 6e69 6f6e 5b73 7472 2c20 6f73 2e50   Union[str, os.P
-00000940: 6174 684c 696b 655d 2064 6972 6563 746f  athLike] directo
-00000950: 7279 3a20 5061 7468 2074 6f20 6469 7265  ry: Path to dire
-00000960: 6374 6f72 7920 686f 6c64 696e 6720 696d  ctory holding im
-00000970: 6167 6520 6669 6c65 730a 2020 2020 3a70  age files.    :p
-00000980: 6172 616d 6574 6572 2073 7472 2066 696c  arameter str fil
-00000990: 655f 7479 7065 5f69 6e3a 2049 6e70 7574  e_type_in: Input
-000009a0: 2066 696c 6520 7479 7065 2c20 652e 672e   file type, e.g.
-000009b0: 2c20 2762 6d70 2720 6f72 2027 706e 672e  , 'bmp' or 'png.
-000009c0: 0a20 2020 203a 7061 7261 6d65 7465 7220  .    :parameter 
-000009d0: 7374 7220 6669 6c65 5f74 7970 655f 6f75  str file_type_ou
-000009e0: 743a 204f 7574 7075 7420 6669 6c65 2074  t: Output file t
-000009f0: 7970 652c 2065 2e67 2e2c 2027 626d 7027  ype, e.g., 'bmp'
-00000a00: 206f 7220 2770 6e67 2e0a 0a20 2020 203a   or 'png...    :
-00000a10: 6578 616d 706c 653a 0a20 2020 203e 3e3e  example:.    >>>
-00000a20: 205f 203d 2063 6861 6e67 655f 696d 675f   _ = change_img_
-00000a30: 666f 726d 6174 2864 6972 6563 746f 7279  format(directory
-00000a40: 3d27 4d79 4469 7265 6374 6f72 7957 496d  ='MyDirectoryWIm
-00000a50: 6167 6573 272c 2066 696c 655f 7479 7065  ages', file_type
-00000a60: 5f69 6e3d 2762 6d70 272c 2066 696c 655f  _in='bmp', file_
-00000a70: 7479 7065 5f6f 7574 3d27 706e 6727 290a  type_out='png').
-00000a80: 0a20 2020 2022 2222 0a20 2020 2069 6620  .    """.    if 
-00000a90: 6e6f 7420 6f73 2e70 6174 682e 6973 6469  not os.path.isdi
-00000aa0: 7228 6469 7265 6374 6f72 7929 3a0a 2020  r(directory):.  
-00000ab0: 2020 2020 2020 7261 6973 6520 4e6f 7444        raise NotD
-00000ac0: 6972 6563 746f 7279 4572 726f 7228 0a20  irectoryError(. 
-00000ad0: 2020 2020 2020 2020 2020 2022 5349 4d42             "SIMB
-00000ae0: 4120 4552 524f 523a 207b 7d20 6973 206e  A ERROR: {} is n
-00000af0: 6f74 2061 2076 616c 6964 2064 6972 6563  ot a valid direc
-00000b00: 746f 7279 222e 666f 726d 6174 2864 6972  tory".format(dir
-00000b10: 6563 746f 7279 292c 0a20 2020 2020 2020  ectory),.       
-00000b20: 2020 2020 2073 6f75 7263 653d 6368 616e       source=chan
-00000b30: 6765 5f69 6d67 5f66 6f72 6d61 742e 5f5f  ge_img_format.__
-00000b40: 6e61 6d65 5f5f 2c0a 2020 2020 2020 2020  name__,.        
-00000b50: 290a 2020 2020 6669 6c65 735f 666f 756e  ).    files_foun
-00000b60: 6420 3d20 676c 6f62 2e67 6c6f 6228 6469  d = glob.glob(di
-00000b70: 7265 6374 6f72 7920 2b20 222f 2a2e 7b7d  rectory + "/*.{}
-00000b80: 222e 666f 726d 6174 2866 696c 655f 7479  ".format(file_ty
-00000b90: 7065 5f69 6e29 290a 2020 2020 6966 206c  pe_in)).    if l
-00000ba0: 656e 2866 696c 6573 5f66 6f75 6e64 2920  en(files_found) 
-00000bb0: 3c20 313a 0a20 2020 2020 2020 2072 6169  < 1:.        rai
-00000bc0: 7365 204e 6f46 696c 6573 466f 756e 6445  se NoFilesFoundE
-00000bd0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00000be0: 2020 2253 494d 4241 2045 5252 4f52 3a20    "SIMBA ERROR: 
-00000bf0: 4e6f 207b 7d20 6669 6c65 7320 2877 6974  No {} files (wit
-00000c00: 6820 2e7b 7d20 6669 6c65 2065 6e64 696e  h .{} file endin
-00000c10: 6729 2066 6f75 6e64 2069 6e20 7468 6520  g) found in the 
-00000c20: 7b7d 2064 6972 6563 746f 7279 222e 666f  {} directory".fo
-00000c30: 726d 6174 280a 2020 2020 2020 2020 2020  rmat(.          
-00000c40: 2020 2020 2020 6669 6c65 5f74 7970 655f        file_type_
-00000c50: 696e 2c20 6669 6c65 5f74 7970 655f 696e  in, file_type_in
-00000c60: 2c20 6469 7265 6374 6f72 790a 2020 2020  , directory.    
-00000c70: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
-00000c80: 2020 2020 2020 2073 6f75 7263 653d 6368         source=ch
-00000c90: 616e 6765 5f69 6d67 5f66 6f72 6d61 742e  ange_img_format.
-00000ca0: 5f5f 6e61 6d65 5f5f 2c0a 2020 2020 2020  __name__,.      
-00000cb0: 2020 290a 2020 2020 7072 696e 7428 227b    ).    print("{
-00000cc0: 7d20 696d 6167 6520 6669 6c65 7320 666f  } image files fo
-00000cd0: 756e 6420 696e 207b 7d2e 2e2e 222e 666f  und in {}...".fo
-00000ce0: 726d 6174 2873 7472 286c 656e 2866 696c  rmat(str(len(fil
-00000cf0: 6573 5f66 6f75 6e64 2929 2c20 6469 7265  es_found)), dire
-00000d00: 6374 6f72 7929 290a 2020 2020 666f 7220  ctory)).    for 
-00000d10: 6669 6c65 5f70 6174 6820 696e 2066 696c  file_path in fil
-00000d20: 6573 5f66 6f75 6e64 3a0a 2020 2020 2020  es_found:.      
-00000d30: 2020 696d 203d 2049 6d61 6765 2e6f 7065    im = Image.ope
-00000d40: 6e28 6669 6c65 5f70 6174 6829 0a20 2020  n(file_path).   
-00000d50: 2020 2020 2073 6176 655f 6e61 6d65 203d       save_name =
-00000d60: 2066 696c 655f 7061 7468 2e72 6570 6c61   file_path.repla
-00000d70: 6365 2822 2e22 202b 2073 7472 2866 696c  ce("." + str(fil
-00000d80: 655f 7479 7065 5f69 6e29 2c20 222e 2220  e_type_in), "." 
-00000d90: 2b20 7374 7228 6669 6c65 5f74 7970 655f  + str(file_type_
-00000da0: 6f75 7429 290a 2020 2020 2020 2020 696d  out)).        im
-00000db0: 2e73 6176 6528 7361 7665 5f6e 616d 6529  .save(save_name)
-00000dc0: 0a20 2020 2020 2020 206f 732e 7265 6d6f  .        os.remo
-00000dd0: 7665 2866 696c 655f 7061 7468 290a 2020  ve(file_path).  
-00000de0: 2020 7374 646f 7574 5f73 7563 6365 7373    stdout_success
-00000df0: 280a 2020 2020 2020 2020 6d73 673d 6622  (.        msg=f"
-00000e00: 5349 4d42 4120 434f 4d50 4c45 5445 3a20  SIMBA COMPLETE: 
-00000e10: 4669 6c65 7320 696e 207b 6469 7265 6374  Files in {direct
-00000e20: 6f72 797d 2064 6972 6563 746f 7279 2063  ory} directory c
-00000e30: 6f6e 7665 7274 6564 2074 6f20 7b66 696c  onverted to {fil
-00000e40: 655f 7479 7065 5f6f 7574 7d22 2c0a 2020  e_type_out}",.  
-00000e50: 2020 2020 2020 736f 7572 6365 3d63 6861        source=cha
-00000e60: 6e67 655f 696d 675f 666f 726d 6174 2e5f  nge_img_format._
-00000e70: 5f6e 616d 655f 5f2c 0a20 2020 2029 0a0a  _name__,.    )..
-00000e80: 0a64 6566 2063 6c61 6865 5f65 6e68 616e  .def clahe_enhan
-00000e90: 6365 5f76 6964 656f 2866 696c 655f 7061  ce_video(file_pa
-00000ea0: 7468 3a20 556e 696f 6e5b 7374 722c 206f  th: Union[str, o
-00000eb0: 732e 5061 7468 4c69 6b65 5d29 202d 3e20  s.PathLike]) -> 
-00000ec0: 4e6f 6e65 3a0a 2020 2020 2222 220a 2020  None:.    """.  
-00000ed0: 2020 436f 6e76 6572 7420 6120 7369 6e67    Convert a sing
-00000ee0: 6c65 2076 6964 656f 2066 696c 6520 746f  le video file to
-00000ef0: 2063 6c61 6865 2d65 6e68 616e 6365 6420   clahe-enhanced 
-00000f00: 6772 6579 7363 616c 6520 2e61 7669 2066  greyscale .avi f
-00000f10: 696c 652e 2054 6865 2072 6573 756c 7420  ile. The result 
-00000f20: 6973 2073 6176 6564 2077 6974 6820 7072  is saved with pr
-00000f30: 6566 6978 0a20 2020 2060 6043 4c41 4845  efix.    ``CLAHE
-00000f40: 5f60 6020 696e 2074 6865 2073 616d 6520  _`` in the same 
-00000f50: 6469 7265 6374 6f72 7920 6173 2069 6e20  directory as in 
-00000f60: 7468 6520 696e 7075 7420 6669 6c65 2e0a  the input file..
-00000f70: 0a20 2020 203a 7061 7261 6d65 7465 7220  .    :parameter 
-00000f80: 556e 696f 6e5b 7374 722c 206f 732e 5061  Union[str, os.Pa
-00000f90: 7468 4c69 6b65 5d20 6669 6c65 5f70 6174  thLike] file_pat
-00000fa0: 683a 2050 6174 6820 746f 2076 6964 656f  h: Path to video
-00000fb0: 2066 696c 652e 0a0a 2020 2020 3a65 7861   file...    :exa
-00000fc0: 6d70 6c65 3a0a 2020 2020 3e3e 3e20 5f20  mple:.    >>> _ 
-00000fd0: 3d20 636c 6168 655f 656e 6861 6e63 655f  = clahe_enhance_
-00000fe0: 7669 6465 6f28 6669 6c65 5f70 6174 683a  video(file_path:
-00000ff0: 2027 7072 6f6a 6563 745f 666f 6c64 6572   'project_folder
-00001000: 2f76 6964 656f 732f 5669 6465 6f5f 312e  /videos/Video_1.
-00001010: 6d70 3427 290a 2020 2020 2222 220a 0a20  mp4').    """.. 
-00001020: 2020 2064 6972 2c20 6669 6c65 5f6e 616d     dir, file_nam
-00001030: 652c 2066 696c 655f 6578 7420 3d20 6765  e, file_ext = ge
-00001040: 745f 666e 5f65 7874 2866 696c 6570 6174  t_fn_ext(filepat
-00001050: 683d 6669 6c65 5f70 6174 6829 0a20 2020  h=file_path).   
-00001060: 2073 6176 655f 7061 7468 203d 206f 732e   save_path = os.
-00001070: 7061 7468 2e6a 6f69 6e28 6469 722c 2066  path.join(dir, f
-00001080: 2243 4c41 4845 5f7b 6669 6c65 5f6e 616d  "CLAHE_{file_nam
-00001090: 657d 2e61 7669 2229 0a20 2020 2076 6964  e}.avi").    vid
-000010a0: 656f 5f6d 6574 615f 6461 7461 203d 2067  eo_meta_data = g
-000010b0: 6574 5f76 6964 656f 5f6d 6574 615f 6461  et_video_meta_da
-000010c0: 7461 2866 696c 655f 7061 7468 290a 2020  ta(file_path).  
-000010d0: 2020 666f 7572 6363 203d 2063 7632 2e56    fourcc = cv2.V
-000010e0: 6964 656f 5772 6974 6572 5f66 6f75 7263  ideoWriter_fourc
-000010f0: 6328 2a46 6f72 6d61 7473 2e41 5649 5f43  c(*Formats.AVI_C
-00001100: 4f44 4543 2e76 616c 7565 290a 2020 2020  ODEC.value).    
-00001110: 7072 696e 7428 6622 4170 706c 7969 6e67  print(f"Applying
-00001120: 2043 4c41 4845 206f 6e20 7669 6465 6f20   CLAHE on video 
-00001130: 7b66 696c 655f 6e61 6d65 7d2c 2074 6869  {file_name}, thi
-00001140: 7320 6d69 6768 7420 7461 6b65 2061 7768  s might take awh
-00001150: 696c 652e 2e2e 2229 0a20 2020 2063 6170  ile...").    cap
-00001160: 203d 2063 7632 2e56 6964 656f 4361 7074   = cv2.VideoCapt
-00001170: 7572 6528 6669 6c65 5f70 6174 6829 0a20  ure(file_path). 
-00001180: 2020 2077 7269 7465 7220 3d20 6376 322e     writer = cv2.
-00001190: 5669 6465 6f57 7269 7465 7228 0a20 2020  VideoWriter(.   
-000011a0: 2020 2020 2073 6176 655f 7061 7468 2c0a       save_path,.
-000011b0: 2020 2020 2020 2020 666f 7572 6363 2c0a          fourcc,.
-000011c0: 2020 2020 2020 2020 7669 6465 6f5f 6d65          video_me
-000011d0: 7461 5f64 6174 615b 2266 7073 225d 2c0a  ta_data["fps"],.
-000011e0: 2020 2020 2020 2020 2876 6964 656f 5f6d          (video_m
-000011f0: 6574 615f 6461 7461 5b22 7769 6474 6822  eta_data["width"
-00001200: 5d2c 2076 6964 656f 5f6d 6574 615f 6461  ], video_meta_da
-00001210: 7461 5b22 6865 6967 6874 225d 292c 0a20  ta["height"]),. 
-00001220: 2020 2020 2020 2030 2c0a 2020 2020 290a         0,.    ).
-00001230: 2020 2020 636c 6168 655f 6669 6c74 6572      clahe_filter
-00001240: 203d 2063 7632 2e63 7265 6174 6543 4c41   = cv2.createCLA
-00001250: 4845 2863 6c69 704c 696d 6974 3d32 2c20  HE(clipLimit=2, 
-00001260: 7469 6c65 4772 6964 5369 7a65 3d28 3136  tileGridSize=(16
-00001270: 2c20 3136 2929 0a20 2020 2066 726d 5f63  , 16)).    frm_c
-00001280: 6e74 203d 2030 0a20 2020 2074 7279 3a0a  nt = 0.    try:.
-00001290: 2020 2020 2020 2020 7768 696c 6520 5472          while Tr
-000012a0: 7565 3a0a 2020 2020 2020 2020 2020 2020  ue:.            
-000012b0: 7265 742c 2069 6d67 203d 2063 6170 2e72  ret, img = cap.r
-000012c0: 6561 6428 290a 2020 2020 2020 2020 2020  ead().          
-000012d0: 2020 6966 2072 6574 3a0a 2020 2020 2020    if ret:.      
-000012e0: 2020 2020 2020 2020 2020 6672 6d5f 636e            frm_cn
-000012f0: 7420 2b3d 2031 0a20 2020 2020 2020 2020  t += 1.         
-00001300: 2020 2020 2020 2069 6d67 203d 2063 7632         img = cv2
-00001310: 2e63 7674 436f 6c6f 7228 696d 672c 2063  .cvtColor(img, c
-00001320: 7632 2e43 4f4c 4f52 5f42 4752 3247 5241  v2.COLOR_BGR2GRA
-00001330: 5929 0a20 2020 2020 2020 2020 2020 2020  Y).             
-00001340: 2020 2063 6c61 6865 5f66 726d 203d 2063     clahe_frm = c
-00001350: 6c61 6865 5f66 696c 7465 722e 6170 706c  lahe_filter.appl
-00001360: 7928 696d 6729 0a20 2020 2020 2020 2020  y(img).         
-00001370: 2020 2020 2020 2077 7269 7465 722e 7772         writer.wr
-00001380: 6974 6528 636c 6168 655f 6672 6d29 0a20  ite(clahe_frm). 
-00001390: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-000013a0: 7269 6e74 280a 2020 2020 2020 2020 2020  rint(.          
-000013b0: 2020 2020 2020 2020 2020 6622 434c 4148            f"CLAH
-000013c0: 4520 636f 6e76 6572 7465 6420 6672 616d  E converted fram
-000013d0: 6520 7b66 726d 5f63 6e74 7d2f 7b76 6964  e {frm_cnt}/{vid
-000013e0: 656f 5f6d 6574 615f 6461 7461 5b27 6672  eo_meta_data['fr
-000013f0: 616d 655f 636f 756e 7427 5d7d 220a 2020  ame_count']}".  
-00001400: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00001410: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00001420: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00001430: 2020 6272 6561 6b0a 2020 2020 2020 2020    break.        
-00001440: 6361 702e 7265 6c65 6173 6528 290a 2020  cap.release().  
-00001450: 2020 2020 2020 7772 6974 6572 2e72 656c        writer.rel
-00001460: 6561 7365 2829 0a20 2020 2020 2020 2070  ease().        p
-00001470: 7269 6e74 2866 2243 4c41 4845 2076 6964  rint(f"CLAHE vid
-00001480: 656f 2063 7265 6174 6564 3a20 7b73 6176  eo created: {sav
-00001490: 655f 7061 7468 7d2e 2229 0a20 2020 2065  e_path}.").    e
-000014a0: 7863 6570 7420 4578 6365 7074 696f 6e20  xcept Exception 
-000014b0: 6173 2073 653a 0a20 2020 2020 2020 2070  as se:.        p
-000014c0: 7269 6e74 2873 652e 6172 6773 290a 2020  rint(se.args).  
-000014d0: 2020 2020 2020 7072 696e 7428 6622 434c        print(f"CL
-000014e0: 4148 4520 636f 6e76 6572 7369 6f6e 2066  AHE conversion f
-000014f0: 6169 6c65 6420 666f 7220 7669 6465 6f20  ailed for video 
-00001500: 7b66 696c 655f 6e61 6d65 7d2e 2229 0a20  {file_name}."). 
-00001510: 2020 2020 2020 2063 6170 2e72 656c 6561         cap.relea
-00001520: 7365 2829 0a20 2020 2020 2020 2077 7269  se().        wri
-00001530: 7465 722e 7265 6c65 6173 6528 290a 2020  ter.release().  
-00001540: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00001550: 6545 7272 6f72 2829 0a0a 0a64 6566 2065  eError()...def e
-00001560: 7874 7261 6374 5f66 7261 6d65 5f72 616e  xtract_frame_ran
-00001570: 6765 280a 2020 2020 6669 6c65 5f70 6174  ge(.    file_pat
-00001580: 683a 2055 6e69 6f6e 5b73 7472 2c20 6f73  h: Union[str, os
-00001590: 2e50 6174 684c 696b 655d 2c20 7374 6172  .PathLike], star
-000015a0: 745f 6672 616d 653a 2069 6e74 2c20 656e  t_frame: int, en
-000015b0: 645f 6672 616d 653a 2069 6e74 0a29 202d  d_frame: int.) -
-000015c0: 3e20 4e6f 6e65 3a0a 2020 2020 2222 220a  > None:.    """.
-000015d0: 2020 2020 4578 7472 6163 7420 6120 7573      Extract a us
-000015e0: 6572 2d64 6566 696e 6564 2072 616e 6765  er-defined range
-000015f0: 206f 6620 6672 616d 6573 2066 726f 6d20   of frames from 
-00001600: 6120 7669 6465 6f20 6669 6c65 2074 6f20  a video file to 
-00001610: 6070 6e67 6020 666f 726d 6174 2e20 496d  `png` format. Im
-00001620: 6167 6573 0a20 2020 2061 7265 2073 6176  ages.    are sav
-00001630: 6564 2069 6e20 6120 666f 6c64 6572 2077  ed in a folder w
-00001640: 6974 6820 7468 6520 7375 6666 6978 2060  ith the suffix `
-00001650: 5f66 7261 6d65 7360 2077 6974 6869 6e20  _frames` within 
-00001660: 7468 6520 7361 6d65 2064 6972 6563 746f  the same directo
-00001670: 7279 2061 7320 7468 6520 7669 6465 6f20  ry as the video 
-00001680: 6669 6c65 2e0a 0a20 2020 203a 7061 7261  file...    :para
-00001690: 6d65 7465 7220 556e 696f 6e5b 7374 722c  meter Union[str,
-000016a0: 206f 732e 5061 7468 4c69 6b65 5d20 6669   os.PathLike] fi
-000016b0: 6c65 5f70 6174 683a 2050 6174 6820 746f  le_path: Path to
-000016c0: 2076 6964 656f 2066 696c 650a 2020 2020   video file.    
-000016d0: 3a70 6172 616d 6574 6572 2069 6e74 2073  :parameter int s
-000016e0: 7461 7274 5f66 7261 6d65 3a20 4669 7273  tart_frame: Firs
-000016f0: 7420 6672 616d 6520 696e 2072 616e 6765  t frame in range
-00001700: 2074 6f20 6578 7472 6163 740a 2020 2020   to extract.    
-00001710: 3a70 6172 616d 6574 6572 2069 6e74 2065  :parameter int e
-00001720: 6e64 5f66 7261 6d65 3a20 4c61 7374 2066  nd_frame: Last f
-00001730: 7261 6d65 2069 6e20 7261 6e67 6520 746f  rame in range to
-00001740: 2065 7874 7261 6374 2e0a 0a20 2020 203a   extract...    :
-00001750: 6578 616d 706c 653a 0a20 2020 203e 3e3e  example:.    >>>
-00001760: 205f 203d 2065 7874 7261 6374 5f66 7261   _ = extract_fra
-00001770: 6d65 5f72 616e 6765 2866 696c 655f 7061  me_range(file_pa
-00001780: 7468 3d27 7072 6f6a 6563 745f 666f 6c64  th='project_fold
-00001790: 6572 2f76 6964 656f 732f 5669 6465 6f5f  er/videos/Video_
-000017a0: 312e 6d70 3427 2c20 7374 6172 745f 6672  1.mp4', start_fr
-000017b0: 616d 653d 3130 302c 2065 6e64 5f66 7261  ame=100, end_fra
-000017c0: 6d65 3d35 3030 290a 2020 2020 2222 220a  me=500).    """.
-000017d0: 0a20 2020 2063 6865 636b 5f66 696c 655f  .    check_file_
-000017e0: 6578 6973 745f 616e 645f 7265 6164 6162  exist_and_readab
-000017f0: 6c65 2866 696c 655f 7061 7468 3d66 696c  le(file_path=fil
-00001800: 655f 7061 7468 290a 2020 2020 7669 6465  e_path).    vide
-00001810: 6f5f 6d65 7461 5f64 6174 6120 3d20 6765  o_meta_data = ge
-00001820: 745f 7669 6465 6f5f 6d65 7461 5f64 6174  t_video_meta_dat
-00001830: 6128 6669 6c65 5f70 6174 6829 0a20 2020  a(file_path).   
-00001840: 2063 6865 636b 5f69 6e74 286e 616d 653d   check_int(name=
-00001850: 2273 7461 7274 2066 7261 6d65 222c 2076  "start frame", v
-00001860: 616c 7565 3d73 7461 7274 5f66 7261 6d65  alue=start_frame
-00001870: 2c20 6d69 6e5f 7661 6c75 653d 3029 0a20  , min_value=0). 
-00001880: 2020 2066 696c 655f 6469 722c 2066 696c     file_dir, fil
-00001890: 655f 6e61 6d65 2c20 6669 6c65 5f65 7874  e_name, file_ext
-000018a0: 203d 2067 6574 5f66 6e5f 6578 7428 6669   = get_fn_ext(fi
-000018b0: 6c65 7061 7468 3d66 696c 655f 7061 7468  lepath=file_path
-000018c0: 290a 2020 2020 6368 6563 6b5f 696e 7428  ).    check_int(
-000018d0: 0a20 2020 2020 2020 206e 616d 653d 2265  .        name="e
-000018e0: 6e64 2066 7261 6d65 222c 2076 616c 7565  nd frame", value
-000018f0: 3d65 6e64 5f66 7261 6d65 2c20 6d61 785f  =end_frame, max_
-00001900: 7661 6c75 653d 7669 6465 6f5f 6d65 7461  value=video_meta
-00001910: 5f64 6174 615b 2266 7261 6d65 5f63 6f75  _data["frame_cou
-00001920: 6e74 225d 0a20 2020 2029 0a20 2020 2066  nt"].    ).    f
-00001930: 7261 6d65 5f72 616e 6765 203d 206c 6973  rame_range = lis
-00001940: 7428 7261 6e67 6528 696e 7428 7374 6172  t(range(int(star
-00001950: 745f 6672 616d 6529 2c20 696e 7428 656e  t_frame), int(en
-00001960: 645f 6672 616d 6529 202b 2031 2929 0a20  d_frame) + 1)). 
-00001970: 2020 2073 6176 655f 6469 7220 3d20 6f73     save_dir = os
-00001980: 2e70 6174 682e 6a6f 696e 2866 696c 655f  .path.join(file_
-00001990: 6469 722c 2066 696c 655f 6e61 6d65 202b  dir, file_name +
-000019a0: 2022 5f66 7261 6d65 7322 290a 2020 2020   "_frames").    
-000019b0: 6361 7020 3d20 6376 322e 5669 6465 6f43  cap = cv2.VideoC
-000019c0: 6170 7475 7265 2866 696c 655f 7061 7468  apture(file_path
-000019d0: 290a 2020 2020 6966 206e 6f74 206f 732e  ).    if not os.
-000019e0: 7061 7468 2e65 7869 7374 7328 7361 7665  path.exists(save
-000019f0: 5f64 6972 293a 0a20 2020 2020 2020 206f  _dir):.        o
-00001a00: 732e 6d61 6b65 6469 7273 2873 6176 655f  s.makedirs(save_
-00001a10: 6469 7229 0a20 2020 2066 6f72 2066 726d  dir).    for frm
-00001a20: 5f63 6e74 2c20 6672 6d5f 6e75 6d62 6572  _cnt, frm_number
-00001a30: 2069 6e20 656e 756d 6572 6174 6528 6672   in enumerate(fr
-00001a40: 616d 655f 7261 6e67 6529 3a0a 2020 2020  ame_range):.    
-00001a50: 2020 2020 6361 702e 7365 7428 312c 2066      cap.set(1, f
-00001a60: 726d 5f6e 756d 6265 7229 0a20 2020 2020  rm_number).     
-00001a70: 2020 2072 6574 2c20 6672 616d 6520 3d20     ret, frame = 
-00001a80: 6361 702e 7265 6164 2829 0a20 2020 2020  cap.read().     
-00001a90: 2020 2066 726d 5f73 6176 655f 7061 7468     frm_save_path
-00001aa0: 203d 206f 732e 7061 7468 2e6a 6f69 6e28   = os.path.join(
-00001ab0: 7361 7665 5f64 6972 2c20 227b 7d2e 7b7d  save_dir, "{}.{}
-00001ac0: 222e 666f 726d 6174 2873 7472 2866 726d  ".format(str(frm
-00001ad0: 5f6e 756d 6265 7229 2c20 2270 6e67 2229  _number), "png")
-00001ae0: 290a 2020 2020 2020 2020 6376 322e 696d  ).        cv2.im
-00001af0: 7772 6974 6528 6672 6d5f 7361 7665 5f70  write(frm_save_p
-00001b00: 6174 682c 2066 7261 6d65 290a 2020 2020  ath, frame).    
-00001b10: 2020 2020 7072 696e 7428 0a20 2020 2020      print(.     
-00001b20: 2020 2020 2020 2022 4672 616d 6520 7b7d         "Frame {}
-00001b30: 2073 6176 6564 2028 4672 616d 6520 7b7d   saved (Frame {}
-00001b40: 2f7b 7d29 222e 666f 726d 6174 280a 2020  /{})".format(.  
-00001b50: 2020 2020 2020 2020 2020 2020 2020 7374                st
-00001b60: 7228 6672 6d5f 6e75 6d62 6572 292c 2073  r(frm_number), s
-00001b70: 7472 2866 726d 5f63 6e74 292c 2073 7472  tr(frm_cnt), str
-00001b80: 286c 656e 2866 7261 6d65 5f72 616e 6765  (len(frame_range
-00001b90: 2929 0a20 2020 2020 2020 2020 2020 2029  )).            )
-00001ba0: 0a20 2020 2020 2020 2029 0a20 2020 2073  .        ).    s
-00001bb0: 7464 6f75 745f 7375 6363 6573 7328 0a20  tdout_success(. 
-00001bc0: 2020 2020 2020 206d 7367 3d66 227b 7374         msg=f"{st
-00001bd0: 7228 6c65 6e28 6672 616d 655f 7261 6e67  r(len(frame_rang
-00001be0: 6529 297d 2066 7261 6d65 7320 6578 7472  e))} frames extr
-00001bf0: 6163 7465 6420 666f 7220 7669 6465 6f20  acted for video 
-00001c00: 7b66 696c 655f 6e61 6d65 7d22 2c0a 2020  {file_name}",.  
-00001c10: 2020 2020 2020 736f 7572 6365 3d65 7874        source=ext
-00001c20: 7261 6374 5f66 7261 6d65 5f72 616e 6765  ract_frame_range
-00001c30: 2e5f 5f6e 616d 655f 5f2c 0a20 2020 2029  .__name__,.    )
-00001c40: 0a0a 0a64 6566 2063 6861 6e67 655f 7369  ...def change_si
-00001c50: 6e67 6c65 5f76 6964 656f 5f66 7073 280a  ngle_video_fps(.
-00001c60: 2020 2020 6669 6c65 5f70 6174 683a 2055      file_path: U
-00001c70: 6e69 6f6e 5b73 7472 2c20 6f73 2e50 6174  nion[str, os.Pat
-00001c80: 684c 696b 655d 2c20 6670 733a 2069 6e74  hLike], fps: int
-00001c90: 2c20 6770 753a 204f 7074 696f 6e61 6c5b  , gpu: Optional[
-00001ca0: 626f 6f6c 5d20 3d20 4661 6c73 650a 2920  bool] = False.) 
-00001cb0: 2d3e 204e 6f6e 653a 0a20 2020 2022 2222  -> None:.    """
-00001cc0: 0a20 2020 2043 6861 6e67 6520 7468 6520  .    Change the 
-00001cd0: 6670 7320 6f66 2061 2073 696e 676c 6520  fps of a single 
-00001ce0: 7669 6465 6f20 6669 6c65 2e20 5265 7375  video file. Resu
-00001cf0: 6c74 7320 6172 6520 7374 6f72 6564 2069  lts are stored i
-00001d00: 6e20 7468 6520 7361 6d65 2064 6972 6563  n the same direc
-00001d10: 746f 7279 2061 7320 696e 2074 6865 2069  tory as in the i
-00001d20: 6e70 7574 2066 696c 6520 7769 7468 0a20  nput file with. 
-00001d30: 2020 2074 6865 2073 7566 6669 7820 6060     the suffix ``
-00001d40: 5f66 7073 5f6e 6577 5f66 7073 6060 2e0a  _fps_new_fps``..
-00001d50: 0a20 2020 202e 2e20 6e6f 7465 3a3a 0a20  .    .. note::. 
-00001d60: 2020 2020 2020 546f 2063 6861 6e67 6520        To change 
-00001d70: 7468 6520 4650 5320 6f66 2061 6c6c 2076  the FPS of all v
-00001d80: 6964 656f 7320 696e 2061 2064 6972 6563  ideos in a direc
-00001d90: 746f 7279 2c20 7573 6520 6060 7369 6d62  tory, use ``simb
-00001da0: 612e 7669 6465 6f5f 7072 6f63 6573 736f  a.video_processo
-00001db0: 7273 2e76 6964 656f 5f70 726f 6365 7373  rs.video_process
-00001dc0: 696e 672e 6368 616e 6765 5f66 7073 5f6f  ing.change_fps_o
-00001dd0: 665f 6d75 6c74 6970 6c65 5f76 6964 656f  f_multiple_video
-00001de0: 7360 602e 0a0a 2020 2020 3a70 6172 616d  s``...    :param
-00001df0: 6574 6572 2055 6e69 6f6e 5b73 7472 2c20  eter Union[str, 
-00001e00: 6f73 2e50 6174 684c 696b 655d 2066 696c  os.PathLike] fil
-00001e10: 655f 7061 7468 3a20 5061 7468 2074 6f20  e_path: Path to 
-00001e20: 7669 6465 6f20 6669 6c65 0a20 2020 203a  video file.    :
-00001e30: 7061 7261 6d65 7465 7220 696e 7420 6670  parameter int fp
-00001e40: 733a 2046 7073 206f 6620 7468 6520 6e65  s: Fps of the ne
-00001e50: 7720 7669 6465 6f20 6669 6c65 2e0a 2020  w video file..  
-00001e60: 2020 3a70 6172 616d 6574 6572 204f 7074    :parameter Opt
-00001e70: 696f 6e61 6c5b 626f 6f6c 5d20 6770 753a  ional[bool] gpu:
-00001e80: 2049 6620 5472 7565 2c20 7573 6520 4e56   If True, use NV
-00001e90: 4944 4541 2047 5055 2063 6f64 6563 732e  IDEA GPU codecs.
-00001ea0: 2044 6566 6175 6c74 2046 616c 7365 2e0a   Default False..
-00001eb0: 0a20 2020 203a 6578 616d 706c 653a 0a20  .    :example:. 
-00001ec0: 2020 203e 3e3e 205f 203d 2063 6861 6e67     >>> _ = chang
-00001ed0: 655f 7369 6e67 6c65 5f76 6964 656f 5f66  e_single_video_f
-00001ee0: 7073 2866 696c 655f 7061 7468 3d27 7072  ps(file_path='pr
-00001ef0: 6f6a 6563 745f 666f 6c64 6572 2f76 6964  oject_folder/vid
-00001f00: 656f 732f 5669 6465 6f5f 312e 6d70 3427  eos/Video_1.mp4'
-00001f10: 2c20 6670 733d 3135 290a 2020 2020 2222  , fps=15).    ""
-00001f20: 220a 0a20 2020 2074 696d 6572 203d 2053  "..    timer = S
-00001f30: 696d 6261 5469 6d65 7228 7374 6172 743d  imbaTimer(start=
-00001f40: 5472 7565 290a 2020 2020 6966 2067 7075  True).    if gpu
-00001f50: 2061 6e64 206e 6f74 2063 6865 636b 5f6e   and not check_n
-00001f60: 7669 6465 615f 6770 755f 6176 6169 6c61  videa_gpu_availa
-00001f70: 626c 6528 293a 0a20 2020 2020 2020 2072  ble():.        r
-00001f80: 6169 7365 2046 464d 5045 4743 6f64 6563  aise FFMPEGCodec
-00001f90: 4750 5545 7272 6f72 280a 2020 2020 2020  GPUError(.      
-00001fa0: 2020 2020 2020 6d73 673d 224e 6f20 4750        msg="No GP
-00001fb0: 5520 666f 756e 6420 2861 7320 6576 616c  U found (as eval
-00001fc0: 7561 7465 6420 6279 206e 7669 6465 612d  uated by nvidea-
-00001fd0: 736d 6920 7265 7475 726e 696e 6720 4e6f  smi returning No
-00001fe0: 6e65 2922 2c0a 2020 2020 2020 2020 2020  ne)",.          
-00001ff0: 2020 736f 7572 6365 3d63 6861 6e67 655f    source=change_
-00002000: 7369 6e67 6c65 5f76 6964 656f 5f66 7073  single_video_fps
-00002010: 2e5f 5f6e 616d 655f 5f2c 0a20 2020 2020  .__name__,.     
-00002020: 2020 2029 0a20 2020 2063 6865 636b 5f66     ).    check_f
-00002030: 696c 655f 6578 6973 745f 616e 645f 7265  ile_exist_and_re
-00002040: 6164 6162 6c65 2866 696c 655f 7061 7468  adable(file_path
-00002050: 3d66 696c 655f 7061 7468 290a 2020 2020  =file_path).    
-00002060: 6368 6563 6b5f 696e 7428 6e61 6d65 3d22  check_int(name="
-00002070: 4e65 7720 6670 7322 2c20 7661 6c75 653d  New fps", value=
-00002080: 6670 7329 0a20 2020 2076 6964 656f 5f6d  fps).    video_m
-00002090: 6574 615f 6461 7461 203d 2067 6574 5f76  eta_data = get_v
-000020a0: 6964 656f 5f6d 6574 615f 6461 7461 2876  ideo_meta_data(v
-000020b0: 6964 656f 5f70 6174 683d 6669 6c65 5f70  ideo_path=file_p
-000020c0: 6174 6829 0a20 2020 2064 6972 5f6e 616d  ath).    dir_nam
-000020d0: 652c 2066 696c 655f 6e61 6d65 2c20 6578  e, file_name, ex
-000020e0: 7420 3d20 6765 745f 666e 5f65 7874 2866  t = get_fn_ext(f
-000020f0: 696c 6570 6174 683d 6669 6c65 5f70 6174  ilepath=file_pat
-00002100: 6829 0a20 2020 2069 6620 696e 7428 6670  h).    if int(fp
-00002110: 7329 203d 3d20 696e 7428 7669 6465 6f5f  s) == int(video_
-00002120: 6d65 7461 5f64 6174 615b 2266 7073 225d  meta_data["fps"]
-00002130: 293a 0a20 2020 2020 2020 2053 616d 6549  ):.        SameI
-00002140: 6e70 7574 416e 644f 7574 7075 7457 6172  nputAndOutputWar
-00002150: 6e69 6e67 280a 2020 2020 2020 2020 2020  ning(.          
-00002160: 2020 6d73 673d 6622 5468 6520 6e65 7720    msg=f"The new 
-00002170: 6670 7320 6973 2074 6865 2073 616d 6520  fps is the same 
-00002180: 6173 2074 6865 2069 6e70 7574 2066 7073  as the input fps
-00002190: 2066 6f72 2076 6964 656f 207b 6669 6c65   for video {file
-000021a0: 5f6e 616d 657d 2028 7b73 7472 2866 7073  _name} ({str(fps
-000021b0: 297d 2922 2c0a 2020 2020 2020 2020 2020  )})",.          
-000021c0: 2020 736f 7572 6365 3d63 6861 6e67 655f    source=change_
-000021d0: 7369 6e67 6c65 5f76 6964 656f 5f66 7073  single_video_fps
-000021e0: 2e5f 5f6e 616d 655f 5f2c 0a20 2020 2020  .__name__,.     
-000021f0: 2020 2029 0a20 2020 2073 6176 655f 7061     ).    save_pa
-00002200: 7468 203d 206f 732e 7061 7468 2e6a 6f69  th = os.path.joi
-00002210: 6e28 0a20 2020 2020 2020 2064 6972 5f6e  n(.        dir_n
-00002220: 616d 652c 2066 696c 655f 6e61 6d65 202b  ame, file_name +
-00002230: 2022 5f66 7073 5f7b 7d7b 7d22 2e66 6f72   "_fps_{}{}".for
-00002240: 6d61 7428 7374 7228 6670 7329 2c20 7374  mat(str(fps), st
-00002250: 7228 6578 7429 290a 2020 2020 290a 2020  r(ext)).    ).  
-00002260: 2020 7072 696e 7428 6622 436f 6e76 6572    print(f"Conver
-00002270: 7469 6e67 2074 6865 2046 5053 2074 6f20  ting the FPS to 
-00002280: 7b66 7073 7d20 666f 7220 7669 6465 6f20  {fps} for video 
-00002290: 7b66 696c 655f 6e61 6d65 7d20 2e2e 2e22  {file_name} ..."
-000022a0: 290a 2020 2020 6966 206f 732e 7061 7468  ).    if os.path
-000022b0: 2e69 7366 696c 6528 7361 7665 5f70 6174  .isfile(save_pat
-000022c0: 6829 3a0a 2020 2020 2020 2020 4669 6c65  h):.        File
-000022d0: 4578 6973 7457 6172 6e69 6e67 280a 2020  ExistWarning(.  
-000022e0: 2020 2020 2020 2020 2020 6d73 673d 6622            msg=f"
-000022f0: 4f76 6572 7772 6974 696e 6720 6578 6973  Overwriting exis
-00002300: 7469 6e67 2066 696c 6520 6174 207b 7361  ting file at {sa
-00002310: 7665 5f70 6174 687d 2e2e 2e22 2c0a 2020  ve_path}...",.  
-00002320: 2020 2020 2020 2020 2020 736f 7572 6365            source
-00002330: 3d63 6861 6e67 655f 7369 6e67 6c65 5f76  =change_single_v
-00002340: 6964 656f 5f66 7073 2e5f 5f6e 616d 655f  ideo_fps.__name_
-00002350: 5f2c 0a20 2020 2020 2020 2029 0a20 2020  _,.        ).   
-00002360: 2069 6620 6770 753a 0a20 2020 2020 2020   if gpu:.       
-00002370: 2063 6f6d 6d61 6e64 203d 2066 2766 666d   command = f'ffm
-00002380: 7065 6720 2d68 7761 6363 656c 2061 7574  peg -hwaccel aut
-00002390: 6f20 2d63 3a76 2068 3236 345f 6375 7669  o -c:v h264_cuvi
-000023a0: 6420 2d69 2022 7b66 696c 655f 7061 7468  d -i "{file_path
-000023b0: 7d22 202d 7666 2022 6670 733d 7b66 7073  }" -vf "fps={fps
-000023c0: 7d22 202d 633a 7620 6832 3634 5f6e 7665  }" -c:v h264_nve
-000023d0: 6e63 202d 633a 6120 636f 7079 2022 7b73  nc -c:a copy "{s
-000023e0: 6176 655f 7061 7468 7d22 202d 7927 0a20  ave_path}" -y'. 
-000023f0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00002400: 2063 6f6d 6d61 6e64 203d 2028 0a20 2020   command = (.   
-00002410: 2020 2020 2020 2020 2073 7472 2822 6666           str("ff
-00002420: 6d70 6567 202d 6920 2229 0a20 2020 2020  mpeg -i ").     
-00002430: 2020 2020 2020 202b 2027 2227 0a20 2020         + '"'.   
-00002440: 2020 2020 2020 2020 202b 2073 7472 2866           + str(f
-00002450: 696c 655f 7061 7468 290a 2020 2020 2020  ile_path).      
-00002460: 2020 2020 2020 2b20 2722 270a 2020 2020        + '"'.    
-00002470: 2020 2020 2020 2020 2b20 2220 2d66 696c          + " -fil
-00002480: 7465 723a 7620 6670 733d 6670 733d 220a  ter:v fps=fps=".
-00002490: 2020 2020 2020 2020 2020 2020 2b20 7374              + st
-000024a0: 7228 6670 7329 0a20 2020 2020 2020 2020  r(fps).         
-000024b0: 2020 202b 2022 2022 0a20 2020 2020 2020     + " ".       
-000024c0: 2020 2020 202b 2027 2227 0a20 2020 2020       + '"'.     
-000024d0: 2020 2020 2020 202b 2073 6176 655f 7061         + save_pa
-000024e0: 7468 0a20 2020 2020 2020 2020 2020 202b  th.            +
-000024f0: 2027 2220 2d79 270a 2020 2020 2020 2020   '" -y'.        
-00002500: 290a 2020 2020 7375 6270 726f 6365 7373  ).    subprocess
-00002510: 2e63 616c 6c28 636f 6d6d 616e 642c 2073  .call(command, s
-00002520: 6865 6c6c 3d54 7275 6529 0a20 2020 2074  hell=True).    t
-00002530: 696d 6572 2e73 746f 705f 7469 6d65 7228  imer.stop_timer(
-00002540: 290a 2020 2020 7374 646f 7574 5f73 7563  ).    stdout_suc
-00002550: 6365 7373 280a 2020 2020 2020 2020 6d73  cess(.        ms
-00002560: 673d 6627 5349 4d42 4120 434f 4d50 4c45  g=f'SIMBA COMPLE
-00002570: 5445 3a20 4650 5320 6f66 2076 6964 656f  TE: FPS of video
-00002580: 207b 6669 6c65 5f6e 616d 657d 2063 6861   {file_name} cha
-00002590: 6e67 6564 2066 726f 6d20 7b73 7472 2876  nged from {str(v
-000025a0: 6964 656f 5f6d 6574 615f 6461 7461 5b22  ideo_meta_data["
-000025b0: 6670 7322 5d29 7d20 746f 207b 7374 7228  fps"])} to {str(
-000025c0: 6670 7329 7d20 616e 6420 7361 7665 6420  fps)} and saved 
-000025d0: 696e 2064 6972 6563 746f 7279 207b 7361  in directory {sa
-000025e0: 7665 5f70 6174 687d 272c 0a20 2020 2020  ve_path}',.     
-000025f0: 2020 2065 6c61 7073 6564 5f74 696d 653d     elapsed_time=
-00002600: 7469 6d65 722e 656c 6170 7365 645f 7469  timer.elapsed_ti
-00002610: 6d65 5f73 7472 2c0a 2020 2020 2020 2020  me_str,.        
-00002620: 736f 7572 6365 3d63 6861 6e67 655f 7369  source=change_si
-00002630: 6e67 6c65 5f76 6964 656f 5f66 7073 2e5f  ngle_video_fps._
-00002640: 5f6e 616d 655f 5f2c 0a20 2020 2029 0a0a  _name__,.    )..
-00002650: 0a64 6566 2063 6861 6e67 655f 6670 735f  .def change_fps_
-00002660: 6f66 5f6d 756c 7469 706c 655f 7669 6465  of_multiple_vide
-00002670: 6f73 280a 2020 2020 6469 7265 6374 6f72  os(.    director
-00002680: 793a 2055 6e69 6f6e 5b73 7472 2c20 6f73  y: Union[str, os
-00002690: 2e50 6174 684c 696b 655d 2c20 6670 733a  .PathLike], fps:
-000026a0: 2069 6e74 2c20 6770 753a 204f 7074 696f   int, gpu: Optio
-000026b0: 6e61 6c5b 626f 6f6c 5d20 3d20 4661 6c73  nal[bool] = Fals
-000026c0: 650a 2920 2d3e 204e 6f6e 653a 0a20 2020  e.) -> None:.   
-000026d0: 2022 2222 0a20 2020 2043 6861 6e67 6520   """.    Change 
-000026e0: 7468 6520 6670 7320 6f66 2061 6c6c 2076  the fps of all v
-000026f0: 6964 656f 2066 696c 6573 2069 6e20 6120  ideo files in a 
-00002700: 666f 6c64 6572 2e20 5265 7375 6c74 7320  folder. Results 
-00002710: 6172 6520 7374 6f72 6564 2069 6e20 7468  are stored in th
-00002720: 6520 7361 6d65 2064 6972 6563 746f 7279  e same directory
-00002730: 2061 7320 696e 2074 6865 2069 6e70 7574   as in the input
-00002740: 2066 696c 6573 2077 6974 680a 2020 2020   files with.    
-00002750: 7468 6520 7375 6666 6978 2060 605f 6670  the suffix ``_fp
-00002760: 735f 6e65 775f 6670 7360 602e 0a0a 2020  s_new_fps``...  
-00002770: 2020 3a70 6172 616d 6574 6572 2055 6e69    :parameter Uni
-00002780: 6f6e 5b73 7472 2c20 6f73 2e50 6174 684c  on[str, os.PathL
-00002790: 696b 655d 2064 6972 6563 746f 7279 3a20  ike] directory: 
-000027a0: 5061 7468 2074 6f20 7669 6465 6f20 6669  Path to video fi
-000027b0: 6c65 2064 6972 6563 746f 7279 0a20 2020  le directory.   
-000027c0: 203a 7061 7261 6d65 7465 7220 696e 7420   :parameter int 
-000027d0: 6670 733a 2046 7073 206f 6620 7468 6520  fps: Fps of the 
-000027e0: 6e65 7720 7669 6465 6f20 6669 6c65 732e  new video files.
-000027f0: 0a20 2020 203a 7061 7261 6d65 7465 7220  .    :parameter 
-00002800: 4f70 7469 6f6e 616c 5b62 6f6f 6c5d 2067  Optional[bool] g
-00002810: 7075 3a20 4966 2054 7275 652c 2075 7365  pu: If True, use
-00002820: 204e 5649 4445 4120 4750 5520 636f 6465   NVIDEA GPU code
-00002830: 6373 2e20 4465 6661 756c 7420 4661 6c73  cs. Default Fals
-00002840: 652e 0a0a 2020 2020 3a65 7861 6d70 6c65  e...    :example
-00002850: 3a0a 2020 2020 3e3e 3e20 5f20 3d20 6368  :.    >>> _ = ch
-00002860: 616e 6765 5f66 7073 5f6f 665f 6d75 6c74  ange_fps_of_mult
-00002870: 6970 6c65 5f76 6964 656f 7328 6469 7265  iple_videos(dire
-00002880: 6374 6f72 793d 2770 726f 6a65 6374 5f66  ctory='project_f
-00002890: 6f6c 6465 722f 7669 6465 6f73 2f56 6964  older/videos/Vid
-000028a0: 656f 5f31 2e6d 7034 272c 2066 7073 3d31  eo_1.mp4', fps=1
-000028b0: 3529 0a20 2020 2022 2222 0a0a 2020 2020  5).    """..    
-000028c0: 7469 6d65 7220 3d20 5369 6d62 6154 696d  timer = SimbaTim
-000028d0: 6572 2873 7461 7274 3d54 7275 6529 0a20  er(start=True). 
-000028e0: 2020 2069 6620 6770 7520 616e 6420 6e6f     if gpu and no
-000028f0: 7420 6368 6563 6b5f 6e76 6964 6561 5f67  t check_nvidea_g
-00002900: 7075 5f61 7661 696c 6162 6c65 2829 3a0a  pu_available():.
-00002910: 2020 2020 2020 2020 7261 6973 6520 4646          raise FF
-00002920: 4d50 4547 436f 6465 6347 5055 4572 726f  MPEGCodecGPUErro
-00002930: 7228 0a20 2020 2020 2020 2020 2020 206d  r(.            m
-00002940: 7367 3d22 4e6f 2047 5055 2066 6f75 6e64  sg="No GPU found
-00002950: 2028 6173 2065 7661 6c75 6174 6564 2062   (as evaluated b
-00002960: 7920 6e76 6964 6561 2d73 6d69 2072 6574  y nvidea-smi ret
-00002970: 7572 6e69 6e67 204e 6f6e 6529 222c 0a20  urning None)",. 
-00002980: 2020 2020 2020 2020 2020 2073 6f75 7263             sourc
-00002990: 653d 6368 616e 6765 5f66 7073 5f6f 665f  e=change_fps_of_
-000029a0: 6d75 6c74 6970 6c65 5f76 6964 656f 732e  multiple_videos.
-000029b0: 5f5f 6e61 6d65 5f5f 2c0a 2020 2020 2020  __name__,.      
-000029c0: 2020 290a 2020 2020 6966 206e 6f74 206f    ).    if not o
-000029d0: 732e 7061 7468 2e69 7364 6972 2864 6972  s.path.isdir(dir
-000029e0: 6563 746f 7279 293a 0a20 2020 2020 2020  ectory):.       
-000029f0: 2072 6169 7365 204e 6f74 4469 7265 6374   raise NotDirect
-00002a00: 6f72 7945 7272 6f72 280a 2020 2020 2020  oryError(.      
-00002a10: 2020 2020 2020 6d73 673d 2253 494d 4241        msg="SIMBA
-00002a20: 2045 5252 4f52 3a20 7b7d 2069 7320 6e6f   ERROR: {} is no
-00002a30: 7420 6120 7661 6c69 6420 6469 7265 6374  t a valid direct
-00002a40: 6f72 7922 2e66 6f72 6d61 7428 6469 7265  ory".format(dire
-00002a50: 6374 6f72 7929 2c0a 2020 2020 2020 2020  ctory),.        
-00002a60: 2020 2020 736f 7572 6365 3d63 6861 6e67      source=chang
-00002a70: 655f 6670 735f 6f66 5f6d 756c 7469 706c  e_fps_of_multipl
-00002a80: 655f 7669 6465 6f73 2e5f 5f6e 616d 655f  e_videos.__name_
-00002a90: 5f2c 0a20 2020 2020 2020 2029 0a20 2020  _,.        ).   
-00002aa0: 2063 6865 636b 5f69 6e74 286e 616d 653d   check_int(name=
-00002ab0: 224e 6577 2066 7073 222c 2076 616c 7565  "New fps", value
-00002ac0: 3d66 7073 290a 2020 2020 7669 6465 6f5f  =fps).    video_
-00002ad0: 7061 7468 7320 3d20 5b5d 0a20 2020 2066  paths = [].    f
-00002ae0: 696c 655f 7061 7468 735f 696e 5f66 6f6c  ile_paths_in_fol
-00002af0: 6465 7220 3d20 5b66 2066 6f72 2066 2069  der = [f for f i
-00002b00: 6e20 676c 6f62 2e67 6c6f 6228 6469 7265  n glob.glob(dire
-00002b10: 6374 6f72 7920 2b20 222f 2a22 2920 6966  ctory + "/*") if
-00002b20: 206f 732e 7061 7468 2e69 7366 696c 6528   os.path.isfile(
-00002b30: 6629 5d0a 2020 2020 666f 7220 6669 6c65  f)].    for file
-00002b40: 5f70 6174 6820 696e 2066 696c 655f 7061  _path in file_pa
-00002b50: 7468 735f 696e 5f66 6f6c 6465 723a 0a20  ths_in_folder:. 
-00002b60: 2020 2020 2020 205f 2c20 5f2c 2065 7874         _, _, ext
-00002b70: 203d 2067 6574 5f66 6e5f 6578 7428 6669   = get_fn_ext(fi
-00002b80: 6c65 7061 7468 3d66 696c 655f 7061 7468  lepath=file_path
-00002b90: 290a 2020 2020 2020 2020 6966 2065 7874  ).        if ext
-00002ba0: 2e6c 6f77 6572 2829 2069 6e20 5b22 2e61  .lower() in [".a
-00002bb0: 7669 222c 2022 2e6d 7034 222c 2022 2e6d  vi", ".mp4", ".m
-00002bc0: 6f76 222c 2022 2e66 6c76 225d 3a0a 2020  ov", ".flv"]:.  
-00002bd0: 2020 2020 2020 2020 2020 7669 6465 6f5f            video_
-00002be0: 7061 7468 732e 6170 7065 6e64 2866 696c  paths.append(fil
-00002bf0: 655f 7061 7468 290a 2020 2020 6966 206c  e_path).    if l
-00002c00: 656e 2876 6964 656f 5f70 6174 6873 2920  en(video_paths) 
-00002c10: 3c20 313a 0a20 2020 2020 2020 2072 6169  < 1:.        rai
-00002c20: 7365 204e 6f46 696c 6573 466f 756e 6445  se NoFilesFoundE
-00002c30: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00002c40: 2020 6d73 673d 2253 494d 4241 2045 5252    msg="SIMBA ERR
-00002c50: 4f52 3a20 4e6f 2066 696c 6573 2077 6974  OR: No files wit
-00002c60: 6820 2e6d 7034 2c20 2e61 7669 2c20 2e6d  h .mp4, .avi, .m
-00002c70: 6f76 2c20 2e66 6c76 2066 696c 6520 656e  ov, .flv file en
-00002c80: 6469 6e67 2066 6f75 6e64 2069 6e20 7468  ding found in th
-00002c90: 6520 7b7d 2064 6972 6563 746f 7279 222e  e {} directory".
-00002ca0: 666f 726d 6174 280a 2020 2020 2020 2020  format(.        
-00002cb0: 2020 2020 2020 2020 6469 7265 6374 6f72          director
-00002cc0: 790a 2020 2020 2020 2020 2020 2020 292c  y.            ),
-00002cd0: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
-00002ce0: 7263 653d 6368 616e 6765 5f66 7073 5f6f  rce=change_fps_o
-00002cf0: 665f 6d75 6c74 6970 6c65 5f76 6964 656f  f_multiple_video
-00002d00: 732e 5f5f 6e61 6d65 5f5f 2c0a 2020 2020  s.__name__,.    
-00002d10: 2020 2020 290a 2020 2020 666f 7220 6669      ).    for fi
-00002d20: 6c65 5f63 6e74 2c20 6669 6c65 5f70 6174  le_cnt, file_pat
-00002d30: 6820 696e 2065 6e75 6d65 7261 7465 2876  h in enumerate(v
-00002d40: 6964 656f 5f70 6174 6873 293a 0a20 2020  ideo_paths):.   
-00002d50: 2020 2020 2064 6972 5f6e 616d 652c 2066       dir_name, f
-00002d60: 696c 655f 6e61 6d65 2c20 6578 7420 3d20  ile_name, ext = 
-00002d70: 6765 745f 666e 5f65 7874 2866 696c 6570  get_fn_ext(filep
-00002d80: 6174 683d 6669 6c65 5f70 6174 6829 0a20  ath=file_path). 
-00002d90: 2020 2020 2020 2070 7269 6e74 2822 436f         print("Co
-00002da0: 6e76 6572 7469 6e67 2046 5053 2066 6f72  nverting FPS for
-00002db0: 207b 7d2e 2e2e 222e 666f 726d 6174 2866   {}...".format(f
-00002dc0: 696c 655f 6e61 6d65 2929 0a20 2020 2020  ile_name)).     
-00002dd0: 2020 2073 6176 655f 7061 7468 203d 206f     save_path = o
-00002de0: 732e 7061 7468 2e6a 6f69 6e28 0a20 2020  s.path.join(.   
-00002df0: 2020 2020 2020 2020 2064 6972 5f6e 616d           dir_nam
-00002e00: 652c 2066 696c 655f 6e61 6d65 202b 2022  e, file_name + "
-00002e10: 5f66 7073 5f7b 7d7b 7d22 2e66 6f72 6d61  _fps_{}{}".forma
-00002e20: 7428 7374 7228 6670 7329 2c20 7374 7228  t(str(fps), str(
-00002e30: 6578 7429 290a 2020 2020 2020 2020 290a  ext)).        ).
-00002e40: 2020 2020 2020 2020 6966 2067 7075 3a0a          if gpu:.
-00002e50: 2020 2020 2020 2020 2020 2020 636f 6d6d              comm
-00002e60: 616e 6420 3d20 6627 6666 6d70 6567 202d  and = f'ffmpeg -
-00002e70: 6877 6163 6365 6c20 6175 746f 202d 633a  hwaccel auto -c:
-00002e80: 7620 6832 3634 5f63 7576 6964 202d 6920  v h264_cuvid -i 
-00002e90: 227b 6669 6c65 5f70 6174 687d 2220 2d76  "{file_path}" -v
-00002ea0: 6620 2266 7073 3d7b 6670 737d 2220 2d63  f "fps={fps}" -c
-00002eb0: 3a76 2068 3236 345f 6e76 656e 6320 2d63  :v h264_nvenc -c
-00002ec0: 3a61 2063 6f70 7920 227b 7361 7665 5f70  :a copy "{save_p
-00002ed0: 6174 687d 2220 2d79 270a 2020 2020 2020  ath}" -y'.      
-00002ee0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00002ef0: 2020 2020 636f 6d6d 616e 6420 3d20 280a      command = (.
-00002f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002f10: 7374 7228 2266 666d 7065 6720 2d69 2022  str("ffmpeg -i "
-00002f20: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00002f30: 2020 2b20 7374 7228 6669 6c65 5f70 6174    + str(file_pat
-00002f40: 6829 0a20 2020 2020 2020 2020 2020 2020  h).             
-00002f50: 2020 202b 2022 202d 6669 6c74 6572 3a76     + " -filter:v
-00002f60: 2066 7073 3d66 7073 3d22 0a20 2020 2020   fps=fps=".     
-00002f70: 2020 2020 2020 2020 2020 202b 2073 7472             + str
-00002f80: 2866 7073 290a 2020 2020 2020 2020 2020  (fps).          
-00002f90: 2020 2020 2020 2b20 2220 220a 2020 2020        + " ".    
-00002fa0: 2020 2020 2020 2020 2020 2020 2b20 2722              + '"
-00002fb0: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
-00002fc0: 2020 2b20 7361 7665 5f70 6174 680a 2020    + save_path.  
-00002fd0: 2020 2020 2020 2020 2020 2020 2020 2b20                + 
-00002fe0: 2722 202d 7927 0a20 2020 2020 2020 2020  '" -y'.         
-00002ff0: 2020 2029 0a20 2020 2020 2020 2073 7562     ).        sub
-00003000: 7072 6f63 6573 732e 6361 6c6c 2863 6f6d  process.call(com
-00003010: 6d61 6e64 2c20 7368 656c 6c3d 5472 7565  mand, shell=True
-00003020: 290a 2020 2020 2020 2020 7072 696e 7428  ).        print(
-00003030: 2256 6964 656f 207b 7d20 636f 6d70 6c65  "Video {} comple
-00003040: 7465 2e2e 2e22 2e66 6f72 6d61 7428 6669  te...".format(fi
-00003050: 6c65 5f6e 616d 6529 290a 2020 2020 7469  le_name)).    ti
-00003060: 6d65 722e 7374 6f70 5f74 696d 6572 2829  mer.stop_timer()
-00003070: 0a20 2020 2073 7464 6f75 745f 7375 6363  .    stdout_succ
-00003080: 6573 7328 0a20 2020 2020 2020 206d 7367  ess(.        msg
-00003090: 3d66 2253 494d 4241 2043 4f4d 504c 4554  =f"SIMBA COMPLET
-000030a0: 453a 2046 5053 206f 6620 7b73 7472 286c  E: FPS of {str(l
-000030b0: 656e 2876 6964 656f 5f70 6174 6873 2929  en(video_paths))
-000030c0: 7d20 7669 6465 6f28 7329 2063 6861 6e67  } video(s) chang
-000030d0: 6564 2074 6f20 7b73 7472 2866 7073 297d  ed to {str(fps)}
-000030e0: 222c 0a20 2020 2020 2020 2065 6c61 7073  ",.        elaps
-000030f0: 6564 5f74 696d 653d 7469 6d65 722e 656c  ed_time=timer.el
-00003100: 6170 7365 645f 7469 6d65 5f73 7472 2c0a  apsed_time_str,.
-00003110: 2020 2020 2020 2020 736f 7572 6365 3d63          source=c
-00003120: 6861 6e67 655f 6670 735f 6f66 5f6d 756c  hange_fps_of_mul
-00003130: 7469 706c 655f 7669 6465 6f73 2e5f 5f6e  tiple_videos.__n
-00003140: 616d 655f 5f2c 0a20 2020 2029 0a0a 0a64  ame__,.    )...d
-00003150: 6566 2063 6f6e 7665 7274 5f76 6964 656f  ef convert_video
-00003160: 5f70 6f77 6572 706f 696e 745f 636f 6d70  _powerpoint_comp
-00003170: 6174 6962 6c65 5f66 6f72 6d61 7428 0a20  atible_format(. 
-00003180: 2020 2066 696c 655f 7061 7468 3a20 556e     file_path: Un
-00003190: 696f 6e5b 7374 722c 206f 732e 5061 7468  ion[str, os.Path
-000031a0: 4c69 6b65 5d2c 2067 7075 3a20 4f70 7469  Like], gpu: Opti
-000031b0: 6f6e 616c 5b62 6f6f 6c5d 203d 2046 616c  onal[bool] = Fal
-000031c0: 7365 0a29 202d 3e20 4e6f 6e65 3a0a 2020  se.) -> None:.  
-000031d0: 2020 2222 220a 2020 2020 4372 6561 7465    """.    Create
-000031e0: 204d 5320 506f 7765 7250 6f69 6e74 2063   MS PowerPoint c
-000031f0: 6f6d 7061 7469 626c 6520 636f 7079 206f  ompatible copy o
-00003200: 6620 6120 7669 6465 6f20 6669 6c65 2e20  f a video file. 
-00003210: 5468 6520 7265 7375 6c74 2069 7320 7374  The result is st
-00003220: 6f72 6564 2069 6e20 7468 6520 7361 6d65  ored in the same
-00003230: 2064 6972 6563 746f 7279 2061 7320 7468   directory as th
-00003240: 650a 2020 2020 696e 7075 7420 6669 6c65  e.    input file
-00003250: 2077 6974 6820 7468 6520 6060 5f70 6f77   with the ``_pow
-00003260: 6572 706f 696e 7472 6561 6479 6060 2073  erpointready`` s
-00003270: 7566 6669 782e 0a0a 2020 2020 3a70 6172  uffix...    :par
-00003280: 616d 6574 6572 2055 6e69 6f6e 5b73 7472  ameter Union[str
-00003290: 2c20 6f73 2e50 6174 684c 696b 655d 2066  , os.PathLike] f
-000032a0: 696c 655f 7061 7468 3a20 5061 7468 2074  ile_path: Path t
-000032b0: 6f20 7669 6465 6f20 6669 6c65 2e0a 2020  o video file..  
-000032c0: 2020 3a70 6172 616d 6574 6572 204f 7074    :parameter Opt
-000032d0: 696f 6e61 6c5b 626f 6f6c 5d20 6770 753a  ional[bool] gpu:
-000032e0: 2049 6620 5472 7565 2c20 7573 6520 4e56   If True, use NV
-000032f0: 4944 4541 2047 5055 2063 6f64 6563 732e  IDEA GPU codecs.
-00003300: 2044 6566 6175 6c74 2046 616c 7365 2e0a   Default False..
-00003310: 0a20 2020 203a 6578 616d 706c 653a 0a20  .    :example:. 
-00003320: 2020 203e 3e3e 205f 203d 2063 6f6e 7665     >>> _ = conve
-00003330: 7274 5f76 6964 656f 5f70 6f77 6572 706f  rt_video_powerpo
-00003340: 696e 745f 636f 6d70 6174 6962 6c65 5f66  int_compatible_f
-00003350: 6f72 6d61 7428 6669 6c65 5f70 6174 683d  ormat(file_path=
-00003360: 2770 726f 6a65 6374 5f66 6f6c 6465 722f  'project_folder/
-00003370: 7669 6465 6f73 2f56 6964 656f 5f31 2e6d  videos/Video_1.m
-00003380: 7034 2729 0a20 2020 2022 2222 0a20 2020  p4').    """.   
-00003390: 2069 6620 6770 7520 616e 6420 6e6f 7420   if gpu and not 
-000033a0: 6368 6563 6b5f 6e76 6964 6561 5f67 7075  check_nvidea_gpu
-000033b0: 5f61 7661 696c 6162 6c65 2829 3a0a 2020  _available():.  
-000033c0: 2020 2020 2020 7261 6973 6520 4646 4d50        raise FFMP
-000033d0: 4547 436f 6465 6347 5055 4572 726f 7228  EGCodecGPUError(
-000033e0: 0a20 2020 2020 2020 2020 2020 206d 7367  .            msg
-000033f0: 3d22 4e6f 2047 5055 2066 6f75 6e64 2028  ="No GPU found (
-00003400: 6173 2065 7661 6c75 6174 6564 2062 7920  as evaluated by 
-00003410: 6e76 6964 6561 2d73 6d69 2072 6574 7572  nvidea-smi retur
-00003420: 6e69 6e67 204e 6f6e 6529 222c 0a20 2020  ning None)",.   
-00003430: 2020 2020 2020 2020 2073 6f75 7263 653d           source=
-00003440: 636f 6e76 6572 745f 7669 6465 6f5f 706f  convert_video_po
-00003450: 7765 7270 6f69 6e74 5f63 6f6d 7061 7469  werpoint_compati
-00003460: 626c 655f 666f 726d 6174 2e5f 5f6e 616d  ble_format.__nam
-00003470: 655f 5f2c 0a20 2020 2020 2020 2029 0a20  e__,.        ). 
-00003480: 2020 2074 696d 6572 203d 2053 696d 6261     timer = Simba
-00003490: 5469 6d65 7228 7374 6172 743d 5472 7565  Timer(start=True
-000034a0: 290a 2020 2020 6368 6563 6b5f 6669 6c65  ).    check_file
-000034b0: 5f65 7869 7374 5f61 6e64 5f72 6561 6461  _exist_and_reada
-000034c0: 626c 6528 6669 6c65 5f70 6174 683d 6669  ble(file_path=fi
-000034d0: 6c65 5f70 6174 6829 0a20 2020 2064 6972  le_path).    dir
-000034e0: 2c20 6669 6c65 5f6e 616d 652c 2065 7874  , file_name, ext
-000034f0: 203d 2067 6574 5f66 6e5f 6578 7428 6669   = get_fn_ext(fi
-00003500: 6c65 7061 7468 3d66 696c 655f 7061 7468  lepath=file_path
-00003510: 290a 2020 2020 7361 7665 5f6e 616d 6520  ).    save_name 
-00003520: 3d20 6f73 2e70 6174 682e 6a6f 696e 2864  = os.path.join(d
-00003530: 6972 2c20 6669 6c65 5f6e 616d 6520 2b20  ir, file_name + 
-00003540: 225f 706f 7765 7270 6f69 6e74 7265 6164  "_powerpointread
-00003550: 792e 6d70 3422 290a 2020 2020 6966 206f  y.mp4").    if o
-00003560: 732e 7061 7468 2e69 7366 696c 6528 7361  s.path.isfile(sa
-00003570: 7665 5f6e 616d 6529 3a0a 2020 2020 2020  ve_name):.      
-00003580: 2020 7261 6973 6520 4669 6c65 4578 6973    raise FileExis
-00003590: 7445 7272 6f72 280a 2020 2020 2020 2020  tError(.        
-000035a0: 2020 2020 6d73 673d 2253 494d 4241 2045      msg="SIMBA E
-000035b0: 5252 4f52 3a20 5468 6520 6f75 7466 696c  RROR: The outfil
-000035c0: 6520 6669 6c65 2061 6c72 6561 6479 2065  e file already e
-000035d0: 7869 7374 3a20 7b7d 2e22 2e66 6f72 6d61  xist: {}.".forma
-000035e0: 7428 7361 7665 5f6e 616d 6529 2c0a 2020  t(save_name),.  
-000035f0: 2020 2020 2020 2020 2020 736f 7572 6365            source
-00003600: 3d63 6f6e 7665 7274 5f76 6964 656f 5f70  =convert_video_p
-00003610: 6f77 6572 706f 696e 745f 636f 6d70 6174  owerpoint_compat
-00003620: 6962 6c65 5f66 6f72 6d61 742e 5f5f 6e61  ible_format.__na
-00003630: 6d65 5f5f 2c0a 2020 2020 2020 2020 290a  me__,.        ).
-00003640: 2020 2020 6966 2067 7075 3a0a 2020 2020      if gpu:.    
-00003650: 2020 2020 636f 6d6d 616e 6420 3d20 2766      command = 'f
-00003660: 666d 7065 6720 2d68 7761 6363 656c 2061  fmpeg -hwaccel a
-00003670: 7574 6f20 2d63 3a76 2068 3236 345f 6375  uto -c:v h264_cu
-00003680: 7669 6420 2d69 2022 7b7d 2220 2d63 3a76  vid -i "{}" -c:v
-00003690: 2068 3236 345f 6e76 656e 6320 2d70 7265   h264_nvenc -pre
-000036a0: 7365 7420 736c 6f77 202d 7072 6f66 696c  set slow -profil
-000036b0: 653a 7620 6869 6768 202d 6c65 7665 6c3a  e:v high -level:
-000036c0: 7620 342e 3020 2d70 6978 5f66 6d74 2079  v 4.0 -pix_fmt y
-000036d0: 7576 3432 3070 202d 6372 6620 3232 202d  uv420p -crf 22 -
-000036e0: 633a 6120 6161 6320 227b 7d22 272e 666f  c:a aac "{}"'.fo
-000036f0: 726d 6174 280a 2020 2020 2020 2020 2020  rmat(.          
-00003700: 2020 6669 6c65 5f70 6174 682c 2073 6176    file_path, sav
-00003710: 655f 6e61 6d65 0a20 2020 2020 2020 2029  e_name.        )
-00003720: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
-00003730: 2020 2063 6f6d 6d61 6e64 203d 2028 0a20     command = (. 
-00003740: 2020 2020 2020 2020 2020 2073 7472 2822             str("
-00003750: 6666 6d70 6567 202d 6920 2229 0a20 2020  ffmpeg -i ").   
-00003760: 2020 2020 2020 2020 202b 2027 2227 0a20           + '"'. 
-00003770: 2020 2020 2020 2020 2020 202b 2073 7472             + str
-00003780: 2866 696c 655f 7061 7468 290a 2020 2020  (file_path).    
-00003790: 2020 2020 2020 2020 2b20 2722 270a 2020          + '"'.  
-000037a0: 2020 2020 2020 2020 2020 2b20 2220 2d63            + " -c
-000037b0: 3a76 206c 6962 7832 3634 202d 7072 6573  :v libx264 -pres
-000037c0: 6574 2073 6c6f 7720 202d 7072 6f66 696c  et slow  -profil
-000037d0: 653a 7620 6869 6768 202d 6c65 7665 6c3a  e:v high -level:
-000037e0: 7620 342e 3020 2d70 6978 5f66 6d74 2079  v 4.0 -pix_fmt y
-000037f0: 7576 3432 3070 202d 6372 6620 3232 202d  uv420p -crf 22 -
-00003800: 636f 6465 633a 6120 6161 6320 220a 2020  codec:a aac ".  
-00003810: 2020 2020 2020 2020 2020 2b20 2722 270a            + '"'.
-00003820: 2020 2020 2020 2020 2020 2020 2b20 7361              + sa
-00003830: 7665 5f6e 616d 650a 2020 2020 2020 2020  ve_name.        
-00003840: 2020 2020 2b20 2722 270a 2020 2020 2020      + '"'.      
-00003850: 2020 290a 2020 2020 7072 696e 7428 2243    ).    print("C
-00003860: 7265 6174 696e 6720 7669 6465 6f20 696e  reating video in
-00003870: 2070 6f77 6572 706f 696e 7420 636f 6d70   powerpoint comp
-00003880: 6174 6962 6c65 2066 6f72 6d61 742e 2e2e  atible format...
-00003890: 2022 290a 2020 2020 7375 6270 726f 6365   ").    subproce
-000038a0: 7373 2e63 616c 6c28 636f 6d6d 616e 642c  ss.call(command,
-000038b0: 2073 6865 6c6c 3d54 7275 652c 2073 7464   shell=True, std
-000038c0: 6f75 743d 7375 6270 726f 6365 7373 2e50  out=subprocess.P
-000038d0: 4950 4529 0a20 2020 2074 696d 6572 2e73  IPE).    timer.s
-000038e0: 746f 705f 7469 6d65 7228 290a 2020 2020  top_timer().    
-000038f0: 7374 646f 7574 5f73 7563 6365 7373 280a  stdout_success(.
-00003900: 2020 2020 2020 2020 6d73 673d 6622 5349          msg=f"SI
-00003910: 4d42 4120 434f 4d50 4c45 5445 3a20 5669  MBA COMPLETE: Vi
-00003920: 6465 6f20 636f 6e76 6572 7465 6421 207b  deo converted! {
-00003930: 7361 7665 5f6e 616d 657d 2067 656e 6572  save_name} gener
-00003940: 6174 6564 2122 2c0a 2020 2020 2020 2020  ated!",.        
-00003950: 656c 6170 7365 645f 7469 6d65 3d74 696d  elapsed_time=tim
-00003960: 6572 2e65 6c61 7073 6564 5f74 696d 655f  er.elapsed_time_
-00003970: 7374 722c 0a20 2020 2020 2020 2073 6f75  str,.        sou
-00003980: 7263 653d 636f 6e76 6572 745f 7669 6465  rce=convert_vide
-00003990: 6f5f 706f 7765 7270 6f69 6e74 5f63 6f6d  o_powerpoint_com
-000039a0: 7061 7469 626c 655f 666f 726d 6174 2e5f  patible_format._
-000039b0: 5f6e 616d 655f 5f2c 0a20 2020 2029 0a0a  _name__,.    )..
-000039c0: 0a23 2063 6f6e 7665 7274 5f76 6964 656f  .# convert_video
-000039d0: 5f70 6f77 6572 706f 696e 745f 636f 6d70  _powerpoint_comp
-000039e0: 6174 6962 6c65 5f66 6f72 6d61 7428 6669  atible_format(fi
-000039f0: 6c65 5f70 6174 683d 7222 433a 5c55 7365  le_path=r"C:\Use
-00003a00: 7273 5c4e 6170 655f 436f 6d70 7574 6572  rs\Nape_Computer
-00003a10: 5f32 5c44 6573 6b74 6f70 5c74 6573 745f  _2\Desktop\test_
-00003a20: 7669 6465 6f73 5c42 6f78 315f 504d 325f  videos\Box1_PM2_
-00003a30: 6461 795f 355f 3230 3231 3131 3034 5431  day_5_20211104T1
-00003a40: 3731 3032 312e 6d70 3422 2c20 6770 753d  71021.mp4", gpu=
-00003a50: 5472 7565 290a 0a0a 6465 6620 636f 6e76  True)...def conv
-00003a60: 6572 745f 746f 5f6d 7034 280a 2020 2020  ert_to_mp4(.    
-00003a70: 6669 6c65 5f70 6174 683a 2055 6e69 6f6e  file_path: Union
-00003a80: 5b73 7472 2c20 6f73 2e50 6174 684c 696b  [str, os.PathLik
-00003a90: 655d 2c20 6770 753a 204f 7074 696f 6e61  e], gpu: Optiona
-00003aa0: 6c5b 626f 6f6c 5d20 3d20 4661 6c73 650a  l[bool] = False.
-00003ab0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2022  ) -> None:.    "
-00003ac0: 2222 0a20 2020 2043 6f6e 7665 7274 2061  "".    Convert a
-00003ad0: 2076 6964 656f 2066 696c 6520 746f 206d   video file to m
-00003ae0: 7034 2066 6f72 6d61 742e 2054 6865 2072  p4 format. The r
-00003af0: 6573 756c 7420 6973 2073 746f 7265 6420  esult is stored 
-00003b00: 696e 2074 6865 2073 616d 6520 6469 7265  in the same dire
-00003b10: 6374 6f72 7920 6173 2074 6865 0a20 2020  ctory as the.   
-00003b20: 2069 6e70 7574 2066 696c 6520 7769 7468   input file with
-00003b30: 2074 6865 2060 605f 636f 6e76 6572 7465   the ``_converte
-00003b40: 642e 6d70 3460 6020 7375 6666 6978 2e0a  d.mp4`` suffix..
-00003b50: 0a20 2020 203a 7061 7261 6d65 7465 7220  .    :parameter 
-00003b60: 556e 696f 6e5b 7374 722c 206f 732e 5061  Union[str, os.Pa
-00003b70: 7468 4c69 6b65 5d20 6669 6c65 5f70 6174  thLike] file_pat
-00003b80: 683a 2050 6174 6820 746f 2076 6964 656f  h: Path to video
-00003b90: 2066 696c 652e 0a20 2020 203a 7061 7261   file..    :para
-00003ba0: 6d65 7465 7220 4f70 7469 6f6e 616c 5b62  meter Optional[b
-00003bb0: 6f6f 6c5d 2067 7075 3a20 4966 2054 7275  ool] gpu: If Tru
-00003bc0: 652c 2075 7365 204e 5649 4445 4120 4750  e, use NVIDEA GP
-00003bd0: 5520 636f 6465 6373 2e20 4465 6661 756c  U codecs. Defaul
-00003be0: 7420 4661 6c73 652e 0a0a 2020 2020 3a65  t False...    :e
-00003bf0: 7861 6d70 6c65 3a0a 2020 2020 3e3e 3e20  xample:.    >>> 
-00003c00: 5f20 3d20 636f 6e76 6572 745f 746f 5f6d  _ = convert_to_m
-00003c10: 7034 2866 696c 655f 7061 7468 3d27 7072  p4(file_path='pr
-00003c20: 6f6a 6563 745f 666f 6c64 6572 2f76 6964  oject_folder/vid
-00003c30: 656f 732f 5669 6465 6f5f 312e 6176 6927  eos/Video_1.avi'
-00003c40: 290a 2020 2020 2222 220a 0a20 2020 2074  ).    """..    t
-00003c50: 696d 6572 203d 2053 696d 6261 5469 6d65  imer = SimbaTime
-00003c60: 7228 7374 6172 743d 5472 7565 290a 2020  r(start=True).  
-00003c70: 2020 6966 2067 7075 2061 6e64 206e 6f74    if gpu and not
-00003c80: 2063 6865 636b 5f6e 7669 6465 615f 6770   check_nvidea_gp
-00003c90: 755f 6176 6169 6c61 626c 6528 293a 0a20  u_available():. 
-00003ca0: 2020 2020 2020 2072 6169 7365 2046 464d         raise FFM
-00003cb0: 5045 4743 6f64 6563 4750 5545 7272 6f72  PEGCodecGPUError
-00003cc0: 280a 2020 2020 2020 2020 2020 2020 6d73  (.            ms
-00003cd0: 673d 224e 6f20 4750 5520 666f 756e 6420  g="No GPU found 
-00003ce0: 2861 7320 6576 616c 7561 7465 6420 6279  (as evaluated by
-00003cf0: 206e 7669 6465 612d 736d 6920 7265 7475   nvidea-smi retu
-00003d00: 726e 696e 6720 4e6f 6e65 2922 2c0a 2020  rning None)",.  
-00003d10: 2020 2020 2020 2020 2020 736f 7572 6365            source
-00003d20: 3d63 6f6e 7665 7274 5f74 6f5f 6d70 342e  =convert_to_mp4.
-00003d30: 5f5f 6e61 6d65 5f5f 2c0a 2020 2020 2020  __name__,.      
-00003d40: 2020 290a 2020 2020 6368 6563 6b5f 6669    ).    check_fi
-00003d50: 6c65 5f65 7869 7374 5f61 6e64 5f72 6561  le_exist_and_rea
-00003d60: 6461 626c 6528 6669 6c65 5f70 6174 683d  dable(file_path=
-00003d70: 6669 6c65 5f70 6174 6829 0a20 2020 2064  file_path).    d
-00003d80: 6972 2c20 6669 6c65 5f6e 616d 652c 2065  ir, file_name, e
-00003d90: 7874 203d 2067 6574 5f66 6e5f 6578 7428  xt = get_fn_ext(
-00003da0: 6669 6c65 7061 7468 3d66 696c 655f 7061  filepath=file_pa
-00003db0: 7468 290a 2020 2020 7361 7665 5f6e 616d  th).    save_nam
-00003dc0: 6520 3d20 6f73 2e70 6174 682e 6a6f 696e  e = os.path.join
-00003dd0: 2864 6972 2c20 6669 6c65 5f6e 616d 6520  (dir, file_name 
-00003de0: 2b20 225f 636f 6e76 6572 7465 642e 6d70  + "_converted.mp
-00003df0: 3422 290a 2020 2020 6966 206f 732e 7061  4").    if os.pa
-00003e00: 7468 2e69 7366 696c 6528 7361 7665 5f6e  th.isfile(save_n
-00003e10: 616d 6529 3a0a 2020 2020 2020 2020 7261  ame):.        ra
-00003e20: 6973 6520 4669 6c65 4578 6973 7445 7272  ise FileExistErr
-00003e30: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-00003e40: 6d73 673d 2253 494d 4241 2045 5252 4f52  msg="SIMBA ERROR
-00003e50: 3a20 5468 6520 6f75 7466 696c 6520 6669  : The outfile fi
-00003e60: 6c65 2061 6c72 6561 6479 2065 7869 7374  le already exist
-00003e70: 3a20 7b7d 2e22 2e66 6f72 6d61 7428 7361  : {}.".format(sa
-00003e80: 7665 5f6e 616d 6529 2c0a 2020 2020 2020  ve_name),.      
-00003e90: 2020 2020 2020 736f 7572 6365 3d63 6f6e        source=con
-00003ea0: 7665 7274 5f74 6f5f 6d70 342e 5f5f 6e61  vert_to_mp4.__na
-00003eb0: 6d65 5f5f 2c0a 2020 2020 2020 2020 290a  me__,.        ).
-00003ec0: 2020 2020 6966 2067 7075 3a0a 2020 2020      if gpu:.    
-00003ed0: 2020 2020 636f 6d6d 616e 6420 3d20 280a      command = (.
-00003ee0: 2020 2020 2020 2020 2020 2020 2766 666d              'ffm
-00003ef0: 7065 6720 2d68 7761 6363 656c 2061 7574  peg -hwaccel aut
-00003f00: 6f20 2d63 3a76 2068 3236 345f 6375 7669  o -c:v h264_cuvi
-00003f10: 6420 2d69 2022 7b7d 2220 2d63 3a76 2068  d -i "{}" -c:v h
-00003f20: 3236 345f 6e76 656e 6320 227b 7d22 272e  264_nvenc "{}"'.
-00003f30: 666f 726d 6174 280a 2020 2020 2020 2020  format(.        
-00003f40: 2020 2020 2020 2020 6669 6c65 5f70 6174          file_pat
-00003f50: 682c 2073 6176 655f 6e61 6d65 0a20 2020  h, save_name.   
-00003f60: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00003f70: 2020 2029 0a20 2020 2065 6c73 653a 0a20     ).    else:. 
-00003f80: 2020 2020 2020 2063 6f6d 6d61 6e64 203d         command =
-00003f90: 2028 0a20 2020 2020 2020 2020 2020 2073   (.            s
-00003fa0: 7472 2822 6666 6d70 6567 202d 6920 2229  tr("ffmpeg -i ")
-00003fb0: 202b 2027 2227 202b 2073 7472 2866 696c   + '"' + str(fil
-00003fc0: 655f 7061 7468 2920 2b20 2722 2720 2b20  e_path) + '"' + 
-00003fd0: 2220 2220 2b20 2722 2720 2b20 7361 7665  " " + '"' + save
-00003fe0: 5f6e 616d 6520 2b20 2722 270a 2020 2020  _name + '"'.    
-00003ff0: 2020 2020 290a 2020 2020 7072 696e 7428      ).    print(
-00004000: 2243 6f6e 7665 7274 696e 6720 746f 206d  "Converting to m
-00004010: 7034 2e2e 2e20 2229 0a20 2020 2073 7562  p4... ").    sub
-00004020: 7072 6f63 6573 732e 6361 6c6c 2863 6f6d  process.call(com
-00004030: 6d61 6e64 2c20 7368 656c 6c3d 5472 7565  mand, shell=True
-00004040: 2c20 7374 646f 7574 3d73 7562 7072 6f63  , stdout=subproc
-00004050: 6573 732e 5049 5045 290a 2020 2020 7469  ess.PIPE).    ti
-00004060: 6d65 722e 7374 6f70 5f74 696d 6572 2829  mer.stop_timer()
-00004070: 0a20 2020 2073 7464 6f75 745f 7375 6363  .    stdout_succ
-00004080: 6573 7328 0a20 2020 2020 2020 206d 7367  ess(.        msg
-00004090: 3d66 2253 494d 4241 2043 4f4d 504c 4554  =f"SIMBA COMPLET
-000040a0: 453a 2056 6964 656f 2063 6f6e 7665 7274  E: Video convert
-000040b0: 6564 2120 7b73 6176 655f 6e61 6d65 7d20  ed! {save_name} 
-000040c0: 6765 6e65 7261 7465 6421 222c 0a20 2020  generated!",.   
-000040d0: 2020 2020 2065 6c61 7073 6564 5f74 696d       elapsed_tim
-000040e0: 653d 7469 6d65 722e 656c 6170 7365 645f  e=timer.elapsed_
-000040f0: 7469 6d65 5f73 7472 2c0a 2020 2020 2020  time_str,.      
-00004100: 2020 736f 7572 6365 3d63 6f6e 7665 7274    source=convert
-00004110: 5f74 6f5f 6d70 342e 5f5f 6e61 6d65 5f5f  _to_mp4.__name__
-00004120: 2c0a 2020 2020 290a 0a0a 2320 636f 6e76  ,.    )...# conv
-00004130: 6572 745f 746f 5f6d 7034 2866 696c 655f  ert_to_mp4(file_
-00004140: 7061 7468 3d72 2743 3a5c 5573 6572 735c  path=r'C:\Users\
-00004150: 4e61 7065 5f43 6f6d 7075 7465 725f 325c  Nape_Computer_2\
-00004160: 4465 736b 746f 705c 7465 7374 5f76 6964  Desktop\test_vid
-00004170: 656f 735c 426f 7831 5f50 4d32 5f64 6179  eos\Box1_PM2_day
-00004180: 5f35 5f32 3032 3131 3130 3454 3137 3130  _5_20211104T1710
-00004190: 3231 2e6d 7034 272c 2067 7075 3d54 7275  21.mp4', gpu=Tru
-000041a0: 6529 0a0a 0a64 6566 2076 6964 656f 5f74  e)...def video_t
-000041b0: 6f5f 6772 6579 7363 616c 6528 0a20 2020  o_greyscale(.   
-000041c0: 2066 696c 655f 7061 7468 3a20 556e 696f   file_path: Unio
-000041d0: 6e5b 7374 722c 206f 732e 5061 7468 4c69  n[str, os.PathLi
-000041e0: 6b65 5d2c 2067 7075 3a20 4f70 7469 6f6e  ke], gpu: Option
-000041f0: 616c 5b62 6f6f 6c5d 203d 2046 616c 7365  al[bool] = False
-00004200: 0a29 202d 3e20 4e6f 6e65 3a0a 2020 2020  .) -> None:.    
-00004210: 2222 220a 2020 2020 436f 6e76 6572 7420  """.    Convert 
-00004220: 6120 7669 6465 6f20 6669 6c65 2074 6f20  a video file to 
-00004230: 6772 6579 7363 616c 6520 6d70 3420 666f  greyscale mp4 fo
-00004240: 726d 6174 2e20 5468 6520 7265 7375 6c74  rmat. The result
-00004250: 2069 7320 7374 6f72 6564 2069 6e20 7468   is stored in th
-00004260: 6520 7361 6d65 2064 6972 6563 746f 7279  e same directory
-00004270: 2061 7320 7468 650a 2020 2020 696e 7075   as the.    inpu
-00004280: 7420 6669 6c65 2077 6974 6820 7468 6520  t file with the 
-00004290: 6060 5f67 7261 7973 6361 6c65 2e6d 7034  ``_grayscale.mp4
-000042a0: 6060 2073 7566 6669 782e 0a0a 2020 2020  `` suffix...    
-000042b0: 3a70 6172 616d 6574 6572 2055 6e69 6f6e  :parameter Union
-000042c0: 5b73 7472 2c20 6f73 2e50 6174 684c 696b  [str, os.PathLik
-000042d0: 655d 2066 696c 655f 7061 7468 3a20 5061  e] file_path: Pa
-000042e0: 7468 2074 6f20 7669 6465 6f20 6669 6c65  th to video file
-000042f0: 2e0a 2020 2020 3a70 6172 616d 6574 6572  ..    :parameter
-00004300: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
-00004310: 6770 753a 2049 6620 5472 7565 2c20 7573  gpu: If True, us
-00004320: 6520 4e56 4944 4541 2047 5055 2063 6f64  e NVIDEA GPU cod
-00004330: 6563 732e 2044 6566 6175 6c74 2046 616c  ecs. Default Fal
-00004340: 7365 2e0a 2020 2020 3a72 6169 7365 2046  se..    :raise F
-00004350: 464d 5045 4743 6f64 6563 4750 5545 7272  FMPEGCodecGPUErr
-00004360: 6f72 3a20 4966 206e 6f20 4750 5520 6973  or: If no GPU is
-00004370: 2066 6f75 6e64 2061 6e64 2060 6067 7075   found and ``gpu
-00004380: 203d 3d20 5472 7565 6060 2e0a 2020 2020   == True``..    
-00004390: 3a72 6169 7365 2046 696c 6545 7869 7374  :raise FileExist
-000043a0: 4572 726f 723a 2049 6620 7669 6465 6f20  Error: If video 
-000043b0: 6e61 6d65 2077 6974 6820 6060 5f67 7261  name with ``_gra
-000043c0: 7973 6361 6c65 6060 2073 7566 6669 7820  yscale`` suffix 
-000043d0: 616c 7265 6164 7920 6578 6973 742e 0a0a  already exist...
-000043e0: 2020 2020 3a65 7861 6d70 6c65 3a0a 2020      :example:.  
-000043f0: 2020 3e3e 3e20 5f20 3d20 7669 6465 6f5f    >>> _ = video_
-00004400: 746f 5f67 7265 7973 6361 6c65 2866 696c  to_greyscale(fil
-00004410: 655f 7061 7468 3d27 7072 6f6a 6563 745f  e_path='project_
-00004420: 666f 6c64 6572 2f76 6964 656f 732f 5669  folder/videos/Vi
-00004430: 6465 6f5f 312e 6176 6927 290a 2020 2020  deo_1.avi').    
-00004440: 2222 220a 2020 2020 6966 2067 7075 2061  """.    if gpu a
-00004450: 6e64 206e 6f74 2063 6865 636b 5f6e 7669  nd not check_nvi
-00004460: 6465 615f 6770 755f 6176 6169 6c61 626c  dea_gpu_availabl
-00004470: 6528 293a 0a20 2020 2020 2020 2072 6169  e():.        rai
-00004480: 7365 2046 464d 5045 4743 6f64 6563 4750  se FFMPEGCodecGP
-00004490: 5545 7272 6f72 280a 2020 2020 2020 2020  UError(.        
-000044a0: 2020 2020 6d73 673d 224e 6f20 4750 5520      msg="No GPU 
-000044b0: 666f 756e 6420 2861 7320 6576 616c 7561  found (as evalua
-000044c0: 7465 6420 6279 206e 7669 6465 612d 736d  ted by nvidea-sm
-000044d0: 6920 7265 7475 726e 696e 6720 4e6f 6e65  i returning None
-000044e0: 2922 2c0a 2020 2020 2020 2020 2020 2020  )",.            
-000044f0: 736f 7572 6365 3d76 6964 656f 5f74 6f5f  source=video_to_
-00004500: 6772 6579 7363 616c 652e 5f5f 6e61 6d65  greyscale.__name
-00004510: 5f5f 2c0a 2020 2020 2020 2020 290a 2020  __,.        ).  
-00004520: 2020 7469 6d65 7220 3d20 5369 6d62 6154    timer = SimbaT
-00004530: 696d 6572 2873 7461 7274 3d54 7275 6529  imer(start=True)
-00004540: 0a20 2020 2063 6865 636b 5f66 696c 655f  .    check_file_
-00004550: 6578 6973 745f 616e 645f 7265 6164 6162  exist_and_readab
-00004560: 6c65 2866 696c 655f 7061 7468 3d66 696c  le(file_path=fil
-00004570: 655f 7061 7468 290a 2020 2020 6469 722c  e_path).    dir,
-00004580: 2066 696c 655f 6e61 6d65 2c20 6578 7420   file_name, ext 
-00004590: 3d20 6765 745f 666e 5f65 7874 2866 696c  = get_fn_ext(fil
-000045a0: 6570 6174 683d 6669 6c65 5f70 6174 6829  epath=file_path)
-000045b0: 0a20 2020 2073 6176 655f 6e61 6d65 203d  .    save_name =
-000045c0: 206f 732e 7061 7468 2e6a 6f69 6e28 6469   os.path.join(di
-000045d0: 722c 2066 696c 655f 6e61 6d65 202b 2022  r, file_name + "
-000045e0: 5f67 7261 7973 6361 6c65 2e6d 7034 2229  _grayscale.mp4")
-000045f0: 0a20 2020 2069 6620 6f73 2e70 6174 682e  .    if os.path.
-00004600: 6973 6669 6c65 2873 6176 655f 6e61 6d65  isfile(save_name
-00004610: 293a 0a20 2020 2020 2020 2072 6169 7365  ):.        raise
-00004620: 2046 696c 6545 7869 7374 4572 726f 7228   FileExistError(
-00004630: 0a20 2020 2020 2020 2020 2020 206d 7367  .            msg
-00004640: 3d22 5349 4d42 4120 4552 524f 523a 2054  ="SIMBA ERROR: T
-00004650: 6865 206f 7574 6669 6c65 2066 696c 6520  he outfile file 
-00004660: 616c 7265 6164 7920 6578 6973 743a 207b  already exist: {
-00004670: 7d2e 222e 666f 726d 6174 2873 6176 655f  }.".format(save_
-00004680: 6e61 6d65 292c 0a20 2020 2020 2020 2020  name),.         
-00004690: 2020 2073 6f75 7263 653d 7669 6465 6f5f     source=video_
-000046a0: 746f 5f67 7265 7973 6361 6c65 2e5f 5f6e  to_greyscale.__n
-000046b0: 616d 655f 5f2c 0a20 2020 2020 2020 2029  ame__,.        )
-000046c0: 0a20 2020 2069 6620 6770 753a 0a20 2020  .    if gpu:.   
-000046d0: 2020 2020 2063 6f6d 6d61 6e64 203d 2066       command = f
-000046e0: 2766 666d 7065 6720 2d68 7761 6363 656c  'ffmpeg -hwaccel
-000046f0: 2061 7574 6f20 2d63 3a76 2068 3236 345f   auto -c:v h264_
-00004700: 6375 7669 6420 2d69 2022 7b66 696c 655f  cuvid -i "{file_
-00004710: 7061 7468 7d22 202d 7666 2022 6877 7570  path}" -vf "hwup
-00004720: 6c6f 6164 5f63 7564 612c 6877 646f 776e  load_cuda,hwdown
-00004730: 6c6f 6164 2c66 6f72 6d61 743d 6e76 3132  load,format=nv12
-00004740: 2c66 6f72 6d61 743d 6772 6179 2220 2d63  ,format=gray" -c
-00004750: 3a76 2068 3236 345f 6e76 656e 6320 2d63  :v h264_nvenc -c
-00004760: 3a61 2063 6f70 7920 227b 7361 7665 5f6e  :a copy "{save_n
-00004770: 616d 657d 2227 0a20 2020 2065 6c73 653a  ame}"'.    else:
-00004780: 0a20 2020 2020 2020 2063 6f6d 6d61 6e64  .        command
-00004790: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-000047a0: 2073 7472 2822 6666 6d70 6567 202d 6920   str("ffmpeg -i 
-000047b0: 2229 0a20 2020 2020 2020 2020 2020 202b  ").            +
-000047c0: 2027 2227 0a20 2020 2020 2020 2020 2020   '"'.           
-000047d0: 202b 2073 7472 2866 696c 655f 7061 7468   + str(file_path
-000047e0: 290a 2020 2020 2020 2020 2020 2020 2b20  ).            + 
-000047f0: 2722 270a 2020 2020 2020 2020 2020 2020  '"'.            
-00004800: 2b20 2220 2d76 6620 666f 726d 6174 3d67  + " -vf format=g
-00004810: 7261 7920 220a 2020 2020 2020 2020 2020  ray ".          
-00004820: 2020 2b20 2722 270a 2020 2020 2020 2020    + '"'.        
-00004830: 2020 2020 2b20 7361 7665 5f6e 616d 650a      + save_name.
-00004840: 2020 2020 2020 2020 2020 2020 2b20 2722              + '"
-00004850: 270a 2020 2020 2020 2020 290a 2020 2020  '.        ).    
-00004860: 7072 696e 7428 6622 436f 6e76 6572 7469  print(f"Converti
-00004870: 6e67 207b 6669 6c65 5f6e 616d 657d 2074  ng {file_name} t
-00004880: 6f20 6772 6579 7363 616c 652e 2e2e 2022  o greyscale... "
-00004890: 290a 2020 2020 7375 6270 726f 6365 7373  ).    subprocess
-000048a0: 2e63 616c 6c28 636f 6d6d 616e 642c 2073  .call(command, s
-000048b0: 6865 6c6c 3d54 7275 652c 2073 7464 6f75  hell=True, stdou
-000048c0: 743d 7375 6270 726f 6365 7373 2e50 4950  t=subprocess.PIP
-000048d0: 4529 0a20 2020 2074 696d 6572 2e73 746f  E).    timer.sto
-000048e0: 705f 7469 6d65 7228 290a 2020 2020 7374  p_timer().    st
-000048f0: 646f 7574 5f73 7563 6365 7373 280a 2020  dout_success(.  
-00004900: 2020 2020 2020 6d73 673d 6622 5349 4d42        msg=f"SIMB
-00004910: 4120 434f 4d50 4c45 5445 3a20 5669 6465  A COMPLETE: Vide
-00004920: 6f20 636f 6e76 6572 7465 6421 207b 7361  o converted! {sa
-00004930: 7665 5f6e 616d 657d 2067 656e 6572 6174  ve_name} generat
-00004940: 6564 2122 2c0a 2020 2020 2020 2020 656c  ed!",.        el
-00004950: 6170 7365 645f 7469 6d65 3d74 696d 6572  apsed_time=timer
-00004960: 2e65 6c61 7073 6564 5f74 696d 655f 7374  .elapsed_time_st
-00004970: 722c 0a20 2020 2020 2020 2073 6f75 7263  r,.        sourc
-00004980: 653d 7669 6465 6f5f 746f 5f67 7265 7973  e=video_to_greys
-00004990: 6361 6c65 2e5f 5f6e 616d 655f 5f2c 0a20  cale.__name__,. 
-000049a0: 2020 2029 0a0a 0a23 2076 6964 656f 5f74     )...# video_t
-000049b0: 6f5f 6772 6579 7363 616c 6528 6669 6c65  o_greyscale(file
-000049c0: 5f70 6174 683d 7227 433a 5c55 7365 7273  _path=r'C:\Users
-000049d0: 5c4e 6170 655f 436f 6d70 7574 6572 5f32  \Nape_Computer_2
-000049e0: 5c44 6573 6b74 6f70 5c74 6573 745f 7669  \Desktop\test_vi
-000049f0: 6465 6f73 5c42 6f78 315f 504d 325f 6461  deos\Box1_PM2_da
-00004a00: 795f 355f 3230 3231 3131 3034 5431 3731  y_5_20211104T171
-00004a10: 3032 312e 6d70 3427 2c20 6770 753d 5472  021.mp4', gpu=Tr
-00004a20: 7565 290a 0a0a 6465 6620 7375 7065 7269  ue)...def superi
-00004a30: 6d70 6f73 655f 6672 616d 655f 636f 756e  mpose_frame_coun
-00004a40: 7428 0a20 2020 2066 696c 655f 7061 7468  t(.    file_path
-00004a50: 3a20 556e 696f 6e5b 7374 722c 206f 732e  : Union[str, os.
-00004a60: 5061 7468 4c69 6b65 5d2c 2067 7075 3a20  PathLike], gpu: 
-00004a70: 4f70 7469 6f6e 616c 5b62 6f6f 6c5d 203d  Optional[bool] =
-00004a80: 2046 616c 7365 0a29 202d 3e20 4e6f 6e65   False.) -> None
-00004a90: 3a0a 2020 2020 2222 220a 2020 2020 5375  :.    """.    Su
-00004aa0: 7065 7269 6d70 6f73 6520 6672 616d 6520  perimpose frame 
-00004ab0: 636f 756e 7420 6f6e 2061 2076 6964 656f  count on a video
-00004ac0: 2066 696c 652e 2054 6865 2072 6573 756c   file. The resul
-00004ad0: 7420 6973 2073 746f 7265 6420 696e 2074  t is stored in t
-00004ae0: 6865 2073 616d 6520 6469 7265 6374 6f72  he same director
-00004af0: 7920 6173 2074 6865 0a20 2020 2069 6e70  y as the.    inp
-00004b00: 7574 2066 696c 6520 7769 7468 2074 6865  ut file with the
-00004b10: 2060 605f 6672 616d 655f 6e6f 2e6d 7034   ``_frame_no.mp4
-00004b20: 6060 2073 7566 6669 782e 0a0a 2020 2020  `` suffix...    
-00004b30: 3a70 6172 616d 6574 6572 2055 6e69 6f6e  :parameter Union
-00004b40: 5b73 7472 2c20 6f73 2e50 6174 684c 696b  [str, os.PathLik
-00004b50: 655d 2066 696c 655f 7061 7468 3a20 5061  e] file_path: Pa
-00004b60: 7468 2074 6f20 7669 6465 6f20 6669 6c65  th to video file
-00004b70: 2e0a 2020 2020 3a70 6172 616d 6574 6572  ..    :parameter
-00004b80: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
-00004b90: 6770 753a 2049 6620 5472 7565 2c20 7573  gpu: If True, us
-00004ba0: 6520 4e56 4944 4541 2047 5055 2063 6f64  e NVIDEA GPU cod
-00004bb0: 6563 732e 2044 6566 6175 6c74 2046 616c  ecs. Default Fal
-00004bc0: 7365 2e0a 0a20 2020 203a 6578 616d 706c  se...    :exampl
-00004bd0: 653a 0a20 2020 203e 3e3e 205f 203d 2073  e:.    >>> _ = s
-00004be0: 7570 6572 696d 706f 7365 5f66 7261 6d65  uperimpose_frame
-00004bf0: 5f63 6f75 6e74 2866 696c 655f 7061 7468  _count(file_path
-00004c00: 3d27 7072 6f6a 6563 745f 666f 6c64 6572  ='project_folder
-00004c10: 2f76 6964 656f 732f 5669 6465 6f5f 312e  /videos/Video_1.
-00004c20: 6176 6927 290a 2020 2020 2222 220a 2020  avi').    """.  
-00004c30: 2020 7369 6d62 615f 6377 203d 206f 732e    simba_cw = os.
-00004c40: 7061 7468 2e64 6972 6e61 6d65 2873 696d  path.dirname(sim
-00004c50: 6261 2e5f 5f66 696c 655f 5f29 0a20 2020  ba.__file__).   
-00004c60: 2073 696d 6261 5f66 6f6e 745f 7061 7468   simba_font_path
-00004c70: 203d 206f 732e 7061 7468 2e6a 6f69 6e28   = os.path.join(
-00004c80: 7369 6d62 615f 6377 2c20 2261 7373 6574  simba_cw, "asset
-00004c90: 7322 2c20 2255 6275 6e74 754d 6f6e 6f2d  s", "UbuntuMono-
-00004ca0: 5265 6775 6c61 722e 7474 6622 290a 2020  Regular.ttf").  
-00004cb0: 2020 7469 6d65 7220 3d20 5369 6d62 6154    timer = SimbaT
-00004cc0: 696d 6572 2873 7461 7274 3d54 7275 6529  imer(start=True)
-00004cd0: 0a20 2020 2069 6620 6e6f 7420 6f73 2e70  .    if not os.p
-00004ce0: 6174 682e 6973 6669 6c65 2873 696d 6261  ath.isfile(simba
-00004cf0: 5f66 6f6e 745f 7061 7468 293a 0a20 2020  _font_path):.   
-00004d00: 2020 2020 2069 6620 706c 6174 666f 726d       if platform
-00004d10: 2e73 7973 7465 6d28 2920 3d3d 204f 532e  .system() == OS.
-00004d20: 5749 4e44 4f57 532e 7661 6c75 653a 0a20  WINDOWS.value:. 
-00004d30: 2020 2020 2020 2020 2020 2073 696d 6261             simba
-00004d40: 5f66 6f6e 745f 7061 7468 203d 2022 433a  _font_path = "C:
-00004d50: 2f57 696e 646f 7773 2f66 6f6e 7473 2f61  /Windows/fonts/a
-00004d60: 7269 616c 2e74 7466 220a 2020 2020 2020  rial.ttf".      
-00004d70: 2020 2020 2020 6966 206e 6f74 206f 732e        if not os.
-00004d80: 7061 7468 2e69 7366 696c 6528 7369 6d62  path.isfile(simb
-00004d90: 615f 666f 6e74 5f70 6174 6829 3a0a 2020  a_font_path):.  
-00004da0: 2020 2020 2020 2020 2020 2020 2020 7369                si
-00004db0: 6d62 615f 666f 6e74 5f70 6174 6820 3d20  mba_font_path = 
-00004dc0: 6f73 2e6c 6973 7464 6972 2872 2243 3a2f  os.listdir(r"C:/
-00004dd0: 5769 6e64 6f77 732f 666f 6e74 7322 295b  Windows/fonts")[
-00004de0: 305d 0a20 2020 2020 2020 2020 2020 2073  0].            s
-00004df0: 696d 6261 5f66 6f6e 745f 7061 7468 203d  imba_font_path =
-00004e00: 2073 696d 6261 5f66 6f6e 745f 7061 7468   simba_font_path
-00004e10: 5b32 3a5d 2e72 6570 6c61 6365 2822 5c5c  [2:].replace("\\
-00004e20: 222c 2022 2f22 290a 2020 2020 2020 2020  ", "/").        
-00004e30: 656c 6966 2028 706c 6174 666f 726d 2e73  elif (platform.s
-00004e40: 7973 7465 6d28 2920 3d3d 204f 532e 4d41  ystem() == OS.MA
-00004e50: 432e 7661 6c75 6529 206f 7220 280a 2020  C.value) or (.  
-00004e60: 2020 2020 2020 2020 2020 706c 6174 666f            platfo
-00004e70: 726d 2e73 7973 7465 6d28 2920 3d3d 204f  rm.system() == O
-00004e80: 532e 4c49 4e55 582e 7661 6c75 650a 2020  S.LINUX.value.  
-00004e90: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
-00004ea0: 2020 2020 2073 696d 6261 5f66 6f6e 745f       simba_font_
-00004eb0: 7061 7468 203d 2022 4172 6961 6c2e 7474  path = "Arial.tt
-00004ec0: 6622 0a20 2020 2065 6c73 653a 0a20 2020  f".    else:.   
-00004ed0: 2020 2020 2069 6620 706c 6174 666f 726d       if platform
-00004ee0: 2e73 7973 7465 6d28 2920 3d3d 204f 532e  .system() == OS.
-00004ef0: 5749 4e44 4f57 532e 7661 6c75 653a 0a20  WINDOWS.value:. 
-00004f00: 2020 2020 2020 2020 2020 2073 696d 6261             simba
-00004f10: 5f66 6f6e 745f 7061 7468 203d 2073 7472  _font_path = str
-00004f20: 2873 696d 6261 5f66 6f6e 745f 7061 7468  (simba_font_path
-00004f30: 5b32 3a5d 2e72 6570 6c61 6365 2822 5c5c  [2:].replace("\\
-00004f40: 222c 2022 2f22 2929 0a20 2020 2063 6865  ", "/")).    che
-00004f50: 636b 5f66 696c 655f 6578 6973 745f 616e  ck_file_exist_an
-00004f60: 645f 7265 6164 6162 6c65 2866 696c 655f  d_readable(file_
-00004f70: 7061 7468 3d66 696c 655f 7061 7468 290a  path=file_path).
-00004f80: 2020 2020 6469 722c 2066 696c 655f 6e61      dir, file_na
-00004f90: 6d65 2c20 6578 7420 3d20 6765 745f 666e  me, ext = get_fn
-00004fa0: 5f65 7874 2866 696c 6570 6174 683d 6669  _ext(filepath=fi
-00004fb0: 6c65 5f70 6174 6829 0a20 2020 2073 6176  le_path).    sav
-00004fc0: 655f 6e61 6d65 203d 206f 732e 7061 7468  e_name = os.path
-00004fd0: 2e6a 6f69 6e28 6469 722c 2066 696c 655f  .join(dir, file_
-00004fe0: 6e61 6d65 202b 2022 5f66 7261 6d65 5f6e  name + "_frame_n
-00004ff0: 6f2e 6d70 3422 290a 2020 2020 7072 696e  o.mp4").    prin
-00005000: 7428 6622 5375 7065 7269 6d70 6f73 696e  t(f"Superimposin
-00005010: 6720 6672 616d 6520 6e75 6d62 6572 7320  g frame numbers 
-00005020: 7573 696e 6720 666f 6e74 2070 6174 6820  using font path 
-00005030: 7b73 696d 6261 5f66 6f6e 745f 7061 7468  {simba_font_path
-00005040: 7d2e 2e2e 2e2e 2e20 2229 0a20 2020 2074  }...... ").    t
-00005050: 7279 3a0a 2020 2020 2020 2020 6966 2067  ry:.        if g
-00005060: 7075 3a0a 2020 2020 2020 2020 2020 2020  pu:.            
-00005070: 636f 6d6d 616e 6420 3d20 6627 6666 6d70  command = f'ffmp
-00005080: 6567 202d 6877 6163 6365 6c20 6175 746f  eg -hwaccel auto
-00005090: 202d 633a 7620 6832 3634 5f63 7576 6964   -c:v h264_cuvid
-000050a0: 202d 6920 227b 6669 6c65 5f70 6174 687d   -i "{file_path}
-000050b0: 2220 2d76 6620 2264 7261 7774 6578 743d  " -vf "drawtext=
-000050c0: 666f 6e74 6669 6c65 3d7b 7369 6d62 615f  fontfile={simba_
-000050d0: 666f 6e74 5f70 6174 687d 3a74 6578 743d  font_path}:text=
-000050e0: 257b 7b6e 7d7d 3a78 3d28 772d 7477 292f  %{{n}}:x=(w-tw)/
-000050f0: 323a 793d 682d 7468 2d31 303a 666f 6e74  2:y=h-th-10:font
-00005100: 636f 6c6f 723d 7768 6974 653a 626f 783d  color=white:box=
-00005110: 313a 626f 7863 6f6c 6f72 3d77 6869 7465  1:boxcolor=white
-00005120: 4030 2e35 2220 2d63 3a76 2068 3236 345f  @0.5" -c:v h264_
-00005130: 6e76 656e 6320 2d63 3a61 2063 6f70 7920  nvenc -c:a copy 
-00005140: 227b 7361 7665 5f6e 616d 657d 2220 2d79  "{save_name}" -y
-00005150: 270a 2020 2020 2020 2020 656c 7365 3a0a  '.        else:.
-00005160: 2020 2020 2020 2020 2020 2020 636f 6d6d              comm
-00005170: 616e 6420 3d20 280a 2020 2020 2020 2020  and = (.        
-00005180: 2020 2020 2020 2020 7374 7228 2266 666d          str("ffm
-00005190: 7065 6720 2d79 202d 6920 2229 0a20 2020  peg -y -i ").   
-000051a0: 2020 2020 2020 2020 2020 2020 202b 2027               + '
-000051b0: 2227 0a20 2020 2020 2020 2020 2020 2020  "'.             
-000051c0: 2020 202b 2066 696c 655f 7061 7468 0a20     + file_path. 
-000051d0: 2020 2020 2020 2020 2020 2020 2020 202b                 +
-000051e0: 2027 2227 0a20 2020 2020 2020 2020 2020   '"'.           
-000051f0: 2020 2020 202b 2027 202d 7666 2022 6472       + ' -vf "dr
-00005200: 6177 7465 7874 3d66 6f6e 7466 696c 653d  awtext=fontfile=
-00005210: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
-00005220: 2020 2b20 7369 6d62 615f 666f 6e74 5f70    + simba_font_p
-00005230: 6174 680a 2020 2020 2020 2020 2020 2020  ath.            
-00005240: 2020 2020 2b20 223a 2074 6578 743d 2725      + ": text='%
-00005250: 7b66 7261 6d65 5f6e 756d 7d27 3a20 7374  {frame_num}': st
-00005260: 6172 745f 6e75 6d62 6572 3d30 3a20 783d  art_number=0: x=
-00005270: 2877 2d74 7729 2f32 3a20 793d 682d 2832  (w-tw)/2: y=h-(2
-00005280: 2a6c 6829 3a20 666f 6e74 636f 6c6f 723d  *lh): fontcolor=
-00005290: 626c 6163 6b3a 2066 6f6e 7473 697a 653d  black: fontsize=
-000052a0: 3230 3a20 626f 783d 313a 2062 6f78 636f  20: box=1: boxco
-000052b0: 6c6f 723d 7768 6974 653a 2062 6f78 626f  lor=white: boxbo
-000052c0: 7264 6572 773d 355c 2220 2d63 3a61 2063  rderw=5\" -c:a c
-000052d0: 6f70 7920 220a 2020 2020 2020 2020 2020  opy ".          
-000052e0: 2020 2020 2020 2b20 2722 270a 2020 2020        + '"'.    
-000052f0: 2020 2020 2020 2020 2020 2020 2b20 7361              + sa
-00005300: 7665 5f6e 616d 650a 2020 2020 2020 2020  ve_name.        
-00005310: 2020 2020 2020 2020 2b20 2722 202d 7927          + '" -y'
-00005320: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00005330: 2020 2020 2020 2070 7269 6e74 2866 2255         print(f"U
-00005340: 7369 6e67 2066 6f6e 7420 7061 7468 207b  sing font path {
-00005350: 7369 6d62 615f 666f 6e74 5f70 6174 687d  simba_font_path}
-00005360: 2e2e 2e22 290a 2020 2020 2020 2020 7375  ...").        su
-00005370: 6270 726f 6365 7373 2e63 6865 636b 5f6f  bprocess.check_o
-00005380: 7574 7075 7428 636f 6d6d 616e 642c 2073  utput(command, s
-00005390: 6865 6c6c 3d54 7275 6529 0a20 2020 2020  hell=True).     
-000053a0: 2020 2073 7562 7072 6f63 6573 732e 6361     subprocess.ca
-000053b0: 6c6c 2863 6f6d 6d61 6e64 2c20 7368 656c  ll(command, shel
-000053c0: 6c3d 5472 7565 2c20 7374 646f 7574 3d73  l=True, stdout=s
-000053d0: 7562 7072 6f63 6573 732e 5049 5045 290a  ubprocess.PIPE).
-000053e0: 2020 2020 6578 6365 7074 2073 7562 7072      except subpr
-000053f0: 6f63 6573 732e 4361 6c6c 6564 5072 6f63  ocess.CalledProc
-00005400: 6573 7345 7272 6f72 2061 7320 653a 0a20  essError as e:. 
-00005410: 2020 2020 2020 2069 6620 6770 753a 0a20         if gpu:. 
-00005420: 2020 2020 2020 2020 2020 2063 6f6d 6d61             comma
-00005430: 6e64 203d 2066 2766 666d 7065 6720 2d68  nd = f'ffmpeg -h
-00005440: 7761 6363 656c 2061 7574 6f20 2d63 3a76  waccel auto -c:v
-00005450: 2068 3236 345f 6375 7669 6420 2d69 2022   h264_cuvid -i "
-00005460: 7b66 696c 655f 7061 7468 7d22 202d 7666  {file_path}" -vf
-00005470: 2022 6472 6177 7465 7874 3d66 6f6e 7473   "drawtext=fonts
-00005480: 697a 653d 3234 3a66 6f6e 7466 696c 653d  ize=24:fontfile=
-00005490: 7b73 696d 6261 5f66 6f6e 745f 7061 7468  {simba_font_path
-000054a0: 7d3a 7465 7874 3d25 7b7b 6e7d 7d3a 783d  }:text=%{{n}}:x=
-000054b0: 2877 2d74 7729 2f32 3a79 3d68 2d74 682d  (w-tw)/2:y=h-th-
-000054c0: 3130 3a66 6f6e 7463 6f6c 6f72 3d77 6869  10:fontcolor=whi
-000054d0: 7465 3a62 6f78 3d31 3a62 6f78 636f 6c6f  te:box=1:boxcolo
-000054e0: 723d 7768 6974 6540 302e 3522 202d 633a  r=white@0.5" -c:
-000054f0: 7620 6832 3634 5f6e 7665 6e63 202d 633a  v h264_nvenc -c:
-00005500: 6120 636f 7079 2022 7b73 6176 655f 6e61  a copy "{save_na
-00005510: 6d65 7d22 202d 7927 0a20 2020 2020 2020  me}" -y'.       
-00005520: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00005530: 2020 2063 6f6d 6d61 6e64 203d 2066 2766     command = f'f
-00005540: 666d 7065 6720 2d79 202d 6920 227b 6669  fmpeg -y -i "{fi
-00005550: 6c65 5f70 6174 687d 2220 2d76 6620 2264  le_path}" -vf "d
-00005560: 7261 7774 6578 743d 666f 6e74 6669 6c65  rawtext=fontfile
-00005570: 3d7b 7369 6d62 615f 666f 6e74 5f70 6174  ={simba_font_pat
-00005580: 687d 3a74 6578 743d 5c27 257b 7b66 7261  h}:text=\'%{{fra
-00005590: 6d65 5f6e 756d 7d7d 5c27 3a73 7461 7274  me_num}}\':start
-000055a0: 5f6e 756d 6265 723d 313a 783d 2877 2d74  _number=1:x=(w-t
-000055b0: 7729 2f32 3a79 3d68 2d28 322a 6c68 293a  w)/2:y=h-(2*lh):
-000055c0: 666f 6e74 636f 6c6f 723d 626c 6163 6b3a  fontcolor=black:
-000055d0: 666f 6e74 7369 7a65 3d32 303a 626f 783d  fontsize=20:box=
-000055e0: 313a 626f 7863 6f6c 6f72 3d77 6869 7465  1:boxcolor=white
-000055f0: 3a62 6f78 626f 7264 6572 773d 3522 202d  :boxborderw=5" -
-00005600: 633a 6120 636f 7079 2022 7b73 6176 655f  c:a copy "{save_
-00005610: 6e61 6d65 7d22 202d 7927 0a20 2020 2020  name}" -y'.     
-00005620: 2020 2070 7269 6e74 2866 2255 7369 6e67     print(f"Using
-00005630: 2066 6f6e 7420 7061 7468 207b 7369 6d62   font path {simb
-00005640: 615f 666f 6e74 5f70 6174 687d 2e2e 2e22  a_font_path}..."
-00005650: 290a 2020 2020 2020 2020 7375 6270 726f  ).        subpro
-00005660: 6365 7373 2e63 616c 6c28 636f 6d6d 616e  cess.call(comman
-00005670: 642c 2073 6865 6c6c 3d54 7275 652c 2073  d, shell=True, s
-00005680: 7464 6f75 743d 7375 6270 726f 6365 7373  tdout=subprocess
-00005690: 2e50 4950 4529 0a20 2020 2074 696d 6572  .PIPE).    timer
-000056a0: 2e73 746f 705f 7469 6d65 7228 290a 2020  .stop_timer().  
-000056b0: 2020 7374 646f 7574 5f73 7563 6365 7373    stdout_success
-000056c0: 280a 2020 2020 2020 2020 6d73 673d 6622  (.        msg=f"
-000056d0: 5375 7065 7269 6d70 6f73 6564 2076 6964  Superimposed vid
-000056e0: 656f 2063 6f6e 7665 7274 6564 2120 7b73  eo converted! {s
-000056f0: 6176 655f 6e61 6d65 7d20 6765 6e65 7261  ave_name} genera
-00005700: 7465 6421 222c 0a20 2020 2020 2020 2065  ted!",.        e
-00005710: 6c61 7073 6564 5f74 696d 653d 7469 6d65  lapsed_time=time
-00005720: 722e 656c 6170 7365 645f 7469 6d65 5f73  r.elapsed_time_s
-00005730: 7472 2c0a 2020 2020 290a 0a0a 2320 5f20  tr,.    )...# _ 
-00005740: 3d20 7375 7065 7269 6d70 6f73 655f 6672  = superimpose_fr
-00005750: 616d 655f 636f 756e 7428 6669 6c65 5f70  ame_count(file_p
-00005760: 6174 683d 7227 2f55 7365 7273 2f73 696d  ath=r'/Users/sim
-00005770: 6f6e 2f44 6573 6b74 6f70 2f65 6e76 732f  on/Desktop/envs/
-00005780: 7472 6f75 626c 6573 686f 6f74 696e 672f  troubleshooting/
-00005790: 7477 6f5f 626c 6163 6b5f 616e 696d 616c  two_black_animal
-000057a0: 735f 3134 6270 2f70 726f 6a65 6374 5f66  s_14bp/project_f
-000057b0: 6f6c 6465 722f 7669 6465 6f73 2f54 6f67  older/videos/Tog
-000057c0: 6574 6865 725f 312e 6176 6927 2c20 6770  ether_1.avi', gp
-000057d0: 753d 4661 6c73 6529 0a0a 0a64 6566 2072  u=False)...def r
-000057e0: 656d 6f76 655f 6265 6769 6e6e 696e 675f  emove_beginning_
-000057f0: 6f66 5f76 6964 656f 280a 2020 2020 6669  of_video(.    fi
-00005800: 6c65 5f70 6174 683a 2055 6e69 6f6e 5b73  le_path: Union[s
-00005810: 7472 2c20 6f73 2e50 6174 684c 696b 655d  tr, os.PathLike]
-00005820: 2c20 7469 6d65 3a20 696e 742c 2067 7075  , time: int, gpu
-00005830: 3a20 4f70 7469 6f6e 616c 5b62 6f6f 6c5d  : Optional[bool]
-00005840: 203d 2046 616c 7365 0a29 202d 3e20 4e6f   = False.) -> No
-00005850: 6e65 3a0a 2020 2020 2222 220a 2020 2020  ne:.    """.    
-00005860: 5265 6d6f 7665 204e 2073 6563 6f6e 6473  Remove N seconds
-00005870: 2066 726f 6d20 7468 6520 6265 6769 6e6e   from the beginn
-00005880: 696e 6720 6f66 2061 2076 6964 656f 2066  ing of a video f
-00005890: 696c 652e 2054 6865 2072 6573 756c 7420  ile. The result 
-000058a0: 6973 2073 746f 7265 6420 696e 2074 6865  is stored in the
-000058b0: 2073 616d 6520 6469 7265 6374 6f72 7920   same directory 
-000058c0: 6173 2074 6865 0a20 2020 2069 6e70 7574  as the.    input
-000058d0: 2066 696c 6520 7769 7468 2074 6865 2060   file with the `
-000058e0: 605f 7368 6f72 7465 6e2e 6d70 3460 6020  `_shorten.mp4`` 
-000058f0: 7375 6666 6978 2e0a 0a20 2020 203a 7061  suffix...    :pa
-00005900: 7261 6d65 7465 7220 556e 696f 6e5b 7374  rameter Union[st
-00005910: 722c 206f 732e 5061 7468 4c69 6b65 5d20  r, os.PathLike] 
-00005920: 6669 6c65 5f70 6174 683a 2050 6174 6820  file_path: Path 
-00005930: 746f 2076 6964 656f 2066 696c 650a 2020  to video file.  
-00005940: 2020 3a70 6172 616d 6574 6572 2069 6e74    :parameter int
-00005950: 2074 696d 653a 204e 756d 6265 7220 6f66   time: Number of
-00005960: 2073 6563 6f6e 6473 2074 6f20 7265 6d6f   seconds to remo
-00005970: 7665 2066 726f 6d20 7468 6520 6265 6769  ve from the begi
-00005980: 6e6e 696e 6720 6f66 2074 6865 2076 6964  nning of the vid
-00005990: 656f 2e0a 2020 2020 3a70 6172 616d 6574  eo..    :paramet
-000059a0: 6572 204f 7074 696f 6e61 6c5b 626f 6f6c  er Optional[bool
-000059b0: 5d20 6770 753a 2049 6620 5472 7565 2c20  ] gpu: If True, 
-000059c0: 7573 6520 4e56 4944 4541 2047 5055 2063  use NVIDEA GPU c
-000059d0: 6f64 6563 732e 2044 6566 6175 6c74 2046  odecs. Default F
-000059e0: 616c 7365 2e0a 0a20 2020 203a 6578 616d  alse...    :exam
-000059f0: 706c 653a 0a20 2020 203e 3e3e 205f 203d  ple:.    >>> _ =
-00005a00: 2072 656d 6f76 655f 6265 6769 6e6e 696e   remove_beginnin
-00005a10: 675f 6f66 5f76 6964 656f 2866 696c 655f  g_of_video(file_
-00005a20: 7061 7468 3d27 7072 6f6a 6563 745f 666f  path='project_fo
-00005a30: 6c64 6572 2f76 6964 656f 732f 5669 6465  lder/videos/Vide
-00005a40: 6f5f 312e 6176 6927 2c20 7469 6d65 3d31  o_1.avi', time=1
-00005a50: 3029 0a20 2020 2022 2222 0a0a 2020 2020  0).    """..    
-00005a60: 7469 6d65 7220 3d20 5369 6d62 6154 696d  timer = SimbaTim
-00005a70: 6572 2873 7461 7274 3d54 7275 6529 0a20  er(start=True). 
-00005a80: 2020 2063 6865 636b 5f66 696c 655f 6578     check_file_ex
-00005a90: 6973 745f 616e 645f 7265 6164 6162 6c65  ist_and_readable
-00005aa0: 2866 696c 655f 7061 7468 3d66 696c 655f  (file_path=file_
-00005ab0: 7061 7468 290a 2020 2020 6368 6563 6b5f  path).    check_
-00005ac0: 696e 7428 6e61 6d65 3d22 4375 7420 7469  int(name="Cut ti
-00005ad0: 6d65 222c 2076 616c 7565 3d74 696d 6529  me", value=time)
-00005ae0: 0a20 2020 2064 6972 2c20 6669 6c65 5f6e  .    dir, file_n
-00005af0: 616d 652c 2065 7874 203d 2067 6574 5f66  ame, ext = get_f
-00005b00: 6e5f 6578 7428 6669 6c65 7061 7468 3d66  n_ext(filepath=f
-00005b10: 696c 655f 7061 7468 290a 2020 2020 7361  ile_path).    sa
-00005b20: 7665 5f6e 616d 6520 3d20 6f73 2e70 6174  ve_name = os.pat
-00005b30: 682e 6a6f 696e 2864 6972 2c20 6669 6c65  h.join(dir, file
-00005b40: 5f6e 616d 6520 2b20 225f 7368 6f72 7465  _name + "_shorte
-00005b50: 6e2e 6d70 3422 290a 2020 2020 6966 206f  n.mp4").    if o
-00005b60: 732e 7061 7468 2e69 7366 696c 6528 7361  s.path.isfile(sa
-00005b70: 7665 5f6e 616d 6529 3a0a 2020 2020 2020  ve_name):.      
-00005b80: 2020 7261 6973 6520 4669 6c65 4578 6973    raise FileExis
-00005b90: 7445 7272 6f72 280a 2020 2020 2020 2020  tError(.        
-00005ba0: 2020 2020 6d73 673d 2253 494d 4241 2045      msg="SIMBA E
-00005bb0: 5252 4f52 3a20 5468 6520 6f75 7466 696c  RROR: The outfil
-00005bc0: 6520 6669 6c65 2061 6c72 6561 6479 2065  e file already e
-00005bd0: 7869 7374 3a20 7b7d 2e22 2e66 6f72 6d61  xist: {}.".forma
-00005be0: 7428 7361 7665 5f6e 616d 6529 2c0a 2020  t(save_name),.  
-00005bf0: 2020 2020 2020 2020 2020 736f 7572 6365            source
-00005c00: 3d72 656d 6f76 655f 6265 6769 6e6e 696e  =remove_beginnin
-00005c10: 675f 6f66 5f76 6964 656f 2e5f 5f6e 616d  g_of_video.__nam
-00005c20: 655f 5f2c 0a20 2020 2020 2020 2029 0a20  e__,.        ). 
-00005c30: 2020 2069 6620 6770 753a 0a20 2020 2020     if gpu:.     
-00005c40: 2020 2069 6620 6e6f 7420 6368 6563 6b5f     if not check_
-00005c50: 6e76 6964 6561 5f67 7075 5f61 7661 696c  nvidea_gpu_avail
-00005c60: 6162 6c65 2829 3a0a 2020 2020 2020 2020  able():.        
-00005c70: 2020 2020 7261 6973 6520 4646 4d50 4547      raise FFMPEG
-00005c80: 436f 6465 6347 5055 4572 726f 7228 0a20  CodecGPUError(. 
-00005c90: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00005ca0: 7367 3d22 4e6f 2047 5055 2066 6f75 6e64  sg="No GPU found
-00005cb0: 2028 6173 2065 7661 6c75 6174 6564 2062   (as evaluated b
-00005cc0: 7920 6e76 6964 6561 2d73 6d69 2072 6574  y nvidea-smi ret
-00005cd0: 7572 6e69 6e67 204e 6f6e 6529 222c 0a20  urning None)",. 
-00005ce0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00005cf0: 6f75 7263 653d 7265 6d6f 7665 5f62 6567  ource=remove_beg
-00005d00: 696e 6e69 6e67 5f6f 665f 7669 6465 6f2e  inning_of_video.
-00005d10: 5f5f 6e61 6d65 5f5f 2c0a 2020 2020 2020  __name__,.      
-00005d20: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00005d30: 636f 6d6d 616e 6420 3d20 2766 666d 7065  command = 'ffmpe
-00005d40: 6720 2d68 7761 6363 656c 2061 7574 6f20  g -hwaccel auto 
-00005d50: 2d63 3a76 2068 3236 345f 6375 7669 6420  -c:v h264_cuvid 
-00005d60: 2d73 7320 7b7d 202d 6920 227b 7d22 202d  -ss {} -i "{}" -
-00005d70: 633a 7620 6832 3634 5f6e 7665 6e63 202d  c:v h264_nvenc -
-00005d80: 633a 6120 6161 6320 227b 7d22 272e 666f  c:a aac "{}"'.fo
-00005d90: 726d 6174 280a 2020 2020 2020 2020 2020  rmat(.          
-00005da0: 2020 696e 7428 7469 6d65 292c 2066 696c    int(time), fil
-00005db0: 655f 7061 7468 2c20 7361 7665 5f6e 616d  e_path, save_nam
-00005dc0: 650a 2020 2020 2020 2020 290a 2020 2020  e.        ).    
-00005dd0: 656c 7365 3a0a 2020 2020 2020 2020 636f  else:.        co
-00005de0: 6d6d 616e 6420 3d20 280a 2020 2020 2020  mmand = (.      
-00005df0: 2020 2020 2020 7374 7228 2266 666d 7065        str("ffmpe
-00005e00: 6720 2d73 7320 2229 0a20 2020 2020 2020  g -ss ").       
-00005e10: 2020 2020 202b 2073 7472 2869 6e74 2874       + str(int(t
-00005e20: 696d 6529 290a 2020 2020 2020 2020 2020  ime)).          
-00005e30: 2020 2b20 2220 2d69 2022 0a20 2020 2020    + " -i ".     
-00005e40: 2020 2020 2020 202b 2027 2227 0a20 2020         + '"'.   
-00005e50: 2020 2020 2020 2020 202b 2073 7472 2866           + str(f
-00005e60: 696c 655f 7061 7468 290a 2020 2020 2020  ile_path).      
-00005e70: 2020 2020 2020 2b20 2722 270a 2020 2020        + '"'.    
-00005e80: 2020 2020 2020 2020 2b20 2220 2d63 3a76          + " -c:v
-00005e90: 206c 6962 7832 3634 202d 633a 6120 6161   libx264 -c:a aa
-00005ea0: 6320 220a 2020 2020 2020 2020 2020 2020  c ".            
-00005eb0: 2b20 2722 270a 2020 2020 2020 2020 2020  + '"'.          
-00005ec0: 2020 2b20 7361 7665 5f6e 616d 650a 2020    + save_name.  
-00005ed0: 2020 2020 2020 2020 2020 2b20 2722 270a            + '"'.
-00005ee0: 2020 2020 2020 2020 290a 2020 2020 7072          ).    pr
-00005ef0: 696e 7428 2253 686f 7274 656e 696e 6720  int("Shortening 
-00005f00: 7669 6465 6f2e 2e2e 2022 290a 2020 2020  video... ").    
-00005f10: 7375 6270 726f 6365 7373 2e63 616c 6c28  subprocess.call(
-00005f20: 636f 6d6d 616e 642c 2073 6865 6c6c 3d54  command, shell=T
-00005f30: 7275 652c 2073 7464 6f75 743d 7375 6270  rue, stdout=subp
-00005f40: 726f 6365 7373 2e50 4950 4529 0a20 2020  rocess.PIPE).   
-00005f50: 2074 696d 6572 2e73 746f 705f 7469 6d65   timer.stop_time
-00005f60: 7228 290a 2020 2020 7374 646f 7574 5f73  r().    stdout_s
-00005f70: 7563 6365 7373 280a 2020 2020 2020 2020  uccess(.        
-00005f80: 6d73 673d 6622 5349 4d42 4120 434f 4d50  msg=f"SIMBA COMP
-00005f90: 4c45 5445 3a20 5669 6465 6f20 636f 6e76  LETE: Video conv
-00005fa0: 6572 7465 6421 207b 7361 7665 5f6e 616d  erted! {save_nam
-00005fb0: 657d 2067 656e 6572 6174 6564 2122 2c0a  e} generated!",.
-00005fc0: 2020 2020 2020 2020 656c 6170 7365 645f          elapsed_
-00005fd0: 7469 6d65 3d74 696d 6572 2e65 6c61 7073  time=timer.elaps
-00005fe0: 6564 5f74 696d 655f 7374 722c 0a20 2020  ed_time_str,.   
-00005ff0: 2020 2020 2073 6f75 7263 653d 7265 6d6f       source=remo
-00006000: 7665 5f62 6567 696e 6e69 6e67 5f6f 665f  ve_beginning_of_
-00006010: 7669 6465 6f2e 5f5f 6e61 6d65 5f5f 2c0a  video.__name__,.
-00006020: 2020 2020 290a 0a0a 2320 7265 6d6f 7665      )...# remove
-00006030: 5f62 6567 696e 6e69 6e67 5f6f 665f 7669  _beginning_of_vi
-00006040: 6465 6f28 6669 6c65 5f70 6174 683d 7227  deo(file_path=r'
-00006050: 433a 5c55 7365 7273 5c4e 6170 655f 436f  C:\Users\Nape_Co
-00006060: 6d70 7574 6572 5f32 5c44 6573 6b74 6f70  mputer_2\Desktop
-00006070: 5c74 6573 745f 7669 6465 6f73 5c42 6f78  \test_videos\Box
-00006080: 315f 504d 325f 6461 795f 355f 3230 3231  1_PM2_day_5_2021
-00006090: 3131 3034 5431 3731 3032 312e 6d70 3427  1104T171021.mp4'
-000060a0: 2c20 7469 6d65 3d31 302c 2067 7075 3d54  , time=10, gpu=T
-000060b0: 7275 6529 0a0a 0a64 6566 2063 6c69 705f  rue)...def clip_
-000060c0: 7669 6465 6f5f 696e 5f72 616e 6765 280a  video_in_range(.
-000060d0: 2020 2020 6669 6c65 5f70 6174 683a 2055      file_path: U
-000060e0: 6e69 6f6e 5b73 7472 2c20 6f73 2e50 6174  nion[str, os.Pat
-000060f0: 684c 696b 655d 2c0a 2020 2020 7374 6172  hLike],.    star
-00006100: 745f 7469 6d65 3a20 7374 722c 0a20 2020  t_time: str,.   
-00006110: 2065 6e64 5f74 696d 653a 2073 7472 2c0a   end_time: str,.
-00006120: 2020 2020 6f75 745f 6469 723a 204f 7074      out_dir: Opt
-00006130: 696f 6e61 6c5b 556e 696f 6e5b 7374 722c  ional[Union[str,
-00006140: 206f 732e 5061 7468 4c69 6b65 5d5d 203d   os.PathLike]] =
-00006150: 204e 6f6e 652c 0a20 2020 206f 7665 7277   None,.    overw
-00006160: 7269 7465 3a20 4f70 7469 6f6e 616c 5b62  rite: Optional[b
-00006170: 6f6f 6c5d 203d 2046 616c 7365 2c0a 2020  ool] = False,.  
-00006180: 2020 696e 636c 7564 655f 636c 6970 5f74    include_clip_t
-00006190: 696d 655f 696e 5f66 696c 656e 616d 653a  ime_in_filename:
-000061a0: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
-000061b0: 3d20 4661 6c73 652c 0a20 2020 2067 7075  = False,.    gpu
-000061c0: 3a20 4f70 7469 6f6e 616c 5b62 6f6f 6c5d  : Optional[bool]
-000061d0: 203d 2046 616c 7365 2c0a 2920 2d3e 204e   = False,.) -> N
-000061e0: 6f6e 653a 0a20 2020 2022 2222 0a20 2020  one:.    """.   
-000061f0: 2043 6c69 7020 7669 6465 6f20 7769 7468   Clip video with
-00006200: 696e 2061 2073 7065 6369 6669 6320 7261  in a specific ra
-00006210: 6e67 652e 2054 6865 2072 6573 756c 7420  nge. The result 
-00006220: 6973 2073 746f 7265 6420 696e 2074 6865  is stored in the
-00006230: 2073 616d 6520 6469 7265 6374 6f72 7920   same directory 
-00006240: 6173 2074 6865 0a20 2020 2069 6e70 7574  as the.    input
-00006250: 2066 696c 6520 7769 7468 2074 6865 2060   file with the `
-00006260: 605f 636c 6970 7065 642e 6d70 3460 6020  `_clipped.mp4`` 
-00006270: 7375 6666 6978 2e0a 0a20 2020 203a 7061  suffix...    :pa
-00006280: 7261 6d65 7465 7220 556e 696f 6e5b 7374  rameter Union[st
-00006290: 722c 206f 732e 5061 7468 4c69 6b65 5d20  r, os.PathLike] 
-000062a0: 6669 6c65 5f70 6174 683a 2050 6174 6820  file_path: Path 
-000062b0: 746f 2076 6964 656f 2066 696c 650a 2020  to video file.  
-000062c0: 2020 3a70 6172 616d 6574 6572 2073 7472    :parameter str
-000062d0: 2073 7461 7274 5f74 696d 653a 2053 7461   start_time: Sta
-000062e0: 7274 2074 696d 6520 696e 2048 483a 4d4d  rt time in HH:MM
-000062f0: 3a53 5320 666f 726d 6174 2e0a 2020 2020  :SS format..    
-00006300: 3a70 6172 616d 6574 6572 2073 7472 2065  :parameter str e
-00006310: 6e64 5f74 696d 653a 2045 6e64 2074 696d  nd_time: End tim
-00006320: 6520 696e 2048 483a 4d4d 3a53 5320 666f  e in HH:MM:SS fo
-00006330: 726d 6174 2e0a 2020 2020 3a70 6172 616d  rmat..    :param
-00006340: 6574 6572 204f 7074 696f 6e61 6c5b 556e  eter Optional[Un
-00006350: 696f 6e5b 7374 722c 206f 732e 5061 7468  ion[str, os.Path
-00006360: 4c69 6b65 5d5d 206f 7574 5f64 6972 3a20  Like]] out_dir: 
-00006370: 4966 204e 6f6e 652c 2074 6865 6e20 7468  If None, then th
-00006380: 6520 636c 6970 2077 696c 6c20 6265 2073  e clip will be s
-00006390: 746f 7265 6420 696e 2074 6865 2073 616d  tored in the sam
-000063a0: 6520 6469 7220 6173 2074 6865 2069 6e70  e dir as the inp
-000063b0: 7574 2076 6964 656f 2e20 4966 2064 6972  ut video. If dir
-000063c0: 6563 746f 7279 2c20 7468 656e 2074 6865  ectory, then the
-000063d0: 206c 6f63 6174 696f 6e20 6f66 2074 6865   location of the
-000063e0: 206f 7574 7075 7420 6669 6c65 732e 0a20   output files.. 
-000063f0: 2020 203a 7061 7261 6d65 7465 7220 4f70     :parameter Op
-00006400: 7469 6f6e 616c 5b62 6f6f 6c5d 2069 6e63  tional[bool] inc
-00006410: 6c75 6465 5f63 6c69 705f 7469 6d65 5f69  lude_clip_time_i
-00006420: 6e5f 6669 6c65 6e61 6d65 3a20 4966 2054  n_filename: If T
-00006430: 7275 652c 2069 6e63 6c75 6465 2074 6865  rue, include the
-00006440: 2063 6c69 7020 7374 6172 7420 616e 6420   clip start and 
-00006450: 656e 6420 696e 2048 482d 4d4d 2d53 5320  end in HH-MM-SS 
-00006460: 666f 726d 6174 2061 7320 7375 6666 6978  format as suffix
-00006470: 2069 6e20 7468 6520 6669 6c65 6e61 6d65   in the filename
-00006480: 2e20 4966 2046 616c 7365 2c20 7468 656e  . If False, then
-00006490: 2075 7365 2069 6e74 6567 6572 2073 7566   use integer suf
-000064a0: 6669 6320 7265 7072 6573 656e 7469 6e67  fic representing
-000064b0: 2074 6865 2063 6f75 6e74 2e0a 2020 2020   the count..    
-000064c0: 3a70 6172 616d 6574 6572 204f 7074 696f  :parameter Optio
-000064d0: 6e61 6c5b 626f 6f6c 5d20 6f76 6572 7772  nal[bool] overwr
-000064e0: 6974 653a 2049 6620 5472 7565 2c20 7468  ite: If True, th
-000064f0: 6520 6f76 6572 7772 6974 6520 6f75 7470  e overwrite outp
-00006500: 7574 2066 696c 6520 6966 2070 6174 6820  ut file if path 
-00006510: 616c 7265 6164 7920 6578 6973 742e 2049  already exist. I
-00006520: 6620 4661 6c73 652c 2074 6865 6e20 7261  f False, then ra
-00006530: 6973 6520 4669 6c65 4578 6973 7445 7272  ise FileExistErr
-00006540: 6f72 2e0a 2020 2020 3a70 6172 616d 6574  or..    :paramet
-00006550: 6572 204f 7074 696f 6e61 6c5b 626f 6f6c  er Optional[bool
-00006560: 5d20 6770 753a 2049 6620 5472 7565 2c20  ] gpu: If True, 
-00006570: 7573 6520 4e56 4944 4541 2047 5055 2063  use NVIDEA GPU c
-00006580: 6f64 6563 732e 2044 6566 6175 6c74 2046  odecs. Default F
-00006590: 616c 7365 2e0a 0a20 2020 203a 6578 616d  alse...    :exam
-000065a0: 706c 653a 0a20 2020 203e 3e3e 205f 203d  ple:.    >>> _ =
-000065b0: 2063 6c69 705f 7669 6465 6f5f 696e 5f72   clip_video_in_r
-000065c0: 616e 6765 2866 696c 655f 7061 7468 3d27  ange(file_path='
-000065d0: 7072 6f6a 6563 745f 666f 6c64 6572 2f76  project_folder/v
-000065e0: 6964 656f 732f 5669 6465 6f5f 312e 6176  ideos/Video_1.av
-000065f0: 6927 2c20 7374 6172 745f 7469 6d65 3d27  i', start_time='
-00006600: 3030 3a30 303a 3035 272c 2065 6e64 5f74  00:00:05', end_t
-00006610: 696d 653d 2730 303a 3030 3a31 3027 290a  ime='00:00:10').
-00006620: 2020 2020 2222 220a 0a20 2020 2069 6620      """..    if 
-00006630: 6770 7520 616e 6420 6e6f 7420 6368 6563  gpu and not chec
-00006640: 6b5f 6e76 6964 6561 5f67 7075 5f61 7661  k_nvidea_gpu_ava
-00006650: 696c 6162 6c65 2829 3a0a 2020 2020 2020  ilable():.      
-00006660: 2020 7261 6973 6520 4646 4d50 4547 436f    raise FFMPEGCo
-00006670: 6465 6347 5055 4572 726f 7228 0a20 2020  decGPUError(.   
-00006680: 2020 2020 2020 2020 206d 7367 3d22 4e6f           msg="No
-00006690: 2047 5055 2066 6f75 6e64 2028 6173 2065   GPU found (as e
-000066a0: 7661 6c75 6174 6564 2062 7920 6e76 6964  valuated by nvid
-000066b0: 6561 2d73 6d69 2072 6574 7572 6e69 6e67  ea-smi returning
-000066c0: 204e 6f6e 6529 222c 0a20 2020 2020 2020   None)",.       
-000066d0: 2020 2020 2073 6f75 7263 653d 636c 6970       source=clip
-000066e0: 5f76 6964 656f 5f69 6e5f 7261 6e67 652e  _video_in_range.
-000066f0: 5f5f 6e61 6d65 5f5f 2c0a 2020 2020 2020  __name__,.      
-00006700: 2020 290a 2020 2020 7469 6d65 7220 3d20    ).    timer = 
-00006710: 5369 6d62 6154 696d 6572 2873 7461 7274  SimbaTimer(start
-00006720: 3d54 7275 6529 0a20 2020 2063 6865 636b  =True).    check
-00006730: 5f66 696c 655f 6578 6973 745f 616e 645f  _file_exist_and_
-00006740: 7265 6164 6162 6c65 2866 696c 655f 7061  readable(file_pa
-00006750: 7468 3d66 696c 655f 7061 7468 290a 2020  th=file_path).  
-00006760: 2020 6469 722c 2066 696c 655f 6e61 6d65    dir, file_name
-00006770: 2c20 6578 7420 3d20 6765 745f 666e 5f65  , ext = get_fn_e
-00006780: 7874 2866 696c 6570 6174 683d 6669 6c65  xt(filepath=file
-00006790: 5f70 6174 6829 0a20 2020 2069 6620 6f75  _path).    if ou
-000067a0: 745f 6469 7220 6973 206e 6f74 204e 6f6e  t_dir is not Non
-000067b0: 653a 0a20 2020 2020 2020 2063 6865 636b  e:.        check
-000067c0: 5f69 665f 6469 725f 6578 6973 7473 2869  _if_dir_exists(i
-000067d0: 6e5f 6469 723d 6f75 745f 6469 7229 0a20  n_dir=out_dir). 
-000067e0: 2020 2020 2020 2064 6972 203d 206f 7574         dir = out
-000067f0: 5f64 6972 0a20 2020 2063 6865 636b 5f69  _dir.    check_i
-00006800: 665f 7374 7269 6e67 5f76 616c 7565 5f69  f_string_value_i
-00006810: 735f 7661 6c69 645f 7669 6465 6f5f 7469  s_valid_video_ti
-00006820: 6d65 7374 616d 7028 7661 6c75 653d 7374  mestamp(value=st
-00006830: 6172 745f 7469 6d65 2c20 6e61 6d65 3d22  art_time, name="
-00006840: 5354 4152 5420 5449 4d45 2229 0a20 2020  START TIME").   
-00006850: 2063 6865 636b 5f69 665f 7374 7269 6e67   check_if_string
-00006860: 5f76 616c 7565 5f69 735f 7661 6c69 645f  _value_is_valid_
-00006870: 7669 6465 6f5f 7469 6d65 7374 616d 7028  video_timestamp(
-00006880: 7661 6c75 653d 656e 645f 7469 6d65 2c20  value=end_time, 
-00006890: 6e61 6d65 3d22 454e 4420 5449 4d45 2229  name="END TIME")
-000068a0: 0a20 2020 2063 6865 636b 5f74 6861 745f  .    check_that_
-000068b0: 6868 6d6d 7373 5f73 7461 7274 5f69 735f  hhmmss_start_is_
-000068c0: 6265 666f 7265 5f65 6e64 280a 2020 2020  before_end(.    
-000068d0: 2020 2020 7374 6172 745f 7469 6d65 3d73      start_time=s
-000068e0: 7461 7274 5f74 696d 652c 2065 6e64 5f74  tart_time, end_t
-000068f0: 696d 653d 656e 645f 7469 6d65 2c20 6e61  ime=end_time, na
-00006900: 6d65 3d66 227b 6669 6c65 5f6e 616d 657d  me=f"{file_name}
-00006910: 2074 696d 6573 7461 6d70 7322 0a20 2020   timestamps".   
-00006920: 2029 0a20 2020 2069 6620 6e6f 7420 696e   ).    if not in
-00006930: 636c 7564 655f 636c 6970 5f74 696d 655f  clude_clip_time_
-00006940: 696e 5f66 696c 656e 616d 653a 0a20 2020  in_filename:.   
-00006950: 2020 2020 2073 6176 655f 6e61 6d65 203d       save_name =
-00006960: 206f 732e 7061 7468 2e6a 6f69 6e28 6469   os.path.join(di
-00006970: 722c 2066 696c 655f 6e61 6d65 202b 2022  r, file_name + "
-00006980: 5f63 6c69 7070 6564 2e6d 7034 2229 0a20  _clipped.mp4"). 
-00006990: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-000069a0: 2073 6176 655f 6e61 6d65 203d 206f 732e   save_name = os.
-000069b0: 7061 7468 2e6a 6f69 6e28 0a20 2020 2020  path.join(.     
-000069c0: 2020 2020 2020 2064 6972 2c0a 2020 2020         dir,.    
-000069d0: 2020 2020 2020 2020 6669 6c65 5f6e 616d          file_nam
-000069e0: 650a 2020 2020 2020 2020 2020 2020 2b20  e.            + 
-000069f0: 6627 5f7b 7374 6172 745f 7469 6d65 2e72  f'_{start_time.r
-00006a00: 6570 6c61 6365 2822 3a22 2c20 222d 2229  eplace(":", "-")
-00006a10: 7d5f 7b65 6e64 5f74 696d 652e 7265 706c  }_{end_time.repl
-00006a20: 6163 6528 223a 222c 2022 2d22 297d 2e6d  ace(":", "-")}.m
-00006a30: 7034 272c 0a20 2020 2020 2020 2029 0a20  p4',.        ). 
-00006a40: 2020 2069 6620 6f73 2e70 6174 682e 6973     if os.path.is
-00006a50: 6669 6c65 2873 6176 655f 6e61 6d65 2920  file(save_name) 
-00006a60: 616e 6420 286e 6f74 206f 7665 7277 7269  and (not overwri
-00006a70: 7465 293a 0a20 2020 2020 2020 2072 6169  te):.        rai
-00006a80: 7365 2046 696c 6545 7869 7374 4572 726f  se FileExistErro
-00006a90: 7228 0a20 2020 2020 2020 2020 2020 206d  r(.            m
-00006aa0: 7367 3d66 2253 494d 4241 2045 5252 4f52  sg=f"SIMBA ERROR
-00006ab0: 3a20 5468 6520 6f75 7466 696c 6520 6669  : The outfile fi
-00006ac0: 6c65 2061 6c72 6561 6479 2065 7869 7374  le already exist
-00006ad0: 3a20 7b73 6176 655f 6e61 6d65 7d2e 222c  : {save_name}.",
-00006ae0: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
-00006af0: 7263 653d 636c 6970 5f76 6964 656f 5f69  rce=clip_video_i
-00006b00: 6e5f 7261 6e67 652e 5f5f 6e61 6d65 5f5f  n_range.__name__
-00006b10: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00006b20: 6966 2067 7075 3a0a 2020 2020 2020 2020  if gpu:.        
-00006b30: 636f 6d6d 616e 6420 3d20 6627 6666 6d70  command = f'ffmp
-00006b40: 6567 202d 6877 6163 6365 6c20 6175 746f  eg -hwaccel auto
-00006b50: 202d 633a 7620 6832 3634 5f63 7576 6964   -c:v h264_cuvid
-00006b60: 202d 6920 227b 6669 6c65 5f70 6174 687d   -i "{file_path}
-00006b70: 2220 2d73 7320 7b73 7461 7274 5f74 696d  " -ss {start_tim
-00006b80: 657d 202d 746f 207b 656e 645f 7469 6d65  e} -to {end_time
-00006b90: 7d20 2d61 7379 6e63 2031 2022 7b73 6176  } -async 1 "{sav
-00006ba0: 655f 6e61 6d65 7d22 202d 7927 0a20 2020  e_name}" -y'.   
-00006bb0: 2065 6c73 653a 0a20 2020 2020 2020 2063   else:.        c
-00006bc0: 6f6d 6d61 6e64 203d 2066 2766 666d 7065  ommand = f'ffmpe
-00006bd0: 6720 2d69 2022 7b66 696c 655f 7061 7468  g -i "{file_path
-00006be0: 7d22 202d 7373 207b 7374 6172 745f 7469  }" -ss {start_ti
-00006bf0: 6d65 7d20 2d74 6f20 7b65 6e64 5f74 696d  me} -to {end_tim
-00006c00: 657d 202d 6173 796e 6320 3120 227b 7361  e} -async 1 "{sa
-00006c10: 7665 5f6e 616d 657d 2220 2d79 270a 2020  ve_name}" -y'.  
-00006c20: 2020 7072 696e 7428 6622 436c 6970 7069    print(f"Clippi
-00006c30: 6e67 2076 6964 656f 207b 6669 6c65 5f6e  ng video {file_n
-00006c40: 616d 657d 2062 6574 7765 656e 207b 7374  ame} between {st
-00006c50: 6172 745f 7469 6d65 7d20 616e 6420 7b65  art_time} and {e
-00006c60: 6e64 5f74 696d 657d 2e2e 2e20 2229 0a20  nd_time}... "). 
-00006c70: 2020 2073 7562 7072 6f63 6573 732e 6361     subprocess.ca
-00006c80: 6c6c 2863 6f6d 6d61 6e64 2c20 7368 656c  ll(command, shel
-00006c90: 6c3d 5472 7565 2c20 7374 646f 7574 3d73  l=True, stdout=s
-00006ca0: 7562 7072 6f63 6573 732e 5049 5045 290a  ubprocess.PIPE).
-00006cb0: 2020 2020 7469 6d65 722e 7374 6f70 5f74      timer.stop_t
-00006cc0: 696d 6572 2829 0a20 2020 2073 7464 6f75  imer().    stdou
-00006cd0: 745f 7375 6363 6573 7328 0a20 2020 2020  t_success(.     
-00006ce0: 2020 206d 7367 3d66 2256 6964 656f 2063     msg=f"Video c
-00006cf0: 6f6e 7665 7274 6564 2120 7b73 6176 655f  onverted! {save_
-00006d00: 6e61 6d65 7d20 6765 6e65 7261 7465 6421  name} generated!
-00006d10: 222c 0a20 2020 2020 2020 2065 6c61 7073  ",.        elaps
-00006d20: 6564 5f74 696d 653d 7469 6d65 722e 656c  ed_time=timer.el
-00006d30: 6170 7365 645f 7469 6d65 5f73 7472 2c0a  apsed_time_str,.
-00006d40: 2020 2020 2020 2020 736f 7572 6365 3d63          source=c
-00006d50: 6c69 705f 7669 6465 6f5f 696e 5f72 616e  lip_video_in_ran
-00006d60: 6765 2e5f 5f6e 616d 655f 5f2c 0a20 2020  ge.__name__,.   
-00006d70: 2029 0a0a 0a64 6566 2064 6f77 6e73 616d   )...def downsam
-00006d80: 706c 655f 7669 6465 6f28 0a20 2020 2066  ple_video(.    f
-00006d90: 696c 655f 7061 7468 3a20 556e 696f 6e5b  ile_path: Union[
-00006da0: 7374 722c 206f 732e 5061 7468 4c69 6b65  str, os.PathLike
-00006db0: 5d2c 0a20 2020 2076 6964 656f 5f68 6569  ],.    video_hei
-00006dc0: 6768 743a 2069 6e74 2c0a 2020 2020 7669  ght: int,.    vi
-00006dd0: 6465 6f5f 7769 6474 683a 2069 6e74 2c0a  deo_width: int,.
-00006de0: 2020 2020 6770 753a 204f 7074 696f 6e61      gpu: Optiona
-00006df0: 6c5b 626f 6f6c 5d20 3d20 4661 6c73 652c  l[bool] = False,
-00006e00: 0a29 202d 3e20 4e6f 6e65 3a0a 2020 2020  .) -> None:.    
-00006e10: 2222 220a 2020 2020 446f 776e 2d73 616d  """.    Down-sam
-00006e20: 706c 6520 6120 7669 6465 6f20 6669 6c65  ple a video file
-00006e30: 2e20 5468 6520 7265 7375 6c74 2069 7320  . The result is 
-00006e40: 7374 6f72 6564 2069 6e20 7468 6520 7361  stored in the sa
-00006e50: 6d65 2064 6972 6563 746f 7279 2061 7320  me directory as 
-00006e60: 7468 650a 2020 2020 696e 7075 7420 6669  the.    input fi
-00006e70: 6c65 2077 6974 6820 7468 6520 6060 5f64  le with the ``_d
-00006e80: 6f77 6e73 616d 706c 6564 2e6d 7034 6060  ownsampled.mp4``
-00006e90: 2073 7566 6669 782e 0a0a 2020 2020 3a70   suffix...    :p
-00006ea0: 6172 616d 6574 6572 2055 6e69 6f6e 5b73  arameter Union[s
-00006eb0: 7472 2c20 6f73 2e50 6174 684c 696b 655d  tr, os.PathLike]
-00006ec0: 2066 696c 655f 7061 7468 3a20 5061 7468   file_path: Path
-00006ed0: 2074 6f20 7669 6465 6f20 6669 6c65 2e0a   to video file..
-00006ee0: 2020 2020 3a70 6172 616d 6574 6572 2069      :parameter i
-00006ef0: 6e74 2076 6964 656f 5f68 6569 6768 743a  nt video_height:
-00006f00: 2068 6569 6768 7420 6f66 206e 6577 2076   height of new v
-00006f10: 6964 656f 2e0a 2020 2020 3a70 6172 616d  ideo..    :param
-00006f20: 6574 6572 2069 6e74 2076 6964 656f 5f77  eter int video_w
-00006f30: 6964 7468 3a20 7769 6474 6820 6f66 206e  idth: width of n
-00006f40: 6577 2076 6964 656f 2e0a 2020 2020 3a70  ew video..    :p
-00006f50: 6172 616d 6574 6572 204f 7074 696f 6e61  arameter Optiona
-00006f60: 6c5b 626f 6f6c 5d20 6770 753a 2049 6620  l[bool] gpu: If 
-00006f70: 5472 7565 2c20 7573 6520 4e56 4944 4541  True, use NVIDEA
-00006f80: 2047 5055 2063 6f64 6563 732e 2044 6566   GPU codecs. Def
-00006f90: 6175 6c74 2046 616c 7365 2e0a 0a20 2020  ault False...   
-00006fa0: 203a 6578 616d 706c 653a 0a20 2020 203e   :example:.    >
-00006fb0: 3e3e 205f 203d 2064 6f77 6e73 616d 706c  >> _ = downsampl
-00006fc0: 655f 7669 6465 6f28 6669 6c65 5f70 6174  e_video(file_pat
-00006fd0: 683d 2770 726f 6a65 6374 5f66 6f6c 6465  h='project_folde
-00006fe0: 722f 7669 6465 6f73 2f56 6964 656f 5f31  r/videos/Video_1
-00006ff0: 2e61 7669 272c 2076 6964 656f 5f68 6569  .avi', video_hei
-00007000: 6768 743d 3630 302c 2076 6964 656f 5f77  ght=600, video_w
-00007010: 6964 7468 3d34 3030 290a 2020 2020 2222  idth=400).    ""
-00007020: 220a 2020 2020 6966 2067 7075 2061 6e64  ".    if gpu and
-00007030: 206e 6f74 2063 6865 636b 5f6e 7669 6465   not check_nvide
-00007040: 615f 6770 755f 6176 6169 6c61 626c 6528  a_gpu_available(
-00007050: 293a 0a20 2020 2020 2020 2072 6169 7365  ):.        raise
-00007060: 2046 464d 5045 4743 6f64 6563 4750 5545   FFMPEGCodecGPUE
-00007070: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00007080: 2020 6d73 673d 224e 6f20 4750 5520 666f    msg="No GPU fo
-00007090: 756e 6420 2861 7320 6576 616c 7561 7465  und (as evaluate
-000070a0: 6420 6279 206e 7669 6465 612d 736d 6920  d by nvidea-smi 
-000070b0: 7265 7475 726e 696e 6720 4e6f 6e65 2922  returning None)"
-000070c0: 2c0a 2020 2020 2020 2020 2020 2020 736f  ,.            so
-000070d0: 7572 6365 3d64 6f77 6e73 616d 706c 655f  urce=downsample_
-000070e0: 7669 6465 6f2e 5f5f 6e61 6d65 5f5f 2c0a  video.__name__,.
-000070f0: 2020 2020 2020 2020 290a 2020 2020 7469          ).    ti
-00007100: 6d65 7220 3d20 5369 6d62 6154 696d 6572  mer = SimbaTimer
-00007110: 2873 7461 7274 3d54 7275 6529 0a20 2020  (start=True).   
-00007120: 2063 6865 636b 5f69 6e74 286e 616d 653d   check_int(name=
-00007130: 2256 6964 656f 2068 6569 6768 7422 2c20  "Video height", 
-00007140: 7661 6c75 653d 7669 6465 6f5f 6865 6967  value=video_heig
-00007150: 6874 290a 2020 2020 6368 6563 6b5f 696e  ht).    check_in
-00007160: 7428 6e61 6d65 3d22 5669 6465 6f20 7769  t(name="Video wi
-00007170: 6474 6822 2c20 7661 6c75 653d 7669 6465  dth", value=vide
-00007180: 6f5f 7769 6474 6829 0a20 2020 2063 6865  o_width).    che
-00007190: 636b 5f66 696c 655f 6578 6973 745f 616e  ck_file_exist_an
-000071a0: 645f 7265 6164 6162 6c65 2866 696c 655f  d_readable(file_
-000071b0: 7061 7468 3d66 696c 655f 7061 7468 290a  path=file_path).
-000071c0: 2020 2020 6469 722c 2066 696c 655f 6e61      dir, file_na
-000071d0: 6d65 2c20 6578 7420 3d20 6765 745f 666e  me, ext = get_fn
-000071e0: 5f65 7874 2866 696c 6570 6174 683d 6669  _ext(filepath=fi
-000071f0: 6c65 5f70 6174 6829 0a20 2020 2073 6176  le_path).    sav
-00007200: 655f 6e61 6d65 203d 206f 732e 7061 7468  e_name = os.path
-00007210: 2e6a 6f69 6e28 6469 722c 2066 696c 655f  .join(dir, file_
-00007220: 6e61 6d65 202b 2022 5f64 6f77 6e73 616d  name + "_downsam
-00007230: 706c 6564 2e6d 7034 2229 0a20 2020 2069  pled.mp4").    i
-00007240: 6620 6f73 2e70 6174 682e 6973 6669 6c65  f os.path.isfile
-00007250: 2873 6176 655f 6e61 6d65 293a 0a20 2020  (save_name):.   
-00007260: 2020 2020 2072 6169 7365 2046 696c 6545       raise FileE
-00007270: 7869 7374 4572 726f 7228 0a20 2020 2020  xistError(.     
-00007280: 2020 2020 2020 2022 5349 4d42 4120 4552         "SIMBA ER
-00007290: 524f 523a 2054 6865 206f 7574 6669 6c65  ROR: The outfile
-000072a0: 2066 696c 6520 616c 7265 6164 7920 6578   file already ex
-000072b0: 6973 743a 207b 7d2e 222e 666f 726d 6174  ist: {}.".format
-000072c0: 2873 6176 655f 6e61 6d65 292c 0a20 2020  (save_name),.   
-000072d0: 2020 2020 2020 2020 2073 6f75 7263 653d           source=
-000072e0: 646f 776e 7361 6d70 6c65 5f76 6964 656f  downsample_video
-000072f0: 2e5f 5f6e 616d 655f 5f2c 0a20 2020 2020  .__name__,.     
-00007300: 2020 2029 0a20 2020 2069 6620 6770 753a     ).    if gpu:
-00007310: 0a20 2020 2020 2020 2063 6f6d 6d61 6e64  .        command
-00007320: 203d 2066 2766 666d 7065 6720 2d79 202d   = f'ffmpeg -y -
-00007330: 6877 6163 6365 6c20 6175 746f 202d 633a  hwaccel auto -c:
-00007340: 7620 6832 3634 5f63 7576 6964 202d 6920  v h264_cuvid -i 
-00007350: 227b 6669 6c65 5f70 6174 687d 2220 2d76  "{file_path}" -v
-00007360: 6620 2273 6361 6c65 3d77 3d7b 7669 6465  f "scale=w={vide
-00007370: 6f5f 7769 6474 687d 3a68 3d7b 7669 6465  o_width}:h={vide
-00007380: 6f5f 6865 6967 6874 7d3a 666f 7263 655f  o_height}:force_
-00007390: 6f72 6967 696e 616c 5f61 7370 6563 745f  original_aspect_
-000073a0: 7261 7469 6f3d 6465 6372 6561 7365 3a66  ratio=decrease:f
-000073b0: 6c61 6773 3d62 6963 7562 6963 2220 2d63  lags=bicubic" -c
-000073c0: 3a76 2068 3236 345f 6e76 656e 6320 227b  :v h264_nvenc "{
-000073d0: 7361 7665 5f6e 616d 657d 2227 0a20 2020  save_name}"'.   
-000073e0: 2065 6c73 653a 0a20 2020 2020 2020 2063   else:.        c
-000073f0: 6f6d 6d61 6e64 203d 2028 0a20 2020 2020  ommand = (.     
-00007400: 2020 2020 2020 2073 7472 2822 6666 6d70         str("ffmp
-00007410: 6567 202d 6920 2229 0a20 2020 2020 2020  eg -i ").       
-00007420: 2020 2020 202b 2027 2227 0a20 2020 2020       + '"'.     
-00007430: 2020 2020 2020 202b 2073 7472 2866 696c         + str(fil
-00007440: 655f 7061 7468 290a 2020 2020 2020 2020  e_path).        
-00007450: 2020 2020 2b20 2722 270a 2020 2020 2020      + '"'.      
-00007460: 2020 2020 2020 2b20 2220 2d76 6620 7363        + " -vf sc
-00007470: 616c 653d 220a 2020 2020 2020 2020 2020  ale=".          
-00007480: 2020 2b20 7374 7228 7669 6465 6f5f 7769    + str(video_wi
-00007490: 6474 6829 0a20 2020 2020 2020 2020 2020  dth).           
-000074a0: 202b 2022 3a22 0a20 2020 2020 2020 2020   + ":".         
-000074b0: 2020 202b 2073 7472 2876 6964 656f 5f68     + str(video_h
-000074c0: 6569 6768 7429 0a20 2020 2020 2020 2020  eight).         
-000074d0: 2020 202b 2022 2022 0a20 2020 2020 2020     + " ".       
-000074e0: 2020 2020 202b 2027 2227 0a20 2020 2020       + '"'.     
-000074f0: 2020 2020 2020 202b 2073 6176 655f 6e61         + save_na
-00007500: 6d65 0a20 2020 2020 2020 2020 2020 202b  me.            +
-00007510: 2027 2227 0a20 2020 2020 2020 2020 2020   '"'.           
-00007520: 202b 2022 202d 6869 6465 5f62 616e 6e65   + " -hide_banne
-00007530: 7222 0a20 2020 2020 2020 2029 0a20 2020  r".        ).   
-00007540: 2070 7269 6e74 2822 446f 776e 2d73 616d   print("Down-sam
-00007550: 706c 696e 6720 7669 6465 6f2e 2e2e 2022  pling video... "
-00007560: 290a 2020 2020 7375 6270 726f 6365 7373  ).    subprocess
-00007570: 2e63 616c 6c28 636f 6d6d 616e 642c 2073  .call(command, s
-00007580: 6865 6c6c 3d54 7275 652c 2073 7464 6f75  hell=True, stdou
-00007590: 743d 7375 6270 726f 6365 7373 2e50 4950  t=subprocess.PIP
-000075a0: 4529 0a20 2020 2074 696d 6572 2e73 746f  E).    timer.sto
-000075b0: 705f 7469 6d65 7228 290a 2020 2020 7374  p_timer().    st
-000075c0: 646f 7574 5f73 7563 6365 7373 280a 2020  dout_success(.  
-000075d0: 2020 2020 2020 6d73 673d 6622 5349 4d42        msg=f"SIMB
-000075e0: 4120 434f 4d50 4c45 5445 3a20 5669 6465  A COMPLETE: Vide
-000075f0: 6f20 636f 6e76 6572 7465 6421 207b 7361  o converted! {sa
-00007600: 7665 5f6e 616d 657d 2067 656e 6572 6174  ve_name} generat
-00007610: 6564 2122 2c0a 2020 2020 2020 2020 656c  ed!",.        el
-00007620: 6170 7365 645f 7469 6d65 3d74 696d 6572  apsed_time=timer
-00007630: 2e65 6c61 7073 6564 5f74 696d 655f 7374  .elapsed_time_st
-00007640: 722c 0a20 2020 2020 2020 2073 6f75 7263  r,.        sourc
-00007650: 653d 646f 776e 7361 6d70 6c65 5f76 6964  e=downsample_vid
-00007660: 656f 2e5f 5f6e 616d 655f 5f2c 0a20 2020  eo.__name__,.   
-00007670: 2029 0a0a 0a23 2064 6f77 6e73 616d 706c   )...# downsampl
-00007680: 655f 7669 6465 6f28 6669 6c65 5f70 6174  e_video(file_pat
-00007690: 683d 7227 433a 5c55 7365 7273 5c4e 6170  h=r'C:\Users\Nap
-000076a0: 655f 436f 6d70 7574 6572 5f32 5c44 6573  e_Computer_2\Des
-000076b0: 6b74 6f70 5c74 6573 745f 7669 6465 6f73  ktop\test_videos
-000076c0: 5c42 6f78 315f 504d 325f 6461 795f 355f  \Box1_PM2_day_5_
-000076d0: 3230 3231 3131 3034 5431 3731 3032 312e  20211104T171021.
-000076e0: 6d70 3427 2c20 7669 6465 6f5f 6865 6967  mp4', video_heig
-000076f0: 6874 3d36 3030 2c20 7669 6465 6f5f 7769  ht=600, video_wi
-00007700: 6474 683d 3430 302c 2067 7075 3d54 7275  dth=400, gpu=Tru
-00007710: 6529 0a0a 0a64 6566 2067 6966 5f63 7265  e)...def gif_cre
-00007720: 6174 6f72 280a 2020 2020 6669 6c65 5f70  ator(.    file_p
-00007730: 6174 683a 2073 7472 2c0a 2020 2020 7374  ath: str,.    st
-00007740: 6172 745f 7469 6d65 3a20 696e 742c 0a20  art_time: int,. 
-00007750: 2020 2064 7572 6174 696f 6e3a 2069 6e74     duration: int
-00007760: 2c0a 2020 2020 7769 6474 683a 2069 6e74  ,.    width: int
-00007770: 2c0a 2020 2020 6770 753a 204f 7074 696f  ,.    gpu: Optio
-00007780: 6e61 6c5b 626f 6f6c 5d20 3d20 4661 6c73  nal[bool] = Fals
-00007790: 652c 0a29 202d 3e20 4e6f 6e65 3a0a 2020  e,.) -> None:.  
-000077a0: 2020 2222 220a 2020 2020 4372 6561 7465    """.    Create
-000077b0: 2061 2073 616d 706c 6520 6769 6620 6672   a sample gif fr
-000077c0: 6f6d 2061 2076 6964 656f 2066 696c 652e  om a video file.
-000077d0: 2054 6865 2072 6573 756c 7420 6973 2073   The result is s
-000077e0: 746f 7265 6420 696e 2074 6865 2073 616d  tored in the sam
-000077f0: 6520 6469 7265 6374 6f72 7920 6173 2074  e directory as t
-00007800: 6865 0a20 2020 2069 6e70 7574 2066 696c  he.    input fil
-00007810: 6520 7769 7468 2074 6865 2060 602e 6769  e with the ``.gi
-00007820: 6660 6020 6669 6c65 2d65 6e64 696e 672e  f`` file-ending.
-00007830: 0a0a 2020 2020 2e2e 206e 6f74 653a 3a0a  ..    .. note::.
-00007840: 2020 2020 2020 2054 6865 2068 6569 6768         The heigh
-00007850: 7420 6973 2061 7574 6f2d 636f 6d70 7574  t is auto-comput
-00007860: 6564 2074 6f20 7265 7461 696e 2061 7370  ed to retain asp
-00007870: 6563 7420 7261 7469 6f0a 0a20 2020 203a  ect ratio..    :
-00007880: 7061 7261 6d65 7465 7220 556e 696f 6e5b  parameter Union[
-00007890: 7374 722c 206f 732e 5061 7468 4c69 6b65  str, os.PathLike
-000078a0: 5d20 6669 6c65 5f70 6174 683a 2050 6174  ] file_path: Pat
-000078b0: 6820 746f 2076 6964 656f 2066 696c 652e  h to video file.
-000078c0: 0a20 2020 203a 7061 7261 6d65 7465 7220  .    :parameter 
-000078d0: 696e 7420 7374 6172 745f 7469 6d65 3a20  int start_time: 
-000078e0: 5374 6172 7420 7469 6d65 206f 6620 7468  Start time of th
-000078f0: 6520 6769 6620 696e 2072 656c 6174 696f  e gif in relatio
-00007900: 6e20 746f 2074 6865 2076 6964 656f 2069  n to the video i
-00007910: 6e20 7365 636f 6e64 732e 0a20 2020 203a  n seconds..    :
-00007920: 7061 7261 6d65 7465 7220 696e 7420 6475  parameter int du
-00007930: 7261 7469 6f6e 3a20 4475 7261 7469 6f6e  ration: Duration
-00007940: 206f 6620 7468 6520 6769 662e 0a20 2020   of the gif..   
-00007950: 203a 7061 7261 6d65 7465 7220 696e 7420   :parameter int 
-00007960: 7769 6474 683a 2057 6964 7468 206f 6620  width: Width of 
-00007970: 7468 6520 6769 662e 0a20 2020 203a 7061  the gif..    :pa
-00007980: 7261 6d65 7465 7220 4f70 7469 6f6e 616c  rameter Optional
-00007990: 5b62 6f6f 6c5d 2067 7075 3a20 4966 2054  [bool] gpu: If T
-000079a0: 7275 652c 2075 7365 204e 5649 4445 4120  rue, use NVIDEA 
-000079b0: 4750 5520 636f 6465 6373 2e20 4465 6661  GPU codecs. Defa
-000079c0: 756c 7420 4661 6c73 652e 0a0a 2020 2020  ult False...    
-000079d0: 3a65 7861 6d70 6c65 3a0a 2020 2020 3e3e  :example:.    >>
-000079e0: 3e20 5f20 3d20 6769 665f 6372 6561 746f  > _ = gif_creato
-000079f0: 7228 6669 6c65 5f70 6174 683d 2770 726f  r(file_path='pro
-00007a00: 6a65 6374 5f66 6f6c 6465 722f 7669 6465  ject_folder/vide
-00007a10: 6f73 2f56 6964 656f 5f31 2e61 7669 272c  os/Video_1.avi',
-00007a20: 2073 7461 7274 5f74 696d 653d 352c 2064   start_time=5, d
-00007a30: 7572 6174 696f 6e3d 3130 2c20 7769 6474  uration=10, widt
-00007a40: 683d 3630 3029 0a20 2020 2022 2222 0a0a  h=600).    """..
-00007a50: 2020 2020 7469 6d65 7220 3d20 5369 6d62      timer = Simb
-00007a60: 6154 696d 6572 2873 7461 7274 3d54 7275  aTimer(start=Tru
-00007a70: 6529 0a20 2020 2069 6620 6770 7520 616e  e).    if gpu an
-00007a80: 6420 6e6f 7420 6368 6563 6b5f 6e76 6964  d not check_nvid
-00007a90: 6561 5f67 7075 5f61 7661 696c 6162 6c65  ea_gpu_available
-00007aa0: 2829 3a0a 2020 2020 2020 2020 7261 6973  ():.        rais
-00007ab0: 6520 4646 4d50 4547 436f 6465 6347 5055  e FFMPEGCodecGPU
-00007ac0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-00007ad0: 2020 206d 7367 3d22 4e56 4944 4541 2047     msg="NVIDEA G
-00007ae0: 5055 206e 6f74 2061 7661 696c 6162 6c65  PU not available
-00007af0: 2028 6173 2065 7661 6c75 6174 6564 2062   (as evaluated b
-00007b00: 7920 6e76 6964 6561 2d73 6d69 2072 6574  y nvidea-smi ret
-00007b10: 7572 6e69 6e67 204e 6f6e 6522 2c0a 2020  urning None",.  
-00007b20: 2020 2020 2020 2020 2020 736f 7572 6365            source
-00007b30: 3d67 6966 5f63 7265 6174 6f72 2e5f 5f6e  =gif_creator.__n
-00007b40: 616d 655f 5f2c 0a20 2020 2020 2020 2029  ame__,.        )
-00007b50: 0a20 2020 2063 6865 636b 5f66 696c 655f  .    check_file_
-00007b60: 6578 6973 745f 616e 645f 7265 6164 6162  exist_and_readab
-00007b70: 6c65 2866 696c 655f 7061 7468 3d66 696c  le(file_path=fil
-00007b80: 655f 7061 7468 290a 2020 2020 6368 6563  e_path).    chec
-00007b90: 6b5f 696e 7428 6e61 6d65 3d22 5374 6172  k_int(name="Star
-00007ba0: 7420 7469 6d65 222c 2076 616c 7565 3d73  t time", value=s
-00007bb0: 7461 7274 5f74 696d 6529 0a20 2020 2063  tart_time).    c
-00007bc0: 6865 636b 5f69 6e74 286e 616d 653d 2244  heck_int(name="D
-00007bd0: 7572 6174 696f 6e22 2c20 7661 6c75 653d  uration", value=
-00007be0: 6475 7261 7469 6f6e 290a 2020 2020 6368  duration).    ch
-00007bf0: 6563 6b5f 696e 7428 6e61 6d65 3d22 5769  eck_int(name="Wi
-00007c00: 6474 6822 2c20 7661 6c75 653d 7769 6474  dth", value=widt
-00007c10: 6829 0a20 2020 205f 203d 2067 6574 5f76  h).    _ = get_v
-00007c20: 6964 656f 5f6d 6574 615f 6461 7461 2866  ideo_meta_data(f
-00007c30: 696c 655f 7061 7468 290a 2020 2020 6469  ile_path).    di
-00007c40: 722c 2066 696c 655f 6e61 6d65 2c20 6578  r, file_name, ex
-00007c50: 7420 3d20 6765 745f 666e 5f65 7874 2866  t = get_fn_ext(f
-00007c60: 696c 6570 6174 683d 6669 6c65 5f70 6174  ilepath=file_pat
-00007c70: 6829 0a20 2020 2073 6176 655f 6e61 6d65  h).    save_name
-00007c80: 203d 206f 732e 7061 7468 2e6a 6f69 6e28   = os.path.join(
-00007c90: 6469 722c 2066 696c 655f 6e61 6d65 202b  dir, file_name +
-00007ca0: 2022 2e67 6966 2229 0a20 2020 2069 6620   ".gif").    if 
-00007cb0: 6f73 2e70 6174 682e 6973 6669 6c65 2873  os.path.isfile(s
-00007cc0: 6176 655f 6e61 6d65 293a 0a20 2020 2020  ave_name):.     
-00007cd0: 2020 2072 6169 7365 2046 696c 6545 7869     raise FileExi
-00007ce0: 7374 4572 726f 7228 0a20 2020 2020 2020  stError(.       
-00007cf0: 2020 2020 2022 5349 4d42 4120 4552 524f       "SIMBA ERRO
-00007d00: 523a 2054 6865 206f 7574 6669 6c65 2066  R: The outfile f
-00007d10: 696c 6520 616c 7265 6164 7920 6578 6973  ile already exis
-00007d20: 743a 207b 7d2e 222e 666f 726d 6174 2873  t: {}.".format(s
-00007d30: 6176 655f 6e61 6d65 292c 0a20 2020 2020  ave_name),.     
-00007d40: 2020 2020 2020 2073 6f75 7263 653d 6769         source=gi
-00007d50: 665f 6372 6561 746f 722e 5f5f 6e61 6d65  f_creator.__name
-00007d60: 5f5f 2c0a 2020 2020 2020 2020 290a 2020  __,.        ).  
-00007d70: 2020 6966 2067 7075 3a0a 2020 2020 2020    if gpu:.      
-00007d80: 2020 636f 6d6d 616e 6420 3d20 6627 6666    command = f'ff
-00007d90: 6d70 6567 202d 6877 6163 6365 6c20 6175  mpeg -hwaccel au
-00007da0: 746f 202d 633a 7620 6832 3634 5f63 7576  to -c:v h264_cuv
-00007db0: 6964 202d 7373 207b 7374 6172 745f 7469  id -ss {start_ti
-00007dc0: 6d65 7d20 2d69 2022 7b66 696c 655f 7061  me} -i "{file_pa
-00007dd0: 7468 7d22 202d 746f 207b 6475 7261 7469  th}" -to {durati
-00007de0: 6f6e 7d20 2d76 6620 2266 7073 3d31 302c  on} -vf "fps=10,
-00007df0: 7363 616c 653d 7b77 6964 7468 7d3a 2d31  scale={width}:-1
-00007e00: 2220 2d63 3a76 2067 6966 202d 7069 785f  " -c:v gif -pix_
-00007e10: 666d 7420 7267 6232 3420 2d79 2022 7b73  fmt rgb24 -y "{s
-00007e20: 6176 655f 6e61 6d65 7d22 202d 7927 0a20  ave_name}" -y'. 
-00007e30: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00007e40: 2063 6f6d 6d61 6e64 203d 2028 0a20 2020   command = (.   
-00007e50: 2020 2020 2020 2020 2022 6666 6d70 6567           "ffmpeg
-00007e60: 202d 7373 2022 0a20 2020 2020 2020 2020   -ss ".         
-00007e70: 2020 202b 2073 7472 2873 7461 7274 5f74     + str(start_t
-00007e80: 696d 6529 0a20 2020 2020 2020 2020 2020  ime).           
-00007e90: 202b 2022 202d 7420 220a 2020 2020 2020   + " -t ".      
-00007ea0: 2020 2020 2020 2b20 7374 7228 6475 7261        + str(dura
-00007eb0: 7469 6f6e 290a 2020 2020 2020 2020 2020  tion).          
-00007ec0: 2020 2b20 2220 2d69 2022 0a20 2020 2020    + " -i ".     
-00007ed0: 2020 2020 2020 202b 2027 2227 0a20 2020         + '"'.   
-00007ee0: 2020 2020 2020 2020 202b 2073 7472 2866           + str(f
-00007ef0: 696c 655f 7061 7468 290a 2020 2020 2020  ile_path).      
-00007f00: 2020 2020 2020 2b20 2722 270a 2020 2020        + '"'.    
-00007f10: 2020 2020 2020 2020 2b20 2720 2d66 696c          + ' -fil
-00007f20: 7465 725f 636f 6d70 6c65 7820 225b 303a  ter_complex "[0:
-00007f30: 765d 2066 7073 3d31 352c 7363 616c 653d  v] fps=15,scale=
-00007f40: 773d 270a 2020 2020 2020 2020 2020 2020  w='.            
-00007f50: 2b20 7374 7228 7769 6474 6829 0a20 2020  + str(width).   
-00007f60: 2020 2020 2020 2020 202b 2027 3a68 3d2d           + ':h=-
-00007f70: 312c 7370 6c69 7420 5b61 5d5b 625d 3b5b  1,split [a][b];[
-00007f80: 615d 2070 616c 6574 7465 6765 6e3d 7374  a] palettegen=st
-00007f90: 6174 735f 6d6f 6465 3d73 696e 676c 6520  ats_mode=single 
-00007fa0: 5b70 5d3b 5b62 5d5b 705d 2070 616c 6574  [p];[b][p] palet
-00007fb0: 7465 7573 653d 6e65 773d 3122 2027 0a20  teuse=new=1" '. 
-00007fc0: 2020 2020 2020 2020 2020 202b 2027 2227             + '"'
-00007fd0: 0a20 2020 2020 2020 2020 2020 202b 2073  .            + s
-00007fe0: 7472 2873 6176 655f 6e61 6d65 290a 2020  tr(save_name).  
-00007ff0: 2020 2020 2020 2020 2020 2b20 2722 270a            + '"'.
-00008000: 2020 2020 2020 2020 290a 2020 2020 7072          ).    pr
-00008010: 696e 7428 2243 7265 6174 696e 6720 6769  int("Creating gi
-00008020: 6620 7361 6d70 6c65 2e2e 2e20 2229 0a20  f sample... "). 
-00008030: 2020 2073 7562 7072 6f63 6573 732e 6361     subprocess.ca
-00008040: 6c6c 2863 6f6d 6d61 6e64 2c20 7368 656c  ll(command, shel
-00008050: 6c3d 5472 7565 2c20 7374 646f 7574 3d73  l=True, stdout=s
-00008060: 7562 7072 6f63 6573 732e 5049 5045 290a  ubprocess.PIPE).
-00008070: 2020 2020 7469 6d65 722e 7374 6f70 5f74      timer.stop_t
-00008080: 696d 6572 2829 0a20 2020 2073 7464 6f75  imer().    stdou
-00008090: 745f 7375 6363 6573 7328 0a20 2020 2020  t_success(.     
-000080a0: 2020 206d 7367 3d66 2253 494d 4241 2043     msg=f"SIMBA C
-000080b0: 4f4d 504c 4554 453a 2056 6964 656f 2063  OMPLETE: Video c
-000080c0: 6f6e 7665 7274 6564 2120 7b73 6176 655f  onverted! {save_
-000080d0: 6e61 6d65 7d20 6765 6e65 7261 7465 6421  name} generated!
-000080e0: 222c 0a20 2020 2020 2020 2065 6c61 7073  ",.        elaps
-000080f0: 6564 5f74 696d 653d 7469 6d65 722e 656c  ed_time=timer.el
-00008100: 6170 7365 645f 7469 6d65 5f73 7472 2c0a  apsed_time_str,.
-00008110: 2020 2020 2020 2020 736f 7572 6365 3d67          source=g
-00008120: 6966 5f63 7265 6174 6f72 2e5f 5f6e 616d  if_creator.__nam
-00008130: 655f 5f2c 0a20 2020 2029 0a0a 0a23 2067  e__,.    )...# g
-00008140: 6966 5f63 7265 6174 6f72 2866 696c 655f  if_creator(file_
-00008150: 7061 7468 3d72 2743 3a5c 5573 6572 735c  path=r'C:\Users\
-00008160: 4e61 7065 5f43 6f6d 7075 7465 725f 325c  Nape_Computer_2\
-00008170: 4465 736b 746f 705c 7465 7374 5f76 6964  Desktop\test_vid
-00008180: 656f 735c 426f 7831 5f50 4d32 5f64 6179  eos\Box1_PM2_day
-00008190: 5f35 5f32 3032 3131 3130 3454 3137 3130  _5_20211104T1710
-000081a0: 3231 2e6d 7034 272c 2073 7461 7274 5f74  21.mp4', start_t
-000081b0: 696d 653d 352c 2064 7572 6174 696f 6e3d  ime=5, duration=
-000081c0: 3135 2c20 7769 6474 683d 3630 302c 2067  15, width=600, g
-000081d0: 7075 3d54 7275 6529 0a0a 0a64 6566 2062  pu=True)...def b
-000081e0: 6174 6368 5f63 6f6e 7665 7274 5f76 6964  atch_convert_vid
-000081f0: 656f 5f66 6f72 6d61 7428 0a20 2020 2064  eo_format(.    d
-00008200: 6972 6563 746f 7279 3a20 556e 696f 6e5b  irectory: Union[
-00008210: 7374 722c 206f 732e 5061 7468 4c69 6b65  str, os.PathLike
-00008220: 5d2c 0a20 2020 2069 6e70 7574 5f66 6f72  ],.    input_for
-00008230: 6d61 743a 2073 7472 2c0a 2020 2020 6f75  mat: str,.    ou
-00008240: 7470 7574 5f66 6f72 6d61 743a 2073 7472  tput_format: str
-00008250: 2c0a 2020 2020 6770 753a 204f 7074 696f  ,.    gpu: Optio
-00008260: 6e61 6c5b 626f 6f6c 5d20 3d20 4661 6c73  nal[bool] = Fals
-00008270: 652c 0a29 202d 3e20 4e6f 6e65 3a0a 2020  e,.) -> None:.  
-00008280: 2020 2222 220a 2020 2020 4261 7463 6820    """.    Batch 
-00008290: 636f 6e76 6572 7420 616c 6c20 7669 6465  convert all vide
-000082a0: 6f73 2069 6e20 6120 666f 6c64 6572 206f  os in a folder o
-000082b0: 6620 7370 6563 6966 6963 2066 6f72 6d61  f specific forma
-000082c0: 7420 696e 746f 2061 2064 6966 6665 7265  t into a differe
-000082d0: 6e74 2076 6964 656f 2066 6f72 6d61 742e  nt video format.
-000082e0: 2054 6865 2072 6573 756c 7473 2061 7265   The results are
-000082f0: 0a20 2020 2073 746f 7265 6420 696e 2074  .    stored in t
-00008300: 6865 2073 616d 6520 6469 7265 6374 6f72  he same director
-00008310: 7920 6173 2074 6865 2069 6e70 7574 2066  y as the input f
-00008320: 696c 6573 2e0a 0a20 2020 203a 7061 7261  iles...    :para
-00008330: 6d65 7465 7220 556e 696f 6e5b 7374 722c  meter Union[str,
-00008340: 206f 732e 5061 7468 4c69 6b65 5d20 6469   os.PathLike] di
-00008350: 7265 6374 6f72 793a 2050 6174 6820 746f  rectory: Path to
-00008360: 2076 6964 656f 2066 696c 6520 6469 7265   video file dire
-00008370: 6374 6f72 792e 0a20 2020 203a 7061 7261  ctory..    :para
-00008380: 6d65 7465 7220 7374 7220 696e 7075 745f  meter str input_
-00008390: 666f 726d 6174 3a20 466f 726d 6174 206f  format: Format o
-000083a0: 6620 7468 6520 696e 7075 7420 6669 6c65  f the input file
-000083b0: 7320 2865 2e67 2e2c 2061 7669 292e 0a20  s (e.g., avi).. 
-000083c0: 2020 203a 7061 7261 6d65 7465 7220 7374     :parameter st
-000083d0: 7220 6f75 7470 7574 5f66 6f72 6d61 743a  r output_format:
-000083e0: 2046 6f72 6d61 7420 6f66 2074 6865 206f   Format of the o
-000083f0: 7574 7075 7420 6669 6c65 7320 2865 2e67  utput files (e.g
-00008400: 2e2c 206d 7034 292e 0a20 2020 203a 7061  ., mp4)..    :pa
-00008410: 7261 6d65 7465 7220 4f70 7469 6f6e 616c  rameter Optional
-00008420: 5b62 6f6f 6c5d 2067 7075 3a20 4966 2054  [bool] gpu: If T
-00008430: 7275 652c 2075 7365 204e 5649 4445 4120  rue, use NVIDEA 
-00008440: 4750 5520 636f 6465 6373 2e20 4465 6661  GPU codecs. Defa
-00008450: 756c 7420 4661 6c73 652e 0a0a 2020 2020  ult False...    
-00008460: 3a65 7861 6d70 6c65 3a0a 2020 2020 3e3e  :example:.    >>
-00008470: 3e20 5f20 3d20 6261 7463 685f 636f 6e76  > _ = batch_conv
-00008480: 6572 745f 7669 6465 6f5f 666f 726d 6174  ert_video_format
-00008490: 2864 6972 6563 746f 7279 3d27 7072 6f6a  (directory='proj
-000084a0: 6563 745f 666f 6c64 6572 2f76 6964 656f  ect_folder/video
-000084b0: 7327 2c20 696e 7075 745f 666f 726d 6174  s', input_format
-000084c0: 3d27 6176 6927 2c20 6f75 7470 7574 5f66  ='avi', output_f
-000084d0: 6f72 6d61 743d 276d 7034 2729 0a20 2020  ormat='mp4').   
-000084e0: 2022 2222 0a0a 2020 2020 6966 2067 7075   """..    if gpu
-000084f0: 2061 6e64 206e 6f74 2063 6865 636b 5f6e   and not check_n
-00008500: 7669 6465 615f 6770 755f 6176 6169 6c61  videa_gpu_availa
-00008510: 626c 6528 293a 0a20 2020 2020 2020 2072  ble():.        r
-00008520: 6169 7365 2046 464d 5045 4743 6f64 6563  aise FFMPEGCodec
-00008530: 4750 5545 7272 6f72 280a 2020 2020 2020  GPUError(.      
-00008540: 2020 2020 2020 6d73 673d 224e 5649 4445        msg="NVIDE
-00008550: 4120 4750 5520 6e6f 7420 6176 6169 6c61  A GPU not availa
-00008560: 626c 6520 2861 7320 6576 616c 7561 7465  ble (as evaluate
-00008570: 6420 6279 206e 7669 6465 612d 736d 6920  d by nvidea-smi 
-00008580: 7265 7475 726e 696e 6720 4e6f 6e65 222c  returning None",
-00008590: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
-000085a0: 7263 653d 6261 7463 685f 636f 6e76 6572  rce=batch_conver
-000085b0: 745f 7669 6465 6f5f 666f 726d 6174 2e5f  t_video_format._
-000085c0: 5f6e 616d 655f 5f2c 0a20 2020 2020 2020  _name__,.       
-000085d0: 2029 0a20 2020 2069 6620 696e 7075 745f   ).    if input_
-000085e0: 666f 726d 6174 203d 3d20 6f75 7470 7574  format == output
-000085f0: 5f66 6f72 6d61 743a 0a20 2020 2020 2020  _format:.       
-00008600: 2072 6169 7365 2049 6e76 616c 6964 4669   raise InvalidFi
-00008610: 6c65 5479 7065 4572 726f 7228 0a20 2020  leTypeError(.   
-00008620: 2020 2020 2020 2020 206d 7367 3d66 2254           msg=f"T
-00008630: 6865 2069 6e70 7574 2066 6f72 6d61 7420  he input format 
-00008640: 287b 696e 7075 745f 666f 726d 6174 7d29  ({input_format})
-00008650: 2069 7320 7468 6520 7361 6d65 2061 7320   is the same as 
-00008660: 7468 6520 6f75 7470 7574 2066 6f72 6d61  the output forma
-00008670: 7420 287b 6f75 7470 7574 5f66 6f72 6d61  t ({output_forma
-00008680: 747d 2922 2c0a 2020 2020 2020 2020 2020  t})",.          
-00008690: 2020 736f 7572 6365 3d62 6174 6368 5f63    source=batch_c
-000086a0: 6f6e 7665 7274 5f76 6964 656f 5f66 6f72  onvert_video_for
-000086b0: 6d61 742e 5f5f 6e61 6d65 5f5f 2c0a 2020  mat.__name__,.  
-000086c0: 2020 2020 2020 290a 2020 2020 6966 206e        ).    if n
-000086d0: 6f74 206f 732e 7061 7468 2e69 7364 6972  ot os.path.isdir
-000086e0: 2864 6972 6563 746f 7279 293a 0a20 2020  (directory):.   
-000086f0: 2020 2020 2072 6169 7365 204e 6f74 4469       raise NotDi
-00008700: 7265 6374 6f72 7945 7272 6f72 280a 2020  rectoryError(.  
-00008710: 2020 2020 2020 2020 2020 6d73 673d 2253            msg="S
-00008720: 494d 4241 2045 5252 4f52 3a20 7b7d 2069  IMBA ERROR: {} i
-00008730: 7320 6e6f 7420 6120 7661 6c69 6420 6469  s not a valid di
-00008740: 7265 6374 6f72 7922 2e66 6f72 6d61 7428  rectory".format(
-00008750: 6469 7265 6374 6f72 7929 2c0a 2020 2020  directory),.    
-00008760: 2020 2020 2020 2020 736f 7572 6365 3d62          source=b
-00008770: 6174 6368 5f63 6f6e 7665 7274 5f76 6964  atch_convert_vid
-00008780: 656f 5f66 6f72 6d61 742e 5f5f 6e61 6d65  eo_format.__name
-00008790: 5f5f 2c0a 2020 2020 2020 2020 290a 2020  __,.        ).  
-000087a0: 2020 7669 6465 6f5f 7061 7468 7320 3d20    video_paths = 
-000087b0: 5b5d 0a20 2020 2066 696c 655f 7061 7468  [].    file_path
-000087c0: 735f 696e 5f66 6f6c 6465 7220 3d20 5b66  s_in_folder = [f
-000087d0: 2066 6f72 2066 2069 6e20 676c 6f62 2e67   for f in glob.g
-000087e0: 6c6f 6228 6469 7265 6374 6f72 7920 2b20  lob(directory + 
-000087f0: 222f 2a22 2920 6966 206f 732e 7061 7468  "/*") if os.path
-00008800: 2e69 7366 696c 6528 6629 5d0a 2020 2020  .isfile(f)].    
-00008810: 666f 7220 6669 6c65 5f70 6174 6820 696e  for file_path in
-00008820: 2066 696c 655f 7061 7468 735f 696e 5f66   file_paths_in_f
-00008830: 6f6c 6465 723a 0a20 2020 2020 2020 205f  older:.        _
-00008840: 2c20 5f2c 2065 7874 203d 2067 6574 5f66  , _, ext = get_f
-00008850: 6e5f 6578 7428 6669 6c65 7061 7468 3d66  n_ext(filepath=f
-00008860: 696c 655f 7061 7468 290a 2020 2020 2020  ile_path).      
-00008870: 2020 6966 2065 7874 2e6c 6f77 6572 2829    if ext.lower()
-00008880: 203d 3d20 222e 7b7d 222e 666f 726d 6174   == ".{}".format
-00008890: 2869 6e70 7574 5f66 6f72 6d61 742e 6c6f  (input_format.lo
-000088a0: 7765 7228 2929 3a0a 2020 2020 2020 2020  wer()):.        
-000088b0: 2020 2020 7669 6465 6f5f 7061 7468 732e      video_paths.
-000088c0: 6170 7065 6e64 2866 696c 655f 7061 7468  append(file_path
-000088d0: 290a 2020 2020 6966 206c 656e 2876 6964  ).    if len(vid
-000088e0: 656f 5f70 6174 6873 2920 3c20 313a 0a20  eo_paths) < 1:. 
-000088f0: 2020 2020 2020 2072 6169 7365 204e 6f46         raise NoF
-00008900: 696c 6573 466f 756e 6445 7272 6f72 280a  ilesFoundError(.
-00008910: 2020 2020 2020 2020 2020 2020 6d73 673d              msg=
-00008920: 2253 494d 4241 2045 5252 4f52 3a20 4e6f  "SIMBA ERROR: No
-00008930: 2066 696c 6573 2077 6974 6820 2e7b 7d20   files with .{} 
-00008940: 6669 6c65 2065 6e64 696e 6720 666f 756e  file ending foun
-00008950: 6420 696e 2074 6865 207b 7d20 6469 7265  d in the {} dire
-00008960: 6374 6f72 7922 2e66 6f72 6d61 7428 0a20  ctory".format(. 
-00008970: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00008980: 6e70 7574 5f66 6f72 6d61 742c 2064 6972  nput_format, dir
-00008990: 6563 746f 7279 0a20 2020 2020 2020 2020  ectory.         
-000089a0: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
-000089b0: 2020 736f 7572 6365 3d62 6174 6368 5f63    source=batch_c
-000089c0: 6f6e 7665 7274 5f76 6964 656f 5f66 6f72  onvert_video_for
-000089d0: 6d61 742e 5f5f 6e61 6d65 5f5f 2c0a 2020  mat.__name__,.  
-000089e0: 2020 2020 2020 290a 2020 2020 666f 7220        ).    for 
-000089f0: 6669 6c65 5f63 6e74 2c20 6669 6c65 5f70  file_cnt, file_p
-00008a00: 6174 6820 696e 2065 6e75 6d65 7261 7465  ath in enumerate
-00008a10: 2876 6964 656f 5f70 6174 6873 293a 0a20  (video_paths):. 
-00008a20: 2020 2020 2020 2064 6972 5f6e 616d 652c         dir_name,
-00008a30: 2066 696c 655f 6e61 6d65 2c20 6578 7420   file_name, ext 
-00008a40: 3d20 6765 745f 666e 5f65 7874 2866 696c  = get_fn_ext(fil
-00008a50: 6570 6174 683d 6669 6c65 5f70 6174 6829  epath=file_path)
-00008a60: 0a20 2020 2020 2020 2070 7269 6e74 2822  .        print("
-00008a70: 5072 6f63 6573 7369 6e67 2076 6964 656f  Processing video
-00008a80: 207b 7d2e 2e2e 222e 666f 726d 6174 2866   {}...".format(f
-00008a90: 696c 655f 6e61 6d65 2929 0a20 2020 2020  ile_name)).     
-00008aa0: 2020 2073 6176 655f 7061 7468 203d 206f     save_path = o
-00008ab0: 732e 7061 7468 2e6a 6f69 6e28 0a20 2020  s.path.join(.   
-00008ac0: 2020 2020 2020 2020 2064 6972 5f6e 616d           dir_nam
-00008ad0: 652c 2066 696c 655f 6e61 6d65 202b 2022  e, file_name + "
-00008ae0: 2e7b 7d22 2e66 6f72 6d61 7428 6f75 7470  .{}".format(outp
-00008af0: 7574 5f66 6f72 6d61 742e 6c6f 7765 7228  ut_format.lower(
-00008b00: 2929 0a20 2020 2020 2020 2029 0a20 2020  )).        ).   
-00008b10: 2020 2020 2069 6620 6f73 2e70 6174 682e       if os.path.
-00008b20: 6973 6669 6c65 2873 6176 655f 7061 7468  isfile(save_path
-00008b30: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-00008b40: 6169 7365 2046 696c 6545 7869 7374 4572  aise FileExistEr
-00008b50: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-00008b60: 2020 2020 206d 7367 3d22 5349 4d42 4120       msg="SIMBA 
-00008b70: 4552 524f 523a 2054 6865 206f 7574 6669  ERROR: The outfi
-00008b80: 6c65 2066 696c 6520 616c 7265 6164 7920  le file already 
-00008b90: 6578 6973 743a 207b 7d2e 222e 666f 726d  exist: {}.".form
-00008ba0: 6174 280a 2020 2020 2020 2020 2020 2020  at(.            
-00008bb0: 2020 2020 2020 2020 7361 7665 5f70 6174          save_pat
-00008bc0: 680a 2020 2020 2020 2020 2020 2020 2020  h.              
-00008bd0: 2020 292c 0a20 2020 2020 2020 2020 2020    ),.           
-00008be0: 2020 2020 2073 6f75 7263 653d 6261 7463       source=batc
-00008bf0: 685f 636f 6e76 6572 745f 7669 6465 6f5f  h_convert_video_
-00008c00: 666f 726d 6174 2e5f 5f6e 616d 655f 5f2c  format.__name__,
-00008c10: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00008c20: 2020 2020 2020 2069 6620 6770 753a 0a20         if gpu:. 
-00008c30: 2020 2020 2020 2020 2020 2063 6f6d 6d61             comma
-00008c40: 6e64 203d 2027 6666 6d70 6567 202d 6877  nd = 'ffmpeg -hw
-00008c50: 6163 6365 6c20 6175 746f 202d 633a 7620  accel auto -c:v 
-00008c60: 6832 3634 5f63 7576 6964 202d 6920 227b  h264_cuvid -i "{
-00008c70: 7d22 202d 633a 7620 6832 3634 5f6e 7665  }" -c:v h264_nve
-00008c80: 6e63 202d 6371 2032 3320 2d70 7265 7365  nc -cq 23 -prese
-00008c90: 743a 7620 6d65 6469 756d 202d 633a 6120  t:v medium -c:a 
-00008ca0: 636f 7079 2022 7b7d 2227 2e66 6f72 6d61  copy "{}"'.forma
-00008cb0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00008cc0: 2020 2066 696c 655f 7061 7468 2c20 7361     file_path, sa
-00008cd0: 7665 5f70 6174 680a 2020 2020 2020 2020  ve_path.        
-00008ce0: 2020 2020 290a 2020 2020 2020 2020 656c      ).        el
-00008cf0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00008d00: 636f 6d6d 616e 6420 3d20 280a 2020 2020  command = (.    
-00008d10: 2020 2020 2020 2020 2020 2020 2266 666d              "ffm
-00008d20: 7065 6720 2d79 202d 6920 220a 2020 2020  peg -y -i ".    
-00008d30: 2020 2020 2020 2020 2020 2020 2b20 2722              + '"
-00008d40: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
-00008d50: 2020 2b20 6669 6c65 5f70 6174 680a 2020    + file_path.  
-00008d60: 2020 2020 2020 2020 2020 2020 2020 2b20                + 
-00008d70: 2722 270a 2020 2020 2020 2020 2020 2020  '"'.            
-00008d80: 2020 2020 2b20 2220 2d63 3a76 206c 6962      + " -c:v lib
-00008d90: 7832 3634 202d 6372 6620 3520 2d70 7265  x264 -crf 5 -pre
-00008da0: 7365 7420 6d65 6469 756d 202d 633a 6120  set medium -c:a 
-00008db0: 6c69 626d 7033 6c61 6d65 202d 623a 6120  libmp3lame -b:a 
-00008dc0: 3332 306b 2022 0a20 2020 2020 2020 2020  320k ".         
-00008dd0: 2020 2020 2020 202b 2027 2227 0a20 2020         + '"'.   
-00008de0: 2020 2020 2020 2020 2020 2020 202b 2073               + s
-00008df0: 6176 655f 7061 7468 0a20 2020 2020 2020  ave_path.       
-00008e00: 2020 2020 2020 2020 202b 2027 2227 0a20           + '"'. 
-00008e10: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00008e20: 2020 2020 2073 7562 7072 6f63 6573 732e       subprocess.
-00008e30: 6361 6c6c 2863 6f6d 6d61 6e64 2c20 7368  call(command, sh
-00008e40: 656c 6c3d 5472 7565 2c20 7374 646f 7574  ell=True, stdout
-00008e50: 3d73 7562 7072 6f63 6573 732e 5049 5045  =subprocess.PIPE
-00008e60: 290a 2020 2020 2020 2020 7072 696e 7428  ).        print(
-00008e70: 0a20 2020 2020 2020 2020 2020 2022 5669  .            "Vi
-00008e80: 6465 6f20 7b7d 2063 6f6d 706c 6574 652c  deo {} complete,
-00008e90: 2028 5669 6465 6f20 7b7d 2f7b 7d29 2e2e   (Video {}/{})..
-00008ea0: 2e22 2e66 6f72 6d61 7428 0a20 2020 2020  .".format(.     
-00008eb0: 2020 2020 2020 2020 2020 2066 696c 655f             file_
-00008ec0: 6e61 6d65 2c20 7374 7228 6669 6c65 5f63  name, str(file_c
-00008ed0: 6e74 202b 2031 292c 2073 7472 286c 656e  nt + 1), str(len
-00008ee0: 2876 6964 656f 5f70 6174 6873 2929 0a20  (video_paths)). 
-00008ef0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00008f00: 2020 2020 2029 0a0a 2020 2020 7374 646f       )..    stdo
-00008f10: 7574 5f73 7563 6365 7373 280a 2020 2020  ut_success(.    
-00008f20: 2020 2020 6d73 673d 6622 5349 4d42 4120      msg=f"SIMBA 
-00008f30: 434f 4d50 4c45 5445 3a20 7b73 7472 286c  COMPLETE: {str(l
-00008f40: 656e 2876 6964 656f 5f70 6174 6873 2929  en(video_paths))
-00008f50: 7d20 7669 6465 6f73 2063 6f6e 7665 7274  } videos convert
-00008f60: 6564 2069 6e20 7b64 6972 6563 746f 7279  ed in {directory
-00008f70: 7d20 6469 7265 6374 6f72 7921 222c 0a20  } directory!",. 
-00008f80: 2020 2020 2020 2073 6f75 7263 653d 6261         source=ba
-00008f90: 7463 685f 636f 6e76 6572 745f 7669 6465  tch_convert_vide
-00008fa0: 6f5f 666f 726d 6174 2e5f 5f6e 616d 655f  o_format.__name_
-00008fb0: 5f2c 0a20 2020 2029 0a0a 0a64 6566 2062  _,.    )...def b
-00008fc0: 6174 6368 5f63 7265 6174 655f 6672 616d  atch_create_fram
-00008fd0: 6573 2864 6972 6563 746f 7279 3a20 556e  es(directory: Un
-00008fe0: 696f 6e5b 7374 722c 206f 732e 5061 7468  ion[str, os.Path
-00008ff0: 4c69 6b65 5d29 202d 3e20 4e6f 6e65 3a0a  Like]) -> None:.
-00009000: 2020 2020 2222 220a 2020 2020 4578 7472      """.    Extr
-00009010: 6163 7420 616c 6c20 6672 616d 6573 2066  act all frames f
-00009020: 6f72 2061 6c6c 2076 6964 656f 7320 696e  or all videos in
-00009030: 2061 2064 6972 6563 746f 7279 2e20 5265   a directory. Re
-00009040: 7375 6c74 7320 6172 6520 7374 6f72 6564  sults are stored
-00009050: 2077 6974 6869 6e20 7375 622d 6469 7265   within sub-dire
-00009060: 6374 6f72 6965 7320 696e 2074 6865 2069  ctories in the i
-00009070: 6e70 7574 0a20 2020 2064 6972 6563 746f  nput.    directo
-00009080: 7279 206e 616d 6564 2061 6363 6f72 6469  ry named accordi
-00009090: 6e67 2074 6f20 7468 6520 7669 6465 6f20  ng to the video 
-000090a0: 6669 6c65 732e 0a0a 2020 2020 3a70 6172  files...    :par
-000090b0: 616d 6574 6572 2073 7472 2064 6972 6563  ameter str direc
-000090c0: 746f 7279 3a20 5061 7468 2074 6f20 6469  tory: Path to di
-000090d0: 7265 6374 6f72 7920 636f 6e74 6169 6e69  rectory containi
-000090e0: 6e67 2076 6964 656f 2066 696c 6573 2e0a  ng video files..
-000090f0: 0a20 2020 203a 6578 616d 706c 653a 0a20  .    :example:. 
-00009100: 2020 203e 3e3e 205f 203d 2062 6174 6368     >>> _ = batch
-00009110: 5f63 7265 6174 655f 6672 616d 6573 2864  _create_frames(d
-00009120: 6972 6563 746f 7279 3d27 7072 6f6a 6563  irectory='projec
-00009130: 745f 666f 6c64 6572 2f76 6964 656f 7327  t_folder/videos'
-00009140: 290a 2020 2020 2222 220a 0a20 2020 2069  ).    """..    i
-00009150: 6620 6e6f 7420 6f73 2e70 6174 682e 6973  f not os.path.is
-00009160: 6469 7228 6469 7265 6374 6f72 7929 3a0a  dir(directory):.
-00009170: 2020 2020 2020 2020 7261 6973 6520 4e6f          raise No
-00009180: 7444 6972 6563 746f 7279 4572 726f 7228  tDirectoryError(
-00009190: 0a20 2020 2020 2020 2020 2020 206d 7367  .            msg
-000091a0: 3d22 5349 4d42 4120 4552 524f 523a 207b  ="SIMBA ERROR: {
-000091b0: 7d20 6973 206e 6f74 2061 2076 616c 6964  } is not a valid
-000091c0: 2064 6972 6563 746f 7279 222e 666f 726d   directory".form
-000091d0: 6174 2864 6972 6563 746f 7279 292c 0a20  at(directory),. 
-000091e0: 2020 2020 2020 2020 2020 2073 6f75 7263             sourc
-000091f0: 653d 6261 7463 685f 6372 6561 7465 5f66  e=batch_create_f
-00009200: 7261 6d65 732e 5f5f 6e61 6d65 5f5f 2c0a  rames.__name__,.
-00009210: 2020 2020 2020 2020 290a 2020 2020 7669          ).    vi
-00009220: 6465 6f5f 7061 7468 7320 3d20 5b5d 0a20  deo_paths = []. 
-00009230: 2020 2066 696c 655f 7061 7468 735f 696e     file_paths_in
-00009240: 5f66 6f6c 6465 7220 3d20 5b66 2066 6f72  _folder = [f for
-00009250: 2066 2069 6e20 676c 6f62 2e67 6c6f 6228   f in glob.glob(
-00009260: 6469 7265 6374 6f72 7920 2b20 222f 2a22  directory + "/*"
-00009270: 2920 6966 206f 732e 7061 7468 2e69 7366  ) if os.path.isf
-00009280: 696c 6528 6629 5d0a 2020 2020 666f 7220  ile(f)].    for 
-00009290: 6669 6c65 5f70 6174 6820 696e 2066 696c  file_path in fil
-000092a0: 655f 7061 7468 735f 696e 5f66 6f6c 6465  e_paths_in_folde
-000092b0: 723a 0a20 2020 2020 2020 205f 2c20 5f2c  r:.        _, _,
-000092c0: 2065 7874 203d 2067 6574 5f66 6e5f 6578   ext = get_fn_ex
-000092d0: 7428 6669 6c65 7061 7468 3d66 696c 655f  t(filepath=file_
-000092e0: 7061 7468 290a 2020 2020 2020 2020 6966  path).        if
-000092f0: 2065 7874 2e6c 6f77 6572 2829 2069 6e20   ext.lower() in 
-00009300: 5b22 2e61 7669 222c 2022 2e6d 7034 222c  [".avi", ".mp4",
-00009310: 2022 2e6d 6f76 222c 2022 2e66 6c76 225d   ".mov", ".flv"]
-00009320: 3a0a 2020 2020 2020 2020 2020 2020 7669  :.            vi
-00009330: 6465 6f5f 7061 7468 732e 6170 7065 6e64  deo_paths.append
-00009340: 2866 696c 655f 7061 7468 290a 2020 2020  (file_path).    
-00009350: 6966 206c 656e 2876 6964 656f 5f70 6174  if len(video_pat
-00009360: 6873 2920 3c20 313a 0a20 2020 2020 2020  hs) < 1:.       
-00009370: 2072 6169 7365 204e 6f46 696c 6573 466f   raise NoFilesFo
-00009380: 756e 6445 7272 6f72 280a 2020 2020 2020  undError(.      
-00009390: 2020 2020 2020 6d73 673d 2253 494d 4241        msg="SIMBA
-000093a0: 2045 5252 4f52 3a20 4e6f 2066 696c 6573   ERROR: No files
-000093b0: 2077 6974 6820 2e6d 7034 2c20 2e61 7669   with .mp4, .avi
-000093c0: 2c20 2e6d 6f76 2c20 2e66 6c76 2066 696c  , .mov, .flv fil
-000093d0: 6520 656e 6469 6e67 2066 6f75 6e64 2069  e ending found i
-000093e0: 6e20 7468 6520 7b7d 2064 6972 6563 746f  n the {} directo
-000093f0: 7279 222e 666f 726d 6174 280a 2020 2020  ry".format(.    
-00009400: 2020 2020 2020 2020 2020 2020 6469 7265              dire
-00009410: 6374 6f72 790a 2020 2020 2020 2020 2020  ctory.          
-00009420: 2020 292c 0a20 2020 2020 2020 2020 2020    ),.           
-00009430: 2073 6f75 7263 653d 6261 7463 685f 6372   source=batch_cr
-00009440: 6561 7465 5f66 7261 6d65 732e 5f5f 6e61  eate_frames.__na
-00009450: 6d65 5f5f 2c0a 2020 2020 2020 2020 290a  me__,.        ).
-00009460: 2020 2020 666f 7220 6669 6c65 5f63 6e74      for file_cnt
-00009470: 2c20 6669 6c65 5f70 6174 6820 696e 2065  , file_path in e
-00009480: 6e75 6d65 7261 7465 2876 6964 656f 5f70  numerate(video_p
-00009490: 6174 6873 293a 0a20 2020 2020 2020 2064  aths):.        d
-000094a0: 6972 5f6e 616d 652c 2066 696c 655f 6e61  ir_name, file_na
-000094b0: 6d65 2c20 6578 7420 3d20 6765 745f 666e  me, ext = get_fn
-000094c0: 5f65 7874 2866 696c 6570 6174 683d 6669  _ext(filepath=fi
-000094d0: 6c65 5f70 6174 6829 0a20 2020 2020 2020  le_path).       
-000094e0: 2070 7269 6e74 2822 5072 6f63 6573 7369   print("Processi
-000094f0: 6e67 2076 6964 656f 207b 7d2e 2e2e 222e  ng video {}...".
-00009500: 666f 726d 6174 2866 696c 655f 6e61 6d65  format(file_name
-00009510: 2929 0a20 2020 2020 2020 2073 6176 655f  )).        save_
-00009520: 6469 7220 3d20 6f73 2e70 6174 682e 6a6f  dir = os.path.jo
-00009530: 696e 2864 6972 5f6e 616d 652c 2066 696c  in(dir_name, fil
-00009540: 655f 6e61 6d65 290a 2020 2020 2020 2020  e_name).        
-00009550: 6966 206e 6f74 206f 732e 7061 7468 2e65  if not os.path.e
-00009560: 7869 7374 7328 7361 7665 5f64 6972 293a  xists(save_dir):
-00009570: 0a20 2020 2020 2020 2020 2020 206f 732e  .            os.
-00009580: 6d61 6b65 6469 7273 2873 6176 655f 6469  makedirs(save_di
-00009590: 7229 0a20 2020 2020 2020 2076 6964 656f  r).        video
-000095a0: 5f74 6f5f 6672 616d 6573 2866 696c 655f  _to_frames(file_
-000095b0: 7061 7468 2c20 7361 7665 5f64 6972 2c20  path, save_dir, 
-000095c0: 6f76 6572 7772 6974 653d 5472 7565 2c20  overwrite=True, 
-000095d0: 6576 6572 793d 312c 2063 6875 6e6b 5f73  every=1, chunk_s
-000095e0: 697a 653d 3130 3030 290a 2020 2020 2020  ize=1000).      
-000095f0: 2020 7072 696e 7428 0a20 2020 2020 2020    print(.       
-00009600: 2020 2020 2022 5669 6465 6f20 7b7d 2063       "Video {} c
-00009610: 6f6d 706c 6574 652c 2028 5669 6465 6f20  omplete, (Video 
-00009620: 7b7d 2f7b 7d29 2e2e 2e22 2e66 6f72 6d61  {}/{})...".forma
-00009630: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00009640: 2020 2066 696c 655f 6e61 6d65 2c20 7374     file_name, st
-00009650: 7228 6669 6c65 5f63 6e74 202b 2031 292c  r(file_cnt + 1),
-00009660: 2073 7472 286c 656e 2876 6964 656f 5f70   str(len(video_p
-00009670: 6174 6873 2929 0a20 2020 2020 2020 2020  aths)).         
-00009680: 2020 2029 0a20 2020 2020 2020 2029 0a20     ).        ). 
-00009690: 2020 2073 7464 6f75 745f 7375 6363 6573     stdout_succes
-000096a0: 7328 0a20 2020 2020 2020 206d 7367 3d66  s(.        msg=f
-000096b0: 227b 7374 7228 6c65 6e28 7669 6465 6f5f  "{str(len(video_
-000096c0: 7061 7468 7329 297d 2076 6964 656f 7320  paths))} videos 
-000096d0: 636f 6e76 6572 7465 6420 696e 746f 2066  converted into f
-000096e0: 7261 6d65 7320 696e 207b 6469 7265 6374  rames in {direct
-000096f0: 6f72 797d 2064 6972 6563 746f 7279 2122  ory} directory!"
-00009700: 2c0a 2020 2020 2020 2020 736f 7572 6365  ,.        source
-00009710: 3d62 6174 6368 5f63 7265 6174 655f 6672  =batch_create_fr
-00009720: 616d 6573 2e5f 5f6e 616d 655f 5f2c 0a20  ames.__name__,. 
-00009730: 2020 2029 0a0a 0a64 6566 2065 7874 7261     )...def extra
-00009740: 6374 5f66 7261 6d65 735f 7369 6e67 6c65  ct_frames_single
-00009750: 5f76 6964 656f 2866 696c 655f 7061 7468  _video(file_path
-00009760: 3a20 556e 696f 6e5b 7374 722c 206f 732e  : Union[str, os.
-00009770: 5061 7468 4c69 6b65 5d29 202d 3e20 4e6f  PathLike]) -> No
-00009780: 6e65 3a0a 2020 2020 2222 220a 2020 2020  ne:.    """.    
-00009790: 4578 7472 6163 7420 616c 6c20 6672 616d  Extract all fram
-000097a0: 6573 2066 6f72 2061 2073 696e 676c 652e  es for a single.
-000097b0: 2052 6573 756c 7473 2061 7265 2073 746f   Results are sto
-000097c0: 7265 6420 7769 7468 696e 2061 2073 7562  red within a sub
-000097d0: 6469 7265 6374 6f72 7920 696e 2074 6865  directory in the
-000097e0: 2073 616d 650a 2020 2020 6469 7265 6374   same.    direct
-000097f0: 6f72 7920 6173 2074 6865 2069 6e70 7574  ory as the input
-00009800: 2066 696c 652e 0a0a 2020 2020 3a70 6172   file...    :par
-00009810: 616d 6574 6572 2073 7472 2066 696c 655f  ameter str file_
-00009820: 7061 7468 3a20 5061 7468 2074 6f20 7669  path: Path to vi
-00009830: 6465 6f20 6669 6c65 2e0a 0a20 2020 203a  deo file...    :
-00009840: 6578 616d 706c 653a 0a20 2020 203e 3e3e  example:.    >>>
-00009850: 205f 203d 2065 7874 7261 6374 5f66 7261   _ = extract_fra
-00009860: 6d65 735f 7369 6e67 6c65 5f76 6964 656f  mes_single_video
-00009870: 2866 696c 655f 7061 7468 3d27 7072 6f6a  (file_path='proj
-00009880: 6563 745f 666f 6c64 6572 2f76 6964 656f  ect_folder/video
-00009890: 732f 5669 6465 6f5f 312e 6d70 3427 290a  s/Video_1.mp4').
-000098a0: 2020 2020 2222 220a 0a20 2020 2074 696d      """..    tim
-000098b0: 6572 203d 2053 696d 6261 5469 6d65 7228  er = SimbaTimer(
-000098c0: 7374 6172 743d 5472 7565 290a 2020 2020  start=True).    
-000098d0: 6368 6563 6b5f 6669 6c65 5f65 7869 7374  check_file_exist
-000098e0: 5f61 6e64 5f72 6561 6461 626c 6528 6669  _and_readable(fi
-000098f0: 6c65 5f70 6174 683d 6669 6c65 5f70 6174  le_path=file_pat
-00009900: 6829 0a20 2020 205f 203d 2067 6574 5f76  h).    _ = get_v
-00009910: 6964 656f 5f6d 6574 615f 6461 7461 2866  ideo_meta_data(f
-00009920: 696c 655f 7061 7468 290a 2020 2020 6469  ile_path).    di
-00009930: 725f 6e61 6d65 2c20 6669 6c65 5f6e 616d  r_name, file_nam
-00009940: 652c 2065 7874 203d 2067 6574 5f66 6e5f  e, ext = get_fn_
-00009950: 6578 7428 6669 6c65 7061 7468 3d66 696c  ext(filepath=fil
-00009960: 655f 7061 7468 290a 2020 2020 7361 7665  e_path).    save
-00009970: 5f64 6972 203d 206f 732e 7061 7468 2e6a  _dir = os.path.j
-00009980: 6f69 6e28 6469 725f 6e61 6d65 2c20 6669  oin(dir_name, fi
-00009990: 6c65 5f6e 616d 6529 0a20 2020 2069 6620  le_name).    if 
-000099a0: 6e6f 7420 6f73 2e70 6174 682e 6578 6973  not os.path.exis
-000099b0: 7473 2873 6176 655f 6469 7229 3a0a 2020  ts(save_dir):.  
-000099c0: 2020 2020 2020 6f73 2e6d 616b 6564 6972        os.makedir
-000099d0: 7328 7361 7665 5f64 6972 290a 2020 2020  s(save_dir).    
-000099e0: 7072 696e 7428 2250 726f 6365 7373 696e  print("Processin
-000099f0: 6720 7669 6465 6f20 7b7d 2e2e 2e22 2e66  g video {}...".f
-00009a00: 6f72 6d61 7428 6669 6c65 5f6e 616d 6529  ormat(file_name)
-00009a10: 290a 2020 2020 7669 6465 6f5f 746f 5f66  ).    video_to_f
-00009a20: 7261 6d65 7328 6669 6c65 5f70 6174 682c  rames(file_path,
-00009a30: 2073 6176 655f 6469 722c 206f 7665 7277   save_dir, overw
-00009a40: 7269 7465 3d54 7275 652c 2065 7665 7279  rite=True, every
-00009a50: 3d31 2c20 6368 756e 6b5f 7369 7a65 3d31  =1, chunk_size=1
-00009a60: 3030 3029 0a20 2020 2074 696d 6572 2e73  000).    timer.s
-00009a70: 746f 705f 7469 6d65 7228 290a 2020 2020  top_timer().    
-00009a80: 7374 646f 7574 5f73 7563 6365 7373 280a  stdout_success(.
-00009a90: 2020 2020 2020 2020 6d73 673d 6622 5669          msg=f"Vi
-00009aa0: 6465 6f20 7b66 696c 655f 6e61 6d65 7d20  deo {file_name} 
-00009ab0: 636f 6e76 6572 7465 6420 746f 2069 6d61  converted to ima
-00009ac0: 6765 7320 696e 207b 6469 725f 6e61 6d65  ges in {dir_name
-00009ad0: 7d20 6469 7265 6374 6f72 7921 222c 0a20  } directory!",. 
-00009ae0: 2020 2020 2020 2065 6c61 7073 6564 5f74         elapsed_t
-00009af0: 696d 653d 7469 6d65 722e 656c 6170 7365  ime=timer.elapse
-00009b00: 645f 7469 6d65 5f73 7472 2c0a 2020 2020  d_time_str,.    
-00009b10: 2020 2020 736f 7572 6365 3d65 7874 7261      source=extra
-00009b20: 6374 5f66 7261 6d65 735f 7369 6e67 6c65  ct_frames_single
-00009b30: 5f76 6964 656f 2e5f 5f6e 616d 655f 5f2c  _video.__name__,
-00009b40: 0a20 2020 2029 0a0a 0a64 6566 206d 756c  .    )...def mul
-00009b50: 7469 5f73 706c 6974 5f76 6964 656f 280a  ti_split_video(.
-00009b60: 2020 2020 6669 6c65 5f70 6174 683a 2055      file_path: U
-00009b70: 6e69 6f6e 5b73 7472 2c20 6f73 2e50 6174  nion[str, os.Pat
-00009b80: 684c 696b 655d 2c0a 2020 2020 7374 6172  hLike],.    star
-00009b90: 745f 7469 6d65 733a 204c 6973 745b 7374  t_times: List[st
-00009ba0: 725d 2c0a 2020 2020 656e 645f 7469 6d65  r],.    end_time
-00009bb0: 733a 204c 6973 745b 7374 725d 2c0a 2020  s: List[str],.  
-00009bc0: 2020 6f75 745f 6469 723a 204f 7074 696f    out_dir: Optio
-00009bd0: 6e61 6c5b 556e 696f 6e5b 7374 722c 206f  nal[Union[str, o
-00009be0: 732e 5061 7468 4c69 6b65 5d5d 203d 204e  s.PathLike]] = N
-00009bf0: 6f6e 652c 0a20 2020 2069 6e63 6c75 6465  one,.    include
-00009c00: 5f63 6c69 705f 7469 6d65 5f69 6e5f 6669  _clip_time_in_fi
-00009c10: 6c65 6e61 6d65 3a20 4f70 7469 6f6e 616c  lename: Optional
-00009c20: 5b62 6f6f 6c5d 203d 2046 616c 7365 2c0a  [bool] = False,.
-00009c30: 2020 2020 6770 753a 204f 7074 696f 6e61      gpu: Optiona
-00009c40: 6c5b 626f 6f6c 5d20 3d20 4661 6c73 652c  l[bool] = False,
-00009c50: 0a29 202d 3e20 4e6f 6e65 3a0a 2020 2020  .) -> None:.    
-00009c60: 2222 220a 2020 2020 4469 7669 6465 2061  """.    Divide a
-00009c70: 2076 6964 656f 2066 696c 6520 696e 746f   video file into
-00009c80: 206d 756c 7469 706c 6520 7669 6465 6f20   multiple video 
-00009c90: 6669 6c65 7320 6672 6f6d 2073 7065 6369  files from speci
-00009ca0: 6669 6564 2073 7461 7274 2061 6e64 2073  fied start and s
-00009cb0: 746f 7020 7469 6d65 732e 0a0a 2020 2020  top times...    
-00009cc0: 3a70 6172 616d 6574 6572 2073 7472 2066  :parameter str f
-00009cd0: 696c 655f 7061 7468 3a20 5061 7468 2074  ile_path: Path t
-00009ce0: 6f20 696e 7075 7420 7669 6465 6f20 6669  o input video fi
-00009cf0: 6c65 2e0a 2020 2020 3a70 6172 616d 6574  le..    :paramet
-00009d00: 6572 204c 6973 745b 7374 725d 2073 7461  er List[str] sta
-00009d10: 7274 5f74 696d 6573 3a20 5374 6172 7420  rt_times: Start 
-00009d20: 7469 6d65 7320 696e 2048 483a 4d4d 3a53  times in HH:MM:S
-00009d30: 5320 666f 726d 6174 2e0a 2020 2020 3a70  S format..    :p
-00009d40: 6172 616d 6574 6572 204c 6973 745b 7374  arameter List[st
-00009d50: 725d 2065 6e64 5f74 696d 6573 3a20 456e  r] end_times: En
-00009d60: 6420 7469 6d65 7320 696e 2048 483a 4d4d  d times in HH:MM
-00009d70: 3a53 5320 666f 726d 6174 2e0a 2020 2020  :SS format..    
-00009d80: 3a70 6172 616d 6574 6572 204f 7074 696f  :parameter Optio
-00009d90: 6e61 6c5b 556e 696f 6e5b 7374 722c 206f  nal[Union[str, o
-00009da0: 732e 5061 7468 4c69 6b65 5d5d 206f 7574  s.PathLike]] out
-00009db0: 5f64 6972 3a20 4966 204e 6f6e 652c 2074  _dir: If None, t
-00009dc0: 6865 6e20 7468 6520 636c 6970 7320 7769  hen the clips wi
-00009dd0: 6c6c 2062 6520 7374 6f72 6564 2069 6e20  ll be stored in 
-00009de0: 7468 6520 7361 6d65 2064 6972 2061 7320  the same dir as 
-00009df0: 7468 6520 696e 7075 7420 7669 6465 6f2e  the input video.
-00009e00: 2049 6620 6469 7265 6374 6f72 792c 2074   If directory, t
-00009e10: 6865 6e20 7468 6520 6c6f 6361 7469 6f6e  hen the location
-00009e20: 206f 6620 7468 6520 6f75 7470 7574 2066   of the output f
-00009e30: 696c 6573 2e0a 2020 2020 3a70 6172 616d  iles..    :param
-00009e40: 6574 6572 204f 7074 696f 6e61 6c5b 626f  eter Optional[bo
-00009e50: 6f6c 5d20 696e 636c 7564 655f 636c 6970  ol] include_clip
-00009e60: 5f74 696d 655f 696e 5f66 696c 656e 616d  _time_in_filenam
-00009e70: 653a 2049 6620 5472 7565 2c20 696e 636c  e: If True, incl
-00009e80: 7564 6520 7468 6520 636c 6970 2073 7461  ude the clip sta
-00009e90: 7274 2061 6e64 2065 6e64 2069 6e20 4848  rt and end in HH
-00009ea0: 2d4d 4d2d 5353 2066 6f72 6d61 7420 6173  -MM-SS format as
-00009eb0: 2073 7566 6669 7820 696e 2074 6865 2066   suffix in the f
-00009ec0: 696c 656e 616d 652e 2049 6620 4661 6c73  ilename. If Fals
-00009ed0: 652c 2074 6865 6e20 7573 6520 696e 7465  e, then use inte
-00009ee0: 6765 7220 7375 6666 6963 2072 6570 7265  ger suffic repre
-00009ef0: 7365 6e74 696e 6720 7468 6520 636f 756e  senting the coun
-00009f00: 742e 0a20 2020 203a 7061 7261 6d65 7465  t..    :paramete
-00009f10: 7220 4f70 7469 6f6e 616c 5b62 6f6f 6c5d  r Optional[bool]
-00009f20: 2067 7075 3a20 4966 2054 7275 652c 2075   gpu: If True, u
-00009f30: 7365 204e 5649 4445 4120 4750 5520 636f  se NVIDEA GPU co
-00009f40: 6465 6373 2e20 4465 6661 756c 7420 4661  decs. Default Fa
-00009f50: 6c73 652e 0a0a 2020 2020 3a65 7861 6d70  lse...    :examp
-00009f60: 6c65 3a0a 2020 2020 3e3e 3e20 5f20 3d20  le:.    >>> _ = 
-00009f70: 6d75 6c74 695f 7370 6c69 745f 7669 6465  multi_split_vide
-00009f80: 6f28 6669 6c65 5f70 6174 683d 2770 726f  o(file_path='pro
-00009f90: 6a65 6374 5f66 6f6c 6465 722f 7669 6465  ject_folder/vide
-00009fa0: 6f73 2f56 6964 656f 5f31 2e6d 7034 272c  os/Video_1.mp4',
-00009fb0: 2073 7461 7274 5f74 696d 6573 3d5b 2730   start_times=['0
-00009fc0: 303a 3030 3a30 3527 2c20 2730 303a 3030  0:00:05', '00:00
-00009fd0: 3a32 3027 5d2c 2065 6e64 5f74 696d 6573  :20'], end_times
-00009fe0: 3d5b 2730 303a 3030 3a31 3027 2c20 2730  =['00:00:10', '0
-00009ff0: 303a 3030 3a32 3527 5d29 0a20 2020 2022  0:00:25']).    "
-0000a000: 2222 0a0a 2020 2020 7469 6d65 7220 3d20  ""..    timer = 
-0000a010: 5369 6d62 6154 696d 6572 2873 7461 7274  SimbaTimer(start
-0000a020: 3d54 7275 6529 0a20 2020 2063 6865 636b  =True).    check
-0000a030: 5f66 696c 655f 6578 6973 745f 616e 645f  _file_exist_and_
-0000a040: 7265 6164 6162 6c65 2866 696c 655f 7061  readable(file_pa
-0000a050: 7468 3d66 696c 655f 7061 7468 290a 2020  th=file_path).  
-0000a060: 2020 6469 725f 6e61 6d65 2c20 6669 6c65    dir_name, file
-0000a070: 5f6e 616d 652c 2065 7874 203d 2067 6574  _name, ext = get
-0000a080: 5f66 6e5f 6578 7428 6669 6c65 7061 7468  _fn_ext(filepath
-0000a090: 3d66 696c 655f 7061 7468 290a 2020 2020  =file_path).    
-0000a0a0: 6966 206f 7574 5f64 6972 2069 7320 6e6f  if out_dir is no
-0000a0b0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-0000a0c0: 6966 206e 6f74 206f 732e 7061 7468 2e69  if not os.path.i
-0000a0d0: 7364 6972 286f 7574 5f64 6972 293a 0a20  sdir(out_dir):. 
-0000a0e0: 2020 2020 2020 2020 2020 206f 732e 6d61             os.ma
-0000a0f0: 6b65 6469 7273 286f 7574 5f64 6972 290a  kedirs(out_dir).
-0000a100: 2020 2020 2020 2020 6469 725f 6e61 6d65          dir_name
-0000a110: 203d 206f 7574 5f64 6972 0a20 2020 2066   = out_dir.    f
-0000a120: 6f72 2073 7461 7274 5f74 696d 655f 636e  or start_time_cn
-0000a130: 742c 2073 7461 7274 5f74 696d 6520 696e  t, start_time in
-0000a140: 2065 6e75 6d65 7261 7465 2873 7461 7274   enumerate(start
-0000a150: 5f74 696d 6573 293a 0a20 2020 2020 2020  _times):.       
-0000a160: 2063 6865 636b 5f69 665f 7374 7269 6e67   check_if_string
-0000a170: 5f76 616c 7565 5f69 735f 7661 6c69 645f  _value_is_valid_
-0000a180: 7669 6465 6f5f 7469 6d65 7374 616d 7028  video_timestamp(
-0000a190: 0a20 2020 2020 2020 2020 2020 2076 616c  .            val
-0000a1a0: 7565 3d73 7461 7274 5f74 696d 652c 206e  ue=start_time, n
-0000a1b0: 616d 653d 6622 5374 6172 7420 7469 6d65  ame=f"Start time
-0000a1c0: 2066 6f72 2063 6c69 7020 7b73 7461 7274   for clip {start
-0000a1d0: 5f74 696d 655f 636e 742b 317d 220a 2020  _time_cnt+1}".  
-0000a1e0: 2020 2020 2020 290a 2020 2020 666f 7220        ).    for 
-0000a1f0: 656e 645f 7469 6d65 5f63 6e74 2c20 656e  end_time_cnt, en
-0000a200: 645f 7469 6d65 2069 6e20 656e 756d 6572  d_time in enumer
-0000a210: 6174 6528 656e 645f 7469 6d65 7329 3a0a  ate(end_times):.
-0000a220: 2020 2020 2020 2020 6368 6563 6b5f 6966          check_if
-0000a230: 5f73 7472 696e 675f 7661 6c75 655f 6973  _string_value_is
-0000a240: 5f76 616c 6964 5f76 6964 656f 5f74 696d  _valid_video_tim
-0000a250: 6573 7461 6d70 280a 2020 2020 2020 2020  estamp(.        
-0000a260: 2020 2020 7661 6c75 653d 656e 645f 7469      value=end_ti
-0000a270: 6d65 2c20 6e61 6d65 3d66 2245 6e64 2074  me, name=f"End t
-0000a280: 696d 6520 666f 7220 636c 6970 207b 656e  ime for clip {en
-0000a290: 645f 7469 6d65 5f63 6e74 2b31 7d22 0a20  d_time_cnt+1}". 
-0000a2a0: 2020 2020 2020 2029 0a20 2020 2066 6f72         ).    for
-0000a2b0: 2063 6c69 705f 636e 742c 2028 7374 6172   clip_cnt, (star
-0000a2c0: 745f 7469 6d65 2c20 656e 645f 7469 6d65  t_time, end_time
-0000a2d0: 2920 696e 2065 6e75 6d65 7261 7465 287a  ) in enumerate(z
-0000a2e0: 6970 2873 7461 7274 5f74 696d 6573 2c20  ip(start_times, 
-0000a2f0: 656e 645f 7469 6d65 7329 293a 0a20 2020  end_times)):.   
-0000a300: 2020 2020 2063 6865 636b 5f74 6861 745f       check_that_
-0000a310: 6868 6d6d 7373 5f73 7461 7274 5f69 735f  hhmmss_start_is_
-0000a320: 6265 666f 7265 5f65 6e64 280a 2020 2020  before_end(.    
-0000a330: 2020 2020 2020 2020 7374 6172 745f 7469          start_ti
-0000a340: 6d65 3d73 7461 7274 5f74 696d 652c 2065  me=start_time, e
-0000a350: 6e64 5f74 696d 653d 656e 645f 7469 6d65  nd_time=end_time
-0000a360: 2c20 6e61 6d65 3d66 2243 6c69 7020 7b73  , name=f"Clip {s
-0000a370: 7472 2863 6c69 705f 636e 742b 3129 7d22  tr(clip_cnt+1)}"
-0000a380: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-0000a390: 2020 2063 6865 636b 5f69 665f 6868 6d6d     check_if_hhmm
-0000a3a0: 7373 5f74 696d 6573 7461 6d70 5f69 735f  ss_timestamp_is_
-0000a3b0: 7661 6c69 645f 7061 7274 5f6f 665f 7669  valid_part_of_vi
-0000a3c0: 6465 6f28 0a20 2020 2020 2020 2020 2020  deo(.           
-0000a3d0: 2074 696d 6573 7461 6d70 3d73 7461 7274   timestamp=start
-0000a3e0: 5f74 696d 652c 2076 6964 656f 5f70 6174  _time, video_pat
-0000a3f0: 683d 6669 6c65 5f70 6174 680a 2020 2020  h=file_path.    
-0000a400: 2020 2020 290a 2020 2020 2020 2020 6368      ).        ch
-0000a410: 6563 6b5f 6966 5f68 686d 6d73 735f 7469  eck_if_hhmmss_ti
-0000a420: 6d65 7374 616d 705f 6973 5f76 616c 6964  mestamp_is_valid
-0000a430: 5f70 6172 745f 6f66 5f76 6964 656f 280a  _part_of_video(.
-0000a440: 2020 2020 2020 2020 2020 2020 7469 6d65              time
-0000a450: 7374 616d 703d 656e 645f 7469 6d65 2c20  stamp=end_time, 
-0000a460: 7669 6465 6f5f 7061 7468 3d66 696c 655f  video_path=file_
-0000a470: 7061 7468 0a20 2020 2020 2020 2029 0a20  path.        ). 
-0000a480: 2020 2020 2020 2069 6620 6e6f 7420 696e         if not in
-0000a490: 636c 7564 655f 636c 6970 5f74 696d 655f  clude_clip_time_
-0000a4a0: 696e 5f66 696c 656e 616d 653a 0a20 2020  in_filename:.   
-0000a4b0: 2020 2020 2020 2020 2073 6176 655f 7061           save_pa
-0000a4c0: 7468 203d 206f 732e 7061 7468 2e6a 6f69  th = os.path.joi
-0000a4d0: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
-0000a4e0: 2020 2064 6972 5f6e 616d 652c 2066 696c     dir_name, fil
-0000a4f0: 655f 6e61 6d65 202b 2022 5f7b 7d22 2e66  e_name + "_{}".f
-0000a500: 6f72 6d61 7428 7374 7228 636c 6970 5f63  ormat(str(clip_c
-0000a510: 6e74 202b 2031 2929 202b 2022 2e6d 7034  nt + 1)) + ".mp4
-0000a520: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-0000a530: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0000a540: 2020 2020 2020 2020 2020 7361 7665 5f70            save_p
-0000a550: 6174 6820 3d20 6f73 2e70 6174 682e 6a6f  ath = os.path.jo
-0000a560: 696e 280a 2020 2020 2020 2020 2020 2020  in(.            
-0000a570: 2020 2020 6469 725f 6e61 6d65 2c0a 2020      dir_name,.  
-0000a580: 2020 2020 2020 2020 2020 2020 2020 6669                fi
-0000a590: 6c65 5f6e 616d 650a 2020 2020 2020 2020  le_name.        
-0000a5a0: 2020 2020 2020 2020 2b20 6627 5f7b 7374          + f'_{st
-0000a5b0: 6172 745f 7469 6d65 2e72 6570 6c61 6365  art_time.replace
-0000a5c0: 2822 3a22 2c20 222d 2229 7d5f 7b65 6e64  (":", "-")}_{end
-0000a5d0: 5f74 696d 652e 7265 706c 6163 6528 223a  _time.replace(":
-0000a5e0: 222c 2022 2d22 297d 2e6d 7034 272c 0a20  ", "-")}.mp4',. 
-0000a5f0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0000a600: 2020 2020 2069 6620 6f73 2e70 6174 682e       if os.path.
-0000a610: 6973 6669 6c65 2873 6176 655f 7061 7468  isfile(save_path
-0000a620: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-0000a630: 6169 7365 2046 696c 6545 7869 7374 4572  aise FileExistEr
-0000a640: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-0000a650: 2020 2020 206d 7367 3d66 2254 6865 206f       msg=f"The o
-0000a660: 7574 6669 6c65 2066 696c 6520 616c 7265  utfile file alre
-0000a670: 6164 7920 6578 6973 743a 207b 7361 7665  ady exist: {save
-0000a680: 5f70 6174 687d 2e22 2c0a 2020 2020 2020  _path}.",.      
-0000a690: 2020 2020 2020 2020 2020 736f 7572 6365            source
-0000a6a0: 3d6d 756c 7469 5f73 706c 6974 5f76 6964  =multi_split_vid
-0000a6b0: 656f 2e5f 5f6e 616d 655f 5f2c 0a20 2020  eo.__name__,.   
-0000a6c0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0000a6d0: 2020 2069 6620 6770 753a 0a20 2020 2020     if gpu:.     
-0000a6e0: 2020 2020 2020 2069 6620 6e6f 7420 6368         if not ch
-0000a6f0: 6563 6b5f 6e76 6964 6561 5f67 7075 5f61  eck_nvidea_gpu_a
-0000a700: 7661 696c 6162 6c65 2829 3a0a 2020 2020  vailable():.    
-0000a710: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0000a720: 6520 4646 4d50 4547 436f 6465 6347 5055  e FFMPEGCodecGPU
-0000a730: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-0000a740: 2020 2020 2020 2020 2020 206d 7367 3d22             msg="
-0000a750: 4e56 4944 4541 2047 5055 206e 6f74 2061  NVIDEA GPU not a
-0000a760: 7661 696c 6162 6c65 2028 6173 2065 7661  vailable (as eva
-0000a770: 6c75 6174 6564 2062 7920 6e76 6964 6561  luated by nvidea
-0000a780: 2d73 6d69 2072 6574 7572 6e69 6e67 204e  -smi returning N
-0000a790: 6f6e 6522 2c0a 2020 2020 2020 2020 2020  one",.          
-0000a7a0: 2020 2020 2020 2020 2020 736f 7572 6365            source
-0000a7b0: 3d6d 756c 7469 5f73 706c 6974 5f76 6964  =multi_split_vid
-0000a7c0: 656f 2e5f 5f6e 616d 655f 5f2c 0a20 2020  eo.__name__,.   
-0000a7d0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-0000a7e0: 2020 2020 2020 2020 2020 2063 6f6d 6d61             comma
-0000a7f0: 6e64 203d 2027 6666 6d70 6567 202d 6877  nd = 'ffmpeg -hw
-0000a800: 6163 6365 6c20 6175 746f 202d 6920 227b  accel auto -i "{
-0000a810: 7d22 202d 7373 207b 7d20 2d74 6f20 7b7d  }" -ss {} -to {}
-0000a820: 202d 633a 7620 6832 3634 5f6e 7665 6e63   -c:v h264_nvenc
-0000a830: 202d 6173 796e 6320 3120 227b 7d22 272e   -async 1 "{}"'.
-0000a840: 666f 726d 6174 280a 2020 2020 2020 2020  format(.        
-0000a850: 2020 2020 2020 2020 6669 6c65 5f70 6174          file_pat
-0000a860: 682c 2073 7461 7274 5f74 696d 652c 2065  h, start_time, e
-0000a870: 6e64 5f74 696d 652c 2073 6176 655f 7061  nd_time, save_pa
-0000a880: 7468 0a20 2020 2020 2020 2020 2020 2029  th.            )
-0000a890: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-0000a8a0: 2020 2020 2020 2020 2020 2063 6f6d 6d61             comma
-0000a8b0: 6e64 203d 2066 2766 666d 7065 6720 2d69  nd = f'ffmpeg -i
-0000a8c0: 2022 7b66 696c 655f 7061 7468 7d22 202d   "{file_path}" -
-0000a8d0: 7373 207b 7374 6172 745f 7469 6d65 7d20  ss {start_time} 
-0000a8e0: 2d74 6f20 7b65 6e64 5f74 696d 657d 202d  -to {end_time} -
-0000a8f0: 6173 796e 6320 3120 227b 7361 7665 5f70  async 1 "{save_p
-0000a900: 6174 687d 2227 0a20 2020 2020 2020 2070  ath}"'.        p
-0000a910: 7269 6e74 2822 5072 6f63 6573 7369 6e67  rint("Processing
-0000a920: 2076 6964 656f 2063 6c69 7020 7b7d 2e2e   video clip {}..
-0000a930: 2e22 2e66 6f72 6d61 7428 7374 7228 636c  .".format(str(cl
-0000a940: 6970 5f63 6e74 202b 2031 2929 290a 2020  ip_cnt + 1))).  
-0000a950: 2020 2020 2020 7375 6270 726f 6365 7373        subprocess
-0000a960: 2e63 616c 6c28 636f 6d6d 616e 642c 2073  .call(command, s
-0000a970: 6865 6c6c 3d54 7275 652c 2073 7464 6f75  hell=True, stdou
-0000a980: 743d 7375 6270 726f 6365 7373 2e50 4950  t=subprocess.PIP
-0000a990: 4529 0a20 2020 2074 696d 6572 2e73 746f  E).    timer.sto
-0000a9a0: 705f 7469 6d65 7228 290a 2020 2020 7374  p_timer().    st
-0000a9b0: 646f 7574 5f73 7563 6365 7373 280a 2020  dout_success(.  
-0000a9c0: 2020 2020 2020 6d73 673d 6622 5669 6465        msg=f"Vide
-0000a9d0: 6f20 7b66 696c 655f 6e61 6d65 7d20 636f  o {file_name} co
-0000a9e0: 6e76 6572 7465 6420 696e 746f 207b 7374  nverted into {st
-0000a9f0: 7228 6c65 6e28 7374 6172 745f 7469 6d65  r(len(start_time
-0000aa00: 7329 297d 2063 6c69 7073 2069 6e20 6469  s))} clips in di
-0000aa10: 7265 6374 6f72 7920 7b64 6972 5f6e 616d  rectory {dir_nam
-0000aa20: 657d 2122 2c0a 2020 2020 2020 2020 656c  e}!",.        el
-0000aa30: 6170 7365 645f 7469 6d65 3d74 696d 6572  apsed_time=timer
-0000aa40: 2e65 6c61 7073 6564 5f74 696d 655f 7374  .elapsed_time_st
-0000aa50: 722c 0a20 2020 2020 2020 2073 6f75 7263  r,.        sourc
-0000aa60: 653d 6d75 6c74 695f 7370 6c69 745f 7669  e=multi_split_vi
-0000aa70: 6465 6f2e 5f5f 6e61 6d65 5f5f 2c0a 2020  deo.__name__,.  
-0000aa80: 2020 290a 0a0a 2320 6d75 6c74 695f 7370    )...# multi_sp
-0000aa90: 6c69 745f 7669 6465 6f28 6669 6c65 5f70  lit_video(file_p
-0000aaa0: 6174 683d 7227 2f55 7365 7273 2f73 696d  ath=r'/Users/sim
-0000aab0: 6f6e 2f44 6573 6b74 6f70 2f74 696d 655f  on/Desktop/time_
-0000aac0: 735f 636f 6e76 6572 7465 642e 6d70 3427  s_converted.mp4'
-0000aad0: 2c20 7374 6172 745f 7469 6d65 733d 5b27  , start_times=['
-0000aae0: 3030 3a30 303a 3031 272c 2027 3030 3a30  00:00:01', '00:0
-0000aaf0: 303a 3032 275d 2c20 656e 645f 7469 6d65  0:02'], end_time
-0000ab00: 733d 5b27 3030 3a30 303a 3034 272c 2027  s=['00:00:04', '
-0000ab10: 3030 3a30 303a 3035 275d 2c20 6770 753d  00:00:05'], gpu=
-0000ab20: 4661 6c73 6529 0a0a 0a64 6566 2063 726f  False)...def cro
-0000ab30: 705f 7369 6e67 6c65 5f76 6964 656f 280a  p_single_video(.
-0000ab40: 2020 2020 6669 6c65 5f70 6174 683a 2055      file_path: U
-0000ab50: 6e69 6f6e 5b73 7472 2c20 6f73 2e50 6174  nion[str, os.Pat
-0000ab60: 684c 696b 655d 2c20 6770 753a 204f 7074  hLike], gpu: Opt
-0000ab70: 696f 6e61 6c5b 626f 6f6c 5d20 3d20 4661  ional[bool] = Fa
-0000ab80: 6c73 650a 2920 2d3e 204e 6f6e 653a 0a20  lse.) -> None:. 
-0000ab90: 2020 2022 2222 0a20 2020 2043 726f 7020     """.    Crop 
-0000aba0: 6120 7369 6e67 6c65 2076 6964 656f 2075  a single video u
-0000abb0: 7369 6e67 2060 6073 696d 6261 2e76 6964  sing ``simba.vid
-0000abc0: 656f 5f70 726f 6365 7373 6f72 732e 726f  eo_processors.ro
-0000abd0: 695f 7365 6c65 6374 6f72 2e52 4f49 5365  i_selector.ROISe
-0000abe0: 6c65 6374 6f72 6060 2069 6e74 6572 6661  lector`` interfa
-0000abf0: 6365 2e20 5265 7375 6c74 7320 6973 2073  ce. Results is s
-0000ac00: 6176 6564 2069 6e20 7468 6520 7361 6d65  aved in the same
-0000ac10: 2064 6972 6563 746f 7279 2061 7320 696e   directory as in
-0000ac20: 7075 7420 7669 6465 6f20 7769 7468 2074  put video with t
-0000ac30: 6865 0a20 2020 2060 605f 6372 6f70 7065  he.    ``_croppe
-0000ac40: 642e 6d70 3460 6020 7375 6666 6978 602e  d.mp4`` suffix`.
-0000ac50: 0a0a 2020 2020 3a70 6172 616d 6574 6572  ..    :parameter
-0000ac60: 2073 7472 2066 696c 655f 7061 7468 3a20   str file_path: 
-0000ac70: 5061 7468 2074 6f20 7669 6465 6f20 6669  Path to video fi
-0000ac80: 6c65 2e0a 2020 2020 3a70 6172 616d 6574  le..    :paramet
-0000ac90: 6572 204f 7074 696f 6e61 6c5b 626f 6f6c  er Optional[bool
-0000aca0: 5d20 6770 753a 2049 6620 5472 7565 2c20  ] gpu: If True, 
-0000acb0: 7573 6520 4e56 4944 4541 2047 5055 2063  use NVIDEA GPU c
-0000acc0: 6f64 6563 732e 2044 6566 6175 6c74 2046  odecs. Default F
-0000acd0: 616c 7365 2e0a 0a20 2020 203a 6578 616d  alse...    :exam
-0000ace0: 706c 653a 0a20 2020 203e 3e3e 205f 203d  ple:.    >>> _ =
-0000acf0: 2063 726f 705f 7369 6e67 6c65 5f76 6964   crop_single_vid
-0000ad00: 656f 2866 696c 655f 7061 7468 3d27 7072  eo(file_path='pr
-0000ad10: 6f6a 6563 745f 666f 6c64 6572 2f76 6964  oject_folder/vid
-0000ad20: 656f 732f 5669 6465 6f5f 312e 6d70 3427  eos/Video_1.mp4'
-0000ad30: 290a 2020 2020 2222 220a 0a20 2020 2069  ).    """..    i
-0000ad40: 6620 6770 7520 616e 6420 6e6f 7420 6368  f gpu and not ch
-0000ad50: 6563 6b5f 6e76 6964 6561 5f67 7075 5f61  eck_nvidea_gpu_a
-0000ad60: 7661 696c 6162 6c65 2829 3a0a 2020 2020  vailable():.    
-0000ad70: 2020 2020 7261 6973 6520 4646 4d50 4547      raise FFMPEG
-0000ad80: 436f 6465 6347 5055 4572 726f 7228 0a20  CodecGPUError(. 
-0000ad90: 2020 2020 2020 2020 2020 206d 7367 3d22             msg="
-0000ada0: 4e56 4944 4541 2047 5055 206e 6f74 2061  NVIDEA GPU not a
-0000adb0: 7661 696c 6162 6c65 2028 6173 2065 7661  vailable (as eva
-0000adc0: 6c75 6174 6564 2062 7920 6e76 6964 6561  luated by nvidea
-0000add0: 2d73 6d69 2072 6574 7572 6e69 6e67 204e  -smi returning N
-0000ade0: 6f6e 6522 2c0a 2020 2020 2020 2020 2020  one",.          
-0000adf0: 2020 736f 7572 6365 3d63 726f 705f 7369    source=crop_si
-0000ae00: 6e67 6c65 5f76 6964 656f 2e5f 5f6e 616d  ngle_video.__nam
-0000ae10: 655f 5f2c 0a20 2020 2020 2020 2029 0a20  e__,.        ). 
-0000ae20: 2020 2063 6865 636b 5f66 696c 655f 6578     check_file_ex
-0000ae30: 6973 745f 616e 645f 7265 6164 6162 6c65  ist_and_readable
-0000ae40: 2866 696c 655f 7061 7468 3d66 696c 655f  (file_path=file_
-0000ae50: 7061 7468 290a 2020 2020 5f20 3d20 6765  path).    _ = ge
-0000ae60: 745f 7669 6465 6f5f 6d65 7461 5f64 6174  t_video_meta_dat
-0000ae70: 6128 7669 6465 6f5f 7061 7468 3d66 696c  a(video_path=fil
-0000ae80: 655f 7061 7468 290a 2020 2020 6469 725f  e_path).    dir_
-0000ae90: 6e61 6d65 2c20 6669 6c65 5f6e 616d 652c  name, file_name,
-0000aea0: 2065 7874 203d 2067 6574 5f66 6e5f 6578   ext = get_fn_ex
-0000aeb0: 7428 6669 6c65 7061 7468 3d66 696c 655f  t(filepath=file_
-0000aec0: 7061 7468 290a 2020 2020 726f 695f 7365  path).    roi_se
-0000aed0: 6c65 6374 6f72 203d 2052 4f49 5365 6c65  lector = ROISele
-0000aee0: 6374 6f72 2870 6174 683d 6669 6c65 5f70  ctor(path=file_p
-0000aef0: 6174 6829 0a20 2020 2072 6f69 5f73 656c  ath).    roi_sel
-0000af00: 6563 746f 722e 7275 6e28 290a 2020 2020  ector.run().    
-0000af10: 6966 2028 0a20 2020 2020 2020 2028 726f  if (.        (ro
-0000af20: 695f 7365 6c65 6374 6f72 2e74 6f70 5f6c  i_selector.top_l
-0000af30: 6566 745b 305d 203c 2030 290a 2020 2020  eft[0] < 0).    
-0000af40: 2020 2020 6f72 2028 726f 695f 7365 6c65      or (roi_sele
-0000af50: 6374 6f72 2e74 6f70 5f6c 6566 745b 315d  ctor.top_left[1]
-0000af60: 203c 2030 290a 2020 2020 2020 2020 6f72   < 0).        or
-0000af70: 2028 726f 695f 7365 6c65 6374 6f72 2e62   (roi_selector.b
-0000af80: 6f74 746f 6d5f 7269 6768 745b 305d 203c  ottom_right[0] <
-0000af90: 2030 290a 2020 2020 2020 2020 6f72 2028   0).        or (
-0000afa0: 726f 695f 7365 6c65 6374 6f72 2e62 6f74  roi_selector.bot
-0000afb0: 746f 6d5f 7269 6768 745b 315d 203c 2031  tom_right[1] < 1
-0000afc0: 290a 2020 2020 293a 0a20 2020 2020 2020  ).    ):.       
-0000afd0: 2072 6169 7365 2043 6f75 6e74 4572 726f   raise CountErro
-0000afe0: 7228 0a20 2020 2020 2020 2020 2020 206d  r(.            m
-0000aff0: 7367 3d22 4352 4f50 2046 4149 4c45 443a  sg="CROP FAILED:
-0000b000: 2043 616e 6e6f 7420 7573 6520 6e65 6761   Cannot use nega
-0000b010: 7469 7665 2063 726f 7020 636f 6f72 6469  tive crop coordi
-0000b020: 6e61 7465 732e 222c 0a20 2020 2020 2020  nates.",.       
-0000b030: 2020 2020 2073 6f75 7263 653d 6372 6f70       source=crop
-0000b040: 5f6d 756c 7469 706c 655f 7669 6465 6f73  _multiple_videos
-0000b050: 2e5f 5f6e 616d 655f 5f2c 0a20 2020 2020  .__name__,.     
-0000b060: 2020 2029 0a20 2020 2073 6176 655f 7061     ).    save_pa
-0000b070: 7468 203d 206f 732e 7061 7468 2e6a 6f69  th = os.path.joi
-0000b080: 6e28 6469 725f 6e61 6d65 2c20 6622 7b66  n(dir_name, f"{f
-0000b090: 696c 655f 6e61 6d65 7d5f 6372 6f70 7065  ile_name}_croppe
-0000b0a0: 642e 6d70 3422 290a 2020 2020 6966 206f  d.mp4").    if o
-0000b0b0: 732e 7061 7468 2e69 7366 696c 6528 7361  s.path.isfile(sa
-0000b0c0: 7665 5f70 6174 6829 3a0a 2020 2020 2020  ve_path):.      
-0000b0d0: 2020 7261 6973 6520 4669 6c65 4578 6973    raise FileExis
-0000b0e0: 7445 7272 6f72 280a 2020 2020 2020 2020  tError(.        
-0000b0f0: 2020 2020 6d73 673d 6622 5349 4d42 4120      msg=f"SIMBA 
-0000b100: 4552 524f 523a 2054 6865 206f 7574 2066  ERROR: The out f
-0000b110: 696c 6520 2061 6c72 6561 6479 2065 7869  ile  already exi
-0000b120: 7374 3a20 7b73 6176 655f 7061 7468 7d2e  st: {save_path}.
-0000b130: 222c 0a20 2020 2020 2020 2020 2020 2073  ",.            s
-0000b140: 6f75 7263 653d 6372 6f70 5f73 696e 676c  ource=crop_singl
-0000b150: 655f 7669 6465 6f2e 5f5f 6e61 6d65 5f5f  e_video.__name__
-0000b160: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-0000b170: 7469 6d65 7220 3d20 5369 6d62 6154 696d  timer = SimbaTim
-0000b180: 6572 2873 7461 7274 3d54 7275 6529 0a20  er(start=True). 
-0000b190: 2020 2069 6620 6770 753a 0a20 2020 2020     if gpu:.     
-0000b1a0: 2020 2063 6f6d 6d61 6e64 203d 2066 2766     command = f'f
-0000b1b0: 666d 7065 6720 2d68 7761 6363 656c 2061  fmpeg -hwaccel a
-0000b1c0: 7574 6f20 2d63 3a76 2068 3236 345f 6375  uto -c:v h264_cu
-0000b1d0: 7669 6420 2d69 2022 7b66 696c 655f 7061  vid -i "{file_pa
-0000b1e0: 7468 7d22 202d 7666 2022 6372 6f70 3d7b  th}" -vf "crop={
-0000b1f0: 726f 695f 7365 6c65 6374 6f72 2e77 6964  roi_selector.wid
-0000b200: 7468 7d3a 7b72 6f69 5f73 656c 6563 746f  th}:{roi_selecto
-0000b210: 722e 6865 6967 6874 7d3a 7b72 6f69 5f73  r.height}:{roi_s
-0000b220: 656c 6563 746f 722e 746f 705f 6c65 6674  elector.top_left
-0000b230: 5b30 5d7d 3a7b 726f 695f 7365 6c65 6374  [0]}:{roi_select
-0000b240: 6f72 2e74 6f70 5f6c 6566 745b 315d 7d22  or.top_left[1]}"
-0000b250: 202d 633a 7620 6832 3634 5f6e 7665 6e63   -c:v h264_nvenc
-0000b260: 202d 633a 6120 636f 7079 2022 7b73 6176   -c:a copy "{sav
-0000b270: 655f 7061 7468 7d22 270a 2020 2020 656c  e_path}"'.    el
-0000b280: 7365 3a0a 2020 2020 2020 2020 636f 6d6d  se:.        comm
-0000b290: 616e 6420 3d20 6627 6666 6d70 6567 202d  and = f'ffmpeg -
-0000b2a0: 7920 2d69 2022 7b66 696c 655f 7061 7468  y -i "{file_path
-0000b2b0: 7d22 202d 7666 2022 6372 6f70 3d7b 726f  }" -vf "crop={ro
-0000b2c0: 695f 7365 6c65 6374 6f72 2e77 6964 7468  i_selector.width
-0000b2d0: 7d3a 7b72 6f69 5f73 656c 6563 746f 722e  }:{roi_selector.
-0000b2e0: 6865 6967 6874 7d3a 7b72 6f69 5f73 656c  height}:{roi_sel
-0000b2f0: 6563 746f 722e 746f 705f 6c65 6674 5b30  ector.top_left[0
-0000b300: 5d7d 3a7b 726f 695f 7365 6c65 6374 6f72  ]}:{roi_selector
-0000b310: 2e74 6f70 5f6c 6566 745b 315d 7d22 202d  .top_left[1]}" -
-0000b320: 633a 7620 6c69 6278 3236 3420 2d63 7266  c:v libx264 -crf
-0000b330: 2031 3720 2d63 3a61 2063 6f70 7920 227b   17 -c:a copy "{
-0000b340: 7361 7665 5f70 6174 687d 2227 0a20 2020  save_path}"'.   
-0000b350: 2073 7562 7072 6f63 6573 732e 6361 6c6c   subprocess.call
-0000b360: 2863 6f6d 6d61 6e64 2c20 7368 656c 6c3d  (command, shell=
-0000b370: 5472 7565 290a 2020 2020 7469 6d65 722e  True).    timer.
-0000b380: 7374 6f70 5f74 696d 6572 2829 0a20 2020  stop_timer().   
-0000b390: 2073 7464 6f75 745f 7375 6363 6573 7328   stdout_success(
-0000b3a0: 0a20 2020 2020 2020 2066 2256 6964 656f  .        f"Video
-0000b3b0: 207b 6669 6c65 5f6e 616d 657d 2063 726f   {file_name} cro
-0000b3c0: 7070 6564 2061 6e64 2073 6176 6564 2061  pped and saved a
-0000b3d0: 7420 7b73 6176 655f 7061 7468 7d22 2c0a  t {save_path}",.
-0000b3e0: 2020 2020 2020 2020 656c 6170 7365 645f          elapsed_
-0000b3f0: 7469 6d65 3d74 696d 6572 2e65 6c61 7073  time=timer.elaps
-0000b400: 6564 5f74 696d 655f 7374 722c 0a20 2020  ed_time_str,.   
-0000b410: 2020 2020 2073 6f75 7263 653d 6372 6f70       source=crop
-0000b420: 5f73 696e 676c 655f 7669 6465 6f2e 5f5f  _single_video.__
-0000b430: 6e61 6d65 5f5f 2c0a 2020 2020 290a 0a0a  name__,.    )...
-0000b440: 2320 5f20 3d20 6372 6f70 5f73 696e 676c  # _ = crop_singl
-0000b450: 655f 7669 6465 6f28 6669 6c65 5f70 6174  e_video(file_pat
-0000b460: 683d 272f 5573 6572 732f 7369 6d6f 6e2f  h='/Users/simon/
-0000b470: 4465 736b 746f 702f 656e 7673 2f74 726f  Desktop/envs/tro
-0000b480: 7562 6c65 7368 6f6f 7469 6e67 2f41 5245  ubleshooting/ARE
-0000b490: 535f 6461 7461 2f54 6572 6d69 7465 2054  S_data/Termite T
-0000b4a0: 6573 7420 312f 5465 726d 6974 6520 5465  est 1/Termite Te
-0000b4b0: 7374 2031 2e6d 7034 2729 0a0a 2320 6372  st 1.mp4')..# cr
-0000b4c0: 6f70 5f73 696e 676c 655f 7669 6465 6f28  op_single_video(
-0000b4d0: 6669 6c65 5f70 6174 683d 7227 433a 5c55  file_path=r'C:\U
-0000b4e0: 7365 7273 5c4e 6170 655f 436f 6d70 7574  sers\Nape_Comput
-0000b4f0: 6572 5f32 5c44 6573 6b74 6f70 5c74 6573  er_2\Desktop\tes
-0000b500: 745f 7669 6465 6f73 5c42 6f78 315f 504d  t_videos\Box1_PM
-0000b510: 325f 6461 795f 355f 3230 3231 3131 3034  2_day_5_20211104
-0000b520: 5431 3731 3032 312e 6d70 3427 2c20 6770  T171021.mp4', gp
-0000b530: 753d 4661 6c73 6529 0a0a 0a64 6566 2063  u=False)...def c
-0000b540: 726f 705f 6d75 6c74 6970 6c65 5f76 6964  rop_multiple_vid
-0000b550: 656f 7328 0a20 2020 2064 6972 6563 746f  eos(.    directo
-0000b560: 7279 5f70 6174 683a 2055 6e69 6f6e 5b73  ry_path: Union[s
-0000b570: 7472 2c20 6f73 2e50 6174 684c 696b 655d  tr, os.PathLike]
-0000b580: 2c0a 2020 2020 6f75 7470 7574 5f70 6174  ,.    output_pat
-0000b590: 683a 2055 6e69 6f6e 5b73 7472 2c20 6f73  h: Union[str, os
-0000b5a0: 2e50 6174 684c 696b 655d 2c0a 2020 2020  .PathLike],.    
-0000b5b0: 6770 753a 204f 7074 696f 6e61 6c5b 626f  gpu: Optional[bo
-0000b5c0: 6f6c 5d20 3d20 4661 6c73 652c 0a29 202d  ol] = False,.) -
-0000b5d0: 3e20 4e6f 6e65 3a0a 2020 2020 2222 220a  > None:.    """.
-0000b5e0: 2020 2020 4372 6f70 206d 756c 7469 706c      Crop multipl
-0000b5f0: 6520 7669 6465 6f73 2069 6e20 6120 666f  e videos in a fo
-0000b600: 6c64 6572 2061 6363 6f72 6469 6e67 2074  lder according t
-0000b610: 6f20 6372 6f70 2d63 6f6f 7264 696e 6174  o crop-coordinat
-0000b620: 6573 2064 6566 696e 6564 2069 6e20 7468  es defined in th
-0000b630: 6520 2a2a 6669 7273 742a 2a20 7669 6465  e **first** vide
-0000b640: 6f2e 0a0a 2020 2020 3a70 6172 616d 6574  o...    :paramet
-0000b650: 6572 2073 7472 2064 6972 6563 746f 7279  er str directory
-0000b660: 5f70 6174 683a 2044 6972 6563 746f 7279  _path: Directory
-0000b670: 2063 6f6e 7461 696e 696e 6720 696e 7075   containing inpu
-0000b680: 7420 7669 6465 6f73 2e0a 2020 2020 3a70  t videos..    :p
-0000b690: 6172 616d 6574 6572 2073 7472 206f 7574  arameter str out
-0000b6a0: 7075 745f 7061 7468 3a20 4469 7265 6374  put_path: Direct
-0000b6b0: 6f72 7920 7768 6572 6520 746f 2073 6176  ory where to sav
-0000b6c0: 6520 7468 6520 6372 6f70 7065 6420 7669  e the cropped vi
-0000b6d0: 6465 6f73 2e0a 2020 2020 3a70 6172 616d  deos..    :param
-0000b6e0: 6574 6572 204f 7074 696f 6e61 6c5b 626f  eter Optional[bo
-0000b6f0: 6f6c 5d20 6770 753a 2049 6620 5472 7565  ol] gpu: If True
-0000b700: 2c20 7573 6520 4e56 4944 4541 2047 5055  , use NVIDEA GPU
-0000b710: 2063 6f64 6563 732e 2044 6566 6175 6c74   codecs. Default
-0000b720: 2046 616c 7365 2e0a 0a20 2020 203a 6578   False...    :ex
-0000b730: 616d 706c 653a 0a20 2020 203e 3e3e 205f  ample:.    >>> _
-0000b740: 203d 2063 726f 705f 6d75 6c74 6970 6c65   = crop_multiple
-0000b750: 5f76 6964 656f 7328 6469 7265 6374 6f72  _videos(director
-0000b760: 795f 7061 7468 3d27 7072 6f6a 6563 745f  y_path='project_
-0000b770: 666f 6c64 6572 2f76 6964 656f 7327 2c20  folder/videos', 
-0000b780: 6f75 7470 7574 5f70 6174 683d 2770 726f  output_path='pro
-0000b790: 6a65 6374 5f66 6f6c 6465 722f 7669 6465  ject_folder/vide
-0000b7a0: 6f73 2f6d 795f 6e65 775f 666f 6c64 6572  os/my_new_folder
-0000b7b0: 2729 0a20 2020 2022 2222 0a0a 2020 2020  ').    """..    
-0000b7c0: 6966 2067 7075 2061 6e64 206e 6f74 2063  if gpu and not c
-0000b7d0: 6865 636b 5f6e 7669 6465 615f 6770 755f  heck_nvidea_gpu_
-0000b7e0: 6176 6169 6c61 626c 6528 293a 0a20 2020  available():.   
-0000b7f0: 2020 2020 2072 6169 7365 2046 464d 5045       raise FFMPE
-0000b800: 4743 6f64 6563 4750 5545 7272 6f72 280a  GCodecGPUError(.
-0000b810: 2020 2020 2020 2020 2020 2020 6d73 673d              msg=
-0000b820: 224e 5649 4445 4120 4750 5520 6e6f 7420  "NVIDEA GPU not 
-0000b830: 6176 6169 6c61 626c 6520 2861 7320 6576  available (as ev
-0000b840: 616c 7561 7465 6420 6279 206e 7669 6465  aluated by nvide
-0000b850: 612d 736d 6920 7265 7475 726e 696e 6720  a-smi returning 
-0000b860: 4e6f 6e65 222c 0a20 2020 2020 2020 2020  None",.         
-0000b870: 2020 2073 6f75 7263 653d 6372 6f70 5f6d     source=crop_m
-0000b880: 756c 7469 706c 655f 7669 6465 6f73 2e5f  ultiple_videos._
-0000b890: 5f6e 616d 655f 5f2c 0a20 2020 2020 2020  _name__,.       
-0000b8a0: 2029 0a20 2020 2069 6620 6e6f 7420 6f73   ).    if not os
-0000b8b0: 2e70 6174 682e 6973 6469 7228 6469 7265  .path.isdir(dire
-0000b8c0: 6374 6f72 795f 7061 7468 293a 0a20 2020  ctory_path):.   
-0000b8d0: 2020 2020 2072 6169 7365 204e 6f74 4469       raise NotDi
-0000b8e0: 7265 6374 6f72 7945 7272 6f72 280a 2020  rectoryError(.  
-0000b8f0: 2020 2020 2020 2020 2020 6d73 673d 2253            msg="S
-0000b900: 494d 4241 2045 5252 4f52 3a20 7b7d 2069  IMBA ERROR: {} i
-0000b910: 7320 6e6f 7420 6120 7661 6c69 6420 6469  s not a valid di
-0000b920: 7265 6374 6f72 7922 2e66 6f72 6d61 7428  rectory".format(
-0000b930: 6469 7265 6374 6f72 795f 7061 7468 292c  directory_path),
-0000b940: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
-0000b950: 7263 653d 6372 6f70 5f6d 756c 7469 706c  rce=crop_multipl
-0000b960: 655f 7669 6465 6f73 2e5f 5f6e 616d 655f  e_videos.__name_
-0000b970: 5f2c 0a20 2020 2020 2020 2029 0a20 2020  _,.        ).   
-0000b980: 2076 6964 656f 5f70 6174 6873 203d 205b   video_paths = [
-0000b990: 5d0a 2020 2020 6669 6c65 5f70 6174 6873  ].    file_paths
-0000b9a0: 5f69 6e5f 666f 6c64 6572 203d 205b 0a20  _in_folder = [. 
-0000b9b0: 2020 2020 2020 2066 2066 6f72 2066 2069         f for f i
-0000b9c0: 6e20 676c 6f62 2e67 6c6f 6228 6469 7265  n glob.glob(dire
-0000b9d0: 6374 6f72 795f 7061 7468 202b 2022 2f2a  ctory_path + "/*
-0000b9e0: 2229 2069 6620 6f73 2e70 6174 682e 6973  ") if os.path.is
-0000b9f0: 6669 6c65 2866 290a 2020 2020 5d0a 2020  file(f).    ].  
-0000ba00: 2020 666f 7220 6669 6c65 5f70 6174 6820    for file_path 
-0000ba10: 696e 2066 696c 655f 7061 7468 735f 696e  in file_paths_in
-0000ba20: 5f66 6f6c 6465 723a 0a20 2020 2020 2020  _folder:.       
-0000ba30: 205f 2c20 5f2c 2065 7874 203d 2067 6574   _, _, ext = get
-0000ba40: 5f66 6e5f 6578 7428 6669 6c65 7061 7468  _fn_ext(filepath
-0000ba50: 3d66 696c 655f 7061 7468 290a 2020 2020  =file_path).    
-0000ba60: 2020 2020 6966 2065 7874 2e6c 6f77 6572      if ext.lower
-0000ba70: 2829 2069 6e20 4f70 7469 6f6e 732e 414c  () in Options.AL
-0000ba80: 4c5f 5649 4445 4f5f 464f 524d 4154 5f4f  L_VIDEO_FORMAT_O
-0000ba90: 5054 494f 4e53 2e76 616c 7565 3a0a 2020  PTIONS.value:.  
-0000baa0: 2020 2020 2020 2020 2020 7669 6465 6f5f            video_
-0000bab0: 7061 7468 732e 6170 7065 6e64 2866 696c  paths.append(fil
-0000bac0: 655f 7061 7468 290a 2020 2020 6966 206c  e_path).    if l
-0000bad0: 656e 2876 6964 656f 5f70 6174 6873 2920  en(video_paths) 
-0000bae0: 3c20 313a 0a20 2020 2020 2020 2072 6169  < 1:.        rai
-0000baf0: 7365 204e 6f46 696c 6573 466f 756e 6445  se NoFilesFoundE
-0000bb00: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-0000bb10: 2020 6d73 673d 2253 494d 4241 2045 5252    msg="SIMBA ERR
-0000bb20: 4f52 3a20 4e6f 2066 696c 6573 2077 6974  OR: No files wit
-0000bb30: 6820 2e6d 7034 2c20 2e61 7669 2c20 2e6d  h .mp4, .avi, .m
-0000bb40: 6f76 2c20 2e66 6c76 2066 696c 6520 656e  ov, .flv file en
-0000bb50: 6469 6e67 2066 6f75 6e64 2069 6e20 7468  ding found in th
-0000bb60: 6520 7b7d 2064 6972 6563 746f 7279 222e  e {} directory".
-0000bb70: 666f 726d 6174 280a 2020 2020 2020 2020  format(.        
-0000bb80: 2020 2020 2020 2020 6469 7265 6374 6f72          director
-0000bb90: 795f 7061 7468 0a20 2020 2020 2020 2020  y_path.         
-0000bba0: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
-0000bbb0: 2020 736f 7572 6365 3d63 726f 705f 6d75    source=crop_mu
-0000bbc0: 6c74 6970 6c65 5f76 6964 656f 732e 5f5f  ltiple_videos.__
-0000bbd0: 6e61 6d65 5f5f 2c0a 2020 2020 2020 2020  name__,.        
-0000bbe0: 290a 2020 2020 726f 695f 7365 6c65 6374  ).    roi_select
-0000bbf0: 6f72 203d 2052 4f49 5365 6c65 6374 6f72  or = ROISelector
-0000bc00: 2870 6174 683d 6669 6c65 5f70 6174 6873  (path=file_paths
-0000bc10: 5f69 6e5f 666f 6c64 6572 5b30 5d29 0a20  _in_folder[0]). 
-0000bc20: 2020 2072 6f69 5f73 656c 6563 746f 722e     roi_selector.
-0000bc30: 7275 6e28 290a 2020 2020 6966 2028 726f  run().    if (ro
-0000bc40: 695f 7365 6c65 6374 6f72 2e77 6964 7468  i_selector.width
-0000bc50: 203d 3d20 3020 616e 6420 726f 695f 7365   == 0 and roi_se
-0000bc60: 6c65 6374 6f72 2e68 6569 6768 7420 3d3d  lector.height ==
-0000bc70: 2030 2920 6f72 2028 0a20 2020 2020 2020   0) or (.       
-0000bc80: 2072 6f69 5f73 656c 6563 746f 722e 7769   roi_selector.wi
-0000bc90: 6474 680a 2020 2020 2020 2020 2b20 726f  dth.        + ro
-0000bca0: 695f 7365 6c65 6374 6f72 2e68 6569 6768  i_selector.heigh
-0000bcb0: 740a 2020 2020 2020 2020 2b20 726f 695f  t.        + roi_
-0000bcc0: 7365 6c65 6374 6f72 2e74 6f70 5f6c 6566  selector.top_lef
-0000bcd0: 745b 305d 0a20 2020 2020 2020 202b 2072  t[0].        + r
-0000bce0: 6f69 5f73 656c 6563 746f 722e 746f 705f  oi_selector.top_
-0000bcf0: 6c65 6674 5b31 5d0a 2020 2020 2020 2020  left[1].        
-0000bd00: 3d3d 2030 0a20 2020 2029 3a0a 2020 2020  == 0.    ):.    
-0000bd10: 2020 2020 7261 6973 6520 436f 756e 7445      raise CountE
-0000bd20: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-0000bd30: 2020 6d73 673d 2243 524f 5020 4641 494c    msg="CROP FAIL
-0000bd40: 4544 3a20 4372 6f70 7069 6e67 2068 6569  ED: Cropping hei
-0000bd50: 6768 7420 616e 6420 7769 6474 6820 6172  ght and width ar
-0000bd60: 6520 626f 7468 2030 2e20 506c 6561 7365  e both 0. Please
-0000bd70: 2074 7279 2061 6761 696e 2e22 2c0a 2020   try again.",.  
-0000bd80: 2020 2020 2020 2020 2020 736f 7572 6365            source
-0000bd90: 3d63 726f 705f 6d75 6c74 6970 6c65 5f76  =crop_multiple_v
-0000bda0: 6964 656f 732e 5f5f 6e61 6d65 5f5f 2c0a  ideos.__name__,.
-0000bdb0: 2020 2020 2020 2020 290a 2020 2020 6966          ).    if
-0000bdc0: 2028 0a20 2020 2020 2020 2028 726f 695f   (.        (roi_
-0000bdd0: 7365 6c65 6374 6f72 2e74 6f70 5f6c 6566  selector.top_lef
-0000bde0: 745b 305d 203c 2030 290a 2020 2020 2020  t[0] < 0).      
-0000bdf0: 2020 6f72 2028 726f 695f 7365 6c65 6374    or (roi_select
-0000be00: 6f72 2e74 6f70 5f6c 6566 745b 315d 203c  or.top_left[1] <
-0000be10: 2030 290a 2020 2020 2020 2020 6f72 2028   0).        or (
-0000be20: 726f 695f 7365 6c65 6374 6f72 2e62 6f74  roi_selector.bot
-0000be30: 746f 6d5f 7269 6768 745b 305d 203c 2030  tom_right[0] < 0
-0000be40: 290a 2020 2020 2020 2020 6f72 2028 726f  ).        or (ro
-0000be50: 695f 7365 6c65 6374 6f72 2e62 6f74 746f  i_selector.botto
-0000be60: 6d5f 7269 6768 745b 315d 203c 2031 290a  m_right[1] < 1).
-0000be70: 2020 2020 293a 0a20 2020 2020 2020 2072      ):.        r
-0000be80: 6169 7365 2043 6f75 6e74 4572 726f 7228  aise CountError(
-0000be90: 0a20 2020 2020 2020 2020 2020 206d 7367  .            msg
-0000bea0: 3d22 4352 4f50 2046 4149 4c45 443a 2043  ="CROP FAILED: C
-0000beb0: 616e 6e6f 7420 7573 6520 6e65 6761 7469  annot use negati
-0000bec0: 7665 2063 726f 7020 636f 6f72 6469 6e61  ve crop coordina
-0000bed0: 7465 732e 222c 0a20 2020 2020 2020 2020  tes.",.         
-0000bee0: 2020 2073 6f75 7263 653d 6372 6f70 5f6d     source=crop_m
-0000bef0: 756c 7469 706c 655f 7669 6465 6f73 2e5f  ultiple_videos._
-0000bf00: 5f6e 616d 655f 5f2c 0a20 2020 2020 2020  _name__,.       
-0000bf10: 2029 0a20 2020 2074 696d 6572 203d 2053   ).    timer = S
-0000bf20: 696d 6261 5469 6d65 7228 7374 6172 743d  imbaTimer(start=
-0000bf30: 5472 7565 290a 2020 2020 666f 7220 6669  True).    for fi
-0000bf40: 6c65 5f63 6e74 2c20 6669 6c65 5f70 6174  le_cnt, file_pat
-0000bf50: 6820 696e 2065 6e75 6d65 7261 7465 2876  h in enumerate(v
-0000bf60: 6964 656f 5f70 6174 6873 293a 0a20 2020  ideo_paths):.   
-0000bf70: 2020 2020 2076 6964 656f 5f74 696d 6572       video_timer
-0000bf80: 203d 2053 696d 6261 5469 6d65 7228 7374   = SimbaTimer(st
-0000bf90: 6172 743d 5472 7565 290a 2020 2020 2020  art=True).      
-0000bfa0: 2020 6469 725f 6e61 6d65 2c20 6669 6c65    dir_name, file
-0000bfb0: 5f6e 616d 652c 2065 7874 203d 2067 6574  _name, ext = get
-0000bfc0: 5f66 6e5f 6578 7428 6669 6c65 7061 7468  _fn_ext(filepath
-0000bfd0: 3d66 696c 655f 7061 7468 290a 2020 2020  =file_path).    
-0000bfe0: 2020 2020 7072 696e 7428 6622 4372 6f70      print(f"Crop
-0000bff0: 7069 6e67 2076 6964 656f 207b 6669 6c65  ping video {file
-0000c000: 5f6e 616d 657d 2e2e 2e22 290a 2020 2020  _name}...").    
-0000c010: 2020 2020 7669 6465 6f5f 6d65 7461 5f64      video_meta_d
-0000c020: 6174 6120 3d20 6765 745f 7669 6465 6f5f  ata = get_video_
-0000c030: 6d65 7461 5f64 6174 6128 6669 6c65 5f70  meta_data(file_p
-0000c040: 6174 6829 0a20 2020 2020 2020 2069 6620  ath).        if 
-0000c050: 2872 6f69 5f73 656c 6563 746f 722e 626f  (roi_selector.bo
-0000c060: 7474 6f6d 5f72 6967 6874 5b30 5d20 3e20  ttom_right[0] > 
-0000c070: 7669 6465 6f5f 6d65 7461 5f64 6174 615b  video_meta_data[
-0000c080: 2277 6964 7468 225d 2920 6f72 2028 0a20  "width"]) or (. 
-0000c090: 2020 2020 2020 2020 2020 2072 6f69 5f73             roi_s
-0000c0a0: 656c 6563 746f 722e 626f 7474 6f6d 5f72  elector.bottom_r
-0000c0b0: 6967 6874 5b31 5d20 3e20 7669 6465 6f5f  ight[1] > video_
-0000c0c0: 6d65 7461 5f64 6174 615b 2268 6569 6768  meta_data["heigh
-0000c0d0: 7422 5d0a 2020 2020 2020 2020 293a 0a20  t"].        ):. 
-0000c0e0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0000c0f0: 2049 6e76 616c 6964 496e 7075 7445 7272   InvalidInputErr
-0000c100: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-0000c110: 2020 2020 6d73 673d 6627 4361 6e6e 6f74      msg=f'Cannot
-0000c120: 2063 726f 7020 7669 6465 6f20 7b66 696c   crop video {fil
-0000c130: 655f 6e61 6d65 7d20 6f66 2073 697a 6520  e_name} of size 
-0000c140: 7b76 6964 656f 5f6d 6574 615f 6461 7461  {video_meta_data
-0000c150: 5b22 7265 736f 6c75 7469 6f6e 5f73 7472  ["resolution_str
-0000c160: 225d 7d20 6174 206c 6f63 6174 696f 6e20  "]} at location 
-0000c170: 746f 7020 6c65 6674 3a20 7b72 6f69 5f73  top left: {roi_s
-0000c180: 656c 6563 746f 722e 746f 705f 6c65 6674  elector.top_left
-0000c190: 7d2c 2062 6f74 746f 6d20 7269 6768 743a  }, bottom right:
-0000c1a0: 207b 726f 695f 7365 6c65 6374 6f72 2e62   {roi_selector.b
-0000c1b0: 6f74 746f 6d5f 7269 6768 747d 272c 0a20  ottom_right}',. 
-0000c1c0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0000c1d0: 6f75 7263 653d 6372 6f70 5f6d 756c 7469  ource=crop_multi
-0000c1e0: 706c 655f 7669 6465 6f73 2e5f 5f6e 616d  ple_videos.__nam
-0000c1f0: 655f 5f2c 0a20 2020 2020 2020 2020 2020  e__,.           
-0000c200: 2029 0a20 2020 2020 2020 2073 6176 655f   ).        save_
-0000c210: 7061 7468 203d 206f 732e 7061 7468 2e6a  path = os.path.j
-0000c220: 6f69 6e28 6f75 7470 7574 5f70 6174 682c  oin(output_path,
-0000c230: 2066 696c 655f 6e61 6d65 202b 2022 5f63   file_name + "_c
-0000c240: 726f 7070 6564 2e6d 7034 2229 0a20 2020  ropped.mp4").   
-0000c250: 2020 2020 2069 6620 6770 753a 0a20 2020       if gpu:.   
-0000c260: 2020 2020 2020 2020 2063 6f6d 6d61 6e64           command
-0000c270: 203d 2066 2766 666d 7065 6720 2d68 7761   = f'ffmpeg -hwa
-0000c280: 6363 656c 2061 7574 6f20 2d63 3a76 2068  ccel auto -c:v h
-0000c290: 3236 345f 6375 7669 6420 2d69 2022 7b66  264_cuvid -i "{f
-0000c2a0: 696c 655f 7061 7468 7d22 202d 7666 2022  ile_path}" -vf "
-0000c2b0: 6372 6f70 3d7b 726f 695f 7365 6c65 6374  crop={roi_select
-0000c2c0: 6f72 2e77 6964 7468 7d3a 7b72 6f69 5f73  or.width}:{roi_s
-0000c2d0: 656c 6563 746f 722e 6865 6967 6874 7d3a  elector.height}:
-0000c2e0: 7b72 6f69 5f73 656c 6563 746f 722e 746f  {roi_selector.to
-0000c2f0: 705f 6c65 6674 5b30 5d7d 3a7b 726f 695f  p_left[0]}:{roi_
-0000c300: 7365 6c65 6374 6f72 2e74 6f70 5f6c 6566  selector.top_lef
-0000c310: 745b 315d 7d22 202d 633a 7620 6832 3634  t[1]}" -c:v h264
-0000c320: 5f6e 7665 6e63 202d 633a 6120 636f 7079  _nvenc -c:a copy
-0000c330: 2022 7b73 6176 655f 7061 7468 7d22 202d   "{save_path}" -
-0000c340: 7927 0a20 2020 2020 2020 2065 6c73 653a  y'.        else:
-0000c350: 0a20 2020 2020 2020 2020 2020 2063 6f6d  .            com
-0000c360: 6d61 6e64 203d 2066 2766 666d 7065 6720  mand = f'ffmpeg 
-0000c370: 2d69 2022 7b66 696c 655f 7061 7468 7d22  -i "{file_path}"
-0000c380: 202d 7666 2022 6372 6f70 3d7b 726f 695f   -vf "crop={roi_
-0000c390: 7365 6c65 6374 6f72 2e77 6964 7468 7d3a  selector.width}:
-0000c3a0: 7b72 6f69 5f73 656c 6563 746f 722e 6865  {roi_selector.he
-0000c3b0: 6967 6874 7d3a 7b72 6f69 5f73 656c 6563  ight}:{roi_selec
-0000c3c0: 746f 722e 746f 705f 6c65 6674 5b30 5d7d  tor.top_left[0]}
-0000c3d0: 3a7b 726f 695f 7365 6c65 6374 6f72 2e74  :{roi_selector.t
-0000c3e0: 6f70 5f6c 6566 745b 315d 7d22 202d 633a  op_left[1]}" -c:
-0000c3f0: 7620 6c69 6278 3236 3420 2d63 7266 2031  v libx264 -crf 1
-0000c400: 3720 2d63 3a61 2063 6f70 7920 227b 7361  7 -c:a copy "{sa
-0000c410: 7665 5f70 6174 687d 2220 2d79 270a 2020  ve_path}" -y'.  
-0000c420: 2020 2020 2020 7375 6270 726f 6365 7373        subprocess
-0000c430: 2e63 616c 6c28 636f 6d6d 616e 642c 2073  .call(command, s
-0000c440: 6865 6c6c 3d54 7275 6529 0a20 2020 2020  hell=True).     
-0000c450: 2020 2076 6964 656f 5f74 696d 6572 2e73     video_timer.s
-0000c460: 746f 705f 7469 6d65 7228 290a 2020 2020  top_timer().    
-0000c470: 2020 2020 7072 696e 7428 0a20 2020 2020      print(.     
-0000c480: 2020 2020 2020 2066 2256 6964 656f 207b         f"Video {
-0000c490: 6669 6c65 5f6e 616d 657d 2063 726f 7070  file_name} cropp
-0000c4a0: 6564 2028 5669 6465 6f20 7b66 696c 655f  ed (Video {file_
-0000c4b0: 636e 742b 317d 2f7b 6c65 6e28 7669 6465  cnt+1}/{len(vide
-0000c4c0: 6f5f 7061 7468 7329 7d2c 2065 6c61 7073  o_paths)}, elaps
-0000c4d0: 6564 2074 696d 653a 207b 7669 6465 6f5f  ed time: {video_
-0000c4e0: 7469 6d65 722e 656c 6170 7365 645f 7469  timer.elapsed_ti
-0000c4f0: 6d65 5f73 7472 7d29 220a 2020 2020 2020  me_str})".      
-0000c500: 2020 290a 2020 2020 7469 6d65 722e 7374    ).    timer.st
-0000c510: 6f70 5f74 696d 6572 2829 0a20 2020 2073  op_timer().    s
-0000c520: 7464 6f75 745f 7375 6363 6573 7328 0a20  tdout_success(. 
-0000c530: 2020 2020 2020 206d 7367 3d66 227b 7374         msg=f"{st
-0000c540: 7228 6c65 6e28 7669 6465 6f5f 7061 7468  r(len(video_path
-0000c550: 7329 297d 2076 6964 656f 7320 6372 6f70  s))} videos crop
-0000c560: 7065 6420 616e 6420 7361 7665 6420 696e  ped and saved in
-0000c570: 207b 6469 7265 6374 6f72 795f 7061 7468   {directory_path
-0000c580: 7d20 6469 7265 6374 6f72 7922 2c0a 2020  } directory",.  
-0000c590: 2020 2020 2020 656c 6170 7365 645f 7469        elapsed_ti
-0000c5a0: 6d65 3d74 696d 6572 2e65 6c61 7073 6564  me=timer.elapsed
-0000c5b0: 5f74 696d 655f 7374 722c 0a20 2020 2020  _time_str,.     
-0000c5c0: 2020 2073 6f75 7263 653d 6372 6f70 5f6d     source=crop_m
-0000c5d0: 756c 7469 706c 655f 7669 6465 6f73 2e5f  ultiple_videos._
-0000c5e0: 5f6e 616d 655f 5f2c 0a20 2020 2029 0a0a  _name__,.    )..
-0000c5f0: 0a23 205f 203d 2063 726f 705f 6d75 6c74  .# _ = crop_mult
-0000c600: 6970 6c65 5f76 6964 656f 7328 6469 7265  iple_videos(dire
-0000c610: 6374 6f72 795f 7061 7468 3d27 2f55 7365  ctory_path='/Use
-0000c620: 7273 2f73 696d 6f6e 2f44 6573 6b74 6f70  rs/simon/Desktop
-0000c630: 2f65 6e76 732f 7472 6f75 626c 6573 686f  /envs/troublesho
-0000c640: 6f74 696e 672f 7477 6f5f 626c 6163 6b5f  oting/two_black_
-0000c650: 616e 696d 616c 735f 3134 6270 2f76 6964  animals_14bp/vid
-0000c660: 656f 7327 2c20 6f75 7470 7574 5f70 6174  eos', output_pat
-0000c670: 683d 272f 5573 6572 732f 7369 6d6f 6e2f  h='/Users/simon/
-0000c680: 4465 736b 746f 702f 656e 7673 2f74 726f  Desktop/envs/tro
-0000c690: 7562 6c65 7368 6f6f 7469 6e67 2f74 776f  ubleshooting/two
-0000c6a0: 5f62 6c61 636b 5f61 6e69 6d61 6c73 5f31  _black_animals_1
-0000c6b0: 3462 702f 7465 7374 2f74 6573 7427 290a  4bp/test/test').
-0000c6c0: 0a0a 6465 6620 6672 616d 6573 5f74 6f5f  ..def frames_to_
-0000c6d0: 6d6f 7669 6528 0a20 2020 2064 6972 6563  movie(.    direc
-0000c6e0: 746f 7279 3a20 556e 696f 6e5b 7374 722c  tory: Union[str,
-0000c6f0: 206f 732e 5061 7468 4c69 6b65 5d2c 0a20   os.PathLike],. 
-0000c700: 2020 2066 7073 3a20 696e 742c 0a20 2020     fps: int,.   
-0000c710: 2062 6974 7261 7465 3a20 696e 742c 0a20   bitrate: int,. 
-0000c720: 2020 2069 6d67 5f66 6f72 6d61 743a 2073     img_format: s
-0000c730: 7472 2c0a 2020 2020 6770 753a 204f 7074  tr,.    gpu: Opt
-0000c740: 696f 6e61 6c5b 626f 6f6c 5d20 3d20 4661  ional[bool] = Fa
-0000c750: 6c73 652c 0a29 202d 3e20 4e6f 6e65 3a0a  lse,.) -> None:.
-0000c760: 2020 2020 2222 220a 2020 2020 4d65 7267      """.    Merg
-0000c770: 6520 616c 6c20 696d 6167 6520 6669 6c65  e all image file
-0000c780: 7320 696e 2061 2066 6f6c 6465 7220 746f  s in a folder to
-0000c790: 2061 206d 7034 2076 6964 656f 2066 696c   a mp4 video fil
-0000c7a0: 652e 2056 6964 656f 2066 696c 6520 6973  e. Video file is
-0000c7b0: 2073 746f 7265 6420 696e 2074 6865 2073   stored in the s
-0000c7c0: 616d 6520 6469 7265 6374 6f72 7920 6173  ame directory as
-0000c7d0: 2074 6865 0a20 2020 2069 6e70 7574 2064   the.    input d
-0000c7e0: 6972 6563 746f 7279 2073 7562 2d66 6f6c  irectory sub-fol
-0000c7f0: 6465 722e 0a0a 2020 2020 2e2e 206e 6f74  der...    .. not
-0000c800: 653a 3a0a 2020 2020 2020 2054 6865 2049  e::.       The I
-0000c810: 6d61 6765 2066 696c 6573 2068 6176 6520  mage files have 
-0000c820: 746f 2068 6176 6520 6f72 6465 7265 6420  to have ordered 
-0000c830: 6e75 6d65 7269 6361 6c20 6e61 6d65 7320  numerical names 
-0000c840: 652e 672e 2c20 6060 312e 706e 6760 602c  e.g., ``1.png``,
-0000c850: 2060 6032 2e70 6e67 6060 2065 7463 2e2e   ``2.png`` etc..
-0000c860: 2e0a 0a20 2020 203a 7061 7261 6d65 7465  ...    :paramete
-0000c870: 7220 7374 7220 6469 7265 6374 6f72 793a  r str directory:
-0000c880: 2044 6972 6563 746f 7279 2063 6f6e 7461   Directory conta
-0000c890: 696e 696e 6720 7468 6520 696d 6167 6573  ining the images
-0000c8a0: 2e0a 2020 2020 3a70 6172 616d 6574 6572  ..    :parameter
-0000c8b0: 2069 6e74 2066 7073 3a20 5468 6520 6672   int fps: The fr
-0000c8c0: 616d 6520 7261 7465 206f 6620 7468 6520  ame rate of the 
-0000c8d0: 6f75 7470 7574 2076 6964 656f 2e0a 2020  output video..  
-0000c8e0: 2020 3a70 6172 616d 6574 6572 2069 6e74    :parameter int
-0000c8f0: 2062 6974 7261 7465 3a20 5468 6520 6269   bitrate: The bi
-0000c900: 7472 6174 6520 6f66 2074 6865 206f 7574  trate of the out
-0000c910: 7075 7420 7669 6465 6f20 2865 2e67 2e2c  put video (e.g.,
-0000c920: 2033 3230 3030 292e 0a20 2020 203a 7061   32000)..    :pa
-0000c930: 7261 6d65 7465 7220 7374 7220 696d 675f  rameter str img_
-0000c940: 666f 726d 6174 3a20 5468 6520 666f 726d  format: The form
-0000c950: 6174 206f 6620 7468 6520 696e 7075 7420  at of the input 
-0000c960: 696d 6167 6520 6669 6c65 7320 2865 2e67  image files (e.g
-0000c970: 2e2c 2060 6070 6e67 6060 292e 0a20 2020  ., ``png``)..   
-0000c980: 203a 7061 7261 6d65 7465 7220 4f70 7469   :parameter Opti
-0000c990: 6f6e 616c 5b62 6f6f 6c5d 2067 7075 3a20  onal[bool] gpu: 
-0000c9a0: 4966 2054 7275 652c 2075 7365 204e 5649  If True, use NVI
-0000c9b0: 4445 4120 4750 5520 636f 6465 6373 2e20  DEA GPU codecs. 
-0000c9c0: 4465 6661 756c 7420 4661 6c73 652e 0a0a  Default False...
-0000c9d0: 2020 2020 3a65 7861 6d70 6c65 3a0a 2020      :example:.  
-0000c9e0: 2020 3e3e 3e20 5f20 3d20 6672 616d 6573    >>> _ = frames
-0000c9f0: 5f74 6f5f 6d6f 7669 6528 6469 7265 6374  _to_movie(direct
-0000ca00: 6f72 795f 7061 7468 3d27 7072 6f6a 6563  ory_path='projec
-0000ca10: 745f 666f 6c64 6572 2f76 6964 656f 5f69  t_folder/video_i
-0000ca20: 6d67 272c 2066 7073 3d31 352c 2062 6974  mg', fps=15, bit
-0000ca30: 7261 7465 3d33 3230 3030 2c20 696d 675f  rate=32000, img_
-0000ca40: 666f 726d 6174 3d27 706e 6727 290a 2020  format='png').  
-0000ca50: 2020 2222 220a 0a20 2020 2069 6620 6770    """..    if gp
-0000ca60: 7520 616e 6420 6e6f 7420 6368 6563 6b5f  u and not check_
-0000ca70: 6e76 6964 6561 5f67 7075 5f61 7661 696c  nvidea_gpu_avail
-0000ca80: 6162 6c65 2829 3a0a 2020 2020 2020 2020  able():.        
-0000ca90: 7261 6973 6520 4646 4d50 4547 436f 6465  raise FFMPEGCode
-0000caa0: 6347 5055 4572 726f 7228 0a20 2020 2020  cGPUError(.     
-0000cab0: 2020 2020 2020 206d 7367 3d22 4e56 4944         msg="NVID
-0000cac0: 4541 2047 5055 206e 6f74 2061 7661 696c  EA GPU not avail
-0000cad0: 6162 6c65 2028 6173 2065 7661 6c75 6174  able (as evaluat
-0000cae0: 6564 2062 7920 6e76 6964 6561 2d73 6d69  ed by nvidea-smi
-0000caf0: 2072 6574 7572 6e69 6e67 204e 6f6e 6522   returning None"
-0000cb00: 2c0a 2020 2020 2020 2020 2020 2020 736f  ,.            so
-0000cb10: 7572 6365 3d66 7261 6d65 735f 746f 5f6d  urce=frames_to_m
-0000cb20: 6f76 6965 2e5f 5f6e 616d 655f 5f2c 0a20  ovie.__name__,. 
-0000cb30: 2020 2020 2020 2029 0a20 2020 2069 6620         ).    if 
-0000cb40: 6e6f 7420 6f73 2e70 6174 682e 6973 6469  not os.path.isdi
-0000cb50: 7228 6469 7265 6374 6f72 7929 3a0a 2020  r(directory):.  
-0000cb60: 2020 2020 2020 7261 6973 6520 4e6f 7444        raise NotD
-0000cb70: 6972 6563 746f 7279 4572 726f 7228 0a20  irectoryError(. 
-0000cb80: 2020 2020 2020 2020 2020 206d 7367 3d22             msg="
-0000cb90: 5349 4d42 4120 4552 524f 523a 207b 7d20  SIMBA ERROR: {} 
-0000cba0: 6973 206e 6f74 2061 2076 616c 6964 2064  is not a valid d
-0000cbb0: 6972 6563 746f 7279 222e 666f 726d 6174  irectory".format
-0000cbc0: 2864 6972 6563 746f 7279 292c 0a20 2020  (directory),.   
-0000cbd0: 2020 2020 2020 2020 2073 6f75 7263 653d           source=
-0000cbe0: 6672 616d 6573 5f74 6f5f 6d6f 7669 652e  frames_to_movie.
-0000cbf0: 5f5f 6e61 6d65 5f5f 2c0a 2020 2020 2020  __name__,.      
-0000cc00: 2020 290a 2020 2020 6368 6563 6b5f 696e    ).    check_in
-0000cc10: 7428 6e61 6d65 3d22 4650 5322 2c20 7661  t(name="FPS", va
-0000cc20: 6c75 653d 6670 7329 0a20 2020 2063 6865  lue=fps).    che
-0000cc30: 636b 5f69 6e74 286e 616d 653d 2242 4954  ck_int(name="BIT
-0000cc40: 5241 5445 222c 2076 616c 7565 3d62 6974  RATE", value=bit
-0000cc50: 7261 7465 290a 2020 2020 6669 6c65 5f70  rate).    file_p
-0000cc60: 6174 6873 5f69 6e5f 666f 6c64 6572 203d  aths_in_folder =
-0000cc70: 205b 6620 666f 7220 6620 696e 2067 6c6f   [f for f in glo
-0000cc80: 622e 676c 6f62 2864 6972 6563 746f 7279  b.glob(directory
-0000cc90: 202b 2022 2f2a 2229 2069 6620 6f73 2e70   + "/*") if os.p
-0000cca0: 6174 682e 6973 6669 6c65 2866 295d 0a20  ath.isfile(f)]. 
-0000ccb0: 2020 2069 6d67 5f70 6174 6873 5f69 6e5f     img_paths_in_
-0000ccc0: 666f 6c64 6572 203d 205b 0a20 2020 2020  folder = [.     
-0000ccd0: 2020 2078 2066 6f72 2078 2069 6e20 6669     x for x in fi
-0000cce0: 6c65 5f70 6174 6873 5f69 6e5f 666f 6c64  le_paths_in_fold
-0000ccf0: 6572 2069 6620 5061 7468 2878 292e 7375  er if Path(x).su
-0000cd00: 6666 6978 5b31 3a5d 203d 3d20 696d 675f  ffix[1:] == img_
-0000cd10: 666f 726d 6174 0a20 2020 205d 0a20 2020  format.    ].   
-0000cd20: 2069 6620 6c65 6e28 696d 675f 7061 7468   if len(img_path
-0000cd30: 735f 696e 5f66 6f6c 6465 7229 203c 2031  s_in_folder) < 1
-0000cd40: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
-0000cd50: 4e6f 4669 6c65 7346 6f75 6e64 4572 726f  NoFilesFoundErro
-0000cd60: 7228 0a20 2020 2020 2020 2020 2020 206d  r(.            m
-0000cd70: 7367 3d22 5349 4d42 4120 4552 524f 523a  sg="SIMBA ERROR:
-0000cd80: 205a 6572 6f20 696d 6167 6573 206f 6620   Zero images of 
-0000cd90: 6669 6c65 2d74 7970 6520 7b7d 2066 6f75  file-type {} fou
-0000cda0: 6e64 2069 6e20 7b7d 2064 6972 6563 746f  nd in {} directo
-0000cdb0: 7279 222e 666f 726d 6174 280a 2020 2020  ry".format(.    
-0000cdc0: 2020 2020 2020 2020 2020 2020 696d 675f              img_
-0000cdd0: 666f 726d 6174 2c20 6469 7265 6374 6f72  format, director
-0000cde0: 790a 2020 2020 2020 2020 2020 2020 292c  y.            ),
-0000cdf0: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
-0000ce00: 7263 653d 6672 616d 6573 5f74 6f5f 6d6f  rce=frames_to_mo
-0000ce10: 7669 652e 5f5f 6e61 6d65 5f5f 2c0a 2020  vie.__name__,.  
-0000ce20: 2020 2020 2020 290a 2020 2020 696d 6720        ).    img 
-0000ce30: 3d20 6376 322e 696d 7265 6164 2869 6d67  = cv2.imread(img
-0000ce40: 5f70 6174 6873 5f69 6e5f 666f 6c64 6572  _paths_in_folder
-0000ce50: 5b30 5d29 0a20 2020 2069 6d67 5f68 2c20  [0]).    img_h, 
-0000ce60: 696d 675f 7720 3d20 696e 7428 696d 672e  img_w = int(img.
-0000ce70: 7368 6170 655b 305d 292c 2069 6e74 2869  shape[0]), int(i
-0000ce80: 6d67 2e73 6861 7065 5b31 5d29 0a20 2020  mg.shape[1]).   
-0000ce90: 2066 666d 7065 675f 666e 203d 206f 732e   ffmpeg_fn = os.
-0000cea0: 7061 7468 2e6a 6f69 6e28 6469 7265 6374  path.join(direct
-0000ceb0: 6f72 792c 2022 2564 2e7b 7d22 2e66 6f72  ory, "%d.{}".for
-0000cec0: 6d61 7428 696d 675f 666f 726d 6174 2929  mat(img_format))
-0000ced0: 0a20 2020 2073 6176 655f 7061 7468 203d  .    save_path =
-0000cee0: 206f 732e 7061 7468 2e6a 6f69 6e28 0a20   os.path.join(. 
-0000cef0: 2020 2020 2020 206f 732e 7061 7468 2e64         os.path.d
-0000cf00: 6972 6e61 6d65 2864 6972 6563 746f 7279  irname(directory
-0000cf10: 292c 206f 732e 7061 7468 2e62 6173 656e  ), os.path.basen
-0000cf20: 616d 6528 6469 7265 6374 6f72 7929 202b  ame(directory) +
-0000cf30: 2022 2e6d 7034 220a 2020 2020 290a 2020   ".mp4".    ).  
-0000cf40: 2020 6966 2067 7075 3a0a 2020 2020 2020    if gpu:.      
-0000cf50: 2020 636f 6d6d 616e 6420 3d20 6627 6666    command = f'ff
-0000cf60: 6d70 6567 202d 7920 2d72 207b 6670 737d  mpeg -y -r {fps}
-0000cf70: 202d 6620 696d 6167 6532 202d 7320 7b69   -f image2 -s {i
-0000cf80: 6d67 5f68 7d78 7b69 6d67 5f77 7d20 2d69  mg_h}x{img_w} -i
-0000cf90: 2022 7b66 666d 7065 675f 666e 7d22 202d   "{ffmpeg_fn}" -
-0000cfa0: 633a 7620 6832 3634 5f6e 7665 6e63 202d  c:v h264_nvenc -
-0000cfb0: 623a 7620 7b62 6974 7261 7465 7d6b 2022  b:v {bitrate}k "
-0000cfc0: 7b73 6176 655f 7061 7468 7d22 202d 7927  {save_path}" -y'
-0000cfd0: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
-0000cfe0: 2020 2063 6f6d 6d61 6e64 203d 2028 0a20     command = (. 
-0000cff0: 2020 2020 2020 2020 2020 2073 7472 280a             str(.
-0000d000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d010: 2266 666d 7065 6720 2d79 202d 7220 220a  "ffmpeg -y -r ".
-0000d020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d030: 2b20 7374 7228 6670 7329 0a20 2020 2020  + str(fps).     
-0000d040: 2020 2020 2020 2020 2020 202b 2022 202d             + " -
-0000d050: 6620 696d 6167 6532 202d 7320 220a 2020  f image2 -s ".  
-0000d060: 2020 2020 2020 2020 2020 2020 2020 2b20                + 
-0000d070: 7374 7228 696d 675f 6829 0a20 2020 2020  str(img_h).     
-0000d080: 2020 2020 2020 2020 2020 202b 2022 7822             + "x"
-0000d090: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d0a0: 202b 2073 7472 2869 6d67 5f77 290a 2020   + str(img_w).  
-0000d0b0: 2020 2020 2020 2020 2020 2020 2020 2b20                + 
-0000d0c0: 2220 2d69 2022 0a20 2020 2020 2020 2020  " -i ".         
-0000d0d0: 2020 2020 2020 202b 2027 2227 0a20 2020         + '"'.   
-0000d0e0: 2020 2020 2020 2020 2020 2020 202b 2066               + f
-0000d0f0: 666d 7065 675f 666e 0a20 2020 2020 2020  fmpeg_fn.       
-0000d100: 2020 2020 2020 2020 202b 2027 2227 0a20           + '"'. 
-0000d110: 2020 2020 2020 2020 2020 2020 2020 202b                 +
-0000d120: 2022 202d 7663 6f64 6563 206c 6962 7832   " -vcodec libx2
-0000d130: 3634 202d 6220 220a 2020 2020 2020 2020  64 -b ".        
-0000d140: 2020 2020 2020 2020 2b20 7374 7228 6269          + str(bi
-0000d150: 7472 6174 6529 0a20 2020 2020 2020 2020  trate).         
-0000d160: 2020 2020 2020 202b 2022 6b20 220a 2020         + "k ".  
-0000d170: 2020 2020 2020 2020 2020 2020 2020 2b20                + 
-0000d180: 2722 270a 2020 2020 2020 2020 2020 2020  '"'.            
-0000d190: 2020 2020 2b20 7374 7228 7361 7665 5f70      + str(save_p
-0000d1a0: 6174 6829 0a20 2020 2020 2020 2020 2020  ath).           
-0000d1b0: 2020 2020 202b 2027 2227 0a20 2020 2020       + '"'.     
-0000d1c0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0000d1d0: 2020 2020 202b 2022 202d 7922 0a20 2020       + " -y".   
-0000d1e0: 2020 2020 2029 0a20 2020 2070 7269 6e74       ).    print
-0000d1f0: 280a 2020 2020 2020 2020 2243 7265 6174  (.        "Creat
-0000d200: 696e 6720 7b7d 2066 726f 6d20 7b7d 2069  ing {} from {} i
-0000d210: 6d61 6765 732e 2e2e 222e 666f 726d 6174  mages...".format
-0000d220: 280a 2020 2020 2020 2020 2020 2020 6f73  (.            os
-0000d230: 2e70 6174 682e 6261 7365 6e61 6d65 2873  .path.basename(s
-0000d240: 6176 655f 7061 7468 292c 2073 7472 286c  ave_path), str(l
-0000d250: 656e 2869 6d67 5f70 6174 6873 5f69 6e5f  en(img_paths_in_
-0000d260: 666f 6c64 6572 2929 0a20 2020 2020 2020  folder)).       
-0000d270: 2029 0a20 2020 2029 0a20 2020 2073 7562   ).    ).    sub
-0000d280: 7072 6f63 6573 732e 6361 6c6c 2863 6f6d  process.call(com
-0000d290: 6d61 6e64 2c20 7368 656c 6c3d 5472 7565  mand, shell=True
-0000d2a0: 290a 2020 2020 7374 646f 7574 5f73 7563  ).    stdout_suc
-0000d2b0: 6365 7373 286d 7367 3d66 2256 6964 656f  cess(msg=f"Video
-0000d2c0: 2063 7265 6174 6564 2061 7420 7b73 6176   created at {sav
-0000d2d0: 655f 7061 7468 7d22 2c20 736f 7572 6365  e_path}", source
-0000d2e0: 3d66 7261 6d65 735f 746f 5f6d 6f76 6965  =frames_to_movie
-0000d2f0: 2e5f 5f6e 616d 655f 5f29 0a0a 0a64 6566  .__name__)...def
-0000d300: 2076 6964 656f 5f63 6f6e 6361 7465 6e61   video_concatena
-0000d310: 746f 7228 0a20 2020 2076 6964 656f 5f6f  tor(.    video_o
-0000d320: 6e65 5f70 6174 683a 2055 6e69 6f6e 5b73  ne_path: Union[s
-0000d330: 7472 2c20 6f73 2e50 6174 684c 696b 655d  tr, os.PathLike]
-0000d340: 2c0a 2020 2020 7669 6465 6f5f 7477 6f5f  ,.    video_two_
-0000d350: 7061 7468 3a20 556e 696f 6e5b 7374 722c  path: Union[str,
-0000d360: 206f 732e 5061 7468 4c69 6b65 5d2c 0a20   os.PathLike],. 
-0000d370: 2020 2072 6573 6f6c 7574 696f 6e3a 2055     resolution: U
-0000d380: 6e69 6f6e 5b69 6e74 2c20 7374 725d 2c0a  nion[int, str],.
-0000d390: 2020 2020 686f 7269 7a6f 6e74 616c 3a20      horizontal: 
-0000d3a0: 626f 6f6c 2c0a 2020 2020 6770 753a 204f  bool,.    gpu: O
-0000d3b0: 7074 696f 6e61 6c5b 626f 6f6c 5d20 3d20  ptional[bool] = 
-0000d3c0: 4661 6c73 652c 0a29 202d 3e20 4e6f 6e65  False,.) -> None
-0000d3d0: 3a0a 2020 2020 2222 220a 2020 2020 436f  :.    """.    Co
-0000d3e0: 6e63 6174 656e 6174 6520 7477 6f20 7669  ncatenate two vi
-0000d3f0: 6465 6f73 2074 6f20 6120 7369 6e67 6c65  deos to a single
-0000d400: 2076 6964 656f 0a0a 2020 2020 3a70 6172   video..    :par
-0000d410: 616d 2073 7472 2076 6964 656f 5f6f 6e65  am str video_one
-0000d420: 5f70 6174 683a 2050 6174 6820 746f 2074  _path: Path to t
-0000d430: 6865 2066 6972 7374 2076 6964 656f 2069  he first video i
-0000d440: 6e20 7468 6520 636f 6e63 6174 656e 6174  n the concatenat
-0000d450: 6564 2076 6964 656f 0a20 2020 203a 7061  ed video.    :pa
-0000d460: 7261 6d20 7374 7220 7669 6465 6f5f 7477  ram str video_tw
-0000d470: 6f5f 7061 7468 3a20 5061 7468 2074 6f20  o_path: Path to 
-0000d480: 7468 6520 7365 636f 6e64 2076 6964 656f  the second video
-0000d490: 2069 6e20 7468 6520 636f 6e63 6174 656e   in the concaten
-0000d4a0: 6174 6564 2076 6964 656f 0a20 2020 203a  ated video.    :
-0000d4b0: 7061 7261 6d20 696e 7420 6f72 2073 7472  param int or str
-0000d4c0: 2072 6573 6f6c 7574 696f 6e3a 2049 6620   resolution: If 
-0000d4d0: 7374 722c 2074 6865 6e20 7468 6520 6e61  str, then the na
-0000d4e0: 6d65 206f 6620 7468 6520 7669 6465 6f20  me of the video 
-0000d4f0: 7768 6963 6820 7265 736f 6c75 7469 6f6e  which resolution
-0000d500: 2079 6f75 2077 616e 7420 746f 2072 6574   you want to ret
-0000d510: 6169 6e2e 2045 2e67 2e2c 2060 5669 6465  ain. E.g., `Vide
-0000d520: 6f5f 3160 2e20 456c 7365 2069 6e74 2c20  o_1`. Else int, 
-0000d530: 7265 7072 6573 656e 7469 6e67 2074 6865  representing the
-0000d540: 2076 6964 656f 2077 6964 7468 2028 6966   video width (if
-0000d550: 2076 6572 7469 6361 6c20 636f 6e63 6174   vertical concat
-0000d560: 2920 6f72 2068 6569 6768 7420 2869 6620  ) or height (if 
-0000d570: 686f 7269 7a6f 6e74 616c 2063 6f6e 6361  horizontal conca
-0000d580: 7429 2e20 4173 7065 6374 2072 6169 6f20  t). Aspect raio 
-0000d590: 7769 6c6c 2062 6520 7265 7461 696e 6564  will be retained
-0000d5a0: 2e0a 2020 2020 3a70 6172 616d 2068 6f72  ..    :param hor
-0000d5b0: 697a 6f6e 7461 6c3a 2049 6620 7472 7565  izontal: If true
-0000d5c0: 2c20 7468 656e 2068 6f72 697a 6f6e 7461  , then horizonta
-0000d5d0: 6c20 636f 6e63 6174 656e 6174 696f 6e2e  l concatenation.
-0000d5e0: 2045 6c73 6520 7665 7274 6963 616c 2063   Else vertical c
-0000d5f0: 6f6e 6361 7465 6e61 7469 6f6e 2e0a 2020  oncatenation..  
-0000d600: 2020 3a70 6172 616d 6574 6572 204f 7074    :parameter Opt
-0000d610: 696f 6e61 6c5b 626f 6f6c 5d20 6770 753a  ional[bool] gpu:
-0000d620: 2049 6620 5472 7565 2c20 7573 6520 4e56   If True, use NV
-0000d630: 4944 4541 2047 5055 2063 6f64 6563 732e  IDEA GPU codecs.
-0000d640: 2044 6566 6175 6c74 2046 616c 7365 2e0a   Default False..
-0000d650: 0a20 2020 203a 6578 616d 706c 653a 0a20  .    :example:. 
-0000d660: 2020 203e 3e3e 2076 6964 656f 5f63 6f6e     >>> video_con
-0000d670: 6361 7465 6e61 746f 7228 7669 6465 6f5f  catenator(video_
-0000d680: 6f6e 655f 7061 7468 3d27 7072 6f6a 6563  one_path='projec
-0000d690: 745f 666f 6c64 6572 2f76 6964 656f 732f  t_folder/videos/
-0000d6a0: 5669 6465 6f5f 312e 6d70 3427 2c20 7669  Video_1.mp4', vi
-0000d6b0: 6465 6f5f 7477 6f5f 7061 7468 3d27 7072  deo_two_path='pr
-0000d6c0: 6f6a 6563 745f 666f 6c64 6572 2f76 6964  oject_folder/vid
-0000d6d0: 656f 732f 5669 6465 6f5f 322e 6d70 3427  eos/Video_2.mp4'
-0000d6e0: 2c20 7265 736f 6c75 7469 6f6e 3d38 3030  , resolution=800
-0000d6f0: 2c20 686f 7269 7a6f 6e74 616c 3d54 7275  , horizontal=Tru
-0000d700: 6529 0a20 2020 2022 2222 0a0a 2020 2020  e).    """..    
-0000d710: 6966 2067 7075 2061 6e64 206e 6f74 2063  if gpu and not c
-0000d720: 6865 636b 5f6e 7669 6465 615f 6770 755f  heck_nvidea_gpu_
-0000d730: 6176 6169 6c61 626c 6528 293a 0a20 2020  available():.   
-0000d740: 2020 2020 2072 6169 7365 2046 464d 5045       raise FFMPE
-0000d750: 4743 6f64 6563 4750 5545 7272 6f72 280a  GCodecGPUError(.
-0000d760: 2020 2020 2020 2020 2020 2020 6d73 673d              msg=
-0000d770: 224e 5649 4445 4120 4750 5520 6e6f 7420  "NVIDEA GPU not 
-0000d780: 6176 6169 6c61 626c 6520 2861 7320 6576  available (as ev
-0000d790: 616c 7561 7465 6420 6279 206e 7669 6465  aluated by nvide
-0000d7a0: 612d 736d 6920 7265 7475 726e 696e 6720  a-smi returning 
-0000d7b0: 4e6f 6e65 222c 0a20 2020 2020 2020 2020  None",.         
-0000d7c0: 2020 2073 6f75 7263 653d 7669 6465 6f5f     source=video_
-0000d7d0: 636f 6e63 6174 656e 6174 6f72 2e5f 5f6e  concatenator.__n
-0000d7e0: 616d 655f 5f2c 0a20 2020 2020 2020 2029  ame__,.        )
-0000d7f0: 0a20 2020 2069 6620 6e6f 7420 6368 6563  .    if not chec
-0000d800: 6b5f 6666 6d70 6567 5f61 7661 696c 6162  k_ffmpeg_availab
-0000d810: 6c65 2829 3a0a 2020 2020 2020 2020 7261  le():.        ra
-0000d820: 6973 6520 4646 4d50 4547 4e6f 7446 6f75  ise FFMPEGNotFou
-0000d830: 6e64 4572 726f 7228 0a20 2020 2020 2020  ndError(.       
-0000d840: 2020 2020 206d 7367 3d22 4646 4d50 4547       msg="FFMPEG
-0000d850: 206e 6f74 2066 6f75 6e64 206f 6e20 7468   not found on th
-0000d860: 6520 636f 6d70 7574 6572 2e20 496e 7374  e computer. Inst
-0000d870: 616c 6c20 4646 4d50 4547 2074 6f20 7573  all FFMPEG to us
-0000d880: 6520 7468 6520 636f 6e63 6174 656e 6174  e the concatenat
-0000d890: 696f 6e20 6d65 7468 6f64 2e22 2c0a 2020  ion method.",.  
-0000d8a0: 2020 2020 2020 2020 2020 736f 7572 6365            source
-0000d8b0: 3d76 6964 656f 5f63 6f6e 6361 7465 6e61  =video_concatena
-0000d8c0: 746f 722e 5f5f 6e61 6d65 5f5f 2c0a 2020  tor.__name__,.  
-0000d8d0: 2020 2020 2020 290a 2020 2020 7469 6d65        ).    time
-0000d8e0: 7220 3d20 5369 6d62 6154 696d 6572 2873  r = SimbaTimer(s
-0000d8f0: 7461 7274 3d54 7275 6529 0a20 2020 2066  tart=True).    f
-0000d900: 6f72 2066 696c 655f 7061 7468 2069 6e20  or file_path in 
-0000d910: 5b76 6964 656f 5f6f 6e65 5f70 6174 682c  [video_one_path,
-0000d920: 2076 6964 656f 5f74 776f 5f70 6174 685d   video_two_path]
-0000d930: 3a0a 2020 2020 2020 2020 6368 6563 6b5f  :.        check_
-0000d940: 6669 6c65 5f65 7869 7374 5f61 6e64 5f72  file_exist_and_r
-0000d950: 6561 6461 626c 6528 6669 6c65 5f70 6174  eadable(file_pat
-0000d960: 683d 6669 6c65 5f70 6174 6829 0a20 2020  h=file_path).   
-0000d970: 2020 2020 205f 203d 2067 6574 5f76 6964       _ = get_vid
-0000d980: 656f 5f6d 6574 615f 6461 7461 2866 696c  eo_meta_data(fil
-0000d990: 655f 7061 7468 290a 2020 2020 6966 2074  e_path).    if t
-0000d9a0: 7970 6528 7265 736f 6c75 7469 6f6e 2920  ype(resolution) 
-0000d9b0: 6973 2069 6e74 3a0a 2020 2020 2020 2020  is int:.        
-0000d9c0: 7669 6465 6f5f 6d65 7461 5f64 6174 6120  video_meta_data 
-0000d9d0: 3d20 7b7d 0a20 2020 2020 2020 2069 6620  = {}.        if 
-0000d9e0: 686f 7269 7a6f 6e74 616c 3a0a 2020 2020  horizontal:.    
-0000d9f0: 2020 2020 2020 2020 7669 6465 6f5f 6d65          video_me
-0000da00: 7461 5f64 6174 615b 2268 6569 6768 7422  ta_data["height"
-0000da10: 5d20 3d20 7265 736f 6c75 7469 6f6e 0a20  ] = resolution. 
-0000da20: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0000da30: 2020 2020 2020 2020 2076 6964 656f 5f6d           video_m
-0000da40: 6574 615f 6461 7461 5b22 7769 6474 6822  eta_data["width"
-0000da50: 5d20 3d20 7265 736f 6c75 7469 6f6e 0a20  ] = resolution. 
-0000da60: 2020 2065 6c69 6620 7265 736f 6c75 7469     elif resoluti
-0000da70: 6f6e 2069 7320 2256 6964 656f 2031 223a  on is "Video 1":
-0000da80: 0a20 2020 2020 2020 2076 6964 656f 5f6d  .        video_m
-0000da90: 6574 615f 6461 7461 203d 2067 6574 5f76  eta_data = get_v
-0000daa0: 6964 656f 5f6d 6574 615f 6461 7461 2876  ideo_meta_data(v
-0000dab0: 6964 656f 5f6f 6e65 5f70 6174 6829 0a20  ideo_one_path). 
-0000dac0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0000dad0: 2076 6964 656f 5f6d 6574 615f 6461 7461   video_meta_data
-0000dae0: 203d 2067 6574 5f76 6964 656f 5f6d 6574   = get_video_met
-0000daf0: 615f 6461 7461 2876 6964 656f 5f6f 6e65  a_data(video_one
-0000db00: 5f70 6174 6829 0a20 2020 2064 6972 2c20  _path).    dir, 
-0000db10: 6669 6c65 5f6e 616d 655f 312c 205f 203d  file_name_1, _ =
-0000db20: 2067 6574 5f66 6e5f 6578 7428 7669 6465   get_fn_ext(vide
-0000db30: 6f5f 6f6e 655f 7061 7468 290a 2020 2020  o_one_path).    
-0000db40: 5f2c 2066 696c 655f 6e61 6d65 5f32 2c20  _, file_name_2, 
-0000db50: 5f20 3d20 6765 745f 666e 5f65 7874 2876  _ = get_fn_ext(v
-0000db60: 6964 656f 5f74 776f 5f70 6174 6829 0a20  ideo_two_path). 
-0000db70: 2020 2070 7269 6e74 2866 2243 6f6e 6361     print(f"Conca
-0000db80: 7465 6e61 7469 6e67 2076 6964 656f 7320  tenating videos 
-0000db90: 7b66 696c 655f 6e61 6d65 5f31 7d20 616e  {file_name_1} an
-0000dba0: 6420 7b66 696c 655f 6e61 6d65 5f32 7d2e  d {file_name_2}.
-0000dbb0: 2e2e 2229 0a20 2020 2073 6176 655f 7061  ..").    save_pa
-0000dbc0: 7468 203d 206f 732e 7061 7468 2e6a 6f69  th = os.path.joi
-0000dbd0: 6e28 6469 722c 2066 696c 655f 6e61 6d65  n(dir, file_name
-0000dbe0: 5f31 202b 2066 696c 655f 6e61 6d65 5f32  _1 + file_name_2
-0000dbf0: 202b 2022 5f63 6f6e 6361 742e 6d70 3422   + "_concat.mp4"
-0000dc00: 290a 2020 2020 6966 2068 6f72 697a 6f6e  ).    if horizon
-0000dc10: 7461 6c3a 0a20 2020 2020 2020 2069 6620  tal:.        if 
-0000dc20: 6770 753a 0a20 2020 2020 2020 2020 2020  gpu:.           
-0000dc30: 2063 6f6d 6d61 6e64 203d 2066 2766 666d   command = f'ffm
-0000dc40: 7065 6720 2d79 202d 6877 6163 6365 6c20  peg -y -hwaccel 
-0000dc50: 6175 746f 202d 633a 7620 6832 3634 5f63  auto -c:v h264_c
-0000dc60: 7576 6964 202d 6920 227b 7669 6465 6f5f  uvid -i "{video_
-0000dc70: 6f6e 655f 7061 7468 7d22 202d 6877 6163  one_path}" -hwac
-0000dc80: 6365 6c20 6175 746f 202d 633a 7620 6832  cel auto -c:v h2
-0000dc90: 3634 5f63 7576 6964 202d 6920 227b 7669  64_cuvid -i "{vi
-0000dca0: 6465 6f5f 7477 6f5f 7061 7468 7d22 202d  deo_two_path}" -
-0000dcb0: 6669 6c74 6572 5f63 6f6d 706c 6578 2022  filter_complex "
-0000dcc0: 5b30 3a76 5d73 6361 6c65 3d2d 313a 7b76  [0:v]scale=-1:{v
-0000dcd0: 6964 656f 5f6d 6574 615f 6461 7461 5b22  ideo_meta_data["
-0000dce0: 6865 6967 6874 225d 7d5b 7630 5d3b 5b76  height"]}[v0];[v
-0000dcf0: 305d 5b31 3a76 5d68 7374 6163 6b3d 696e  0][1:v]hstack=in
-0000dd00: 7075 7473 3d32 2220 2d63 3a76 2068 3236  puts=2" -c:v h26
-0000dd10: 345f 6e76 656e 6320 227b 7361 7665 5f70  4_nvenc "{save_p
-0000dd20: 6174 687d 2227 0a20 2020 2020 2020 2065  ath}"'.        e
-0000dd30: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0000dd40: 2063 6f6d 6d61 6e64 203d 2027 6666 6d70   command = 'ffmp
-0000dd50: 6567 202d 7920 2d69 2022 7b7d 2220 2d69  eg -y -i "{}" -i
-0000dd60: 2022 7b7d 2220 2d66 696c 7465 725f 636f   "{}" -filter_co
-0000dd70: 6d70 6c65 7820 225b 303a 765d 7363 616c  mplex "[0:v]scal
-0000dd80: 653d 2d31 3a7b 7d5b 7630 5d3b 5b76 305d  e=-1:{}[v0];[v0]
-0000dd90: 5b31 3a76 5d68 7374 6163 6b3d 696e 7075  [1:v]hstack=inpu
-0000dda0: 7473 3d32 2220 227b 7d22 272e 666f 726d  ts=2" "{}"'.form
-0000ddb0: 6174 280a 2020 2020 2020 2020 2020 2020  at(.            
-0000ddc0: 2020 2020 7669 6465 6f5f 6f6e 655f 7061      video_one_pa
-0000ddd0: 7468 2c20 7669 6465 6f5f 7477 6f5f 7061  th, video_two_pa
-0000dde0: 7468 2c20 7669 6465 6f5f 6d65 7461 5f64  th, video_meta_d
-0000ddf0: 6174 615b 2268 6569 6768 7422 5d2c 2073  ata["height"], s
-0000de00: 6176 655f 7061 7468 0a20 2020 2020 2020  ave_path.       
-0000de10: 2020 2020 2029 0a20 2020 2065 6c73 653a       ).    else:
-0000de20: 0a20 2020 2020 2020 2069 6620 6770 753a  .        if gpu:
-0000de30: 0a20 2020 2020 2020 2020 2020 2063 6f6d  .            com
-0000de40: 6d61 6e64 203d 2066 2766 666d 7065 6720  mand = f'ffmpeg 
-0000de50: 2d79 202d 6877 6163 6365 6c20 6175 746f  -y -hwaccel auto
-0000de60: 202d 633a 7620 6832 3634 5f63 7576 6964   -c:v h264_cuvid
-0000de70: 202d 6920 227b 7669 6465 6f5f 6f6e 655f   -i "{video_one_
-0000de80: 7061 7468 7d22 202d 6877 6163 6365 6c20  path}" -hwaccel 
-0000de90: 6175 746f 202d 633a 7620 6832 3634 5f63  auto -c:v h264_c
-0000dea0: 7576 6964 202d 6920 227b 7669 6465 6f5f  uvid -i "{video_
-0000deb0: 7477 6f5f 7061 7468 7d22 202d 6669 6c74  two_path}" -filt
-0000dec0: 6572 5f63 6f6d 706c 6578 2022 5b30 3a76  er_complex "[0:v
-0000ded0: 5d73 6361 6c65 3d7b 7669 6465 6f5f 6d65  ]scale={video_me
-0000dee0: 7461 5f64 6174 615b 2277 6964 7468 225d  ta_data["width"]
-0000def0: 7d3a 2d31 5b76 305d 3b5b 7630 5d5b 313a  }:-1[v0];[v0][1:
-0000df00: 765d 7673 7461 636b 3d69 6e70 7574 733d  v]vstack=inputs=
-0000df10: 3222 202d 633a 7620 6832 3634 5f6e 7665  2" -c:v h264_nve
-0000df20: 6e63 2022 7b73 6176 655f 7061 7468 7d22  nc "{save_path}"
-0000df30: 270a 2020 2020 2020 2020 656c 7365 3a0a  '.        else:.
-0000df40: 2020 2020 2020 2020 2020 2020 636f 6d6d              comm
-0000df50: 616e 6420 3d20 2766 666d 7065 6720 2d79  and = 'ffmpeg -y
-0000df60: 202d 6920 227b 7d22 202d 6920 227b 7d22   -i "{}" -i "{}"
-0000df70: 202d 6669 6c74 6572 5f63 6f6d 706c 6578   -filter_complex
-0000df80: 2022 5b30 3a76 5d73 6361 6c65 3d7b 7d3a   "[0:v]scale={}:
-0000df90: 2d31 5b76 305d 3b5b 7630 5d5b 313a 765d  -1[v0];[v0][1:v]
-0000dfa0: 7673 7461 636b 3d69 6e70 7574 733d 3222  vstack=inputs=2"
-0000dfb0: 2022 7b7d 2227 2e66 6f72 6d61 7428 0a20   "{}"'.format(. 
-0000dfc0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-0000dfd0: 6964 656f 5f6f 6e65 5f70 6174 682c 2076  ideo_one_path, v
-0000dfe0: 6964 656f 5f74 776f 5f70 6174 682c 2076  ideo_two_path, v
-0000dff0: 6964 656f 5f6d 6574 615f 6461 7461 5b22  ideo_meta_data["
-0000e000: 7769 6474 6822 5d2c 2073 6176 655f 7061  width"], save_pa
-0000e010: 7468 0a20 2020 2020 2020 2020 2020 2029  th.            )
-0000e020: 0a0a 2020 2020 6966 2067 7075 3a0a 2020  ..    if gpu:.  
-0000e030: 2020 2020 2020 7072 6f63 6573 7320 3d20        process = 
-0000e040: 7375 6270 726f 6365 7373 2e50 6f70 656e  subprocess.Popen
-0000e050: 2863 6f6d 6d61 6e64 2c20 7368 656c 6c3d  (command, shell=
-0000e060: 5472 7565 290a 2020 2020 2020 2020 6f75  True).        ou
-0000e070: 7470 7574 2c20 6572 726f 7220 3d20 7072  tput, error = pr
-0000e080: 6f63 6573 732e 636f 6d6d 756e 6963 6174  ocess.communicat
-0000e090: 6528 290a 2020 2020 2020 2020 6966 2070  e().        if p
-0000e0a0: 726f 6365 7373 2e72 6574 7572 6e63 6f64  rocess.returncod
-0000e0b0: 6520 213d 2030 3a0a 2020 2020 2020 2020  e != 0:.        
-0000e0c0: 2020 2020 6966 2022 556e 6b6e 6f77 6e20      if "Unknown 
-0000e0d0: 6465 636f 6465 7222 2069 6e20 7374 7228  decoder" in str(
-0000e0e0: 6572 726f 722e 7370 6c69 7428 6222 5c6e  error.split(b"\n
-0000e0f0: 2229 5b2d 325d 293a 0a20 2020 2020 2020  ")[-2]):.       
-0000e100: 2020 2020 2020 2020 2072 6169 7365 2046           raise F
-0000e110: 464d 5045 4743 6f64 6563 4750 5545 7272  FMPEGCodecGPUErr
-0000e120: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-0000e130: 2020 2020 2020 2020 6d73 673d 2247 5055          msg="GPU
-0000e140: 2063 6f64 6563 206e 6f74 2066 6f75 6e64   codec not found
-0000e150: 3a20 7265 7665 7274 696e 6720 746f 2043  : reverting to C
-0000e160: 5055 2e20 5072 6f70 6572 6c79 2063 6f6e  PU. Properly con
-0000e170: 6669 6775 7265 2046 464d 7065 6720 616e  figure FFMpeg an
-0000e180: 6420 656e 7375 7265 2079 6f75 2068 6176  d ensure you hav
-0000e190: 6520 4750 5520 6176 6169 6c61 626c 6520  e GPU available 
-0000e1a0: 6f72 2075 7365 2043 5055 2e22 2c0a 2020  or use CPU.",.  
-0000e1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e1c0: 2020 736f 7572 6365 3d76 6964 656f 5f63    source=video_c
-0000e1d0: 6f6e 6361 7465 6e61 746f 722e 5f5f 6e61  oncatenator.__na
-0000e1e0: 6d65 5f5f 2c0a 2020 2020 2020 2020 2020  me__,.          
-0000e1f0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0000e200: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0000e210: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000e220: 4646 4d50 4547 436f 6465 6347 5055 4572  FFMPEGCodecGPUEr
-0000e230: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-0000e240: 2020 2020 2020 2020 206d 7367 3d22 4750           msg="GP
-0000e250: 5520 6572 726f 722e 2050 726f 7065 726c  U error. Properl
-0000e260: 7920 636f 6e66 6967 7572 6520 4646 4d70  y configure FFMp
-0000e270: 6567 2061 6e64 2065 6e73 7572 6520 796f  eg and ensure yo
-0000e280: 7520 6861 7665 2047 5055 2061 7661 696c  u have GPU avail
-0000e290: 6162 6c65 2c20 6f72 2075 7365 2043 5055  able, or use CPU
-0000e2a0: 2e22 2c0a 2020 2020 2020 2020 2020 2020  .",.            
-0000e2b0: 2020 2020 2020 2020 736f 7572 6365 3d76          source=v
-0000e2c0: 6964 656f 5f63 6f6e 6361 7465 6e61 746f  ideo_concatenato
-0000e2d0: 722e 5f5f 6e61 6d65 5f5f 2c0a 2020 2020  r.__name__,.    
-0000e2e0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0000e2f0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0000e300: 2020 2020 2020 2020 7061 7373 0a20 2020          pass.   
-0000e310: 2065 6c73 653a 0a20 2020 2020 2020 2073   else:.        s
-0000e320: 7562 7072 6f63 6573 732e 6361 6c6c 2863  ubprocess.call(c
-0000e330: 6f6d 6d61 6e64 2c20 7368 656c 6c3d 5472  ommand, shell=Tr
-0000e340: 7565 2c20 7374 646f 7574 3d73 7562 7072  ue, stdout=subpr
-0000e350: 6f63 6573 732e 5049 5045 290a 2020 2020  ocess.PIPE).    
-0000e360: 7469 6d65 722e 7374 6f70 5f74 696d 6572  timer.stop_timer
-0000e370: 2829 0a20 2020 2073 7464 6f75 745f 7375  ().    stdout_su
-0000e380: 6363 6573 7328 0a20 2020 2020 2020 206d  ccess(.        m
-0000e390: 7367 3d66 2256 6964 656f 7320 636f 6e63  sg=f"Videos conc
-0000e3a0: 6174 656e 6174 6564 2061 6e64 2073 6176  atenated and sav
-0000e3b0: 6564 2061 7420 7b73 6176 655f 7061 7468  ed at {save_path
-0000e3c0: 7d22 2c0a 2020 2020 2020 2020 656c 6170  }",.        elap
-0000e3d0: 7365 645f 7469 6d65 3d74 696d 6572 2e65  sed_time=timer.e
-0000e3e0: 6c61 7073 6564 5f74 696d 655f 7374 722c  lapsed_time_str,
-0000e3f0: 0a20 2020 2020 2020 2073 6f75 7263 653d  .        source=
-0000e400: 7669 6465 6f5f 636f 6e63 6174 656e 6174  video_concatenat
-0000e410: 6f72 2e5f 5f6e 616d 655f 5f2c 0a20 2020  or.__name__,.   
-0000e420: 2029 0a0a 0a23 2076 6964 656f 5f63 6f6e   )...# video_con
-0000e430: 6361 7465 6e61 746f 7228 7669 6465 6f5f  catenator(video_
-0000e440: 6f6e 655f 7061 7468 3d72 272f 5573 6572  one_path=r'/User
-0000e450: 732f 7369 6d6f 6e2f 4465 736b 746f 702f  s/simon/Desktop/
-0000e460: 656e 7673 2f74 726f 7562 6c65 7368 6f6f  envs/troubleshoo
-0000e470: 7469 6e67 2f74 776f 5f62 6c61 636b 5f61  ting/two_black_a
-0000e480: 6e69 6d61 6c73 5f31 3462 702f 7072 6f6a  nimals_14bp/proj
-0000e490: 6563 745f 666f 6c64 6572 2f76 6964 656f  ect_folder/video
-0000e4a0: 732f 546f 6765 7468 6572 5f31 2e61 7669  s/Together_1.avi
-0000e4b0: 272c 0a23 2020 2020 2020 2020 2020 2020  ',.#            
-0000e4c0: 2020 2020 2020 2020 7669 6465 6f5f 7477          video_tw
-0000e4d0: 6f5f 7061 7468 3d72 272f 5573 6572 732f  o_path=r'/Users/
-0000e4e0: 7369 6d6f 6e2f 4465 736b 746f 702f 656e  simon/Desktop/en
-0000e4f0: 7673 2f74 726f 7562 6c65 7368 6f6f 7469  vs/troubleshooti
-0000e500: 6e67 2f74 776f 5f62 6c61 636b 5f61 6e69  ng/two_black_ani
-0000e510: 6d61 6c73 5f31 3462 702f 7072 6f6a 6563  mals_14bp/projec
-0000e520: 745f 666f 6c64 6572 2f76 6964 656f 732f  t_folder/videos/
-0000e530: 546f 6765 7468 6572 5f32 2e61 7669 272c  Together_2.avi',
-0000e540: 2072 6573 6f6c 7574 696f 6e3d 2756 6964   resolution='Vid
-0000e550: 656f 5f31 272c 0a23 2020 2020 2020 2020  eo_1',.#        
-0000e560: 2020 2020 2020 2020 2020 2020 686f 7269              hori
-0000e570: 7a6f 6e74 616c 3d46 616c 7365 2c0a 2320  zontal=False,.# 
-0000e580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e590: 2020 2067 7075 3d46 616c 7365 290a 0a0a     gpu=False)...
-0000e5a0: 636c 6173 7320 5669 6465 6f52 6f74 6174  class VideoRotat
-0000e5b0: 6f72 2843 6f6e 6669 6752 6561 6465 7229  or(ConfigReader)
-0000e5c0: 3a0a 2020 2020 2222 220a 2020 2020 4755  :.    """.    GU
-0000e5d0: 4920 546f 6f6c 2066 6f72 2072 6f74 6174  I Tool for rotat
-0000e5e0: 696e 6720 7669 6465 6f2e 2052 6f74 6174  ing video. Rotat
-0000e5f0: 6564 2076 6964 656f 2069 7320 7361 7665  ed video is save
-0000e600: 6420 7769 7468 2074 6865 2060 605f 726f  d with the ``_ro
-0000e610: 7461 7465 645f 4441 5445 5449 4d45 2e6d  tated_DATETIME.m
-0000e620: 7034 6060 2073 7566 6669 782e 0a0a 2020  p4`` suffix...  
-0000e630: 2020 3a70 6172 616d 6574 6572 2073 7472    :parameter str
-0000e640: 2069 6e70 7574 5f70 6174 683a 2050 6174   input_path: Pat
-0000e650: 6820 746f 2076 6964 656f 2074 6f20 726f  h to video to ro
-0000e660: 7461 7465 2e0a 2020 2020 3a70 6172 616d  tate..    :param
-0000e670: 6574 6572 2073 7472 206f 7574 7075 745f  eter str output_
-0000e680: 6469 723a 2044 6972 6563 746f 7279 2077  dir: Directory w
-0000e690: 6865 7265 2074 6f20 7361 7665 2074 6865  here to save the
-0000e6a0: 2072 6f74 6174 6564 2076 6964 656f 2e0a   rotated video..
-0000e6b0: 2020 2020 3a70 6172 616d 6574 6572 204f      :parameter O
-0000e6c0: 7074 696f 6e61 6c5b 626f 6f6c 5d20 6770  ptional[bool] gp
-0000e6d0: 753a 2049 6620 5472 7565 2c20 7573 6520  u: If True, use 
-0000e6e0: 4646 4d50 4547 204e 5649 4445 4120 4750  FFMPEG NVIDEA GP
-0000e6f0: 5520 636f 6465 6373 2e20 456c 7365 2043  U codecs. Else C
-0000e700: 5055 2063 6f64 6563 732e 0a20 2020 203a  PU codecs..    :
-0000e710: 7061 7261 6d65 7465 7220 4f70 7469 6f6e  parameter Option
-0000e720: 616c 5b62 6f6f 6c5d 2067 7075 3a20 4966  al[bool] gpu: If
-0000e730: 2054 7275 652c 2075 7365 2046 4650 4d50   True, use FFPMP
-0000e740: 4547 2e20 456c 7365 2c20 4f70 656e 4356  EG. Else, OpenCV
-0000e750: 2e0a 0a20 2020 203a 6578 616d 706c 653a  ...    :example:
-0000e760: 0a20 2020 203e 3e3e 2056 6964 656f 526f  .    >>> VideoRo
-0000e770: 7461 746f 7228 696e 7075 745f 7061 7468  tator(input_path
-0000e780: 3d27 7072 6f6a 6563 745f 666f 6c64 6572  ='project_folder
-0000e790: 2f76 6964 656f 732f 5669 6465 6f5f 312e  /videos/Video_1.
-0000e7a0: 6d70 3427 2c20 6f75 7470 7574 5f64 6972  mp4', output_dir
-0000e7b0: 3d27 7072 6f6a 6563 745f 666f 6c64 6572  ='project_folder
-0000e7c0: 2f76 6964 656f 7327 290a 2020 2020 2222  /videos').    ""
-0000e7d0: 220a 0a20 2020 2064 6566 205f 5f69 6e69  "..    def __ini
-0000e7e0: 745f 5f28 0a20 2020 2020 2020 2073 656c  t__(.        sel
-0000e7f0: 662c 0a20 2020 2020 2020 2069 6e70 7574  f,.        input
-0000e800: 5f70 6174 683a 2055 6e69 6f6e 5b73 7472  _path: Union[str
-0000e810: 2c20 6f73 2e50 6174 684c 696b 655d 2c0a  , os.PathLike],.
-0000e820: 2020 2020 2020 2020 6f75 7470 7574 5f64          output_d
-0000e830: 6972 3a20 556e 696f 6e5b 7374 722c 206f  ir: Union[str, o
-0000e840: 732e 5061 7468 4c69 6b65 5d2c 0a20 2020  s.PathLike],.   
-0000e850: 2020 2020 2067 7075 3a20 4f70 7469 6f6e       gpu: Option
-0000e860: 616c 5b62 6f6f 6c5d 203d 2046 616c 7365  al[bool] = False
-0000e870: 2c0a 2020 2020 2020 2020 6666 6d70 6567  ,.        ffmpeg
-0000e880: 3a20 4f70 7469 6f6e 616c 5b62 6f6f 6c5d  : Optional[bool]
-0000e890: 203d 2046 616c 7365 2c0a 2020 2020 2920   = False,.    ) 
-0000e8a0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-0000e8b0: 2069 6620 6770 7520 616e 6420 6e6f 7420   if gpu and not 
-0000e8c0: 6368 6563 6b5f 6e76 6964 6561 5f67 7075  check_nvidea_gpu
-0000e8d0: 5f61 7661 696c 6162 6c65 2829 3a0a 2020  _available():.  
-0000e8e0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000e8f0: 4646 4d50 4547 436f 6465 6347 5055 4572  FFMPEGCodecGPUEr
-0000e900: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-0000e910: 2020 2020 206d 7367 3d22 4e6f 2047 5055       msg="No GPU
-0000e920: 2066 6f75 6e64 2028 6173 2065 7661 6c75   found (as evalu
-0000e930: 6174 6564 2062 7920 6e76 6964 6561 2d73  ated by nvidea-s
-0000e940: 6d69 2072 6574 7572 6e69 6e67 204e 6f6e  mi returning Non
-0000e950: 6529 222c 0a20 2020 2020 2020 2020 2020  e)",.           
-0000e960: 2020 2020 2073 6f75 7263 653d 7365 6c66       source=self
-0000e970: 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e 616d  .__class__.__nam
-0000e980: 655f 5f2c 0a20 2020 2020 2020 2020 2020  e__,.           
-0000e990: 2029 0a20 2020 2020 2020 2069 6620 6666   ).        if ff
-0000e9a0: 6d70 6567 2061 6e64 206e 6f74 2063 6865  mpeg and not che
-0000e9b0: 636b 5f66 666d 7065 675f 6176 6169 6c61  ck_ffmpeg_availa
-0000e9c0: 626c 6528 293a 0a20 2020 2020 2020 2020  ble():.         
-0000e9d0: 2020 2072 6169 7365 2046 464d 5045 474e     raise FFMPEGN
-0000e9e0: 6f74 466f 756e 6445 7272 6f72 280a 2020  otFoundError(.  
-0000e9f0: 2020 2020 2020 2020 2020 2020 2020 6d73                ms
-0000ea00: 673d 2746 464d 5045 4720 6e6f 7420 666f  g='FFMPEG not fo
-0000ea10: 756e 6420 6f6e 2074 6865 2063 6f6d 7075  und on the compu
-0000ea20: 7465 7220 2861 7320 6576 616c 7561 7465  ter (as evaluate
-0000ea30: 6420 6279 2022 6666 6d70 6567 2220 7265  d by "ffmpeg" re
-0000ea40: 7475 726e 696e 6720 4e6f 6e65 2927 2c0a  turning None)',.
-0000ea50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ea60: 736f 7572 6365 3d73 656c 662e 5f5f 636c  source=self.__cl
-0000ea70: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 2c0a  ass__.__name__,.
-0000ea80: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0000ea90: 2020 2020 2020 5f2c 2073 656c 662e 6370        _, self.cp
-0000eaa0: 755f 636e 7420 3d20 6669 6e64 5f63 6f72  u_cnt = find_cor
-0000eab0: 655f 636e 7428 290a 2020 2020 2020 2020  e_cnt().        
-0000eac0: 7365 6c66 2e67 7075 2c20 7365 6c66 2e66  self.gpu, self.f
-0000ead0: 666d 7065 6720 3d20 6770 752c 2066 666d  fmpeg = gpu, ffm
-0000eae0: 7065 670a 2020 2020 2020 2020 7365 6c66  peg.        self
-0000eaf0: 2e73 6176 655f 6469 7220 3d20 6f75 7470  .save_dir = outp
-0000eb00: 7574 5f64 6972 0a20 2020 2020 2020 2073  ut_dir.        s
-0000eb10: 656c 662e 6461 7465 7469 6d65 203d 2064  elf.datetime = d
-0000eb20: 6174 6574 696d 652e 6e6f 7728 292e 7374  atetime.now().st
-0000eb30: 7266 7469 6d65 2822 2559 256d 2564 2548  rftime("%Y%m%d%H
-0000eb40: 254d 2553 2229 0a20 2020 2020 2020 2069  %M%S").        i
-0000eb50: 6620 6f73 2e70 6174 682e 6973 6669 6c65  f os.path.isfile
-0000eb60: 2869 6e70 7574 5f70 6174 6829 3a0a 2020  (input_path):.  
-0000eb70: 2020 2020 2020 2020 2020 7365 6c66 2e76            self.v
-0000eb80: 6964 656f 5f70 6174 6873 203d 205b 696e  ideo_paths = [in
-0000eb90: 7075 745f 7061 7468 5d0a 2020 2020 2020  put_path].      
-0000eba0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0000ebb0: 2020 2020 7365 6c66 2e76 6964 656f 5f70      self.video_p
-0000ebc0: 6174 6873 203d 2066 696e 645f 616c 6c5f  aths = find_all_
-0000ebd0: 7669 6465 6f73 5f69 6e5f 6469 7265 6374  videos_in_direct
-0000ebe0: 6f72 7928 0a20 2020 2020 2020 2020 2020  ory(.           
-0000ebf0: 2020 2020 2064 6972 6563 746f 7279 3d69       directory=i
-0000ec00: 6e70 7574 5f70 6174 682c 2061 735f 6469  nput_path, as_di
-0000ec10: 6374 3d54 7275 650a 2020 2020 2020 2020  ct=True.        
-0000ec20: 2020 2020 292e 7661 6c75 6573 2829 0a20      ).values(). 
-0000ec30: 2020 2020 2020 2020 2020 2063 6865 636b             check
-0000ec40: 5f69 665f 6669 6c65 7061 7468 5f6c 6973  _if_filepath_lis
-0000ec50: 745f 6973 5f65 6d70 7479 280a 2020 2020  t_is_empty(.    
-0000ec60: 2020 2020 2020 2020 2020 2020 6669 6c65              file
-0000ec70: 7061 7468 733d 7365 6c66 2e76 6964 656f  paths=self.video
-0000ec80: 5f70 6174 6873 2c0a 2020 2020 2020 2020  _paths,.        
-0000ec90: 2020 2020 2020 2020 6572 726f 725f 6d73          error_ms
-0000eca0: 673d 6622 4e6f 2076 6964 656f 7320 666f  g=f"No videos fo
-0000ecb0: 756e 6420 696e 207b 696e 7075 745f 7061  und in {input_pa
-0000ecc0: 7468 7d20 6469 7265 6374 6f72 7922 2c0a  th} directory",.
-0000ecd0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-0000ece0: 2020 2064 6566 205f 5f69 6e73 6572 745f     def __insert_
-0000ecf0: 696d 6728 7365 6c66 2c20 696d 673a 206e  img(self, img: n
-0000ed00: 702e 6172 7261 7929 3a0a 2020 2020 2020  p.array):.      
-0000ed10: 2020 6375 7272 656e 745f 6672 6d5f 7069    current_frm_pi
-0000ed20: 6c20 3d20 496d 6167 652e 6672 6f6d 6172  l = Image.fromar
-0000ed30: 7261 7928 696d 6729 0a20 2020 2020 2020  ray(img).       
-0000ed40: 2063 7572 7265 6e74 5f66 726d 5f70 696c   current_frm_pil
-0000ed50: 2e74 6875 6d62 6e61 696c 284d 4158 5f46  .thumbnail(MAX_F
-0000ed60: 524d 5f53 495a 452c 2049 6d61 6765 2e41  RM_SIZE, Image.A
-0000ed70: 4e54 4941 4c49 4153 290a 2020 2020 2020  NTIALIAS).      
-0000ed80: 2020 6375 7272 656e 745f 6672 6d5f 7069    current_frm_pi
-0000ed90: 6c20 3d20 496d 6167 6554 6b2e 5068 6f74  l = ImageTk.Phot
-0000eda0: 6f49 6d61 6765 280a 2020 2020 2020 2020  oImage(.        
-0000edb0: 2020 2020 6d61 7374 6572 3d73 656c 662e      master=self.
-0000edc0: 6d61 696e 5f66 726d 2c20 696d 6167 653d  main_frm, image=
-0000edd0: 6375 7272 656e 745f 6672 6d5f 7069 6c0a  current_frm_pil.
-0000ede0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0000edf0: 2020 7365 6c66 2e76 6964 656f 5f66 7261    self.video_fra
-0000ee00: 6d65 203d 204c 6162 656c 2873 656c 662e  me = Label(self.
-0000ee10: 6d61 696e 5f66 726d 2c20 696d 6167 653d  main_frm, image=
-0000ee20: 6375 7272 656e 745f 6672 6d5f 7069 6c29  current_frm_pil)
-0000ee30: 0a20 2020 2020 2020 2073 656c 662e 7669  .        self.vi
-0000ee40: 6465 6f5f 6672 616d 652e 696d 6167 6520  deo_frame.image 
-0000ee50: 3d20 6375 7272 656e 745f 6672 6d5f 7069  = current_frm_pi
-0000ee60: 6c0a 2020 2020 2020 2020 7365 6c66 2e76  l.        self.v
-0000ee70: 6964 656f 5f66 7261 6d65 2e67 7269 6428  ideo_frame.grid(
-0000ee80: 726f 773d 302c 2063 6f6c 756d 6e3d 3029  row=0, column=0)
-0000ee90: 0a0a 2020 2020 6465 6620 5f5f 726f 7461  ..    def __rota
-0000eea0: 7465 2873 656c 662c 2076 616c 7565 3a20  te(self, value: 
-0000eeb0: 696e 742c 2069 6d67 3a20 6e70 2e61 7272  int, img: np.arr
-0000eec0: 6179 293a 0a20 2020 2020 2020 2073 656c  ay):.        sel
-0000eed0: 662e 6469 665f 616e 676c 6520 2b3d 2076  f.dif_angle += v
-0000eee0: 616c 7565 0a20 2020 2020 2020 2072 6f74  alue.        rot
-0000eef0: 6174 696f 6e5f 6d61 7472 6978 203d 2063  ation_matrix = c
-0000ef00: 7632 2e67 6574 526f 7461 7469 6f6e 4d61  v2.getRotationMa
-0000ef10: 7472 6978 3244 280a 2020 2020 2020 2020  trix2D(.        
-0000ef20: 2020 2020 2873 656c 662e 7669 6465 6f5f      (self.video_
-0000ef30: 6d65 7461 5f64 6174 615b 2277 6964 7468  meta_data["width
-0000ef40: 225d 202f 2032 2c20 7365 6c66 2e76 6964  "] / 2, self.vid
-0000ef50: 656f 5f6d 6574 615f 6461 7461 5b22 6865  eo_meta_data["he
-0000ef60: 6967 6874 225d 202f 2032 292c 0a20 2020  ight"] / 2),.   
-0000ef70: 2020 2020 2020 2020 2073 656c 662e 6469           self.di
-0000ef80: 665f 616e 676c 652c 0a20 2020 2020 2020  f_angle,.       
-0000ef90: 2020 2020 2031 2c0a 2020 2020 2020 2020       1,.        
-0000efa0: 290a 2020 2020 2020 2020 696d 6720 3d20  ).        img = 
-0000efb0: 6376 322e 7761 7270 4166 6669 6e65 280a  cv2.warpAffine(.
-0000efc0: 2020 2020 2020 2020 2020 2020 696d 672c              img,
-0000efd0: 0a20 2020 2020 2020 2020 2020 2072 6f74  .            rot
-0000efe0: 6174 696f 6e5f 6d61 7472 6978 2c0a 2020  ation_matrix,.  
-0000eff0: 2020 2020 2020 2020 2020 2873 656c 662e            (self.
-0000f000: 7669 6465 6f5f 6d65 7461 5f64 6174 615b  video_meta_data[
-0000f010: 2277 6964 7468 225d 2c20 7365 6c66 2e76  "width"], self.v
-0000f020: 6964 656f 5f6d 6574 615f 6461 7461 5b22  ideo_meta_data["
-0000f030: 6865 6967 6874 225d 292c 0a20 2020 2020  height"]),.     
-0000f040: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
-0000f050: 662e 5f5f 696e 7365 7274 5f69 6d67 2869  f.__insert_img(i
-0000f060: 6d67 3d69 6d67 290a 0a20 2020 2064 6566  mg=img)..    def
-0000f070: 205f 5f72 756e 5f72 6f74 6174 696f 6e28   __run_rotation(
-0000f080: 7365 6c66 293a 0a20 2020 2020 2020 2073  self):.        s
-0000f090: 656c 662e 6d61 696e 5f66 726d 2e64 6573  elf.main_frm.des
-0000f0a0: 7472 6f79 2829 0a20 2020 2020 2020 2073  troy().        s
-0000f0b0: 7461 7274 203d 2074 696d 652e 7469 6d65  tart = time.time
-0000f0c0: 2829 0a20 2020 2020 2020 2069 6620 7365  ().        if se
-0000f0d0: 6c66 2e66 666d 7065 6720 6f72 2073 656c  lf.ffmpeg or sel
-0000f0e0: 662e 6770 753a 0a20 2020 2020 2020 2020  f.gpu:.         
-0000f0f0: 2020 2066 6f72 2076 6964 656f 5f63 6e74     for video_cnt
-0000f100: 2c20 2876 6964 656f 5f70 6174 682c 2072  , (video_path, r
-0000f110: 6f74 6174 696f 6e29 2069 6e20 656e 756d  otation) in enum
-0000f120: 6572 6174 6528 7365 6c66 2e72 6573 756c  erate(self.resul
-0000f130: 7473 2e69 7465 6d73 2829 293a 0a20 2020  ts.items()):.   
-0000f140: 2020 2020 2020 2020 2020 2020 205f 2c20               _, 
-0000f150: 6e61 6d65 2c20 5f20 3d20 6765 745f 666e  name, _ = get_fn
-0000f160: 5f65 7874 2866 696c 6570 6174 683d 7669  _ext(filepath=vi
-0000f170: 6465 6f5f 7061 7468 290a 2020 2020 2020  deo_path).      
-0000f180: 2020 2020 2020 2020 2020 7361 7665 5f70            save_p
-0000f190: 6174 6820 3d20 6f73 2e70 6174 682e 6a6f  ath = os.path.jo
-0000f1a0: 696e 280a 2020 2020 2020 2020 2020 2020  in(.            
-0000f1b0: 2020 2020 2020 2020 7365 6c66 2e73 6176          self.sav
-0000f1c0: 655f 6469 722c 2066 227b 6e61 6d65 7d5f  e_dir, f"{name}_
-0000f1d0: 726f 7461 7465 645f 7b73 656c 662e 6461  rotated_{self.da
-0000f1e0: 7465 7469 6d65 7d2e 6d70 3422 0a20 2020  tetime}.mp4".   
-0000f1f0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-0000f200: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000f210: 6620 7365 6c66 2e67 7075 3a0a 2020 2020  f self.gpu:.    
-0000f220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f230: 636d 6420 3d20 6627 6666 6d70 6567 202d  cmd = f'ffmpeg -
-0000f240: 6877 6163 6365 6c20 6175 746f 202d 6920  hwaccel auto -i 
-0000f250: 7b76 6964 656f 5f70 6174 687d 202d 7666  {video_path} -vf
-0000f260: 2022 6877 7570 6c6f 6164 5f63 7564 612c   "hwupload_cuda,
-0000f270: 726f 7461 7465 3d7b 726f 7461 7469 6f6e  rotate={rotation
-0000f280: 7d2a 2850 492f 3138 3029 2c66 6f72 6d61  }*(PI/180),forma
-0000f290: 743d 6e76 3132 7c63 7564 6122 202d 633a  t=nv12|cuda" -c:
-0000f2a0: 7620 6832 3634 5f6e 7665 6e63 207b 7361  v h264_nvenc {sa
-0000f2b0: 7665 5f70 6174 687d 202d 7927 0a20 2020  ve_path} -y'.   
-0000f2c0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-0000f2d0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0000f2e0: 2020 2020 2020 2063 6d64 203d 2066 2766         cmd = f'f
-0000f2f0: 666d 7065 6720 2d69 207b 7669 6465 6f5f  fmpeg -i {video_
-0000f300: 7061 7468 7d20 2d76 6620 2272 6f74 6174  path} -vf "rotat
-0000f310: 653d 7b72 6f74 6174 696f 6e7d 2a28 5049  e={rotation}*(PI
-0000f320: 2f31 3830 2922 207b 7361 7665 5f70 6174  /180)" {save_pat
-0000f330: 687d 202d 7927 0a20 2020 2020 2020 2020  h} -y'.         
-0000f340: 2020 2020 2020 2073 7562 7072 6f63 6573         subproces
-0000f350: 732e 6361 6c6c 2863 6d64 2c20 7368 656c  s.call(cmd, shel
-0000f360: 6c3d 5472 7565 2c20 7374 646f 7574 3d73  l=True, stdout=s
-0000f370: 7562 7072 6f63 6573 732e 5049 5045 290a  ubprocess.PIPE).
-0000f380: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0000f390: 2020 2020 2020 2020 2020 666f 7220 7669            for vi
-0000f3a0: 6465 6f5f 636e 742c 2028 7669 6465 6f5f  deo_cnt, (video_
-0000f3b0: 7061 7468 2c20 726f 7461 7469 6f6e 2920  path, rotation) 
-0000f3c0: 696e 2065 6e75 6d65 7261 7465 2873 656c  in enumerate(sel
-0000f3d0: 662e 7265 7375 6c74 732e 6974 656d 7328  f.results.items(
-0000f3e0: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
-0000f3f0: 2020 2020 6361 7020 3d20 6376 322e 5669      cap = cv2.Vi
-0000f400: 6465 6f43 6170 7475 7265 2876 6964 656f  deoCapture(video
-0000f410: 5f70 6174 6829 0a20 2020 2020 2020 2020  _path).         
-0000f420: 2020 2020 2020 205f 2c20 6e61 6d65 2c20         _, name, 
-0000f430: 5f20 3d20 6765 745f 666e 5f65 7874 2866  _ = get_fn_ext(f
-0000f440: 696c 6570 6174 683d 7669 6465 6f5f 7061  ilepath=video_pa
-0000f450: 7468 290a 2020 2020 2020 2020 2020 2020  th).            
-0000f460: 2020 2020 726f 7461 7469 6f6e 5f6d 6174      rotation_mat
-0000f470: 7269 7820 3d20 6376 322e 6765 7452 6f74  rix = cv2.getRot
-0000f480: 6174 696f 6e4d 6174 7269 7832 4428 0a20  ationMatrix2D(. 
-0000f490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f4a0: 2020 2028 0a20 2020 2020 2020 2020 2020     (.           
-0000f4b0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000f4c0: 662e 7669 6465 6f5f 6d65 7461 5f64 6174  f.video_meta_dat
-0000f4d0: 615b 2277 6964 7468 225d 202f 2032 2c0a  a["width"] / 2,.
-0000f4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f4f0: 2020 2020 2020 2020 7365 6c66 2e76 6964          self.vid
-0000f500: 656f 5f6d 6574 615f 6461 7461 5b22 6865  eo_meta_data["he
-0000f510: 6967 6874 225d 202f 2032 2c0a 2020 2020  ight"] / 2,.    
-0000f520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f530: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-0000f540: 2020 2020 2020 2072 6f74 6174 696f 6e2c         rotation,
-0000f550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f560: 2020 2020 2031 2c0a 2020 2020 2020 2020       1,.        
-0000f570: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0000f580: 2020 2020 2020 2020 2020 7361 7665 5f70            save_p
-0000f590: 6174 6820 3d20 6f73 2e70 6174 682e 6a6f  ath = os.path.jo
-0000f5a0: 696e 280a 2020 2020 2020 2020 2020 2020  in(.            
-0000f5b0: 2020 2020 2020 2020 7365 6c66 2e73 6176          self.sav
-0000f5c0: 655f 6469 722c 2066 227b 6e61 6d65 7d5f  e_dir, f"{name}_
-0000f5d0: 726f 7461 7465 645f 7b73 656c 662e 6461  rotated_{self.da
-0000f5e0: 7465 7469 6d65 7d2e 6d70 3422 0a20 2020  tetime}.mp4".   
-0000f5f0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-0000f600: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-0000f610: 6964 656f 5f6d 6574 6120 3d20 6765 745f  ideo_meta = get_
-0000f620: 7669 6465 6f5f 6d65 7461 5f64 6174 6128  video_meta_data(
-0000f630: 7669 6465 6f5f 7061 7468 3d76 6964 656f  video_path=video
-0000f640: 5f70 6174 6829 0a20 2020 2020 2020 2020  _path).         
-0000f650: 2020 2020 2020 2066 6f75 7263 6320 3d20         fourcc = 
-0000f660: 6376 322e 5669 6465 6f57 7269 7465 725f  cv2.VideoWriter_
-0000f670: 666f 7572 6363 282a 466f 726d 6174 732e  fourcc(*Formats.
-0000f680: 4d50 345f 434f 4445 432e 7661 6c75 6529  MP4_CODEC.value)
-0000f690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f6a0: 2077 7269 7465 7220 3d20 6376 322e 5669   writer = cv2.Vi
-0000f6b0: 6465 6f57 7269 7465 7228 0a20 2020 2020  deoWriter(.     
-0000f6c0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0000f6d0: 6176 655f 7061 7468 2c0a 2020 2020 2020  ave_path,.      
-0000f6e0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-0000f6f0: 7572 6363 2c0a 2020 2020 2020 2020 2020  urcc,.          
-0000f700: 2020 2020 2020 2020 2020 7669 6465 6f5f            video_
-0000f710: 6d65 7461 5b22 6670 7322 5d2c 0a20 2020  meta["fps"],.   
-0000f720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f730: 2028 7669 6465 6f5f 6d65 7461 5b22 7769   (video_meta["wi
-0000f740: 6474 6822 5d2c 2076 6964 656f 5f6d 6574  dth"], video_met
-0000f750: 615b 2268 6569 6768 7422 5d29 2c0a 2020  a["height"]),.  
-0000f760: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0000f770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f780: 696d 675f 636e 7420 3d20 300a 2020 2020  img_cnt = 0.    
-0000f790: 2020 2020 2020 2020 2020 2020 7768 696c              whil
-0000f7a0: 6520 5472 7565 3a0a 2020 2020 2020 2020  e True:.        
-0000f7b0: 2020 2020 2020 2020 2020 2020 7265 742c              ret,
-0000f7c0: 2069 6d67 203d 2063 6170 2e72 6561 6428   img = cap.read(
-0000f7d0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0000f7e0: 2020 2020 2020 6966 206e 6f74 2072 6574        if not ret
-0000f7f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000f800: 2020 2020 2020 2020 2020 6272 6561 6b0a            break.
-0000f810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f820: 2020 2020 696d 6720 3d20 6376 322e 7761      img = cv2.wa
-0000f830: 7270 4166 6669 6e65 280a 2020 2020 2020  rpAffine(.      
-0000f840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f850: 2020 696d 672c 0a20 2020 2020 2020 2020    img,.         
-0000f860: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000f870: 6f74 6174 696f 6e5f 6d61 7472 6978 2c0a  otation_matrix,.
-0000f880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f890: 2020 2020 2020 2020 2873 656c 662e 7669          (self.vi
-0000f8a0: 6465 6f5f 6d65 7461 5f64 6174 615b 2277  deo_meta_data["w
-0000f8b0: 6964 7468 225d 2c20 7365 6c66 2e76 6964  idth"], self.vid
-0000f8c0: 656f 5f6d 6574 615f 6461 7461 5b22 6865  eo_meta_data["he
-0000f8d0: 6967 6874 225d 292c 0a20 2020 2020 2020  ight"]),.       
-0000f8e0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-0000f8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f900: 2020 2077 7269 7465 722e 7772 6974 6528     writer.write(
-0000f910: 696d 6729 0a20 2020 2020 2020 2020 2020  img).           
-0000f920: 2020 2020 2020 2020 2069 6d67 5f63 6e74           img_cnt
-0000f930: 202b 3d20 310a 2020 2020 2020 2020 2020   += 1.          
-0000f940: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0000f950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f960: 2020 2020 2020 2020 2066 2752 6f74 6174           f'Rotat
-0000f970: 696e 6720 6672 616d 6520 7b69 6d67 5f63  ing frame {img_c
-0000f980: 6e74 7d2f 7b76 6964 656f 5f6d 6574 615b  nt}/{video_meta[
-0000f990: 2266 7261 6d65 5f63 6f75 6e74 225d 7d20  "frame_count"]} 
-0000f9a0: 2856 6964 656f 207b 7669 6465 6f5f 636e  (Video {video_cn
-0000f9b0: 7420 2b20 317d 2f7b 6c65 6e28 7365 6c66  t + 1}/{len(self
-0000f9c0: 2e72 6573 756c 7473 2e6b 6579 7328 2929  .results.keys())
-0000f9d0: 7d29 2027 0a20 2020 2020 2020 2020 2020  }) '.           
-0000f9e0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0000f9f0: 2020 2020 2020 2020 2020 2063 6170 2e72             cap.r
-0000fa00: 656c 6561 7365 2829 0a20 2020 2020 2020  elease().       
-0000fa10: 2020 2020 2020 2020 2077 7269 7465 722e           writer.
-0000fa20: 7265 6c65 6173 6528 290a 2020 2020 2020  release().      
-0000fa30: 2020 7374 646f 7574 5f73 7563 6365 7373    stdout_success
-0000fa40: 280a 2020 2020 2020 2020 2020 2020 6d73  (.            ms
-0000fa50: 673d 6622 416c 6c20 7669 6465 6f73 2072  g=f"All videos r
-0000fa60: 6f74 6174 6564 2061 6e64 2073 6176 6564  otated and saved
-0000fa70: 2069 6e20 7b73 656c 662e 7361 7665 5f64   in {self.save_d
-0000fa80: 6972 7d22 2c0a 2020 2020 2020 2020 2020  ir}",.          
-0000fa90: 2020 656c 6170 7365 645f 7469 6d65 3d73    elapsed_time=s
-0000faa0: 7472 2872 6f75 6e64 2828 7469 6d65 2e74  tr(round((time.t
-0000fab0: 696d 6528 2920 2d20 7374 6172 7429 2c20  ime() - start), 
-0000fac0: 3229 292c 0a20 2020 2020 2020 2020 2020  2)),.           
-0000fad0: 2073 6f75 7263 653d 7365 6c66 2e5f 5f63   source=self.__c
-0000fae0: 6c61 7373 5f5f 2e5f 5f6e 616d 655f 5f2c  lass__.__name__,
-0000faf0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-0000fb00: 6465 6620 5f5f 7361 7665 2873 656c 6629  def __save(self)
-0000fb10: 3a0a 2020 2020 2020 2020 7072 6f63 6573  :.        proces
-0000fb20: 7320 3d20 4e6f 6e65 0a20 2020 2020 2020  s = None.       
-0000fb30: 2073 656c 662e 7265 7375 6c74 735b 7365   self.results[se
-0000fb40: 6c66 2e66 696c 655f 7061 7468 5d20 3d20  lf.file_path] = 
-0000fb50: 7365 6c66 2e64 6966 5f61 6e67 6c65 0a20  self.dif_angle. 
-0000fb60: 2020 2020 2020 2069 6620 6c65 6e28 7365         if len(se
-0000fb70: 6c66 2e72 6573 756c 7473 2e6b 6579 7328  lf.results.keys(
-0000fb80: 2929 203d 3d20 6c65 6e28 7365 6c66 2e76  )) == len(self.v
-0000fb90: 6964 656f 5f70 6174 6873 293a 0a20 2020  ideo_paths):.   
-0000fba0: 2020 2020 2020 2020 2070 726f 6365 7373           process
-0000fbb0: 203d 206d 756c 7469 7072 6f63 6573 7369   = multiprocessi
-0000fbc0: 6e67 2e50 726f 6365 7373 2874 6172 6765  ng.Process(targe
-0000fbd0: 743d 7365 6c66 2e5f 5f72 756e 5f72 6f74  t=self.__run_rot
-0000fbe0: 6174 696f 6e28 2929 0a20 2020 2020 2020  ation()).       
-0000fbf0: 2020 2020 2070 726f 6365 7373 2e73 7461       process.sta
-0000fc00: 7274 2829 0a20 2020 2020 2020 2065 6c73  rt().        els
-0000fc10: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-0000fc20: 656c 662e 5f5f 7275 6e5f 696e 7465 7266  elf.__run_interf
-0000fc30: 6163 6528 0a20 2020 2020 2020 2020 2020  ace(.           
-0000fc40: 2020 2020 2066 696c 655f 7061 7468 3d73       file_path=s
-0000fc50: 656c 662e 7669 6465 6f5f 7061 7468 735b  elf.video_paths[
-0000fc60: 6c65 6e28 7365 6c66 2e72 6573 756c 7473  len(self.results
-0000fc70: 2e6b 6579 7328 2929 202d 2031 5d0a 2020  .keys()) - 1].  
-0000fc80: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0000fc90: 2020 2020 6966 2070 726f 6365 7373 2069      if process i
-0000fca0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-0000fcb0: 2020 2020 2020 2020 7072 6f63 6573 732e          process.
-0000fcc0: 6a6f 696e 2829 0a0a 2020 2020 6465 6620  join()..    def 
-0000fcd0: 5f5f 6269 6e64 5f6b 6579 7328 7365 6c66  __bind_keys(self
-0000fce0: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
-0000fcf0: 6d61 696e 5f66 726d 2e62 696e 6428 0a20  main_frm.bind(. 
-0000fd00: 2020 2020 2020 2020 2020 2022 3c4c 6566             "<Lef
-0000fd10: 743e 222c 206c 616d 6264 6120 783a 2073  t>", lambda x: s
-0000fd20: 656c 662e 5f5f 726f 7461 7465 2876 616c  elf.__rotate(val
-0000fd30: 7565 3d31 2c20 696d 673d 7365 6c66 2e5f  ue=1, img=self._
-0000fd40: 6f72 6967 5f69 6d67 290a 2020 2020 2020  orig_img).      
-0000fd50: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-0000fd60: 2e6d 6169 6e5f 6672 6d2e 6269 6e64 280a  .main_frm.bind(.
-0000fd70: 2020 2020 2020 2020 2020 2020 223c 5269              "<Ri
-0000fd80: 6768 743e 222c 206c 616d 6264 6120 783a  ght>", lambda x:
-0000fd90: 2073 656c 662e 5f5f 726f 7461 7465 2876   self.__rotate(v
-0000fda0: 616c 7565 3d2d 312c 2069 6d67 3d73 656c  alue=-1, img=sel
-0000fdb0: 662e 5f6f 7269 675f 696d 6729 0a20 2020  f._orig_img).   
-0000fdc0: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-0000fdd0: 656c 662e 6d61 696e 5f66 726d 2e62 696e  elf.main_frm.bin
-0000fde0: 6428 223c 4573 6361 7065 3e22 2c20 6c61  d("<Escape>", la
-0000fdf0: 6d62 6461 2078 3a20 7365 6c66 2e5f 5f73  mbda x: self.__s
-0000fe00: 6176 6528 2929 0a0a 2020 2020 6465 6620  ave())..    def 
-0000fe10: 5f5f 7275 6e5f 696e 7465 7266 6163 6528  __run_interface(
-0000fe20: 7365 6c66 2c20 6669 6c65 5f70 6174 683a  self, file_path:
-0000fe30: 2073 7472 293a 0a20 2020 2020 2020 2073   str):.        s
-0000fe40: 656c 662e 6469 665f 616e 676c 6520 3d20  elf.dif_angle = 
-0000fe50: 300a 2020 2020 2020 2020 7072 696e 7428  0.        print(
-0000fe60: 6669 6c65 5f70 6174 6829 0a20 2020 2020  file_path).     
-0000fe70: 2020 2073 656c 662e 7669 6465 6f5f 6d65     self.video_me
-0000fe80: 7461 5f64 6174 6120 3d20 6765 745f 7669  ta_data = get_vi
-0000fe90: 6465 6f5f 6d65 7461 5f64 6174 6128 7669  deo_meta_data(vi
-0000fea0: 6465 6f5f 7061 7468 3d66 696c 655f 7061  deo_path=file_pa
-0000feb0: 7468 290a 2020 2020 2020 2020 7365 6c66  th).        self
-0000fec0: 2e66 696c 655f 7061 7468 203d 2066 696c  .file_path = fil
-0000fed0: 655f 7061 7468 0a20 2020 2020 2020 205f  e_path.        _
-0000fee0: 2c20 7365 6c66 2e76 6964 656f 5f6e 616d  , self.video_nam
-0000fef0: 652c 205f 203d 2067 6574 5f66 6e5f 6578  e, _ = get_fn_ex
-0000ff00: 7428 6669 6c65 7061 7468 3d66 696c 655f  t(filepath=file_
-0000ff10: 7061 7468 290a 2020 2020 2020 2020 7365  path).        se
-0000ff20: 6c66 2e6d 6169 6e5f 6672 6d20 3d20 546f  lf.main_frm = To
-0000ff30: 706c 6576 656c 2829 0a20 2020 2020 2020  plevel().       
-0000ff40: 2073 656c 662e 6d61 696e 5f66 726d 2e74   self.main_frm.t
-0000ff50: 6974 6c65 2866 2252 4f54 4154 4520 5649  itle(f"ROTATE VI
-0000ff60: 4445 4f20 7b73 656c 662e 7669 6465 6f5f  DEO {self.video_
-0000ff70: 6e61 6d65 7d22 290a 2020 2020 2020 2020  name}").        
-0000ff80: 7365 6c66 2e76 6964 656f 5f66 726d 203d  self.video_frm =
-0000ff90: 2046 7261 6d65 2873 656c 662e 6d61 696e   Frame(self.main
-0000ffa0: 5f66 726d 290a 2020 2020 2020 2020 7365  _frm).        se
-0000ffb0: 6c66 2e76 6964 656f 5f66 726d 2e67 7269  lf.video_frm.gri
-0000ffc0: 6428 726f 773d 302c 2063 6f6c 756d 6e3d  d(row=0, column=
-0000ffd0: 3029 0a20 2020 2020 2020 2073 656c 662e  0).        self.
-0000ffe0: 696e 7374 7275 6374 696f 6e5f 6672 6d20  instruction_frm 
-0000fff0: 3d20 4672 616d 6528 7365 6c66 2e6d 6169  = Frame(self.mai
-00010000: 6e5f 6672 6d2c 2077 6964 7468 3d31 3030  n_frm, width=100
-00010010: 2c20 6865 6967 6874 3d31 3030 290a 2020  , height=100).  
-00010020: 2020 2020 2020 7365 6c66 2e69 6e73 7472        self.instr
-00010030: 7563 7469 6f6e 5f66 726d 2e67 7269 6428  uction_frm.grid(
-00010040: 726f 773d 302c 2063 6f6c 756d 6e3d 322c  row=0, column=2,
-00010050: 2073 7469 636b 793d 4e57 290a 2020 2020   sticky=NW).    
-00010060: 2020 2020 7365 6c66 2e6b 6579 5f6c 626c      self.key_lbl
-00010070: 7320 3d20 4c61 6265 6c28 0a20 2020 2020  s = Label(.     
-00010080: 2020 2020 2020 2073 656c 662e 696e 7374         self.inst
-00010090: 7275 6374 696f 6e5f 6672 6d2c 0a20 2020  ruction_frm,.   
-000100a0: 2020 2020 2020 2020 2074 6578 743d 225c           text="\
-000100b0: 6e5c 6e20 4e61 7669 6761 7469 6f6e 3a20  n\n Navigation: 
-000100c0: 220a 2020 2020 2020 2020 2020 2020 225c  ".            "\
-000100d0: 6e20 4c65 6674 2061 7272 6f77 203d 2031  n Left arrow = 1
-000100e0: c2b0 206c 6566 7422 0a20 2020 2020 2020  .. left".       
-000100f0: 2020 2020 2022 5c6e 2052 6967 6874 2061       "\n Right a
-00010100: 7272 6f77 203d 2031 c2b0 2072 6967 6874  rrow = 1.. right
-00010110: 220a 2020 2020 2020 2020 2020 2020 225c  ".            "\
-00010120: 6e20 4573 6320 3d20 5361 7665 222c 0a20  n Esc = Save",. 
-00010130: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00010140: 2020 7365 6c66 2e6b 6579 5f6c 626c 732e    self.key_lbls.
-00010150: 6772 6964 2873 7469 636b 793d 4e57 290a  grid(sticky=NW).
-00010160: 2020 2020 2020 2020 7365 6c66 2e63 6170          self.cap
-00010170: 203d 2063 7632 2e56 6964 656f 4361 7074   = cv2.VideoCapt
-00010180: 7572 6528 6669 6c65 5f70 6174 6829 0a20  ure(file_path). 
-00010190: 2020 2020 2020 205f 2c20 7365 6c66 2e69         _, self.i
-000101a0: 6d67 203d 2073 656c 662e 6361 702e 7265  mg = self.cap.re
-000101b0: 6164 2829 0a20 2020 2020 2020 2073 656c  ad().        sel
-000101c0: 662e 5f6f 7269 675f 696d 6720 3d20 6376  f._orig_img = cv
-000101d0: 322e 6376 7443 6f6c 6f72 2873 656c 662e  2.cvtColor(self.
-000101e0: 696d 672c 2063 7632 2e43 4f4c 4f52 5f52  img, cv2.COLOR_R
-000101f0: 4742 3242 4752 290a 2020 2020 2020 2020  GB2BGR).        
-00010200: 7365 6c66 2e5f 5f69 6e73 6572 745f 696d  self.__insert_im
-00010210: 6728 696d 673d 7365 6c66 2e5f 6f72 6967  g(img=self._orig
-00010220: 5f69 6d67 290a 2020 2020 2020 2020 7365  _img).        se
-00010230: 6c66 2e5f 5f62 696e 645f 6b65 7973 2829  lf.__bind_keys()
-00010240: 0a0a 2020 2020 6465 6620 7275 6e28 7365  ..    def run(se
-00010250: 6c66 293a 0a20 2020 2020 2020 2073 656c  lf):.        sel
-00010260: 662e 7265 7375 6c74 7320 3d20 7b7d 0a20  f.results = {}. 
-00010270: 2020 2020 2020 2066 6f72 2076 6964 656f         for video
-00010280: 5f70 6174 6820 696e 2073 656c 662e 7669  _path in self.vi
-00010290: 6465 6f5f 7061 7468 733a 0a20 2020 2020  deo_paths:.     
-000102a0: 2020 2020 2020 2073 656c 662e 5f5f 7275         self.__ru
-000102b0: 6e5f 696e 7465 7266 6163 6528 7669 6465  n_interface(vide
-000102c0: 6f5f 7061 7468 290a 2020 2020 2020 2020  o_path).        
-000102d0: 7365 6c66 2e6d 6169 6e5f 6672 6d2e 6d61  self.main_frm.ma
-000102e0: 696e 6c6f 6f70 2829 0a0a 0a64 6566 2065  inloop()...def e
-000102f0: 7874 7261 6374 5f66 7261 6d65 735f 6672  xtract_frames_fr
-00010300: 6f6d 5f61 6c6c 5f76 6964 656f 735f 696e  om_all_videos_in
-00010310: 5f64 6972 6563 746f 7279 280a 2020 2020  _directory(.    
-00010320: 636f 6e66 6967 5f70 6174 683a 2055 6e69  config_path: Uni
-00010330: 6f6e 5b73 7472 2c20 6f73 2e50 6174 684c  on[str, os.PathL
-00010340: 696b 655d 2c20 6469 7265 6374 6f72 793a  ike], directory:
-00010350: 2055 6e69 6f6e 5b73 7472 2c20 6f73 2e50   Union[str, os.P
-00010360: 6174 684c 696b 655d 0a29 202d 3e20 4e6f  athLike].) -> No
-00010370: 6e65 3a0a 2020 2020 2222 220a 2020 2020  ne:.    """.    
-00010380: 4578 7472 6163 7420 616c 6c20 6672 616d  Extract all fram
-00010390: 6573 2066 726f 6d20 616c 6c20 7669 6465  es from all vide
-000103a0: 6f73 2069 6e20 6120 6469 7265 6374 6f72  os in a director
-000103b0: 792e 2054 6865 2072 6573 756c 7473 2061  y. The results a
-000103c0: 7265 2073 6176 6564 2069 6e20 7468 6520  re saved in the 
-000103d0: 7072 6f6a 6563 745f 666f 6c64 6572 2f66  project_folder/f
-000103e0: 7261 6d65 732f 696e 7075 7420 6469 7265  rames/input dire
-000103f0: 6374 6f72 7920 6f66 2074 6865 2053 696d  ctory of the Sim
-00010400: 4241 2070 726f 6a65 6374 0a0a 2020 2020  BA project..    
-00010410: 3a70 6172 616d 6574 6572 2073 7472 2063  :parameter str c
-00010420: 6f6e 6669 675f 7061 7468 3a20 7061 7468  onfig_path: path
-00010430: 2074 6f20 5369 6d42 4120 7072 6f6a 6563   to SimBA projec
-00010440: 7420 636f 6e66 6967 2066 696c 6520 696e  t config file in
-00010450: 2043 6f6e 6669 6770 6172 7365 7220 666f   Configparser fo
-00010460: 726d 6174 2e0a 2020 2020 3a70 6172 616d  rmat..    :param
-00010470: 6574 6572 2073 7472 2064 6972 6563 746f  eter str directo
-00010480: 7279 3a20 7061 7468 2074 6f20 6669 6c65  ry: path to file
-00010490: 206f 7220 666f 6c64 6572 2063 6f6e 7461   or folder conta
-000104a0: 696e 696e 6720 7669 6465 6f73 2069 6e20  ining videos in 
-000104b0: 6d70 3420 616e 642f 6f72 2061 7669 2066  mp4 and/or avi f
-000104c0: 6f72 6d61 742e 0a0a 2020 2020 3a65 7861  ormat...    :exa
-000104d0: 6d70 6c65 3a0a 2020 2020 3e3e 3e20 6578  mple:.    >>> ex
-000104e0: 7472 6163 745f 6672 616d 6573 5f66 726f  tract_frames_fro
-000104f0: 6d5f 616c 6c5f 7669 6465 6f73 5f69 6e5f  m_all_videos_in_
-00010500: 6469 7265 6374 6f72 7928 636f 6e66 6967  directory(config
-00010510: 5f70 6174 683d 2770 726f 6a65 6374 5f66  _path='project_f
-00010520: 6f6c 6465 722f 7072 6f6a 6563 745f 636f  older/project_co
-00010530: 6e66 6967 2e69 6e69 272c 2073 6f75 7263  nfig.ini', sourc
-00010540: 653d 272f 7465 7374 732f 7465 7374 5f64  e='/tests/test_d
-00010550: 6174 612f 7669 6465 6f5f 7465 7374 7327  ata/video_tests'
-00010560: 290a 2020 2020 2222 220a 0a20 2020 2074  ).    """..    t
-00010570: 696d 6572 203d 2053 696d 6261 5469 6d65  imer = SimbaTime
-00010580: 7228 7374 6172 743d 5472 7565 290a 2020  r(start=True).  
-00010590: 2020 7669 6465 6f5f 7061 7468 732c 2076    video_paths, v
-000105a0: 6964 656f 5f74 7970 6573 203d 205b 5d2c  ideo_types = [],
-000105b0: 205b 222e 6176 6922 2c20 222e 6d70 3422   [".avi", ".mp4"
-000105c0: 5d0a 2020 2020 6669 6c65 735f 696e 5f66  ].    files_in_f
-000105d0: 6f6c 6465 7220 3d20 676c 6f62 2e67 6c6f  older = glob.glo
-000105e0: 6228 6469 7265 6374 6f72 7920 2b20 222f  b(directory + "/
-000105f0: 2a22 290a 2020 2020 666f 7220 6669 6c65  *").    for file
-00010600: 5f70 6174 6820 696e 2066 696c 6573 5f69  _path in files_i
-00010610: 6e5f 666f 6c64 6572 3a0a 2020 2020 2020  n_folder:.      
-00010620: 2020 5f2c 205f 2c20 6578 7420 3d20 6765    _, _, ext = ge
-00010630: 745f 666e 5f65 7874 2866 696c 6570 6174  t_fn_ext(filepat
-00010640: 683d 6669 6c65 5f70 6174 6829 0a20 2020  h=file_path).   
-00010650: 2020 2020 2069 6620 6578 742e 6c6f 7765       if ext.lowe
-00010660: 7228 2920 696e 2076 6964 656f 5f74 7970  r() in video_typ
-00010670: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-00010680: 7669 6465 6f5f 7061 7468 732e 6170 7065  video_paths.appe
-00010690: 6e64 2866 696c 655f 7061 7468 290a 2020  nd(file_path).  
-000106a0: 2020 6966 206c 656e 2876 6964 656f 5f70    if len(video_p
-000106b0: 6174 6873 2920 3d3d 2030 3a0a 2020 2020  aths) == 0:.    
-000106c0: 2020 2020 7261 6973 6520 4e6f 4669 6c65      raise NoFile
-000106d0: 7346 6f75 6e64 4572 726f 7228 0a20 2020  sFoundError(.   
-000106e0: 2020 2020 2020 2020 206d 7367 3d22 5349           msg="SI
-000106f0: 4d42 4120 4552 524f 523a 2030 2076 6964  MBA ERROR: 0 vid
-00010700: 656f 2066 696c 6573 2069 6e20 6d70 3420  eo files in mp4 
-00010710: 6f72 2061 7669 2066 6f72 6d61 7420 666f  or avi format fo
-00010720: 756e 6420 696e 207b 7d22 2e66 6f72 6d61  und in {}".forma
-00010730: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00010740: 2020 2064 6972 6563 746f 7279 0a20 2020     directory.   
-00010750: 2020 2020 2020 2020 2029 2c0a 2020 2020           ),.    
-00010760: 2020 2020 2020 2020 736f 7572 6365 3d65          source=e
-00010770: 7874 7261 6374 5f66 7261 6d65 735f 6672  xtract_frames_fr
-00010780: 6f6d 5f61 6c6c 5f76 6964 656f 735f 696e  om_all_videos_in
-00010790: 5f64 6972 6563 746f 7279 2e5f 5f6e 616d  _directory.__nam
-000107a0: 655f 5f2c 0a20 2020 2020 2020 2029 0a20  e__,.        ). 
-000107b0: 2020 2063 6f6e 6669 6720 3d20 7265 6164     config = read
-000107c0: 5f63 6f6e 6669 675f 6669 6c65 2863 6f6e  _config_file(con
-000107d0: 6669 675f 7061 7468 290a 2020 2020 7072  fig_path).    pr
-000107e0: 6f6a 6563 745f 7061 7468 203d 2072 6561  oject_path = rea
-000107f0: 645f 636f 6e66 6967 5f65 6e74 7279 280a  d_config_entry(.
-00010800: 2020 2020 2020 2020 636f 6e66 6967 2c20          config, 
-00010810: 2247 656e 6572 616c 2073 6574 7469 6e67  "General setting
-00010820: 7322 2c20 2270 726f 6a65 6374 5f70 6174  s", "project_pat
-00010830: 6822 2c20 6461 7461 5f74 7970 653d 2266  h", data_type="f
-00010840: 6f6c 6465 725f 7061 7468 220a 2020 2020  older_path".    
-00010850: 290a 0a20 2020 2070 7269 6e74 280a 2020  )..    print(.  
-00010860: 2020 2020 2020 2245 7874 7261 6374 696e        "Extractin
-00010870: 6720 6672 616d 6573 2066 6f72 207b 7d20  g frames for {} 
-00010880: 7669 6465 6f73 2069 6e74 6f20 7072 6f6a  videos into proj
-00010890: 6563 745f 666f 6c64 6572 2f66 7261 6d65  ect_folder/frame
-000108a0: 732f 696e 7075 7420 6469 7265 6374 6f72  s/input director
-000108b0: 792e 2e2e 222e 666f 726d 6174 280a 2020  y...".format(.  
-000108c0: 2020 2020 2020 2020 2020 6c65 6e28 7669            len(vi
-000108d0: 6465 6f5f 7061 7468 7329 0a20 2020 2020  deo_paths).     
-000108e0: 2020 2029 0a20 2020 2029 0a20 2020 2066     ).    ).    f
-000108f0: 6f72 2076 6964 656f 5f70 6174 6820 696e  or video_path in
-00010900: 2076 6964 656f 5f70 6174 6873 3a0a 2020   video_paths:.  
-00010910: 2020 2020 2020 6469 725f 6e61 6d65 2c20        dir_name, 
-00010920: 7669 6465 6f5f 6e61 6d65 2c20 6578 7420  video_name, ext 
-00010930: 3d20 6765 745f 666e 5f65 7874 2876 6964  = get_fn_ext(vid
-00010940: 656f 5f70 6174 6829 0a20 2020 2020 2020  eo_path).       
-00010950: 2073 6176 655f 7061 7468 203d 206f 732e   save_path = os.
-00010960: 7061 7468 2e6a 6f69 6e28 7072 6f6a 6563  path.join(projec
-00010970: 745f 7061 7468 2c20 2266 7261 6d65 7322  t_path, "frames"
-00010980: 2c20 2269 6e70 7574 222c 2076 6964 656f  , "input", video
-00010990: 5f6e 616d 6529 0a20 2020 2020 2020 2069  _name).        i
-000109a0: 6620 6e6f 7420 6f73 2e70 6174 682e 6578  f not os.path.ex
-000109b0: 6973 7473 2873 6176 655f 7061 7468 293a  ists(save_path):
-000109c0: 0a20 2020 2020 2020 2020 2020 206f 732e  .            os.
-000109d0: 6d61 6b65 6469 7273 2873 6176 655f 7061  makedirs(save_pa
-000109e0: 7468 290a 2020 2020 2020 2020 656c 7365  th).        else
-000109f0: 3a0a 2020 2020 2020 2020 2020 2020 7072  :.            pr
-00010a00: 696e 7428 0a20 2020 2020 2020 2020 2020  int(.           
-00010a10: 2020 2020 2066 2246 7261 6d65 7320 666f       f"Frames fo
-00010a20: 7220 7669 6465 6f20 7b76 6964 656f 5f6e  r video {video_n
-00010a30: 616d 657d 2061 6c72 6561 6479 2065 7874  ame} already ext
-00010a40: 7261 6374 6564 2e20 5369 6d42 4120 6973  racted. SimBA is
-00010a50: 206f 7665 7277 7269 7469 6e67 2070 7269   overwriting pri
-00010a60: 6f72 2066 7261 6d65 732e 2e2e 220a 2020  or frames...".  
-00010a70: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00010a80: 2020 2020 7669 6465 6f5f 746f 5f66 7261      video_to_fra
-00010a90: 6d65 7328 7669 6465 6f5f 7061 7468 2c20  mes(video_path, 
-00010aa0: 7361 7665 5f70 6174 682c 206f 7665 7277  save_path, overw
-00010ab0: 7269 7465 3d54 7275 652c 2065 7665 7279  rite=True, every
-00010ac0: 3d31 2c20 6368 756e 6b5f 7369 7a65 3d31  =1, chunk_size=1
-00010ad0: 3030 3029 0a20 2020 2074 696d 6572 2e73  000).    timer.s
-00010ae0: 746f 705f 7469 6d65 7228 290a 2020 2020  top_timer().    
-00010af0: 7374 646f 7574 5f73 7563 6365 7373 280a  stdout_success(.
-00010b00: 2020 2020 2020 2020 6622 4672 616d 6573          f"Frames
-00010b10: 2063 7265 6174 6564 2066 6f72 207b 7374   created for {st
-00010b20: 7228 6c65 6e28 7669 6465 6f5f 7061 7468  r(len(video_path
-00010b30: 7329 297d 2076 6964 656f 7322 2c0a 2020  s))} videos",.  
-00010b40: 2020 2020 2020 656c 6170 7365 645f 7469        elapsed_ti
-00010b50: 6d65 3d74 696d 6572 2e65 6c61 7073 6564  me=timer.elapsed
-00010b60: 5f74 696d 655f 7374 722c 0a20 2020 2020  _time_str,.     
-00010b70: 2020 2073 6f75 7263 653d 6578 7472 6163     source=extrac
-00010b80: 745f 6672 616d 6573 5f66 726f 6d5f 616c  t_frames_from_al
-00010b90: 6c5f 7669 6465 6f73 5f69 6e5f 6469 7265  l_videos_in_dire
-00010ba0: 6374 6f72 792e 5f5f 6e61 6d65 5f5f 2c0a  ctory.__name__,.
-00010bb0: 2020 2020 290a 0a0a 6465 6620 636f 7079      )...def copy
-00010bc0: 5f69 6d67 5f66 6f6c 6465 7228 0a20 2020  _img_folder(.   
-00010bd0: 2063 6f6e 6669 675f 7061 7468 3a20 556e   config_path: Un
-00010be0: 696f 6e5b 7374 722c 206f 732e 5061 7468  ion[str, os.Path
-00010bf0: 4c69 6b65 5d2c 2073 6f75 7263 653a 2055  Like], source: U
-00010c00: 6e69 6f6e 5b73 7472 2c20 6f73 2e50 6174  nion[str, os.Pat
-00010c10: 684c 696b 655d 0a29 202d 3e20 4e6f 6e65  hLike].) -> None
-00010c20: 3a0a 2020 2020 2222 220a 2020 2020 436f  :.    """.    Co
-00010c30: 7079 2064 6972 6563 746f 7279 206f 6620  py directory of 
-00010c40: 706e 6720 6669 6c65 7320 746f 2074 6865  png files to the
-00010c50: 2053 696d 4241 2070 726f 6a65 6374 2e20   SimBA project. 
-00010c60: 5468 6520 6469 7265 6374 6f72 7920 6973  The directory is
-00010c70: 2073 746f 7265 6420 696e 2074 6865 2070   stored in the p
-00010c80: 726f 6a65 6374 5f66 6f6c 6465 722f 6672  roject_folder/fr
-00010c90: 616d 6573 2f69 6e70 7574 2066 6f6c 6465  ames/input folde
-00010ca0: 7220 6f66 2074 6865 2053 696d 4241 2070  r of the SimBA p
-00010cb0: 726f 6a65 6374 0a0a 2020 2020 3a70 6172  roject..    :par
-00010cc0: 616d 6574 6572 2073 7472 2063 6f6e 6669  ameter str confi
-00010cd0: 675f 7061 7468 3a20 7061 7468 2074 6f20  g_path: path to 
-00010ce0: 5369 6d42 4120 7072 6f6a 6563 7420 636f  SimBA project co
-00010cf0: 6e66 6967 2066 696c 6520 696e 2043 6f6e  nfig file in Con
-00010d00: 6669 6770 6172 7365 7220 666f 726d 6174  figparser format
-00010d10: 2e0a 2020 2020 3a70 6172 616d 6574 6572  ..    :parameter
-00010d20: 2073 7472 2073 6f75 7263 653a 2070 6174   str source: pat
-00010d30: 6820 746f 2069 6d61 6765 2066 6f6c 6465  h to image folde
-00010d40: 7220 6f75 7473 6964 6520 5369 6d42 4120  r outside SimBA 
-00010d50: 7072 6f6a 6563 742e 0a0a 2020 2020 3a65  project...    :e
-00010d60: 7861 6d70 6c65 3a0a 2020 2020 3e3e 3e20  xample:.    >>> 
-00010d70: 636f 7079 5f69 6d67 5f66 6f6c 6465 7228  copy_img_folder(
-00010d80: 636f 6e66 6967 5f70 6174 683d 274d 7953  config_path='MyS
-00010d90: 696d 4241 7072 6f6a 6563 7443 6f6e 6669  imBAprojectConfi
-00010da0: 6727 2c20 736f 7572 6365 3d27 2f44 6972  g', source='/Dir
-00010db0: 6563 746f 7279 5769 7468 5669 6465 6f73  ectoryWithVideos
-00010dc0: 2f27 290a 0a20 2020 2022 2222 0a20 2020  /')..    """.   
-00010dd0: 2074 696d 6572 203d 2053 696d 6261 5469   timer = SimbaTi
-00010de0: 6d65 7228 7374 6172 743d 5472 7565 290a  mer(start=True).
-00010df0: 2020 2020 6966 206e 6f74 206f 732e 7061      if not os.pa
-00010e00: 7468 2e69 7364 6972 2873 6f75 7263 6529  th.isdir(source)
-00010e10: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
-00010e20: 4e6f 7444 6972 6563 746f 7279 4572 726f  NotDirectoryErro
-00010e30: 7228 0a20 2020 2020 2020 2020 2020 206d  r(.            m
-00010e40: 7367 3d66 2253 494d 4241 2045 5252 4f52  sg=f"SIMBA ERROR
-00010e50: 3a20 736f 7572 6365 207b 736f 7572 6365  : source {source
-00010e60: 7d20 6973 206e 6f74 2061 2064 6972 6563  } is not a direc
-00010e70: 746f 7279 2e22 2c0a 2020 2020 2020 2020  tory.",.        
-00010e80: 2020 2020 736f 7572 6365 3d63 6f70 795f      source=copy_
-00010e90: 696d 675f 666f 6c64 6572 2e5f 5f6e 616d  img_folder.__nam
-00010ea0: 655f 5f2c 0a20 2020 2020 2020 2029 0a20  e__,.        ). 
-00010eb0: 2020 2069 6620 6c65 6e28 676c 6f62 2e67     if len(glob.g
-00010ec0: 6c6f 6228 736f 7572 6365 202b 2022 2f2a  lob(source + "/*
-00010ed0: 2e70 6e67 2229 2920 3d3d 2030 3a0a 2020  .png")) == 0:.  
-00010ee0: 2020 2020 2020 7261 6973 6520 4e6f 4669        raise NoFi
-00010ef0: 6c65 7346 6f75 6e64 4572 726f 7228 0a20  lesFoundError(. 
-00010f00: 2020 2020 2020 2020 2020 206d 7367 3d66             msg=f
-00010f10: 2253 494d 4241 2045 5252 4f52 3a20 736f  "SIMBA ERROR: so
-00010f20: 7572 6365 207b 736f 7572 6365 7d20 646f  urce {source} do
-00010f30: 6573 206e 6f74 2063 6f6e 7461 696e 2061  es not contain a
-00010f40: 6e79 202e 706e 6720 6669 6c65 732e 222c  ny .png files.",
-00010f50: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
-00010f60: 7263 653d 636f 7079 5f69 6d67 5f66 6f6c  rce=copy_img_fol
-00010f70: 6465 722e 5f5f 6e61 6d65 5f5f 2c0a 2020  der.__name__,.  
-00010f80: 2020 2020 2020 290a 2020 2020 696e 7075        ).    inpu
-00010f90: 745f 6261 7365 6e61 6d65 203d 206f 732e  t_basename = os.
-00010fa0: 7061 7468 2e62 6173 656e 616d 6528 736f  path.basename(so
-00010fb0: 7572 6365 290a 2020 2020 636f 6e66 6967  urce).    config
-00010fc0: 203d 2072 6561 645f 636f 6e66 6967 5f66   = read_config_f
-00010fd0: 696c 6528 636f 6e66 6967 5f70 6174 6829  ile(config_path)
-00010fe0: 0a20 2020 2070 726f 6a65 6374 5f70 6174  .    project_pat
-00010ff0: 6820 3d20 7265 6164 5f63 6f6e 6669 675f  h = read_config_
-00011000: 656e 7472 7928 0a20 2020 2020 2020 2063  entry(.        c
-00011010: 6f6e 6669 672c 0a20 2020 2020 2020 2043  onfig,.        C
-00011020: 6f6e 6669 674b 6579 2e47 454e 4552 414c  onfigKey.GENERAL
-00011030: 5f53 4554 5449 4e47 532e 7661 6c75 652c  _SETTINGS.value,
-00011040: 0a20 2020 2020 2020 2043 6f6e 6669 674b  .        ConfigK
-00011050: 6579 2e50 524f 4a45 4354 5f50 4154 482e  ey.PROJECT_PATH.
-00011060: 7661 6c75 652c 0a20 2020 2020 2020 2064  value,.        d
-00011070: 6174 615f 7479 7065 3d22 666f 6c64 6572  ata_type="folder
-00011080: 5f70 6174 6822 2c0a 2020 2020 290a 2020  _path",.    ).  
-00011090: 2020 696e 7075 745f 6672 616d 6573 5f64    input_frames_d
-000110a0: 6972 203d 206f 732e 7061 7468 2e6a 6f69  ir = os.path.joi
-000110b0: 6e28 7072 6f6a 6563 745f 7061 7468 2c20  n(project_path, 
-000110c0: 5061 7468 732e 494e 5055 545f 4652 414d  Paths.INPUT_FRAM
-000110d0: 4553 5f44 4952 2e76 616c 7565 290a 2020  ES_DIR.value).  
-000110e0: 2020 6465 7374 696e 6174 696f 6e20 3d20    destination = 
-000110f0: 6f73 2e70 6174 682e 6a6f 696e 2869 6e70  os.path.join(inp
-00011100: 7574 5f66 7261 6d65 735f 6469 722c 2069  ut_frames_dir, i
-00011110: 6e70 7574 5f62 6173 656e 616d 6529 0a20  nput_basename). 
-00011120: 2020 2069 6620 6f73 2e70 6174 682e 6973     if os.path.is
-00011130: 6469 7228 6465 7374 696e 6174 696f 6e29  dir(destination)
-00011140: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
-00011150: 4469 7265 6374 6f72 7945 7869 7374 4572  DirectoryExistEr
-00011160: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-00011170: 206d 7367 3d66 2253 494d 4241 2045 5252   msg=f"SIMBA ERR
-00011180: 4f52 3a20 7b64 6573 7469 6e61 7469 6f6e  OR: {destination
-00011190: 7d20 616c 7265 6164 7920 6578 6973 7420  } already exist 
-000111a0: 696e 2053 696d 4241 2070 726f 6a65 6374  in SimBA project
-000111b0: 2e22 2c0a 2020 2020 2020 2020 2020 2020  .",.            
-000111c0: 736f 7572 6365 3d63 6f70 795f 696d 675f  source=copy_img_
-000111d0: 666f 6c64 6572 2e5f 5f6e 616d 655f 5f2c  folder.__name__,
-000111e0: 0a20 2020 2020 2020 2029 0a20 2020 2070  .        ).    p
-000111f0: 7269 6e74 2866 2249 6d70 6f72 7469 6e67  rint(f"Importing
-00011200: 2069 6d61 6765 2066 696c 6573 2066 6f72   image files for
-00011210: 207b 696e 7075 745f 6261 7365 6e61 6d65   {input_basename
-00011220: 7d2e 2e2e 2229 0a20 2020 2073 6875 7469  }...").    shuti
-00011230: 6c2e 636f 7079 7472 6565 2873 6f75 7263  l.copytree(sourc
-00011240: 652c 2064 6573 7469 6e61 7469 6f6e 290a  e, destination).
-00011250: 2020 2020 7469 6d65 722e 7374 6f70 5f74      timer.stop_t
-00011260: 696d 6572 2829 0a20 2020 2073 7464 6f75  imer().    stdou
-00011270: 745f 7375 6363 6573 7328 0a20 2020 2020  t_success(.     
-00011280: 2020 206d 7367 3d66 227b 6465 7374 696e     msg=f"{destin
-00011290: 6174 696f 6e7d 2069 6d70 6f72 7465 6420  ation} imported 
-000112a0: 746f 2053 696d 4241 2070 726f 6a65 6374  to SimBA project
-000112b0: 222c 0a20 2020 2020 2020 2065 6c61 7073  ",.        elaps
-000112c0: 6564 5f74 696d 653d 7469 6d65 722e 656c  ed_time=timer.el
-000112d0: 6170 7365 645f 7469 6d65 5f73 7472 2c0a  apsed_time_str,.
-000112e0: 2020 2020 2020 2020 736f 7572 6365 3d63          source=c
-000112f0: 6f70 795f 696d 675f 666f 6c64 6572 2e5f  opy_img_folder._
-00011300: 5f6e 616d 655f 5f2c 0a20 2020 2029 0a0a  _name__,.    )..
-00011310: 0a64 6566 2061 7070 656e 645f 6175 6469  .def append_audi
-00011320: 6f28 0a20 2020 2076 6964 656f 5f70 6174  o(.    video_pat
-00011330: 683a 2055 6e69 6f6e 5b73 7472 2c20 6f73  h: Union[str, os
-00011340: 2e50 6174 684c 696b 655d 2c0a 2020 2020  .PathLike],.    
-00011350: 6175 6469 6f5f 7061 7468 3a20 556e 696f  audio_path: Unio
-00011360: 6e5b 7374 722c 206f 732e 5061 7468 4c69  n[str, os.PathLi
-00011370: 6b65 5d2c 0a20 2020 2061 7564 696f 5f73  ke],.    audio_s
-00011380: 7263 5f74 7970 653a 204c 6974 6572 616c  rc_type: Literal
-00011390: 5b22 7669 6465 6f22 2c20 2261 7564 696f  ["video", "audio
-000113a0: 225d 203d 2022 7669 6465 6f22 2c0a 2920  "] = "video",.) 
-000113b0: 2d3e 204e 6f6e 653a 0a20 2020 2022 2222  -> None:.    """
-000113c0: 0a20 2020 2041 7070 656e 6420 6175 6469  .    Append audi
-000113d0: 6f20 7472 6163 6b20 6672 6f6d 206f 6e65  o track from one
-000113e0: 2076 6964 656f 2074 6f20 616e 6f74 6865   video to anothe
-000113f0: 7220 7669 6465 6f20 7769 7468 6f75 7420  r video without 
-00011400: 616e 2061 7564 696f 2074 7261 636b 2e0a  an audio track..
-00011410: 0a20 2020 203a 7061 7261 6d20 556e 696f  .    :param Unio
-00011420: 6e5b 7374 722c 206f 732e 5061 7468 4c69  n[str, os.PathLi
-00011430: 6b65 5d20 7669 6465 6f5f 6f6e 655f 7061  ke] video_one_pa
-00011440: 7468 3a20 5061 7468 2074 6f20 7669 6465  th: Path to vide
-00011450: 6f20 6669 6c65 2077 6974 686f 7574 2061  o file without a
-00011460: 7564 696f 2074 7261 636b 2e0a 2020 2020  udio track..    
-00011470: 3a70 6172 616d 2055 6e69 6f6e 5b73 7472  :param Union[str
-00011480: 2c20 6f73 2e50 6174 684c 696b 655d 2061  , os.PathLike] a
-00011490: 7564 696f 5f70 6174 683a 2050 6174 6820  udio_path: Path 
-000114a0: 746f 2066 696c 6520 2865 2e67 2e2c 2076  to file (e.g., v
-000114b0: 6964 656f 2920 7769 7468 2061 7564 696f  ideo) with audio
-000114c0: 2074 7261 636b 2e0a 2020 2020 3a70 6172   track..    :par
-000114d0: 616d 204c 6974 6572 616c 5b27 7669 6465  am Literal['vide
-000114e0: 6f27 2c20 2761 7564 696f 275d 2061 7564  o', 'audio'] aud
-000114f0: 696f 5f73 7263 5f74 7970 653a 2054 7970  io_src_type: Typ
-00011500: 6520 6f66 2061 7564 696f 2073 6f75 7263  e of audio sourc
-00011510: 6520 6f66 2022 7669 6465 6f5f 7477 6f5f  e of "video_two_
-00011520: 7061 7468 2220 2865 2e67 2e2c 2076 6964  path" (e.g., vid
-00011530: 656f 206f 7220 6175 6469 6f20 6669 6c65  eo or audio file
-00011540: 292e 0a0a 2020 2020 3a65 7861 6d70 6c65  )...    :example
-00011550: 3a0a 2020 2020 3e3e 3e20 6170 7065 6e64  :.    >>> append
-00011560: 5f61 7564 696f 2876 6964 656f 5f70 6174  _audio(video_pat
-00011570: 683d 272f 5573 6572 732f 7369 6d6f 6e2f  h='/Users/simon/
-00011580: 4465 736b 746f 702f 656e 7673 2f74 726f  Desktop/envs/tro
-00011590: 7562 6c65 7368 6f6f 7469 6e67 2f74 776f  ubleshooting/two
-000115a0: 5f62 6c61 636b 5f61 6e69 6d61 6c73 5f31  _black_animals_1
-000115b0: 3462 702f 7072 6f6a 6563 745f 666f 6c64  4bp/project_fold
-000115c0: 6572 2f76 6964 656f 732f 6d65 7267 6564  er/videos/merged
-000115d0: 5f76 6964 656f 5f32 3032 3330 3432 3532  _video_202304252
-000115e0: 3031 3633 372e 6d70 3427 2c0a 2020 2020  01637.mp4',.    
-000115f0: 3e3e 3e20 6175 6469 6f5f 7061 7468 3d22  >>> audio_path="
-00011600: 2f55 7365 7273 2f73 696d 6f6e 2f44 6f63  /Users/simon/Doc
-00011610: 756d 656e 7473 2f5a 6f6f 6d2f 6464 642f  uments/Zoom/ddd/
-00011620: 7669 6465 6f31 3138 3037 3332 3233 332e  video1180732233.
-00011630: 6d70 3422 290a 2020 2020 2222 220a 0a20  mp4").    """.. 
-00011640: 2020 2069 6620 6e6f 7420 6368 6563 6b5f     if not check_
-00011650: 6666 6d70 6567 5f61 7661 696c 6162 6c65  ffmpeg_available
-00011660: 2829 3a0a 2020 2020 2020 2020 7261 6973  ():.        rais
-00011670: 6520 4646 4d50 4547 4e6f 7446 6f75 6e64  e FFMPEGNotFound
-00011680: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-00011690: 2020 206d 7367 3d22 4646 4d70 6567 206e     msg="FFMpeg n
-000116a0: 6f74 2066 6f75 6e64 206f 6e20 636f 6d70  ot found on comp
-000116b0: 7574 6572 2e20 5365 6520 5369 6d42 4120  uter. See SimBA 
-000116c0: 646f 6373 2066 6f72 2069 6e73 7461 6c6c  docs for install
-000116d0: 2069 6e73 7472 7563 7469 6f6e 732e 222c   instructions.",
-000116e0: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
-000116f0: 7263 653d 6170 7065 6e64 5f61 7564 696f  rce=append_audio
-00011700: 2e5f 5f6e 616d 655f 5f2c 0a20 2020 2020  .__name__,.     
-00011710: 2020 2029 0a20 2020 2063 6865 636b 5f66     ).    check_f
-00011720: 696c 655f 6578 6973 745f 616e 645f 7265  ile_exist_and_re
-00011730: 6164 6162 6c65 2866 696c 655f 7061 7468  adable(file_path
-00011740: 3d76 6964 656f 5f70 6174 6829 0a20 2020  =video_path).   
-00011750: 2063 6865 636b 5f66 696c 655f 6578 6973   check_file_exis
-00011760: 745f 616e 645f 7265 6164 6162 6c65 2866  t_and_readable(f
-00011770: 696c 655f 7061 7468 3d61 7564 696f 5f70  ile_path=audio_p
-00011780: 6174 6829 0a20 2020 2076 6964 656f 5f6d  ath).    video_m
-00011790: 6574 615f 6461 7461 203d 2067 6574 5f76  eta_data = get_v
-000117a0: 6964 656f 5f6d 6574 615f 6461 7461 2876  ideo_meta_data(v
-000117b0: 6964 656f 5f70 6174 683d 7669 6465 6f5f  ideo_path=video_
-000117c0: 7061 7468 290a 2020 2020 6175 6469 6f5f  path).    audio_
-000117d0: 7372 635f 6d65 7461 5f64 6174 6120 3d20  src_meta_data = 
-000117e0: 6765 745f 7669 6465 6f5f 6d65 7461 5f64  get_video_meta_d
-000117f0: 6174 6128 7669 6465 6f5f 7061 7468 3d61  ata(video_path=a
-00011800: 7564 696f 5f70 6174 6829 0a20 2020 2073  udio_path).    s
-00011810: 6176 655f 7061 7468 203d 206f 732e 7061  ave_path = os.pa
-00011820: 7468 2e6a 6f69 6e28 0a20 2020 2020 2020  th.join(.       
-00011830: 206f 732e 7061 7468 2e64 6972 6e61 6d65   os.path.dirname
-00011840: 2876 6964 656f 5f70 6174 6829 2c20 6765  (video_path), ge
-00011850: 745f 666e 5f65 7874 2866 696c 6570 6174  t_fn_ext(filepat
-00011860: 683d 7669 6465 6f5f 7061 7468 295b 315d  h=video_path)[1]
-00011870: 202b 2022 5f77 5f61 7564 696f 2e6d 7034   + "_w_audio.mp4
-00011880: 220a 2020 2020 290a 2020 2020 636d 6420  ".    ).    cmd 
-00011890: 3d20 5b0a 2020 2020 2020 2020 2266 6670  = [.        "ffp
-000118a0: 726f 6265 222c 0a20 2020 2020 2020 2022  robe",.        "
-000118b0: 2d76 222c 0a20 2020 2020 2020 2022 6572  -v",.        "er
-000118c0: 726f 7222 2c0a 2020 2020 2020 2020 222d  ror",.        "-
-000118d0: 7365 6c65 6374 5f73 7472 6561 6d73 222c  select_streams",
-000118e0: 0a20 2020 2020 2020 2022 613a 3022 2c0a  .        "a:0",.
-000118f0: 2020 2020 2020 2020 222d 7368 6f77 5f65          "-show_e
-00011900: 6e74 7269 6573 222c 0a20 2020 2020 2020  ntries",.       
-00011910: 2022 7374 7265 616d 3d63 6f64 6563 5f6e   "stream=codec_n
-00011920: 616d 6522 2c0a 2020 2020 2020 2020 222d  ame",.        "-
-00011930: 6f66 222c 0a20 2020 2020 2020 2022 6465  of",.        "de
-00011940: 6661 756c 743d 6e6f 7072 696e 745f 7772  fault=noprint_wr
-00011950: 6170 7065 7273 3d31 3a6e 6f6b 6579 3d31  appers=1:nokey=1
-00011960: 222c 0a20 2020 2020 2020 2061 7564 696f  ",.        audio
-00011970: 5f70 6174 682c 0a20 2020 205d 0a20 2020  _path,.    ].   
-00011980: 2074 7279 3a0a 2020 2020 2020 2020 7472   try:.        tr
-00011990: 6163 6b5f 7479 7065 203d 2028 0a20 2020  ack_type = (.   
-000119a0: 2020 2020 2020 2020 2073 7562 7072 6f63           subproc
-000119b0: 6573 732e 6368 6563 6b5f 6f75 7470 7574  ess.check_output
-000119c0: 2863 6d64 2c20 7374 6465 7272 3d73 7562  (cmd, stderr=sub
-000119d0: 7072 6f63 6573 732e 5354 444f 5554 290a  process.STDOUT).
-000119e0: 2020 2020 2020 2020 2020 2020 2e64 6563              .dec
-000119f0: 6f64 6528 2275 7466 2d38 2229 0a20 2020  ode("utf-8").   
-00011a00: 2020 2020 2020 2020 202e 7374 7269 7028           .strip(
-00011a10: 290a 2020 2020 2020 2020 290a 2020 2020  ).        ).    
-00011a20: 6578 6365 7074 2073 7562 7072 6f63 6573  except subproces
-00011a30: 732e 4361 6c6c 6564 5072 6f63 6573 7345  s.CalledProcessE
-00011a40: 7272 6f72 3a0a 2020 2020 2020 2020 7261  rror:.        ra
-00011a50: 6973 6520 4e6f 4461 7461 4572 726f 7228  ise NoDataError(
-00011a60: 0a20 2020 2020 2020 2020 2020 206d 7367  .            msg
-00011a70: 3d66 224e 6f20 6175 6469 6f20 7472 6163  =f"No audio trac
-00011a80: 6b20 666f 756e 6420 696e 2066 696c 6520  k found in file 
-00011a90: 7b61 7564 696f 5f70 6174 687d 222c 0a20  {audio_path}",. 
-00011aa0: 2020 2020 2020 2020 2020 2073 6f75 7263             sourc
-00011ab0: 653d 6170 7065 6e64 5f61 7564 696f 2e5f  e=append_audio._
-00011ac0: 5f6e 616d 655f 5f2c 0a20 2020 2020 2020  _name__,.       
-00011ad0: 2029 0a0a 2020 2020 6966 2076 6964 656f   )..    if video
-00011ae0: 5f6d 6574 615f 6461 7461 5b22 6672 616d  _meta_data["fram
-00011af0: 655f 636f 756e 7422 5d20 213d 2061 7564  e_count"] != aud
-00011b00: 696f 5f73 7263 5f6d 6574 615f 6461 7461  io_src_meta_data
-00011b10: 5b22 6672 616d 655f 636f 756e 7422 5d3a  ["frame_count"]:
-00011b20: 0a20 2020 2020 2020 2049 6e56 616c 6964  .        InValid
-00011b30: 5573 6572 496e 7075 7457 6172 6e69 6e67  UserInputWarning
-00011b40: 280a 2020 2020 2020 2020 2020 2020 6d73  (.            ms
-00011b50: 673d 6627 5468 6520 7669 6465 6f20 287b  g=f'The video ({
-00011b60: 7669 6465 6f5f 6d65 7461 5f64 6174 615b  video_meta_data[
-00011b70: 2266 7261 6d65 5f63 6f75 6e74 225d 7d29  "frame_count"]})
-00011b80: 2061 6e64 2061 7564 696f 2073 6f75 7263   and audio sourc
-00011b90: 6520 287b 6175 6469 6f5f 7372 635f 6d65  e ({audio_src_me
-00011ba0: 7461 5f64 6174 615b 2266 7261 6d65 5f63  ta_data["frame_c
-00011bb0: 6f75 6e74 225d 7d29 2064 6f65 7320 6e6f  ount"]}) does no
-00011bc0: 7420 6861 7665 2061 6e20 6571 7561 6c20  t have an equal 
-00011bd0: 6e75 6d62 6572 206f 6620 6672 616d 6573  number of frames
-00011be0: 2e27 2c0a 2020 2020 2020 2020 2020 2020  .',.            
-00011bf0: 736f 7572 6365 3d61 7070 656e 645f 6175  source=append_au
-00011c00: 6469 6f2e 5f5f 6e61 6d65 5f5f 2c0a 2020  dio.__name__,.  
-00011c10: 2020 2020 2020 290a 0a20 2020 2063 6d64        )..    cmd
-00011c20: 203d 2066 2766 666d 7065 6720 2d69 2022   = f'ffmpeg -i "
-00011c30: 7b76 6964 656f 5f70 6174 687d 2220 2d69  {video_path}" -i
-00011c40: 2022 7b61 7564 696f 5f70 6174 687d 2220   "{audio_path}" 
-00011c50: 2d63 3a76 2063 6f70 7920 2d6d 6170 2030  -c:v copy -map 0
-00011c60: 3a76 3a30 202d 6d61 7020 313a 613a 3020  :v:0 -map 1:a:0 
-00011c70: 227b 7361 7665 5f70 6174 687d 2220 2d79  "{save_path}" -y
-00011c80: 270a 0a20 2020 2074 7279 3a0a 2020 2020  '..    try:.    
-00011c90: 2020 2020 7375 6270 726f 6365 7373 2e72      subprocess.r
-00011ca0: 756e 2863 6d64 2c20 7368 656c 6c3d 5472  un(cmd, shell=Tr
-00011cb0: 7565 2c20 6368 6563 6b3d 5472 7565 290a  ue, check=True).
-00011cc0: 2020 2020 6578 6365 7074 2073 7562 7072      except subpr
-00011cd0: 6f63 6573 732e 4361 6c6c 6564 5072 6f63  ocess.CalledProc
-00011ce0: 6573 7345 7272 6f72 2061 7320 653a 0a20  essError as e:. 
-00011cf0: 2020 2020 2020 2070 7269 6e74 2822 4572         print("Er
-00011d00: 726f 723a 222c 2065 290a 0a20 2020 2073  ror:", e)..    s
-00011d10: 7464 6f75 745f 7375 6363 6573 7328 0a20  tdout_success(. 
-00011d20: 2020 2020 2020 206d 7367 3d66 2241 7564         msg=f"Aud
-00011d30: 696f 206d 6572 6765 6420 7375 6363 6573  io merged succes
-00011d40: 7366 756c 6c79 2c20 6669 6c65 2073 6176  sfully, file sav
-00011d50: 6564 2061 7420 7b73 6176 655f 7061 7468  ed at {save_path
-00011d60: 7d21 222c 0a20 2020 2020 2020 2073 6f75  }!",.        sou
-00011d70: 7263 653d 6170 7065 6e64 5f61 7564 696f  rce=append_audio
-00011d80: 2e5f 5f6e 616d 655f 5f2c 0a20 2020 2029  .__name__,.    )
-00011d90: 0a0a 0a64 6566 2063 726f 705f 7369 6e67  ...def crop_sing
-00011da0: 6c65 5f76 6964 656f 5f63 6972 636c 6528  le_video_circle(
-00011db0: 6669 6c65 5f70 6174 683a 2055 6e69 6f6e  file_path: Union
-00011dc0: 5b73 7472 2c20 6f73 2e50 6174 684c 696b  [str, os.PathLik
-00011dd0: 655d 2920 2d3e 204e 6f6e 653a 0a20 2020  e]) -> None:.   
-00011de0: 2022 2222 0a20 2020 2043 726f 7020 6120   """.    Crop a 
-00011df0: 7669 6465 6f20 6261 7365 6420 6f6e 2063  video based on c
-00011e00: 6972 6375 6c61 7220 7265 6769 6f6e 7320  ircular regions 
-00011e10: 6f66 2069 6e74 6572 6573 7420 2852 4f49  of interest (ROI
-00011e20: 7329 2073 656c 6563 7465 6420 6279 2074  s) selected by t
-00011e30: 6865 2075 7365 722e 0a0a 2020 2020 3a70  he user...    :p
-00011e40: 6172 616d 2020 556e 696f 6e5b 7374 722c  aram  Union[str,
-00011e50: 206f 732e 5061 7468 4c69 6b65 5d20 6669   os.PathLike] fi
-00011e60: 6c65 5f70 6174 683a 2054 6865 2070 6174  le_path: The pat
-00011e70: 6820 746f 2074 6865 2069 6e70 7574 2076  h to the input v
-00011e80: 6964 656f 2066 696c 652e 0a0a 2020 2020  ideo file...    
-00011e90: 2e2e 206e 6f74 653a 3a0a 2020 2020 2020  .. note::.      
-00011ea0: 2054 6869 7320 6675 6e63 7469 6f6e 2063   This function c
-00011eb0: 726f 7073 2074 6865 2069 6e70 7574 2076  rops the input v
-00011ec0: 6964 656f 2062 6173 6564 206f 6e20 6369  ideo based on ci
-00011ed0: 7263 756c 6172 2072 6567 696f 6e73 206f  rcular regions o
-00011ee0: 6620 696e 7465 7265 7374 2028 524f 4973  f interest (ROIs
-00011ef0: 2920 7365 6c65 6374 6564 2062 7920 7468  ) selected by th
-00011f00: 6520 7573 6572 2e0a 2020 2020 2020 2054  e user..       T
-00011f10: 6865 2075 7365 7220 6973 2070 726f 6d70  he user is promp
-00011f20: 7465 6420 746f 2073 656c 6563 7420 6120  ted to select a 
-00011f30: 6369 7263 756c 6172 2052 4f49 206f 6e20  circular ROI on 
-00011f40: 7468 6520 7669 6465 6f20 6672 616d 652c  the video frame,
-00011f50: 2061 6e64 2074 6865 2066 756e 6374 696f   and the functio
-00011f60: 6e20 7468 656e 2063 726f 7073 2074 6865  n then crops the
-00011f70: 2076 6964 656f 0a20 2020 2020 2020 6261   video.       ba
-00011f80: 7365 6420 6f6e 2074 6865 2073 656c 6563  sed on the selec
-00011f90: 7465 6420 524f 492e 2054 6865 2063 726f  ted ROI. The cro
-00011fa0: 7070 6564 2076 6964 656f 2069 7320 7361  pped video is sa
-00011fb0: 7665 6420 7769 7468 2022 5f63 6972 636c  ved with "_circl
-00011fc0: 655f 6372 6f70 7065 6422 2073 7566 6669  e_cropped" suffi
-00011fd0: 7820 696e 2074 6865 2073 616d 6520 6469  x in the same di
-00011fe0: 7265 6374 6f72 790a 2020 2020 2020 2061  rectory.       a
-00011ff0: 7320 7468 6520 696e 7075 7420 7669 6465  s the input vide
-00012000: 6f20 6669 6c65 2e0a 0a20 2020 203a 6578  o file...    :ex
-00012010: 616d 706c 653a 0a20 2020 203e 3e3e 2063  ample:.    >>> c
-00012020: 726f 705f 7369 6e67 6c65 5f76 6964 656f  rop_single_video
-00012030: 5f63 6972 636c 6528 6669 6c65 5f70 6174  _circle(file_pat
-00012040: 683d 272f 5573 6572 732f 7369 6d6f 6e2f  h='/Users/simon/
-00012050: 4465 736b 746f 702f 4147 4752 4553 5349  Desktop/AGGRESSI
-00012060: 5649 5459 5f34 5f31 315f 3231 5f54 7269  VITY_4_11_21_Tri
-00012070: 616c 5f32 5f63 616d 6572 6131 5f72 6f74  al_2_camera1_rot
-00012080: 6174 6564 5f32 3032 3430 3231 3131 3433  ated_20240211143
-00012090: 3335 352e 6d70 3427 290a 2020 2020 2222  355.mp4').    ""
-000120a0: 220a 0a20 2020 2064 6972 2c20 7669 6465  "..    dir, vide
-000120b0: 6f5f 6e61 6d65 2c20 5f20 3d20 6765 745f  o_name, _ = get_
-000120c0: 666e 5f65 7874 2866 696c 6570 6174 683d  fn_ext(filepath=
-000120d0: 6669 6c65 5f70 6174 6829 0a20 2020 2073  file_path).    s
-000120e0: 6176 655f 7061 7468 203d 206f 732e 7061  ave_path = os.pa
-000120f0: 7468 2e6a 6f69 6e28 6469 722c 2066 227b  th.join(dir, f"{
-00012100: 7669 6465 6f5f 6e61 6d65 7d5f 6369 7263  video_name}_circ
-00012110: 6c65 5f63 726f 7070 6564 2e6d 7034 2229  le_cropped.mp4")
-00012120: 0a20 2020 2076 6964 656f 5f6d 6574 615f  .    video_meta_
-00012130: 6461 7461 203d 2067 6574 5f76 6964 656f  data = get_video
-00012140: 5f6d 6574 615f 6461 7461 2876 6964 656f  _meta_data(video
-00012150: 5f70 6174 683d 6669 6c65 5f70 6174 6829  _path=file_path)
-00012160: 0a20 2020 2063 6865 636b 5f66 696c 655f  .    check_file_
-00012170: 6578 6973 745f 616e 645f 7265 6164 6162  exist_and_readab
-00012180: 6c65 2866 696c 655f 7061 7468 3d66 696c  le(file_path=fil
-00012190: 655f 7061 7468 290a 2020 2020 6369 7263  e_path).    circ
-000121a0: 6c65 5f73 656c 6563 746f 7220 3d20 524f  le_selector = RO
-000121b0: 4953 656c 6563 746f 7243 6972 636c 6528  ISelectorCircle(
-000121c0: 7061 7468 3d66 696c 655f 7061 7468 290a  path=file_path).
-000121d0: 2020 2020 6369 7263 6c65 5f73 656c 6563      circle_selec
-000121e0: 746f 722e 7275 6e28 290a 2020 2020 7469  tor.run().    ti
-000121f0: 6d65 7220 3d20 5369 6d62 6154 696d 6572  mer = SimbaTimer
-00012200: 2873 7461 7274 3d54 7275 6529 0a20 2020  (start=True).   
-00012210: 2072 203d 2063 6972 636c 655f 7365 6c65   r = circle_sele
-00012220: 6374 6f72 2e63 6972 636c 655f 7261 6469  ctor.circle_radi
-00012230: 7573 0a20 2020 2078 2c20 7920 3d20 6369  us.    x, y = ci
-00012240: 7263 6c65 5f73 656c 6563 746f 722e 6369  rcle_selector.ci
-00012250: 7263 6c65 5f63 656e 7465 725b 305d 2c20  rcle_center[0], 
-00012260: 6369 7263 6c65 5f73 656c 6563 746f 722e  circle_selector.
-00012270: 6369 7263 6c65 5f63 656e 7465 725b 315d  circle_center[1]
-00012280: 0a20 2020 2070 6f6c 7967 6f6e 203d 2050  .    polygon = P
-00012290: 6f6c 7967 6f6e 280a 2020 2020 2020 2020  olygon(.        
-000122a0: 5b0a 2020 2020 2020 2020 2020 2020 2878  [.            (x
-000122b0: 202b 2072 202a 206e 702e 636f 7328 616e   + r * np.cos(an
-000122c0: 676c 6529 2c20 7920 2b20 7220 2a20 6e70  gle), y + r * np
-000122d0: 2e73 696e 2861 6e67 6c65 2929 0a20 2020  .sin(angle)).   
-000122e0: 2020 2020 2020 2020 2066 6f72 2061 6e67           for ang
-000122f0: 6c65 2069 6e20 6e70 2e6c 696e 7370 6163  le in np.linspac
-00012300: 6528 302c 2032 202a 206e 702e 7069 2c20  e(0, 2 * np.pi, 
-00012310: 3130 3029 0a20 2020 2020 2020 205d 0a20  100).        ]. 
-00012320: 2020 2029 0a20 2020 2070 6f6c 7967 6f6e     ).    polygon
-00012330: 7320 3d20 5b70 6f6c 7967 6f6e 2066 6f72  s = [polygon for
-00012340: 2078 2069 6e20 7261 6e67 6528 7669 6465   x in range(vide
-00012350: 6f5f 6d65 7461 5f64 6174 615b 2266 7261  o_meta_data["fra
-00012360: 6d65 5f63 6f75 6e74 225d 295d 0a20 2020  me_count"])].   
-00012370: 2069 6620 2870 6c61 7466 6f72 6d2e 7379   if (platform.sy
-00012380: 7374 656d 2829 203d 3d20 2244 6172 7769  stem() == "Darwi
-00012390: 6e22 2920 616e 6420 286d 756c 7469 7072  n") and (multipr
-000123a0: 6f63 6573 7369 6e67 2e67 6574 5f73 7461  ocessing.get_sta
-000123b0: 7274 5f6d 6574 686f 6428 2920 6973 204e  rt_method() is N
-000123c0: 6f6e 6529 3a0a 2020 2020 2020 2020 6d75  one):.        mu
-000123d0: 6c74 6970 726f 6365 7373 696e 672e 7365  ltiprocessing.se
-000123e0: 745f 7374 6172 745f 6d65 7468 6f64 2822  t_start_method("
-000123f0: 7370 6177 6e22 2c20 666f 7263 653d 5472  spawn", force=Tr
-00012400: 7565 290a 2020 2020 706f 6c79 676f 6e73  ue).    polygons
-00012410: 203d 2049 6d61 6765 4d69 7869 6e28 292e   = ImageMixin().
-00012420: 736c 6963 655f 7368 6170 6573 5f69 6e5f  slice_shapes_in_
-00012430: 696d 6773 280a 2020 2020 2020 2020 696d  imgs(.        im
-00012440: 6773 3d66 696c 655f 7061 7468 2c20 7368  gs=file_path, sh
-00012450: 6170 6573 3d70 6f6c 7967 6f6e 732c 2076  apes=polygons, v
-00012460: 6572 626f 7365 3d46 616c 7365 0a20 2020  erbose=False.   
-00012470: 2029 0a20 2020 2074 696d 652e 736c 6565   ).    time.slee
-00012480: 7028 3329 0a20 2020 205f 203d 2049 6d61  p(3).    _ = Ima
-00012490: 6765 4d69 7869 6e2e 696d 675f 7374 6163  geMixin.img_stac
-000124a0: 6b5f 746f 5f76 6964 656f 280a 2020 2020  k_to_video(.    
-000124b0: 2020 2020 696d 6773 3d70 6f6c 7967 6f6e      imgs=polygon
-000124c0: 732c 2073 6176 655f 7061 7468 3d73 6176  s, save_path=sav
-000124d0: 655f 7061 7468 2c20 6670 733d 7669 6465  e_path, fps=vide
-000124e0: 6f5f 6d65 7461 5f64 6174 615b 2266 7073  o_meta_data["fps
-000124f0: 225d 0a20 2020 2029 0a20 2020 2074 696d  "].    ).    tim
-00012500: 6572 2e73 746f 705f 7469 6d65 7228 290a  er.stop_timer().
-00012510: 2020 2020 7374 646f 7574 5f73 7563 6365      stdout_succe
-00012520: 7373 280a 2020 2020 2020 2020 6d73 673d  ss(.        msg=
-00012530: 6622 4369 7263 6c65 2d62 6173 6564 2063  f"Circle-based c
-00012540: 726f 7070 6564 2073 6176 6564 2061 7420  ropped saved at 
-00012550: 746f 207b 7361 7665 5f70 6174 687d 222c  to {save_path}",
-00012560: 0a20 2020 2020 2020 2065 6c61 7073 6564  .        elapsed
-00012570: 5f74 696d 653d 7469 6d65 722e 656c 6170  _time=timer.elap
-00012580: 7365 645f 7469 6d65 5f73 7472 2c0a 2020  sed_time_str,.  
-00012590: 2020 290a 0a0a 6465 6620 6372 6f70 5f6d    )...def crop_m
-000125a0: 756c 7469 706c 655f 7669 6465 6f73 5f63  ultiple_videos_c
-000125b0: 6972 636c 6573 280a 2020 2020 696e 5f64  ircles(.    in_d
-000125c0: 6972 3a20 556e 696f 6e5b 7374 722c 206f  ir: Union[str, o
-000125d0: 732e 5061 7468 4c69 6b65 5d2c 206f 7574  s.PathLike], out
-000125e0: 5f64 6972 3a20 556e 696f 6e5b 7374 722c  _dir: Union[str,
-000125f0: 206f 732e 5061 7468 4c69 6b65 5d0a 2920   os.PathLike].) 
-00012600: 2d3e 204e 6f6e 653a 0a20 2020 2022 2222  -> None:.    """
-00012610: 0a20 2020 2043 726f 7020 6d75 6c74 6970  .    Crop multip
-00012620: 6c65 2076 6964 656f 7320 6261 7365 6420  le videos based 
-00012630: 6f6e 2063 6972 6375 6c61 7220 7265 6769  on circular regi
-00012640: 6f6e 7320 6f66 2069 6e74 6572 6573 7420  ons of interest 
-00012650: 2852 4f49 7329 2073 656c 6563 7465 6420  (ROIs) selected 
-00012660: 6279 2074 6865 2075 7365 722e 0a0a 2020  by the user...  
-00012670: 2020 3a70 6172 616d 2020 556e 696f 6e5b    :param  Union[
-00012680: 7374 722c 206f 732e 5061 7468 4c69 6b65  str, os.PathLike
-00012690: 5d20 696e 5f64 6972 3a20 5468 6520 6469  ] in_dir: The di
-000126a0: 7265 6374 6f72 7920 636f 6e74 6169 6e69  rectory containi
-000126b0: 6e67 2069 6e70 7574 2076 6964 656f 2066  ng input video f
-000126c0: 696c 6573 2e0a 2020 2020 3a70 6172 616d  iles..    :param
-000126d0: 2020 556e 696f 6e5b 7374 722c 206f 732e    Union[str, os.
-000126e0: 5061 7468 4c69 6b65 5d20 6f75 745f 6469  PathLike] out_di
-000126f0: 723a 2054 6865 2064 6972 6563 746f 7279  r: The directory
-00012700: 2074 6f20 7361 7665 2074 6865 2063 726f   to save the cro
-00012710: 7070 6564 2076 6964 656f 2066 696c 6573  pped video files
-00012720: 2e0a 0a20 2020 202e 2e20 6e6f 7465 3a3a  ...    .. note::
-00012730: 0a20 2020 2020 2020 5468 6973 2066 756e  .       This fun
-00012740: 6374 696f 6e20 6372 6f70 7320 6d75 6c74  ction crops mult
-00012750: 6970 6c65 2076 6964 656f 7320 6261 7365  iple videos base
-00012760: 6420 6f6e 2063 6972 6375 6c61 7220 524f  d on circular RO
-00012770: 4973 2073 656c 6563 7465 6420 6279 2074  Is selected by t
-00012780: 6865 2075 7365 722e 0a20 2020 2020 2020  he user..       
-00012790: 5468 6520 7573 6572 2069 7320 6173 6b65  The user is aske
-000127a0: 6420 746f 2064 6566 696e 6520 6120 6369  d to define a ci
-000127b0: 7263 6c65 206d 616e 7561 6c6c 7920 696e  rcle manually in
-000127c0: 206f 6e65 2076 6964 656f 2077 6974 6869   one video withi
-000127d0: 6e20 7468 6520 696e 7075 7420 6469 7265  n the input dire
-000127e0: 6374 6f72 792e 0a20 2020 2020 2020 5468  ctory..       Th
-000127f0: 6520 6675 6e63 7469 6f6e 2074 6865 6e20  e function then 
-00012800: 6372 6f70 7320 616c 6c20 7468 6520 7669  crops all the vi
-00012810: 6465 6f20 696e 2074 6865 2069 6e70 7574  deo in the input
-00012820: 2064 6972 6563 746f 7279 2061 6363 6f72   directory accor
-00012830: 6469 6e67 2074 6f20 7468 6520 7368 6170  ding to the shap
-00012840: 6520 6465 6669 6e65 640a 2020 2020 2020  e defined.      
-00012850: 2075 7369 6e67 2074 6865 2066 6972 7374   using the first
-00012860: 2076 6964 656f 2061 6e64 2073 6176 6573   video and saves
-00012870: 2074 6865 2076 6964 656f 7320 696e 2074   the videos in t
-00012880: 6865 2060 606f 7574 5f64 6972 6060 2077  he ``out_dir`` w
-00012890: 6974 6820 7468 6520 7361 6d65 2066 696c  ith the same fil
-000128a0: 656e 616d 6573 2061 7320 7468 6520 6f72  enames as the or
-000128b0: 6967 696e 616c 2076 6964 656f 732e 2e0a  iginal videos...
-000128c0: 0a20 2020 203a 6578 616d 706c 653a 0a20  .    :example:. 
-000128d0: 2020 203e 3e3e 2063 726f 705f 6d75 6c74     >>> crop_mult
-000128e0: 6970 6c65 5f76 6964 656f 735f 6369 7263  iple_videos_circ
-000128f0: 6c65 7328 696e 5f64 6972 3d27 2f55 7365  les(in_dir='/Use
-00012900: 7273 2f73 696d 6f6e 2f44 6573 6b74 6f70  rs/simon/Desktop
-00012910: 2f65 6469 7465 642f 7465 7374 7327 2c20  /edited/tests', 
-00012920: 6f75 745f 6469 723d 272f 5573 6572 732f  out_dir='/Users/
-00012930: 7369 6d6f 6e2f 4465 736b 746f 7027 290a  simon/Desktop').
-00012940: 2020 2020 2222 220a 0a20 2020 2063 6865      """..    che
-00012950: 636b 5f69 665f 6469 725f 6578 6973 7473  ck_if_dir_exists
-00012960: 2869 6e5f 6469 723d 696e 5f64 6972 290a  (in_dir=in_dir).
-00012970: 2020 2020 6368 6563 6b5f 6966 5f64 6972      check_if_dir
-00012980: 5f65 7869 7374 7328 696e 5f64 6972 3d6f  _exists(in_dir=o
-00012990: 7574 5f64 6972 290a 2020 2020 7669 6465  ut_dir).    vide
-000129a0: 6f5f 6669 6c65 7320 3d20 6669 6e64 5f61  o_files = find_a
-000129b0: 6c6c 5f76 6964 656f 735f 696e 5f64 6972  ll_videos_in_dir
-000129c0: 6563 746f 7279 2864 6972 6563 746f 7279  ectory(directory
-000129d0: 3d69 6e5f 6469 7229 0a20 2020 2063 6972  =in_dir).    cir
-000129e0: 636c 655f 7365 6c65 6374 6f72 203d 2052  cle_selector = R
-000129f0: 4f49 5365 6c65 6374 6f72 4369 7263 6c65  OISelectorCircle
-00012a00: 2870 6174 683d 6f73 2e70 6174 682e 6a6f  (path=os.path.jo
-00012a10: 696e 2869 6e5f 6469 722c 2076 6964 656f  in(in_dir, video
-00012a20: 5f66 696c 6573 5b30 5d29 290a 2020 2020  _files[0])).    
-00012a30: 6369 7263 6c65 5f73 656c 6563 746f 722e  circle_selector.
-00012a40: 7275 6e28 290a 2020 2020 7220 3d20 6369  run().    r = ci
-00012a50: 7263 6c65 5f73 656c 6563 746f 722e 6369  rcle_selector.ci
-00012a60: 7263 6c65 5f72 6164 6975 730a 2020 2020  rcle_radius.    
-00012a70: 782c 2079 203d 2063 6972 636c 655f 7365  x, y = circle_se
-00012a80: 6c65 6374 6f72 2e63 6972 636c 655f 6365  lector.circle_ce
-00012a90: 6e74 6572 5b30 5d2c 2063 6972 636c 655f  nter[0], circle_
-00012aa0: 7365 6c65 6374 6f72 2e63 6972 636c 655f  selector.circle_
-00012ab0: 6365 6e74 6572 5b31 5d0a 2020 2020 706f  center[1].    po
-00012ac0: 6c79 676f 6e20 3d20 506f 6c79 676f 6e28  lygon = Polygon(
-00012ad0: 0a20 2020 2020 2020 205b 0a20 2020 2020  .        [.     
-00012ae0: 2020 2020 2020 2028 7820 2b20 7220 2a20         (x + r * 
-00012af0: 6e70 2e63 6f73 2861 6e67 6c65 292c 2079  np.cos(angle), y
-00012b00: 202b 2072 202a 206e 702e 7369 6e28 616e   + r * np.sin(an
-00012b10: 676c 6529 290a 2020 2020 2020 2020 2020  gle)).          
-00012b20: 2020 666f 7220 616e 676c 6520 696e 206e    for angle in n
-00012b30: 702e 6c69 6e73 7061 6365 2830 2c20 3220  p.linspace(0, 2 
-00012b40: 2a20 6e70 2e70 692c 2031 3030 290a 2020  * np.pi, 100).  
-00012b50: 2020 2020 2020 5d0a 2020 2020 290a 2020        ].    ).  
-00012b60: 2020 7469 6d65 7220 3d20 5369 6d62 6154    timer = SimbaT
-00012b70: 696d 6572 2873 7461 7274 3d54 7275 6529  imer(start=True)
-00012b80: 0a20 2020 2069 6620 2870 6c61 7466 6f72  .    if (platfor
-00012b90: 6d2e 7379 7374 656d 2829 203d 3d20 2244  m.system() == "D
-00012ba0: 6172 7769 6e22 2920 616e 6420 286d 756c  arwin") and (mul
-00012bb0: 7469 7072 6f63 6573 7369 6e67 2e67 6574  tiprocessing.get
-00012bc0: 5f73 7461 7274 5f6d 6574 686f 6428 2920  _start_method() 
-00012bd0: 6973 204e 6f6e 6529 3a0a 2020 2020 2020  is None):.      
-00012be0: 2020 6d75 6c74 6970 726f 6365 7373 696e    multiprocessin
-00012bf0: 672e 7365 745f 7374 6172 745f 6d65 7468  g.set_start_meth
-00012c00: 6f64 2822 7370 6177 6e22 2c20 666f 7263  od("spawn", forc
-00012c10: 653d 4661 6c73 6529 0a20 2020 2066 6f72  e=False).    for
-00012c20: 2076 6964 656f 5f63 6e74 2c20 7669 6465   video_cnt, vide
-00012c30: 6f5f 7061 7468 2069 6e20 656e 756d 6572  o_path in enumer
-00012c40: 6174 6528 7669 6465 6f5f 6669 6c65 7329  ate(video_files)
-00012c50: 3a0a 2020 2020 2020 2020 7072 696e 7428  :.        print(
-00012c60: 0a20 2020 2020 2020 2020 2020 2066 2243  .            f"C
-00012c70: 6972 636c 6520 6372 6f70 7069 6e67 2076  ircle cropping v
-00012c80: 6964 656f 207b 7669 6465 6f5f 7061 7468  ideo {video_path
-00012c90: 7d20 287b 7669 6465 6f5f 636e 742b 317d  } ({video_cnt+1}
-00012ca0: 2f7b 6c65 6e28 7669 6465 6f5f 6669 6c65  /{len(video_file
-00012cb0: 7329 7d29 2e2e 2e22 0a20 2020 2020 2020  s)})...".       
-00012cc0: 2029 0a20 2020 2020 2020 2076 6964 656f   ).        video
-00012cd0: 5f70 6174 6820 3d20 6f73 2e70 6174 682e  _path = os.path.
-00012ce0: 6a6f 696e 2869 6e5f 6469 722c 2076 6964  join(in_dir, vid
-00012cf0: 656f 5f70 6174 6829 0a20 2020 2020 2020  eo_path).       
-00012d00: 205f 2c20 7669 6465 6f5f 6e61 6d65 2c20   _, video_name, 
-00012d10: 5f20 3d20 6765 745f 666e 5f65 7874 2866  _ = get_fn_ext(f
-00012d20: 696c 6570 6174 683d 7669 6465 6f5f 7061  ilepath=video_pa
-00012d30: 7468 290a 2020 2020 2020 2020 7361 7665  th).        save
-00012d40: 5f70 6174 6820 3d20 6f73 2e70 6174 682e  _path = os.path.
-00012d50: 6a6f 696e 286f 7574 5f64 6972 2c20 6622  join(out_dir, f"
-00012d60: 7b76 6964 656f 5f6e 616d 657d 2e6d 7034  {video_name}.mp4
-00012d70: 2229 0a20 2020 2020 2020 2076 6964 656f  ").        video
-00012d80: 5f6d 6574 615f 6461 7461 203d 2067 6574  _meta_data = get
-00012d90: 5f76 6964 656f 5f6d 6574 615f 6461 7461  _video_meta_data
-00012da0: 2876 6964 656f 5f70 6174 683d 7669 6465  (video_path=vide
-00012db0: 6f5f 7061 7468 290a 2020 2020 2020 2020  o_path).        
-00012dc0: 706f 6c79 676f 6e73 203d 205b 706f 6c79  polygons = [poly
-00012dd0: 676f 6e20 666f 7220 7820 696e 2072 616e  gon for x in ran
-00012de0: 6765 2876 6964 656f 5f6d 6574 615f 6461  ge(video_meta_da
-00012df0: 7461 5b22 6672 616d 655f 636f 756e 7422  ta["frame_count"
-00012e00: 5d29 5d0a 2020 2020 2020 2020 706f 6c79  ])].        poly
-00012e10: 676f 6e73 203d 2049 6d61 6765 4d69 7869  gons = ImageMixi
-00012e20: 6e28 292e 736c 6963 655f 7368 6170 6573  n().slice_shapes
-00012e30: 5f69 6e5f 696d 6773 280a 2020 2020 2020  _in_imgs(.      
-00012e40: 2020 2020 2020 696d 6773 3d76 6964 656f        imgs=video
-00012e50: 5f70 6174 682c 2073 6861 7065 733d 706f  _path, shapes=po
-00012e60: 6c79 676f 6e73 2c20 7665 7262 6f73 653d  lygons, verbose=
-00012e70: 4661 6c73 650a 2020 2020 2020 2020 290a  False.        ).
-00012e80: 2020 2020 2020 2020 7469 6d65 2e73 6c65          time.sle
-00012e90: 6570 2831 290a 2020 2020 2020 2020 5f20  ep(1).        _ 
-00012ea0: 3d20 496d 6167 654d 6978 696e 2e69 6d67  = ImageMixin.img
-00012eb0: 5f73 7461 636b 5f74 6f5f 7669 6465 6f28  _stack_to_video(
-00012ec0: 0a20 2020 2020 2020 2020 2020 2069 6d67  .            img
-00012ed0: 733d 706f 6c79 676f 6e73 2c20 7361 7665  s=polygons, save
-00012ee0: 5f70 6174 683d 7361 7665 5f70 6174 682c  _path=save_path,
-00012ef0: 2066 7073 3d76 6964 656f 5f6d 6574 615f   fps=video_meta_
-00012f00: 6461 7461 5b22 6670 7322 5d0a 2020 2020  data["fps"].    
-00012f10: 2020 2020 290a 2020 2020 7469 6d65 722e      ).    timer.
-00012f20: 7374 6f70 5f74 696d 6572 2829 0a20 2020  stop_timer().   
-00012f30: 2073 7464 6f75 745f 7375 6363 6573 7328   stdout_success(
-00012f40: 0a20 2020 2020 2020 206d 7367 3d66 2243  .        msg=f"C
-00012f50: 6972 636c 652d 6261 7365 6420 6372 6f70  ircle-based crop
-00012f60: 7065 6420 7b6c 656e 2876 6964 656f 5f66  ped {len(video_f
-00012f70: 696c 6573 297d 2066 696c 6573 2074 6f20  iles)} files to 
-00012f80: 6469 7265 6374 6f72 7920 7b6f 7574 5f64  directory {out_d
-00012f90: 6972 7d22 2c0a 2020 2020 2020 2020 656c  ir}",.        el
-00012fa0: 6170 7365 645f 7469 6d65 3d74 696d 6572  apsed_time=timer
-00012fb0: 2e65 6c61 7073 6564 5f74 696d 655f 7374  .elapsed_time_st
-00012fc0: 722c 0a20 2020 2029 0a0a 0a64 6566 2063  r,.    )...def c
-00012fd0: 726f 705f 7369 6e67 6c65 5f76 6964 656f  rop_single_video
-00012fe0: 5f70 6f6c 7967 6f6e 2866 696c 655f 7061  _polygon(file_pa
-00012ff0: 7468 3a20 556e 696f 6e5b 7374 722c 206f  th: Union[str, o
-00013000: 732e 5061 7468 4c69 6b65 5d29 202d 3e20  s.PathLike]) -> 
-00013010: 4e6f 6e65 3a0a 2020 2020 2222 220a 2020  None:.    """.  
-00013020: 2020 4372 6f70 2061 2076 6964 656f 2062    Crop a video b
-00013030: 6173 6564 206f 6e20 706f 6c79 676f 6e61  ased on polygona
-00013040: 6c20 7265 6769 6f6e 7320 6f66 2069 6e74  l regions of int
-00013050: 6572 6573 7420 2852 4f49 7329 2073 656c  erest (ROIs) sel
-00013060: 6563 7465 6420 6279 2074 6865 2075 7365  ected by the use
-00013070: 722e 0a0a 2020 2020 3a70 6172 616d 2020  r...    :param  
-00013080: 556e 696f 6e5b 7374 722c 206f 732e 5061  Union[str, os.Pa
-00013090: 7468 4c69 6b65 5d20 6669 6c65 5f70 6174  thLike] file_pat
-000130a0: 683a 2054 6865 2070 6174 6820 746f 2074  h: The path to t
-000130b0: 6865 2069 6e70 7574 2076 6964 656f 2066  he input video f
-000130c0: 696c 652e 0a0a 2020 2020 2e2e 206e 6f74  ile...    .. not
-000130d0: 653a 3a0a 2020 2020 2020 2054 6869 7320  e::.       This 
-000130e0: 6675 6e63 7469 6f6e 2063 726f 7073 2074  function crops t
-000130f0: 6865 2069 6e70 7574 2076 6964 656f 2062  he input video b
-00013100: 6173 6564 206f 6e20 706f 6c79 676f 6e61  ased on polygona
-00013110: 6c20 7265 6769 6f6e 7320 6f66 2069 6e74  l regions of int
-00013120: 6572 6573 7420 2852 4f49 7329 2073 656c  erest (ROIs) sel
-00013130: 6563 7465 6420 6279 2074 6865 2075 7365  ected by the use
-00013140: 722e 0a20 2020 2020 2020 5468 6520 7573  r..       The us
-00013150: 6572 2069 7320 7072 6f6d 7074 6564 2074  er is prompted t
-00013160: 6f20 7365 6c65 6374 2061 2070 6f6c 7967  o select a polyg
-00013170: 6f6e 616c 2052 4f49 206f 6e20 7468 6520  onal ROI on the 
-00013180: 7669 6465 6f20 6672 616d 652c 2061 6e64  video frame, and
-00013190: 2074 6865 2066 756e 6374 696f 6e20 7468   the function th
-000131a0: 656e 2063 726f 7073 2074 6865 2076 6964  en crops the vid
-000131b0: 656f 0a20 2020 2020 2020 6261 7365 6420  eo.       based 
-000131c0: 6f6e 2074 6865 2073 656c 6563 7465 6420  on the selected 
-000131d0: 524f 492e 2054 6865 2063 726f 7070 6564  ROI. The cropped
-000131e0: 2076 6964 656f 2069 7320 7361 7665 6420   video is saved 
-000131f0: 7769 7468 2022 5f70 6f6c 7967 6f6e 5f63  with "_polygon_c
-00013200: 726f 7070 6564 2220 7375 6666 6978 2069  ropped" suffix i
-00013210: 6e20 7468 6520 7361 6d65 2064 6972 6563  n the same direc
-00013220: 746f 7279 0a20 2020 2020 2020 6173 2074  tory.       as t
-00013230: 6865 2069 6e70 7574 2076 6964 656f 2066  he input video f
-00013240: 696c 652e 0a0a 2020 2020 3a65 7861 6d70  ile...    :examp
-00013250: 6c65 3a0a 2020 2020 3e3e 3e20 6372 6f70  le:.    >>> crop
-00013260: 5f73 696e 676c 655f 7669 6465 6f5f 706f  _single_video_po
-00013270: 6c79 676f 6e28 6669 6c65 5f70 6174 683d  lygon(file_path=
-00013280: 272f 5573 6572 732f 7369 6d6f 6e2f 4465  '/Users/simon/De
-00013290: 736b 746f 702f 4147 4752 4553 5349 5649  sktop/AGGRESSIVI
-000132a0: 5459 5f34 5f31 315f 3231 5f54 7269 616c  TY_4_11_21_Trial
-000132b0: 5f32 5f63 616d 6572 6131 5f72 6f74 6174  _2_camera1_rotat
-000132c0: 6564 5f32 3032 3430 3231 3131 3433 3335  ed_2024021114335
-000132d0: 352e 6d70 3427 290a 2020 2020 2222 220a  5.mp4').    """.
-000132e0: 0a20 2020 2064 6972 2c20 7669 6465 6f5f  .    dir, video_
-000132f0: 6e61 6d65 2c20 5f20 3d20 6765 745f 666e  name, _ = get_fn
-00013300: 5f65 7874 2866 696c 6570 6174 683d 6669  _ext(filepath=fi
-00013310: 6c65 5f70 6174 6829 0a20 2020 2073 6176  le_path).    sav
-00013320: 655f 7061 7468 203d 206f 732e 7061 7468  e_path = os.path
-00013330: 2e6a 6f69 6e28 6469 722c 2066 227b 7669  .join(dir, f"{vi
-00013340: 6465 6f5f 6e61 6d65 7d5f 706f 6c79 676f  deo_name}_polygo
-00013350: 6e5f 6372 6f70 7065 642e 6d70 3422 290a  n_cropped.mp4").
-00013360: 2020 2020 7669 6465 6f5f 6d65 7461 5f64      video_meta_d
-00013370: 6174 6120 3d20 6765 745f 7669 6465 6f5f  ata = get_video_
-00013380: 6d65 7461 5f64 6174 6128 7669 6465 6f5f  meta_data(video_
-00013390: 7061 7468 3d66 696c 655f 7061 7468 290a  path=file_path).
-000133a0: 2020 2020 6368 6563 6b5f 6669 6c65 5f65      check_file_e
-000133b0: 7869 7374 5f61 6e64 5f72 6561 6461 626c  xist_and_readabl
-000133c0: 6528 6669 6c65 5f70 6174 683d 6669 6c65  e(file_path=file
-000133d0: 5f70 6174 6829 0a20 2020 2070 6f6c 7967  _path).    polyg
-000133e0: 6f6e 5f73 656c 6563 746f 7220 3d20 524f  on_selector = RO
-000133f0: 4953 656c 6563 746f 7250 6f6c 7967 6f6e  ISelectorPolygon
-00013400: 2870 6174 683d 6669 6c65 5f70 6174 6829  (path=file_path)
-00013410: 0a20 2020 2070 6f6c 7967 6f6e 5f73 656c  .    polygon_sel
-00013420: 6563 746f 722e 7275 6e28 290a 2020 2020  ector.run().    
-00013430: 7469 6d65 7220 3d20 5369 6d62 6154 696d  timer = SimbaTim
-00013440: 6572 2873 7461 7274 3d54 7275 6529 0a20  er(start=True). 
-00013450: 2020 2076 6572 7469 6365 7320 3d20 706f     vertices = po
-00013460: 6c79 676f 6e5f 7365 6c65 6374 6f72 2e70  lygon_selector.p
-00013470: 6f6c 7967 6f6e 5f76 6572 7469 6365 730a  olygon_vertices.
-00013480: 2020 2020 706f 6c79 676f 6e20 3d20 506f      polygon = Po
-00013490: 6c79 676f 6e28 7665 7274 6963 6573 290a  lygon(vertices).
-000134a0: 2020 2020 706f 6c79 676f 6e73 203d 205b      polygons = [
-000134b0: 706f 6c79 676f 6e20 666f 7220 7820 696e  polygon for x in
-000134c0: 2072 616e 6765 2876 6964 656f 5f6d 6574   range(video_met
-000134d0: 615f 6461 7461 5b22 6672 616d 655f 636f  a_data["frame_co
-000134e0: 756e 7422 5d29 5d0a 2020 2020 6966 2028  unt"])].    if (
-000134f0: 706c 6174 666f 726d 2e73 7973 7465 6d28  platform.system(
-00013500: 2920 3d3d 2022 4461 7277 696e 2229 2061  ) == "Darwin") a
-00013510: 6e64 2028 6d75 6c74 6970 726f 6365 7373  nd (multiprocess
-00013520: 696e 672e 6765 745f 7374 6172 745f 6d65  ing.get_start_me
-00013530: 7468 6f64 2829 2069 7320 4e6f 6e65 293a  thod() is None):
-00013540: 0a20 2020 2020 2020 206d 756c 7469 7072  .        multipr
-00013550: 6f63 6573 7369 6e67 2e73 6574 5f73 7461  ocessing.set_sta
-00013560: 7274 5f6d 6574 686f 6428 2273 7061 776e  rt_method("spawn
-00013570: 222c 2066 6f72 6365 3d46 616c 7365 290a  ", force=False).
-00013580: 2020 2020 706f 6c79 676f 6e73 203d 2049      polygons = I
-00013590: 6d61 6765 4d69 7869 6e28 292e 736c 6963  mageMixin().slic
-000135a0: 655f 7368 6170 6573 5f69 6e5f 696d 6773  e_shapes_in_imgs
-000135b0: 280a 2020 2020 2020 2020 696d 6773 3d66  (.        imgs=f
-000135c0: 696c 655f 7061 7468 2c20 7368 6170 6573  ile_path, shapes
-000135d0: 3d70 6f6c 7967 6f6e 732c 2076 6572 626f  =polygons, verbo
-000135e0: 7365 3d54 7275 650a 2020 2020 290a 2020  se=True.    ).  
-000135f0: 2020 5f20 3d20 496d 6167 654d 6978 696e    _ = ImageMixin
-00013600: 2e69 6d67 5f73 7461 636b 5f74 6f5f 7669  .img_stack_to_vi
-00013610: 6465 6f28 0a20 2020 2020 2020 2069 6d67  deo(.        img
-00013620: 733d 706f 6c79 676f 6e73 2c20 7361 7665  s=polygons, save
-00013630: 5f70 6174 683d 7361 7665 5f70 6174 682c  _path=save_path,
-00013640: 2066 7073 3d76 6964 656f 5f6d 6574 615f   fps=video_meta_
-00013650: 6461 7461 5b22 6670 7322 5d0a 2020 2020  data["fps"].    
-00013660: 290a 2020 2020 7469 6d65 722e 7374 6f70  ).    timer.stop
-00013670: 5f74 696d 6572 2829 0a20 2020 2073 7464  _timer().    std
-00013680: 6f75 745f 7375 6363 6573 7328 0a20 2020  out_success(.   
-00013690: 2020 2020 206d 7367 3d66 2250 6f6c 7967       msg=f"Polyg
-000136a0: 6f6e 2d62 6173 6564 2063 726f 7070 6564  on-based cropped
-000136b0: 2073 6176 6564 2061 7420 746f 207b 7361   saved at to {sa
-000136c0: 7665 5f70 6174 687d 222c 0a20 2020 2020  ve_path}",.     
-000136d0: 2020 2065 6c61 7073 6564 5f74 696d 653d     elapsed_time=
-000136e0: 7469 6d65 722e 656c 6170 7365 645f 7469  timer.elapsed_ti
-000136f0: 6d65 5f73 7472 2c0a 2020 2020 290a 0a0a  me_str,.    )...
-00013700: 6465 6620 6372 6f70 5f6d 756c 7469 706c  def crop_multipl
-00013710: 655f 7669 6465 6f73 5f70 6f6c 7967 6f6e  e_videos_polygon
-00013720: 7328 0a20 2020 2069 6e5f 6469 723a 2055  s(.    in_dir: U
-00013730: 6e69 6f6e 5b73 7472 2c20 6f73 2e50 6174  nion[str, os.Pat
-00013740: 684c 696b 655d 2c20 6f75 745f 6469 723a  hLike], out_dir:
-00013750: 2055 6e69 6f6e 5b73 7472 2c20 6f73 2e50   Union[str, os.P
-00013760: 6174 684c 696b 655d 0a29 202d 3e20 4e6f  athLike].) -> No
-00013770: 6e65 3a0a 2020 2020 2222 220a 2020 2020  ne:.    """.    
-00013780: 4372 6f70 206d 756c 7469 706c 6520 7669  Crop multiple vi
-00013790: 6465 6f73 2062 6173 6564 206f 6e20 706f  deos based on po
-000137a0: 6c79 676f 6e61 6c20 7265 6769 6f6e 7320  lygonal regions 
-000137b0: 6f66 2069 6e74 6572 6573 7420 2852 4f49  of interest (ROI
-000137c0: 7329 2073 656c 6563 7465 6420 6279 2074  s) selected by t
-000137d0: 6865 2075 7365 722e 0a0a 2020 2020 3a70  he user...    :p
-000137e0: 6172 616d 2020 556e 696f 6e5b 7374 722c  aram  Union[str,
-000137f0: 206f 732e 5061 7468 4c69 6b65 5d20 696e   os.PathLike] in
-00013800: 5f64 6972 3a20 5468 6520 6469 7265 6374  _dir: The direct
-00013810: 6f72 7920 636f 6e74 6169 6e69 6e67 2069  ory containing i
-00013820: 6e70 7574 2076 6964 656f 2066 696c 6573  nput video files
-00013830: 2e0a 2020 2020 3a70 6172 616d 2020 556e  ..    :param  Un
-00013840: 696f 6e5b 7374 722c 206f 732e 5061 7468  ion[str, os.Path
-00013850: 4c69 6b65 5d20 6f75 745f 6469 723a 2054  Like] out_dir: T
-00013860: 6865 2064 6972 6563 746f 7279 2074 6f20  he directory to 
-00013870: 7361 7665 2074 6865 2063 726f 7070 6564  save the cropped
-00013880: 2076 6964 656f 2066 696c 6573 2e0a 0a20   video files... 
-00013890: 2020 202e 2e20 6e6f 7465 3a3a 0a20 2020     .. note::.   
-000138a0: 2020 2020 5468 6973 2066 756e 6374 696f      This functio
-000138b0: 6e20 6372 6f70 7320 6d75 6c74 6970 6c65  n crops multiple
-000138c0: 2076 6964 656f 7320 6261 7365 6420 6f6e   videos based on
-000138d0: 2070 6f6c 7967 6f6e 616c 2052 4f49 7320   polygonal ROIs 
-000138e0: 7365 6c65 6374 6564 2062 7920 7468 6520  selected by the 
-000138f0: 7573 6572 2e0a 2020 2020 2020 2054 6865  user..       The
-00013900: 2075 7365 7220 6973 2061 736b 6564 2074   user is asked t
-00013910: 6f20 6465 6669 6e65 2061 2070 6f6c 7967  o define a polyg
-00013920: 6f6e 206d 616e 7561 6c6c 7920 696e 206f  on manually in o
-00013930: 6e65 2076 6964 656f 2077 6974 6869 6e20  ne video within 
-00013940: 7468 6520 696e 7075 7420 6469 7265 6374  the input direct
-00013950: 6f72 792e 0a20 2020 2020 2020 5468 6520  ory..       The 
-00013960: 6675 6e63 7469 6f6e 2074 6865 6e20 6372  function then cr
-00013970: 6f70 7320 616c 6c20 7468 6520 7669 6465  ops all the vide
-00013980: 6f20 696e 2074 6865 2069 6e70 7574 2064  o in the input d
-00013990: 6972 6563 746f 7279 2061 6363 6f72 6469  irectory accordi
-000139a0: 6e67 2074 6f20 7468 6520 7368 6170 6520  ng to the shape 
-000139b0: 6465 6669 6e65 640a 2020 2020 2020 2075  defined.       u
-000139c0: 7369 6e67 2074 6865 2066 6972 7374 2076  sing the first v
-000139d0: 6964 656f 2061 6e64 2073 6176 6573 2074  ideo and saves t
-000139e0: 6865 2076 6964 656f 7320 696e 2074 6865  he videos in the
-000139f0: 2060 606f 7574 5f64 6972 6060 2077 6974   ``out_dir`` wit
-00013a00: 6820 7468 6520 7361 6d65 2066 696c 656e  h the same filen
-00013a10: 616d 6573 2061 7320 7468 6520 6f72 6967  ames as the orig
-00013a20: 696e 616c 2076 6964 656f 732e 2e0a 0a20  inal videos.... 
-00013a30: 2020 203a 6578 616d 706c 653a 0a20 2020     :example:.   
-00013a40: 203e 3e3e 2063 726f 705f 6d75 6c74 6970   >>> crop_multip
-00013a50: 6c65 5f76 6964 656f 735f 706f 6c79 676f  le_videos_polygo
-00013a60: 6e73 2869 6e5f 6469 723d 272f 5573 6572  ns(in_dir='/User
-00013a70: 732f 7369 6d6f 6e2f 4465 736b 746f 702f  s/simon/Desktop/
-00013a80: 6564 6974 6564 2f74 6573 7473 272c 206f  edited/tests', o
-00013a90: 7574 5f64 6972 3d27 2f55 7365 7273 2f73  ut_dir='/Users/s
-00013aa0: 696d 6f6e 2f44 6573 6b74 6f70 2729 0a20  imon/Desktop'). 
-00013ab0: 2020 2022 2222 0a0a 2020 2020 6368 6563     """..    chec
-00013ac0: 6b5f 6966 5f64 6972 5f65 7869 7374 7328  k_if_dir_exists(
-00013ad0: 696e 5f64 6972 3d69 6e5f 6469 7229 0a20  in_dir=in_dir). 
-00013ae0: 2020 2063 6865 636b 5f69 665f 6469 725f     check_if_dir_
-00013af0: 6578 6973 7473 2869 6e5f 6469 723d 6f75  exists(in_dir=ou
-00013b00: 745f 6469 7229 0a20 2020 2076 6964 656f  t_dir).    video
-00013b10: 5f66 696c 6573 203d 2066 696e 645f 616c  _files = find_al
-00013b20: 6c5f 7669 6465 6f73 5f69 6e5f 6469 7265  l_videos_in_dire
-00013b30: 6374 6f72 7928 6469 7265 6374 6f72 793d  ctory(directory=
-00013b40: 696e 5f64 6972 290a 2020 2020 706f 6c79  in_dir).    poly
-00013b50: 676f 6e5f 7365 6c65 6374 6f72 203d 2052  gon_selector = R
-00013b60: 4f49 5365 6c65 6374 6f72 506f 6c79 676f  OISelectorPolygo
-00013b70: 6e28 7061 7468 3d6f 732e 7061 7468 2e6a  n(path=os.path.j
-00013b80: 6f69 6e28 696e 5f64 6972 2c20 7669 6465  oin(in_dir, vide
-00013b90: 6f5f 6669 6c65 735b 305d 2929 0a20 2020  o_files[0])).   
-00013ba0: 2070 6f6c 7967 6f6e 5f73 656c 6563 746f   polygon_selecto
-00013bb0: 722e 7275 6e28 290a 2020 2020 7665 7274  r.run().    vert
-00013bc0: 6963 6573 203d 2070 6f6c 7967 6f6e 5f73  ices = polygon_s
-00013bd0: 656c 6563 746f 722e 706f 6c79 676f 6e5f  elector.polygon_
-00013be0: 7665 7274 6963 6573 0a20 2020 2070 6f6c  vertices.    pol
-00013bf0: 7967 6f6e 203d 2050 6f6c 7967 6f6e 2876  ygon = Polygon(v
-00013c00: 6572 7469 6365 7329 0a20 2020 2074 696d  ertices).    tim
-00013c10: 6572 203d 2053 696d 6261 5469 6d65 7228  er = SimbaTimer(
-00013c20: 7374 6172 743d 5472 7565 290a 2020 2020  start=True).    
-00013c30: 6966 2028 706c 6174 666f 726d 2e73 7973  if (platform.sys
-00013c40: 7465 6d28 2920 3d3d 2022 4461 7277 696e  tem() == "Darwin
-00013c50: 2229 2061 6e64 2028 6d75 6c74 6970 726f  ") and (multipro
-00013c60: 6365 7373 696e 672e 6765 745f 7374 6172  cessing.get_star
-00013c70: 745f 6d65 7468 6f64 2829 2069 7320 4e6f  t_method() is No
-00013c80: 6e65 293a 0a20 2020 2020 2020 206d 756c  ne):.        mul
-00013c90: 7469 7072 6f63 6573 7369 6e67 2e73 6574  tiprocessing.set
-00013ca0: 5f73 7461 7274 5f6d 6574 686f 6428 2273  _start_method("s
-00013cb0: 7061 776e 222c 2066 6f72 6365 3d54 7275  pawn", force=Tru
-00013cc0: 6529 0a20 2020 2066 6f72 2076 6964 656f  e).    for video
-00013cd0: 5f63 6e74 2c20 7669 6465 6f5f 7061 7468  _cnt, video_path
-00013ce0: 2069 6e20 656e 756d 6572 6174 6528 7669   in enumerate(vi
-00013cf0: 6465 6f5f 6669 6c65 7329 3a0a 2020 2020  deo_files):.    
-00013d00: 2020 2020 7072 696e 7428 0a20 2020 2020      print(.     
-00013d10: 2020 2020 2020 2066 2250 6f6c 7967 6f6e         f"Polygon
-00013d20: 2063 726f 7070 696e 6720 7669 6465 6f20   cropping video 
-00013d30: 7b76 6964 656f 5f70 6174 687d 2028 7b76  {video_path} ({v
-00013d40: 6964 656f 5f63 6e74 2b31 7d2f 7b6c 656e  ideo_cnt+1}/{len
-00013d50: 2876 6964 656f 5f66 696c 6573 297d 292e  (video_files)}).
-00013d60: 2e2e 220a 2020 2020 2020 2020 290a 2020  ..".        ).  
-00013d70: 2020 2020 2020 7669 6465 6f5f 7061 7468        video_path
-00013d80: 203d 206f 732e 7061 7468 2e6a 6f69 6e28   = os.path.join(
-00013d90: 696e 5f64 6972 2c20 7669 6465 6f5f 7061  in_dir, video_pa
-00013da0: 7468 290a 2020 2020 2020 2020 5f2c 2076  th).        _, v
-00013db0: 6964 656f 5f6e 616d 652c 205f 203d 2067  ideo_name, _ = g
-00013dc0: 6574 5f66 6e5f 6578 7428 6669 6c65 7061  et_fn_ext(filepa
-00013dd0: 7468 3d76 6964 656f 5f70 6174 6829 0a20  th=video_path). 
-00013de0: 2020 2020 2020 2073 6176 655f 7061 7468         save_path
-00013df0: 203d 206f 732e 7061 7468 2e6a 6f69 6e28   = os.path.join(
-00013e00: 6f75 745f 6469 722c 2066 227b 7669 6465  out_dir, f"{vide
-00013e10: 6f5f 6e61 6d65 7d2e 6d70 3422 290a 2020  o_name}.mp4").  
-00013e20: 2020 2020 2020 7669 6465 6f5f 6d65 7461        video_meta
-00013e30: 5f64 6174 6120 3d20 6765 745f 7669 6465  _data = get_vide
-00013e40: 6f5f 6d65 7461 5f64 6174 6128 7669 6465  o_meta_data(vide
-00013e50: 6f5f 7061 7468 3d76 6964 656f 5f70 6174  o_path=video_pat
-00013e60: 6829 0a20 2020 2020 2020 2070 6f6c 7967  h).        polyg
-00013e70: 6f6e 7320 3d20 5b70 6f6c 7967 6f6e 2066  ons = [polygon f
-00013e80: 6f72 2078 2069 6e20 7261 6e67 6528 7669  or x in range(vi
-00013e90: 6465 6f5f 6d65 7461 5f64 6174 615b 2266  deo_meta_data["f
-00013ea0: 7261 6d65 5f63 6f75 6e74 225d 295d 0a20  rame_count"])]. 
-00013eb0: 2020 2020 2020 2070 6f6c 7967 6f6e 7320         polygons 
-00013ec0: 3d20 496d 6167 654d 6978 696e 2829 2e73  = ImageMixin().s
-00013ed0: 6c69 6365 5f73 6861 7065 735f 696e 5f69  lice_shapes_in_i
-00013ee0: 6d67 7328 0a20 2020 2020 2020 2020 2020  mgs(.           
-00013ef0: 2069 6d67 733d 7669 6465 6f5f 7061 7468   imgs=video_path
-00013f00: 2c20 7368 6170 6573 3d70 6f6c 7967 6f6e  , shapes=polygon
-00013f10: 732c 2076 6572 626f 7365 3d46 616c 7365  s, verbose=False
-00013f20: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00013f30: 2020 205f 203d 2049 6d61 6765 4d69 7869     _ = ImageMixi
-00013f40: 6e2e 696d 675f 7374 6163 6b5f 746f 5f76  n.img_stack_to_v
-00013f50: 6964 656f 280a 2020 2020 2020 2020 2020  ideo(.          
-00013f60: 2020 696d 6773 3d70 6f6c 7967 6f6e 732c    imgs=polygons,
-00013f70: 2073 6176 655f 7061 7468 3d73 6176 655f   save_path=save_
-00013f80: 7061 7468 2c20 6670 733d 7669 6465 6f5f  path, fps=video_
-00013f90: 6d65 7461 5f64 6174 615b 2266 7073 225d  meta_data["fps"]
-00013fa0: 0a20 2020 2020 2020 2029 0a20 2020 2074  .        ).    t
-00013fb0: 696d 6572 2e73 746f 705f 7469 6d65 7228  imer.stop_timer(
-00013fc0: 290a 2020 2020 7374 646f 7574 5f73 7563  ).    stdout_suc
-00013fd0: 6365 7373 280a 2020 2020 2020 2020 6d73  cess(.        ms
-00013fe0: 673d 6622 506f 6c79 676f 6e2d 6261 7365  g=f"Polygon-base
-00013ff0: 6420 6372 6f70 7065 6420 7b6c 656e 2876  d cropped {len(v
-00014000: 6964 656f 5f66 696c 6573 297d 2066 696c  ideo_files)} fil
-00014010: 6573 2074 6f20 6469 7265 6374 6f72 7920  es to directory 
-00014020: 7b6f 7574 5f64 6972 7d22 2c0a 2020 2020  {out_dir}",.    
-00014030: 2020 2020 656c 6170 7365 645f 7469 6d65      elapsed_time
-00014040: 3d74 696d 6572 2e65 6c61 7073 6564 5f74  =timer.elapsed_t
-00014050: 696d 655f 7374 722c 0a20 2020 2029 0a    ime_str,.    ).
+00000570: 2020 2020 2020 2020 2020 2020 2020 496e                In
+00000580: 7661 6c69 6446 696c 6554 7970 6545 7272  validFileTypeErr
+00000590: 6f72 2c20 496e 7661 6c69 6449 6e70 7574  or, InvalidInput
+000005a0: 4572 726f 722c 0a20 2020 2020 2020 2020  Error,.         
+000005b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000005c0: 2020 2020 2020 2049 6e76 616c 6964 5669         InvalidVi
+000005d0: 6465 6f46 696c 6545 7272 6f72 2c20 4e6f  deoFileError, No
+000005e0: 4461 7461 4572 726f 722c 0a20 2020 2020  DataError,.     
+000005f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000600: 2020 2020 2020 2020 2020 204e 6f46 696c             NoFil
+00000610: 6573 466f 756e 6445 7272 6f72 2c20 4e6f  esFoundError, No
+00000620: 7444 6972 6563 746f 7279 4572 726f 7229  tDirectoryError)
+00000630: 0a66 726f 6d20 7369 6d62 612e 7574 696c  .from simba.util
+00000640: 732e 7072 696e 7469 6e67 2069 6d70 6f72  s.printing impor
+00000650: 7420 5369 6d62 6154 696d 6572 2c20 7374  t SimbaTimer, st
+00000660: 646f 7574 5f73 7563 6365 7373 0a66 726f  dout_success.fro
+00000670: 6d20 7369 6d62 612e 7574 696c 732e 7265  m simba.utils.re
+00000680: 6164 5f77 7269 7465 2069 6d70 6f72 7420  ad_write import 
+00000690: 280a 2020 2020 6368 6563 6b5f 6966 5f68  (.    check_if_h
+000006a0: 686d 6d73 735f 7469 6d65 7374 616d 705f  hmmss_timestamp_
+000006b0: 6973 5f76 616c 6964 5f70 6172 745f 6f66  is_valid_part_of
+000006c0: 5f76 6964 656f 2c0a 2020 2020 6669 6e64  _video,.    find
+000006d0: 5f61 6c6c 5f76 6964 656f 735f 696e 5f64  _all_videos_in_d
+000006e0: 6972 6563 746f 7279 2c20 6669 6e64 5f63  irectory, find_c
+000006f0: 6f72 655f 636e 742c 2067 6574 5f66 6e5f  ore_cnt, get_fn_
+00000700: 6578 742c 0a20 2020 2067 6574 5f76 6964  ext,.    get_vid
+00000710: 656f 5f6d 6574 615f 6461 7461 2c20 7265  eo_meta_data, re
+00000720: 6164 5f63 6f6e 6669 675f 656e 7472 792c  ad_config_entry,
+00000730: 2072 6561 645f 636f 6e66 6967 5f66 696c   read_config_fil
+00000740: 6529 0a66 726f 6d20 7369 6d62 612e 7574  e).from simba.ut
+00000750: 696c 732e 7761 726e 696e 6773 2069 6d70  ils.warnings imp
+00000760: 6f72 7420 2846 696c 6545 7869 7374 5761  ort (FileExistWa
+00000770: 726e 696e 672c 2049 6e56 616c 6964 5573  rning, InValidUs
+00000780: 6572 496e 7075 7457 6172 6e69 6e67 2c0a  erInputWarning,.
+00000790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000007a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000007b0: 2020 5361 6d65 496e 7075 7441 6e64 4f75    SameInputAndOu
+000007c0: 7470 7574 5761 726e 696e 6729 0a66 726f  tputWarning).fro
+000007d0: 6d20 7369 6d62 612e 7669 6465 6f5f 7072  m simba.video_pr
+000007e0: 6f63 6573 736f 7273 2e65 7874 7261 6374  ocessors.extract
+000007f0: 5f66 7261 6d65 7320 696d 706f 7274 2076  _frames import v
+00000800: 6964 656f 5f74 6f5f 6672 616d 6573 0a66  ideo_to_frames.f
+00000810: 726f 6d20 7369 6d62 612e 7669 6465 6f5f  rom simba.video_
+00000820: 7072 6f63 6573 736f 7273 2e72 6f69 5f73  processors.roi_s
+00000830: 656c 6563 746f 7220 696d 706f 7274 2052  elector import R
+00000840: 4f49 5365 6c65 6374 6f72 0a66 726f 6d20  OISelector.from 
+00000850: 7369 6d62 612e 7669 6465 6f5f 7072 6f63  simba.video_proc
+00000860: 6573 736f 7273 2e72 6f69 5f73 656c 6563  essors.roi_selec
+00000870: 746f 725f 6369 7263 6c65 2069 6d70 6f72  tor_circle impor
+00000880: 7420 524f 4953 656c 6563 746f 7243 6972  t ROISelectorCir
+00000890: 636c 650a 6672 6f6d 2073 696d 6261 2e76  cle.from simba.v
+000008a0: 6964 656f 5f70 726f 6365 7373 6f72 732e  ideo_processors.
+000008b0: 726f 695f 7365 6c65 6374 6f72 5f70 6f6c  roi_selector_pol
+000008c0: 7967 6f6e 2069 6d70 6f72 7420 524f 4953  ygon import ROIS
+000008d0: 656c 6563 746f 7250 6f6c 7967 6f6e 0a0a  electorPolygon..
+000008e0: 4d41 585f 4652 4d5f 5349 5a45 203d 2031  MAX_FRM_SIZE = 1
+000008f0: 3038 302c 2036 3530 0a0a 0a64 6566 2063  080, 650...def c
+00000900: 6861 6e67 655f 696d 675f 666f 726d 6174  hange_img_format
+00000910: 280a 2020 2020 6469 7265 6374 6f72 793a  (.    directory:
+00000920: 2055 6e69 6f6e 5b73 7472 2c20 6f73 2e50   Union[str, os.P
+00000930: 6174 684c 696b 655d 2c0a 2020 2020 6669  athLike],.    fi
+00000940: 6c65 5f74 7970 655f 696e 3a20 7374 722c  le_type_in: str,
+00000950: 0a20 2020 2066 696c 655f 7479 7065 5f6f  .    file_type_o
+00000960: 7574 3a20 7374 722c 0a20 2020 2076 6572  ut: str,.    ver
+00000970: 626f 7365 3a20 4f70 7469 6f6e 616c 5b62  bose: Optional[b
+00000980: 6f6f 6c5d 203d 2046 616c 7365 2c0a 2920  ool] = False,.) 
+00000990: 2d3e 204e 6f6e 653a 0a20 2020 2022 2222  -> None:.    """
+000009a0: 0a20 2020 2043 6f6e 7665 7274 2074 6865  .    Convert the
+000009b0: 2066 696c 6520 7479 7065 206f 6620 616c   file type of al
+000009c0: 6c20 696d 6167 6520 6669 6c65 7320 7769  l image files wi
+000009d0: 7468 696e 2061 2064 6972 6563 746f 7279  thin a directory
+000009e0: 2e0a 0a20 2020 203a 7061 7261 6d65 7465  ...    :paramete
+000009f0: 7220 556e 696f 6e5b 7374 722c 206f 732e  r Union[str, os.
+00000a00: 5061 7468 4c69 6b65 5d20 6469 7265 6374  PathLike] direct
+00000a10: 6f72 793a 2050 6174 6820 746f 2064 6972  ory: Path to dir
+00000a20: 6563 746f 7279 2068 6f6c 6469 6e67 2069  ectory holding i
+00000a30: 6d61 6765 2066 696c 6573 0a20 2020 203a  mage files.    :
+00000a40: 7061 7261 6d65 7465 7220 7374 7220 6669  parameter str fi
+00000a50: 6c65 5f74 7970 655f 696e 3a20 496e 7075  le_type_in: Inpu
+00000a60: 7420 6669 6c65 2074 7970 652c 2065 2e67  t file type, e.g
+00000a70: 2e2c 2027 626d 7027 206f 7220 2770 6e67  ., 'bmp' or 'png
+00000a80: 2e0a 2020 2020 3a70 6172 616d 6574 6572  ..    :parameter
+00000a90: 2073 7472 2066 696c 655f 7479 7065 5f6f   str file_type_o
+00000aa0: 7574 3a20 4f75 7470 7574 2066 696c 6520  ut: Output file 
+00000ab0: 7479 7065 2c20 652e 672e 2c20 2762 6d70  type, e.g., 'bmp
+00000ac0: 2720 6f72 2027 706e 672e 0a20 2020 203a  ' or 'png..    :
+00000ad0: 7061 7261 6d65 7465 7220 4f70 7469 6f6e  parameter Option
+00000ae0: 616c 5b62 6f6f 6c5d 2076 6572 626f 7365  al[bool] verbose
+00000af0: 3a20 4966 2054 7275 652c 2070 7269 6e74  : If True, print
+00000b00: 7320 7072 6f67 7265 7373 2e20 4465 6661  s progress. Defa
+00000b10: 756c 7420 4661 6c73 652e 0a0a 2020 2020  ult False...    
+00000b20: 3a65 7861 6d70 6c65 3a0a 2020 2020 3e3e  :example:.    >>
+00000b30: 3e20 5f20 3d20 6368 616e 6765 5f69 6d67  > _ = change_img
+00000b40: 5f66 6f72 6d61 7428 6469 7265 6374 6f72  _format(director
+00000b50: 793d 272f 5573 6572 732f 7369 6d6f 6e2f  y='/Users/simon/
+00000b60: 4465 736b 746f 702f 656e 7673 2f73 696d  Desktop/envs/sim
+00000b70: 6261 2f74 726f 7562 6c65 7368 6f6f 7469  ba/troubleshooti
+00000b80: 6e67 2f74 776f 5f62 6c61 636b 5f61 6e69  ng/two_black_ani
+00000b90: 6d61 6c73 5f31 3462 702f 7465 7374 5f69  mals_14bp/test_i
+00000ba0: 6d67 272c 2066 696c 655f 7479 7065 5f69  mg', file_type_i
+00000bb0: 6e3d 2770 6e67 272c 2066 696c 655f 7479  n='png', file_ty
+00000bc0: 7065 5f6f 7574 3d27 626d 7027 2c20 7665  pe_out='bmp', ve
+00000bd0: 7262 6f73 653d 5472 7565 290a 0a20 2020  rbose=True)..   
+00000be0: 2022 2222 0a20 2020 2063 6865 636b 5f69   """.    check_i
+00000bf0: 665f 6469 725f 6578 6973 7473 2869 6e5f  f_dir_exists(in_
+00000c00: 6469 723d 6469 7265 6374 6f72 792c 2073  dir=directory, s
+00000c10: 6f75 7263 653d 6368 616e 6765 5f69 6d67  ource=change_img
+00000c20: 5f66 6f72 6d61 742e 5f5f 6e61 6d65 5f5f  _format.__name__
+00000c30: 290a 2020 2020 6669 6c65 735f 666f 756e  ).    files_foun
+00000c40: 6420 3d20 676c 6f62 2e67 6c6f 6228 6469  d = glob.glob(di
+00000c50: 7265 6374 6f72 7920 2b20 6622 2f2a 2e7b  rectory + f"/*.{
+00000c60: 6669 6c65 5f74 7970 655f 696e 7d22 290a  file_type_in}").
+00000c70: 2020 2020 6966 206c 656e 2866 696c 6573      if len(files
+00000c80: 5f66 6f75 6e64 2920 3d3d 2030 3a0a 2020  _found) == 0:.  
+00000c90: 2020 2020 2020 7261 6973 6520 4e6f 4669        raise NoFi
+00000ca0: 6c65 7346 6f75 6e64 4572 726f 7228 0a20  lesFoundError(. 
+00000cb0: 2020 2020 2020 2020 2020 2066 2253 494d             f"SIM
+00000cc0: 4241 2045 5252 4f52 3a20 4e6f 207b 6669  BA ERROR: No {fi
+00000cd0: 6c65 5f74 7970 655f 696e 7d20 6669 6c65  le_type_in} file
+00000ce0: 7320 2877 6974 6820 2e7b 6669 6c65 5f74  s (with .{file_t
+00000cf0: 7970 655f 696e 7d20 6669 6c65 2065 7874  ype_in} file ext
+00000d00: 656e 7369 6f6e 2920 666f 756e 6420 696e  ension) found in
+00000d10: 2074 6865 207b 6469 7265 6374 6f72 797d   the {directory}
+00000d20: 2064 6972 6563 746f 7279 222c 0a20 2020   directory",.   
+00000d30: 2020 2020 2020 2020 2073 6f75 7263 653d           source=
+00000d40: 6368 616e 6765 5f69 6d67 5f66 6f72 6d61  change_img_forma
+00000d50: 742e 5f5f 6e61 6d65 5f5f 2c0a 2020 2020  t.__name__,.    
+00000d60: 2020 2020 290a 2020 2020 7072 696e 7428      ).    print(
+00000d70: 6622 7b6c 656e 2866 696c 6573 5f66 6f75  f"{len(files_fou
+00000d80: 6e64 297d 2069 6d61 6765 2066 696c 6573  nd)} image files
+00000d90: 2066 6f75 6e64 2069 6e20 7b64 6972 6563   found in {direc
+00000da0: 746f 7279 7d2e 2e2e 2229 0a20 2020 2066  tory}...").    f
+00000db0: 6f72 2066 696c 655f 636e 742c 2066 696c  or file_cnt, fil
+00000dc0: 655f 7061 7468 2069 6e20 656e 756d 6572  e_path in enumer
+00000dd0: 6174 6528 6669 6c65 735f 666f 756e 6429  ate(files_found)
+00000de0: 3a0a 2020 2020 2020 2020 6966 2076 6572  :.        if ver
+00000df0: 626f 7365 3a0a 2020 2020 2020 2020 2020  bose:.          
+00000e00: 2020 7072 696e 7428 6622 436f 6e76 6572    print(f"Conver
+00000e10: 7469 6e67 2066 696c 6520 7b66 696c 655f  ting file {file_
+00000e20: 636e 742b 317d 2f7b 6c65 6e28 6669 6c65  cnt+1}/{len(file
+00000e30: 735f 666f 756e 6429 7d20 2e2e 2e22 290a  s_found)} ...").
+00000e40: 2020 2020 2020 2020 696d 203d 2049 6d61          im = Ima
+00000e50: 6765 2e6f 7065 6e28 6669 6c65 5f70 6174  ge.open(file_pat
+00000e60: 6829 0a20 2020 2020 2020 2073 6176 655f  h).        save_
+00000e70: 6e61 6d65 203d 2066 696c 655f 7061 7468  name = file_path
+00000e80: 2e72 6570 6c61 6365 2822 2e22 202b 2073  .replace("." + s
+00000e90: 7472 2866 696c 655f 7479 7065 5f69 6e29  tr(file_type_in)
+00000ea0: 2c20 222e 2220 2b20 7374 7228 6669 6c65  , "." + str(file
+00000eb0: 5f74 7970 655f 6f75 7429 290a 2020 2020  _type_out)).    
+00000ec0: 2020 2020 696d 2e73 6176 6528 7361 7665      im.save(save
+00000ed0: 5f6e 616d 6529 0a20 2020 2020 2020 206f  _name).        o
+00000ee0: 732e 7265 6d6f 7665 2866 696c 655f 7061  s.remove(file_pa
+00000ef0: 7468 290a 2020 2020 7374 646f 7574 5f73  th).    stdout_s
+00000f00: 7563 6365 7373 280a 2020 2020 2020 2020  uccess(.        
+00000f10: 6d73 673d 6622 5349 4d42 4120 434f 4d50  msg=f"SIMBA COMP
+00000f20: 4c45 5445 3a20 4669 6c65 7320 696e 207b  LETE: Files in {
+00000f30: 6469 7265 6374 6f72 797d 2064 6972 6563  directory} direc
+00000f40: 746f 7279 2063 6f6e 7665 7274 6564 2074  tory converted t
+00000f50: 6f20 7b66 696c 655f 7479 7065 5f6f 7574  o {file_type_out
+00000f60: 7d22 2c0a 2020 2020 2020 2020 736f 7572  }",.        sour
+00000f70: 6365 3d63 6861 6e67 655f 696d 675f 666f  ce=change_img_fo
+00000f80: 726d 6174 2e5f 5f6e 616d 655f 5f2c 0a20  rmat.__name__,. 
+00000f90: 2020 2029 0a0a 0a64 6566 2063 6c61 6865     )...def clahe
+00000fa0: 5f65 6e68 616e 6365 5f76 6964 656f 280a  _enhance_video(.
+00000fb0: 2020 2020 6669 6c65 5f70 6174 683a 2055      file_path: U
+00000fc0: 6e69 6f6e 5b73 7472 2c20 6f73 2e50 6174  nion[str, os.Pat
+00000fd0: 684c 696b 655d 2c0a 2020 2020 636c 6970  hLike],.    clip
+00000fe0: 5f6c 696d 6974 3a20 4f70 7469 6f6e 616c  _limit: Optional
+00000ff0: 5b69 6e74 5d20 3d20 322c 0a20 2020 2074  [int] = 2,.    t
+00001000: 696c 655f 6772 6964 5f73 697a 653a 204f  ile_grid_size: O
+00001010: 7074 696f 6e61 6c5b 5475 706c 655b 696e  ptional[Tuple[in
+00001020: 745d 5d20 3d20 2831 362c 2031 3629 2c0a  t]] = (16, 16),.
+00001030: 2920 2d3e 204e 6f6e 653a 0a20 2020 2022  ) -> None:.    "
+00001040: 2222 0a20 2020 2043 6f6e 7665 7274 2061  "".    Convert a
+00001050: 2073 696e 676c 6520 7669 6465 6f20 6669   single video fi
+00001060: 6c65 2074 6f20 636c 6168 652d 656e 6861  le to clahe-enha
+00001070: 6e63 6564 2067 7265 7973 6361 6c65 202e  nced greyscale .
+00001080: 6176 6920 6669 6c65 2e20 5468 6520 7265  avi file. The re
+00001090: 7375 6c74 2069 7320 7361 7665 6420 7769  sult is saved wi
+000010a0: 7468 2070 7265 6669 780a 2020 2020 6060  th prefix.    ``
+000010b0: 434c 4148 455f 6060 2069 6e20 7468 6520  CLAHE_`` in the 
+000010c0: 7361 6d65 2064 6972 6563 746f 7279 2061  same directory a
+000010d0: 7320 696e 2074 6865 2069 6e70 7574 2066  s in the input f
+000010e0: 696c 652e 0a0a 2020 2020 3a70 6172 616d  ile...    :param
+000010f0: 6574 6572 2055 6e69 6f6e 5b73 7472 2c20  eter Union[str, 
+00001100: 6f73 2e50 6174 684c 696b 655d 2066 696c  os.PathLike] fil
+00001110: 655f 7061 7468 3a20 5061 7468 2074 6f20  e_path: Path to 
+00001120: 7669 6465 6f20 6669 6c65 2e0a 2020 2020  video file..    
+00001130: 3a70 6172 616d 6574 6572 204f 7074 696f  :parameter Optio
+00001140: 6e61 6c5b 696e 745d 2063 6c69 705f 6c69  nal[int] clip_li
+00001150: 6d69 743a 2043 4c41 4845 2061 6d70 6c69  mit: CLAHE ampli
+00001160: 6669 6361 7469 6f6e 206c 696d 6974 2e20  fication limit. 
+00001170: 496e 6363 7265 6173 6564 2063 6c69 7020  Inccreased clip 
+00001180: 6c69 6d69 7420 7265 6475 6365 206e 6f69  limit reduce noi
+00001190: 7365 2069 6e20 6f75 7470 7574 2e20 4465  se in output. De
+000011a0: 6661 756c 743a 2032 2e0a 2020 2020 3a70  fault: 2..    :p
+000011b0: 6172 616d 6574 6572 204f 7074 696f 6e61  arameter Optiona
+000011c0: 6c5b 5475 706c 655b 696e 745d 5d20 7469  l[Tuple[int]] ti
+000011d0: 6c65 5f67 7269 645f 7369 7a65 3a20 5468  le_grid_size: Th
+000011e0: 6520 6869 7374 6f67 7261 6d20 6b65 726e  e histogram kern
+000011f0: 656c 2073 697a 652e 0a0a 2020 2020 3a65  el size...    :e
+00001200: 7861 6d70 6c65 3a0a 2020 2020 3e3e 3e20  xample:.    >>> 
+00001210: 5f20 3d20 636c 6168 655f 656e 6861 6e63  _ = clahe_enhanc
+00001220: 655f 7669 6465 6f28 6669 6c65 5f70 6174  e_video(file_pat
+00001230: 683a 2027 7072 6f6a 6563 745f 666f 6c64  h: 'project_fold
+00001240: 6572 2f76 6964 656f 732f 5669 6465 6f5f  er/videos/Video_
+00001250: 312e 6d70 3427 290a 2020 2020 2222 220a  1.mp4').    """.
+00001260: 0a20 2020 2063 6865 636b 5f66 696c 655f  .    check_file_
+00001270: 6578 6973 745f 616e 645f 7265 6164 6162  exist_and_readab
+00001280: 6c65 2866 696c 655f 7061 7468 3d66 696c  le(file_path=fil
+00001290: 655f 7061 7468 290a 2020 2020 6368 6563  e_path).    chec
+000012a0: 6b5f 696e 7428 0a20 2020 2020 2020 206e  k_int(.        n
+000012b0: 616d 653d 6622 7b63 6c61 6865 5f65 6e68  ame=f"{clahe_enh
+000012c0: 616e 6365 5f76 6964 656f 2e5f 5f6e 616d  ance_video.__nam
+000012d0: 655f 5f7d 2063 6c69 705f 6c69 6d69 7422  e__} clip_limit"
+000012e0: 2c20 7661 6c75 653d 636c 6970 5f6c 696d  , value=clip_lim
+000012f0: 6974 2c20 6d69 6e5f 7661 6c75 653d 300a  it, min_value=0.
+00001300: 2020 2020 290a 2020 2020 7669 6465 6f5f      ).    video_
+00001310: 6d65 7461 5f64 6174 6120 3d20 6765 745f  meta_data = get_
+00001320: 7669 6465 6f5f 6d65 7461 5f64 6174 6128  video_meta_data(
+00001330: 6669 6c65 5f70 6174 6829 0a20 2020 2063  file_path).    c
+00001340: 6865 636b 5f76 616c 6964 5f74 7570 6c65  heck_valid_tuple
+00001350: 280a 2020 2020 2020 2020 783d 7469 6c65  (.        x=tile
+00001360: 5f67 7269 645f 7369 7a65 2c0a 2020 2020  _grid_size,.    
+00001370: 2020 2020 736f 7572 6365 3d63 6c61 6865      source=clahe
+00001380: 5f65 6e68 616e 6365 5f76 6964 656f 2e5f  _enhance_video._
+00001390: 5f6e 616d 655f 5f2c 0a20 2020 2020 2020  _name__,.       
+000013a0: 2061 6363 6570 7465 645f 6c65 6e67 7468   accepted_length
+000013b0: 733d 2832 2c29 2c0a 2020 2020 2020 2020  s=(2,),.        
+000013c0: 7661 6c69 645f 6474 7970 6573 3d28 696e  valid_dtypes=(in
+000013d0: 742c 292c 0a20 2020 2029 0a20 2020 2069  t,),.    ).    i
+000013e0: 6620 2874 696c 655f 6772 6964 5f73 697a  f (tile_grid_siz
+000013f0: 655b 305d 203e 2076 6964 656f 5f6d 6574  e[0] > video_met
+00001400: 615f 6461 7461 5b22 6865 6967 6874 225d  a_data["height"]
+00001410: 2920 6f72 2028 0a20 2020 2020 2020 2028  ) or (.        (
+00001420: 7469 6c65 5f67 7269 645f 7369 7a65 5b31  tile_grid_size[1
+00001430: 5d20 3e20 7669 6465 6f5f 6d65 7461 5f64  ] > video_meta_d
+00001440: 6174 615b 2277 6964 7468 225d 290a 2020  ata["width"]).  
+00001450: 2020 293a 0a20 2020 2020 2020 2072 6169    ):.        rai
+00001460: 7365 2049 6e76 616c 6964 496e 7075 7445  se InvalidInputE
+00001470: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00001480: 2020 6d73 673d 6627 5468 6520 7469 6c65    msg=f'The tile
+00001490: 2067 7269 6420 7369 7a65 2028 7b74 696c   grid size ({til
+000014a0: 655f 6772 6964 5f73 697a 657d 2920 6973  e_grid_size}) is
+000014b0: 206c 6172 6765 7220 7468 616e 2074 6865   larger than the
+000014c0: 2076 6964 656f 2073 697a 6520 287b 7669   video size ({vi
+000014d0: 6465 6f5f 6d65 7461 5f64 6174 615b 2272  deo_meta_data["r
+000014e0: 6573 6f6c 7574 696f 6e5f 7374 7222 5d7d  esolution_str"]}
+000014f0: 2927 2c0a 2020 2020 2020 2020 2020 2020  )',.            
+00001500: 736f 7572 6365 3d63 6c61 6865 5f65 6e68  source=clahe_enh
+00001510: 616e 6365 5f76 6964 656f 2e5f 5f6e 616d  ance_video.__nam
+00001520: 655f 5f2c 0a20 2020 2020 2020 2029 0a20  e__,.        ). 
+00001530: 2020 2064 6972 2c20 6669 6c65 5f6e 616d     dir, file_nam
+00001540: 652c 2066 696c 655f 6578 7420 3d20 6765  e, file_ext = ge
+00001550: 745f 666e 5f65 7874 2866 696c 6570 6174  t_fn_ext(filepat
+00001560: 683d 6669 6c65 5f70 6174 6829 0a20 2020  h=file_path).   
+00001570: 2073 6176 655f 7061 7468 203d 206f 732e   save_path = os.
+00001580: 7061 7468 2e6a 6f69 6e28 6469 722c 2066  path.join(dir, f
+00001590: 2243 4c41 4845 5f7b 6669 6c65 5f6e 616d  "CLAHE_{file_nam
+000015a0: 657d 2e61 7669 2229 0a20 2020 2066 6f75  e}.avi").    fou
+000015b0: 7263 6320 3d20 6376 322e 5669 6465 6f57  rcc = cv2.VideoW
+000015c0: 7269 7465 725f 666f 7572 6363 282a 466f  riter_fourcc(*Fo
+000015d0: 726d 6174 732e 4156 495f 434f 4445 432e  rmats.AVI_CODEC.
+000015e0: 7661 6c75 6529 0a20 2020 2070 7269 6e74  value).    print
+000015f0: 2866 2241 7070 6c79 696e 6720 434c 4148  (f"Applying CLAH
+00001600: 4520 6f6e 2076 6964 656f 207b 6669 6c65  E on video {file
+00001610: 5f6e 616d 657d 2c20 7468 6973 206d 6967  _name}, this mig
+00001620: 6874 2074 616b 6520 6177 6869 6c65 2e2e  ht take awhile..
+00001630: 2e22 290a 2020 2020 6361 7020 3d20 6376  .").    cap = cv
+00001640: 322e 5669 6465 6f43 6170 7475 7265 2866  2.VideoCapture(f
+00001650: 696c 655f 7061 7468 290a 2020 2020 7772  ile_path).    wr
+00001660: 6974 6572 203d 2063 7632 2e56 6964 656f  iter = cv2.Video
+00001670: 5772 6974 6572 280a 2020 2020 2020 2020  Writer(.        
+00001680: 7361 7665 5f70 6174 682c 0a20 2020 2020  save_path,.     
+00001690: 2020 2066 6f75 7263 632c 0a20 2020 2020     fourcc,.     
+000016a0: 2020 2076 6964 656f 5f6d 6574 615f 6461     video_meta_da
+000016b0: 7461 5b22 6670 7322 5d2c 0a20 2020 2020  ta["fps"],.     
+000016c0: 2020 2028 7669 6465 6f5f 6d65 7461 5f64     (video_meta_d
+000016d0: 6174 615b 2277 6964 7468 225d 2c20 7669  ata["width"], vi
+000016e0: 6465 6f5f 6d65 7461 5f64 6174 615b 2268  deo_meta_data["h
+000016f0: 6569 6768 7422 5d29 2c0a 2020 2020 2020  eight"]),.      
+00001700: 2020 302c 0a20 2020 2029 0a20 2020 2063    0,.    ).    c
+00001710: 6c61 6865 5f66 696c 7465 7220 3d20 6376  lahe_filter = cv
+00001720: 322e 6372 6561 7465 434c 4148 4528 0a20  2.createCLAHE(. 
+00001730: 2020 2020 2020 2063 6c69 704c 696d 6974         clipLimit
+00001740: 3d69 6e74 2863 6c69 705f 6c69 6d69 7429  =int(clip_limit)
+00001750: 2c20 7469 6c65 4772 6964 5369 7a65 3d74  , tileGridSize=t
+00001760: 696c 655f 6772 6964 5f73 697a 650a 2020  ile_grid_size.  
+00001770: 2020 290a 2020 2020 6672 6d5f 636e 7420    ).    frm_cnt 
+00001780: 3d20 300a 2020 2020 7472 793a 0a20 2020  = 0.    try:.   
+00001790: 2020 2020 2077 6869 6c65 2054 7275 653a       while True:
+000017a0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+000017b0: 2c20 696d 6720 3d20 6361 702e 7265 6164  , img = cap.read
+000017c0: 2829 0a20 2020 2020 2020 2020 2020 2069  ().            i
+000017d0: 6620 7265 743a 0a20 2020 2020 2020 2020  f ret:.         
+000017e0: 2020 2020 2020 2066 726d 5f63 6e74 202b         frm_cnt +
+000017f0: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
+00001800: 2020 2020 696d 6720 3d20 6376 322e 6376      img = cv2.cv
+00001810: 7443 6f6c 6f72 2869 6d67 2c20 6376 322e  tColor(img, cv2.
+00001820: 434f 4c4f 525f 4247 5232 4752 4159 290a  COLOR_BGR2GRAY).
+00001830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001840: 636c 6168 655f 6672 6d20 3d20 636c 6168  clahe_frm = clah
+00001850: 655f 6669 6c74 6572 2e61 7070 6c79 2869  e_filter.apply(i
+00001860: 6d67 290a 2020 2020 2020 2020 2020 2020  mg).            
+00001870: 2020 2020 7772 6974 6572 2e77 7269 7465      writer.write
+00001880: 2863 6c61 6865 5f66 726d 290a 2020 2020  (clahe_frm).    
+00001890: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+000018a0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+000018b0: 2020 2020 2020 2066 2243 4c41 4845 2063         f"CLAHE c
+000018c0: 6f6e 7665 7274 6564 2066 7261 6d65 207b  onverted frame {
+000018d0: 6672 6d5f 636e 747d 2f7b 7669 6465 6f5f  frm_cnt}/{video_
+000018e0: 6d65 7461 5f64 6174 615b 2766 7261 6d65  meta_data['frame
+000018f0: 5f63 6f75 6e74 275d 7d22 0a20 2020 2020  _count']}".     
+00001900: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00001910: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00001920: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00001930: 7265 616b 0a20 2020 2020 2020 2063 6170  reak.        cap
+00001940: 2e72 656c 6561 7365 2829 0a20 2020 2020  .release().     
+00001950: 2020 2077 7269 7465 722e 7265 6c65 6173     writer.releas
+00001960: 6528 290a 2020 2020 2020 2020 7072 696e  e().        prin
+00001970: 7428 6622 434c 4148 4520 7669 6465 6f20  t(f"CLAHE video 
+00001980: 6372 6561 7465 643a 207b 7361 7665 5f70  created: {save_p
+00001990: 6174 687d 2e22 290a 2020 2020 6578 6365  ath}.").    exce
+000019a0: 7074 2045 7863 6570 7469 6f6e 2061 7320  pt Exception as 
+000019b0: 7365 3a0a 2020 2020 2020 2020 7072 696e  se:.        prin
+000019c0: 7428 7365 2e61 7267 7329 0a20 2020 2020  t(se.args).     
+000019d0: 2020 2070 7269 6e74 2866 2243 4c41 4845     print(f"CLAHE
+000019e0: 2063 6f6e 7665 7273 696f 6e20 6661 696c   conversion fail
+000019f0: 6564 2066 6f72 2076 6964 656f 207b 6669  ed for video {fi
+00001a00: 6c65 5f6e 616d 657d 2e22 290a 2020 2020  le_name}.").    
+00001a10: 2020 2020 6361 702e 7265 6c65 6173 6528      cap.release(
+00001a20: 290a 2020 2020 2020 2020 7772 6974 6572  ).        writer
+00001a30: 2e72 656c 6561 7365 2829 0a20 2020 2020  .release().     
+00001a40: 2020 2072 6169 7365 2049 6e76 616c 6964     raise Invalid
+00001a50: 5669 6465 6f46 696c 6545 7272 6f72 280a  VideoFileError(.
+00001a60: 2020 2020 2020 2020 2020 2020 6d73 673d              msg=
+00001a70: 6622 436f 756c 6420 6e6f 7420 636f 6e76  f"Could not conv
+00001a80: 6572 7420 6669 6c65 207b 6669 6c65 5f70  ert file {file_p
+00001a90: 6174 687d 2074 6f20 434c 4148 4520 656e  ath} to CLAHE en
+00001aa0: 6861 6e63 6564 2076 6964 656f 222c 0a20  hanced video",. 
+00001ab0: 2020 2020 2020 2020 2020 2073 6f75 7263             sourc
+00001ac0: 653d 636c 6168 655f 656e 6861 6e63 655f  e=clahe_enhance_
+00001ad0: 7669 6465 6f2e 5f5f 6e61 6d65 5f5f 2c0a  video.__name__,.
+00001ae0: 2020 2020 2020 2020 290a 0a0a 6465 6620          )...def 
+00001af0: 6578 7472 6163 745f 6672 616d 655f 7261  extract_frame_ra
+00001b00: 6e67 6528 0a20 2020 2066 696c 655f 7061  nge(.    file_pa
+00001b10: 7468 3a20 556e 696f 6e5b 7374 722c 206f  th: Union[str, o
+00001b20: 732e 5061 7468 4c69 6b65 5d2c 2073 7461  s.PathLike], sta
+00001b30: 7274 5f66 7261 6d65 3a20 696e 742c 2065  rt_frame: int, e
+00001b40: 6e64 5f66 7261 6d65 3a20 696e 740a 2920  nd_frame: int.) 
+00001b50: 2d3e 204e 6f6e 653a 0a20 2020 2022 2222  -> None:.    """
+00001b60: 0a20 2020 2045 7874 7261 6374 2061 2075  .    Extract a u
+00001b70: 7365 722d 6465 6669 6e65 6420 7261 6e67  ser-defined rang
+00001b80: 6520 6f66 2066 7261 6d65 7320 6672 6f6d  e of frames from
+00001b90: 2061 2076 6964 656f 2066 696c 6520 746f   a video file to
+00001ba0: 2060 706e 6760 2066 6f72 6d61 742e 2049   `png` format. I
+00001bb0: 6d61 6765 730a 2020 2020 6172 6520 7361  mages.    are sa
+00001bc0: 7665 6420 696e 2061 2066 6f6c 6465 7220  ved in a folder 
+00001bd0: 7769 7468 2074 6865 2073 7566 6669 7820  with the suffix 
+00001be0: 605f 6672 616d 6573 6020 7769 7468 696e  `_frames` within
+00001bf0: 2074 6865 2073 616d 6520 6469 7265 6374   the same direct
+00001c00: 6f72 7920 6173 2074 6865 2076 6964 656f  ory as the video
+00001c10: 2066 696c 652e 0a0a 2020 2020 3a70 6172   file...    :par
+00001c20: 616d 6574 6572 2055 6e69 6f6e 5b73 7472  ameter Union[str
+00001c30: 2c20 6f73 2e50 6174 684c 696b 655d 2066  , os.PathLike] f
+00001c40: 696c 655f 7061 7468 3a20 5061 7468 2074  ile_path: Path t
+00001c50: 6f20 7669 6465 6f20 6669 6c65 0a20 2020  o video file.   
+00001c60: 203a 7061 7261 6d65 7465 7220 696e 7420   :parameter int 
+00001c70: 7374 6172 745f 6672 616d 653a 2046 6972  start_frame: Fir
+00001c80: 7374 2066 7261 6d65 2069 6e20 7261 6e67  st frame in rang
+00001c90: 6520 746f 2065 7874 7261 6374 0a20 2020  e to extract.   
+00001ca0: 203a 7061 7261 6d65 7465 7220 696e 7420   :parameter int 
+00001cb0: 656e 645f 6672 616d 653a 204c 6173 7420  end_frame: Last 
+00001cc0: 6672 616d 6520 696e 2072 616e 6765 2074  frame in range t
+00001cd0: 6f20 6578 7472 6163 742e 0a0a 2020 2020  o extract...    
+00001ce0: 3a65 7861 6d70 6c65 3a0a 2020 2020 3e3e  :example:.    >>
+00001cf0: 3e20 5f20 3d20 6578 7472 6163 745f 6672  > _ = extract_fr
+00001d00: 616d 655f 7261 6e67 6528 6669 6c65 5f70  ame_range(file_p
+00001d10: 6174 683d 2770 726f 6a65 6374 5f66 6f6c  ath='project_fol
+00001d20: 6465 722f 7669 6465 6f73 2f56 6964 656f  der/videos/Video
+00001d30: 5f31 2e6d 7034 272c 2073 7461 7274 5f66  _1.mp4', start_f
+00001d40: 7261 6d65 3d31 3030 2c20 656e 645f 6672  rame=100, end_fr
+00001d50: 616d 653d 3530 3029 0a20 2020 2022 2222  ame=500).    """
+00001d60: 0a0a 2020 2020 6368 6563 6b5f 6669 6c65  ..    check_file
+00001d70: 5f65 7869 7374 5f61 6e64 5f72 6561 6461  _exist_and_reada
+00001d80: 626c 6528 6669 6c65 5f70 6174 683d 6669  ble(file_path=fi
+00001d90: 6c65 5f70 6174 6829 0a20 2020 2076 6964  le_path).    vid
+00001da0: 656f 5f6d 6574 615f 6461 7461 203d 2067  eo_meta_data = g
+00001db0: 6574 5f76 6964 656f 5f6d 6574 615f 6461  et_video_meta_da
+00001dc0: 7461 2866 696c 655f 7061 7468 290a 2020  ta(file_path).  
+00001dd0: 2020 6368 6563 6b5f 696e 7428 6e61 6d65    check_int(name
+00001de0: 3d22 7374 6172 7420 6672 616d 6522 2c20  ="start frame", 
+00001df0: 7661 6c75 653d 7374 6172 745f 6672 616d  value=start_fram
+00001e00: 652c 206d 696e 5f76 616c 7565 3d30 290a  e, min_value=0).
+00001e10: 2020 2020 6669 6c65 5f64 6972 2c20 6669      file_dir, fi
+00001e20: 6c65 5f6e 616d 652c 2066 696c 655f 6578  le_name, file_ex
+00001e30: 7420 3d20 6765 745f 666e 5f65 7874 2866  t = get_fn_ext(f
+00001e40: 696c 6570 6174 683d 6669 6c65 5f70 6174  ilepath=file_pat
+00001e50: 6829 0a20 2020 2063 6865 636b 5f69 6e74  h).    check_int
+00001e60: 280a 2020 2020 2020 2020 6e61 6d65 3d22  (.        name="
+00001e70: 656e 6420 6672 616d 6522 2c20 7661 6c75  end frame", valu
+00001e80: 653d 656e 645f 6672 616d 652c 206d 6178  e=end_frame, max
+00001e90: 5f76 616c 7565 3d76 6964 656f 5f6d 6574  _value=video_met
+00001ea0: 615f 6461 7461 5b22 6672 616d 655f 636f  a_data["frame_co
+00001eb0: 756e 7422 5d0a 2020 2020 290a 2020 2020  unt"].    ).    
+00001ec0: 6672 616d 655f 7261 6e67 6520 3d20 6c69  frame_range = li
+00001ed0: 7374 2872 616e 6765 2869 6e74 2873 7461  st(range(int(sta
+00001ee0: 7274 5f66 7261 6d65 292c 2069 6e74 2865  rt_frame), int(e
+00001ef0: 6e64 5f66 7261 6d65 2920 2b20 3129 290a  nd_frame) + 1)).
+00001f00: 2020 2020 7361 7665 5f64 6972 203d 206f      save_dir = o
+00001f10: 732e 7061 7468 2e6a 6f69 6e28 6669 6c65  s.path.join(file
+00001f20: 5f64 6972 2c20 6669 6c65 5f6e 616d 6520  _dir, file_name 
+00001f30: 2b20 225f 6672 616d 6573 2229 0a20 2020  + "_frames").   
+00001f40: 2063 6170 203d 2063 7632 2e56 6964 656f   cap = cv2.Video
+00001f50: 4361 7074 7572 6528 6669 6c65 5f70 6174  Capture(file_pat
+00001f60: 6829 0a20 2020 2069 6620 6e6f 7420 6f73  h).    if not os
+00001f70: 2e70 6174 682e 6578 6973 7473 2873 6176  .path.exists(sav
+00001f80: 655f 6469 7229 3a0a 2020 2020 2020 2020  e_dir):.        
+00001f90: 6f73 2e6d 616b 6564 6972 7328 7361 7665  os.makedirs(save
+00001fa0: 5f64 6972 290a 2020 2020 666f 7220 6672  _dir).    for fr
+00001fb0: 6d5f 636e 742c 2066 726d 5f6e 756d 6265  m_cnt, frm_numbe
+00001fc0: 7220 696e 2065 6e75 6d65 7261 7465 2866  r in enumerate(f
+00001fd0: 7261 6d65 5f72 616e 6765 293a 0a20 2020  rame_range):.   
+00001fe0: 2020 2020 2063 6170 2e73 6574 2831 2c20       cap.set(1, 
+00001ff0: 6672 6d5f 6e75 6d62 6572 290a 2020 2020  frm_number).    
+00002000: 2020 2020 7265 742c 2066 7261 6d65 203d      ret, frame =
+00002010: 2063 6170 2e72 6561 6428 290a 2020 2020   cap.read().    
+00002020: 2020 2020 6672 6d5f 7361 7665 5f70 6174      frm_save_pat
+00002030: 6820 3d20 6f73 2e70 6174 682e 6a6f 696e  h = os.path.join
+00002040: 2873 6176 655f 6469 722c 2066 227b 6672  (save_dir, f"{fr
+00002050: 6d5f 6e75 6d62 6572 7d2e 706e 6722 290a  m_number}.png").
+00002060: 2020 2020 2020 2020 6376 322e 696d 7772          cv2.imwr
+00002070: 6974 6528 6672 6d5f 7361 7665 5f70 6174  ite(frm_save_pat
+00002080: 682c 2066 7261 6d65 290a 2020 2020 2020  h, frame).      
+00002090: 2020 7072 696e 7428 6622 4672 616d 6520    print(f"Frame 
+000020a0: 7b66 726d 5f6e 756d 6265 727d 2073 6176  {frm_number} sav
+000020b0: 6564 2028 4672 616d 6520 7b66 726d 5f63  ed (Frame {frm_c
+000020c0: 6e74 7d2f 7b6c 656e 2866 7261 6d65 5f72  nt}/{len(frame_r
+000020d0: 616e 6765 292d 317d 2922 290a 2020 2020  ange)-1})").    
+000020e0: 7374 646f 7574 5f73 7563 6365 7373 280a  stdout_success(.
+000020f0: 2020 2020 2020 2020 6d73 673d 6622 7b6c          msg=f"{l
+00002100: 656e 2866 7261 6d65 5f72 616e 6765 292d  en(frame_range)-
+00002110: 317d 2066 7261 6d65 7320 6578 7472 6163  1} frames extrac
+00002120: 7465 6420 666f 7220 7669 6465 6f20 7b66  ted for video {f
+00002130: 696c 655f 6e61 6d65 7d20 7361 7665 6420  ile_name} saved 
+00002140: 696e 207b 7361 7665 5f64 6972 7d22 2c0a  in {save_dir}",.
+00002150: 2020 2020 2020 2020 736f 7572 6365 3d65          source=e
+00002160: 7874 7261 6374 5f66 7261 6d65 5f72 616e  xtract_frame_ran
+00002170: 6765 2e5f 5f6e 616d 655f 5f2c 0a20 2020  ge.__name__,.   
+00002180: 2029 0a0a 0a64 6566 2063 6861 6e67 655f   )...def change_
+00002190: 7369 6e67 6c65 5f76 6964 656f 5f66 7073  single_video_fps
+000021a0: 280a 2020 2020 6669 6c65 5f70 6174 683a  (.    file_path:
+000021b0: 2055 6e69 6f6e 5b73 7472 2c20 6f73 2e50   Union[str, os.P
+000021c0: 6174 684c 696b 655d 2c20 6670 733a 2069  athLike], fps: i
+000021d0: 6e74 2c20 6770 753a 204f 7074 696f 6e61  nt, gpu: Optiona
+000021e0: 6c5b 626f 6f6c 5d20 3d20 4661 6c73 650a  l[bool] = False.
+000021f0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2022  ) -> None:.    "
+00002200: 2222 0a20 2020 2043 6861 6e67 6520 7468  "".    Change th
+00002210: 6520 6670 7320 6f66 2061 2073 696e 676c  e fps of a singl
+00002220: 6520 7669 6465 6f20 6669 6c65 2e20 5265  e video file. Re
+00002230: 7375 6c74 7320 6172 6520 7374 6f72 6564  sults are stored
+00002240: 2069 6e20 7468 6520 7361 6d65 2064 6972   in the same dir
+00002250: 6563 746f 7279 2061 7320 696e 2074 6865  ectory as in the
+00002260: 2069 6e70 7574 2066 696c 6520 7769 7468   input file with
+00002270: 0a20 2020 2074 6865 2073 7566 6669 7820  .    the suffix 
+00002280: 6060 5f66 7073 5f6e 6577 5f66 7073 6060  ``_fps_new_fps``
+00002290: 2e0a 0a20 2020 202e 2e20 6e6f 7465 3a3a  ...    .. note::
+000022a0: 0a20 2020 2020 2020 546f 2063 6861 6e67  .       To chang
+000022b0: 6520 7468 6520 4650 5320 6f66 2061 6c6c  e the FPS of all
+000022c0: 2076 6964 656f 7320 696e 2061 2064 6972   videos in a dir
+000022d0: 6563 746f 7279 2c20 7573 6520 6060 7369  ectory, use ``si
+000022e0: 6d62 612e 7669 6465 6f5f 7072 6f63 6573  mba.video_proces
+000022f0: 736f 7273 2e76 6964 656f 5f70 726f 6365  sors.video_proce
+00002300: 7373 696e 672e 6368 616e 6765 5f66 7073  ssing.change_fps
+00002310: 5f6f 665f 6d75 6c74 6970 6c65 5f76 6964  _of_multiple_vid
+00002320: 656f 7360 602e 0a0a 2020 2020 3a70 6172  eos``...    :par
+00002330: 616d 6574 6572 2055 6e69 6f6e 5b73 7472  ameter Union[str
+00002340: 2c20 6f73 2e50 6174 684c 696b 655d 2066  , os.PathLike] f
+00002350: 696c 655f 7061 7468 3a20 5061 7468 2074  ile_path: Path t
+00002360: 6f20 7669 6465 6f20 6669 6c65 0a20 2020  o video file.   
+00002370: 203a 7061 7261 6d65 7465 7220 696e 7420   :parameter int 
+00002380: 6670 733a 2046 7073 206f 6620 7468 6520  fps: Fps of the 
+00002390: 6e65 7720 7669 6465 6f20 6669 6c65 2e0a  new video file..
+000023a0: 2020 2020 3a70 6172 616d 6574 6572 204f      :parameter O
+000023b0: 7074 696f 6e61 6c5b 626f 6f6c 5d20 6770  ptional[bool] gp
+000023c0: 753a 2049 6620 5472 7565 2c20 7573 6520  u: If True, use 
+000023d0: 4e56 4944 4541 2047 5055 2063 6f64 6563  NVIDEA GPU codec
+000023e0: 732e 2044 6566 6175 6c74 2046 616c 7365  s. Default False
+000023f0: 2e0a 0a20 2020 203a 6578 616d 706c 653a  ...    :example:
+00002400: 0a20 2020 203e 3e3e 205f 203d 2063 6861  .    >>> _ = cha
+00002410: 6e67 655f 7369 6e67 6c65 5f76 6964 656f  nge_single_video
+00002420: 5f66 7073 2866 696c 655f 7061 7468 3d27  _fps(file_path='
+00002430: 7072 6f6a 6563 745f 666f 6c64 6572 2f76  project_folder/v
+00002440: 6964 656f 732f 5669 6465 6f5f 312e 6d70  ideos/Video_1.mp
+00002450: 3427 2c20 6670 733d 3135 290a 2020 2020  4', fps=15).    
+00002460: 2222 220a 0a20 2020 2074 696d 6572 203d  """..    timer =
+00002470: 2053 696d 6261 5469 6d65 7228 7374 6172   SimbaTimer(star
+00002480: 743d 5472 7565 290a 2020 2020 6368 6563  t=True).    chec
+00002490: 6b5f 6666 6d70 6567 5f61 7661 696c 6162  k_ffmpeg_availab
+000024a0: 6c65 2872 6169 7365 5f65 7272 6f72 3d54  le(raise_error=T
+000024b0: 7275 6529 0a20 2020 2069 6620 6770 7520  rue).    if gpu 
+000024c0: 616e 6420 6e6f 7420 6368 6563 6b5f 6e76  and not check_nv
+000024d0: 6964 6561 5f67 7075 5f61 7661 696c 6162  idea_gpu_availab
+000024e0: 6c65 2829 3a0a 2020 2020 2020 2020 7261  le():.        ra
+000024f0: 6973 6520 4646 4d50 4547 436f 6465 6347  ise FFMPEGCodecG
+00002500: 5055 4572 726f 7228 0a20 2020 2020 2020  PUError(.       
+00002510: 2020 2020 206d 7367 3d22 4e6f 2047 5055       msg="No GPU
+00002520: 2066 6f75 6e64 2028 6173 2065 7661 6c75   found (as evalu
+00002530: 6174 6564 2062 7920 6e76 6964 6561 2d73  ated by nvidea-s
+00002540: 6d69 2072 6574 7572 6e69 6e67 204e 6f6e  mi returning Non
+00002550: 6529 222c 0a20 2020 2020 2020 2020 2020  e)",.           
+00002560: 2073 6f75 7263 653d 6368 616e 6765 5f73   source=change_s
+00002570: 696e 676c 655f 7669 6465 6f5f 6670 732e  ingle_video_fps.
+00002580: 5f5f 6e61 6d65 5f5f 2c0a 2020 2020 2020  __name__,.      
+00002590: 2020 290a 2020 2020 6368 6563 6b5f 6669    ).    check_fi
+000025a0: 6c65 5f65 7869 7374 5f61 6e64 5f72 6561  le_exist_and_rea
+000025b0: 6461 626c 6528 6669 6c65 5f70 6174 683d  dable(file_path=
+000025c0: 6669 6c65 5f70 6174 6829 0a20 2020 2063  file_path).    c
+000025d0: 6865 636b 5f69 6e74 286e 616d 653d 224e  heck_int(name="N
+000025e0: 6577 2066 7073 222c 2076 616c 7565 3d66  ew fps", value=f
+000025f0: 7073 290a 2020 2020 7669 6465 6f5f 6d65  ps).    video_me
+00002600: 7461 5f64 6174 6120 3d20 6765 745f 7669  ta_data = get_vi
+00002610: 6465 6f5f 6d65 7461 5f64 6174 6128 7669  deo_meta_data(vi
+00002620: 6465 6f5f 7061 7468 3d66 696c 655f 7061  deo_path=file_pa
+00002630: 7468 290a 2020 2020 6469 725f 6e61 6d65  th).    dir_name
+00002640: 2c20 6669 6c65 5f6e 616d 652c 2065 7874  , file_name, ext
+00002650: 203d 2067 6574 5f66 6e5f 6578 7428 6669   = get_fn_ext(fi
+00002660: 6c65 7061 7468 3d66 696c 655f 7061 7468  lepath=file_path
+00002670: 290a 2020 2020 6966 2069 6e74 2866 7073  ).    if int(fps
+00002680: 2920 3d3d 2069 6e74 2876 6964 656f 5f6d  ) == int(video_m
+00002690: 6574 615f 6461 7461 5b22 6670 7322 5d29  eta_data["fps"])
+000026a0: 3a0a 2020 2020 2020 2020 5361 6d65 496e  :.        SameIn
+000026b0: 7075 7441 6e64 4f75 7470 7574 5761 726e  putAndOutputWarn
+000026c0: 696e 6728 0a20 2020 2020 2020 2020 2020  ing(.           
+000026d0: 206d 7367 3d66 2254 6865 206e 6577 2066   msg=f"The new f
+000026e0: 7073 2069 7320 7468 6520 7361 6d65 2061  ps is the same a
+000026f0: 7320 7468 6520 696e 7075 7420 6670 7320  s the input fps 
+00002700: 666f 7220 7669 6465 6f20 7b66 696c 655f  for video {file_
+00002710: 6e61 6d65 7d20 287b 7374 7228 6670 7329  name} ({str(fps)
+00002720: 7d29 222c 0a20 2020 2020 2020 2020 2020  })",.           
+00002730: 2073 6f75 7263 653d 6368 616e 6765 5f73   source=change_s
+00002740: 696e 676c 655f 7669 6465 6f5f 6670 732e  ingle_video_fps.
+00002750: 5f5f 6e61 6d65 5f5f 2c0a 2020 2020 2020  __name__,.      
+00002760: 2020 290a 2020 2020 7361 7665 5f70 6174    ).    save_pat
+00002770: 6820 3d20 6f73 2e70 6174 682e 6a6f 696e  h = os.path.join
+00002780: 280a 2020 2020 2020 2020 6469 725f 6e61  (.        dir_na
+00002790: 6d65 2c20 6669 6c65 5f6e 616d 6520 2b20  me, file_name + 
+000027a0: 225f 6670 735f 7b7d 7b7d 222e 666f 726d  "_fps_{}{}".form
+000027b0: 6174 2873 7472 2866 7073 292c 2073 7472  at(str(fps), str
+000027c0: 2865 7874 2929 0a20 2020 2029 0a20 2020  (ext)).    ).   
+000027d0: 2070 7269 6e74 2866 2243 6f6e 7665 7274   print(f"Convert
+000027e0: 696e 6720 7468 6520 4650 5320 746f 207b  ing the FPS to {
+000027f0: 6670 737d 2066 6f72 2076 6964 656f 207b  fps} for video {
+00002800: 6669 6c65 5f6e 616d 657d 202e 2e2e 2229  file_name} ...")
+00002810: 0a20 2020 2069 6620 6f73 2e70 6174 682e  .    if os.path.
+00002820: 6973 6669 6c65 2873 6176 655f 7061 7468  isfile(save_path
+00002830: 293a 0a20 2020 2020 2020 2046 696c 6545  ):.        FileE
+00002840: 7869 7374 5761 726e 696e 6728 0a20 2020  xistWarning(.   
+00002850: 2020 2020 2020 2020 206d 7367 3d66 224f           msg=f"O
+00002860: 7665 7277 7269 7469 6e67 2065 7869 7374  verwriting exist
+00002870: 696e 6720 6669 6c65 2061 7420 7b73 6176  ing file at {sav
+00002880: 655f 7061 7468 7d2e 2e2e 222c 0a20 2020  e_path}...",.   
+00002890: 2020 2020 2020 2020 2073 6f75 7263 653d           source=
+000028a0: 6368 616e 6765 5f73 696e 676c 655f 7669  change_single_vi
+000028b0: 6465 6f5f 6670 732e 5f5f 6e61 6d65 5f5f  deo_fps.__name__
+000028c0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+000028d0: 6966 2067 7075 3a0a 2020 2020 2020 2020  if gpu:.        
+000028e0: 636f 6d6d 616e 6420 3d20 6627 6666 6d70  command = f'ffmp
+000028f0: 6567 202d 6877 6163 6365 6c20 6175 746f  eg -hwaccel auto
+00002900: 202d 633a 7620 6832 3634 5f63 7576 6964   -c:v h264_cuvid
+00002910: 202d 6920 227b 6669 6c65 5f70 6174 687d   -i "{file_path}
+00002920: 2220 2d76 6620 2266 7073 3d7b 6670 737d  " -vf "fps={fps}
+00002930: 2220 2d63 3a76 2068 3236 345f 6e76 656e  " -c:v h264_nven
+00002940: 6320 2d63 3a61 2063 6f70 7920 227b 7361  c -c:a copy "{sa
+00002950: 7665 5f70 6174 687d 2220 2d79 270a 2020  ve_path}" -y'.  
+00002960: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00002970: 636f 6d6d 616e 6420 3d20 6627 6666 6d70  command = f'ffmp
+00002980: 6567 202d 6920 227b 6669 6c65 5f70 6174  eg -i "{file_pat
+00002990: 687d 2220 2d66 696c 7465 723a 7620 6670  h}" -filter:v fp
+000029a0: 733d 6670 733d 7b66 7073 7d20 2d63 3a76  s=fps={fps} -c:v
+000029b0: 206c 6962 7832 3634 202d 633a 6120 6161   libx264 -c:a aa
+000029c0: 6320 227b 7361 7665 5f70 6174 687d 2220  c "{save_path}" 
+000029d0: 2d79 270a 2020 2020 7375 6270 726f 6365  -y'.    subproce
+000029e0: 7373 2e63 616c 6c28 636f 6d6d 616e 642c  ss.call(command,
+000029f0: 2073 6865 6c6c 3d54 7275 6529 0a20 2020   shell=True).   
+00002a00: 2074 696d 6572 2e73 746f 705f 7469 6d65   timer.stop_time
+00002a10: 7228 290a 2020 2020 7374 646f 7574 5f73  r().    stdout_s
+00002a20: 7563 6365 7373 280a 2020 2020 2020 2020  uccess(.        
+00002a30: 6d73 673d 6627 5349 4d42 4120 434f 4d50  msg=f'SIMBA COMP
+00002a40: 4c45 5445 3a20 4650 5320 6f66 2076 6964  LETE: FPS of vid
+00002a50: 656f 207b 6669 6c65 5f6e 616d 657d 2063  eo {file_name} c
+00002a60: 6861 6e67 6564 2066 726f 6d20 7b73 7472  hanged from {str
+00002a70: 2876 6964 656f 5f6d 6574 615f 6461 7461  (video_meta_data
+00002a80: 5b22 6670 7322 5d29 7d20 746f 207b 7374  ["fps"])} to {st
+00002a90: 7228 6670 7329 7d20 616e 6420 7361 7665  r(fps)} and save
+00002aa0: 6420 696e 2064 6972 6563 746f 7279 207b  d in directory {
+00002ab0: 7361 7665 5f70 6174 687d 272c 0a20 2020  save_path}',.   
+00002ac0: 2020 2020 2065 6c61 7073 6564 5f74 696d       elapsed_tim
+00002ad0: 653d 7469 6d65 722e 656c 6170 7365 645f  e=timer.elapsed_
+00002ae0: 7469 6d65 5f73 7472 2c0a 2020 2020 2020  time_str,.      
+00002af0: 2020 736f 7572 6365 3d63 6861 6e67 655f    source=change_
+00002b00: 7369 6e67 6c65 5f76 6964 656f 5f66 7073  single_video_fps
+00002b10: 2e5f 5f6e 616d 655f 5f2c 0a20 2020 2029  .__name__,.    )
+00002b20: 0a0a 0a64 6566 2063 6861 6e67 655f 6670  ...def change_fp
+00002b30: 735f 6f66 5f6d 756c 7469 706c 655f 7669  s_of_multiple_vi
+00002b40: 6465 6f73 280a 2020 2020 6469 7265 6374  deos(.    direct
+00002b50: 6f72 793a 2055 6e69 6f6e 5b73 7472 2c20  ory: Union[str, 
+00002b60: 6f73 2e50 6174 684c 696b 655d 2c20 6670  os.PathLike], fp
+00002b70: 733a 2069 6e74 2c20 6770 753a 204f 7074  s: int, gpu: Opt
+00002b80: 696f 6e61 6c5b 626f 6f6c 5d20 3d20 4661  ional[bool] = Fa
+00002b90: 6c73 650a 2920 2d3e 204e 6f6e 653a 0a20  lse.) -> None:. 
+00002ba0: 2020 2022 2222 0a20 2020 2043 6861 6e67     """.    Chang
+00002bb0: 6520 7468 6520 6670 7320 6f66 2061 6c6c  e the fps of all
+00002bc0: 2076 6964 656f 2066 696c 6573 2069 6e20   video files in 
+00002bd0: 6120 666f 6c64 6572 2e20 5265 7375 6c74  a folder. Result
+00002be0: 7320 6172 6520 7374 6f72 6564 2069 6e20  s are stored in 
+00002bf0: 7468 6520 7361 6d65 2064 6972 6563 746f  the same directo
+00002c00: 7279 2061 7320 696e 2074 6865 2069 6e70  ry as in the inp
+00002c10: 7574 2066 696c 6573 2077 6974 680a 2020  ut files with.  
+00002c20: 2020 7468 6520 7375 6666 6978 2060 605f    the suffix ``_
+00002c30: 6670 735f 6e65 775f 6670 7360 602e 0a0a  fps_new_fps``...
+00002c40: 2020 2020 3a70 6172 616d 6574 6572 2055      :parameter U
+00002c50: 6e69 6f6e 5b73 7472 2c20 6f73 2e50 6174  nion[str, os.Pat
+00002c60: 684c 696b 655d 2064 6972 6563 746f 7279  hLike] directory
+00002c70: 3a20 5061 7468 2074 6f20 7669 6465 6f20  : Path to video 
+00002c80: 6669 6c65 2064 6972 6563 746f 7279 0a20  file directory. 
+00002c90: 2020 203a 7061 7261 6d65 7465 7220 696e     :parameter in
+00002ca0: 7420 6670 733a 2046 7073 206f 6620 7468  t fps: Fps of th
+00002cb0: 6520 6e65 7720 7669 6465 6f20 6669 6c65  e new video file
+00002cc0: 732e 0a20 2020 203a 7061 7261 6d65 7465  s..    :paramete
+00002cd0: 7220 4f70 7469 6f6e 616c 5b62 6f6f 6c5d  r Optional[bool]
+00002ce0: 2067 7075 3a20 4966 2054 7275 652c 2075   gpu: If True, u
+00002cf0: 7365 204e 5649 4445 4120 4750 5520 636f  se NVIDEA GPU co
+00002d00: 6465 6373 2e20 4465 6661 756c 7420 4661  decs. Default Fa
+00002d10: 6c73 652e 0a0a 2020 2020 3a65 7861 6d70  lse...    :examp
+00002d20: 6c65 3a0a 2020 2020 3e3e 3e20 5f20 3d20  le:.    >>> _ = 
+00002d30: 6368 616e 6765 5f66 7073 5f6f 665f 6d75  change_fps_of_mu
+00002d40: 6c74 6970 6c65 5f76 6964 656f 7328 6469  ltiple_videos(di
+00002d50: 7265 6374 6f72 793d 2770 726f 6a65 6374  rectory='project
+00002d60: 5f66 6f6c 6465 722f 7669 6465 6f73 2f56  _folder/videos/V
+00002d70: 6964 656f 5f31 2e6d 7034 272c 2066 7073  ideo_1.mp4', fps
+00002d80: 3d31 3529 0a20 2020 2022 2222 0a0a 2020  =15).    """..  
+00002d90: 2020 7469 6d65 7220 3d20 5369 6d62 6154    timer = SimbaT
+00002da0: 696d 6572 2873 7461 7274 3d54 7275 6529  imer(start=True)
+00002db0: 0a20 2020 2063 6865 636b 5f66 666d 7065  .    check_ffmpe
+00002dc0: 675f 6176 6169 6c61 626c 6528 7261 6973  g_available(rais
+00002dd0: 655f 6572 726f 723d 5472 7565 290a 2020  e_error=True).  
+00002de0: 2020 6966 2067 7075 2061 6e64 206e 6f74    if gpu and not
+00002df0: 2063 6865 636b 5f6e 7669 6465 615f 6770   check_nvidea_gp
+00002e00: 755f 6176 6169 6c61 626c 6528 293a 0a20  u_available():. 
+00002e10: 2020 2020 2020 2072 6169 7365 2046 464d         raise FFM
+00002e20: 5045 4743 6f64 6563 4750 5545 7272 6f72  PEGCodecGPUError
+00002e30: 280a 2020 2020 2020 2020 2020 2020 6d73  (.            ms
+00002e40: 673d 224e 6f20 4750 5520 666f 756e 6420  g="No GPU found 
+00002e50: 2861 7320 6576 616c 7561 7465 6420 6279  (as evaluated by
+00002e60: 206e 7669 6465 612d 736d 6920 7265 7475   nvidea-smi retu
+00002e70: 726e 696e 6720 4e6f 6e65 2922 2c0a 2020  rning None)",.  
+00002e80: 2020 2020 2020 2020 2020 736f 7572 6365            source
+00002e90: 3d63 6861 6e67 655f 6670 735f 6f66 5f6d  =change_fps_of_m
+00002ea0: 756c 7469 706c 655f 7669 6465 6f73 2e5f  ultiple_videos._
+00002eb0: 5f6e 616d 655f 5f2c 0a20 2020 2020 2020  _name__,.       
+00002ec0: 2029 0a20 2020 2069 6620 6e6f 7420 6f73   ).    if not os
+00002ed0: 2e70 6174 682e 6973 6469 7228 6469 7265  .path.isdir(dire
+00002ee0: 6374 6f72 7929 3a0a 2020 2020 2020 2020  ctory):.        
+00002ef0: 7261 6973 6520 4e6f 7444 6972 6563 746f  raise NotDirecto
+00002f00: 7279 4572 726f 7228 0a20 2020 2020 2020  ryError(.       
+00002f10: 2020 2020 206d 7367 3d66 2253 494d 4241       msg=f"SIMBA
+00002f20: 2045 5252 4f52 3a20 7b64 6972 6563 746f   ERROR: {directo
+00002f30: 7279 7d20 6973 206e 6f74 2061 2076 616c  ry} is not a val
+00002f40: 6964 2064 6972 6563 746f 7279 222c 0a20  id directory",. 
+00002f50: 2020 2020 2020 2020 2020 2073 6f75 7263             sourc
+00002f60: 653d 6368 616e 6765 5f66 7073 5f6f 665f  e=change_fps_of_
+00002f70: 6d75 6c74 6970 6c65 5f76 6964 656f 732e  multiple_videos.
+00002f80: 5f5f 6e61 6d65 5f5f 2c0a 2020 2020 2020  __name__,.      
+00002f90: 2020 290a 2020 2020 6368 6563 6b5f 696e    ).    check_in
+00002fa0: 7428 6e61 6d65 3d22 4e65 7720 6670 7322  t(name="New fps"
+00002fb0: 2c20 7661 6c75 653d 6670 7329 0a20 2020  , value=fps).   
+00002fc0: 2076 6964 656f 5f70 6174 6873 203d 205b   video_paths = [
+00002fd0: 5d0a 2020 2020 6669 6c65 5f70 6174 6873  ].    file_paths
+00002fe0: 5f69 6e5f 666f 6c64 6572 203d 205b 6620  _in_folder = [f 
+00002ff0: 666f 7220 6620 696e 2067 6c6f 622e 676c  for f in glob.gl
+00003000: 6f62 2864 6972 6563 746f 7279 202b 2022  ob(directory + "
+00003010: 2f2a 2229 2069 6620 6f73 2e70 6174 682e  /*") if os.path.
+00003020: 6973 6669 6c65 2866 295d 0a20 2020 2066  isfile(f)].    f
+00003030: 6f72 2066 696c 655f 7061 7468 2069 6e20  or file_path in 
+00003040: 6669 6c65 5f70 6174 6873 5f69 6e5f 666f  file_paths_in_fo
+00003050: 6c64 6572 3a0a 2020 2020 2020 2020 5f2c  lder:.        _,
+00003060: 205f 2c20 6578 7420 3d20 6765 745f 666e   _, ext = get_fn
+00003070: 5f65 7874 2866 696c 6570 6174 683d 6669  _ext(filepath=fi
+00003080: 6c65 5f70 6174 6829 0a20 2020 2020 2020  le_path).       
+00003090: 2069 6620 6578 742e 6c6f 7765 7228 2920   if ext.lower() 
+000030a0: 696e 205b 222e 6176 6922 2c20 222e 6d70  in [".avi", ".mp
+000030b0: 3422 2c20 222e 6d6f 7622 2c20 222e 666c  4", ".mov", ".fl
+000030c0: 7622 5d3a 0a20 2020 2020 2020 2020 2020  v"]:.           
+000030d0: 2076 6964 656f 5f70 6174 6873 2e61 7070   video_paths.app
+000030e0: 656e 6428 6669 6c65 5f70 6174 6829 0a20  end(file_path). 
+000030f0: 2020 2069 6620 6c65 6e28 7669 6465 6f5f     if len(video_
+00003100: 7061 7468 7329 203c 2031 3a0a 2020 2020  paths) < 1:.    
+00003110: 2020 2020 7261 6973 6520 4e6f 4669 6c65      raise NoFile
+00003120: 7346 6f75 6e64 4572 726f 7228 0a20 2020  sFoundError(.   
+00003130: 2020 2020 2020 2020 206d 7367 3d22 5349           msg="SI
+00003140: 4d42 4120 4552 524f 523a 204e 6f20 6669  MBA ERROR: No fi
+00003150: 6c65 7320 7769 7468 202e 6d70 342c 202e  les with .mp4, .
+00003160: 6176 692c 202e 6d6f 762c 202e 666c 7620  avi, .mov, .flv 
+00003170: 6669 6c65 2065 6e64 696e 6720 666f 756e  file ending foun
+00003180: 6420 696e 2074 6865 207b 7d20 6469 7265  d in the {} dire
+00003190: 6374 6f72 7922 2e66 6f72 6d61 7428 0a20  ctory".format(. 
+000031a0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+000031b0: 6972 6563 746f 7279 0a20 2020 2020 2020  irectory.       
+000031c0: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
+000031d0: 2020 2020 736f 7572 6365 3d63 6861 6e67      source=chang
+000031e0: 655f 6670 735f 6f66 5f6d 756c 7469 706c  e_fps_of_multipl
+000031f0: 655f 7669 6465 6f73 2e5f 5f6e 616d 655f  e_videos.__name_
+00003200: 5f2c 0a20 2020 2020 2020 2029 0a20 2020  _,.        ).   
+00003210: 2066 6f72 2066 696c 655f 636e 742c 2066   for file_cnt, f
+00003220: 696c 655f 7061 7468 2069 6e20 656e 756d  ile_path in enum
+00003230: 6572 6174 6528 7669 6465 6f5f 7061 7468  erate(video_path
+00003240: 7329 3a0a 2020 2020 2020 2020 7669 6465  s):.        vide
+00003250: 6f5f 7469 6d65 7220 3d20 5369 6d62 6154  o_timer = SimbaT
+00003260: 696d 6572 2873 7461 7274 3d54 7275 6529  imer(start=True)
+00003270: 0a20 2020 2020 2020 2064 6972 5f6e 616d  .        dir_nam
+00003280: 652c 2066 696c 655f 6e61 6d65 2c20 6578  e, file_name, ex
+00003290: 7420 3d20 6765 745f 666e 5f65 7874 2866  t = get_fn_ext(f
+000032a0: 696c 6570 6174 683d 6669 6c65 5f70 6174  ilepath=file_pat
+000032b0: 6829 0a20 2020 2020 2020 2070 7269 6e74  h).        print
+000032c0: 2866 2243 6f6e 7665 7274 696e 6720 4650  (f"Converting FP
+000032d0: 5320 666f 7220 7b66 696c 655f 6e61 6d65  S for {file_name
+000032e0: 7d2e 2e2e 2229 0a20 2020 2020 2020 2073  }...").        s
+000032f0: 6176 655f 7061 7468 203d 206f 732e 7061  ave_path = os.pa
+00003300: 7468 2e6a 6f69 6e28 0a20 2020 2020 2020  th.join(.       
+00003310: 2020 2020 2064 6972 5f6e 616d 652c 2066       dir_name, f
+00003320: 696c 655f 6e61 6d65 202b 2022 5f66 7073  ile_name + "_fps
+00003330: 5f7b 7d7b 7d22 2e66 6f72 6d61 7428 7374  _{}{}".format(st
+00003340: 7228 6670 7329 2c20 7374 7228 6578 7429  r(fps), str(ext)
+00003350: 290a 2020 2020 2020 2020 290a 2020 2020  ).        ).    
+00003360: 2020 2020 6966 2067 7075 3a0a 2020 2020      if gpu:.    
+00003370: 2020 2020 2020 2020 636f 6d6d 616e 6420          command 
+00003380: 3d20 6627 6666 6d70 6567 202d 6877 6163  = f'ffmpeg -hwac
+00003390: 6365 6c20 6175 746f 202d 633a 7620 6832  cel auto -c:v h2
+000033a0: 3634 5f63 7576 6964 202d 6920 227b 6669  64_cuvid -i "{fi
+000033b0: 6c65 5f70 6174 687d 2220 2d76 6620 2266  le_path}" -vf "f
+000033c0: 7073 3d7b 6670 737d 2220 2d63 3a76 2068  ps={fps}" -c:v h
+000033d0: 3236 345f 6e76 656e 6320 2d63 3a61 2063  264_nvenc -c:a c
+000033e0: 6f70 7920 227b 7361 7665 5f70 6174 687d  opy "{save_path}
+000033f0: 2220 2d79 270a 2020 2020 2020 2020 656c  " -y'.        el
+00003400: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00003410: 636f 6d6d 616e 6420 3d20 6627 6666 6d70  command = f'ffmp
+00003420: 6567 202d 6920 7b66 696c 655f 7061 7468  eg -i {file_path
+00003430: 7d20 2d66 696c 7465 723a 7620 6670 733d  } -filter:v fps=
+00003440: 6670 733d 7b66 7073 7d20 2d63 3a76 206c  fps={fps} -c:v l
+00003450: 6962 7832 3634 2022 7b73 6176 655f 7061  ibx264 "{save_pa
+00003460: 7468 7d22 202d 7927 0a20 2020 2020 2020  th}" -y'.       
+00003470: 2073 7562 7072 6f63 6573 732e 6361 6c6c   subprocess.call
+00003480: 2863 6f6d 6d61 6e64 2c20 7368 656c 6c3d  (command, shell=
+00003490: 5472 7565 290a 2020 2020 2020 2020 7669  True).        vi
+000034a0: 6465 6f5f 7469 6d65 722e 7374 6f70 5f74  deo_timer.stop_t
+000034b0: 696d 6572 2829 0a20 2020 2020 2020 2070  imer().        p
+000034c0: 7269 6e74 280a 2020 2020 2020 2020 2020  rint(.          
+000034d0: 2020 6622 5669 6465 6f20 7b66 696c 655f    f"Video {file_
+000034e0: 6e61 6d65 7d20 636f 6d70 6c65 7465 2e2e  name} complete..
+000034f0: 2e20 2865 6c61 7073 6564 2074 696d 653a  . (elapsed time:
+00003500: 207b 7669 6465 6f5f 7469 6d65 722e 656c   {video_timer.el
+00003510: 6170 7365 645f 7469 6d65 5f73 7472 7d73  apsed_time_str}s
+00003520: 2922 0a20 2020 2020 2020 2029 0a20 2020  )".        ).   
+00003530: 2074 696d 6572 2e73 746f 705f 7469 6d65   timer.stop_time
+00003540: 7228 290a 2020 2020 7374 646f 7574 5f73  r().    stdout_s
+00003550: 7563 6365 7373 280a 2020 2020 2020 2020  uccess(.        
+00003560: 6d73 673d 6622 5349 4d42 4120 434f 4d50  msg=f"SIMBA COMP
+00003570: 4c45 5445 3a20 4650 5320 6f66 207b 6c65  LETE: FPS of {le
+00003580: 6e28 7669 6465 6f5f 7061 7468 7329 7d20  n(video_paths)} 
+00003590: 7669 6465 6f28 7329 2063 6861 6e67 6564  video(s) changed
+000035a0: 2074 6f20 7b66 7073 7d22 2c0a 2020 2020   to {fps}",.    
+000035b0: 2020 2020 656c 6170 7365 645f 7469 6d65      elapsed_time
+000035c0: 3d74 696d 6572 2e65 6c61 7073 6564 5f74  =timer.elapsed_t
+000035d0: 696d 655f 7374 722c 0a20 2020 2020 2020  ime_str,.       
+000035e0: 2073 6f75 7263 653d 6368 616e 6765 5f66   source=change_f
+000035f0: 7073 5f6f 665f 6d75 6c74 6970 6c65 5f76  ps_of_multiple_v
+00003600: 6964 656f 732e 5f5f 6e61 6d65 5f5f 2c0a  ideos.__name__,.
+00003610: 2020 2020 290a 0a0a 6465 6620 636f 6e76      )...def conv
+00003620: 6572 745f 7669 6465 6f5f 706f 7765 7270  ert_video_powerp
+00003630: 6f69 6e74 5f63 6f6d 7061 7469 626c 655f  oint_compatible_
+00003640: 666f 726d 6174 280a 2020 2020 6669 6c65  format(.    file
+00003650: 5f70 6174 683a 2055 6e69 6f6e 5b73 7472  _path: Union[str
+00003660: 2c20 6f73 2e50 6174 684c 696b 655d 2c20  , os.PathLike], 
+00003670: 6770 753a 204f 7074 696f 6e61 6c5b 626f  gpu: Optional[bo
+00003680: 6f6c 5d20 3d20 4661 6c73 650a 2920 2d3e  ol] = False.) ->
+00003690: 204e 6f6e 653a 0a20 2020 2022 2222 0a20   None:.    """. 
+000036a0: 2020 2043 7265 6174 6520 4d53 2050 6f77     Create MS Pow
+000036b0: 6572 506f 696e 7420 636f 6d70 6174 6962  erPoint compatib
+000036c0: 6c65 2063 6f70 7920 6f66 2061 2076 6964  le copy of a vid
+000036d0: 656f 2066 696c 652e 2054 6865 2072 6573  eo file. The res
+000036e0: 756c 7420 6973 2073 746f 7265 6420 696e  ult is stored in
+000036f0: 2074 6865 2073 616d 6520 6469 7265 6374   the same direct
+00003700: 6f72 7920 6173 2074 6865 0a20 2020 2069  ory as the.    i
+00003710: 6e70 7574 2066 696c 6520 7769 7468 2074  nput file with t
+00003720: 6865 2060 605f 706f 7765 7270 6f69 6e74  he ``_powerpoint
+00003730: 7265 6164 7960 6020 7375 6666 6978 2e0a  ready`` suffix..
+00003740: 0a20 2020 203a 7061 7261 6d65 7465 7220  .    :parameter 
+00003750: 556e 696f 6e5b 7374 722c 206f 732e 5061  Union[str, os.Pa
+00003760: 7468 4c69 6b65 5d20 6669 6c65 5f70 6174  thLike] file_pat
+00003770: 683a 2050 6174 6820 746f 2076 6964 656f  h: Path to video
+00003780: 2066 696c 652e 0a20 2020 203a 7061 7261   file..    :para
+00003790: 6d65 7465 7220 4f70 7469 6f6e 616c 5b62  meter Optional[b
+000037a0: 6f6f 6c5d 2067 7075 3a20 4966 2054 7275  ool] gpu: If Tru
+000037b0: 652c 2075 7365 204e 5649 4445 4120 4750  e, use NVIDEA GP
+000037c0: 5520 636f 6465 6373 2e20 4465 6661 756c  U codecs. Defaul
+000037d0: 7420 4661 6c73 652e 0a0a 2020 2020 3a65  t False...    :e
+000037e0: 7861 6d70 6c65 3a0a 2020 2020 3e3e 3e20  xample:.    >>> 
+000037f0: 5f20 3d20 636f 6e76 6572 745f 7669 6465  _ = convert_vide
+00003800: 6f5f 706f 7765 7270 6f69 6e74 5f63 6f6d  o_powerpoint_com
+00003810: 7061 7469 626c 655f 666f 726d 6174 2866  patible_format(f
+00003820: 696c 655f 7061 7468 3d27 7072 6f6a 6563  ile_path='projec
+00003830: 745f 666f 6c64 6572 2f76 6964 656f 732f  t_folder/videos/
+00003840: 5669 6465 6f5f 312e 6d70 3427 290a 2020  Video_1.mp4').  
+00003850: 2020 2222 220a 0a20 2020 2063 6865 636b    """..    check
+00003860: 5f66 666d 7065 675f 6176 6169 6c61 626c  _ffmpeg_availabl
+00003870: 6528 7261 6973 655f 6572 726f 723d 5472  e(raise_error=Tr
+00003880: 7565 290a 2020 2020 6966 2067 7075 2061  ue).    if gpu a
+00003890: 6e64 206e 6f74 2063 6865 636b 5f6e 7669  nd not check_nvi
+000038a0: 6465 615f 6770 755f 6176 6169 6c61 626c  dea_gpu_availabl
+000038b0: 6528 293a 0a20 2020 2020 2020 2072 6169  e():.        rai
+000038c0: 7365 2046 464d 5045 4743 6f64 6563 4750  se FFMPEGCodecGP
+000038d0: 5545 7272 6f72 280a 2020 2020 2020 2020  UError(.        
+000038e0: 2020 2020 6d73 673d 224e 6f20 4750 5520      msg="No GPU 
+000038f0: 666f 756e 6420 2861 7320 6576 616c 7561  found (as evalua
+00003900: 7465 6420 6279 206e 7669 6465 612d 736d  ted by nvidea-sm
+00003910: 6920 7265 7475 726e 696e 6720 4e6f 6e65  i returning None
+00003920: 2922 2c0a 2020 2020 2020 2020 2020 2020  )",.            
+00003930: 736f 7572 6365 3d63 6f6e 7665 7274 5f76  source=convert_v
+00003940: 6964 656f 5f70 6f77 6572 706f 696e 745f  ideo_powerpoint_
+00003950: 636f 6d70 6174 6962 6c65 5f66 6f72 6d61  compatible_forma
+00003960: 742e 5f5f 6e61 6d65 5f5f 2c0a 2020 2020  t.__name__,.    
+00003970: 2020 2020 290a 2020 2020 7469 6d65 7220      ).    timer 
+00003980: 3d20 5369 6d62 6154 696d 6572 2873 7461  = SimbaTimer(sta
+00003990: 7274 3d54 7275 6529 0a20 2020 2063 6865  rt=True).    che
+000039a0: 636b 5f66 696c 655f 6578 6973 745f 616e  ck_file_exist_an
+000039b0: 645f 7265 6164 6162 6c65 2866 696c 655f  d_readable(file_
+000039c0: 7061 7468 3d66 696c 655f 7061 7468 290a  path=file_path).
+000039d0: 2020 2020 6469 722c 2066 696c 655f 6e61      dir, file_na
+000039e0: 6d65 2c20 6578 7420 3d20 6765 745f 666e  me, ext = get_fn
+000039f0: 5f65 7874 2866 696c 6570 6174 683d 6669  _ext(filepath=fi
+00003a00: 6c65 5f70 6174 6829 0a20 2020 2073 6176  le_path).    sav
+00003a10: 655f 6e61 6d65 203d 206f 732e 7061 7468  e_name = os.path
+00003a20: 2e6a 6f69 6e28 6469 722c 2066 696c 655f  .join(dir, file_
+00003a30: 6e61 6d65 202b 2022 5f70 6f77 6572 706f  name + "_powerpo
+00003a40: 696e 7472 6561 6479 2e6d 7034 2229 0a20  intready.mp4"). 
+00003a50: 2020 2069 6620 6f73 2e70 6174 682e 6973     if os.path.is
+00003a60: 6669 6c65 2873 6176 655f 6e61 6d65 293a  file(save_name):
+00003a70: 0a20 2020 2020 2020 2072 6169 7365 2046  .        raise F
+00003a80: 696c 6545 7869 7374 4572 726f 7228 0a20  ileExistError(. 
+00003a90: 2020 2020 2020 2020 2020 206d 7367 3d22             msg="
+00003aa0: 5349 4d42 4120 4552 524f 523a 2054 6865  SIMBA ERROR: The
+00003ab0: 206f 7574 6669 6c65 2066 696c 6520 616c   outfile file al
+00003ac0: 7265 6164 7920 6578 6973 743a 207b 7d2e  ready exist: {}.
+00003ad0: 222e 666f 726d 6174 2873 6176 655f 6e61  ".format(save_na
+00003ae0: 6d65 292c 0a20 2020 2020 2020 2020 2020  me),.           
+00003af0: 2073 6f75 7263 653d 636f 6e76 6572 745f   source=convert_
+00003b00: 7669 6465 6f5f 706f 7765 7270 6f69 6e74  video_powerpoint
+00003b10: 5f63 6f6d 7061 7469 626c 655f 666f 726d  _compatible_form
+00003b20: 6174 2e5f 5f6e 616d 655f 5f2c 0a20 2020  at.__name__,.   
+00003b30: 2020 2020 2029 0a20 2020 2069 6620 6770       ).    if gp
+00003b40: 753a 0a20 2020 2020 2020 2063 6f6d 6d61  u:.        comma
+00003b50: 6e64 203d 2027 6666 6d70 6567 202d 6877  nd = 'ffmpeg -hw
+00003b60: 6163 6365 6c20 6175 746f 202d 633a 7620  accel auto -c:v 
+00003b70: 6832 3634 5f63 7576 6964 202d 6920 227b  h264_cuvid -i "{
+00003b80: 7d22 202d 633a 7620 6832 3634 5f6e 7665  }" -c:v h264_nve
+00003b90: 6e63 202d 7072 6573 6574 2073 6c6f 7720  nc -preset slow 
+00003ba0: 2d70 726f 6669 6c65 3a76 2068 6967 6820  -profile:v high 
+00003bb0: 2d6c 6576 656c 3a76 2034 2e30 202d 7069  -level:v 4.0 -pi
+00003bc0: 785f 666d 7420 7975 7634 3230 7020 2d63  x_fmt yuv420p -c
+00003bd0: 7266 2032 3220 2d63 3a61 2061 6163 2022  rf 22 -c:a aac "
+00003be0: 7b7d 2227 2e66 6f72 6d61 7428 0a20 2020  {}"'.format(.   
+00003bf0: 2020 2020 2020 2020 2066 696c 655f 7061           file_pa
+00003c00: 7468 2c20 7361 7665 5f6e 616d 650a 2020  th, save_name.  
+00003c10: 2020 2020 2020 290a 2020 2020 656c 7365        ).    else
+00003c20: 3a0a 2020 2020 2020 2020 636f 6d6d 616e  :.        comman
+00003c30: 6420 3d20 6627 6666 6d70 6567 202d 6920  d = f'ffmpeg -i 
+00003c40: 227b 6669 6c65 5f70 6174 687d 2220 2d63  "{file_path}" -c
+00003c50: 3a76 206c 6962 7832 3634 202d 7072 6573  :v libx264 -pres
+00003c60: 6574 2073 6c6f 7720 2d70 726f 6669 6c65  et slow -profile
+00003c70: 3a76 2068 6967 6820 2d6c 6576 656c 3a76  :v high -level:v
+00003c80: 2034 2e30 202d 7069 785f 666d 7420 7975   4.0 -pix_fmt yu
+00003c90: 7634 3230 7020 2d63 7266 2032 3220 2d63  v420p -crf 22 -c
+00003ca0: 3a76 206c 6962 7832 3634 202d 636f 6465  :v libx264 -code
+00003cb0: 633a 6120 6161 6320 227b 7361 7665 5f6e  c:a aac "{save_n
+00003cc0: 616d 657d 2220 2d79 270a 2020 2020 7072  ame}" -y'.    pr
+00003cd0: 696e 7428 2243 7265 6174 696e 6720 7669  int("Creating vi
+00003ce0: 6465 6f20 696e 2070 6f77 6572 706f 696e  deo in powerpoin
+00003cf0: 7420 636f 6d70 6174 6962 6c65 2066 6f72  t compatible for
+00003d00: 6d61 742e 2e2e 2022 290a 2020 2020 7375  mat... ").    su
+00003d10: 6270 726f 6365 7373 2e63 616c 6c28 636f  bprocess.call(co
+00003d20: 6d6d 616e 642c 2073 6865 6c6c 3d54 7275  mmand, shell=Tru
+00003d30: 652c 2073 7464 6f75 743d 7375 6270 726f  e, stdout=subpro
+00003d40: 6365 7373 2e50 4950 4529 0a20 2020 2074  cess.PIPE).    t
+00003d50: 696d 6572 2e73 746f 705f 7469 6d65 7228  imer.stop_timer(
+00003d60: 290a 2020 2020 7374 646f 7574 5f73 7563  ).    stdout_suc
+00003d70: 6365 7373 280a 2020 2020 2020 2020 6d73  cess(.        ms
+00003d80: 673d 6622 5349 4d42 4120 434f 4d50 4c45  g=f"SIMBA COMPLE
+00003d90: 5445 3a20 5669 6465 6f20 636f 6e76 6572  TE: Video conver
+00003da0: 7465 6421 207b 7361 7665 5f6e 616d 657d  ted! {save_name}
+00003db0: 2067 656e 6572 6174 6564 2122 2c0a 2020   generated!",.  
+00003dc0: 2020 2020 2020 656c 6170 7365 645f 7469        elapsed_ti
+00003dd0: 6d65 3d74 696d 6572 2e65 6c61 7073 6564  me=timer.elapsed
+00003de0: 5f74 696d 655f 7374 722c 0a20 2020 2020  _time_str,.     
+00003df0: 2020 2073 6f75 7263 653d 636f 6e76 6572     source=conver
+00003e00: 745f 7669 6465 6f5f 706f 7765 7270 6f69  t_video_powerpoi
+00003e10: 6e74 5f63 6f6d 7061 7469 626c 655f 666f  nt_compatible_fo
+00003e20: 726d 6174 2e5f 5f6e 616d 655f 5f2c 0a20  rmat.__name__,. 
+00003e30: 2020 2029 0a0a 0a23 2063 6f6e 7665 7274     )...# convert
+00003e40: 5f76 6964 656f 5f70 6f77 6572 706f 696e  _video_powerpoin
+00003e50: 745f 636f 6d70 6174 6962 6c65 5f66 6f72  t_compatible_for
+00003e60: 6d61 7428 6669 6c65 5f70 6174 683d 7222  mat(file_path=r"
+00003e70: 2f55 7365 7273 2f73 696d 6f6e 2f44 6573  /Users/simon/Des
+00003e80: 6b74 6f70 2f65 6e76 732f 7369 6d62 612f  ktop/envs/simba/
+00003e90: 7472 6f75 626c 6573 686f 6f74 696e 672f  troubleshooting/
+00003ea0: 6d6f 7573 655f 6f70 656e 5f66 6965 6c64  mouse_open_field
+00003eb0: 2f70 726f 6a65 6374 5f66 6f6c 6465 722f  /project_folder/
+00003ec0: 7669 6465 6f73 2f74 6573 742f 5349 5f44  videos/test/SI_D
+00003ed0: 4159 335f 3330 385f 4344 315f 5052 4553  AY3_308_CD1_PRES
+00003ee0: 454e 545f 6670 735f 3130 5f66 7073 5f31  ENT_fps_10_fps_1
+00003ef0: 352e 6d70 3422 2c20 6770 753d 4661 6c73  5.mp4", gpu=Fals
+00003f00: 6529 0a0a 0a64 6566 2063 6f6e 7665 7274  e)...def convert
+00003f10: 5f74 6f5f 6d70 3428 0a20 2020 2066 696c  _to_mp4(.    fil
+00003f20: 655f 7061 7468 3a20 556e 696f 6e5b 7374  e_path: Union[st
+00003f30: 722c 206f 732e 5061 7468 4c69 6b65 5d2c  r, os.PathLike],
+00003f40: 2067 7075 3a20 4f70 7469 6f6e 616c 5b62   gpu: Optional[b
+00003f50: 6f6f 6c5d 203d 2046 616c 7365 0a29 202d  ool] = False.) -
+00003f60: 3e20 4e6f 6e65 3a0a 2020 2020 2222 220a  > None:.    """.
+00003f70: 2020 2020 436f 6e76 6572 7420 6120 7669      Convert a vi
+00003f80: 6465 6f20 6669 6c65 2074 6f20 6d70 3420  deo file to mp4 
+00003f90: 666f 726d 6174 2e20 5468 6520 7265 7375  format. The resu
+00003fa0: 6c74 2069 7320 7374 6f72 6564 2069 6e20  lt is stored in 
+00003fb0: 7468 6520 7361 6d65 2064 6972 6563 746f  the same directo
+00003fc0: 7279 2061 7320 7468 650a 2020 2020 696e  ry as the.    in
+00003fd0: 7075 7420 6669 6c65 2077 6974 6820 7468  put file with th
+00003fe0: 6520 6060 5f63 6f6e 7665 7274 6564 2e6d  e ``_converted.m
+00003ff0: 7034 6060 2073 7566 6669 782e 0a0a 2020  p4`` suffix...  
+00004000: 2020 3a70 6172 616d 6574 6572 2055 6e69    :parameter Uni
+00004010: 6f6e 5b73 7472 2c20 6f73 2e50 6174 684c  on[str, os.PathL
+00004020: 696b 655d 2066 696c 655f 7061 7468 3a20  ike] file_path: 
+00004030: 5061 7468 2074 6f20 7669 6465 6f20 6669  Path to video fi
+00004040: 6c65 2e0a 2020 2020 3a70 6172 616d 6574  le..    :paramet
+00004050: 6572 204f 7074 696f 6e61 6c5b 626f 6f6c  er Optional[bool
+00004060: 5d20 6770 753a 2049 6620 5472 7565 2c20  ] gpu: If True, 
+00004070: 7573 6520 4e56 4944 4541 2047 5055 2063  use NVIDEA GPU c
+00004080: 6f64 6563 732e 2044 6566 6175 6c74 2046  odecs. Default F
+00004090: 616c 7365 2e0a 0a20 2020 203a 6578 616d  alse...    :exam
+000040a0: 706c 653a 0a20 2020 203e 3e3e 205f 203d  ple:.    >>> _ =
+000040b0: 2063 6f6e 7665 7274 5f74 6f5f 6d70 3428   convert_to_mp4(
+000040c0: 6669 6c65 5f70 6174 683d 2770 726f 6a65  file_path='proje
+000040d0: 6374 5f66 6f6c 6465 722f 7669 6465 6f73  ct_folder/videos
+000040e0: 2f56 6964 656f 5f31 2e61 7669 2729 0a20  /Video_1.avi'). 
+000040f0: 2020 2022 2222 0a0a 2020 2020 6368 6563     """..    chec
+00004100: 6b5f 6666 6d70 6567 5f61 7661 696c 6162  k_ffmpeg_availab
+00004110: 6c65 2872 6169 7365 5f65 7272 6f72 3d54  le(raise_error=T
+00004120: 7275 6529 0a20 2020 2069 6620 6770 7520  rue).    if gpu 
+00004130: 616e 6420 6e6f 7420 6368 6563 6b5f 6e76  and not check_nv
+00004140: 6964 6561 5f67 7075 5f61 7661 696c 6162  idea_gpu_availab
+00004150: 6c65 2829 3a0a 2020 2020 2020 2020 7261  le():.        ra
+00004160: 6973 6520 4646 4d50 4547 436f 6465 6347  ise FFMPEGCodecG
+00004170: 5055 4572 726f 7228 0a20 2020 2020 2020  PUError(.       
+00004180: 2020 2020 206d 7367 3d22 4e6f 2047 5055       msg="No GPU
+00004190: 2066 6f75 6e64 2028 6173 2065 7661 6c75   found (as evalu
+000041a0: 6174 6564 2062 7920 6e76 6964 6561 2d73  ated by nvidea-s
+000041b0: 6d69 2072 6574 7572 6e69 6e67 204e 6f6e  mi returning Non
+000041c0: 6529 222c 0a20 2020 2020 2020 2020 2020  e)",.           
+000041d0: 2073 6f75 7263 653d 636f 6e76 6572 745f   source=convert_
+000041e0: 746f 5f6d 7034 2e5f 5f6e 616d 655f 5f2c  to_mp4.__name__,
+000041f0: 0a20 2020 2020 2020 2029 0a20 2020 2074  .        ).    t
+00004200: 696d 6572 203d 2053 696d 6261 5469 6d65  imer = SimbaTime
+00004210: 7228 7374 6172 743d 5472 7565 290a 2020  r(start=True).  
+00004220: 2020 6368 6563 6b5f 6669 6c65 5f65 7869    check_file_exi
+00004230: 7374 5f61 6e64 5f72 6561 6461 626c 6528  st_and_readable(
+00004240: 6669 6c65 5f70 6174 683d 6669 6c65 5f70  file_path=file_p
+00004250: 6174 6829 0a20 2020 2064 6972 2c20 6669  ath).    dir, fi
+00004260: 6c65 5f6e 616d 652c 2065 7874 203d 2067  le_name, ext = g
+00004270: 6574 5f66 6e5f 6578 7428 6669 6c65 7061  et_fn_ext(filepa
+00004280: 7468 3d66 696c 655f 7061 7468 290a 2020  th=file_path).  
+00004290: 2020 7361 7665 5f6e 616d 6520 3d20 6f73    save_name = os
+000042a0: 2e70 6174 682e 6a6f 696e 2864 6972 2c20  .path.join(dir, 
+000042b0: 6669 6c65 5f6e 616d 6520 2b20 225f 636f  file_name + "_co
+000042c0: 6e76 6572 7465 642e 6d70 3422 290a 2020  nverted.mp4").  
+000042d0: 2020 6966 206f 732e 7061 7468 2e69 7366    if os.path.isf
+000042e0: 696c 6528 7361 7665 5f6e 616d 6529 3a0a  ile(save_name):.
+000042f0: 2020 2020 2020 2020 7261 6973 6520 4669          raise Fi
+00004300: 6c65 4578 6973 7445 7272 6f72 280a 2020  leExistError(.  
+00004310: 2020 2020 2020 2020 2020 6d73 673d 2253            msg="S
+00004320: 494d 4241 2045 5252 4f52 3a20 5468 6520  IMBA ERROR: The 
+00004330: 6f75 7466 696c 6520 6669 6c65 2061 6c72  outfile file alr
+00004340: 6561 6479 2065 7869 7374 3a20 7b7d 2e22  eady exist: {}."
+00004350: 2e66 6f72 6d61 7428 7361 7665 5f6e 616d  .format(save_nam
+00004360: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
+00004370: 736f 7572 6365 3d63 6f6e 7665 7274 5f74  source=convert_t
+00004380: 6f5f 6d70 342e 5f5f 6e61 6d65 5f5f 2c0a  o_mp4.__name__,.
+00004390: 2020 2020 2020 2020 290a 2020 2020 6966          ).    if
+000043a0: 2067 7075 3a0a 2020 2020 2020 2020 636f   gpu:.        co
+000043b0: 6d6d 616e 6420 3d20 280a 2020 2020 2020  mmand = (.      
+000043c0: 2020 2020 2020 2766 666d 7065 6720 2d68        'ffmpeg -h
+000043d0: 7761 6363 656c 2061 7574 6f20 2d63 3a76  waccel auto -c:v
+000043e0: 2068 3236 345f 6375 7669 6420 2d69 2022   h264_cuvid -i "
+000043f0: 7b7d 2220 2d63 3a76 2068 3236 345f 6e76  {}" -c:v h264_nv
+00004400: 656e 6320 227b 7d22 272e 666f 726d 6174  enc "{}"'.format
+00004410: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00004420: 2020 6669 6c65 5f70 6174 682c 2073 6176    file_path, sav
+00004430: 655f 6e61 6d65 0a20 2020 2020 2020 2020  e_name.         
+00004440: 2020 2029 0a20 2020 2020 2020 2029 0a20     ).        ). 
+00004450: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00004460: 2063 6f6d 6d61 6e64 203d 2066 2766 666d   command = f'ffm
+00004470: 7065 6720 2d69 2022 7b66 696c 655f 7061  peg -i "{file_pa
+00004480: 7468 7d22 202d 633a 7620 6c69 6278 3236  th}" -c:v libx26
+00004490: 3420 227b 7361 7665 5f6e 616d 657d 2227  4 "{save_name}"'
+000044a0: 0a20 2020 2070 7269 6e74 2822 436f 6e76  .    print("Conv
+000044b0: 6572 7469 6e67 2074 6f20 6d70 342e 2e2e  erting to mp4...
+000044c0: 2022 290a 2020 2020 7375 6270 726f 6365   ").    subproce
+000044d0: 7373 2e63 616c 6c28 636f 6d6d 616e 642c  ss.call(command,
+000044e0: 2073 6865 6c6c 3d54 7275 652c 2073 7464   shell=True, std
+000044f0: 6f75 743d 7375 6270 726f 6365 7373 2e50  out=subprocess.P
+00004500: 4950 4529 0a20 2020 2074 696d 6572 2e73  IPE).    timer.s
+00004510: 746f 705f 7469 6d65 7228 290a 2020 2020  top_timer().    
+00004520: 7374 646f 7574 5f73 7563 6365 7373 280a  stdout_success(.
+00004530: 2020 2020 2020 2020 6d73 673d 6622 5349          msg=f"SI
+00004540: 4d42 4120 434f 4d50 4c45 5445 3a20 5669  MBA COMPLETE: Vi
+00004550: 6465 6f20 636f 6e76 6572 7465 6421 207b  deo converted! {
+00004560: 7361 7665 5f6e 616d 657d 2067 656e 6572  save_name} gener
+00004570: 6174 6564 2122 2c0a 2020 2020 2020 2020  ated!",.        
+00004580: 656c 6170 7365 645f 7469 6d65 3d74 696d  elapsed_time=tim
+00004590: 6572 2e65 6c61 7073 6564 5f74 696d 655f  er.elapsed_time_
+000045a0: 7374 722c 0a20 2020 2020 2020 2073 6f75  str,.        sou
+000045b0: 7263 653d 636f 6e76 6572 745f 746f 5f6d  rce=convert_to_m
+000045c0: 7034 2e5f 5f6e 616d 655f 5f2c 0a20 2020  p4.__name__,.   
+000045d0: 2029 0a0a 0a64 6566 2076 6964 656f 5f74   )...def video_t
+000045e0: 6f5f 6772 6579 7363 616c 6528 0a20 2020  o_greyscale(.   
+000045f0: 2066 696c 655f 7061 7468 3a20 556e 696f   file_path: Unio
+00004600: 6e5b 7374 722c 206f 732e 5061 7468 4c69  n[str, os.PathLi
+00004610: 6b65 5d2c 2067 7075 3a20 4f70 7469 6f6e  ke], gpu: Option
+00004620: 616c 5b62 6f6f 6c5d 203d 2046 616c 7365  al[bool] = False
+00004630: 0a29 202d 3e20 4e6f 6e65 3a0a 2020 2020  .) -> None:.    
+00004640: 2222 220a 2020 2020 436f 6e76 6572 7420  """.    Convert 
+00004650: 6120 7669 6465 6f20 6669 6c65 2074 6f20  a video file to 
+00004660: 6772 6579 7363 616c 6520 6d70 3420 666f  greyscale mp4 fo
+00004670: 726d 6174 2e20 5468 6520 7265 7375 6c74  rmat. The result
+00004680: 2069 7320 7374 6f72 6564 2069 6e20 7468   is stored in th
+00004690: 6520 7361 6d65 2064 6972 6563 746f 7279  e same directory
+000046a0: 2061 7320 7468 650a 2020 2020 696e 7075   as the.    inpu
+000046b0: 7420 6669 6c65 2077 6974 6820 7468 6520  t file with the 
+000046c0: 6060 5f67 7261 7973 6361 6c65 2e6d 7034  ``_grayscale.mp4
+000046d0: 6060 2073 7566 6669 782e 0a0a 2020 2020  `` suffix...    
+000046e0: 3a70 6172 616d 6574 6572 2055 6e69 6f6e  :parameter Union
+000046f0: 5b73 7472 2c20 6f73 2e50 6174 684c 696b  [str, os.PathLik
+00004700: 655d 2066 696c 655f 7061 7468 3a20 5061  e] file_path: Pa
+00004710: 7468 2074 6f20 7669 6465 6f20 6669 6c65  th to video file
+00004720: 2e0a 2020 2020 3a70 6172 616d 6574 6572  ..    :parameter
+00004730: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
+00004740: 6770 753a 2049 6620 5472 7565 2c20 7573  gpu: If True, us
+00004750: 6520 4e56 4944 4541 2047 5055 2063 6f64  e NVIDEA GPU cod
+00004760: 6563 732e 2044 6566 6175 6c74 2046 616c  ecs. Default Fal
+00004770: 7365 2e0a 2020 2020 3a72 6169 7365 2046  se..    :raise F
+00004780: 464d 5045 4743 6f64 6563 4750 5545 7272  FMPEGCodecGPUErr
+00004790: 6f72 3a20 4966 206e 6f20 4750 5520 6973  or: If no GPU is
+000047a0: 2066 6f75 6e64 2061 6e64 2060 6067 7075   found and ``gpu
+000047b0: 203d 3d20 5472 7565 6060 2e0a 2020 2020   == True``..    
+000047c0: 3a72 6169 7365 2046 696c 6545 7869 7374  :raise FileExist
+000047d0: 4572 726f 723a 2049 6620 7669 6465 6f20  Error: If video 
+000047e0: 6e61 6d65 2077 6974 6820 6060 5f67 7261  name with ``_gra
+000047f0: 7973 6361 6c65 6060 2073 7566 6669 7820  yscale`` suffix 
+00004800: 616c 7265 6164 7920 6578 6973 742e 0a0a  already exist...
+00004810: 2020 2020 3a65 7861 6d70 6c65 3a0a 2020      :example:.  
+00004820: 2020 3e3e 3e20 5f20 3d20 7669 6465 6f5f    >>> _ = video_
+00004830: 746f 5f67 7265 7973 6361 6c65 2866 696c  to_greyscale(fil
+00004840: 655f 7061 7468 3d27 7072 6f6a 6563 745f  e_path='project_
+00004850: 666f 6c64 6572 2f76 6964 656f 732f 5669  folder/videos/Vi
+00004860: 6465 6f5f 312e 6176 6927 290a 2020 2020  deo_1.avi').    
+00004870: 2222 220a 2020 2020 6368 6563 6b5f 6666  """.    check_ff
+00004880: 6d70 6567 5f61 7661 696c 6162 6c65 2872  mpeg_available(r
+00004890: 6169 7365 5f65 7272 6f72 3d54 7275 6529  aise_error=True)
+000048a0: 0a20 2020 2069 6620 6770 7520 616e 6420  .    if gpu and 
+000048b0: 6e6f 7420 6368 6563 6b5f 6e76 6964 6561  not check_nvidea
+000048c0: 5f67 7075 5f61 7661 696c 6162 6c65 2829  _gpu_available()
+000048d0: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
+000048e0: 4646 4d50 4547 436f 6465 6347 5055 4572  FFMPEGCodecGPUEr
+000048f0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+00004900: 206d 7367 3d22 4e6f 2047 5055 2066 6f75   msg="No GPU fou
+00004910: 6e64 2028 6173 2065 7661 6c75 6174 6564  nd (as evaluated
+00004920: 2062 7920 6e76 6964 6561 2d73 6d69 2072   by nvidea-smi r
+00004930: 6574 7572 6e69 6e67 204e 6f6e 6529 222c  eturning None)",
+00004940: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
+00004950: 7263 653d 7669 6465 6f5f 746f 5f67 7265  rce=video_to_gre
+00004960: 7973 6361 6c65 2e5f 5f6e 616d 655f 5f2c  yscale.__name__,
+00004970: 0a20 2020 2020 2020 2029 0a20 2020 2074  .        ).    t
+00004980: 696d 6572 203d 2053 696d 6261 5469 6d65  imer = SimbaTime
+00004990: 7228 7374 6172 743d 5472 7565 290a 2020  r(start=True).  
+000049a0: 2020 6368 6563 6b5f 6669 6c65 5f65 7869    check_file_exi
+000049b0: 7374 5f61 6e64 5f72 6561 6461 626c 6528  st_and_readable(
+000049c0: 6669 6c65 5f70 6174 683d 6669 6c65 5f70  file_path=file_p
+000049d0: 6174 6829 0a20 2020 2064 6972 2c20 6669  ath).    dir, fi
+000049e0: 6c65 5f6e 616d 652c 2065 7874 203d 2067  le_name, ext = g
+000049f0: 6574 5f66 6e5f 6578 7428 6669 6c65 7061  et_fn_ext(filepa
+00004a00: 7468 3d66 696c 655f 7061 7468 290a 2020  th=file_path).  
+00004a10: 2020 7361 7665 5f6e 616d 6520 3d20 6f73    save_name = os
+00004a20: 2e70 6174 682e 6a6f 696e 2864 6972 2c20  .path.join(dir, 
+00004a30: 6669 6c65 5f6e 616d 6520 2b20 225f 6772  file_name + "_gr
+00004a40: 6179 7363 616c 652e 6d70 3422 290a 2020  ayscale.mp4").  
+00004a50: 2020 6966 206f 732e 7061 7468 2e69 7366    if os.path.isf
+00004a60: 696c 6528 7361 7665 5f6e 616d 6529 3a0a  ile(save_name):.
+00004a70: 2020 2020 2020 2020 7261 6973 6520 4669          raise Fi
+00004a80: 6c65 4578 6973 7445 7272 6f72 280a 2020  leExistError(.  
+00004a90: 2020 2020 2020 2020 2020 6d73 673d 2253            msg="S
+00004aa0: 494d 4241 2045 5252 4f52 3a20 5468 6520  IMBA ERROR: The 
+00004ab0: 6f75 7466 696c 6520 6669 6c65 2061 6c72  outfile file alr
+00004ac0: 6561 6479 2065 7869 7374 3a20 7b7d 2e22  eady exist: {}."
+00004ad0: 2e66 6f72 6d61 7428 7361 7665 5f6e 616d  .format(save_nam
+00004ae0: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
+00004af0: 736f 7572 6365 3d76 6964 656f 5f74 6f5f  source=video_to_
+00004b00: 6772 6579 7363 616c 652e 5f5f 6e61 6d65  greyscale.__name
+00004b10: 5f5f 2c0a 2020 2020 2020 2020 290a 2020  __,.        ).  
+00004b20: 2020 6966 2067 7075 3a0a 2020 2020 2020    if gpu:.      
+00004b30: 2020 636f 6d6d 616e 6420 3d20 6627 6666    command = f'ff
+00004b40: 6d70 6567 202d 6877 6163 6365 6c20 6175  mpeg -hwaccel au
+00004b50: 746f 202d 633a 7620 6832 3634 5f63 7576  to -c:v h264_cuv
+00004b60: 6964 202d 6920 227b 6669 6c65 5f70 6174  id -i "{file_pat
+00004b70: 687d 2220 2d76 6620 2268 7775 706c 6f61  h}" -vf "hwuploa
+00004b80: 645f 6375 6461 2c68 7764 6f77 6e6c 6f61  d_cuda,hwdownloa
+00004b90: 642c 666f 726d 6174 3d6e 7631 322c 666f  d,format=nv12,fo
+00004ba0: 726d 6174 3d67 7261 7922 202d 633a 7620  rmat=gray" -c:v 
+00004bb0: 6832 3634 5f6e 7665 6e63 202d 633a 6120  h264_nvenc -c:a 
+00004bc0: 636f 7079 2022 7b73 6176 655f 6e61 6d65  copy "{save_name
+00004bd0: 7d22 270a 2020 2020 656c 7365 3a0a 2020  }"'.    else:.  
+00004be0: 2020 2020 2020 636f 6d6d 616e 6420 3d20        command = 
+00004bf0: 6627 6666 6d70 6567 202d 6920 227b 6669  f'ffmpeg -i "{fi
+00004c00: 6c65 5f70 6174 687d 2220 2d76 6620 666f  le_path}" -vf fo
+00004c10: 726d 6174 3d67 7261 7920 2d63 3a76 206c  rmat=gray -c:v l
+00004c20: 6962 7832 3634 2022 7b73 6176 655f 6e61  ibx264 "{save_na
+00004c30: 6d65 7d22 270a 2020 2020 7072 696e 7428  me}"'.    print(
+00004c40: 6622 436f 6e76 6572 7469 6e67 207b 6669  f"Converting {fi
+00004c50: 6c65 5f6e 616d 657d 2074 6f20 6772 6579  le_name} to grey
+00004c60: 7363 616c 652e 2e2e 2022 290a 2020 2020  scale... ").    
+00004c70: 7375 6270 726f 6365 7373 2e63 616c 6c28  subprocess.call(
+00004c80: 636f 6d6d 616e 642c 2073 6865 6c6c 3d54  command, shell=T
+00004c90: 7275 652c 2073 7464 6f75 743d 7375 6270  rue, stdout=subp
+00004ca0: 726f 6365 7373 2e50 4950 4529 0a20 2020  rocess.PIPE).   
+00004cb0: 2074 696d 6572 2e73 746f 705f 7469 6d65   timer.stop_time
+00004cc0: 7228 290a 2020 2020 7374 646f 7574 5f73  r().    stdout_s
+00004cd0: 7563 6365 7373 280a 2020 2020 2020 2020  uccess(.        
+00004ce0: 6d73 673d 6622 5349 4d42 4120 434f 4d50  msg=f"SIMBA COMP
+00004cf0: 4c45 5445 3a20 5669 6465 6f20 636f 6e76  LETE: Video conv
+00004d00: 6572 7465 6421 207b 7361 7665 5f6e 616d  erted! {save_nam
+00004d10: 657d 2067 656e 6572 6174 6564 2122 2c0a  e} generated!",.
+00004d20: 2020 2020 2020 2020 656c 6170 7365 645f          elapsed_
+00004d30: 7469 6d65 3d74 696d 6572 2e65 6c61 7073  time=timer.elaps
+00004d40: 6564 5f74 696d 655f 7374 722c 0a20 2020  ed_time_str,.   
+00004d50: 2020 2020 2073 6f75 7263 653d 7669 6465       source=vide
+00004d60: 6f5f 746f 5f67 7265 7973 6361 6c65 2e5f  o_to_greyscale._
+00004d70: 5f6e 616d 655f 5f2c 0a20 2020 2029 0a0a  _name__,.    )..
+00004d80: 0a64 6566 2062 6174 6368 5f76 6964 656f  .def batch_video
+00004d90: 5f74 6f5f 6772 6579 7363 616c 6528 0a20  _to_greyscale(. 
+00004da0: 2020 2064 6972 6563 746f 7279 3a20 556e     directory: Un
+00004db0: 696f 6e5b 7374 722c 206f 732e 5061 7468  ion[str, os.Path
+00004dc0: 4c69 6b65 5d2c 2067 7075 3a20 4f70 7469  Like], gpu: Opti
+00004dd0: 6f6e 616c 5b62 6f6f 6c5d 203d 2046 616c  onal[bool] = Fal
+00004de0: 7365 0a29 202d 3e20 4e6f 6e65 3a0a 2020  se.) -> None:.  
+00004df0: 2020 2222 220a 2020 2020 436f 6e76 6572    """.    Conver
+00004e00: 7420 6120 6469 7265 6374 6f72 7920 6f66  t a directory of
+00004e10: 2076 6964 656f 2066 696c 6520 746f 2067   video file to g
+00004e20: 7265 7973 6361 6c65 206d 7034 2066 6f72  reyscale mp4 for
+00004e30: 6d61 742e 2054 6865 2072 6573 756c 7473  mat. The results
+00004e40: 2061 7265 2073 746f 7265 6420 696e 2074   are stored in t
+00004e50: 6865 2073 616d 6520 6469 7265 6374 6f72  he same director
+00004e60: 7920 6173 2074 6865 0a20 2020 2069 6e70  y as the.    inp
+00004e70: 7574 2066 696c 6573 2077 6974 6820 7468  ut files with th
+00004e80: 6520 6060 5f67 7261 7973 6361 6c65 2e6d  e ``_grayscale.m
+00004e90: 7034 6060 2073 7566 6669 782e 0a0a 2020  p4`` suffix...  
+00004ea0: 2020 3a70 6172 616d 6574 6572 2055 6e69    :parameter Uni
+00004eb0: 6f6e 5b73 7472 2c20 6f73 2e50 6174 684c  on[str, os.PathL
+00004ec0: 696b 655d 2064 6972 6563 746f 7279 3a20  ike] directory: 
+00004ed0: 5061 7468 2074 6f20 6469 7265 6374 6f72  Path to director
+00004ee0: 7920 686f 6c64 696e 6720 7669 6465 6f20  y holding video 
+00004ef0: 6669 6c65 7320 696e 2063 6f6c 6f72 2e0a  files in color..
+00004f00: 2020 2020 3a70 6172 616d 6574 6572 204f      :parameter O
+00004f10: 7074 696f 6e61 6c5b 626f 6f6c 5d20 6770  ptional[bool] gp
+00004f20: 753a 2049 6620 5472 7565 2c20 7573 6520  u: If True, use 
+00004f30: 4e56 4944 4541 2047 5055 2063 6f64 6563  NVIDEA GPU codec
+00004f40: 732e 2044 6566 6175 6c74 2046 616c 7365  s. Default False
+00004f50: 2e0a 2020 2020 3a72 6169 7365 2046 464d  ..    :raise FFM
+00004f60: 5045 4743 6f64 6563 4750 5545 7272 6f72  PEGCodecGPUError
+00004f70: 3a20 4966 206e 6f20 4750 5520 6973 2066  : If no GPU is f
+00004f80: 6f75 6e64 2061 6e64 2060 6067 7075 203d  ound and ``gpu =
+00004f90: 3d20 5472 7565 6060 2e0a 0a20 2020 203a  = True``...    :
+00004fa0: 6578 616d 706c 653a 0a20 2020 203e 3e3e  example:.    >>>
+00004fb0: 205f 203d 2062 6174 6368 5f76 6964 656f   _ = batch_video
+00004fc0: 5f74 6f5f 6772 6579 7363 616c 6528 6469  _to_greyscale(di
+00004fd0: 7265 6374 6f72 793d 272f 5573 6572 732f  rectory='/Users/
+00004fe0: 7369 6d6f 6e2f 4465 736b 746f 702f 656e  simon/Desktop/en
+00004ff0: 7673 2f73 696d 6261 2f74 726f 7562 6c65  vs/simba/trouble
+00005000: 7368 6f6f 7469 6e67 2f6d 6f75 7365 5f6f  shooting/mouse_o
+00005010: 7065 6e5f 6669 656c 642f 7072 6f6a 6563  pen_field/projec
+00005020: 745f 666f 6c64 6572 2f76 6964 656f 732f  t_folder/videos/
+00005030: 7465 7374 5f32 2729 0a20 2020 2022 2222  test_2').    """
+00005040: 0a20 2020 2063 6865 636b 5f66 666d 7065  .    check_ffmpe
+00005050: 675f 6176 6169 6c61 626c 6528 7261 6973  g_available(rais
+00005060: 655f 6572 726f 723d 5472 7565 290a 2020  e_error=True).  
+00005070: 2020 6966 2067 7075 2061 6e64 206e 6f74    if gpu and not
+00005080: 2063 6865 636b 5f6e 7669 6465 615f 6770   check_nvidea_gp
+00005090: 755f 6176 6169 6c61 626c 6528 293a 0a20  u_available():. 
+000050a0: 2020 2020 2020 2072 6169 7365 2046 464d         raise FFM
+000050b0: 5045 4743 6f64 6563 4750 5545 7272 6f72  PEGCodecGPUError
+000050c0: 280a 2020 2020 2020 2020 2020 2020 6d73  (.            ms
+000050d0: 673d 224e 6f20 4750 5520 666f 756e 6420  g="No GPU found 
+000050e0: 2861 7320 6576 616c 7561 7465 6420 6279  (as evaluated by
+000050f0: 206e 7669 6465 612d 736d 6920 7265 7475   nvidea-smi retu
+00005100: 726e 696e 6720 4e6f 6e65 2922 2c0a 2020  rning None)",.  
+00005110: 2020 2020 2020 2020 2020 736f 7572 6365            source
+00005120: 3d62 6174 6368 5f76 6964 656f 5f74 6f5f  =batch_video_to_
+00005130: 6772 6579 7363 616c 652e 5f5f 6e61 6d65  greyscale.__name
+00005140: 5f5f 2c0a 2020 2020 2020 2020 290a 2020  __,.        ).  
+00005150: 2020 7469 6d65 7220 3d20 5369 6d62 6154    timer = SimbaT
+00005160: 696d 6572 2873 7461 7274 3d54 7275 6529  imer(start=True)
+00005170: 0a20 2020 2063 6865 636b 5f69 665f 6469  .    check_if_di
+00005180: 725f 6578 6973 7473 2869 6e5f 6469 723d  r_exists(in_dir=
+00005190: 6469 7265 6374 6f72 792c 2073 6f75 7263  directory, sourc
+000051a0: 653d 6261 7463 685f 7669 6465 6f5f 746f  e=batch_video_to
+000051b0: 5f67 7265 7973 6361 6c65 2e5f 5f6e 616d  _greyscale.__nam
+000051c0: 655f 5f29 0a20 2020 2076 6964 656f 5f70  e__).    video_p
+000051d0: 6174 6873 203d 2066 696e 645f 616c 6c5f  aths = find_all_
+000051e0: 7669 6465 6f73 5f69 6e5f 6469 7265 6374  videos_in_direct
+000051f0: 6f72 7928 0a20 2020 2020 2020 2064 6972  ory(.        dir
+00005200: 6563 746f 7279 3d64 6972 6563 746f 7279  ectory=directory
+00005210: 2c20 6173 5f64 6963 743d 5472 7565 2c20  , as_dict=True, 
+00005220: 7261 6973 655f 6572 726f 723d 5472 7565  raise_error=True
+00005230: 0a20 2020 2029 0a20 2020 2066 6f72 2066  .    ).    for f
+00005240: 696c 655f 636e 742c 2028 6669 6c65 5f6e  ile_cnt, (file_n
+00005250: 616d 652c 2066 696c 655f 7061 7468 2920  ame, file_path) 
+00005260: 696e 2065 6e75 6d65 7261 7465 2876 6964  in enumerate(vid
+00005270: 656f 5f70 6174 6873 2e69 7465 6d73 2829  eo_paths.items()
+00005280: 293a 0a20 2020 2020 2020 2076 6964 656f  ):.        video
+00005290: 5f74 696d 6572 203d 2053 696d 6261 5469  _timer = SimbaTi
+000052a0: 6d65 7228 7374 6172 743d 5472 7565 290a  mer(start=True).
+000052b0: 2020 2020 2020 2020 696e 5f64 6972 2c20          in_dir, 
+000052c0: 5f2c 205f 203d 2067 6574 5f66 6e5f 6578  _, _ = get_fn_ex
+000052d0: 7428 6669 6c65 7061 7468 3d66 696c 655f  t(filepath=file_
+000052e0: 7061 7468 290a 2020 2020 2020 2020 7361  path).        sa
+000052f0: 7665 5f6e 616d 6520 3d20 6f73 2e70 6174  ve_name = os.pat
+00005300: 682e 6a6f 696e 2869 6e5f 6469 722c 2066  h.join(in_dir, f
+00005310: 227b 6669 6c65 5f6e 616d 657d 5f67 7261  "{file_name}_gra
+00005320: 7973 6361 6c65 2e6d 7034 2229 0a20 2020  yscale.mp4").   
+00005330: 2020 2020 2069 6620 6770 753a 0a20 2020       if gpu:.   
+00005340: 2020 2020 2020 2020 2063 6f6d 6d61 6e64           command
+00005350: 203d 2066 2766 666d 7065 6720 2d68 7761   = f'ffmpeg -hwa
+00005360: 6363 656c 2061 7574 6f20 2d63 3a76 2068  ccel auto -c:v h
+00005370: 3236 345f 6375 7669 6420 2d69 2022 7b66  264_cuvid -i "{f
+00005380: 696c 655f 7061 7468 7d22 202d 7666 2022  ile_path}" -vf "
+00005390: 6877 7570 6c6f 6164 5f63 7564 612c 6877  hwupload_cuda,hw
+000053a0: 646f 776e 6c6f 6164 2c66 6f72 6d61 743d  download,format=
+000053b0: 6e76 3132 2c66 6f72 6d61 743d 6772 6179  nv12,format=gray
+000053c0: 2220 2d63 3a76 2068 3236 345f 6e76 656e  " -c:v h264_nven
+000053d0: 6320 2d63 3a61 2063 6f70 7920 227b 7361  c -c:a copy "{sa
+000053e0: 7665 5f6e 616d 657d 2220 2d79 270a 2020  ve_name}" -y'.  
+000053f0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00005400: 2020 2020 2020 2020 636f 6d6d 616e 6420          command 
+00005410: 3d20 6627 6666 6d70 6567 202d 6920 227b  = f'ffmpeg -i "{
+00005420: 6669 6c65 5f70 6174 687d 2220 2d76 6620  file_path}" -vf 
+00005430: 666f 726d 6174 3d67 7261 7920 2d63 3a76  format=gray -c:v
+00005440: 206c 6962 7832 3634 2022 7b73 6176 655f   libx264 "{save_
+00005450: 6e61 6d65 7d22 202d 6869 6465 5f62 616e  name}" -hide_ban
+00005460: 6e65 7220 2d6c 6f67 6c65 7665 6c20 6572  ner -loglevel er
+00005470: 726f 7220 2d79 270a 2020 2020 2020 2020  ror -y'.        
+00005480: 7072 696e 7428 0a20 2020 2020 2020 2020  print(.         
+00005490: 2020 2066 2243 6f6e 7665 7274 696e 6720     f"Converting 
+000054a0: 7b66 696c 655f 6e61 6d65 7d20 746f 2067  {file_name} to g
+000054b0: 7265 7973 6361 6c65 2028 5669 6465 6f20  reyscale (Video 
+000054c0: 7b66 696c 655f 636e 742b 317d 2f7b 6c65  {file_cnt+1}/{le
+000054d0: 6e28 6c69 7374 2876 6964 656f 5f70 6174  n(list(video_pat
+000054e0: 6873 2e6b 6579 7328 2929 297d 292e 2e2e  hs.keys()))})...
+000054f0: 2022 0a20 2020 2020 2020 2029 0a20 2020   ".        ).   
+00005500: 2020 2020 2073 7562 7072 6f63 6573 732e       subprocess.
+00005510: 6361 6c6c 2863 6f6d 6d61 6e64 2c20 7368  call(command, sh
+00005520: 656c 6c3d 5472 7565 2c20 7374 646f 7574  ell=True, stdout
+00005530: 3d73 7562 7072 6f63 6573 732e 5049 5045  =subprocess.PIPE
+00005540: 290a 2020 2020 2020 2020 7669 6465 6f5f  ).        video_
+00005550: 7469 6d65 722e 7374 6f70 5f74 696d 6572  timer.stop_timer
+00005560: 2829 0a20 2020 2020 2020 2070 7269 6e74  ().        print
+00005570: 280a 2020 2020 2020 2020 2020 2020 6622  (.            f"
+00005580: 5669 6465 6f20 7b73 6176 655f 6e61 6d65  Video {save_name
+00005590: 7d20 636f 6d70 6c65 7465 2c20 2865 6c61  } complete, (ela
+000055a0: 7073 6564 2074 696d 653a 207b 7669 6465  psed time: {vide
+000055b0: 6f5f 7469 6d65 722e 656c 6170 7365 645f  o_timer.elapsed_
+000055c0: 7469 6d65 5f73 7472 7d73 2922 0a20 2020  time_str}s)".   
+000055d0: 2020 2020 2029 0a20 2020 2074 696d 6572       ).    timer
+000055e0: 2e73 746f 705f 7469 6d65 7228 290a 2020  .stop_timer().  
+000055f0: 2020 7374 646f 7574 5f73 7563 6365 7373    stdout_success
+00005600: 280a 2020 2020 2020 2020 6d73 673d 6622  (.        msg=f"
+00005610: 7b6c 656e 286c 6973 7428 7669 6465 6f5f  {len(list(video_
+00005620: 7061 7468 732e 6b65 7973 2829 2929 7d20  paths.keys()))} 
+00005630: 7669 6465 6f28 7329 2063 6f6e 7665 7274  video(s) convert
+00005640: 6564 2074 6f20 6772 6573 7973 6361 6c65  ed to gresyscale
+00005650: 2120 5361 7665 6420 696e 207b 6469 7265  ! Saved in {dire
+00005660: 6374 6f72 797d 2077 6974 6820 275f 6772  ctory} with '_gr
+00005670: 6579 7363 616c 6527 2073 7566 6669 7822  eyscale' suffix"
+00005680: 2c0a 2020 2020 2020 2020 656c 6170 7365  ,.        elapse
+00005690: 645f 7469 6d65 3d74 696d 6572 2e65 6c61  d_time=timer.ela
+000056a0: 7073 6564 5f74 696d 655f 7374 722c 0a20  psed_time_str,. 
+000056b0: 2020 2020 2020 2073 6f75 7263 653d 6261         source=ba
+000056c0: 7463 685f 7669 6465 6f5f 746f 5f67 7265  tch_video_to_gre
+000056d0: 7973 6361 6c65 2e5f 5f6e 616d 655f 5f2c  yscale.__name__,
+000056e0: 0a20 2020 2029 0a0a 0a64 6566 2073 7570  .    )...def sup
+000056f0: 6572 696d 706f 7365 5f66 7261 6d65 5f63  erimpose_frame_c
+00005700: 6f75 6e74 280a 2020 2020 6669 6c65 5f70  ount(.    file_p
+00005710: 6174 683a 2055 6e69 6f6e 5b73 7472 2c20  ath: Union[str, 
+00005720: 6f73 2e50 6174 684c 696b 655d 2c20 6770  os.PathLike], gp
+00005730: 753a 204f 7074 696f 6e61 6c5b 626f 6f6c  u: Optional[bool
+00005740: 5d20 3d20 4661 6c73 650a 2920 2d3e 204e  ] = False.) -> N
+00005750: 6f6e 653a 0a20 2020 2022 2222 0a20 2020  one:.    """.   
+00005760: 2053 7570 6572 696d 706f 7365 2066 7261   Superimpose fra
+00005770: 6d65 2063 6f75 6e74 206f 6e20 6120 7669  me count on a vi
+00005780: 6465 6f20 6669 6c65 2e20 5468 6520 7265  deo file. The re
+00005790: 7375 6c74 2069 7320 7374 6f72 6564 2069  sult is stored i
+000057a0: 6e20 7468 6520 7361 6d65 2064 6972 6563  n the same direc
+000057b0: 746f 7279 2061 7320 7468 650a 2020 2020  tory as the.    
+000057c0: 696e 7075 7420 6669 6c65 2077 6974 6820  input file with 
+000057d0: 7468 6520 6060 5f66 7261 6d65 5f6e 6f2e  the ``_frame_no.
+000057e0: 6d70 3460 6020 7375 6666 6978 2e0a 0a20  mp4`` suffix... 
+000057f0: 2020 203a 7061 7261 6d65 7465 7220 556e     :parameter Un
+00005800: 696f 6e5b 7374 722c 206f 732e 5061 7468  ion[str, os.Path
+00005810: 4c69 6b65 5d20 6669 6c65 5f70 6174 683a  Like] file_path:
+00005820: 2050 6174 6820 746f 2076 6964 656f 2066   Path to video f
+00005830: 696c 652e 0a20 2020 203a 7061 7261 6d65  ile..    :parame
+00005840: 7465 7220 4f70 7469 6f6e 616c 5b62 6f6f  ter Optional[boo
+00005850: 6c5d 2067 7075 3a20 4966 2054 7275 652c  l] gpu: If True,
+00005860: 2075 7365 204e 5649 4445 4120 4750 5520   use NVIDEA GPU 
+00005870: 636f 6465 6373 2e20 4465 6661 756c 7420  codecs. Default 
+00005880: 4661 6c73 652e 0a0a 2020 2020 3a65 7861  False...    :exa
+00005890: 6d70 6c65 3a0a 2020 2020 3e3e 3e20 5f20  mple:.    >>> _ 
+000058a0: 3d20 7375 7065 7269 6d70 6f73 655f 6672  = superimpose_fr
+000058b0: 616d 655f 636f 756e 7428 6669 6c65 5f70  ame_count(file_p
+000058c0: 6174 683d 2770 726f 6a65 6374 5f66 6f6c  ath='project_fol
+000058d0: 6465 722f 7669 6465 6f73 2f56 6964 656f  der/videos/Video
+000058e0: 5f31 2e61 7669 2729 0a20 2020 2022 2222  _1.avi').    """
+000058f0: 0a20 2020 2063 6865 636b 5f66 666d 7065  .    check_ffmpe
+00005900: 675f 6176 6169 6c61 626c 6528 7261 6973  g_available(rais
+00005910: 655f 6572 726f 723d 5472 7565 290a 2020  e_error=True).  
+00005920: 2020 7369 6d62 615f 6377 203d 206f 732e    simba_cw = os.
+00005930: 7061 7468 2e64 6972 6e61 6d65 2873 696d  path.dirname(sim
+00005940: 6261 2e5f 5f66 696c 655f 5f29 0a20 2020  ba.__file__).   
+00005950: 2073 696d 6261 5f66 6f6e 745f 7061 7468   simba_font_path
+00005960: 203d 206f 732e 7061 7468 2e6a 6f69 6e28   = os.path.join(
+00005970: 7369 6d62 615f 6377 2c20 2261 7373 6574  simba_cw, "asset
+00005980: 7322 2c20 2255 6275 6e74 754d 6f6e 6f2d  s", "UbuntuMono-
+00005990: 5265 6775 6c61 722e 7474 6622 290a 2020  Regular.ttf").  
+000059a0: 2020 7469 6d65 7220 3d20 5369 6d62 6154    timer = SimbaT
+000059b0: 696d 6572 2873 7461 7274 3d54 7275 6529  imer(start=True)
+000059c0: 0a20 2020 2069 6620 6e6f 7420 6f73 2e70  .    if not os.p
+000059d0: 6174 682e 6973 6669 6c65 2873 696d 6261  ath.isfile(simba
+000059e0: 5f66 6f6e 745f 7061 7468 293a 0a20 2020  _font_path):.   
+000059f0: 2020 2020 2069 6620 706c 6174 666f 726d       if platform
+00005a00: 2e73 7973 7465 6d28 2920 3d3d 204f 532e  .system() == OS.
+00005a10: 5749 4e44 4f57 532e 7661 6c75 653a 0a20  WINDOWS.value:. 
+00005a20: 2020 2020 2020 2020 2020 2073 696d 6261             simba
+00005a30: 5f66 6f6e 745f 7061 7468 203d 2022 433a  _font_path = "C:
+00005a40: 2f57 696e 646f 7773 2f66 6f6e 7473 2f61  /Windows/fonts/a
+00005a50: 7269 616c 2e74 7466 220a 2020 2020 2020  rial.ttf".      
+00005a60: 2020 2020 2020 6966 206e 6f74 206f 732e        if not os.
+00005a70: 7061 7468 2e69 7366 696c 6528 7369 6d62  path.isfile(simb
+00005a80: 615f 666f 6e74 5f70 6174 6829 3a0a 2020  a_font_path):.  
+00005a90: 2020 2020 2020 2020 2020 2020 2020 7369                si
+00005aa0: 6d62 615f 666f 6e74 5f70 6174 6820 3d20  mba_font_path = 
+00005ab0: 6f73 2e6c 6973 7464 6972 2872 2243 3a2f  os.listdir(r"C:/
+00005ac0: 5769 6e64 6f77 732f 666f 6e74 7322 295b  Windows/fonts")[
+00005ad0: 305d 0a20 2020 2020 2020 2020 2020 2073  0].            s
+00005ae0: 696d 6261 5f66 6f6e 745f 7061 7468 203d  imba_font_path =
+00005af0: 2073 696d 6261 5f66 6f6e 745f 7061 7468   simba_font_path
+00005b00: 5b32 3a5d 2e72 6570 6c61 6365 2822 5c5c  [2:].replace("\\
+00005b10: 222c 2022 2f22 290a 2020 2020 2020 2020  ", "/").        
+00005b20: 656c 6966 2028 706c 6174 666f 726d 2e73  elif (platform.s
+00005b30: 7973 7465 6d28 2920 3d3d 204f 532e 4d41  ystem() == OS.MA
+00005b40: 432e 7661 6c75 6529 206f 7220 280a 2020  C.value) or (.  
+00005b50: 2020 2020 2020 2020 2020 706c 6174 666f            platfo
+00005b60: 726d 2e73 7973 7465 6d28 2920 3d3d 204f  rm.system() == O
+00005b70: 532e 4c49 4e55 582e 7661 6c75 650a 2020  S.LINUX.value.  
+00005b80: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+00005b90: 2020 2020 2073 696d 6261 5f66 6f6e 745f       simba_font_
+00005ba0: 7061 7468 203d 2022 4172 6961 6c2e 7474  path = "Arial.tt
+00005bb0: 6622 0a20 2020 2065 6c73 653a 0a20 2020  f".    else:.   
+00005bc0: 2020 2020 2069 6620 706c 6174 666f 726d       if platform
+00005bd0: 2e73 7973 7465 6d28 2920 3d3d 204f 532e  .system() == OS.
+00005be0: 5749 4e44 4f57 532e 7661 6c75 653a 0a20  WINDOWS.value:. 
+00005bf0: 2020 2020 2020 2020 2020 2073 696d 6261             simba
+00005c00: 5f66 6f6e 745f 7061 7468 203d 2073 7472  _font_path = str
+00005c10: 2873 696d 6261 5f66 6f6e 745f 7061 7468  (simba_font_path
+00005c20: 5b32 3a5d 2e72 6570 6c61 6365 2822 5c5c  [2:].replace("\\
+00005c30: 222c 2022 2f22 2929 0a20 2020 2063 6865  ", "/")).    che
+00005c40: 636b 5f66 696c 655f 6578 6973 745f 616e  ck_file_exist_an
+00005c50: 645f 7265 6164 6162 6c65 2866 696c 655f  d_readable(file_
+00005c60: 7061 7468 3d66 696c 655f 7061 7468 290a  path=file_path).
+00005c70: 2020 2020 6469 722c 2066 696c 655f 6e61      dir, file_na
+00005c80: 6d65 2c20 6578 7420 3d20 6765 745f 666e  me, ext = get_fn
+00005c90: 5f65 7874 2866 696c 6570 6174 683d 6669  _ext(filepath=fi
+00005ca0: 6c65 5f70 6174 6829 0a20 2020 2073 6176  le_path).    sav
+00005cb0: 655f 6e61 6d65 203d 206f 732e 7061 7468  e_name = os.path
+00005cc0: 2e6a 6f69 6e28 6469 722c 2066 696c 655f  .join(dir, file_
+00005cd0: 6e61 6d65 202b 2022 5f66 7261 6d65 5f6e  name + "_frame_n
+00005ce0: 6f2e 6d70 3422 290a 2020 2020 7072 696e  o.mp4").    prin
+00005cf0: 7428 6622 5375 7065 7269 6d70 6f73 696e  t(f"Superimposin
+00005d00: 6720 6672 616d 6520 6e75 6d62 6572 7320  g frame numbers 
+00005d10: 7573 696e 6720 666f 6e74 2070 6174 6820  using font path 
+00005d20: 7b73 696d 6261 5f66 6f6e 745f 7061 7468  {simba_font_path
+00005d30: 7d2e 2e2e 2e2e 2e20 2229 0a20 2020 2074  }...... ").    t
+00005d40: 7279 3a0a 2020 2020 2020 2020 6966 2067  ry:.        if g
+00005d50: 7075 3a0a 2020 2020 2020 2020 2020 2020  pu:.            
+00005d60: 636f 6d6d 616e 6420 3d20 6627 6666 6d70  command = f'ffmp
+00005d70: 6567 202d 6877 6163 6365 6c20 6175 746f  eg -hwaccel auto
+00005d80: 202d 633a 7620 6832 3634 5f63 7576 6964   -c:v h264_cuvid
+00005d90: 202d 6920 227b 6669 6c65 5f70 6174 687d   -i "{file_path}
+00005da0: 2220 2d76 6620 2264 7261 7774 6578 743d  " -vf "drawtext=
+00005db0: 666f 6e74 6669 6c65 3d7b 7369 6d62 615f  fontfile={simba_
+00005dc0: 666f 6e74 5f70 6174 687d 3a74 6578 743d  font_path}:text=
+00005dd0: 257b 7b6e 7d7d 3a78 3d28 772d 7477 292f  %{{n}}:x=(w-tw)/
+00005de0: 323a 793d 682d 7468 2d31 303a 666f 6e74  2:y=h-th-10:font
+00005df0: 636f 6c6f 723d 7768 6974 653a 626f 783d  color=white:box=
+00005e00: 313a 626f 7863 6f6c 6f72 3d77 6869 7465  1:boxcolor=white
+00005e10: 4030 2e35 2220 2d63 3a76 2068 3236 345f  @0.5" -c:v h264_
+00005e20: 6e76 656e 6320 2d63 3a61 2063 6f70 7920  nvenc -c:a copy 
+00005e30: 227b 7361 7665 5f6e 616d 657d 2220 2d79  "{save_name}" -y
+00005e40: 270a 2020 2020 2020 2020 656c 7365 3a0a  '.        else:.
+00005e50: 2020 2020 2020 2020 2020 2020 636f 6d6d              comm
+00005e60: 616e 6420 3d20 6627 6666 6d70 6567 202d  and = f'ffmpeg -
+00005e70: 7920 2d69 2022 7b66 696c 655f 7061 7468  y -i "{file_path
+00005e80: 7d22 202d 7666 2022 6472 6177 7465 7874  }" -vf "drawtext
+00005e90: 3d66 6f6e 7466 696c 653d 7b73 696d 6261  =fontfile={simba
+00005ea0: 5f66 6f6e 745f 7061 7468 7d3a 2074 6578  _font_path}: tex
+00005eb0: 743d 5c27 257b 7b66 7261 6d65 5f6e 756d  t=\'%{{frame_num
+00005ec0: 7d7d 5c27 3a20 7374 6172 745f 6e75 6d62  }}\': start_numb
+00005ed0: 6572 3d30 3a20 783d 2877 2d74 7729 2f32  er=0: x=(w-tw)/2
+00005ee0: 3a20 793d 682d 2832 2a6c 6829 3a20 666f  : y=h-(2*lh): fo
+00005ef0: 6e74 636f 6c6f 723d 626c 6163 6b3a 2066  ntcolor=black: f
+00005f00: 6f6e 7473 697a 653d 3230 3a20 626f 783d  ontsize=20: box=
+00005f10: 313a 2062 6f78 636f 6c6f 723d 7768 6974  1: boxcolor=whit
+00005f20: 653a 2062 6f78 626f 7264 6572 773d 3522  e: boxborderw=5"
+00005f30: 202d 633a 6120 636f 7079 2022 7b73 6176   -c:a copy "{sav
+00005f40: 655f 6e61 6d65 7d22 202d 7927 0a20 2020  e_name}" -y'.   
+00005f50: 2020 2020 2070 7269 6e74 2866 2255 7369       print(f"Usi
+00005f60: 6e67 2066 6f6e 7420 7061 7468 207b 7369  ng font path {si
+00005f70: 6d62 615f 666f 6e74 5f70 6174 687d 2e2e  mba_font_path}..
+00005f80: 2e22 290a 2020 2020 2020 2020 7375 6270  .").        subp
+00005f90: 726f 6365 7373 2e63 6865 636b 5f6f 7574  rocess.check_out
+00005fa0: 7075 7428 636f 6d6d 616e 642c 2073 6865  put(command, she
+00005fb0: 6c6c 3d54 7275 6529 0a20 2020 2020 2020  ll=True).       
+00005fc0: 2073 7562 7072 6f63 6573 732e 6361 6c6c   subprocess.call
+00005fd0: 2863 6f6d 6d61 6e64 2c20 7368 656c 6c3d  (command, shell=
+00005fe0: 5472 7565 2c20 7374 646f 7574 3d73 7562  True, stdout=sub
+00005ff0: 7072 6f63 6573 732e 5049 5045 290a 2020  process.PIPE).  
+00006000: 2020 6578 6365 7074 2073 7562 7072 6f63    except subproc
+00006010: 6573 732e 4361 6c6c 6564 5072 6f63 6573  ess.CalledProces
+00006020: 7345 7272 6f72 2061 7320 653a 0a20 2020  sError as e:.   
+00006030: 2020 2020 2069 6620 6770 753a 0a20 2020       if gpu:.   
+00006040: 2020 2020 2020 2020 2063 6f6d 6d61 6e64           command
+00006050: 203d 2066 2766 666d 7065 6720 2d68 7761   = f'ffmpeg -hwa
+00006060: 6363 656c 2061 7574 6f20 2d63 3a76 2068  ccel auto -c:v h
+00006070: 3236 345f 6375 7669 6420 2d69 2022 7b66  264_cuvid -i "{f
+00006080: 696c 655f 7061 7468 7d22 202d 7666 2022  ile_path}" -vf "
+00006090: 6472 6177 7465 7874 3d66 6f6e 7473 697a  drawtext=fontsiz
+000060a0: 653d 3234 3a66 6f6e 7466 696c 653d 7b73  e=24:fontfile={s
+000060b0: 696d 6261 5f66 6f6e 745f 7061 7468 7d3a  imba_font_path}:
+000060c0: 7465 7874 3d25 7b7b 6e7d 7d3a 783d 2877  text=%{{n}}:x=(w
+000060d0: 2d74 7729 2f32 3a79 3d68 2d74 682d 3130  -tw)/2:y=h-th-10
+000060e0: 3a66 6f6e 7463 6f6c 6f72 3d77 6869 7465  :fontcolor=white
+000060f0: 3a62 6f78 3d31 3a62 6f78 636f 6c6f 723d  :box=1:boxcolor=
+00006100: 7768 6974 6540 302e 3522 202d 633a 7620  white@0.5" -c:v 
+00006110: 6832 3634 5f6e 7665 6e63 202d 633a 6120  h264_nvenc -c:a 
+00006120: 636f 7079 2022 7b73 6176 655f 6e61 6d65  copy "{save_name
+00006130: 7d22 202d 7927 0a20 2020 2020 2020 2065  }" -y'.        e
+00006140: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00006150: 2063 6f6d 6d61 6e64 203d 2066 2766 666d   command = f'ffm
+00006160: 7065 6720 2d79 202d 6920 227b 6669 6c65  peg -y -i "{file
+00006170: 5f70 6174 687d 2220 2d76 6620 2264 7261  _path}" -vf "dra
+00006180: 7774 6578 743d 666f 6e74 6669 6c65 3d7b  wtext=fontfile={
+00006190: 7369 6d62 615f 666f 6e74 5f70 6174 687d  simba_font_path}
+000061a0: 3a74 6578 743d 5c27 257b 7b66 7261 6d65  :text=\'%{{frame
+000061b0: 5f6e 756d 7d7d 5c27 3a73 7461 7274 5f6e  _num}}\':start_n
+000061c0: 756d 6265 723d 313a 783d 2877 2d74 7729  umber=1:x=(w-tw)
+000061d0: 2f32 3a79 3d68 2d28 322a 6c68 293a 666f  /2:y=h-(2*lh):fo
+000061e0: 6e74 636f 6c6f 723d 626c 6163 6b3a 666f  ntcolor=black:fo
+000061f0: 6e74 7369 7a65 3d32 303a 626f 783d 313a  ntsize=20:box=1:
+00006200: 626f 7863 6f6c 6f72 3d77 6869 7465 3a62  boxcolor=white:b
+00006210: 6f78 626f 7264 6572 773d 3522 202d 633a  oxborderw=5" -c:
+00006220: 6120 636f 7079 2022 7b73 6176 655f 6e61  a copy "{save_na
+00006230: 6d65 7d22 202d 7927 0a20 2020 2020 2020  me}" -y'.       
+00006240: 2070 7269 6e74 2866 2255 7369 6e67 2066   print(f"Using f
+00006250: 6f6e 7420 7061 7468 207b 7369 6d62 615f  ont path {simba_
+00006260: 666f 6e74 5f70 6174 687d 2e2e 2e22 290a  font_path}...").
+00006270: 2020 2020 2020 2020 7375 6270 726f 6365          subproce
+00006280: 7373 2e63 616c 6c28 636f 6d6d 616e 642c  ss.call(command,
+00006290: 2073 6865 6c6c 3d54 7275 652c 2073 7464   shell=True, std
+000062a0: 6f75 743d 7375 6270 726f 6365 7373 2e50  out=subprocess.P
+000062b0: 4950 4529 0a20 2020 2074 696d 6572 2e73  IPE).    timer.s
+000062c0: 746f 705f 7469 6d65 7228 290a 2020 2020  top_timer().    
+000062d0: 7374 646f 7574 5f73 7563 6365 7373 280a  stdout_success(.
+000062e0: 2020 2020 2020 2020 6d73 673d 6622 5375          msg=f"Su
+000062f0: 7065 7269 6d70 6f73 6564 2076 6964 656f  perimposed video
+00006300: 2063 6f6e 7665 7274 6564 2120 7b73 6176   converted! {sav
+00006310: 655f 6e61 6d65 7d20 6765 6e65 7261 7465  e_name} generate
+00006320: 6421 222c 0a20 2020 2020 2020 2065 6c61  d!",.        ela
+00006330: 7073 6564 5f74 696d 653d 7469 6d65 722e  psed_time=timer.
+00006340: 656c 6170 7365 645f 7469 6d65 5f73 7472  elapsed_time_str
+00006350: 2c0a 2020 2020 290a 0a0a 2320 5f20 3d20  ,.    )...# _ = 
+00006360: 7375 7065 7269 6d70 6f73 655f 6672 616d  superimpose_fram
+00006370: 655f 636f 756e 7428 6669 6c65 5f70 6174  e_count(file_pat
+00006380: 683d 7227 2f55 7365 7273 2f73 696d 6f6e  h=r'/Users/simon
+00006390: 2f44 6573 6b74 6f70 2f65 6e76 732f 7369  /Desktop/envs/si
+000063a0: 6d62 612f 7472 6f75 626c 6573 686f 6f74  mba/troubleshoot
+000063b0: 696e 672f 6d6f 7573 655f 6f70 656e 5f66  ing/mouse_open_f
+000063c0: 6965 6c64 2f70 726f 6a65 6374 5f66 6f6c  ield/project_fol
+000063d0: 6465 722f 7669 6465 6f73 2f53 495f 4441  der/videos/SI_DA
+000063e0: 5933 5f33 3038 5f43 4431 5f50 5245 5345  Y3_308_CD1_PRESE
+000063f0: 4e54 2e6d 7034 272c 2067 7075 3d46 616c  NT.mp4', gpu=Fal
+00006400: 7365 290a 0a0a 6465 6620 7265 6d6f 7665  se)...def remove
+00006410: 5f62 6567 696e 6e69 6e67 5f6f 665f 7669  _beginning_of_vi
+00006420: 6465 6f28 0a20 2020 2066 696c 655f 7061  deo(.    file_pa
+00006430: 7468 3a20 556e 696f 6e5b 7374 722c 206f  th: Union[str, o
+00006440: 732e 5061 7468 4c69 6b65 5d2c 2074 696d  s.PathLike], tim
+00006450: 653a 2069 6e74 2c20 6770 753a 204f 7074  e: int, gpu: Opt
+00006460: 696f 6e61 6c5b 626f 6f6c 5d20 3d20 4661  ional[bool] = Fa
+00006470: 6c73 650a 2920 2d3e 204e 6f6e 653a 0a20  lse.) -> None:. 
+00006480: 2020 2022 2222 0a20 2020 2052 656d 6f76     """.    Remov
+00006490: 6520 4e20 7365 636f 6e64 7320 6672 6f6d  e N seconds from
+000064a0: 2074 6865 2062 6567 696e 6e69 6e67 206f   the beginning o
+000064b0: 6620 6120 7669 6465 6f20 6669 6c65 2e20  f a video file. 
+000064c0: 5468 6520 7265 7375 6c74 2069 7320 7374  The result is st
+000064d0: 6f72 6564 2069 6e20 7468 6520 7361 6d65  ored in the same
+000064e0: 2064 6972 6563 746f 7279 2061 7320 7468   directory as th
+000064f0: 650a 2020 2020 696e 7075 7420 6669 6c65  e.    input file
+00006500: 2077 6974 6820 7468 6520 6060 5f73 686f   with the ``_sho
+00006510: 7274 656e 2e6d 7034 6060 2073 7566 6669  rten.mp4`` suffi
+00006520: 782e 0a0a 2020 2020 3a70 6172 616d 6574  x...    :paramet
+00006530: 6572 2055 6e69 6f6e 5b73 7472 2c20 6f73  er Union[str, os
+00006540: 2e50 6174 684c 696b 655d 2066 696c 655f  .PathLike] file_
+00006550: 7061 7468 3a20 5061 7468 2074 6f20 7669  path: Path to vi
+00006560: 6465 6f20 6669 6c65 0a20 2020 203a 7061  deo file.    :pa
+00006570: 7261 6d65 7465 7220 696e 7420 7469 6d65  rameter int time
+00006580: 3a20 4e75 6d62 6572 206f 6620 7365 636f  : Number of seco
+00006590: 6e64 7320 746f 2072 656d 6f76 6520 6672  nds to remove fr
+000065a0: 6f6d 2074 6865 2062 6567 696e 6e69 6e67  om the beginning
+000065b0: 206f 6620 7468 6520 7669 6465 6f2e 0a20   of the video.. 
+000065c0: 2020 203a 7061 7261 6d65 7465 7220 4f70     :parameter Op
+000065d0: 7469 6f6e 616c 5b62 6f6f 6c5d 2067 7075  tional[bool] gpu
+000065e0: 3a20 4966 2054 7275 652c 2075 7365 204e  : If True, use N
+000065f0: 5649 4445 4120 4750 5520 636f 6465 6373  VIDEA GPU codecs
+00006600: 2e20 4465 6661 756c 7420 4661 6c73 652e  . Default False.
+00006610: 0a0a 2020 2020 3a65 7861 6d70 6c65 3a0a  ..    :example:.
+00006620: 2020 2020 3e3e 3e20 5f20 3d20 7265 6d6f      >>> _ = remo
+00006630: 7665 5f62 6567 696e 6e69 6e67 5f6f 665f  ve_beginning_of_
+00006640: 7669 6465 6f28 6669 6c65 5f70 6174 683d  video(file_path=
+00006650: 2770 726f 6a65 6374 5f66 6f6c 6465 722f  'project_folder/
+00006660: 7669 6465 6f73 2f56 6964 656f 5f31 2e61  videos/Video_1.a
+00006670: 7669 272c 2074 696d 653d 3130 290a 2020  vi', time=10).  
+00006680: 2020 2222 220a 0a20 2020 2063 6865 636b    """..    check
+00006690: 5f66 666d 7065 675f 6176 6169 6c61 626c  _ffmpeg_availabl
+000066a0: 6528 7261 6973 655f 6572 726f 723d 5472  e(raise_error=Tr
+000066b0: 7565 290a 2020 2020 7469 6d65 7220 3d20  ue).    timer = 
+000066c0: 5369 6d62 6154 696d 6572 2873 7461 7274  SimbaTimer(start
+000066d0: 3d54 7275 6529 0a20 2020 2063 6865 636b  =True).    check
+000066e0: 5f66 696c 655f 6578 6973 745f 616e 645f  _file_exist_and_
+000066f0: 7265 6164 6162 6c65 2866 696c 655f 7061  readable(file_pa
+00006700: 7468 3d66 696c 655f 7061 7468 290a 2020  th=file_path).  
+00006710: 2020 6368 6563 6b5f 696e 7428 6e61 6d65    check_int(name
+00006720: 3d22 4375 7420 7469 6d65 222c 2076 616c  ="Cut time", val
+00006730: 7565 3d74 696d 6529 0a20 2020 2064 6972  ue=time).    dir
+00006740: 2c20 6669 6c65 5f6e 616d 652c 2065 7874  , file_name, ext
+00006750: 203d 2067 6574 5f66 6e5f 6578 7428 6669   = get_fn_ext(fi
+00006760: 6c65 7061 7468 3d66 696c 655f 7061 7468  lepath=file_path
+00006770: 290a 2020 2020 7361 7665 5f6e 616d 6520  ).    save_name 
+00006780: 3d20 6f73 2e70 6174 682e 6a6f 696e 2864  = os.path.join(d
+00006790: 6972 2c20 6669 6c65 5f6e 616d 6520 2b20  ir, file_name + 
+000067a0: 225f 7368 6f72 7465 6e2e 6d70 3422 290a  "_shorten.mp4").
+000067b0: 2020 2020 6966 206f 732e 7061 7468 2e69      if os.path.i
+000067c0: 7366 696c 6528 7361 7665 5f6e 616d 6529  sfile(save_name)
+000067d0: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
+000067e0: 4669 6c65 4578 6973 7445 7272 6f72 280a  FileExistError(.
+000067f0: 2020 2020 2020 2020 2020 2020 6d73 673d              msg=
+00006800: 2253 494d 4241 2045 5252 4f52 3a20 5468  "SIMBA ERROR: Th
+00006810: 6520 6f75 7466 696c 6520 6669 6c65 2061  e outfile file a
+00006820: 6c72 6561 6479 2065 7869 7374 3a20 7b7d  lready exist: {}
+00006830: 2e22 2e66 6f72 6d61 7428 7361 7665 5f6e  .".format(save_n
+00006840: 616d 6529 2c0a 2020 2020 2020 2020 2020  ame),.          
+00006850: 2020 736f 7572 6365 3d72 656d 6f76 655f    source=remove_
+00006860: 6265 6769 6e6e 696e 675f 6f66 5f76 6964  beginning_of_vid
+00006870: 656f 2e5f 5f6e 616d 655f 5f2c 0a20 2020  eo.__name__,.   
+00006880: 2020 2020 2029 0a20 2020 2069 6620 6770       ).    if gp
+00006890: 753a 0a20 2020 2020 2020 2069 6620 6e6f  u:.        if no
+000068a0: 7420 6368 6563 6b5f 6e76 6964 6561 5f67  t check_nvidea_g
+000068b0: 7075 5f61 7661 696c 6162 6c65 2829 3a0a  pu_available():.
+000068c0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+000068d0: 6520 4646 4d50 4547 436f 6465 6347 5055  e FFMPEGCodecGPU
+000068e0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+000068f0: 2020 2020 2020 206d 7367 3d22 4e6f 2047         msg="No G
+00006900: 5055 2066 6f75 6e64 2028 6173 2065 7661  PU found (as eva
+00006910: 6c75 6174 6564 2062 7920 6e76 6964 6561  luated by nvidea
+00006920: 2d73 6d69 2072 6574 7572 6e69 6e67 204e  -smi returning N
+00006930: 6f6e 6529 222c 0a20 2020 2020 2020 2020  one)",.         
+00006940: 2020 2020 2020 2073 6f75 7263 653d 7265         source=re
+00006950: 6d6f 7665 5f62 6567 696e 6e69 6e67 5f6f  move_beginning_o
+00006960: 665f 7669 6465 6f2e 5f5f 6e61 6d65 5f5f  f_video.__name__
+00006970: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+00006980: 2020 2020 2020 2020 636f 6d6d 616e 6420          command 
+00006990: 3d20 2766 666d 7065 6720 2d68 7761 6363  = 'ffmpeg -hwacc
+000069a0: 656c 2061 7574 6f20 2d63 3a76 2068 3236  el auto -c:v h26
+000069b0: 345f 6375 7669 6420 2d73 7320 7b7d 202d  4_cuvid -ss {} -
+000069c0: 6920 227b 7d22 202d 633a 7620 6832 3634  i "{}" -c:v h264
+000069d0: 5f6e 7665 6e63 202d 633a 6120 6161 6320  _nvenc -c:a aac 
+000069e0: 227b 7d22 272e 666f 726d 6174 280a 2020  "{}"'.format(.  
+000069f0: 2020 2020 2020 2020 2020 696e 7428 7469            int(ti
+00006a00: 6d65 292c 2066 696c 655f 7061 7468 2c20  me), file_path, 
+00006a10: 7361 7665 5f6e 616d 650a 2020 2020 2020  save_name.      
+00006a20: 2020 290a 2020 2020 656c 7365 3a0a 2020    ).    else:.  
+00006a30: 2020 2020 2020 636f 6d6d 616e 6420 3d20        command = 
+00006a40: 6627 6666 6d70 6567 202d 7373 207b 696e  f'ffmpeg -ss {in
+00006a50: 7428 7469 6d65 297d 202d 6920 227b 6669  t(time)} -i "{fi
+00006a60: 6c65 5f70 6174 687d 2220 2d63 3a76 206c  le_path}" -c:v l
+00006a70: 6962 7832 3634 202d 633a 6120 6161 6320  ibx264 -c:a aac 
+00006a80: 227b 7361 7665 5f6e 616d 657d 2227 0a20  "{save_name}"'. 
+00006a90: 2020 2070 7269 6e74 2822 5368 6f72 7465     print("Shorte
+00006aa0: 6e69 6e67 2076 6964 656f 2e2e 2e20 2229  ning video... ")
+00006ab0: 0a20 2020 2073 7562 7072 6f63 6573 732e  .    subprocess.
+00006ac0: 6361 6c6c 2863 6f6d 6d61 6e64 2c20 7368  call(command, sh
+00006ad0: 656c 6c3d 5472 7565 2c20 7374 646f 7574  ell=True, stdout
+00006ae0: 3d73 7562 7072 6f63 6573 732e 5049 5045  =subprocess.PIPE
+00006af0: 290a 2020 2020 7469 6d65 722e 7374 6f70  ).    timer.stop
+00006b00: 5f74 696d 6572 2829 0a20 2020 2073 7464  _timer().    std
+00006b10: 6f75 745f 7375 6363 6573 7328 0a20 2020  out_success(.   
+00006b20: 2020 2020 206d 7367 3d66 2253 494d 4241       msg=f"SIMBA
+00006b30: 2043 4f4d 504c 4554 453a 2056 6964 656f   COMPLETE: Video
+00006b40: 2063 6f6e 7665 7274 6564 2120 7b73 6176   converted! {sav
+00006b50: 655f 6e61 6d65 7d20 6765 6e65 7261 7465  e_name} generate
+00006b60: 6421 222c 0a20 2020 2020 2020 2065 6c61  d!",.        ela
+00006b70: 7073 6564 5f74 696d 653d 7469 6d65 722e  psed_time=timer.
+00006b80: 656c 6170 7365 645f 7469 6d65 5f73 7472  elapsed_time_str
+00006b90: 2c0a 2020 2020 2020 2020 736f 7572 6365  ,.        source
+00006ba0: 3d72 656d 6f76 655f 6265 6769 6e6e 696e  =remove_beginnin
+00006bb0: 675f 6f66 5f76 6964 656f 2e5f 5f6e 616d  g_of_video.__nam
+00006bc0: 655f 5f2c 0a20 2020 2029 0a0a 0a23 2072  e__,.    )...# r
+00006bd0: 656d 6f76 655f 6265 6769 6e6e 696e 675f  emove_beginning_
+00006be0: 6f66 5f76 6964 656f 2866 696c 655f 7061  of_video(file_pa
+00006bf0: 7468 3d72 272f 5573 6572 732f 7369 6d6f  th=r'/Users/simo
+00006c00: 6e2f 4465 736b 746f 702f 656e 7673 2f73  n/Desktop/envs/s
+00006c10: 696d 6261 2f74 726f 7562 6c65 7368 6f6f  imba/troubleshoo
+00006c20: 7469 6e67 2f6d 6f75 7365 5f6f 7065 6e5f  ting/mouse_open_
+00006c30: 6669 656c 642f 7072 6f6a 6563 745f 666f  field/project_fo
+00006c40: 6c64 6572 2f76 6964 656f 732f 5349 5f44  lder/videos/SI_D
+00006c50: 4159 335f 3330 385f 4344 315f 5052 4553  AY3_308_CD1_PRES
+00006c60: 454e 545f 6672 616d 655f 6e6f 2e6d 7034  ENT_frame_no.mp4
+00006c70: 272c 2074 696d 653d 3130 2c20 6770 753d  ', time=10, gpu=
+00006c80: 4661 6c73 6529 0a0a 0a64 6566 2063 6c69  False)...def cli
+00006c90: 705f 7669 6465 6f5f 696e 5f72 616e 6765  p_video_in_range
+00006ca0: 280a 2020 2020 6669 6c65 5f70 6174 683a  (.    file_path:
+00006cb0: 2055 6e69 6f6e 5b73 7472 2c20 6f73 2e50   Union[str, os.P
+00006cc0: 6174 684c 696b 655d 2c0a 2020 2020 7374  athLike],.    st
+00006cd0: 6172 745f 7469 6d65 3a20 7374 722c 0a20  art_time: str,. 
+00006ce0: 2020 2065 6e64 5f74 696d 653a 2073 7472     end_time: str
+00006cf0: 2c0a 2020 2020 6f75 745f 6469 723a 204f  ,.    out_dir: O
+00006d00: 7074 696f 6e61 6c5b 556e 696f 6e5b 7374  ptional[Union[st
+00006d10: 722c 206f 732e 5061 7468 4c69 6b65 5d5d  r, os.PathLike]]
+00006d20: 203d 204e 6f6e 652c 0a20 2020 206f 7665   = None,.    ove
+00006d30: 7277 7269 7465 3a20 4f70 7469 6f6e 616c  rwrite: Optional
+00006d40: 5b62 6f6f 6c5d 203d 2046 616c 7365 2c0a  [bool] = False,.
+00006d50: 2020 2020 696e 636c 7564 655f 636c 6970      include_clip
+00006d60: 5f74 696d 655f 696e 5f66 696c 656e 616d  _time_in_filenam
+00006d70: 653a 204f 7074 696f 6e61 6c5b 626f 6f6c  e: Optional[bool
+00006d80: 5d20 3d20 4661 6c73 652c 0a20 2020 2067  ] = False,.    g
+00006d90: 7075 3a20 4f70 7469 6f6e 616c 5b62 6f6f  pu: Optional[boo
+00006da0: 6c5d 203d 2046 616c 7365 2c0a 2920 2d3e  l] = False,.) ->
+00006db0: 204e 6f6e 653a 0a20 2020 2022 2222 0a20   None:.    """. 
+00006dc0: 2020 2043 6c69 7020 7669 6465 6f20 7769     Clip video wi
+00006dd0: 7468 696e 2061 2073 7065 6369 6669 6320  thin a specific 
+00006de0: 7261 6e67 652e 2054 6865 2072 6573 756c  range. The resul
+00006df0: 7420 6973 2073 746f 7265 6420 696e 2074  t is stored in t
+00006e00: 6865 2073 616d 6520 6469 7265 6374 6f72  he same director
+00006e10: 7920 6173 2074 6865 0a20 2020 2069 6e70  y as the.    inp
+00006e20: 7574 2066 696c 6520 7769 7468 2074 6865  ut file with the
+00006e30: 2060 605f 636c 6970 7065 642e 6d70 3460   ``_clipped.mp4`
+00006e40: 6020 7375 6666 6978 2e0a 0a20 2020 203a  ` suffix...    :
+00006e50: 7061 7261 6d65 7465 7220 556e 696f 6e5b  parameter Union[
+00006e60: 7374 722c 206f 732e 5061 7468 4c69 6b65  str, os.PathLike
+00006e70: 5d20 6669 6c65 5f70 6174 683a 2050 6174  ] file_path: Pat
+00006e80: 6820 746f 2076 6964 656f 2066 696c 650a  h to video file.
+00006e90: 2020 2020 3a70 6172 616d 6574 6572 2073      :parameter s
+00006ea0: 7472 2073 7461 7274 5f74 696d 653a 2053  tr start_time: S
+00006eb0: 7461 7274 2074 696d 6520 696e 2048 483a  tart time in HH:
+00006ec0: 4d4d 3a53 5320 666f 726d 6174 2e0a 2020  MM:SS format..  
+00006ed0: 2020 3a70 6172 616d 6574 6572 2073 7472    :parameter str
+00006ee0: 2065 6e64 5f74 696d 653a 2045 6e64 2074   end_time: End t
+00006ef0: 696d 6520 696e 2048 483a 4d4d 3a53 5320  ime in HH:MM:SS 
+00006f00: 666f 726d 6174 2e0a 2020 2020 3a70 6172  format..    :par
+00006f10: 616d 6574 6572 204f 7074 696f 6e61 6c5b  ameter Optional[
+00006f20: 556e 696f 6e5b 7374 722c 206f 732e 5061  Union[str, os.Pa
+00006f30: 7468 4c69 6b65 5d5d 206f 7574 5f64 6972  thLike]] out_dir
+00006f40: 3a20 4966 204e 6f6e 652c 2074 6865 6e20  : If None, then 
+00006f50: 7468 6520 636c 6970 2077 696c 6c20 6265  the clip will be
+00006f60: 2073 746f 7265 6420 696e 2074 6865 2073   stored in the s
+00006f70: 616d 6520 6469 7220 6173 2074 6865 2069  ame dir as the i
+00006f80: 6e70 7574 2076 6964 656f 2e20 4966 2064  nput video. If d
+00006f90: 6972 6563 746f 7279 2c20 7468 656e 2074  irectory, then t
+00006fa0: 6865 206c 6f63 6174 696f 6e20 6f66 2074  he location of t
+00006fb0: 6865 206f 7574 7075 7420 6669 6c65 732e  he output files.
+00006fc0: 0a20 2020 203a 7061 7261 6d65 7465 7220  .    :parameter 
+00006fd0: 4f70 7469 6f6e 616c 5b62 6f6f 6c5d 2069  Optional[bool] i
+00006fe0: 6e63 6c75 6465 5f63 6c69 705f 7469 6d65  nclude_clip_time
+00006ff0: 5f69 6e5f 6669 6c65 6e61 6d65 3a20 4966  _in_filename: If
+00007000: 2054 7275 652c 2069 6e63 6c75 6465 2074   True, include t
+00007010: 6865 2063 6c69 7020 7374 6172 7420 616e  he clip start an
+00007020: 6420 656e 6420 696e 2048 482d 4d4d 2d53  d end in HH-MM-S
+00007030: 5320 666f 726d 6174 2061 7320 7375 6666  S format as suff
+00007040: 6978 2069 6e20 7468 6520 6669 6c65 6e61  ix in the filena
+00007050: 6d65 2e20 4966 2046 616c 7365 2c20 7468  me. If False, th
+00007060: 656e 2075 7365 2069 6e74 6567 6572 2073  en use integer s
+00007070: 7566 6669 6320 7265 7072 6573 656e 7469  uffic representi
+00007080: 6e67 2074 6865 2063 6f75 6e74 2e0a 2020  ng the count..  
+00007090: 2020 3a70 6172 616d 6574 6572 204f 7074    :parameter Opt
+000070a0: 696f 6e61 6c5b 626f 6f6c 5d20 6f76 6572  ional[bool] over
+000070b0: 7772 6974 653a 2049 6620 5472 7565 2c20  write: If True, 
+000070c0: 7468 6520 6f76 6572 7772 6974 6520 6f75  the overwrite ou
+000070d0: 7470 7574 2066 696c 6520 6966 2070 6174  tput file if pat
+000070e0: 6820 616c 7265 6164 7920 6578 6973 742e  h already exist.
+000070f0: 2049 6620 4661 6c73 652c 2074 6865 6e20   If False, then 
+00007100: 7261 6973 6520 4669 6c65 4578 6973 7445  raise FileExistE
+00007110: 7272 6f72 2e0a 2020 2020 3a70 6172 616d  rror..    :param
+00007120: 6574 6572 204f 7074 696f 6e61 6c5b 626f  eter Optional[bo
+00007130: 6f6c 5d20 6770 753a 2049 6620 5472 7565  ol] gpu: If True
+00007140: 2c20 7573 6520 4e56 4944 4541 2047 5055  , use NVIDEA GPU
+00007150: 2063 6f64 6563 732e 2044 6566 6175 6c74   codecs. Default
+00007160: 2046 616c 7365 2e0a 0a20 2020 203a 6578   False...    :ex
+00007170: 616d 706c 653a 0a20 2020 203e 3e3e 205f  ample:.    >>> _
+00007180: 203d 2063 6c69 705f 7669 6465 6f5f 696e   = clip_video_in
+00007190: 5f72 616e 6765 2866 696c 655f 7061 7468  _range(file_path
+000071a0: 3d27 7072 6f6a 6563 745f 666f 6c64 6572  ='project_folder
+000071b0: 2f76 6964 656f 732f 5669 6465 6f5f 312e  /videos/Video_1.
+000071c0: 6176 6927 2c20 7374 6172 745f 7469 6d65  avi', start_time
+000071d0: 3d27 3030 3a30 303a 3035 272c 2065 6e64  ='00:00:05', end
+000071e0: 5f74 696d 653d 2730 303a 3030 3a31 3027  _time='00:00:10'
+000071f0: 290a 2020 2020 2222 220a 0a20 2020 2063  ).    """..    c
+00007200: 6865 636b 5f66 666d 7065 675f 6176 6169  heck_ffmpeg_avai
+00007210: 6c61 626c 6528 7261 6973 655f 6572 726f  lable(raise_erro
+00007220: 723d 5472 7565 290a 2020 2020 6966 2067  r=True).    if g
+00007230: 7075 2061 6e64 206e 6f74 2063 6865 636b  pu and not check
+00007240: 5f6e 7669 6465 615f 6770 755f 6176 6169  _nvidea_gpu_avai
+00007250: 6c61 626c 6528 293a 0a20 2020 2020 2020  lable():.       
+00007260: 2072 6169 7365 2046 464d 5045 4743 6f64   raise FFMPEGCod
+00007270: 6563 4750 5545 7272 6f72 280a 2020 2020  ecGPUError(.    
+00007280: 2020 2020 2020 2020 6d73 673d 224e 6f20          msg="No 
+00007290: 4750 5520 666f 756e 6420 2861 7320 6576  GPU found (as ev
+000072a0: 616c 7561 7465 6420 6279 206e 7669 6465  aluated by nvide
+000072b0: 612d 736d 6920 7265 7475 726e 696e 6720  a-smi returning 
+000072c0: 4e6f 6e65 2922 2c0a 2020 2020 2020 2020  None)",.        
+000072d0: 2020 2020 736f 7572 6365 3d63 6c69 705f      source=clip_
+000072e0: 7669 6465 6f5f 696e 5f72 616e 6765 2e5f  video_in_range._
+000072f0: 5f6e 616d 655f 5f2c 0a20 2020 2020 2020  _name__,.       
+00007300: 2029 0a20 2020 2074 696d 6572 203d 2053   ).    timer = S
+00007310: 696d 6261 5469 6d65 7228 7374 6172 743d  imbaTimer(start=
+00007320: 5472 7565 290a 2020 2020 6368 6563 6b5f  True).    check_
+00007330: 6669 6c65 5f65 7869 7374 5f61 6e64 5f72  file_exist_and_r
+00007340: 6561 6461 626c 6528 6669 6c65 5f70 6174  eadable(file_pat
+00007350: 683d 6669 6c65 5f70 6174 6829 0a20 2020  h=file_path).   
+00007360: 2064 6972 2c20 6669 6c65 5f6e 616d 652c   dir, file_name,
+00007370: 2065 7874 203d 2067 6574 5f66 6e5f 6578   ext = get_fn_ex
+00007380: 7428 6669 6c65 7061 7468 3d66 696c 655f  t(filepath=file_
+00007390: 7061 7468 290a 2020 2020 6966 206f 7574  path).    if out
+000073a0: 5f64 6972 2069 7320 6e6f 7420 4e6f 6e65  _dir is not None
+000073b0: 3a0a 2020 2020 2020 2020 6368 6563 6b5f  :.        check_
+000073c0: 6966 5f64 6972 5f65 7869 7374 7328 696e  if_dir_exists(in
+000073d0: 5f64 6972 3d6f 7574 5f64 6972 290a 2020  _dir=out_dir).  
+000073e0: 2020 2020 2020 6469 7220 3d20 6f75 745f        dir = out_
+000073f0: 6469 720a 2020 2020 6368 6563 6b5f 6966  dir.    check_if
+00007400: 5f73 7472 696e 675f 7661 6c75 655f 6973  _string_value_is
+00007410: 5f76 616c 6964 5f76 6964 656f 5f74 696d  _valid_video_tim
+00007420: 6573 7461 6d70 2876 616c 7565 3d73 7461  estamp(value=sta
+00007430: 7274 5f74 696d 652c 206e 616d 653d 2253  rt_time, name="S
+00007440: 5441 5254 2054 494d 4522 290a 2020 2020  TART TIME").    
+00007450: 6368 6563 6b5f 6966 5f73 7472 696e 675f  check_if_string_
+00007460: 7661 6c75 655f 6973 5f76 616c 6964 5f76  value_is_valid_v
+00007470: 6964 656f 5f74 696d 6573 7461 6d70 2876  ideo_timestamp(v
+00007480: 616c 7565 3d65 6e64 5f74 696d 652c 206e  alue=end_time, n
+00007490: 616d 653d 2245 4e44 2054 494d 4522 290a  ame="END TIME").
+000074a0: 2020 2020 6368 6563 6b5f 7468 6174 5f68      check_that_h
+000074b0: 686d 6d73 735f 7374 6172 745f 6973 5f62  hmmss_start_is_b
+000074c0: 6566 6f72 655f 656e 6428 0a20 2020 2020  efore_end(.     
+000074d0: 2020 2073 7461 7274 5f74 696d 653d 7374     start_time=st
+000074e0: 6172 745f 7469 6d65 2c20 656e 645f 7469  art_time, end_ti
+000074f0: 6d65 3d65 6e64 5f74 696d 652c 206e 616d  me=end_time, nam
+00007500: 653d 6622 7b66 696c 655f 6e61 6d65 7d20  e=f"{file_name} 
+00007510: 7469 6d65 7374 616d 7073 220a 2020 2020  timestamps".    
+00007520: 290a 2020 2020 6966 206e 6f74 2069 6e63  ).    if not inc
+00007530: 6c75 6465 5f63 6c69 705f 7469 6d65 5f69  lude_clip_time_i
+00007540: 6e5f 6669 6c65 6e61 6d65 3a0a 2020 2020  n_filename:.    
+00007550: 2020 2020 7361 7665 5f6e 616d 6520 3d20      save_name = 
+00007560: 6f73 2e70 6174 682e 6a6f 696e 2864 6972  os.path.join(dir
+00007570: 2c20 6669 6c65 5f6e 616d 6520 2b20 225f  , file_name + "_
+00007580: 636c 6970 7065 642e 6d70 3422 290a 2020  clipped.mp4").  
+00007590: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000075a0: 7361 7665 5f6e 616d 6520 3d20 6f73 2e70  save_name = os.p
+000075b0: 6174 682e 6a6f 696e 280a 2020 2020 2020  ath.join(.      
+000075c0: 2020 2020 2020 6469 722c 0a20 2020 2020        dir,.     
+000075d0: 2020 2020 2020 2066 696c 655f 6e61 6d65         file_name
+000075e0: 0a20 2020 2020 2020 2020 2020 202b 2066  .            + f
+000075f0: 275f 7b73 7461 7274 5f74 696d 652e 7265  '_{start_time.re
+00007600: 706c 6163 6528 223a 222c 2022 2d22 297d  place(":", "-")}
+00007610: 5f7b 656e 645f 7469 6d65 2e72 6570 6c61  _{end_time.repla
+00007620: 6365 2822 3a22 2c20 222d 2229 7d2e 6d70  ce(":", "-")}.mp
+00007630: 3427 2c0a 2020 2020 2020 2020 290a 2020  4',.        ).  
+00007640: 2020 6966 206f 732e 7061 7468 2e69 7366    if os.path.isf
+00007650: 696c 6528 7361 7665 5f6e 616d 6529 2061  ile(save_name) a
+00007660: 6e64 2028 6e6f 7420 6f76 6572 7772 6974  nd (not overwrit
+00007670: 6529 3a0a 2020 2020 2020 2020 7261 6973  e):.        rais
+00007680: 6520 4669 6c65 4578 6973 7445 7272 6f72  e FileExistError
+00007690: 280a 2020 2020 2020 2020 2020 2020 6d73  (.            ms
+000076a0: 673d 6622 5349 4d42 4120 4552 524f 523a  g=f"SIMBA ERROR:
+000076b0: 2054 6865 206f 7574 6669 6c65 2066 696c   The outfile fil
+000076c0: 6520 616c 7265 6164 7920 6578 6973 743a  e already exist:
+000076d0: 207b 7361 7665 5f6e 616d 657d 2e22 2c0a   {save_name}.",.
+000076e0: 2020 2020 2020 2020 2020 2020 736f 7572              sour
+000076f0: 6365 3d63 6c69 705f 7669 6465 6f5f 696e  ce=clip_video_in
+00007700: 5f72 616e 6765 2e5f 5f6e 616d 655f 5f2c  _range.__name__,
+00007710: 0a20 2020 2020 2020 2029 0a20 2020 2069  .        ).    i
+00007720: 6620 6770 753a 0a20 2020 2020 2020 2063  f gpu:.        c
+00007730: 6f6d 6d61 6e64 203d 2066 2766 666d 7065  ommand = f'ffmpe
+00007740: 6720 2d68 7761 6363 656c 2061 7574 6f20  g -hwaccel auto 
+00007750: 2d63 3a76 2068 3236 345f 6375 7669 6420  -c:v h264_cuvid 
+00007760: 2d69 2022 7b66 696c 655f 7061 7468 7d22  -i "{file_path}"
+00007770: 202d 7373 207b 7374 6172 745f 7469 6d65   -ss {start_time
+00007780: 7d20 2d74 6f20 7b65 6e64 5f74 696d 657d  } -to {end_time}
+00007790: 202d 6173 796e 6320 3120 227b 7361 7665   -async 1 "{save
+000077a0: 5f6e 616d 657d 2220 2d79 270a 2020 2020  _name}" -y'.    
+000077b0: 656c 7365 3a0a 2020 2020 2020 2020 636f  else:.        co
+000077c0: 6d6d 616e 6420 3d20 6627 6666 6d70 6567  mmand = f'ffmpeg
+000077d0: 202d 6920 227b 6669 6c65 5f70 6174 687d   -i "{file_path}
+000077e0: 2220 2d73 7320 7b73 7461 7274 5f74 696d  " -ss {start_tim
+000077f0: 657d 202d 746f 207b 656e 645f 7469 6d65  e} -to {end_time
+00007800: 7d20 2d61 7379 6e63 2031 2022 7b73 6176  } -async 1 "{sav
+00007810: 655f 6e61 6d65 7d22 202d 7927 0a20 2020  e_name}" -y'.   
+00007820: 2070 7269 6e74 2866 2243 6c69 7070 696e   print(f"Clippin
+00007830: 6720 7669 6465 6f20 7b66 696c 655f 6e61  g video {file_na
+00007840: 6d65 7d20 6265 7477 6565 6e20 7b73 7461  me} between {sta
+00007850: 7274 5f74 696d 657d 2061 6e64 207b 656e  rt_time} and {en
+00007860: 645f 7469 6d65 7d2e 2e2e 2022 290a 2020  d_time}... ").  
+00007870: 2020 7375 6270 726f 6365 7373 2e63 616c    subprocess.cal
+00007880: 6c28 636f 6d6d 616e 642c 2073 6865 6c6c  l(command, shell
+00007890: 3d54 7275 652c 2073 7464 6f75 743d 7375  =True, stdout=su
+000078a0: 6270 726f 6365 7373 2e50 4950 4529 0a20  bprocess.PIPE). 
+000078b0: 2020 2074 696d 6572 2e73 746f 705f 7469     timer.stop_ti
+000078c0: 6d65 7228 290a 2020 2020 7374 646f 7574  mer().    stdout
+000078d0: 5f73 7563 6365 7373 280a 2020 2020 2020  _success(.      
+000078e0: 2020 6d73 673d 6622 5669 6465 6f20 636f    msg=f"Video co
+000078f0: 6e76 6572 7465 6421 207b 7361 7665 5f6e  nverted! {save_n
+00007900: 616d 657d 2067 656e 6572 6174 6564 2122  ame} generated!"
+00007910: 2c0a 2020 2020 2020 2020 656c 6170 7365  ,.        elapse
+00007920: 645f 7469 6d65 3d74 696d 6572 2e65 6c61  d_time=timer.ela
+00007930: 7073 6564 5f74 696d 655f 7374 722c 0a20  psed_time_str,. 
+00007940: 2020 2020 2020 2073 6f75 7263 653d 636c         source=cl
+00007950: 6970 5f76 6964 656f 5f69 6e5f 7261 6e67  ip_video_in_rang
+00007960: 652e 5f5f 6e61 6d65 5f5f 2c0a 2020 2020  e.__name__,.    
+00007970: 290a 0a0a 6465 6620 646f 776e 7361 6d70  )...def downsamp
+00007980: 6c65 5f76 6964 656f 280a 2020 2020 6669  le_video(.    fi
+00007990: 6c65 5f70 6174 683a 2055 6e69 6f6e 5b73  le_path: Union[s
+000079a0: 7472 2c20 6f73 2e50 6174 684c 696b 655d  tr, os.PathLike]
+000079b0: 2c0a 2020 2020 7669 6465 6f5f 6865 6967  ,.    video_heig
+000079c0: 6874 3a20 696e 742c 0a20 2020 2076 6964  ht: int,.    vid
+000079d0: 656f 5f77 6964 7468 3a20 696e 742c 0a20  eo_width: int,. 
+000079e0: 2020 2067 7075 3a20 4f70 7469 6f6e 616c     gpu: Optional
+000079f0: 5b62 6f6f 6c5d 203d 2046 616c 7365 2c0a  [bool] = False,.
+00007a00: 2920 2d3e 204e 6f6e 653a 0a20 2020 2022  ) -> None:.    "
+00007a10: 2222 0a20 2020 2044 6f77 6e2d 7361 6d70  "".    Down-samp
+00007a20: 6c65 2061 2076 6964 656f 2066 696c 652e  le a video file.
+00007a30: 2054 6865 2072 6573 756c 7420 6973 2073   The result is s
+00007a40: 746f 7265 6420 696e 2074 6865 2073 616d  tored in the sam
+00007a50: 6520 6469 7265 6374 6f72 7920 6173 2074  e directory as t
+00007a60: 6865 0a20 2020 2069 6e70 7574 2066 696c  he.    input fil
+00007a70: 6520 7769 7468 2074 6865 2060 605f 646f  e with the ``_do
+00007a80: 776e 7361 6d70 6c65 642e 6d70 3460 6020  wnsampled.mp4`` 
+00007a90: 7375 6666 6978 2e0a 0a20 2020 203a 7061  suffix...    :pa
+00007aa0: 7261 6d65 7465 7220 556e 696f 6e5b 7374  rameter Union[st
+00007ab0: 722c 206f 732e 5061 7468 4c69 6b65 5d20  r, os.PathLike] 
+00007ac0: 6669 6c65 5f70 6174 683a 2050 6174 6820  file_path: Path 
+00007ad0: 746f 2076 6964 656f 2066 696c 652e 0a20  to video file.. 
+00007ae0: 2020 203a 7061 7261 6d65 7465 7220 696e     :parameter in
+00007af0: 7420 7669 6465 6f5f 6865 6967 6874 3a20  t video_height: 
+00007b00: 6865 6967 6874 206f 6620 6e65 7720 7669  height of new vi
+00007b10: 6465 6f2e 0a20 2020 203a 7061 7261 6d65  deo..    :parame
+00007b20: 7465 7220 696e 7420 7669 6465 6f5f 7769  ter int video_wi
+00007b30: 6474 683a 2077 6964 7468 206f 6620 6e65  dth: width of ne
+00007b40: 7720 7669 6465 6f2e 0a20 2020 203a 7061  w video..    :pa
+00007b50: 7261 6d65 7465 7220 4f70 7469 6f6e 616c  rameter Optional
+00007b60: 5b62 6f6f 6c5d 2067 7075 3a20 4966 2054  [bool] gpu: If T
+00007b70: 7275 652c 2075 7365 204e 5649 4445 4120  rue, use NVIDEA 
+00007b80: 4750 5520 636f 6465 6373 2e20 4465 6661  GPU codecs. Defa
+00007b90: 756c 7420 4661 6c73 652e 0a0a 2020 2020  ult False...    
+00007ba0: 3a65 7861 6d70 6c65 3a0a 2020 2020 3e3e  :example:.    >>
+00007bb0: 3e20 5f20 3d20 646f 776e 7361 6d70 6c65  > _ = downsample
+00007bc0: 5f76 6964 656f 2866 696c 655f 7061 7468  _video(file_path
+00007bd0: 3d27 7072 6f6a 6563 745f 666f 6c64 6572  ='project_folder
+00007be0: 2f76 6964 656f 732f 5669 6465 6f5f 312e  /videos/Video_1.
+00007bf0: 6176 6927 2c20 7669 6465 6f5f 6865 6967  avi', video_heig
+00007c00: 6874 3d36 3030 2c20 7669 6465 6f5f 7769  ht=600, video_wi
+00007c10: 6474 683d 3430 3029 0a20 2020 2022 2222  dth=400).    """
+00007c20: 0a20 2020 2063 6865 636b 5f66 666d 7065  .    check_ffmpe
+00007c30: 675f 6176 6169 6c61 626c 6528 7261 6973  g_available(rais
+00007c40: 655f 6572 726f 723d 5472 7565 290a 2020  e_error=True).  
+00007c50: 2020 6966 2067 7075 2061 6e64 206e 6f74    if gpu and not
+00007c60: 2063 6865 636b 5f6e 7669 6465 615f 6770   check_nvidea_gp
+00007c70: 755f 6176 6169 6c61 626c 6528 293a 0a20  u_available():. 
+00007c80: 2020 2020 2020 2072 6169 7365 2046 464d         raise FFM
+00007c90: 5045 4743 6f64 6563 4750 5545 7272 6f72  PEGCodecGPUError
+00007ca0: 280a 2020 2020 2020 2020 2020 2020 6d73  (.            ms
+00007cb0: 673d 224e 6f20 4750 5520 666f 756e 6420  g="No GPU found 
+00007cc0: 2861 7320 6576 616c 7561 7465 6420 6279  (as evaluated by
+00007cd0: 206e 7669 6465 612d 736d 6920 7265 7475   nvidea-smi retu
+00007ce0: 726e 696e 6720 4e6f 6e65 2922 2c0a 2020  rning None)",.  
+00007cf0: 2020 2020 2020 2020 2020 736f 7572 6365            source
+00007d00: 3d64 6f77 6e73 616d 706c 655f 7669 6465  =downsample_vide
+00007d10: 6f2e 5f5f 6e61 6d65 5f5f 2c0a 2020 2020  o.__name__,.    
+00007d20: 2020 2020 290a 2020 2020 7469 6d65 7220      ).    timer 
+00007d30: 3d20 5369 6d62 6154 696d 6572 2873 7461  = SimbaTimer(sta
+00007d40: 7274 3d54 7275 6529 0a20 2020 2063 6865  rt=True).    che
+00007d50: 636b 5f69 6e74 286e 616d 653d 2256 6964  ck_int(name="Vid
+00007d60: 656f 2068 6569 6768 7422 2c20 7661 6c75  eo height", valu
+00007d70: 653d 7669 6465 6f5f 6865 6967 6874 290a  e=video_height).
+00007d80: 2020 2020 6368 6563 6b5f 696e 7428 6e61      check_int(na
+00007d90: 6d65 3d22 5669 6465 6f20 7769 6474 6822  me="Video width"
+00007da0: 2c20 7661 6c75 653d 7669 6465 6f5f 7769  , value=video_wi
+00007db0: 6474 6829 0a20 2020 2063 6865 636b 5f66  dth).    check_f
+00007dc0: 696c 655f 6578 6973 745f 616e 645f 7265  ile_exist_and_re
+00007dd0: 6164 6162 6c65 2866 696c 655f 7061 7468  adable(file_path
+00007de0: 3d66 696c 655f 7061 7468 290a 2020 2020  =file_path).    
+00007df0: 6469 722c 2066 696c 655f 6e61 6d65 2c20  dir, file_name, 
+00007e00: 6578 7420 3d20 6765 745f 666e 5f65 7874  ext = get_fn_ext
+00007e10: 2866 696c 6570 6174 683d 6669 6c65 5f70  (filepath=file_p
+00007e20: 6174 6829 0a20 2020 2073 6176 655f 6e61  ath).    save_na
+00007e30: 6d65 203d 206f 732e 7061 7468 2e6a 6f69  me = os.path.joi
+00007e40: 6e28 6469 722c 2066 696c 655f 6e61 6d65  n(dir, file_name
+00007e50: 202b 2022 5f64 6f77 6e73 616d 706c 6564   + "_downsampled
+00007e60: 2e6d 7034 2229 0a20 2020 2069 6620 6f73  .mp4").    if os
+00007e70: 2e70 6174 682e 6973 6669 6c65 2873 6176  .path.isfile(sav
+00007e80: 655f 6e61 6d65 293a 0a20 2020 2020 2020  e_name):.       
+00007e90: 2072 6169 7365 2046 696c 6545 7869 7374   raise FileExist
+00007ea0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+00007eb0: 2020 2022 5349 4d42 4120 4552 524f 523a     "SIMBA ERROR:
+00007ec0: 2054 6865 206f 7574 6669 6c65 2066 696c   The outfile fil
+00007ed0: 6520 616c 7265 6164 7920 6578 6973 743a  e already exist:
+00007ee0: 207b 7d2e 222e 666f 726d 6174 2873 6176   {}.".format(sav
+00007ef0: 655f 6e61 6d65 292c 0a20 2020 2020 2020  e_name),.       
+00007f00: 2020 2020 2073 6f75 7263 653d 646f 776e       source=down
+00007f10: 7361 6d70 6c65 5f76 6964 656f 2e5f 5f6e  sample_video.__n
+00007f20: 616d 655f 5f2c 0a20 2020 2020 2020 2029  ame__,.        )
+00007f30: 0a20 2020 2069 6620 6770 753a 0a20 2020  .    if gpu:.   
+00007f40: 2020 2020 2063 6f6d 6d61 6e64 203d 2066       command = f
+00007f50: 2766 666d 7065 6720 2d79 202d 6877 6163  'ffmpeg -y -hwac
+00007f60: 6365 6c20 6175 746f 202d 633a 7620 6832  cel auto -c:v h2
+00007f70: 3634 5f63 7576 6964 202d 6920 227b 6669  64_cuvid -i "{fi
+00007f80: 6c65 5f70 6174 687d 2220 2d76 6620 2273  le_path}" -vf "s
+00007f90: 6361 6c65 3d77 3d7b 7669 6465 6f5f 7769  cale=w={video_wi
+00007fa0: 6474 687d 3a68 3d7b 7669 6465 6f5f 6865  dth}:h={video_he
+00007fb0: 6967 6874 7d3a 666f 7263 655f 6f72 6967  ight}:force_orig
+00007fc0: 696e 616c 5f61 7370 6563 745f 7261 7469  inal_aspect_rati
+00007fd0: 6f3d 6465 6372 6561 7365 3a66 6c61 6773  o=decrease:flags
+00007fe0: 3d62 6963 7562 6963 2220 2d63 3a76 2068  =bicubic" -c:v h
+00007ff0: 3236 345f 6e76 656e 6320 227b 7361 7665  264_nvenc "{save
+00008000: 5f6e 616d 657d 2227 0a20 2020 2065 6c73  _name}"'.    els
+00008010: 653a 0a20 2020 2020 2020 2063 6f6d 6d61  e:.        comma
+00008020: 6e64 203d 2066 2766 666d 7065 6720 2d69  nd = f'ffmpeg -i
+00008030: 2022 7b66 696c 655f 7061 7468 7d22 202d   "{file_path}" -
+00008040: 7666 2073 6361 6c65 3d7b 7669 6465 6f5f  vf scale={video_
+00008050: 7769 6474 687d 3a7b 7669 6465 6f5f 6865  width}:{video_he
+00008060: 6967 6874 7d20 2d63 3a76 206c 6962 7832  ight} -c:v libx2
+00008070: 3634 2022 7b73 6176 655f 6e61 6d65 7d22  64 "{save_name}"
+00008080: 202d 6869 6465 5f62 616e 6e65 7227 0a20   -hide_banner'. 
+00008090: 2020 2070 7269 6e74 2822 446f 776e 2d73     print("Down-s
+000080a0: 616d 706c 696e 6720 7669 6465 6f2e 2e2e  ampling video...
+000080b0: 2022 290a 2020 2020 7375 6270 726f 6365   ").    subproce
+000080c0: 7373 2e63 616c 6c28 636f 6d6d 616e 642c  ss.call(command,
+000080d0: 2073 6865 6c6c 3d54 7275 652c 2073 7464   shell=True, std
+000080e0: 6f75 743d 7375 6270 726f 6365 7373 2e50  out=subprocess.P
+000080f0: 4950 4529 0a20 2020 2074 696d 6572 2e73  IPE).    timer.s
+00008100: 746f 705f 7469 6d65 7228 290a 2020 2020  top_timer().    
+00008110: 7374 646f 7574 5f73 7563 6365 7373 280a  stdout_success(.
+00008120: 2020 2020 2020 2020 6d73 673d 6622 5349          msg=f"SI
+00008130: 4d42 4120 434f 4d50 4c45 5445 3a20 5669  MBA COMPLETE: Vi
+00008140: 6465 6f20 636f 6e76 6572 7465 6421 207b  deo converted! {
+00008150: 7361 7665 5f6e 616d 657d 2067 656e 6572  save_name} gener
+00008160: 6174 6564 2122 2c0a 2020 2020 2020 2020  ated!",.        
+00008170: 656c 6170 7365 645f 7469 6d65 3d74 696d  elapsed_time=tim
+00008180: 6572 2e65 6c61 7073 6564 5f74 696d 655f  er.elapsed_time_
+00008190: 7374 722c 0a20 2020 2020 2020 2073 6f75  str,.        sou
+000081a0: 7263 653d 646f 776e 7361 6d70 6c65 5f76  rce=downsample_v
+000081b0: 6964 656f 2e5f 5f6e 616d 655f 5f2c 0a20  ideo.__name__,. 
+000081c0: 2020 2029 0a0a 0a64 6566 2067 6966 5f63     )...def gif_c
+000081d0: 7265 6174 6f72 280a 2020 2020 6669 6c65  reator(.    file
+000081e0: 5f70 6174 683a 2055 6e69 6f6e 5b73 7472  _path: Union[str
+000081f0: 2c20 6f73 2e50 6174 684c 696b 655d 2c0a  , os.PathLike],.
+00008200: 2020 2020 7374 6172 745f 7469 6d65 3a20      start_time: 
+00008210: 696e 742c 0a20 2020 2064 7572 6174 696f  int,.    duratio
+00008220: 6e3a 2069 6e74 2c0a 2020 2020 7769 6474  n: int,.    widt
+00008230: 683a 2069 6e74 2c0a 2020 2020 6770 753a  h: int,.    gpu:
+00008240: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
+00008250: 3d20 4661 6c73 652c 0a29 202d 3e20 4e6f  = False,.) -> No
+00008260: 6e65 3a0a 2020 2020 2222 220a 2020 2020  ne:.    """.    
+00008270: 4372 6561 7465 2061 2073 616d 706c 6520  Create a sample 
+00008280: 6769 6620 6672 6f6d 2061 2076 6964 656f  gif from a video
+00008290: 2066 696c 652e 2054 6865 2072 6573 756c   file. The resul
+000082a0: 7420 6973 2073 746f 7265 6420 696e 2074  t is stored in t
+000082b0: 6865 2073 616d 6520 6469 7265 6374 6f72  he same director
+000082c0: 7920 6173 2074 6865 0a20 2020 2069 6e70  y as the.    inp
+000082d0: 7574 2066 696c 6520 7769 7468 2074 6865  ut file with the
+000082e0: 2060 602e 6769 6660 6020 6669 6c65 2d65   ``.gif`` file-e
+000082f0: 6e64 696e 672e 0a0a 2020 2020 2e2e 206e  nding...    .. n
+00008300: 6f74 653a 3a0a 2020 2020 2020 2054 6865  ote::.       The
+00008310: 2068 6569 6768 7420 6973 2061 7574 6f2d   height is auto-
+00008320: 636f 6d70 7574 6564 2074 6f20 7265 7461  computed to reta
+00008330: 696e 2061 7370 6563 7420 7261 7469 6f0a  in aspect ratio.
+00008340: 0a20 2020 203a 7061 7261 6d65 7465 7220  .    :parameter 
+00008350: 556e 696f 6e5b 7374 722c 206f 732e 5061  Union[str, os.Pa
+00008360: 7468 4c69 6b65 5d20 6669 6c65 5f70 6174  thLike] file_pat
+00008370: 683a 2050 6174 6820 746f 2076 6964 656f  h: Path to video
+00008380: 2066 696c 652e 0a20 2020 203a 7061 7261   file..    :para
+00008390: 6d65 7465 7220 696e 7420 7374 6172 745f  meter int start_
+000083a0: 7469 6d65 3a20 5374 6172 7420 7469 6d65  time: Start time
+000083b0: 206f 6620 7468 6520 6769 6620 696e 2072   of the gif in r
+000083c0: 656c 6174 696f 6e20 746f 2074 6865 2076  elation to the v
+000083d0: 6964 656f 2069 6e20 7365 636f 6e64 732e  ideo in seconds.
+000083e0: 0a20 2020 203a 7061 7261 6d65 7465 7220  .    :parameter 
+000083f0: 696e 7420 6475 7261 7469 6f6e 3a20 4475  int duration: Du
+00008400: 7261 7469 6f6e 206f 6620 7468 6520 6769  ration of the gi
+00008410: 662e 0a20 2020 203a 7061 7261 6d65 7465  f..    :paramete
+00008420: 7220 696e 7420 7769 6474 683a 2057 6964  r int width: Wid
+00008430: 7468 206f 6620 7468 6520 6769 662e 0a20  th of the gif.. 
+00008440: 2020 203a 7061 7261 6d65 7465 7220 4f70     :parameter Op
+00008450: 7469 6f6e 616c 5b62 6f6f 6c5d 2067 7075  tional[bool] gpu
+00008460: 3a20 4966 2054 7275 652c 2075 7365 204e  : If True, use N
+00008470: 5649 4445 4120 4750 5520 636f 6465 6373  VIDEA GPU codecs
+00008480: 2e20 4465 6661 756c 7420 4661 6c73 652e  . Default False.
+00008490: 0a0a 2020 2020 3a65 7861 6d70 6c65 3a0a  ..    :example:.
+000084a0: 2020 2020 3e3e 3e20 5f20 3d20 6769 665f      >>> _ = gif_
+000084b0: 6372 6561 746f 7228 6669 6c65 5f70 6174  creator(file_pat
+000084c0: 683d 2770 726f 6a65 6374 5f66 6f6c 6465  h='project_folde
+000084d0: 722f 7669 6465 6f73 2f56 6964 656f 5f31  r/videos/Video_1
+000084e0: 2e61 7669 272c 2073 7461 7274 5f74 696d  .avi', start_tim
+000084f0: 653d 352c 2064 7572 6174 696f 6e3d 3130  e=5, duration=10
+00008500: 2c20 7769 6474 683d 3630 3029 0a20 2020  , width=600).   
+00008510: 2022 2222 0a0a 2020 2020 6368 6563 6b5f   """..    check_
+00008520: 6666 6d70 6567 5f61 7661 696c 6162 6c65  ffmpeg_available
+00008530: 2872 6169 7365 5f65 7272 6f72 3d54 7275  (raise_error=Tru
+00008540: 6529 0a20 2020 2069 6620 6770 7520 616e  e).    if gpu an
+00008550: 6420 6e6f 7420 6368 6563 6b5f 6e76 6964  d not check_nvid
+00008560: 6561 5f67 7075 5f61 7661 696c 6162 6c65  ea_gpu_available
+00008570: 2829 3a0a 2020 2020 2020 2020 7261 6973  ():.        rais
+00008580: 6520 4646 4d50 4547 436f 6465 6347 5055  e FFMPEGCodecGPU
+00008590: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+000085a0: 2020 206d 7367 3d22 4e56 4944 4541 2047     msg="NVIDEA G
+000085b0: 5055 206e 6f74 2061 7661 696c 6162 6c65  PU not available
+000085c0: 2028 6173 2065 7661 6c75 6174 6564 2062   (as evaluated b
+000085d0: 7920 6e76 6964 6561 2d73 6d69 2072 6574  y nvidea-smi ret
+000085e0: 7572 6e69 6e67 204e 6f6e 6522 2c0a 2020  urning None",.  
+000085f0: 2020 2020 2020 2020 2020 736f 7572 6365            source
+00008600: 3d67 6966 5f63 7265 6174 6f72 2e5f 5f6e  =gif_creator.__n
+00008610: 616d 655f 5f2c 0a20 2020 2020 2020 2029  ame__,.        )
+00008620: 0a20 2020 2074 696d 6572 203d 2053 696d  .    timer = Sim
+00008630: 6261 5469 6d65 7228 7374 6172 743d 5472  baTimer(start=Tr
+00008640: 7565 290a 2020 2020 6368 6563 6b5f 6669  ue).    check_fi
+00008650: 6c65 5f65 7869 7374 5f61 6e64 5f72 6561  le_exist_and_rea
+00008660: 6461 626c 6528 6669 6c65 5f70 6174 683d  dable(file_path=
+00008670: 6669 6c65 5f70 6174 6829 0a20 2020 2063  file_path).    c
+00008680: 6865 636b 5f69 6e74 286e 616d 653d 2253  heck_int(name="S
+00008690: 7461 7274 2074 696d 6522 2c20 7661 6c75  tart time", valu
+000086a0: 653d 7374 6172 745f 7469 6d65 2c20 6d69  e=start_time, mi
+000086b0: 6e5f 7661 6c75 653d 3029 0a20 2020 2063  n_value=0).    c
+000086c0: 6865 636b 5f69 6e74 286e 616d 653d 2244  heck_int(name="D
+000086d0: 7572 6174 696f 6e22 2c20 7661 6c75 653d  uration", value=
+000086e0: 6475 7261 7469 6f6e 2c20 6d69 6e5f 7661  duration, min_va
+000086f0: 6c75 653d 3129 0a20 2020 2063 6865 636b  lue=1).    check
+00008700: 5f69 6e74 286e 616d 653d 2257 6964 7468  _int(name="Width
+00008710: 222c 2076 616c 7565 3d77 6964 7468 290a  ", value=width).
+00008720: 2020 2020 7669 6465 6f5f 6d65 7461 5f64      video_meta_d
+00008730: 6174 6120 3d20 6765 745f 7669 6465 6f5f  ata = get_video_
+00008740: 6d65 7461 5f64 6174 6128 6669 6c65 5f70  meta_data(file_p
+00008750: 6174 6829 0a20 2020 2069 6620 2873 7461  ath).    if (sta
+00008760: 7274 5f74 696d 6520 2b20 6475 7261 7469  rt_time + durati
+00008770: 6f6e 2920 3e20 7669 6465 6f5f 6d65 7461  on) > video_meta
+00008780: 5f64 6174 615b 2276 6964 656f 5f6c 656e  _data["video_len
+00008790: 6774 685f 7322 5d3a 0a20 2020 2020 2020  gth_s"]:.       
+000087a0: 2072 6169 7365 2046 7261 6d65 5261 6e67   raise FrameRang
+000087b0: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+000087c0: 2020 2020 6d73 673d 6627 5468 6520 656e      msg=f'The en
+000087d0: 6420 6f66 2074 6865 2067 6966 2028 7374  d of the gif (st
+000087e0: 6172 7420 7469 6d65 3a20 7b73 7461 7274  art time: {start
+000087f0: 5f74 696d 657d 202b 2064 7572 6174 696f  _time} + duratio
+00008800: 6e3a 207b 6475 7261 7469 6f6e 7d29 2069  n: {duration}) i
+00008810: 7320 6c6f 6e67 6572 2074 6861 6e20 7468  s longer than th
+00008820: 6520 7b66 696c 655f 7061 7468 7d20 7669  e {file_path} vi
+00008830: 6465 6f3a 207b 7669 6465 6f5f 6d65 7461  deo: {video_meta
+00008840: 5f64 6174 615b 2276 6964 656f 5f6c 656e  _data["video_len
+00008850: 6774 685f 7322 5d7d 7327 2c0a 2020 2020  gth_s"]}s',.    
+00008860: 2020 2020 2020 2020 736f 7572 6365 3d67          source=g
+00008870: 6966 5f63 7265 6174 6f72 2e5f 5f6e 616d  if_creator.__nam
+00008880: 655f 5f2c 0a20 2020 2020 2020 2029 0a0a  e__,.        )..
+00008890: 2020 2020 6469 722c 2066 696c 655f 6e61      dir, file_na
+000088a0: 6d65 2c20 6578 7420 3d20 6765 745f 666e  me, ext = get_fn
+000088b0: 5f65 7874 2866 696c 6570 6174 683d 6669  _ext(filepath=fi
+000088c0: 6c65 5f70 6174 6829 0a20 2020 2073 6176  le_path).    sav
+000088d0: 655f 6e61 6d65 203d 206f 732e 7061 7468  e_name = os.path
+000088e0: 2e6a 6f69 6e28 6469 722c 2066 696c 655f  .join(dir, file_
+000088f0: 6e61 6d65 202b 2022 2e67 6966 2229 0a20  name + ".gif"). 
+00008900: 2020 2069 6620 6f73 2e70 6174 682e 6973     if os.path.is
+00008910: 6669 6c65 2873 6176 655f 6e61 6d65 293a  file(save_name):
+00008920: 0a20 2020 2020 2020 2072 6169 7365 2046  .        raise F
+00008930: 696c 6545 7869 7374 4572 726f 7228 0a20  ileExistError(. 
+00008940: 2020 2020 2020 2020 2020 2022 5349 4d42             "SIMB
+00008950: 4120 4552 524f 523a 2054 6865 206f 7574  A ERROR: The out
+00008960: 6669 6c65 2066 696c 6520 616c 7265 6164  file file alread
+00008970: 7920 6578 6973 743a 207b 7d2e 222e 666f  y exist: {}.".fo
+00008980: 726d 6174 2873 6176 655f 6e61 6d65 292c  rmat(save_name),
+00008990: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
+000089a0: 7263 653d 6769 665f 6372 6561 746f 722e  rce=gif_creator.
+000089b0: 5f5f 6e61 6d65 5f5f 2c0a 2020 2020 2020  __name__,.      
+000089c0: 2020 290a 2020 2020 6966 2067 7075 3a0a    ).    if gpu:.
+000089d0: 2020 2020 2020 2020 636f 6d6d 616e 6420          command 
+000089e0: 3d20 6627 6666 6d70 6567 202d 6877 6163  = f'ffmpeg -hwac
+000089f0: 6365 6c20 6175 746f 202d 633a 7620 6832  cel auto -c:v h2
+00008a00: 3634 5f63 7576 6964 202d 7373 207b 7374  64_cuvid -ss {st
+00008a10: 6172 745f 7469 6d65 7d20 2d69 2022 7b66  art_time} -i "{f
+00008a20: 696c 655f 7061 7468 7d22 202d 746f 207b  ile_path}" -to {
+00008a30: 6475 7261 7469 6f6e 7d20 2d76 6620 2266  duration} -vf "f
+00008a40: 7073 3d31 302c 7363 616c 653d 7b77 6964  ps=10,scale={wid
+00008a50: 7468 7d3a 2d31 2220 2d63 3a76 2067 6966  th}:-1" -c:v gif
+00008a60: 202d 7069 785f 666d 7420 7267 6232 3420   -pix_fmt rgb24 
+00008a70: 2d79 2022 7b73 6176 655f 6e61 6d65 7d22  -y "{save_name}"
+00008a80: 202d 7927 0a20 2020 2065 6c73 653a 0a20   -y'.    else:. 
+00008a90: 2020 2020 2020 2063 6f6d 6d61 6e64 203d         command =
+00008aa0: 2066 2766 666d 7065 6720 2d73 7320 7b73   f'ffmpeg -ss {s
+00008ab0: 7461 7274 5f74 696d 657d 202d 7420 7b64  tart_time} -t {d
+00008ac0: 7572 6174 696f 6e7d 202d 6920 227b 6669  uration} -i "{fi
+00008ad0: 6c65 5f70 6174 687d 2220 2d66 696c 7465  le_path}" -filte
+00008ae0: 725f 636f 6d70 6c65 7820 225b 303a 765d  r_complex "[0:v]
+00008af0: 2066 7073 3d31 352c 7363 616c 653d 773d   fps=15,scale=w=
+00008b00: 7b77 6964 7468 7d3a 683d 2d31 2c73 706c  {width}:h=-1,spl
+00008b10: 6974 205b 615d 5b62 5d3b 5b61 5d20 7061  it [a][b];[a] pa
+00008b20: 6c65 7474 6567 656e 3d73 7461 7473 5f6d  lettegen=stats_m
+00008b30: 6f64 653d 7369 6e67 6c65 205b 705d 3b5b  ode=single [p];[
+00008b40: 625d 5b70 5d20 7061 6c65 7474 6575 7365  b][p] paletteuse
+00008b50: 3d6e 6577 3d31 2220 227b 7361 7665 5f6e  =new=1" "{save_n
+00008b60: 616d 657d 2227 0a20 2020 2070 7269 6e74  ame}"'.    print
+00008b70: 2822 4372 6561 7469 6e67 2067 6966 2073  ("Creating gif s
+00008b80: 616d 706c 652e 2e2e 2022 290a 2020 2020  ample... ").    
+00008b90: 7375 6270 726f 6365 7373 2e63 616c 6c28  subprocess.call(
+00008ba0: 636f 6d6d 616e 642c 2073 6865 6c6c 3d54  command, shell=T
+00008bb0: 7275 652c 2073 7464 6f75 743d 7375 6270  rue, stdout=subp
+00008bc0: 726f 6365 7373 2e50 4950 4529 0a20 2020  rocess.PIPE).   
+00008bd0: 2074 696d 6572 2e73 746f 705f 7469 6d65   timer.stop_time
+00008be0: 7228 290a 2020 2020 7374 646f 7574 5f73  r().    stdout_s
+00008bf0: 7563 6365 7373 280a 2020 2020 2020 2020  uccess(.        
+00008c00: 6d73 673d 6622 5349 4d42 4120 434f 4d50  msg=f"SIMBA COMP
+00008c10: 4c45 5445 3a20 5669 6465 6f20 636f 6e76  LETE: Video conv
+00008c20: 6572 7465 6421 207b 7361 7665 5f6e 616d  erted! {save_nam
+00008c30: 657d 2067 656e 6572 6174 6564 2122 2c0a  e} generated!",.
+00008c40: 2020 2020 2020 2020 656c 6170 7365 645f          elapsed_
+00008c50: 7469 6d65 3d74 696d 6572 2e65 6c61 7073  time=timer.elaps
+00008c60: 6564 5f74 696d 655f 7374 722c 0a20 2020  ed_time_str,.   
+00008c70: 2020 2020 2073 6f75 7263 653d 6769 665f       source=gif_
+00008c80: 6372 6561 746f 722e 5f5f 6e61 6d65 5f5f  creator.__name__
+00008c90: 2c0a 2020 2020 290a 0a0a 2320 6769 665f  ,.    )...# gif_
+00008ca0: 6372 6561 746f 7228 6669 6c65 5f70 6174  creator(file_pat
+00008cb0: 683d 7227 2f55 7365 7273 2f73 696d 6f6e  h=r'/Users/simon
+00008cc0: 2f44 6573 6b74 6f70 2f65 6e76 732f 7369  /Desktop/envs/si
+00008cd0: 6d62 612f 7472 6f75 626c 6573 686f 6f74  mba/troubleshoot
+00008ce0: 696e 672f 6d6f 7573 655f 6f70 656e 5f66  ing/mouse_open_f
+00008cf0: 6965 6c64 2f70 726f 6a65 6374 5f66 6f6c  ield/project_fol
+00008d00: 6465 722f 7669 6465 6f73 2f53 495f 4441  der/videos/SI_DA
+00008d10: 5933 5f33 3038 5f43 4431 5f50 5245 5345  Y3_308_CD1_PRESE
+00008d20: 4e54 2e6d 7034 272c 2073 7461 7274 5f74  NT.mp4', start_t
+00008d30: 696d 653d 352c 2064 7572 6174 696f 6e3d  ime=5, duration=
+00008d40: 3135 2c20 7769 6474 683d 3630 302c 2067  15, width=600, g
+00008d50: 7075 3d46 616c 7365 290a 0a0a 6465 6620  pu=False)...def 
+00008d60: 6261 7463 685f 636f 6e76 6572 745f 7669  batch_convert_vi
+00008d70: 6465 6f5f 666f 726d 6174 280a 2020 2020  deo_format(.    
+00008d80: 6469 7265 6374 6f72 793a 2055 6e69 6f6e  directory: Union
+00008d90: 5b73 7472 2c20 6f73 2e50 6174 684c 696b  [str, os.PathLik
+00008da0: 655d 2c0a 2020 2020 696e 7075 745f 666f  e],.    input_fo
+00008db0: 726d 6174 3a20 7374 722c 0a20 2020 206f  rmat: str,.    o
+00008dc0: 7574 7075 745f 666f 726d 6174 3a20 7374  utput_format: st
+00008dd0: 722c 0a20 2020 2067 7075 3a20 4f70 7469  r,.    gpu: Opti
+00008de0: 6f6e 616c 5b62 6f6f 6c5d 203d 2046 616c  onal[bool] = Fal
+00008df0: 7365 2c0a 2920 2d3e 204e 6f6e 653a 0a20  se,.) -> None:. 
+00008e00: 2020 2022 2222 0a20 2020 2042 6174 6368     """.    Batch
+00008e10: 2063 6f6e 7665 7274 2061 6c6c 2076 6964   convert all vid
+00008e20: 656f 7320 696e 2061 2066 6f6c 6465 7220  eos in a folder 
+00008e30: 6f66 2073 7065 6369 6669 6320 666f 726d  of specific form
+00008e40: 6174 2069 6e74 6f20 6120 6469 6666 6572  at into a differ
+00008e50: 656e 7420 7669 6465 6f20 666f 726d 6174  ent video format
+00008e60: 2e20 5468 6520 7265 7375 6c74 7320 6172  . The results ar
+00008e70: 650a 2020 2020 7374 6f72 6564 2069 6e20  e.    stored in 
+00008e80: 7468 6520 7361 6d65 2064 6972 6563 746f  the same directo
+00008e90: 7279 2061 7320 7468 6520 696e 7075 7420  ry as the input 
+00008ea0: 6669 6c65 732e 0a0a 2020 2020 3a70 6172  files...    :par
+00008eb0: 616d 6574 6572 2055 6e69 6f6e 5b73 7472  ameter Union[str
+00008ec0: 2c20 6f73 2e50 6174 684c 696b 655d 2064  , os.PathLike] d
+00008ed0: 6972 6563 746f 7279 3a20 5061 7468 2074  irectory: Path t
+00008ee0: 6f20 7669 6465 6f20 6669 6c65 2064 6972  o video file dir
+00008ef0: 6563 746f 7279 2e0a 2020 2020 3a70 6172  ectory..    :par
+00008f00: 616d 6574 6572 2073 7472 2069 6e70 7574  ameter str input
+00008f10: 5f66 6f72 6d61 743a 2046 6f72 6d61 7420  _format: Format 
+00008f20: 6f66 2074 6865 2069 6e70 7574 2066 696c  of the input fil
+00008f30: 6573 2028 652e 672e 2c20 6176 6929 2e0a  es (e.g., avi)..
+00008f40: 2020 2020 3a70 6172 616d 6574 6572 2073      :parameter s
+00008f50: 7472 206f 7574 7075 745f 666f 726d 6174  tr output_format
+00008f60: 3a20 466f 726d 6174 206f 6620 7468 6520  : Format of the 
+00008f70: 6f75 7470 7574 2066 696c 6573 2028 652e  output files (e.
+00008f80: 672e 2c20 6d70 3429 2e0a 2020 2020 3a70  g., mp4)..    :p
+00008f90: 6172 616d 6574 6572 204f 7074 696f 6e61  arameter Optiona
+00008fa0: 6c5b 626f 6f6c 5d20 6770 753a 2049 6620  l[bool] gpu: If 
+00008fb0: 5472 7565 2c20 7573 6520 4e56 4944 4541  True, use NVIDEA
+00008fc0: 2047 5055 2063 6f64 6563 732e 2044 6566   GPU codecs. Def
+00008fd0: 6175 6c74 2046 616c 7365 2e0a 0a20 2020  ault False...   
+00008fe0: 203a 6578 616d 706c 653a 0a20 2020 203e   :example:.    >
+00008ff0: 3e3e 205f 203d 2062 6174 6368 5f63 6f6e  >> _ = batch_con
+00009000: 7665 7274 5f76 6964 656f 5f66 6f72 6d61  vert_video_forma
+00009010: 7428 6469 7265 6374 6f72 793d 2770 726f  t(directory='pro
+00009020: 6a65 6374 5f66 6f6c 6465 722f 7669 6465  ject_folder/vide
+00009030: 6f73 272c 2069 6e70 7574 5f66 6f72 6d61  os', input_forma
+00009040: 743d 2761 7669 272c 206f 7574 7075 745f  t='avi', output_
+00009050: 666f 726d 6174 3d27 6d70 3427 290a 2020  format='mp4').  
+00009060: 2020 2222 220a 0a20 2020 2063 6865 636b    """..    check
+00009070: 5f66 666d 7065 675f 6176 6169 6c61 626c  _ffmpeg_availabl
+00009080: 6528 7261 6973 655f 6572 726f 723d 5472  e(raise_error=Tr
+00009090: 7565 290a 2020 2020 6966 2067 7075 2061  ue).    if gpu a
+000090a0: 6e64 206e 6f74 2063 6865 636b 5f6e 7669  nd not check_nvi
+000090b0: 6465 615f 6770 755f 6176 6169 6c61 626c  dea_gpu_availabl
+000090c0: 6528 293a 0a20 2020 2020 2020 2072 6169  e():.        rai
+000090d0: 7365 2046 464d 5045 4743 6f64 6563 4750  se FFMPEGCodecGP
+000090e0: 5545 7272 6f72 280a 2020 2020 2020 2020  UError(.        
+000090f0: 2020 2020 6d73 673d 224e 5649 4445 4120      msg="NVIDEA 
+00009100: 4750 5520 6e6f 7420 6176 6169 6c61 626c  GPU not availabl
+00009110: 6520 2861 7320 6576 616c 7561 7465 6420  e (as evaluated 
+00009120: 6279 206e 7669 6465 612d 736d 6920 7265  by nvidea-smi re
+00009130: 7475 726e 696e 6720 4e6f 6e65 222c 0a20  turning None",. 
+00009140: 2020 2020 2020 2020 2020 2073 6f75 7263             sourc
+00009150: 653d 6261 7463 685f 636f 6e76 6572 745f  e=batch_convert_
+00009160: 7669 6465 6f5f 666f 726d 6174 2e5f 5f6e  video_format.__n
+00009170: 616d 655f 5f2c 0a20 2020 2020 2020 2029  ame__,.        )
+00009180: 0a20 2020 2069 6620 696e 7075 745f 666f  .    if input_fo
+00009190: 726d 6174 203d 3d20 6f75 7470 7574 5f66  rmat == output_f
+000091a0: 6f72 6d61 743a 0a20 2020 2020 2020 2072  ormat:.        r
+000091b0: 6169 7365 2049 6e76 616c 6964 4669 6c65  aise InvalidFile
+000091c0: 5479 7065 4572 726f 7228 0a20 2020 2020  TypeError(.     
+000091d0: 2020 2020 2020 206d 7367 3d66 2254 6865         msg=f"The
+000091e0: 2069 6e70 7574 2066 6f72 6d61 7420 287b   input format ({
+000091f0: 696e 7075 745f 666f 726d 6174 7d29 2069  input_format}) i
+00009200: 7320 7468 6520 7361 6d65 2061 7320 7468  s the same as th
+00009210: 6520 6f75 7470 7574 2066 6f72 6d61 7420  e output format 
+00009220: 287b 6f75 7470 7574 5f66 6f72 6d61 747d  ({output_format}
+00009230: 2922 2c0a 2020 2020 2020 2020 2020 2020  )",.            
+00009240: 736f 7572 6365 3d62 6174 6368 5f63 6f6e  source=batch_con
+00009250: 7665 7274 5f76 6964 656f 5f66 6f72 6d61  vert_video_forma
+00009260: 742e 5f5f 6e61 6d65 5f5f 2c0a 2020 2020  t.__name__,.    
+00009270: 2020 2020 290a 2020 2020 6966 206e 6f74      ).    if not
+00009280: 206f 732e 7061 7468 2e69 7364 6972 2864   os.path.isdir(d
+00009290: 6972 6563 746f 7279 293a 0a20 2020 2020  irectory):.     
+000092a0: 2020 2072 6169 7365 204e 6f74 4469 7265     raise NotDire
+000092b0: 6374 6f72 7945 7272 6f72 280a 2020 2020  ctoryError(.    
+000092c0: 2020 2020 2020 2020 6d73 673d 2253 494d          msg="SIM
+000092d0: 4241 2045 5252 4f52 3a20 7b7d 2069 7320  BA ERROR: {} is 
+000092e0: 6e6f 7420 6120 7661 6c69 6420 6469 7265  not a valid dire
+000092f0: 6374 6f72 7922 2e66 6f72 6d61 7428 6469  ctory".format(di
+00009300: 7265 6374 6f72 7929 2c0a 2020 2020 2020  rectory),.      
+00009310: 2020 2020 2020 736f 7572 6365 3d62 6174        source=bat
+00009320: 6368 5f63 6f6e 7665 7274 5f76 6964 656f  ch_convert_video
+00009330: 5f66 6f72 6d61 742e 5f5f 6e61 6d65 5f5f  _format.__name__
+00009340: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+00009350: 7669 6465 6f5f 7061 7468 7320 3d20 5b5d  video_paths = []
+00009360: 0a20 2020 2066 696c 655f 7061 7468 735f  .    file_paths_
+00009370: 696e 5f66 6f6c 6465 7220 3d20 5b66 2066  in_folder = [f f
+00009380: 6f72 2066 2069 6e20 676c 6f62 2e67 6c6f  or f in glob.glo
+00009390: 6228 6469 7265 6374 6f72 7920 2b20 222f  b(directory + "/
+000093a0: 2a22 2920 6966 206f 732e 7061 7468 2e69  *") if os.path.i
+000093b0: 7366 696c 6528 6629 5d0a 2020 2020 666f  sfile(f)].    fo
+000093c0: 7220 6669 6c65 5f70 6174 6820 696e 2066  r file_path in f
+000093d0: 696c 655f 7061 7468 735f 696e 5f66 6f6c  ile_paths_in_fol
+000093e0: 6465 723a 0a20 2020 2020 2020 205f 2c20  der:.        _, 
+000093f0: 5f2c 2065 7874 203d 2067 6574 5f66 6e5f  _, ext = get_fn_
+00009400: 6578 7428 6669 6c65 7061 7468 3d66 696c  ext(filepath=fil
+00009410: 655f 7061 7468 290a 2020 2020 2020 2020  e_path).        
+00009420: 6966 2065 7874 2e6c 6f77 6572 2829 203d  if ext.lower() =
+00009430: 3d20 222e 7b7d 222e 666f 726d 6174 2869  = ".{}".format(i
+00009440: 6e70 7574 5f66 6f72 6d61 742e 6c6f 7765  nput_format.lowe
+00009450: 7228 2929 3a0a 2020 2020 2020 2020 2020  r()):.          
+00009460: 2020 7669 6465 6f5f 7061 7468 732e 6170    video_paths.ap
+00009470: 7065 6e64 2866 696c 655f 7061 7468 290a  pend(file_path).
+00009480: 2020 2020 6966 206c 656e 2876 6964 656f      if len(video
+00009490: 5f70 6174 6873 2920 3c20 313a 0a20 2020  _paths) < 1:.   
+000094a0: 2020 2020 2072 6169 7365 204e 6f46 696c       raise NoFil
+000094b0: 6573 466f 756e 6445 7272 6f72 280a 2020  esFoundError(.  
+000094c0: 2020 2020 2020 2020 2020 6d73 673d 2253            msg="S
+000094d0: 494d 4241 2045 5252 4f52 3a20 4e6f 2066  IMBA ERROR: No f
+000094e0: 696c 6573 2077 6974 6820 2e7b 7d20 6669  iles with .{} fi
+000094f0: 6c65 2065 7874 656e 7369 6f6e 2066 6f75  le extension fou
+00009500: 6e64 2069 6e20 7468 6520 7b7d 2064 6972  nd in the {} dir
+00009510: 6563 746f 7279 222e 666f 726d 6174 280a  ectory".format(.
+00009520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009530: 696e 7075 745f 666f 726d 6174 2c20 6469  input_format, di
+00009540: 7265 6374 6f72 790a 2020 2020 2020 2020  rectory.        
+00009550: 2020 2020 292c 0a20 2020 2020 2020 2020      ),.         
+00009560: 2020 2073 6f75 7263 653d 6261 7463 685f     source=batch_
+00009570: 636f 6e76 6572 745f 7669 6465 6f5f 666f  convert_video_fo
+00009580: 726d 6174 2e5f 5f6e 616d 655f 5f2c 0a20  rmat.__name__,. 
+00009590: 2020 2020 2020 2029 0a20 2020 2066 6f72         ).    for
+000095a0: 2066 696c 655f 636e 742c 2066 696c 655f   file_cnt, file_
+000095b0: 7061 7468 2069 6e20 656e 756d 6572 6174  path in enumerat
+000095c0: 6528 7669 6465 6f5f 7061 7468 7329 3a0a  e(video_paths):.
+000095d0: 2020 2020 2020 2020 7669 6465 6f5f 7469          video_ti
+000095e0: 6d65 7220 3d20 5369 6d62 6154 696d 6572  mer = SimbaTimer
+000095f0: 2873 7461 7274 3d54 7275 6529 0a20 2020  (start=True).   
+00009600: 2020 2020 2064 6972 5f6e 616d 652c 2066       dir_name, f
+00009610: 696c 655f 6e61 6d65 2c20 6578 7420 3d20  ile_name, ext = 
+00009620: 6765 745f 666e 5f65 7874 2866 696c 6570  get_fn_ext(filep
+00009630: 6174 683d 6669 6c65 5f70 6174 6829 0a20  ath=file_path). 
+00009640: 2020 2020 2020 2070 7269 6e74 2866 2250         print(f"P
+00009650: 726f 6365 7373 696e 6720 7669 6465 6f20  rocessing video 
+00009660: 7b66 696c 655f 6e61 6d65 7d2e 2e2e 2229  {file_name}...")
+00009670: 0a20 2020 2020 2020 2073 6176 655f 7061  .        save_pa
+00009680: 7468 203d 206f 732e 7061 7468 2e6a 6f69  th = os.path.joi
+00009690: 6e28 0a20 2020 2020 2020 2020 2020 2064  n(.            d
+000096a0: 6972 5f6e 616d 652c 2066 696c 655f 6e61  ir_name, file_na
+000096b0: 6d65 202b 2022 2e7b 7d22 2e66 6f72 6d61  me + ".{}".forma
+000096c0: 7428 6f75 7470 7574 5f66 6f72 6d61 742e  t(output_format.
+000096d0: 6c6f 7765 7228 2929 0a20 2020 2020 2020  lower()).       
+000096e0: 2029 0a20 2020 2020 2020 2069 6620 6f73   ).        if os
+000096f0: 2e70 6174 682e 6973 6669 6c65 2873 6176  .path.isfile(sav
+00009700: 655f 7061 7468 293a 0a20 2020 2020 2020  e_path):.       
+00009710: 2020 2020 2072 6169 7365 2046 696c 6545       raise FileE
+00009720: 7869 7374 4572 726f 7228 0a20 2020 2020  xistError(.     
+00009730: 2020 2020 2020 2020 2020 206d 7367 3d22             msg="
+00009740: 5349 4d42 4120 4552 524f 523a 2054 6865  SIMBA ERROR: The
+00009750: 206f 7574 6669 6c65 2066 696c 6520 616c   outfile file al
+00009760: 7265 6164 7920 6578 6973 743a 207b 7d2e  ready exist: {}.
+00009770: 222e 666f 726d 6174 280a 2020 2020 2020  ".format(.      
+00009780: 2020 2020 2020 2020 2020 2020 2020 7361                sa
+00009790: 7665 5f70 6174 680a 2020 2020 2020 2020  ve_path.        
+000097a0: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
+000097b0: 2020 2020 2020 2020 2020 2073 6f75 7263             sourc
+000097c0: 653d 6261 7463 685f 636f 6e76 6572 745f  e=batch_convert_
+000097d0: 7669 6465 6f5f 666f 726d 6174 2e5f 5f6e  video_format.__n
+000097e0: 616d 655f 5f2c 0a20 2020 2020 2020 2020  ame__,.         
+000097f0: 2020 2029 0a20 2020 2020 2020 2069 6620     ).        if 
+00009800: 6770 753a 0a20 2020 2020 2020 2020 2020  gpu:.           
+00009810: 2063 6f6d 6d61 6e64 203d 2027 6666 6d70   command = 'ffmp
+00009820: 6567 202d 6877 6163 6365 6c20 6175 746f  eg -hwaccel auto
+00009830: 202d 633a 7620 6832 3634 5f63 7576 6964   -c:v h264_cuvid
+00009840: 202d 6920 227b 7d22 202d 633a 7620 6832   -i "{}" -c:v h2
+00009850: 3634 5f6e 7665 6e63 202d 6371 2032 3320  64_nvenc -cq 23 
+00009860: 2d70 7265 7365 743a 7620 6d65 6469 756d  -preset:v medium
+00009870: 202d 633a 6120 636f 7079 2022 7b7d 2227   -c:a copy "{}"'
+00009880: 2e66 6f72 6d61 7428 0a20 2020 2020 2020  .format(.       
+00009890: 2020 2020 2020 2020 2066 696c 655f 7061           file_pa
+000098a0: 7468 2c20 7361 7665 5f70 6174 680a 2020  th, save_path.  
+000098b0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+000098c0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000098d0: 2020 2020 2020 636f 6d6d 616e 6420 3d20        command = 
+000098e0: 6627 6666 6d70 6567 202d 7920 2d69 2022  f'ffmpeg -y -i "
+000098f0: 7b66 696c 655f 7061 7468 7d22 202d 633a  {file_path}" -c:
+00009900: 7620 6c69 6278 3236 3420 2d63 7266 2032  v libx264 -crf 2
+00009910: 3120 2d70 7265 7365 7420 6d65 6469 756d  1 -preset medium
+00009920: 202d 633a 6120 6c69 626d 7033 6c61 6d65   -c:a libmp3lame
+00009930: 202d 623a 6120 3332 306b 2022 7b73 6176   -b:a 320k "{sav
+00009940: 655f 7061 7468 7d22 270a 2020 2020 2020  e_path}"'.      
+00009950: 2020 7375 6270 726f 6365 7373 2e63 616c    subprocess.cal
+00009960: 6c28 636f 6d6d 616e 642c 2073 6865 6c6c  l(command, shell
+00009970: 3d54 7275 652c 2073 7464 6f75 743d 7375  =True, stdout=su
+00009980: 6270 726f 6365 7373 2e50 4950 4529 0a20  bprocess.PIPE). 
+00009990: 2020 2020 2020 2076 6964 656f 5f74 696d         video_tim
+000099a0: 6572 2e73 746f 705f 7469 6d65 7228 290a  er.stop_timer().
+000099b0: 2020 2020 2020 2020 7072 696e 7428 0a20          print(. 
+000099c0: 2020 2020 2020 2020 2020 2066 2256 6964             f"Vid
+000099d0: 656f 207b 6669 6c65 5f6e 616d 657d 2063  eo {file_name} c
+000099e0: 6f6d 706c 6574 652c 2028 656c 6170 7365  omplete, (elapse
+000099f0: 6420 7469 6d65 3a20 7b76 6964 656f 5f74  d time: {video_t
+00009a00: 696d 6572 2e65 6c61 7073 6564 5f74 696d  imer.elapsed_tim
+00009a10: 655f 7374 727d 7329 2028 5669 6465 6f20  e_str}s) (Video 
+00009a20: 7b66 696c 655f 636e 7420 2b20 317d 2f7b  {file_cnt + 1}/{
+00009a30: 6c65 6e28 7669 6465 6f5f 7061 7468 7329  len(video_paths)
+00009a40: 7d29 2e2e 2e22 0a20 2020 2020 2020 2029  })...".        )
+00009a50: 0a20 2020 2073 7464 6f75 745f 7375 6363  .    stdout_succ
+00009a60: 6573 7328 0a20 2020 2020 2020 206d 7367  ess(.        msg
+00009a70: 3d66 2253 494d 4241 2043 4f4d 504c 4554  =f"SIMBA COMPLET
+00009a80: 453a 207b 7374 7228 6c65 6e28 7669 6465  E: {str(len(vide
+00009a90: 6f5f 7061 7468 7329 297d 2076 6964 656f  o_paths))} video
+00009aa0: 7320 636f 6e76 6572 7465 6420 696e 207b  s converted in {
+00009ab0: 6469 7265 6374 6f72 797d 2064 6972 6563  directory} direc
+00009ac0: 746f 7279 2122 2c0a 2020 2020 2020 2020  tory!",.        
+00009ad0: 736f 7572 6365 3d62 6174 6368 5f63 6f6e  source=batch_con
+00009ae0: 7665 7274 5f76 6964 656f 5f66 6f72 6d61  vert_video_forma
+00009af0: 742e 5f5f 6e61 6d65 5f5f 2c0a 2020 2020  t.__name__,.    
+00009b00: 290a 0a0a 2320 5f20 3d20 6261 7463 685f  )...# _ = batch_
+00009b10: 636f 6e76 6572 745f 7669 6465 6f5f 666f  convert_video_fo
+00009b20: 726d 6174 2864 6972 6563 746f 7279 3d27  rmat(directory='
+00009b30: 2f55 7365 7273 2f73 696d 6f6e 2f44 6573  /Users/simon/Des
+00009b40: 6b74 6f70 2f65 6e76 732f 7369 6d62 612f  ktop/envs/simba/
+00009b50: 7472 6f75 626c 6573 686f 6f74 696e 672f  troubleshooting/
+00009b60: 6d6f 7573 655f 6f70 656e 5f66 6965 6c64  mouse_open_field
+00009b70: 2f70 726f 6a65 6374 5f66 6f6c 6465 722f  /project_folder/
+00009b80: 7669 6465 6f73 2f74 6573 745f 3227 2c69  videos/test_2',i
+00009b90: 6e70 7574 5f66 6f72 6d61 743d 276d 7034  nput_format='mp4
+00009ba0: 272c 206f 7574 7075 745f 666f 726d 6174  ', output_format
+00009bb0: 3d27 6176 6927 290a 0a0a 6465 6620 6261  ='avi')...def ba
+00009bc0: 7463 685f 6372 6561 7465 5f66 7261 6d65  tch_create_frame
+00009bd0: 7328 6469 7265 6374 6f72 793a 2055 6e69  s(directory: Uni
+00009be0: 6f6e 5b73 7472 2c20 6f73 2e50 6174 684c  on[str, os.PathL
+00009bf0: 696b 655d 2920 2d3e 204e 6f6e 653a 0a20  ike]) -> None:. 
+00009c00: 2020 2022 2222 0a20 2020 2045 7874 7261     """.    Extra
+00009c10: 6374 2061 6c6c 2066 7261 6d65 7320 666f  ct all frames fo
+00009c20: 7220 616c 6c20 7669 6465 6f73 2069 6e20  r all videos in 
+00009c30: 6120 6469 7265 6374 6f72 792e 2052 6573  a directory. Res
+00009c40: 756c 7473 2061 7265 2073 746f 7265 6420  ults are stored 
+00009c50: 7769 7468 696e 2073 7562 2d64 6972 6563  within sub-direc
+00009c60: 746f 7269 6573 2069 6e20 7468 6520 696e  tories in the in
+00009c70: 7075 740a 2020 2020 6469 7265 6374 6f72  put.    director
+00009c80: 7920 6e61 6d65 6420 6163 636f 7264 696e  y named accordin
+00009c90: 6720 746f 2074 6865 2076 6964 656f 2066  g to the video f
+00009ca0: 696c 6573 2e0a 0a20 2020 203a 7061 7261  iles...    :para
+00009cb0: 6d65 7465 7220 7374 7220 6469 7265 6374  meter str direct
+00009cc0: 6f72 793a 2050 6174 6820 746f 2064 6972  ory: Path to dir
+00009cd0: 6563 746f 7279 2063 6f6e 7461 696e 696e  ectory containin
+00009ce0: 6720 7669 6465 6f20 6669 6c65 732e 0a0a  g video files...
+00009cf0: 2020 2020 3a65 7861 6d70 6c65 3a0a 2020      :example:.  
+00009d00: 2020 3e3e 3e20 5f20 3d20 6261 7463 685f    >>> _ = batch_
+00009d10: 6372 6561 7465 5f66 7261 6d65 7328 6469  create_frames(di
+00009d20: 7265 6374 6f72 793d 2770 726f 6a65 6374  rectory='project
+00009d30: 5f66 6f6c 6465 722f 7669 6465 6f73 2729  _folder/videos')
+00009d40: 0a20 2020 2022 2222 0a0a 2020 2020 6966  .    """..    if
+00009d50: 206e 6f74 206f 732e 7061 7468 2e69 7364   not os.path.isd
+00009d60: 6972 2864 6972 6563 746f 7279 293a 0a20  ir(directory):. 
+00009d70: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
+00009d80: 4469 7265 6374 6f72 7945 7272 6f72 280a  DirectoryError(.
+00009d90: 2020 2020 2020 2020 2020 2020 6d73 673d              msg=
+00009da0: 2253 494d 4241 2045 5252 4f52 3a20 7b7d  "SIMBA ERROR: {}
+00009db0: 2069 7320 6e6f 7420 6120 7661 6c69 6420   is not a valid 
+00009dc0: 6469 7265 6374 6f72 7922 2e66 6f72 6d61  directory".forma
+00009dd0: 7428 6469 7265 6374 6f72 7929 2c0a 2020  t(directory),.  
+00009de0: 2020 2020 2020 2020 2020 736f 7572 6365            source
+00009df0: 3d62 6174 6368 5f63 7265 6174 655f 6672  =batch_create_fr
+00009e00: 616d 6573 2e5f 5f6e 616d 655f 5f2c 0a20  ames.__name__,. 
+00009e10: 2020 2020 2020 2029 0a20 2020 2076 6964         ).    vid
+00009e20: 656f 5f70 6174 6873 203d 205b 5d0a 2020  eo_paths = [].  
+00009e30: 2020 6669 6c65 5f70 6174 6873 5f69 6e5f    file_paths_in_
+00009e40: 666f 6c64 6572 203d 205b 6620 666f 7220  folder = [f for 
+00009e50: 6620 696e 2067 6c6f 622e 676c 6f62 2864  f in glob.glob(d
+00009e60: 6972 6563 746f 7279 202b 2022 2f2a 2229  irectory + "/*")
+00009e70: 2069 6620 6f73 2e70 6174 682e 6973 6669   if os.path.isfi
+00009e80: 6c65 2866 295d 0a20 2020 2066 6f72 2066  le(f)].    for f
+00009e90: 696c 655f 7061 7468 2069 6e20 6669 6c65  ile_path in file
+00009ea0: 5f70 6174 6873 5f69 6e5f 666f 6c64 6572  _paths_in_folder
+00009eb0: 3a0a 2020 2020 2020 2020 5f2c 205f 2c20  :.        _, _, 
+00009ec0: 6578 7420 3d20 6765 745f 666e 5f65 7874  ext = get_fn_ext
+00009ed0: 2866 696c 6570 6174 683d 6669 6c65 5f70  (filepath=file_p
+00009ee0: 6174 6829 0a20 2020 2020 2020 2069 6620  ath).        if 
+00009ef0: 6578 742e 6c6f 7765 7228 2920 696e 205b  ext.lower() in [
+00009f00: 222e 6176 6922 2c20 222e 6d70 3422 2c20  ".avi", ".mp4", 
+00009f10: 222e 6d6f 7622 2c20 222e 666c 7622 5d3a  ".mov", ".flv"]:
+00009f20: 0a20 2020 2020 2020 2020 2020 2076 6964  .            vid
+00009f30: 656f 5f70 6174 6873 2e61 7070 656e 6428  eo_paths.append(
+00009f40: 6669 6c65 5f70 6174 6829 0a20 2020 2069  file_path).    i
+00009f50: 6620 6c65 6e28 7669 6465 6f5f 7061 7468  f len(video_path
+00009f60: 7329 203c 2031 3a0a 2020 2020 2020 2020  s) < 1:.        
+00009f70: 7261 6973 6520 4e6f 4669 6c65 7346 6f75  raise NoFilesFou
+00009f80: 6e64 4572 726f 7228 0a20 2020 2020 2020  ndError(.       
+00009f90: 2020 2020 206d 7367 3d22 5349 4d42 4120       msg="SIMBA 
+00009fa0: 4552 524f 523a 204e 6f20 6669 6c65 7320  ERROR: No files 
+00009fb0: 7769 7468 202e 6d70 342c 202e 6176 692c  with .mp4, .avi,
+00009fc0: 202e 6d6f 762c 202e 666c 7620 6669 6c65   .mov, .flv file
+00009fd0: 2065 6e64 696e 6720 666f 756e 6420 696e   ending found in
+00009fe0: 2074 6865 207b 7d20 6469 7265 6374 6f72   the {} director
+00009ff0: 7922 2e66 6f72 6d61 7428 0a20 2020 2020  y".format(.     
+0000a000: 2020 2020 2020 2020 2020 2064 6972 6563             direc
+0000a010: 746f 7279 0a20 2020 2020 2020 2020 2020  tory.           
+0000a020: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
+0000a030: 736f 7572 6365 3d62 6174 6368 5f63 7265  source=batch_cre
+0000a040: 6174 655f 6672 616d 6573 2e5f 5f6e 616d  ate_frames.__nam
+0000a050: 655f 5f2c 0a20 2020 2020 2020 2029 0a20  e__,.        ). 
+0000a060: 2020 2066 6f72 2066 696c 655f 636e 742c     for file_cnt,
+0000a070: 2066 696c 655f 7061 7468 2069 6e20 656e   file_path in en
+0000a080: 756d 6572 6174 6528 7669 6465 6f5f 7061  umerate(video_pa
+0000a090: 7468 7329 3a0a 2020 2020 2020 2020 6469  ths):.        di
+0000a0a0: 725f 6e61 6d65 2c20 6669 6c65 5f6e 616d  r_name, file_nam
+0000a0b0: 652c 2065 7874 203d 2067 6574 5f66 6e5f  e, ext = get_fn_
+0000a0c0: 6578 7428 6669 6c65 7061 7468 3d66 696c  ext(filepath=fil
+0000a0d0: 655f 7061 7468 290a 2020 2020 2020 2020  e_path).        
+0000a0e0: 7072 696e 7428 2250 726f 6365 7373 696e  print("Processin
+0000a0f0: 6720 7669 6465 6f20 7b7d 2e2e 2e22 2e66  g video {}...".f
+0000a100: 6f72 6d61 7428 6669 6c65 5f6e 616d 6529  ormat(file_name)
+0000a110: 290a 2020 2020 2020 2020 7361 7665 5f64  ).        save_d
+0000a120: 6972 203d 206f 732e 7061 7468 2e6a 6f69  ir = os.path.joi
+0000a130: 6e28 6469 725f 6e61 6d65 2c20 6669 6c65  n(dir_name, file
+0000a140: 5f6e 616d 6529 0a20 2020 2020 2020 2069  _name).        i
+0000a150: 6620 6e6f 7420 6f73 2e70 6174 682e 6578  f not os.path.ex
+0000a160: 6973 7473 2873 6176 655f 6469 7229 3a0a  ists(save_dir):.
+0000a170: 2020 2020 2020 2020 2020 2020 6f73 2e6d              os.m
+0000a180: 616b 6564 6972 7328 7361 7665 5f64 6972  akedirs(save_dir
+0000a190: 290a 2020 2020 2020 2020 7669 6465 6f5f  ).        video_
+0000a1a0: 746f 5f66 7261 6d65 7328 6669 6c65 5f70  to_frames(file_p
+0000a1b0: 6174 682c 2073 6176 655f 6469 722c 206f  ath, save_dir, o
+0000a1c0: 7665 7277 7269 7465 3d54 7275 652c 2065  verwrite=True, e
+0000a1d0: 7665 7279 3d31 2c20 6368 756e 6b5f 7369  very=1, chunk_si
+0000a1e0: 7a65 3d31 3030 3029 0a20 2020 2020 2020  ze=1000).       
+0000a1f0: 2070 7269 6e74 280a 2020 2020 2020 2020   print(.        
+0000a200: 2020 2020 2256 6964 656f 207b 7d20 636f      "Video {} co
+0000a210: 6d70 6c65 7465 2c20 2856 6964 656f 207b  mplete, (Video {
+0000a220: 7d2f 7b7d 292e 2e2e 222e 666f 726d 6174  }/{})...".format
+0000a230: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000a240: 2020 6669 6c65 5f6e 616d 652c 2073 7472    file_name, str
+0000a250: 2866 696c 655f 636e 7420 2b20 3129 2c20  (file_cnt + 1), 
+0000a260: 7374 7228 6c65 6e28 7669 6465 6f5f 7061  str(len(video_pa
+0000a270: 7468 7329 290a 2020 2020 2020 2020 2020  ths)).          
+0000a280: 2020 290a 2020 2020 2020 2020 290a 2020    ).        ).  
+0000a290: 2020 7374 646f 7574 5f73 7563 6365 7373    stdout_success
+0000a2a0: 280a 2020 2020 2020 2020 6d73 673d 6622  (.        msg=f"
+0000a2b0: 7b73 7472 286c 656e 2876 6964 656f 5f70  {str(len(video_p
+0000a2c0: 6174 6873 2929 7d20 7669 6465 6f73 2063  aths))} videos c
+0000a2d0: 6f6e 7665 7274 6564 2069 6e74 6f20 6672  onverted into fr
+0000a2e0: 616d 6573 2069 6e20 7b64 6972 6563 746f  ames in {directo
+0000a2f0: 7279 7d20 6469 7265 6374 6f72 7921 222c  ry} directory!",
+0000a300: 0a20 2020 2020 2020 2073 6f75 7263 653d  .        source=
+0000a310: 6261 7463 685f 6372 6561 7465 5f66 7261  batch_create_fra
+0000a320: 6d65 732e 5f5f 6e61 6d65 5f5f 2c0a 2020  mes.__name__,.  
+0000a330: 2020 290a 0a0a 6465 6620 6578 7472 6163    )...def extrac
+0000a340: 745f 6672 616d 6573 5f73 696e 676c 655f  t_frames_single_
+0000a350: 7669 6465 6f28 6669 6c65 5f70 6174 683a  video(file_path:
+0000a360: 2055 6e69 6f6e 5b73 7472 2c20 6f73 2e50   Union[str, os.P
+0000a370: 6174 684c 696b 655d 2920 2d3e 204e 6f6e  athLike]) -> Non
+0000a380: 653a 0a20 2020 2022 2222 0a20 2020 2045  e:.    """.    E
+0000a390: 7874 7261 6374 2061 6c6c 2066 7261 6d65  xtract all frame
+0000a3a0: 7320 666f 7220 6120 7369 6e67 6c65 2e20  s for a single. 
+0000a3b0: 5265 7375 6c74 7320 6172 6520 7374 6f72  Results are stor
+0000a3c0: 6564 2077 6974 6869 6e20 6120 7375 6264  ed within a subd
+0000a3d0: 6972 6563 746f 7279 2069 6e20 7468 6520  irectory in the 
+0000a3e0: 7361 6d65 0a20 2020 2064 6972 6563 746f  same.    directo
+0000a3f0: 7279 2061 7320 7468 6520 696e 7075 7420  ry as the input 
+0000a400: 6669 6c65 2e0a 0a20 2020 203a 7061 7261  file...    :para
+0000a410: 6d65 7465 7220 7374 7220 6669 6c65 5f70  meter str file_p
+0000a420: 6174 683a 2050 6174 6820 746f 2076 6964  ath: Path to vid
+0000a430: 656f 2066 696c 652e 0a0a 2020 2020 3a65  eo file...    :e
+0000a440: 7861 6d70 6c65 3a0a 2020 2020 3e3e 3e20  xample:.    >>> 
+0000a450: 5f20 3d20 6578 7472 6163 745f 6672 616d  _ = extract_fram
+0000a460: 6573 5f73 696e 676c 655f 7669 6465 6f28  es_single_video(
+0000a470: 6669 6c65 5f70 6174 683d 2770 726f 6a65  file_path='proje
+0000a480: 6374 5f66 6f6c 6465 722f 7669 6465 6f73  ct_folder/videos
+0000a490: 2f56 6964 656f 5f31 2e6d 7034 2729 0a20  /Video_1.mp4'). 
+0000a4a0: 2020 2022 2222 0a0a 2020 2020 7469 6d65     """..    time
+0000a4b0: 7220 3d20 5369 6d62 6154 696d 6572 2873  r = SimbaTimer(s
+0000a4c0: 7461 7274 3d54 7275 6529 0a20 2020 2063  tart=True).    c
+0000a4d0: 6865 636b 5f66 696c 655f 6578 6973 745f  heck_file_exist_
+0000a4e0: 616e 645f 7265 6164 6162 6c65 2866 696c  and_readable(fil
+0000a4f0: 655f 7061 7468 3d66 696c 655f 7061 7468  e_path=file_path
+0000a500: 290a 2020 2020 5f20 3d20 6765 745f 7669  ).    _ = get_vi
+0000a510: 6465 6f5f 6d65 7461 5f64 6174 6128 6669  deo_meta_data(fi
+0000a520: 6c65 5f70 6174 6829 0a20 2020 2064 6972  le_path).    dir
+0000a530: 5f6e 616d 652c 2066 696c 655f 6e61 6d65  _name, file_name
+0000a540: 2c20 6578 7420 3d20 6765 745f 666e 5f65  , ext = get_fn_e
+0000a550: 7874 2866 696c 6570 6174 683d 6669 6c65  xt(filepath=file
+0000a560: 5f70 6174 6829 0a20 2020 2073 6176 655f  _path).    save_
+0000a570: 6469 7220 3d20 6f73 2e70 6174 682e 6a6f  dir = os.path.jo
+0000a580: 696e 2864 6972 5f6e 616d 652c 2066 696c  in(dir_name, fil
+0000a590: 655f 6e61 6d65 290a 2020 2020 6966 206e  e_name).    if n
+0000a5a0: 6f74 206f 732e 7061 7468 2e65 7869 7374  ot os.path.exist
+0000a5b0: 7328 7361 7665 5f64 6972 293a 0a20 2020  s(save_dir):.   
+0000a5c0: 2020 2020 206f 732e 6d61 6b65 6469 7273       os.makedirs
+0000a5d0: 2873 6176 655f 6469 7229 0a20 2020 2070  (save_dir).    p
+0000a5e0: 7269 6e74 2866 2250 726f 6365 7373 696e  rint(f"Processin
+0000a5f0: 6720 7669 6465 6f20 7b66 696c 655f 6e61  g video {file_na
+0000a600: 6d65 7d2e 2e2e 2229 0a20 2020 2076 6964  me}...").    vid
+0000a610: 656f 5f74 6f5f 6672 616d 6573 2866 696c  eo_to_frames(fil
+0000a620: 655f 7061 7468 2c20 7361 7665 5f64 6972  e_path, save_dir
+0000a630: 2c20 6f76 6572 7772 6974 653d 5472 7565  , overwrite=True
+0000a640: 2c20 6576 6572 793d 312c 2063 6875 6e6b  , every=1, chunk
+0000a650: 5f73 697a 653d 3130 3030 290a 2020 2020  _size=1000).    
+0000a660: 7469 6d65 722e 7374 6f70 5f74 696d 6572  timer.stop_timer
+0000a670: 2829 0a20 2020 2073 7464 6f75 745f 7375  ().    stdout_su
+0000a680: 6363 6573 7328 0a20 2020 2020 2020 206d  ccess(.        m
+0000a690: 7367 3d66 2256 6964 656f 207b 6669 6c65  sg=f"Video {file
+0000a6a0: 5f6e 616d 657d 2063 6f6e 7665 7274 6564  _name} converted
+0000a6b0: 2074 6f20 696d 6167 6573 2069 6e20 7b64   to images in {d
+0000a6c0: 6972 5f6e 616d 657d 2064 6972 6563 746f  ir_name} directo
+0000a6d0: 7279 2122 2c0a 2020 2020 2020 2020 656c  ry!",.        el
+0000a6e0: 6170 7365 645f 7469 6d65 3d74 696d 6572  apsed_time=timer
+0000a6f0: 2e65 6c61 7073 6564 5f74 696d 655f 7374  .elapsed_time_st
+0000a700: 722c 0a20 2020 2020 2020 2073 6f75 7263  r,.        sourc
+0000a710: 653d 6578 7472 6163 745f 6672 616d 6573  e=extract_frames
+0000a720: 5f73 696e 676c 655f 7669 6465 6f2e 5f5f  _single_video.__
+0000a730: 6e61 6d65 5f5f 2c0a 2020 2020 290a 0a0a  name__,.    )...
+0000a740: 2320 5f20 3d20 6578 7472 6163 745f 6672  # _ = extract_fr
+0000a750: 616d 6573 5f73 696e 676c 655f 7669 6465  ames_single_vide
+0000a760: 6f28 6669 6c65 5f70 6174 683d 272f 5573  o(file_path='/Us
+0000a770: 6572 732f 7369 6d6f 6e2f 4465 736b 746f  ers/simon/Deskto
+0000a780: 702f 656e 7673 2f73 696d 6261 2f74 726f  p/envs/simba/tro
+0000a790: 7562 6c65 7368 6f6f 7469 6e67 2f6d 6f75  ubleshooting/mou
+0000a7a0: 7365 5f6f 7065 6e5f 6669 656c 642f 7072  se_open_field/pr
+0000a7b0: 6f6a 6563 745f 666f 6c64 6572 2f76 6964  oject_folder/vid
+0000a7c0: 656f 732f 5349 5f44 4159 335f 3330 385f  eos/SI_DAY3_308_
+0000a7d0: 4344 315f 5052 4553 454e 545f 646f 776e  CD1_PRESENT_down
+0000a7e0: 7361 6d70 6c65 642e 6d70 3427 290a 0a0a  sampled.mp4')...
+0000a7f0: 6465 6620 6d75 6c74 695f 7370 6c69 745f  def multi_split_
+0000a800: 7669 6465 6f28 0a20 2020 2066 696c 655f  video(.    file_
+0000a810: 7061 7468 3a20 556e 696f 6e5b 7374 722c  path: Union[str,
+0000a820: 206f 732e 5061 7468 4c69 6b65 5d2c 0a20   os.PathLike],. 
+0000a830: 2020 2073 7461 7274 5f74 696d 6573 3a20     start_times: 
+0000a840: 4c69 7374 5b73 7472 5d2c 0a20 2020 2065  List[str],.    e
+0000a850: 6e64 5f74 696d 6573 3a20 4c69 7374 5b73  nd_times: List[s
+0000a860: 7472 5d2c 0a20 2020 206f 7574 5f64 6972  tr],.    out_dir
+0000a870: 3a20 4f70 7469 6f6e 616c 5b55 6e69 6f6e  : Optional[Union
+0000a880: 5b73 7472 2c20 6f73 2e50 6174 684c 696b  [str, os.PathLik
+0000a890: 655d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  e]] = None,.    
+0000a8a0: 696e 636c 7564 655f 636c 6970 5f74 696d  include_clip_tim
+0000a8b0: 655f 696e 5f66 696c 656e 616d 653a 204f  e_in_filename: O
+0000a8c0: 7074 696f 6e61 6c5b 626f 6f6c 5d20 3d20  ptional[bool] = 
+0000a8d0: 4661 6c73 652c 0a20 2020 2067 7075 3a20  False,.    gpu: 
+0000a8e0: 4f70 7469 6f6e 616c 5b62 6f6f 6c5d 203d  Optional[bool] =
+0000a8f0: 2046 616c 7365 2c0a 2920 2d3e 204e 6f6e   False,.) -> Non
+0000a900: 653a 0a20 2020 2022 2222 0a20 2020 2044  e:.    """.    D
+0000a910: 6976 6964 6520 6120 7669 6465 6f20 6669  ivide a video fi
+0000a920: 6c65 2069 6e74 6f20 6d75 6c74 6970 6c65  le into multiple
+0000a930: 2076 6964 656f 2066 696c 6573 2066 726f   video files fro
+0000a940: 6d20 7370 6563 6966 6965 6420 7374 6172  m specified star
+0000a950: 7420 616e 6420 7374 6f70 2074 696d 6573  t and stop times
+0000a960: 2e0a 0a20 2020 203a 7061 7261 6d65 7465  ...    :paramete
+0000a970: 7220 7374 7220 6669 6c65 5f70 6174 683a  r str file_path:
+0000a980: 2050 6174 6820 746f 2069 6e70 7574 2076   Path to input v
+0000a990: 6964 656f 2066 696c 652e 0a20 2020 203a  ideo file..    :
+0000a9a0: 7061 7261 6d65 7465 7220 4c69 7374 5b73  parameter List[s
+0000a9b0: 7472 5d20 7374 6172 745f 7469 6d65 733a  tr] start_times:
+0000a9c0: 2053 7461 7274 2074 696d 6573 2069 6e20   Start times in 
+0000a9d0: 4848 3a4d 4d3a 5353 2066 6f72 6d61 742e  HH:MM:SS format.
+0000a9e0: 0a20 2020 203a 7061 7261 6d65 7465 7220  .    :parameter 
+0000a9f0: 4c69 7374 5b73 7472 5d20 656e 645f 7469  List[str] end_ti
+0000aa00: 6d65 733a 2045 6e64 2074 696d 6573 2069  mes: End times i
+0000aa10: 6e20 4848 3a4d 4d3a 5353 2066 6f72 6d61  n HH:MM:SS forma
+0000aa20: 742e 0a20 2020 203a 7061 7261 6d65 7465  t..    :paramete
+0000aa30: 7220 4f70 7469 6f6e 616c 5b55 6e69 6f6e  r Optional[Union
+0000aa40: 5b73 7472 2c20 6f73 2e50 6174 684c 696b  [str, os.PathLik
+0000aa50: 655d 5d20 6f75 745f 6469 723a 2049 6620  e]] out_dir: If 
+0000aa60: 4e6f 6e65 2c20 7468 656e 2074 6865 2063  None, then the c
+0000aa70: 6c69 7073 2077 696c 6c20 6265 2073 746f  lips will be sto
+0000aa80: 7265 6420 696e 2074 6865 2073 616d 6520  red in the same 
+0000aa90: 6469 7220 6173 2074 6865 2069 6e70 7574  dir as the input
+0000aaa0: 2076 6964 656f 2e20 4966 2064 6972 6563   video. If direc
+0000aab0: 746f 7279 2c20 7468 656e 2074 6865 206c  tory, then the l
+0000aac0: 6f63 6174 696f 6e20 6f66 2074 6865 206f  ocation of the o
+0000aad0: 7574 7075 7420 6669 6c65 732e 0a20 2020  utput files..   
+0000aae0: 203a 7061 7261 6d65 7465 7220 4f70 7469   :parameter Opti
+0000aaf0: 6f6e 616c 5b62 6f6f 6c5d 2069 6e63 6c75  onal[bool] inclu
+0000ab00: 6465 5f63 6c69 705f 7469 6d65 5f69 6e5f  de_clip_time_in_
+0000ab10: 6669 6c65 6e61 6d65 3a20 4966 2054 7275  filename: If Tru
+0000ab20: 652c 2069 6e63 6c75 6465 2074 6865 2063  e, include the c
+0000ab30: 6c69 7020 7374 6172 7420 616e 6420 656e  lip start and en
+0000ab40: 6420 696e 2048 482d 4d4d 2d53 5320 666f  d in HH-MM-SS fo
+0000ab50: 726d 6174 2061 7320 7375 6666 6978 2069  rmat as suffix i
+0000ab60: 6e20 7468 6520 6669 6c65 6e61 6d65 2e20  n the filename. 
+0000ab70: 4966 2046 616c 7365 2c20 7468 656e 2075  If False, then u
+0000ab80: 7365 2069 6e74 6567 6572 2073 7566 6669  se integer suffi
+0000ab90: 6320 7265 7072 6573 656e 7469 6e67 2074  c representing t
+0000aba0: 6865 2063 6f75 6e74 2e0a 2020 2020 3a70  he count..    :p
+0000abb0: 6172 616d 6574 6572 204f 7074 696f 6e61  arameter Optiona
+0000abc0: 6c5b 626f 6f6c 5d20 6770 753a 2049 6620  l[bool] gpu: If 
+0000abd0: 5472 7565 2c20 7573 6520 4e56 4944 4541  True, use NVIDEA
+0000abe0: 2047 5055 2063 6f64 6563 732e 2044 6566   GPU codecs. Def
+0000abf0: 6175 6c74 2046 616c 7365 2e0a 0a20 2020  ault False...   
+0000ac00: 203a 6578 616d 706c 653a 0a20 2020 203e   :example:.    >
+0000ac10: 3e3e 205f 203d 206d 756c 7469 5f73 706c  >> _ = multi_spl
+0000ac20: 6974 5f76 6964 656f 2866 696c 655f 7061  it_video(file_pa
+0000ac30: 7468 3d27 7072 6f6a 6563 745f 666f 6c64  th='project_fold
+0000ac40: 6572 2f76 6964 656f 732f 5669 6465 6f5f  er/videos/Video_
+0000ac50: 312e 6d70 3427 2c20 7374 6172 745f 7469  1.mp4', start_ti
+0000ac60: 6d65 733d 5b27 3030 3a30 303a 3035 272c  mes=['00:00:05',
+0000ac70: 2027 3030 3a30 303a 3230 275d 2c20 656e   '00:00:20'], en
+0000ac80: 645f 7469 6d65 733d 5b27 3030 3a30 303a  d_times=['00:00:
+0000ac90: 3130 272c 2027 3030 3a30 303a 3235 275d  10', '00:00:25']
+0000aca0: 290a 2020 2020 2222 220a 0a20 2020 2063  ).    """..    c
+0000acb0: 6865 636b 5f66 666d 7065 675f 6176 6169  heck_ffmpeg_avai
+0000acc0: 6c61 626c 6528 7261 6973 655f 6572 726f  lable(raise_erro
+0000acd0: 723d 5472 7565 290a 2020 2020 7469 6d65  r=True).    time
+0000ace0: 7220 3d20 5369 6d62 6154 696d 6572 2873  r = SimbaTimer(s
+0000acf0: 7461 7274 3d54 7275 6529 0a20 2020 2063  tart=True).    c
+0000ad00: 6865 636b 5f66 696c 655f 6578 6973 745f  heck_file_exist_
+0000ad10: 616e 645f 7265 6164 6162 6c65 2866 696c  and_readable(fil
+0000ad20: 655f 7061 7468 3d66 696c 655f 7061 7468  e_path=file_path
+0000ad30: 290a 2020 2020 6469 725f 6e61 6d65 2c20  ).    dir_name, 
+0000ad40: 6669 6c65 5f6e 616d 652c 2065 7874 203d  file_name, ext =
+0000ad50: 2067 6574 5f66 6e5f 6578 7428 6669 6c65   get_fn_ext(file
+0000ad60: 7061 7468 3d66 696c 655f 7061 7468 290a  path=file_path).
+0000ad70: 2020 2020 6966 206f 7574 5f64 6972 2069      if out_dir i
+0000ad80: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+0000ad90: 2020 2020 6966 206e 6f74 206f 732e 7061      if not os.pa
+0000ada0: 7468 2e69 7364 6972 286f 7574 5f64 6972  th.isdir(out_dir
+0000adb0: 293a 0a20 2020 2020 2020 2020 2020 206f  ):.            o
+0000adc0: 732e 6d61 6b65 6469 7273 286f 7574 5f64  s.makedirs(out_d
+0000add0: 6972 290a 2020 2020 2020 2020 6469 725f  ir).        dir_
+0000ade0: 6e61 6d65 203d 206f 7574 5f64 6972 0a20  name = out_dir. 
+0000adf0: 2020 2066 6f72 2073 7461 7274 5f74 696d     for start_tim
+0000ae00: 655f 636e 742c 2073 7461 7274 5f74 696d  e_cnt, start_tim
+0000ae10: 6520 696e 2065 6e75 6d65 7261 7465 2873  e in enumerate(s
+0000ae20: 7461 7274 5f74 696d 6573 293a 0a20 2020  tart_times):.   
+0000ae30: 2020 2020 2063 6865 636b 5f69 665f 7374       check_if_st
+0000ae40: 7269 6e67 5f76 616c 7565 5f69 735f 7661  ring_value_is_va
+0000ae50: 6c69 645f 7669 6465 6f5f 7469 6d65 7374  lid_video_timest
+0000ae60: 616d 7028 0a20 2020 2020 2020 2020 2020  amp(.           
+0000ae70: 2076 616c 7565 3d73 7461 7274 5f74 696d   value=start_tim
+0000ae80: 652c 206e 616d 653d 6622 5374 6172 7420  e, name=f"Start 
+0000ae90: 7469 6d65 2066 6f72 2063 6c69 7020 7b73  time for clip {s
+0000aea0: 7461 7274 5f74 696d 655f 636e 742b 317d  tart_time_cnt+1}
+0000aeb0: 220a 2020 2020 2020 2020 290a 2020 2020  ".        ).    
+0000aec0: 666f 7220 656e 645f 7469 6d65 5f63 6e74  for end_time_cnt
+0000aed0: 2c20 656e 645f 7469 6d65 2069 6e20 656e  , end_time in en
+0000aee0: 756d 6572 6174 6528 656e 645f 7469 6d65  umerate(end_time
+0000aef0: 7329 3a0a 2020 2020 2020 2020 6368 6563  s):.        chec
+0000af00: 6b5f 6966 5f73 7472 696e 675f 7661 6c75  k_if_string_valu
+0000af10: 655f 6973 5f76 616c 6964 5f76 6964 656f  e_is_valid_video
+0000af20: 5f74 696d 6573 7461 6d70 280a 2020 2020  _timestamp(.    
+0000af30: 2020 2020 2020 2020 7661 6c75 653d 656e          value=en
+0000af40: 645f 7469 6d65 2c20 6e61 6d65 3d66 2245  d_time, name=f"E
+0000af50: 6e64 2074 696d 6520 666f 7220 636c 6970  nd time for clip
+0000af60: 207b 656e 645f 7469 6d65 5f63 6e74 2b31   {end_time_cnt+1
+0000af70: 7d22 0a20 2020 2020 2020 2029 0a20 2020  }".        ).   
+0000af80: 2066 6f72 2063 6c69 705f 636e 742c 2028   for clip_cnt, (
+0000af90: 7374 6172 745f 7469 6d65 2c20 656e 645f  start_time, end_
+0000afa0: 7469 6d65 2920 696e 2065 6e75 6d65 7261  time) in enumera
+0000afb0: 7465 287a 6970 2873 7461 7274 5f74 696d  te(zip(start_tim
+0000afc0: 6573 2c20 656e 645f 7469 6d65 7329 293a  es, end_times)):
+0000afd0: 0a20 2020 2020 2020 2063 6865 636b 5f74  .        check_t
+0000afe0: 6861 745f 6868 6d6d 7373 5f73 7461 7274  hat_hhmmss_start
+0000aff0: 5f69 735f 6265 666f 7265 5f65 6e64 280a  _is_before_end(.
+0000b000: 2020 2020 2020 2020 2020 2020 7374 6172              star
+0000b010: 745f 7469 6d65 3d73 7461 7274 5f74 696d  t_time=start_tim
+0000b020: 652c 2065 6e64 5f74 696d 653d 656e 645f  e, end_time=end_
+0000b030: 7469 6d65 2c20 6e61 6d65 3d66 2243 6c69  time, name=f"Cli
+0000b040: 7020 7b73 7472 2863 6c69 705f 636e 742b  p {str(clip_cnt+
+0000b050: 3129 7d22 0a20 2020 2020 2020 2029 0a20  1)}".        ). 
+0000b060: 2020 2020 2020 2063 6865 636b 5f69 665f         check_if_
+0000b070: 6868 6d6d 7373 5f74 696d 6573 7461 6d70  hhmmss_timestamp
+0000b080: 5f69 735f 7661 6c69 645f 7061 7274 5f6f  _is_valid_part_o
+0000b090: 665f 7669 6465 6f28 0a20 2020 2020 2020  f_video(.       
+0000b0a0: 2020 2020 2074 696d 6573 7461 6d70 3d73       timestamp=s
+0000b0b0: 7461 7274 5f74 696d 652c 2076 6964 656f  tart_time, video
+0000b0c0: 5f70 6174 683d 6669 6c65 5f70 6174 680a  _path=file_path.
+0000b0d0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000b0e0: 2020 6368 6563 6b5f 6966 5f68 686d 6d73    check_if_hhmms
+0000b0f0: 735f 7469 6d65 7374 616d 705f 6973 5f76  s_timestamp_is_v
+0000b100: 616c 6964 5f70 6172 745f 6f66 5f76 6964  alid_part_of_vid
+0000b110: 656f 280a 2020 2020 2020 2020 2020 2020  eo(.            
+0000b120: 7469 6d65 7374 616d 703d 656e 645f 7469  timestamp=end_ti
+0000b130: 6d65 2c20 7669 6465 6f5f 7061 7468 3d66  me, video_path=f
+0000b140: 696c 655f 7061 7468 0a20 2020 2020 2020  ile_path.       
+0000b150: 2029 0a20 2020 2020 2020 2069 6620 6e6f   ).        if no
+0000b160: 7420 696e 636c 7564 655f 636c 6970 5f74  t include_clip_t
+0000b170: 696d 655f 696e 5f66 696c 656e 616d 653a  ime_in_filename:
+0000b180: 0a20 2020 2020 2020 2020 2020 2073 6176  .            sav
+0000b190: 655f 7061 7468 203d 206f 732e 7061 7468  e_path = os.path
+0000b1a0: 2e6a 6f69 6e28 0a20 2020 2020 2020 2020  .join(.         
+0000b1b0: 2020 2020 2020 2064 6972 5f6e 616d 652c         dir_name,
+0000b1c0: 2066 696c 655f 6e61 6d65 202b 2022 5f7b   file_name + "_{
+0000b1d0: 7d22 2e66 6f72 6d61 7428 7374 7228 636c  }".format(str(cl
+0000b1e0: 6970 5f63 6e74 202b 2031 2929 202b 2022  ip_cnt + 1)) + "
+0000b1f0: 2e6d 7034 220a 2020 2020 2020 2020 2020  .mp4".          
+0000b200: 2020 290a 2020 2020 2020 2020 656c 7365    ).        else
+0000b210: 3a0a 2020 2020 2020 2020 2020 2020 7361  :.            sa
+0000b220: 7665 5f70 6174 6820 3d20 6f73 2e70 6174  ve_path = os.pat
+0000b230: 682e 6a6f 696e 280a 2020 2020 2020 2020  h.join(.        
+0000b240: 2020 2020 2020 2020 6469 725f 6e61 6d65          dir_name
+0000b250: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000b260: 2020 6669 6c65 5f6e 616d 650a 2020 2020    file_name.    
+0000b270: 2020 2020 2020 2020 2020 2020 2b20 6627              + f'
+0000b280: 5f7b 7374 6172 745f 7469 6d65 2e72 6570  _{start_time.rep
+0000b290: 6c61 6365 2822 3a22 2c20 222d 2229 7d5f  lace(":", "-")}_
+0000b2a0: 7b65 6e64 5f74 696d 652e 7265 706c 6163  {end_time.replac
+0000b2b0: 6528 223a 222c 2022 2d22 297d 2e6d 7034  e(":", "-")}.mp4
+0000b2c0: 272c 0a20 2020 2020 2020 2020 2020 2029  ',.            )
+0000b2d0: 0a20 2020 2020 2020 2069 6620 6f73 2e70  .        if os.p
+0000b2e0: 6174 682e 6973 6669 6c65 2873 6176 655f  ath.isfile(save_
+0000b2f0: 7061 7468 293a 0a20 2020 2020 2020 2020  path):.         
+0000b300: 2020 2072 6169 7365 2046 696c 6545 7869     raise FileExi
+0000b310: 7374 4572 726f 7228 0a20 2020 2020 2020  stError(.       
+0000b320: 2020 2020 2020 2020 206d 7367 3d66 2254           msg=f"T
+0000b330: 6865 206f 7574 6669 6c65 2066 696c 6520  he outfile file 
+0000b340: 616c 7265 6164 7920 6578 6973 743a 207b  already exist: {
+0000b350: 7361 7665 5f70 6174 687d 2e22 2c0a 2020  save_path}.",.  
+0000b360: 2020 2020 2020 2020 2020 2020 2020 736f                so
+0000b370: 7572 6365 3d6d 756c 7469 5f73 706c 6974  urce=multi_split
+0000b380: 5f76 6964 656f 2e5f 5f6e 616d 655f 5f2c  _video.__name__,
+0000b390: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0000b3a0: 2020 2020 2020 2069 6620 6770 753a 0a20         if gpu:. 
+0000b3b0: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+0000b3c0: 7420 6368 6563 6b5f 6e76 6964 6561 5f67  t check_nvidea_g
+0000b3d0: 7075 5f61 7661 696c 6162 6c65 2829 3a0a  pu_available():.
+0000b3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b3f0: 7261 6973 6520 4646 4d50 4547 436f 6465  raise FFMPEGCode
+0000b400: 6347 5055 4572 726f 7228 0a20 2020 2020  cGPUError(.     
+0000b410: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0000b420: 7367 3d22 4e56 4944 4541 2047 5055 206e  sg="NVIDEA GPU n
+0000b430: 6f74 2061 7661 696c 6162 6c65 2028 6173  ot available (as
+0000b440: 2065 7661 6c75 6174 6564 2062 7920 6e76   evaluated by nv
+0000b450: 6964 6561 2d73 6d69 2072 6574 7572 6e69  idea-smi returni
+0000b460: 6e67 204e 6f6e 6522 2c0a 2020 2020 2020  ng None",.      
+0000b470: 2020 2020 2020 2020 2020 2020 2020 736f                so
+0000b480: 7572 6365 3d6d 756c 7469 5f73 706c 6974  urce=multi_split
+0000b490: 5f76 6964 656f 2e5f 5f6e 616d 655f 5f2c  _video.__name__,
+0000b4a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b4b0: 2029 0a20 2020 2020 2020 2020 2020 2063   ).            c
+0000b4c0: 6f6d 6d61 6e64 203d 2027 6666 6d70 6567  ommand = 'ffmpeg
+0000b4d0: 202d 6877 6163 6365 6c20 6175 746f 202d   -hwaccel auto -
+0000b4e0: 6920 227b 7d22 202d 7373 207b 7d20 2d74  i "{}" -ss {} -t
+0000b4f0: 6f20 7b7d 202d 633a 7620 6832 3634 5f6e  o {} -c:v h264_n
+0000b500: 7665 6e63 202d 6173 796e 6320 3120 227b  venc -async 1 "{
+0000b510: 7d22 272e 666f 726d 6174 280a 2020 2020  }"'.format(.    
+0000b520: 2020 2020 2020 2020 2020 2020 6669 6c65              file
+0000b530: 5f70 6174 682c 2073 7461 7274 5f74 696d  _path, start_tim
+0000b540: 652c 2065 6e64 5f74 696d 652c 2073 6176  e, end_time, sav
+0000b550: 655f 7061 7468 0a20 2020 2020 2020 2020  e_path.         
+0000b560: 2020 2029 0a20 2020 2020 2020 2065 6c73     ).        els
+0000b570: 653a 0a20 2020 2020 2020 2020 2020 2063  e:.            c
+0000b580: 6f6d 6d61 6e64 203d 2066 2766 666d 7065  ommand = f'ffmpe
+0000b590: 6720 2d69 2022 7b66 696c 655f 7061 7468  g -i "{file_path
+0000b5a0: 7d22 202d 7373 207b 7374 6172 745f 7469  }" -ss {start_ti
+0000b5b0: 6d65 7d20 2d74 6f20 7b65 6e64 5f74 696d  me} -to {end_tim
+0000b5c0: 657d 202d 6173 796e 6320 3120 227b 7361  e} -async 1 "{sa
+0000b5d0: 7665 5f70 6174 687d 2227 0a20 2020 2020  ve_path}"'.     
+0000b5e0: 2020 2070 7269 6e74 2822 5072 6f63 6573     print("Proces
+0000b5f0: 7369 6e67 2076 6964 656f 2063 6c69 7020  sing video clip 
+0000b600: 7b7d 2e2e 2e22 2e66 6f72 6d61 7428 7374  {}...".format(st
+0000b610: 7228 636c 6970 5f63 6e74 202b 2031 2929  r(clip_cnt + 1))
+0000b620: 290a 2020 2020 2020 2020 7375 6270 726f  ).        subpro
+0000b630: 6365 7373 2e63 616c 6c28 636f 6d6d 616e  cess.call(comman
+0000b640: 642c 2073 6865 6c6c 3d54 7275 652c 2073  d, shell=True, s
+0000b650: 7464 6f75 743d 7375 6270 726f 6365 7373  tdout=subprocess
+0000b660: 2e50 4950 4529 0a20 2020 2074 696d 6572  .PIPE).    timer
+0000b670: 2e73 746f 705f 7469 6d65 7228 290a 2020  .stop_timer().  
+0000b680: 2020 7374 646f 7574 5f73 7563 6365 7373    stdout_success
+0000b690: 280a 2020 2020 2020 2020 6d73 673d 6622  (.        msg=f"
+0000b6a0: 5669 6465 6f20 7b66 696c 655f 6e61 6d65  Video {file_name
+0000b6b0: 7d20 636f 6e76 6572 7465 6420 696e 746f  } converted into
+0000b6c0: 207b 7374 7228 6c65 6e28 7374 6172 745f   {str(len(start_
+0000b6d0: 7469 6d65 7329 297d 2063 6c69 7073 2069  times))} clips i
+0000b6e0: 6e20 6469 7265 6374 6f72 7920 7b64 6972  n directory {dir
+0000b6f0: 5f6e 616d 657d 2122 2c0a 2020 2020 2020  _name}!",.      
+0000b700: 2020 656c 6170 7365 645f 7469 6d65 3d74    elapsed_time=t
+0000b710: 696d 6572 2e65 6c61 7073 6564 5f74 696d  imer.elapsed_tim
+0000b720: 655f 7374 722c 0a20 2020 2020 2020 2073  e_str,.        s
+0000b730: 6f75 7263 653d 6d75 6c74 695f 7370 6c69  ource=multi_spli
+0000b740: 745f 7669 6465 6f2e 5f5f 6e61 6d65 5f5f  t_video.__name__
+0000b750: 2c0a 2020 2020 290a 0a0a 2320 6d75 6c74  ,.    )...# mult
+0000b760: 695f 7370 6c69 745f 7669 6465 6f28 6669  i_split_video(fi
+0000b770: 6c65 5f70 6174 683d 7227 2f55 7365 7273  le_path=r'/Users
+0000b780: 2f73 696d 6f6e 2f44 6573 6b74 6f70 2f74  /simon/Desktop/t
+0000b790: 696d 655f 735f 636f 6e76 6572 7465 642e  ime_s_converted.
+0000b7a0: 6d70 3427 2c20 7374 6172 745f 7469 6d65  mp4', start_time
+0000b7b0: 733d 5b27 3030 3a30 303a 3031 272c 2027  s=['00:00:01', '
+0000b7c0: 3030 3a30 303a 3032 275d 2c20 656e 645f  00:00:02'], end_
+0000b7d0: 7469 6d65 733d 5b27 3030 3a30 303a 3034  times=['00:00:04
+0000b7e0: 272c 2027 3030 3a30 303a 3035 275d 2c20  ', '00:00:05'], 
+0000b7f0: 6770 753d 4661 6c73 6529 0a0a 0a64 6566  gpu=False)...def
+0000b800: 2063 726f 705f 7369 6e67 6c65 5f76 6964   crop_single_vid
+0000b810: 656f 280a 2020 2020 6669 6c65 5f70 6174  eo(.    file_pat
+0000b820: 683a 2055 6e69 6f6e 5b73 7472 2c20 6f73  h: Union[str, os
+0000b830: 2e50 6174 684c 696b 655d 2c20 6770 753a  .PathLike], gpu:
+0000b840: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
+0000b850: 3d20 4661 6c73 650a 2920 2d3e 204e 6f6e  = False.) -> Non
+0000b860: 653a 0a20 2020 2022 2222 0a20 2020 2043  e:.    """.    C
+0000b870: 726f 7020 6120 7369 6e67 6c65 2076 6964  rop a single vid
+0000b880: 656f 2075 7369 6e67 2060 6073 696d 6261  eo using ``simba
+0000b890: 2e76 6964 656f 5f70 726f 6365 7373 6f72  .video_processor
+0000b8a0: 732e 726f 695f 7365 6c65 6374 6f72 2e52  s.roi_selector.R
+0000b8b0: 4f49 5365 6c65 6374 6f72 6060 2069 6e74  OISelector`` int
+0000b8c0: 6572 6661 6365 2e20 5265 7375 6c74 7320  erface. Results 
+0000b8d0: 6973 2073 6176 6564 2069 6e20 7468 6520  is saved in the 
+0000b8e0: 7361 6d65 2064 6972 6563 746f 7279 2061  same directory a
+0000b8f0: 7320 696e 7075 7420 7669 6465 6f20 7769  s input video wi
+0000b900: 7468 2074 6865 0a20 2020 2060 605f 6372  th the.    ``_cr
+0000b910: 6f70 7065 642e 6d70 3460 6020 7375 6666  opped.mp4`` suff
+0000b920: 6978 602e 0a0a 2020 2020 3a70 6172 616d  ix`...    :param
+0000b930: 6574 6572 2073 7472 2066 696c 655f 7061  eter str file_pa
+0000b940: 7468 3a20 5061 7468 2074 6f20 7669 6465  th: Path to vide
+0000b950: 6f20 6669 6c65 2e0a 2020 2020 3a70 6172  o file..    :par
+0000b960: 616d 6574 6572 204f 7074 696f 6e61 6c5b  ameter Optional[
+0000b970: 626f 6f6c 5d20 6770 753a 2049 6620 5472  bool] gpu: If Tr
+0000b980: 7565 2c20 7573 6520 4e56 4944 4541 2047  ue, use NVIDEA G
+0000b990: 5055 2063 6f64 6563 732e 2044 6566 6175  PU codecs. Defau
+0000b9a0: 6c74 2046 616c 7365 2e0a 0a20 2020 203a  lt False...    :
+0000b9b0: 6578 616d 706c 653a 0a20 2020 203e 3e3e  example:.    >>>
+0000b9c0: 205f 203d 2063 726f 705f 7369 6e67 6c65   _ = crop_single
+0000b9d0: 5f76 6964 656f 2866 696c 655f 7061 7468  _video(file_path
+0000b9e0: 3d27 7072 6f6a 6563 745f 666f 6c64 6572  ='project_folder
+0000b9f0: 2f76 6964 656f 732f 5669 6465 6f5f 312e  /videos/Video_1.
+0000ba00: 6d70 3427 290a 2020 2020 2222 220a 0a20  mp4').    """.. 
+0000ba10: 2020 2063 6865 636b 5f66 666d 7065 675f     check_ffmpeg_
+0000ba20: 6176 6169 6c61 626c 6528 7261 6973 655f  available(raise_
+0000ba30: 6572 726f 723d 5472 7565 290a 2020 2020  error=True).    
+0000ba40: 6966 2067 7075 2061 6e64 206e 6f74 2063  if gpu and not c
+0000ba50: 6865 636b 5f6e 7669 6465 615f 6770 755f  heck_nvidea_gpu_
+0000ba60: 6176 6169 6c61 626c 6528 293a 0a20 2020  available():.   
+0000ba70: 2020 2020 2072 6169 7365 2046 464d 5045       raise FFMPE
+0000ba80: 4743 6f64 6563 4750 5545 7272 6f72 280a  GCodecGPUError(.
+0000ba90: 2020 2020 2020 2020 2020 2020 6d73 673d              msg=
+0000baa0: 224e 5649 4445 4120 4750 5520 6e6f 7420  "NVIDEA GPU not 
+0000bab0: 6176 6169 6c61 626c 6520 2861 7320 6576  available (as ev
+0000bac0: 616c 7561 7465 6420 6279 206e 7669 6465  aluated by nvide
+0000bad0: 612d 736d 6920 7265 7475 726e 696e 6720  a-smi returning 
+0000bae0: 4e6f 6e65 222c 0a20 2020 2020 2020 2020  None",.         
+0000baf0: 2020 2073 6f75 7263 653d 6372 6f70 5f73     source=crop_s
+0000bb00: 696e 676c 655f 7669 6465 6f2e 5f5f 6e61  ingle_video.__na
+0000bb10: 6d65 5f5f 2c0a 2020 2020 2020 2020 290a  me__,.        ).
+0000bb20: 2020 2020 6368 6563 6b5f 6669 6c65 5f65      check_file_e
+0000bb30: 7869 7374 5f61 6e64 5f72 6561 6461 626c  xist_and_readabl
+0000bb40: 6528 6669 6c65 5f70 6174 683d 6669 6c65  e(file_path=file
+0000bb50: 5f70 6174 6829 0a20 2020 205f 203d 2067  _path).    _ = g
+0000bb60: 6574 5f76 6964 656f 5f6d 6574 615f 6461  et_video_meta_da
+0000bb70: 7461 2876 6964 656f 5f70 6174 683d 6669  ta(video_path=fi
+0000bb80: 6c65 5f70 6174 6829 0a20 2020 2064 6972  le_path).    dir
+0000bb90: 5f6e 616d 652c 2066 696c 655f 6e61 6d65  _name, file_name
+0000bba0: 2c20 6578 7420 3d20 6765 745f 666e 5f65  , ext = get_fn_e
+0000bbb0: 7874 2866 696c 6570 6174 683d 6669 6c65  xt(filepath=file
+0000bbc0: 5f70 6174 6829 0a20 2020 2072 6f69 5f73  _path).    roi_s
+0000bbd0: 656c 6563 746f 7220 3d20 524f 4953 656c  elector = ROISel
+0000bbe0: 6563 746f 7228 7061 7468 3d66 696c 655f  ector(path=file_
+0000bbf0: 7061 7468 290a 2020 2020 726f 695f 7365  path).    roi_se
+0000bc00: 6c65 6374 6f72 2e72 756e 2829 0a20 2020  lector.run().   
+0000bc10: 2069 6620 280a 2020 2020 2020 2020 2872   if (.        (r
+0000bc20: 6f69 5f73 656c 6563 746f 722e 746f 705f  oi_selector.top_
+0000bc30: 6c65 6674 5b30 5d20 3c20 3029 0a20 2020  left[0] < 0).   
+0000bc40: 2020 2020 206f 7220 2872 6f69 5f73 656c       or (roi_sel
+0000bc50: 6563 746f 722e 746f 705f 6c65 6674 5b31  ector.top_left[1
+0000bc60: 5d20 3c20 3029 0a20 2020 2020 2020 206f  ] < 0).        o
+0000bc70: 7220 2872 6f69 5f73 656c 6563 746f 722e  r (roi_selector.
+0000bc80: 626f 7474 6f6d 5f72 6967 6874 5b30 5d20  bottom_right[0] 
+0000bc90: 3c20 3029 0a20 2020 2020 2020 206f 7220  < 0).        or 
+0000bca0: 2872 6f69 5f73 656c 6563 746f 722e 626f  (roi_selector.bo
+0000bcb0: 7474 6f6d 5f72 6967 6874 5b31 5d20 3c20  ttom_right[1] < 
+0000bcc0: 3129 0a20 2020 2029 3a0a 2020 2020 2020  1).    ):.      
+0000bcd0: 2020 7261 6973 6520 436f 756e 7445 7272    raise CountErr
+0000bce0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+0000bcf0: 6d73 673d 2243 524f 5020 4641 494c 4544  msg="CROP FAILED
+0000bd00: 3a20 4361 6e6e 6f74 2075 7365 206e 6567  : Cannot use neg
+0000bd10: 6174 6976 6520 6372 6f70 2063 6f6f 7264  ative crop coord
+0000bd20: 696e 6174 6573 2e22 2c0a 2020 2020 2020  inates.",.      
+0000bd30: 2020 2020 2020 736f 7572 6365 3d63 726f        source=cro
+0000bd40: 705f 6d75 6c74 6970 6c65 5f76 6964 656f  p_multiple_video
+0000bd50: 732e 5f5f 6e61 6d65 5f5f 2c0a 2020 2020  s.__name__,.    
+0000bd60: 2020 2020 290a 2020 2020 7361 7665 5f70      ).    save_p
+0000bd70: 6174 6820 3d20 6f73 2e70 6174 682e 6a6f  ath = os.path.jo
+0000bd80: 696e 2864 6972 5f6e 616d 652c 2066 227b  in(dir_name, f"{
+0000bd90: 6669 6c65 5f6e 616d 657d 5f63 726f 7070  file_name}_cropp
+0000bda0: 6564 2e6d 7034 2229 0a20 2020 2069 6620  ed.mp4").    if 
+0000bdb0: 6f73 2e70 6174 682e 6973 6669 6c65 2873  os.path.isfile(s
+0000bdc0: 6176 655f 7061 7468 293a 0a20 2020 2020  ave_path):.     
+0000bdd0: 2020 2072 6169 7365 2046 696c 6545 7869     raise FileExi
+0000bde0: 7374 4572 726f 7228 0a20 2020 2020 2020  stError(.       
+0000bdf0: 2020 2020 206d 7367 3d66 2253 494d 4241       msg=f"SIMBA
+0000be00: 2045 5252 4f52 3a20 5468 6520 6f75 7420   ERROR: The out 
+0000be10: 6669 6c65 2020 616c 7265 6164 7920 6578  file  already ex
+0000be20: 6973 743a 207b 7361 7665 5f70 6174 687d  ist: {save_path}
+0000be30: 2e22 2c0a 2020 2020 2020 2020 2020 2020  .",.            
+0000be40: 736f 7572 6365 3d63 726f 705f 7369 6e67  source=crop_sing
+0000be50: 6c65 5f76 6964 656f 2e5f 5f6e 616d 655f  le_video.__name_
+0000be60: 5f2c 0a20 2020 2020 2020 2029 0a20 2020  _,.        ).   
+0000be70: 2074 696d 6572 203d 2053 696d 6261 5469   timer = SimbaTi
+0000be80: 6d65 7228 7374 6172 743d 5472 7565 290a  mer(start=True).
+0000be90: 2020 2020 6966 2067 7075 3a0a 2020 2020      if gpu:.    
+0000bea0: 2020 2020 636f 6d6d 616e 6420 3d20 6627      command = f'
+0000beb0: 6666 6d70 6567 202d 6877 6163 6365 6c20  ffmpeg -hwaccel 
+0000bec0: 6175 746f 202d 633a 7620 6832 3634 5f63  auto -c:v h264_c
+0000bed0: 7576 6964 202d 6920 227b 6669 6c65 5f70  uvid -i "{file_p
+0000bee0: 6174 687d 2220 2d76 6620 2263 726f 703d  ath}" -vf "crop=
+0000bef0: 7b72 6f69 5f73 656c 6563 746f 722e 7769  {roi_selector.wi
+0000bf00: 6474 687d 3a7b 726f 695f 7365 6c65 6374  dth}:{roi_select
+0000bf10: 6f72 2e68 6569 6768 747d 3a7b 726f 695f  or.height}:{roi_
+0000bf20: 7365 6c65 6374 6f72 2e74 6f70 5f6c 6566  selector.top_lef
+0000bf30: 745b 305d 7d3a 7b72 6f69 5f73 656c 6563  t[0]}:{roi_selec
+0000bf40: 746f 722e 746f 705f 6c65 6674 5b31 5d7d  tor.top_left[1]}
+0000bf50: 2220 2d63 3a76 2068 3236 345f 6e76 656e  " -c:v h264_nven
+0000bf60: 6320 2d63 3a61 2063 6f70 7920 227b 7361  c -c:a copy "{sa
+0000bf70: 7665 5f70 6174 687d 2227 0a20 2020 2065  ve_path}"'.    e
+0000bf80: 6c73 653a 0a20 2020 2020 2020 2063 6f6d  lse:.        com
+0000bf90: 6d61 6e64 203d 2066 2766 666d 7065 6720  mand = f'ffmpeg 
+0000bfa0: 2d79 202d 6920 227b 6669 6c65 5f70 6174  -y -i "{file_pat
+0000bfb0: 687d 2220 2d76 6620 2263 726f 703d 7b72  h}" -vf "crop={r
+0000bfc0: 6f69 5f73 656c 6563 746f 722e 7769 6474  oi_selector.widt
+0000bfd0: 687d 3a7b 726f 695f 7365 6c65 6374 6f72  h}:{roi_selector
+0000bfe0: 2e68 6569 6768 747d 3a7b 726f 695f 7365  .height}:{roi_se
+0000bff0: 6c65 6374 6f72 2e74 6f70 5f6c 6566 745b  lector.top_left[
+0000c000: 305d 7d3a 7b72 6f69 5f73 656c 6563 746f  0]}:{roi_selecto
+0000c010: 722e 746f 705f 6c65 6674 5b31 5d7d 2220  r.top_left[1]}" 
+0000c020: 2d63 3a76 206c 6962 7832 3634 202d 6372  -c:v libx264 -cr
+0000c030: 6620 3137 202d 633a 6120 636f 7079 2022  f 17 -c:a copy "
+0000c040: 7b73 6176 655f 7061 7468 7d22 270a 2020  {save_path}"'.  
+0000c050: 2020 7375 6270 726f 6365 7373 2e63 616c    subprocess.cal
+0000c060: 6c28 636f 6d6d 616e 642c 2073 6865 6c6c  l(command, shell
+0000c070: 3d54 7275 6529 0a20 2020 2074 696d 6572  =True).    timer
+0000c080: 2e73 746f 705f 7469 6d65 7228 290a 2020  .stop_timer().  
+0000c090: 2020 7374 646f 7574 5f73 7563 6365 7373    stdout_success
+0000c0a0: 280a 2020 2020 2020 2020 6622 5669 6465  (.        f"Vide
+0000c0b0: 6f20 7b66 696c 655f 6e61 6d65 7d20 6372  o {file_name} cr
+0000c0c0: 6f70 7065 6420 616e 6420 7361 7665 6420  opped and saved 
+0000c0d0: 6174 207b 7361 7665 5f70 6174 687d 222c  at {save_path}",
+0000c0e0: 0a20 2020 2020 2020 2065 6c61 7073 6564  .        elapsed
+0000c0f0: 5f74 696d 653d 7469 6d65 722e 656c 6170  _time=timer.elap
+0000c100: 7365 645f 7469 6d65 5f73 7472 2c0a 2020  sed_time_str,.  
+0000c110: 2020 2020 2020 736f 7572 6365 3d63 726f        source=cro
+0000c120: 705f 7369 6e67 6c65 5f76 6964 656f 2e5f  p_single_video._
+0000c130: 5f6e 616d 655f 5f2c 0a20 2020 2029 0a0a  _name__,.    )..
+0000c140: 0a23 205f 203d 2063 726f 705f 7369 6e67  .# _ = crop_sing
+0000c150: 6c65 5f76 6964 656f 2866 696c 655f 7061  le_video(file_pa
+0000c160: 7468 3d27 2f55 7365 7273 2f73 696d 6f6e  th='/Users/simon
+0000c170: 2f44 6573 6b74 6f70 2f65 6e76 732f 7472  /Desktop/envs/tr
+0000c180: 6f75 626c 6573 686f 6f74 696e 672f 4152  oubleshooting/AR
+0000c190: 4553 5f64 6174 612f 5465 726d 6974 6520  ES_data/Termite 
+0000c1a0: 5465 7374 2031 2f54 6572 6d69 7465 2054  Test 1/Termite T
+0000c1b0: 6573 7420 312e 6d70 3427 290a 0a23 2063  est 1.mp4')..# c
+0000c1c0: 726f 705f 7369 6e67 6c65 5f76 6964 656f  rop_single_video
+0000c1d0: 2866 696c 655f 7061 7468 3d72 2743 3a5c  (file_path=r'C:\
+0000c1e0: 5573 6572 735c 4e61 7065 5f43 6f6d 7075  Users\Nape_Compu
+0000c1f0: 7465 725f 325c 4465 736b 746f 705c 7465  ter_2\Desktop\te
+0000c200: 7374 5f76 6964 656f 735c 426f 7831 5f50  st_videos\Box1_P
+0000c210: 4d32 5f64 6179 5f35 5f32 3032 3131 3130  M2_day_5_2021110
+0000c220: 3454 3137 3130 3231 2e6d 7034 272c 2067  4T171021.mp4', g
+0000c230: 7075 3d46 616c 7365 290a 0a0a 6465 6620  pu=False)...def 
+0000c240: 6372 6f70 5f6d 756c 7469 706c 655f 7669  crop_multiple_vi
+0000c250: 6465 6f73 280a 2020 2020 6469 7265 6374  deos(.    direct
+0000c260: 6f72 795f 7061 7468 3a20 556e 696f 6e5b  ory_path: Union[
+0000c270: 7374 722c 206f 732e 5061 7468 4c69 6b65  str, os.PathLike
+0000c280: 5d2c 0a20 2020 206f 7574 7075 745f 7061  ],.    output_pa
+0000c290: 7468 3a20 556e 696f 6e5b 7374 722c 206f  th: Union[str, o
+0000c2a0: 732e 5061 7468 4c69 6b65 5d2c 0a20 2020  s.PathLike],.   
+0000c2b0: 2067 7075 3a20 4f70 7469 6f6e 616c 5b62   gpu: Optional[b
+0000c2c0: 6f6f 6c5d 203d 2046 616c 7365 2c0a 2920  ool] = False,.) 
+0000c2d0: 2d3e 204e 6f6e 653a 0a20 2020 2022 2222  -> None:.    """
+0000c2e0: 0a20 2020 2043 726f 7020 6d75 6c74 6970  .    Crop multip
+0000c2f0: 6c65 2076 6964 656f 7320 696e 2061 2066  le videos in a f
+0000c300: 6f6c 6465 7220 6163 636f 7264 696e 6720  older according 
+0000c310: 746f 2063 726f 702d 636f 6f72 6469 6e61  to crop-coordina
+0000c320: 7465 7320 6465 6669 6e65 6420 696e 2074  tes defined in t
+0000c330: 6865 202a 2a66 6972 7374 2a2a 2076 6964  he **first** vid
+0000c340: 656f 2e0a 0a20 2020 203a 7061 7261 6d65  eo...    :parame
+0000c350: 7465 7220 7374 7220 6469 7265 6374 6f72  ter str director
+0000c360: 795f 7061 7468 3a20 4469 7265 6374 6f72  y_path: Director
+0000c370: 7920 636f 6e74 6169 6e69 6e67 2069 6e70  y containing inp
+0000c380: 7574 2076 6964 656f 732e 0a20 2020 203a  ut videos..    :
+0000c390: 7061 7261 6d65 7465 7220 7374 7220 6f75  parameter str ou
+0000c3a0: 7470 7574 5f70 6174 683a 2044 6972 6563  tput_path: Direc
+0000c3b0: 746f 7279 2077 6865 7265 2074 6f20 7361  tory where to sa
+0000c3c0: 7665 2074 6865 2063 726f 7070 6564 2076  ve the cropped v
+0000c3d0: 6964 656f 732e 0a20 2020 203a 7061 7261  ideos..    :para
+0000c3e0: 6d65 7465 7220 4f70 7469 6f6e 616c 5b62  meter Optional[b
+0000c3f0: 6f6f 6c5d 2067 7075 3a20 4966 2054 7275  ool] gpu: If Tru
+0000c400: 652c 2075 7365 204e 5649 4445 4120 4750  e, use NVIDEA GP
+0000c410: 5520 636f 6465 6373 2e20 4465 6661 756c  U codecs. Defaul
+0000c420: 7420 4661 6c73 652e 0a0a 2020 2020 3a65  t False...    :e
+0000c430: 7861 6d70 6c65 3a0a 2020 2020 3e3e 3e20  xample:.    >>> 
+0000c440: 5f20 3d20 6372 6f70 5f6d 756c 7469 706c  _ = crop_multipl
+0000c450: 655f 7669 6465 6f73 2864 6972 6563 746f  e_videos(directo
+0000c460: 7279 5f70 6174 683d 2770 726f 6a65 6374  ry_path='project
+0000c470: 5f66 6f6c 6465 722f 7669 6465 6f73 272c  _folder/videos',
+0000c480: 206f 7574 7075 745f 7061 7468 3d27 7072   output_path='pr
+0000c490: 6f6a 6563 745f 666f 6c64 6572 2f76 6964  oject_folder/vid
+0000c4a0: 656f 732f 6d79 5f6e 6577 5f66 6f6c 6465  eos/my_new_folde
+0000c4b0: 7227 290a 2020 2020 2222 220a 0a20 2020  r').    """..   
+0000c4c0: 2063 6865 636b 5f66 666d 7065 675f 6176   check_ffmpeg_av
+0000c4d0: 6169 6c61 626c 6528 7261 6973 655f 6572  ailable(raise_er
+0000c4e0: 726f 723d 5472 7565 290a 2020 2020 6966  ror=True).    if
+0000c4f0: 2067 7075 2061 6e64 206e 6f74 2063 6865   gpu and not che
+0000c500: 636b 5f6e 7669 6465 615f 6770 755f 6176  ck_nvidea_gpu_av
+0000c510: 6169 6c61 626c 6528 293a 0a20 2020 2020  ailable():.     
+0000c520: 2020 2072 6169 7365 2046 464d 5045 4743     raise FFMPEGC
+0000c530: 6f64 6563 4750 5545 7272 6f72 280a 2020  odecGPUError(.  
+0000c540: 2020 2020 2020 2020 2020 6d73 673d 224e            msg="N
+0000c550: 5649 4445 4120 4750 5520 6e6f 7420 6176  VIDEA GPU not av
+0000c560: 6169 6c61 626c 6520 2861 7320 6576 616c  ailable (as eval
+0000c570: 7561 7465 6420 6279 206e 7669 6465 612d  uated by nvidea-
+0000c580: 736d 6920 7265 7475 726e 696e 6720 4e6f  smi returning No
+0000c590: 6e65 222c 0a20 2020 2020 2020 2020 2020  ne",.           
+0000c5a0: 2073 6f75 7263 653d 6372 6f70 5f6d 756c   source=crop_mul
+0000c5b0: 7469 706c 655f 7669 6465 6f73 2e5f 5f6e  tiple_videos.__n
+0000c5c0: 616d 655f 5f2c 0a20 2020 2020 2020 2029  ame__,.        )
+0000c5d0: 0a20 2020 2069 6620 6e6f 7420 6f73 2e70  .    if not os.p
+0000c5e0: 6174 682e 6973 6469 7228 6469 7265 6374  ath.isdir(direct
+0000c5f0: 6f72 795f 7061 7468 293a 0a20 2020 2020  ory_path):.     
+0000c600: 2020 2072 6169 7365 204e 6f74 4469 7265     raise NotDire
+0000c610: 6374 6f72 7945 7272 6f72 280a 2020 2020  ctoryError(.    
+0000c620: 2020 2020 2020 2020 6d73 673d 2253 494d          msg="SIM
+0000c630: 4241 2045 5252 4f52 3a20 7b7d 2069 7320  BA ERROR: {} is 
+0000c640: 6e6f 7420 6120 7661 6c69 6420 6469 7265  not a valid dire
+0000c650: 6374 6f72 7922 2e66 6f72 6d61 7428 6469  ctory".format(di
+0000c660: 7265 6374 6f72 795f 7061 7468 292c 0a20  rectory_path),. 
+0000c670: 2020 2020 2020 2020 2020 2073 6f75 7263             sourc
+0000c680: 653d 6372 6f70 5f6d 756c 7469 706c 655f  e=crop_multiple_
+0000c690: 7669 6465 6f73 2e5f 5f6e 616d 655f 5f2c  videos.__name__,
+0000c6a0: 0a20 2020 2020 2020 2029 0a20 2020 2076  .        ).    v
+0000c6b0: 6964 656f 5f70 6174 6873 203d 205b 5d0a  ideo_paths = [].
+0000c6c0: 2020 2020 6669 6c65 5f70 6174 6873 5f69      file_paths_i
+0000c6d0: 6e5f 666f 6c64 6572 203d 205b 0a20 2020  n_folder = [.   
+0000c6e0: 2020 2020 2066 2066 6f72 2066 2069 6e20       f for f in 
+0000c6f0: 676c 6f62 2e67 6c6f 6228 6469 7265 6374  glob.glob(direct
+0000c700: 6f72 795f 7061 7468 202b 2022 2f2a 2229  ory_path + "/*")
+0000c710: 2069 6620 6f73 2e70 6174 682e 6973 6669   if os.path.isfi
+0000c720: 6c65 2866 290a 2020 2020 5d0a 2020 2020  le(f).    ].    
+0000c730: 666f 7220 6669 6c65 5f70 6174 6820 696e  for file_path in
+0000c740: 2066 696c 655f 7061 7468 735f 696e 5f66   file_paths_in_f
+0000c750: 6f6c 6465 723a 0a20 2020 2020 2020 205f  older:.        _
+0000c760: 2c20 5f2c 2065 7874 203d 2067 6574 5f66  , _, ext = get_f
+0000c770: 6e5f 6578 7428 6669 6c65 7061 7468 3d66  n_ext(filepath=f
+0000c780: 696c 655f 7061 7468 290a 2020 2020 2020  ile_path).      
+0000c790: 2020 6966 2065 7874 2e6c 6f77 6572 2829    if ext.lower()
+0000c7a0: 2069 6e20 4f70 7469 6f6e 732e 414c 4c5f   in Options.ALL_
+0000c7b0: 5649 4445 4f5f 464f 524d 4154 5f4f 5054  VIDEO_FORMAT_OPT
+0000c7c0: 494f 4e53 2e76 616c 7565 3a0a 2020 2020  IONS.value:.    
+0000c7d0: 2020 2020 2020 2020 7669 6465 6f5f 7061          video_pa
+0000c7e0: 7468 732e 6170 7065 6e64 2866 696c 655f  ths.append(file_
+0000c7f0: 7061 7468 290a 2020 2020 6966 206c 656e  path).    if len
+0000c800: 2876 6964 656f 5f70 6174 6873 2920 3c20  (video_paths) < 
+0000c810: 313a 0a20 2020 2020 2020 2072 6169 7365  1:.        raise
+0000c820: 204e 6f46 696c 6573 466f 756e 6445 7272   NoFilesFoundErr
+0000c830: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+0000c840: 6d73 673d 2253 494d 4241 2045 5252 4f52  msg="SIMBA ERROR
+0000c850: 3a20 4e6f 2066 696c 6573 2077 6974 6820  : No files with 
+0000c860: 2e6d 7034 2c20 2e61 7669 2c20 2e6d 6f76  .mp4, .avi, .mov
+0000c870: 2c20 2e66 6c76 2066 696c 6520 656e 6469  , .flv file endi
+0000c880: 6e67 2066 6f75 6e64 2069 6e20 7468 6520  ng found in the 
+0000c890: 7b7d 2064 6972 6563 746f 7279 222e 666f  {} directory".fo
+0000c8a0: 726d 6174 280a 2020 2020 2020 2020 2020  rmat(.          
+0000c8b0: 2020 2020 2020 6469 7265 6374 6f72 795f        directory_
+0000c8c0: 7061 7468 0a20 2020 2020 2020 2020 2020  path.           
+0000c8d0: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
+0000c8e0: 736f 7572 6365 3d63 726f 705f 6d75 6c74  source=crop_mult
+0000c8f0: 6970 6c65 5f76 6964 656f 732e 5f5f 6e61  iple_videos.__na
+0000c900: 6d65 5f5f 2c0a 2020 2020 2020 2020 290a  me__,.        ).
+0000c910: 2020 2020 726f 695f 7365 6c65 6374 6f72      roi_selector
+0000c920: 203d 2052 4f49 5365 6c65 6374 6f72 2870   = ROISelector(p
+0000c930: 6174 683d 6669 6c65 5f70 6174 6873 5f69  ath=file_paths_i
+0000c940: 6e5f 666f 6c64 6572 5b30 5d29 0a20 2020  n_folder[0]).   
+0000c950: 2072 6f69 5f73 656c 6563 746f 722e 7275   roi_selector.ru
+0000c960: 6e28 290a 2020 2020 6966 2028 726f 695f  n().    if (roi_
+0000c970: 7365 6c65 6374 6f72 2e77 6964 7468 203d  selector.width =
+0000c980: 3d20 3020 616e 6420 726f 695f 7365 6c65  = 0 and roi_sele
+0000c990: 6374 6f72 2e68 6569 6768 7420 3d3d 2030  ctor.height == 0
+0000c9a0: 2920 6f72 2028 0a20 2020 2020 2020 2072  ) or (.        r
+0000c9b0: 6f69 5f73 656c 6563 746f 722e 7769 6474  oi_selector.widt
+0000c9c0: 680a 2020 2020 2020 2020 2b20 726f 695f  h.        + roi_
+0000c9d0: 7365 6c65 6374 6f72 2e68 6569 6768 740a  selector.height.
+0000c9e0: 2020 2020 2020 2020 2b20 726f 695f 7365          + roi_se
+0000c9f0: 6c65 6374 6f72 2e74 6f70 5f6c 6566 745b  lector.top_left[
+0000ca00: 305d 0a20 2020 2020 2020 202b 2072 6f69  0].        + roi
+0000ca10: 5f73 656c 6563 746f 722e 746f 705f 6c65  _selector.top_le
+0000ca20: 6674 5b31 5d0a 2020 2020 2020 2020 3d3d  ft[1].        ==
+0000ca30: 2030 0a20 2020 2029 3a0a 2020 2020 2020   0.    ):.      
+0000ca40: 2020 7261 6973 6520 436f 756e 7445 7272    raise CountErr
+0000ca50: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+0000ca60: 6d73 673d 2243 524f 5020 4641 494c 4544  msg="CROP FAILED
+0000ca70: 3a20 4372 6f70 7069 6e67 2068 6569 6768  : Cropping heigh
+0000ca80: 7420 616e 6420 7769 6474 6820 6172 6520  t and width are 
+0000ca90: 626f 7468 2030 2e20 506c 6561 7365 2074  both 0. Please t
+0000caa0: 7279 2061 6761 696e 2e22 2c0a 2020 2020  ry again.",.    
+0000cab0: 2020 2020 2020 2020 736f 7572 6365 3d63          source=c
+0000cac0: 726f 705f 6d75 6c74 6970 6c65 5f76 6964  rop_multiple_vid
+0000cad0: 656f 732e 5f5f 6e61 6d65 5f5f 2c0a 2020  eos.__name__,.  
+0000cae0: 2020 2020 2020 290a 2020 2020 6966 2028        ).    if (
+0000caf0: 0a20 2020 2020 2020 2028 726f 695f 7365  .        (roi_se
+0000cb00: 6c65 6374 6f72 2e74 6f70 5f6c 6566 745b  lector.top_left[
+0000cb10: 305d 203c 2030 290a 2020 2020 2020 2020  0] < 0).        
+0000cb20: 6f72 2028 726f 695f 7365 6c65 6374 6f72  or (roi_selector
+0000cb30: 2e74 6f70 5f6c 6566 745b 315d 203c 2030  .top_left[1] < 0
+0000cb40: 290a 2020 2020 2020 2020 6f72 2028 726f  ).        or (ro
+0000cb50: 695f 7365 6c65 6374 6f72 2e62 6f74 746f  i_selector.botto
+0000cb60: 6d5f 7269 6768 745b 305d 203c 2030 290a  m_right[0] < 0).
+0000cb70: 2020 2020 2020 2020 6f72 2028 726f 695f          or (roi_
+0000cb80: 7365 6c65 6374 6f72 2e62 6f74 746f 6d5f  selector.bottom_
+0000cb90: 7269 6768 745b 315d 203c 2031 290a 2020  right[1] < 1).  
+0000cba0: 2020 293a 0a20 2020 2020 2020 2072 6169    ):.        rai
+0000cbb0: 7365 2043 6f75 6e74 4572 726f 7228 0a20  se CountError(. 
+0000cbc0: 2020 2020 2020 2020 2020 206d 7367 3d22             msg="
+0000cbd0: 4352 4f50 2046 4149 4c45 443a 2043 616e  CROP FAILED: Can
+0000cbe0: 6e6f 7420 7573 6520 6e65 6761 7469 7665  not use negative
+0000cbf0: 2063 726f 7020 636f 6f72 6469 6e61 7465   crop coordinate
+0000cc00: 732e 222c 0a20 2020 2020 2020 2020 2020  s.",.           
+0000cc10: 2073 6f75 7263 653d 6372 6f70 5f6d 756c   source=crop_mul
+0000cc20: 7469 706c 655f 7669 6465 6f73 2e5f 5f6e  tiple_videos.__n
+0000cc30: 616d 655f 5f2c 0a20 2020 2020 2020 2029  ame__,.        )
+0000cc40: 0a20 2020 2074 696d 6572 203d 2053 696d  .    timer = Sim
+0000cc50: 6261 5469 6d65 7228 7374 6172 743d 5472  baTimer(start=Tr
+0000cc60: 7565 290a 2020 2020 666f 7220 6669 6c65  ue).    for file
+0000cc70: 5f63 6e74 2c20 6669 6c65 5f70 6174 6820  _cnt, file_path 
+0000cc80: 696e 2065 6e75 6d65 7261 7465 2876 6964  in enumerate(vid
+0000cc90: 656f 5f70 6174 6873 293a 0a20 2020 2020  eo_paths):.     
+0000cca0: 2020 2076 6964 656f 5f74 696d 6572 203d     video_timer =
+0000ccb0: 2053 696d 6261 5469 6d65 7228 7374 6172   SimbaTimer(star
+0000ccc0: 743d 5472 7565 290a 2020 2020 2020 2020  t=True).        
+0000ccd0: 6469 725f 6e61 6d65 2c20 6669 6c65 5f6e  dir_name, file_n
+0000cce0: 616d 652c 2065 7874 203d 2067 6574 5f66  ame, ext = get_f
+0000ccf0: 6e5f 6578 7428 6669 6c65 7061 7468 3d66  n_ext(filepath=f
+0000cd00: 696c 655f 7061 7468 290a 2020 2020 2020  ile_path).      
+0000cd10: 2020 7072 696e 7428 6622 4372 6f70 7069    print(f"Croppi
+0000cd20: 6e67 2076 6964 656f 207b 6669 6c65 5f6e  ng video {file_n
+0000cd30: 616d 657d 2e2e 2e22 290a 2020 2020 2020  ame}...").      
+0000cd40: 2020 7669 6465 6f5f 6d65 7461 5f64 6174    video_meta_dat
+0000cd50: 6120 3d20 6765 745f 7669 6465 6f5f 6d65  a = get_video_me
+0000cd60: 7461 5f64 6174 6128 6669 6c65 5f70 6174  ta_data(file_pat
+0000cd70: 6829 0a20 2020 2020 2020 2069 6620 2872  h).        if (r
+0000cd80: 6f69 5f73 656c 6563 746f 722e 626f 7474  oi_selector.bott
+0000cd90: 6f6d 5f72 6967 6874 5b30 5d20 3e20 7669  om_right[0] > vi
+0000cda0: 6465 6f5f 6d65 7461 5f64 6174 615b 2277  deo_meta_data["w
+0000cdb0: 6964 7468 225d 2920 6f72 2028 0a20 2020  idth"]) or (.   
+0000cdc0: 2020 2020 2020 2020 2072 6f69 5f73 656c           roi_sel
+0000cdd0: 6563 746f 722e 626f 7474 6f6d 5f72 6967  ector.bottom_rig
+0000cde0: 6874 5b31 5d20 3e20 7669 6465 6f5f 6d65  ht[1] > video_me
+0000cdf0: 7461 5f64 6174 615b 2268 6569 6768 7422  ta_data["height"
+0000ce00: 5d0a 2020 2020 2020 2020 293a 0a20 2020  ].        ):.   
+0000ce10: 2020 2020 2020 2020 2072 6169 7365 2049           raise I
+0000ce20: 6e76 616c 6964 496e 7075 7445 7272 6f72  nvalidInputError
+0000ce30: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000ce40: 2020 6d73 673d 6627 4361 6e6e 6f74 2063    msg=f'Cannot c
+0000ce50: 726f 7020 7669 6465 6f20 7b66 696c 655f  rop video {file_
+0000ce60: 6e61 6d65 7d20 6f66 2073 697a 6520 7b76  name} of size {v
+0000ce70: 6964 656f 5f6d 6574 615f 6461 7461 5b22  ideo_meta_data["
+0000ce80: 7265 736f 6c75 7469 6f6e 5f73 7472 225d  resolution_str"]
+0000ce90: 7d20 6174 206c 6f63 6174 696f 6e20 746f  } at location to
+0000cea0: 7020 6c65 6674 3a20 7b72 6f69 5f73 656c  p left: {roi_sel
+0000ceb0: 6563 746f 722e 746f 705f 6c65 6674 7d2c  ector.top_left},
+0000cec0: 2062 6f74 746f 6d20 7269 6768 743a 207b   bottom right: {
+0000ced0: 726f 695f 7365 6c65 6374 6f72 2e62 6f74  roi_selector.bot
+0000cee0: 746f 6d5f 7269 6768 747d 272c 0a20 2020  tom_right}',.   
+0000cef0: 2020 2020 2020 2020 2020 2020 2073 6f75               sou
+0000cf00: 7263 653d 6372 6f70 5f6d 756c 7469 706c  rce=crop_multipl
+0000cf10: 655f 7669 6465 6f73 2e5f 5f6e 616d 655f  e_videos.__name_
+0000cf20: 5f2c 0a20 2020 2020 2020 2020 2020 2029  _,.            )
+0000cf30: 0a20 2020 2020 2020 2073 6176 655f 7061  .        save_pa
+0000cf40: 7468 203d 206f 732e 7061 7468 2e6a 6f69  th = os.path.joi
+0000cf50: 6e28 6f75 7470 7574 5f70 6174 682c 2066  n(output_path, f
+0000cf60: 696c 655f 6e61 6d65 202b 2022 5f63 726f  ile_name + "_cro
+0000cf70: 7070 6564 2e6d 7034 2229 0a20 2020 2020  pped.mp4").     
+0000cf80: 2020 2069 6620 6770 753a 0a20 2020 2020     if gpu:.     
+0000cf90: 2020 2020 2020 2063 6f6d 6d61 6e64 203d         command =
+0000cfa0: 2066 2766 666d 7065 6720 2d68 7761 6363   f'ffmpeg -hwacc
+0000cfb0: 656c 2061 7574 6f20 2d63 3a76 2068 3236  el auto -c:v h26
+0000cfc0: 345f 6375 7669 6420 2d69 2022 7b66 696c  4_cuvid -i "{fil
+0000cfd0: 655f 7061 7468 7d22 202d 7666 2022 6372  e_path}" -vf "cr
+0000cfe0: 6f70 3d7b 726f 695f 7365 6c65 6374 6f72  op={roi_selector
+0000cff0: 2e77 6964 7468 7d3a 7b72 6f69 5f73 656c  .width}:{roi_sel
+0000d000: 6563 746f 722e 6865 6967 6874 7d3a 7b72  ector.height}:{r
+0000d010: 6f69 5f73 656c 6563 746f 722e 746f 705f  oi_selector.top_
+0000d020: 6c65 6674 5b30 5d7d 3a7b 726f 695f 7365  left[0]}:{roi_se
+0000d030: 6c65 6374 6f72 2e74 6f70 5f6c 6566 745b  lector.top_left[
+0000d040: 315d 7d22 202d 633a 7620 6832 3634 5f6e  1]}" -c:v h264_n
+0000d050: 7665 6e63 202d 633a 6120 636f 7079 2022  venc -c:a copy "
+0000d060: 7b73 6176 655f 7061 7468 7d22 202d 7927  {save_path}" -y'
+0000d070: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0000d080: 2020 2020 2020 2020 2020 2063 6f6d 6d61             comma
+0000d090: 6e64 203d 2066 2766 666d 7065 6720 2d69  nd = f'ffmpeg -i
+0000d0a0: 2022 7b66 696c 655f 7061 7468 7d22 202d   "{file_path}" -
+0000d0b0: 7666 2022 6372 6f70 3d7b 726f 695f 7365  vf "crop={roi_se
+0000d0c0: 6c65 6374 6f72 2e77 6964 7468 7d3a 7b72  lector.width}:{r
+0000d0d0: 6f69 5f73 656c 6563 746f 722e 6865 6967  oi_selector.heig
+0000d0e0: 6874 7d3a 7b72 6f69 5f73 656c 6563 746f  ht}:{roi_selecto
+0000d0f0: 722e 746f 705f 6c65 6674 5b30 5d7d 3a7b  r.top_left[0]}:{
+0000d100: 726f 695f 7365 6c65 6374 6f72 2e74 6f70  roi_selector.top
+0000d110: 5f6c 6566 745b 315d 7d22 202d 633a 7620  _left[1]}" -c:v 
+0000d120: 6c69 6278 3236 3420 2d63 7266 2031 3720  libx264 -crf 17 
+0000d130: 2d63 3a61 2063 6f70 7920 227b 7361 7665  -c:a copy "{save
+0000d140: 5f70 6174 687d 2220 2d79 270a 2020 2020  _path}" -y'.    
+0000d150: 2020 2020 7375 6270 726f 6365 7373 2e63      subprocess.c
+0000d160: 616c 6c28 636f 6d6d 616e 642c 2073 6865  all(command, she
+0000d170: 6c6c 3d54 7275 6529 0a20 2020 2020 2020  ll=True).       
+0000d180: 2076 6964 656f 5f74 696d 6572 2e73 746f   video_timer.sto
+0000d190: 705f 7469 6d65 7228 290a 2020 2020 2020  p_timer().      
+0000d1a0: 2020 7072 696e 7428 0a20 2020 2020 2020    print(.       
+0000d1b0: 2020 2020 2066 2256 6964 656f 207b 6669       f"Video {fi
+0000d1c0: 6c65 5f6e 616d 657d 2063 726f 7070 6564  le_name} cropped
+0000d1d0: 2028 5669 6465 6f20 7b66 696c 655f 636e   (Video {file_cn
+0000d1e0: 742b 317d 2f7b 6c65 6e28 7669 6465 6f5f  t+1}/{len(video_
+0000d1f0: 7061 7468 7329 7d2c 2065 6c61 7073 6564  paths)}, elapsed
+0000d200: 2074 696d 653a 207b 7669 6465 6f5f 7469   time: {video_ti
+0000d210: 6d65 722e 656c 6170 7365 645f 7469 6d65  mer.elapsed_time
+0000d220: 5f73 7472 7d29 220a 2020 2020 2020 2020  _str})".        
+0000d230: 290a 2020 2020 7469 6d65 722e 7374 6f70  ).    timer.stop
+0000d240: 5f74 696d 6572 2829 0a20 2020 2073 7464  _timer().    std
+0000d250: 6f75 745f 7375 6363 6573 7328 0a20 2020  out_success(.   
+0000d260: 2020 2020 206d 7367 3d66 227b 7374 7228       msg=f"{str(
+0000d270: 6c65 6e28 7669 6465 6f5f 7061 7468 7329  len(video_paths)
+0000d280: 297d 2076 6964 656f 7320 6372 6f70 7065  )} videos croppe
+0000d290: 6420 616e 6420 7361 7665 6420 696e 207b  d and saved in {
+0000d2a0: 6469 7265 6374 6f72 795f 7061 7468 7d20  directory_path} 
+0000d2b0: 6469 7265 6374 6f72 7922 2c0a 2020 2020  directory",.    
+0000d2c0: 2020 2020 656c 6170 7365 645f 7469 6d65      elapsed_time
+0000d2d0: 3d74 696d 6572 2e65 6c61 7073 6564 5f74  =timer.elapsed_t
+0000d2e0: 696d 655f 7374 722c 0a20 2020 2020 2020  ime_str,.       
+0000d2f0: 2073 6f75 7263 653d 6372 6f70 5f6d 756c   source=crop_mul
+0000d300: 7469 706c 655f 7669 6465 6f73 2e5f 5f6e  tiple_videos.__n
+0000d310: 616d 655f 5f2c 0a20 2020 2029 0a0a 0a23  ame__,.    )...#
+0000d320: 205f 203d 2063 726f 705f 6d75 6c74 6970   _ = crop_multip
+0000d330: 6c65 5f76 6964 656f 7328 6469 7265 6374  le_videos(direct
+0000d340: 6f72 795f 7061 7468 3d27 2f55 7365 7273  ory_path='/Users
+0000d350: 2f73 696d 6f6e 2f44 6573 6b74 6f70 2f65  /simon/Desktop/e
+0000d360: 6e76 732f 7472 6f75 626c 6573 686f 6f74  nvs/troubleshoot
+0000d370: 696e 672f 7477 6f5f 626c 6163 6b5f 616e  ing/two_black_an
+0000d380: 696d 616c 735f 3134 6270 2f76 6964 656f  imals_14bp/video
+0000d390: 7327 2c20 6f75 7470 7574 5f70 6174 683d  s', output_path=
+0000d3a0: 272f 5573 6572 732f 7369 6d6f 6e2f 4465  '/Users/simon/De
+0000d3b0: 736b 746f 702f 656e 7673 2f74 726f 7562  sktop/envs/troub
+0000d3c0: 6c65 7368 6f6f 7469 6e67 2f74 776f 5f62  leshooting/two_b
+0000d3d0: 6c61 636b 5f61 6e69 6d61 6c73 5f31 3462  lack_animals_14b
+0000d3e0: 702f 7465 7374 2f74 6573 7427 290a 0a0a  p/test/test')...
+0000d3f0: 6465 6620 6672 616d 6573 5f74 6f5f 6d6f  def frames_to_mo
+0000d400: 7669 6528 0a20 2020 2064 6972 6563 746f  vie(.    directo
+0000d410: 7279 3a20 556e 696f 6e5b 7374 722c 206f  ry: Union[str, o
+0000d420: 732e 5061 7468 4c69 6b65 5d2c 0a20 2020  s.PathLike],.   
+0000d430: 2066 7073 3a20 696e 742c 0a20 2020 2062   fps: int,.    b
+0000d440: 6974 7261 7465 3a20 696e 742c 0a20 2020  itrate: int,.   
+0000d450: 2069 6d67 5f66 6f72 6d61 743a 2073 7472   img_format: str
+0000d460: 2c0a 2020 2020 6770 753a 204f 7074 696f  ,.    gpu: Optio
+0000d470: 6e61 6c5b 626f 6f6c 5d20 3d20 4661 6c73  nal[bool] = Fals
+0000d480: 652c 0a29 202d 3e20 4e6f 6e65 3a0a 2020  e,.) -> None:.  
+0000d490: 2020 2222 220a 2020 2020 4d65 7267 6520    """.    Merge 
+0000d4a0: 616c 6c20 696d 6167 6520 6669 6c65 7320  all image files 
+0000d4b0: 696e 2061 2066 6f6c 6465 7220 746f 2061  in a folder to a
+0000d4c0: 206d 7034 2076 6964 656f 2066 696c 652e   mp4 video file.
+0000d4d0: 2056 6964 656f 2066 696c 6520 6973 2073   Video file is s
+0000d4e0: 746f 7265 6420 696e 2074 6865 2073 616d  tored in the sam
+0000d4f0: 6520 6469 7265 6374 6f72 7920 6173 2074  e directory as t
+0000d500: 6865 0a20 2020 2069 6e70 7574 2064 6972  he.    input dir
+0000d510: 6563 746f 7279 2073 7562 2d66 6f6c 6465  ectory sub-folde
+0000d520: 722e 0a0a 2020 2020 2e2e 206e 6f74 653a  r...    .. note:
+0000d530: 3a0a 2020 2020 2020 2054 6865 2049 6d61  :.       The Ima
+0000d540: 6765 2066 696c 6573 2068 6176 6520 746f  ge files have to
+0000d550: 2068 6176 6520 6f72 6465 7265 6420 6e75   have ordered nu
+0000d560: 6d65 7269 6361 6c20 6e61 6d65 7320 652e  merical names e.
+0000d570: 672e 2c20 6060 312e 706e 6760 602c 2060  g., ``1.png``, `
+0000d580: 6032 2e70 6e67 6060 2065 7463 2e2e 2e0a  `2.png`` etc....
+0000d590: 0a20 2020 203a 7061 7261 6d65 7465 7220  .    :parameter 
+0000d5a0: 7374 7220 6469 7265 6374 6f72 793a 2044  str directory: D
+0000d5b0: 6972 6563 746f 7279 2063 6f6e 7461 696e  irectory contain
+0000d5c0: 696e 6720 7468 6520 696d 6167 6573 2e0a  ing the images..
+0000d5d0: 2020 2020 3a70 6172 616d 6574 6572 2069      :parameter i
+0000d5e0: 6e74 2066 7073 3a20 5468 6520 6672 616d  nt fps: The fram
+0000d5f0: 6520 7261 7465 206f 6620 7468 6520 6f75  e rate of the ou
+0000d600: 7470 7574 2076 6964 656f 2e0a 2020 2020  tput video..    
+0000d610: 3a70 6172 616d 6574 6572 2069 6e74 2062  :parameter int b
+0000d620: 6974 7261 7465 3a20 5468 6520 6269 7472  itrate: The bitr
+0000d630: 6174 6520 6f66 2074 6865 206f 7574 7075  ate of the outpu
+0000d640: 7420 7669 6465 6f20 2865 2e67 2e2c 2033  t video (e.g., 3
+0000d650: 3230 3030 292e 0a20 2020 203a 7061 7261  2000)..    :para
+0000d660: 6d65 7465 7220 7374 7220 696d 675f 666f  meter str img_fo
+0000d670: 726d 6174 3a20 5468 6520 666f 726d 6174  rmat: The format
+0000d680: 206f 6620 7468 6520 696e 7075 7420 696d   of the input im
+0000d690: 6167 6520 6669 6c65 7320 2865 2e67 2e2c  age files (e.g.,
+0000d6a0: 2060 6070 6e67 6060 292e 0a20 2020 203a   ``png``)..    :
+0000d6b0: 7061 7261 6d65 7465 7220 4f70 7469 6f6e  parameter Option
+0000d6c0: 616c 5b62 6f6f 6c5d 2067 7075 3a20 4966  al[bool] gpu: If
+0000d6d0: 2054 7275 652c 2075 7365 204e 5649 4445   True, use NVIDE
+0000d6e0: 4120 4750 5520 636f 6465 6373 2e20 4465  A GPU codecs. De
+0000d6f0: 6661 756c 7420 4661 6c73 652e 0a0a 2020  fault False...  
+0000d700: 2020 3a65 7861 6d70 6c65 3a0a 2020 2020    :example:.    
+0000d710: 3e3e 3e20 5f20 3d20 6672 616d 6573 5f74  >>> _ = frames_t
+0000d720: 6f5f 6d6f 7669 6528 6469 7265 6374 6f72  o_movie(director
+0000d730: 795f 7061 7468 3d27 7072 6f6a 6563 745f  y_path='project_
+0000d740: 666f 6c64 6572 2f76 6964 656f 5f69 6d67  folder/video_img
+0000d750: 272c 2066 7073 3d31 352c 2062 6974 7261  ', fps=15, bitra
+0000d760: 7465 3d33 3230 3030 2c20 696d 675f 666f  te=32000, img_fo
+0000d770: 726d 6174 3d27 706e 6727 290a 2020 2020  rmat='png').    
+0000d780: 2222 220a 0a20 2020 2063 6865 636b 5f66  """..    check_f
+0000d790: 666d 7065 675f 6176 6169 6c61 626c 6528  fmpeg_available(
+0000d7a0: 7261 6973 655f 6572 726f 723d 5472 7565  raise_error=True
+0000d7b0: 290a 2020 2020 6966 2067 7075 2061 6e64  ).    if gpu and
+0000d7c0: 206e 6f74 2063 6865 636b 5f6e 7669 6465   not check_nvide
+0000d7d0: 615f 6770 755f 6176 6169 6c61 626c 6528  a_gpu_available(
+0000d7e0: 293a 0a20 2020 2020 2020 2072 6169 7365  ):.        raise
+0000d7f0: 2046 464d 5045 4743 6f64 6563 4750 5545   FFMPEGCodecGPUE
+0000d800: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+0000d810: 2020 6d73 673d 224e 5649 4445 4120 4750    msg="NVIDEA GP
+0000d820: 5520 6e6f 7420 6176 6169 6c61 626c 6520  U not available 
+0000d830: 2861 7320 6576 616c 7561 7465 6420 6279  (as evaluated by
+0000d840: 206e 7669 6465 612d 736d 6920 7265 7475   nvidea-smi retu
+0000d850: 726e 696e 6720 4e6f 6e65 222c 0a20 2020  rning None",.   
+0000d860: 2020 2020 2020 2020 2073 6f75 7263 653d           source=
+0000d870: 6672 616d 6573 5f74 6f5f 6d6f 7669 652e  frames_to_movie.
+0000d880: 5f5f 6e61 6d65 5f5f 2c0a 2020 2020 2020  __name__,.      
+0000d890: 2020 290a 2020 2020 6966 206e 6f74 206f    ).    if not o
+0000d8a0: 732e 7061 7468 2e69 7364 6972 2864 6972  s.path.isdir(dir
+0000d8b0: 6563 746f 7279 293a 0a20 2020 2020 2020  ectory):.       
+0000d8c0: 2072 6169 7365 204e 6f74 4469 7265 6374   raise NotDirect
+0000d8d0: 6f72 7945 7272 6f72 280a 2020 2020 2020  oryError(.      
+0000d8e0: 2020 2020 2020 6d73 673d 2253 494d 4241        msg="SIMBA
+0000d8f0: 2045 5252 4f52 3a20 7b7d 2069 7320 6e6f   ERROR: {} is no
+0000d900: 7420 6120 7661 6c69 6420 6469 7265 6374  t a valid direct
+0000d910: 6f72 7922 2e66 6f72 6d61 7428 6469 7265  ory".format(dire
+0000d920: 6374 6f72 7929 2c0a 2020 2020 2020 2020  ctory),.        
+0000d930: 2020 2020 736f 7572 6365 3d66 7261 6d65      source=frame
+0000d940: 735f 746f 5f6d 6f76 6965 2e5f 5f6e 616d  s_to_movie.__nam
+0000d950: 655f 5f2c 0a20 2020 2020 2020 2029 0a20  e__,.        ). 
+0000d960: 2020 2063 6865 636b 5f69 6e74 286e 616d     check_int(nam
+0000d970: 653d 2246 5053 222c 2076 616c 7565 3d66  e="FPS", value=f
+0000d980: 7073 2c20 6d69 6e5f 7661 6c75 653d 3129  ps, min_value=1)
+0000d990: 0a20 2020 2063 6865 636b 5f69 6e74 286e  .    check_int(n
+0000d9a0: 616d 653d 2242 4954 5241 5445 222c 2076  ame="BITRATE", v
+0000d9b0: 616c 7565 3d62 6974 7261 7465 290a 2020  alue=bitrate).  
+0000d9c0: 2020 6669 6c65 5f70 6174 6873 5f69 6e5f    file_paths_in_
+0000d9d0: 666f 6c64 6572 203d 205b 6620 666f 7220  folder = [f for 
+0000d9e0: 6620 696e 2067 6c6f 622e 676c 6f62 2864  f in glob.glob(d
+0000d9f0: 6972 6563 746f 7279 202b 2022 2f2a 2229  irectory + "/*")
+0000da00: 2069 6620 6f73 2e70 6174 682e 6973 6669   if os.path.isfi
+0000da10: 6c65 2866 295d 0a20 2020 2069 6d67 5f70  le(f)].    img_p
+0000da20: 6174 6873 5f69 6e5f 666f 6c64 6572 203d  aths_in_folder =
+0000da30: 205b 0a20 2020 2020 2020 2078 2066 6f72   [.        x for
+0000da40: 2078 2069 6e20 6669 6c65 5f70 6174 6873   x in file_paths
+0000da50: 5f69 6e5f 666f 6c64 6572 2069 6620 5061  _in_folder if Pa
+0000da60: 7468 2878 292e 7375 6666 6978 5b31 3a5d  th(x).suffix[1:]
+0000da70: 203d 3d20 696d 675f 666f 726d 6174 0a20   == img_format. 
+0000da80: 2020 205d 0a20 2020 2069 6620 6c65 6e28     ].    if len(
+0000da90: 696d 675f 7061 7468 735f 696e 5f66 6f6c  img_paths_in_fol
+0000daa0: 6465 7229 203c 2031 3a0a 2020 2020 2020  der) < 1:.      
+0000dab0: 2020 7261 6973 6520 4e6f 4669 6c65 7346    raise NoFilesF
+0000dac0: 6f75 6e64 4572 726f 7228 0a20 2020 2020  oundError(.     
+0000dad0: 2020 2020 2020 206d 7367 3d22 5349 4d42         msg="SIMB
+0000dae0: 4120 4552 524f 523a 205a 6572 6f20 696d  A ERROR: Zero im
+0000daf0: 6167 6573 206f 6620 6669 6c65 2d74 7970  ages of file-typ
+0000db00: 6520 7b7d 2066 6f75 6e64 2069 6e20 7b7d  e {} found in {}
+0000db10: 2064 6972 6563 746f 7279 222e 666f 726d   directory".form
+0000db20: 6174 280a 2020 2020 2020 2020 2020 2020  at(.            
+0000db30: 2020 2020 696d 675f 666f 726d 6174 2c20      img_format, 
+0000db40: 6469 7265 6374 6f72 790a 2020 2020 2020  directory.      
+0000db50: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
+0000db60: 2020 2020 2073 6f75 7263 653d 6672 616d       source=fram
+0000db70: 6573 5f74 6f5f 6d6f 7669 652e 5f5f 6e61  es_to_movie.__na
+0000db80: 6d65 5f5f 2c0a 2020 2020 2020 2020 290a  me__,.        ).
+0000db90: 2020 2020 696d 6720 3d20 6376 322e 696d      img = cv2.im
+0000dba0: 7265 6164 2869 6d67 5f70 6174 6873 5f69  read(img_paths_i
+0000dbb0: 6e5f 666f 6c64 6572 5b30 5d29 0a20 2020  n_folder[0]).   
+0000dbc0: 2069 6d67 5f68 2c20 696d 675f 7720 3d20   img_h, img_w = 
+0000dbd0: 696e 7428 696d 672e 7368 6170 655b 305d  int(img.shape[0]
+0000dbe0: 292c 2069 6e74 2869 6d67 2e73 6861 7065  ), int(img.shape
+0000dbf0: 5b31 5d29 0a20 2020 2066 666d 7065 675f  [1]).    ffmpeg_
+0000dc00: 666e 203d 206f 732e 7061 7468 2e6a 6f69  fn = os.path.joi
+0000dc10: 6e28 6469 7265 6374 6f72 792c 2022 2564  n(directory, "%d
+0000dc20: 2e7b 7d22 2e66 6f72 6d61 7428 696d 675f  .{}".format(img_
+0000dc30: 666f 726d 6174 2929 0a20 2020 2073 6176  format)).    sav
+0000dc40: 655f 7061 7468 203d 206f 732e 7061 7468  e_path = os.path
+0000dc50: 2e6a 6f69 6e28 0a20 2020 2020 2020 206f  .join(.        o
+0000dc60: 732e 7061 7468 2e64 6972 6e61 6d65 2864  s.path.dirname(d
+0000dc70: 6972 6563 746f 7279 292c 206f 732e 7061  irectory), os.pa
+0000dc80: 7468 2e62 6173 656e 616d 6528 6469 7265  th.basename(dire
+0000dc90: 6374 6f72 7929 202b 2022 2e6d 7034 220a  ctory) + ".mp4".
+0000dca0: 2020 2020 290a 2020 2020 6966 2067 7075      ).    if gpu
+0000dcb0: 3a0a 2020 2020 2020 2020 636f 6d6d 616e  :.        comman
+0000dcc0: 6420 3d20 6627 6666 6d70 6567 202d 7920  d = f'ffmpeg -y 
+0000dcd0: 2d72 207b 6670 737d 202d 6620 696d 6167  -r {fps} -f imag
+0000dce0: 6532 202d 7320 7b69 6d67 5f68 7d78 7b69  e2 -s {img_h}x{i
+0000dcf0: 6d67 5f77 7d20 2d69 2022 7b66 666d 7065  mg_w} -i "{ffmpe
+0000dd00: 675f 666e 7d22 202d 633a 7620 6832 3634  g_fn}" -c:v h264
+0000dd10: 5f6e 7665 6e63 202d 623a 7620 7b62 6974  _nvenc -b:v {bit
+0000dd20: 7261 7465 7d6b 2022 7b73 6176 655f 7061  rate}k "{save_pa
+0000dd30: 7468 7d22 202d 7927 0a20 2020 2065 6c73  th}" -y'.    els
+0000dd40: 653a 0a20 2020 2020 2020 2063 6f6d 6d61  e:.        comma
+0000dd50: 6e64 203d 2066 2766 666d 7065 6720 2d79  nd = f'ffmpeg -y
+0000dd60: 202d 7220 7b66 7073 7d20 2d66 2069 6d61   -r {fps} -f ima
+0000dd70: 6765 3220 2d73 207b 696d 675f 687d 787b  ge2 -s {img_h}x{
+0000dd80: 696d 675f 777d 202d 6920 227b 6666 6d70  img_w} -i "{ffmp
+0000dd90: 6567 5f66 6e7d 2220 2d76 636f 6465 6320  eg_fn}" -vcodec 
+0000dda0: 6c69 6278 3236 3420 2d62 207b 6269 7472  libx264 -b {bitr
+0000ddb0: 6174 657d 6b20 227b 7361 7665 5f70 6174  ate}k "{save_pat
+0000ddc0: 687d 2220 2d79 270a 2020 2020 7072 696e  h}" -y'.    prin
+0000ddd0: 7428 0a20 2020 2020 2020 2066 2243 7265  t(.        f"Cre
+0000dde0: 6174 696e 6720 7b6f 732e 7061 7468 2e62  ating {os.path.b
+0000ddf0: 6173 656e 616d 6528 7361 7665 5f70 6174  asename(save_pat
+0000de00: 6829 7d20 6672 6f6d 207b 6c65 6e28 696d  h)} from {len(im
+0000de10: 675f 7061 7468 735f 696e 5f66 6f6c 6465  g_paths_in_folde
+0000de20: 7229 7d20 696d 6167 6573 2e2e 2e22 0a20  r)} images...". 
+0000de30: 2020 2029 0a20 2020 2073 7562 7072 6f63     ).    subproc
+0000de40: 6573 732e 6361 6c6c 2863 6f6d 6d61 6e64  ess.call(command
+0000de50: 2c20 7368 656c 6c3d 5472 7565 290a 2020  , shell=True).  
+0000de60: 2020 7374 646f 7574 5f73 7563 6365 7373    stdout_success
+0000de70: 286d 7367 3d66 2256 6964 656f 2063 7265  (msg=f"Video cre
+0000de80: 6174 6564 2061 7420 7b73 6176 655f 7061  ated at {save_pa
+0000de90: 7468 7d22 2c20 736f 7572 6365 3d66 7261  th}", source=fra
+0000dea0: 6d65 735f 746f 5f6d 6f76 6965 2e5f 5f6e  mes_to_movie.__n
+0000deb0: 616d 655f 5f29 0a0a 0a23 205f 203d 2066  ame__)...# _ = f
+0000dec0: 7261 6d65 735f 746f 5f6d 6f76 6965 2864  rames_to_movie(d
+0000ded0: 6972 6563 746f 7279 3d27 2f55 7365 7273  irectory='/Users
+0000dee0: 2f73 696d 6f6e 2f44 6573 6b74 6f70 2f65  /simon/Desktop/e
+0000def0: 6e76 732f 7369 6d62 612f 7472 6f75 626c  nvs/simba/troubl
+0000df00: 6573 686f 6f74 696e 672f 6d6f 7573 655f  eshooting/mouse_
+0000df10: 6f70 656e 5f66 6965 6c64 2f70 726f 6a65  open_field/proje
+0000df20: 6374 5f66 6f6c 6465 722f 7669 6465 6f73  ct_folder/videos
+0000df30: 2f53 495f 4441 5933 5f33 3038 5f43 4431  /SI_DAY3_308_CD1
+0000df40: 5f50 5245 5345 4e54 5f64 6f77 6e73 616d  _PRESENT_downsam
+0000df50: 706c 6564 272c 2066 7073 3d31 352c 2062  pled', fps=15, b
+0000df60: 6974 7261 7465 3d33 3230 3030 2c20 696d  itrate=32000, im
+0000df70: 675f 666f 726d 6174 3d27 706e 6727 290a  g_format='png').
+0000df80: 0a0a 6465 6620 7669 6465 6f5f 636f 6e63  ..def video_conc
+0000df90: 6174 656e 6174 6f72 280a 2020 2020 7669  atenator(.    vi
+0000dfa0: 6465 6f5f 6f6e 655f 7061 7468 3a20 556e  deo_one_path: Un
+0000dfb0: 696f 6e5b 7374 722c 206f 732e 5061 7468  ion[str, os.Path
+0000dfc0: 4c69 6b65 5d2c 0a20 2020 2076 6964 656f  Like],.    video
+0000dfd0: 5f74 776f 5f70 6174 683a 2055 6e69 6f6e  _two_path: Union
+0000dfe0: 5b73 7472 2c20 6f73 2e50 6174 684c 696b  [str, os.PathLik
+0000dff0: 655d 2c0a 2020 2020 7265 736f 6c75 7469  e],.    resoluti
+0000e000: 6f6e 3a20 556e 696f 6e5b 696e 742c 2073  on: Union[int, s
+0000e010: 7472 5d2c 0a20 2020 2068 6f72 697a 6f6e  tr],.    horizon
+0000e020: 7461 6c3a 2062 6f6f 6c2c 0a20 2020 2067  tal: bool,.    g
+0000e030: 7075 3a20 4f70 7469 6f6e 616c 5b62 6f6f  pu: Optional[boo
+0000e040: 6c5d 203d 2046 616c 7365 2c0a 2920 2d3e  l] = False,.) ->
+0000e050: 204e 6f6e 653a 0a20 2020 2022 2222 0a20   None:.    """. 
+0000e060: 2020 2043 6f6e 6361 7465 6e61 7465 2074     Concatenate t
+0000e070: 776f 2076 6964 656f 7320 746f 2061 2073  wo videos to a s
+0000e080: 696e 676c 6520 7669 6465 6f0a 0a20 2020  ingle video..   
+0000e090: 203a 7061 7261 6d20 7374 7220 7669 6465   :param str vide
+0000e0a0: 6f5f 6f6e 655f 7061 7468 3a20 5061 7468  o_one_path: Path
+0000e0b0: 2074 6f20 7468 6520 6669 7273 7420 7669   to the first vi
+0000e0c0: 6465 6f20 696e 2074 6865 2063 6f6e 6361  deo in the conca
+0000e0d0: 7465 6e61 7465 6420 7669 6465 6f0a 2020  tenated video.  
+0000e0e0: 2020 3a70 6172 616d 2073 7472 2076 6964    :param str vid
+0000e0f0: 656f 5f74 776f 5f70 6174 683a 2050 6174  eo_two_path: Pat
+0000e100: 6820 746f 2074 6865 2073 6563 6f6e 6420  h to the second 
+0000e110: 7669 6465 6f20 696e 2074 6865 2063 6f6e  video in the con
+0000e120: 6361 7465 6e61 7465 6420 7669 6465 6f0a  catenated video.
+0000e130: 2020 2020 3a70 6172 616d 2069 6e74 206f      :param int o
+0000e140: 7220 7374 7220 7265 736f 6c75 7469 6f6e  r str resolution
+0000e150: 3a20 4966 2073 7472 2c20 7468 656e 2074  : If str, then t
+0000e160: 6865 206e 616d 6520 6f66 2074 6865 2076  he name of the v
+0000e170: 6964 656f 2077 6869 6368 2072 6573 6f6c  ideo which resol
+0000e180: 7574 696f 6e20 796f 7520 7761 6e74 2074  ution you want t
+0000e190: 6f20 7265 7461 696e 2e20 452e 672e 2c20  o retain. E.g., 
+0000e1a0: 6056 6964 656f 5f31 602e 2045 6c73 6520  `Video_1`. Else 
+0000e1b0: 696e 742c 2072 6570 7265 7365 6e74 696e  int, representin
+0000e1c0: 6720 7468 6520 7669 6465 6f20 7769 6474  g the video widt
+0000e1d0: 6820 2869 6620 7665 7274 6963 616c 2063  h (if vertical c
+0000e1e0: 6f6e 6361 7429 206f 7220 6865 6967 6874  oncat) or height
+0000e1f0: 2028 6966 2068 6f72 697a 6f6e 7461 6c20   (if horizontal 
+0000e200: 636f 6e63 6174 292e 2041 7370 6563 7420  concat). Aspect 
+0000e210: 7261 696f 2077 696c 6c20 6265 2072 6574  raio will be ret
+0000e220: 6169 6e65 642e 0a20 2020 203a 7061 7261  ained..    :para
+0000e230: 6d20 686f 7269 7a6f 6e74 616c 3a20 4966  m horizontal: If
+0000e240: 2074 7275 652c 2074 6865 6e20 686f 7269   true, then hori
+0000e250: 7a6f 6e74 616c 2063 6f6e 6361 7465 6e61  zontal concatena
+0000e260: 7469 6f6e 2e20 456c 7365 2076 6572 7469  tion. Else verti
+0000e270: 6361 6c20 636f 6e63 6174 656e 6174 696f  cal concatenatio
+0000e280: 6e2e 0a20 2020 203a 7061 7261 6d65 7465  n..    :paramete
+0000e290: 7220 4f70 7469 6f6e 616c 5b62 6f6f 6c5d  r Optional[bool]
+0000e2a0: 2067 7075 3a20 4966 2054 7275 652c 2075   gpu: If True, u
+0000e2b0: 7365 204e 5649 4445 4120 4750 5520 636f  se NVIDEA GPU co
+0000e2c0: 6465 6373 2e20 4465 6661 756c 7420 4661  decs. Default Fa
+0000e2d0: 6c73 652e 0a0a 2020 2020 3a65 7861 6d70  lse...    :examp
+0000e2e0: 6c65 3a0a 2020 2020 3e3e 3e20 7669 6465  le:.    >>> vide
+0000e2f0: 6f5f 636f 6e63 6174 656e 6174 6f72 2876  o_concatenator(v
+0000e300: 6964 656f 5f6f 6e65 5f70 6174 683d 2770  ideo_one_path='p
+0000e310: 726f 6a65 6374 5f66 6f6c 6465 722f 7669  roject_folder/vi
+0000e320: 6465 6f73 2f56 6964 656f 5f31 2e6d 7034  deos/Video_1.mp4
+0000e330: 272c 2076 6964 656f 5f74 776f 5f70 6174  ', video_two_pat
+0000e340: 683d 2770 726f 6a65 6374 5f66 6f6c 6465  h='project_folde
+0000e350: 722f 7669 6465 6f73 2f56 6964 656f 5f32  r/videos/Video_2
+0000e360: 2e6d 7034 272c 2072 6573 6f6c 7574 696f  .mp4', resolutio
+0000e370: 6e3d 3830 302c 2068 6f72 697a 6f6e 7461  n=800, horizonta
+0000e380: 6c3d 5472 7565 290a 2020 2020 2222 220a  l=True).    """.
+0000e390: 0a20 2020 2069 6620 6770 7520 616e 6420  .    if gpu and 
+0000e3a0: 6e6f 7420 6368 6563 6b5f 6e76 6964 6561  not check_nvidea
+0000e3b0: 5f67 7075 5f61 7661 696c 6162 6c65 2829  _gpu_available()
+0000e3c0: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
+0000e3d0: 4646 4d50 4547 436f 6465 6347 5055 4572  FFMPEGCodecGPUEr
+0000e3e0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+0000e3f0: 206d 7367 3d22 4e56 4944 4541 2047 5055   msg="NVIDEA GPU
+0000e400: 206e 6f74 2061 7661 696c 6162 6c65 2028   not available (
+0000e410: 6173 2065 7661 6c75 6174 6564 2062 7920  as evaluated by 
+0000e420: 6e76 6964 6561 2d73 6d69 2072 6574 7572  nvidea-smi retur
+0000e430: 6e69 6e67 204e 6f6e 6522 2c0a 2020 2020  ning None",.    
+0000e440: 2020 2020 2020 2020 736f 7572 6365 3d76          source=v
+0000e450: 6964 656f 5f63 6f6e 6361 7465 6e61 746f  ideo_concatenato
+0000e460: 722e 5f5f 6e61 6d65 5f5f 2c0a 2020 2020  r.__name__,.    
+0000e470: 2020 2020 290a 2020 2020 6966 206e 6f74      ).    if not
+0000e480: 2063 6865 636b 5f66 666d 7065 675f 6176   check_ffmpeg_av
+0000e490: 6169 6c61 626c 6528 293a 0a20 2020 2020  ailable():.     
+0000e4a0: 2020 2072 6169 7365 2046 464d 5045 474e     raise FFMPEGN
+0000e4b0: 6f74 466f 756e 6445 7272 6f72 280a 2020  otFoundError(.  
+0000e4c0: 2020 2020 2020 2020 2020 6d73 673d 2246            msg="F
+0000e4d0: 464d 5045 4720 6e6f 7420 666f 756e 6420  FMPEG not found 
+0000e4e0: 6f6e 2074 6865 2063 6f6d 7075 7465 722e  on the computer.
+0000e4f0: 2049 6e73 7461 6c6c 2046 464d 5045 4720   Install FFMPEG 
+0000e500: 746f 2075 7365 2074 6865 2063 6f6e 6361  to use the conca
+0000e510: 7465 6e61 7469 6f6e 206d 6574 686f 642e  tenation method.
+0000e520: 222c 0a20 2020 2020 2020 2020 2020 2073  ",.            s
+0000e530: 6f75 7263 653d 7669 6465 6f5f 636f 6e63  ource=video_conc
+0000e540: 6174 656e 6174 6f72 2e5f 5f6e 616d 655f  atenator.__name_
+0000e550: 5f2c 0a20 2020 2020 2020 2029 0a20 2020  _,.        ).   
+0000e560: 2074 696d 6572 203d 2053 696d 6261 5469   timer = SimbaTi
+0000e570: 6d65 7228 7374 6172 743d 5472 7565 290a  mer(start=True).
+0000e580: 2020 2020 666f 7220 6669 6c65 5f70 6174      for file_pat
+0000e590: 6820 696e 205b 7669 6465 6f5f 6f6e 655f  h in [video_one_
+0000e5a0: 7061 7468 2c20 7669 6465 6f5f 7477 6f5f  path, video_two_
+0000e5b0: 7061 7468 5d3a 0a20 2020 2020 2020 2063  path]:.        c
+0000e5c0: 6865 636b 5f66 696c 655f 6578 6973 745f  heck_file_exist_
+0000e5d0: 616e 645f 7265 6164 6162 6c65 2866 696c  and_readable(fil
+0000e5e0: 655f 7061 7468 3d66 696c 655f 7061 7468  e_path=file_path
+0000e5f0: 290a 2020 2020 2020 2020 5f20 3d20 6765  ).        _ = ge
+0000e600: 745f 7669 6465 6f5f 6d65 7461 5f64 6174  t_video_meta_dat
+0000e610: 6128 6669 6c65 5f70 6174 6829 0a20 2020  a(file_path).   
+0000e620: 2069 6620 7479 7065 2872 6573 6f6c 7574   if type(resolut
+0000e630: 696f 6e29 2069 7320 696e 743a 0a20 2020  ion) is int:.   
+0000e640: 2020 2020 2076 6964 656f 5f6d 6574 615f       video_meta_
+0000e650: 6461 7461 203d 207b 7d0a 2020 2020 2020  data = {}.      
+0000e660: 2020 6966 2068 6f72 697a 6f6e 7461 6c3a    if horizontal:
+0000e670: 0a20 2020 2020 2020 2020 2020 2076 6964  .            vid
+0000e680: 656f 5f6d 6574 615f 6461 7461 5b22 6865  eo_meta_data["he
+0000e690: 6967 6874 225d 203d 2072 6573 6f6c 7574  ight"] = resolut
+0000e6a0: 696f 6e0a 2020 2020 2020 2020 656c 7365  ion.        else
+0000e6b0: 3a0a 2020 2020 2020 2020 2020 2020 7669  :.            vi
+0000e6c0: 6465 6f5f 6d65 7461 5f64 6174 615b 2277  deo_meta_data["w
+0000e6d0: 6964 7468 225d 203d 2072 6573 6f6c 7574  idth"] = resolut
+0000e6e0: 696f 6e0a 2020 2020 656c 6966 2072 6573  ion.    elif res
+0000e6f0: 6f6c 7574 696f 6e20 6973 2022 5669 6465  olution is "Vide
+0000e700: 6f20 3122 3a0a 2020 2020 2020 2020 7669  o 1":.        vi
+0000e710: 6465 6f5f 6d65 7461 5f64 6174 6120 3d20  deo_meta_data = 
+0000e720: 6765 745f 7669 6465 6f5f 6d65 7461 5f64  get_video_meta_d
+0000e730: 6174 6128 7669 6465 6f5f 6f6e 655f 7061  ata(video_one_pa
+0000e740: 7468 290a 2020 2020 656c 7365 3a0a 2020  th).    else:.  
+0000e750: 2020 2020 2020 7669 6465 6f5f 6d65 7461        video_meta
+0000e760: 5f64 6174 6120 3d20 6765 745f 7669 6465  _data = get_vide
+0000e770: 6f5f 6d65 7461 5f64 6174 6128 7669 6465  o_meta_data(vide
+0000e780: 6f5f 6f6e 655f 7061 7468 290a 2020 2020  o_one_path).    
+0000e790: 6469 722c 2066 696c 655f 6e61 6d65 5f31  dir, file_name_1
+0000e7a0: 2c20 5f20 3d20 6765 745f 666e 5f65 7874  , _ = get_fn_ext
+0000e7b0: 2876 6964 656f 5f6f 6e65 5f70 6174 6829  (video_one_path)
+0000e7c0: 0a20 2020 205f 2c20 6669 6c65 5f6e 616d  .    _, file_nam
+0000e7d0: 655f 322c 205f 203d 2067 6574 5f66 6e5f  e_2, _ = get_fn_
+0000e7e0: 6578 7428 7669 6465 6f5f 7477 6f5f 7061  ext(video_two_pa
+0000e7f0: 7468 290a 2020 2020 7072 696e 7428 6622  th).    print(f"
+0000e800: 436f 6e63 6174 656e 6174 696e 6720 7669  Concatenating vi
+0000e810: 6465 6f73 207b 6669 6c65 5f6e 616d 655f  deos {file_name_
+0000e820: 317d 2061 6e64 207b 6669 6c65 5f6e 616d  1} and {file_nam
+0000e830: 655f 327d 2e2e 2e22 290a 2020 2020 7361  e_2}...").    sa
+0000e840: 7665 5f70 6174 6820 3d20 6f73 2e70 6174  ve_path = os.pat
+0000e850: 682e 6a6f 696e 2864 6972 2c20 6669 6c65  h.join(dir, file
+0000e860: 5f6e 616d 655f 3120 2b20 6669 6c65 5f6e  _name_1 + file_n
+0000e870: 616d 655f 3220 2b20 225f 636f 6e63 6174  ame_2 + "_concat
+0000e880: 2e6d 7034 2229 0a20 2020 2069 6620 686f  .mp4").    if ho
+0000e890: 7269 7a6f 6e74 616c 3a0a 2020 2020 2020  rizontal:.      
+0000e8a0: 2020 6966 2067 7075 3a0a 2020 2020 2020    if gpu:.      
+0000e8b0: 2020 2020 2020 636f 6d6d 616e 6420 3d20        command = 
+0000e8c0: 6627 6666 6d70 6567 202d 7920 2d68 7761  f'ffmpeg -y -hwa
+0000e8d0: 6363 656c 2061 7574 6f20 2d63 3a76 2068  ccel auto -c:v h
+0000e8e0: 3236 345f 6375 7669 6420 2d69 2022 7b76  264_cuvid -i "{v
+0000e8f0: 6964 656f 5f6f 6e65 5f70 6174 687d 2220  ideo_one_path}" 
+0000e900: 2d68 7761 6363 656c 2061 7574 6f20 2d63  -hwaccel auto -c
+0000e910: 3a76 2068 3236 345f 6375 7669 6420 2d69  :v h264_cuvid -i
+0000e920: 2022 7b76 6964 656f 5f74 776f 5f70 6174   "{video_two_pat
+0000e930: 687d 2220 2d66 696c 7465 725f 636f 6d70  h}" -filter_comp
+0000e940: 6c65 7820 225b 303a 765d 7363 616c 653d  lex "[0:v]scale=
+0000e950: 2d31 3a7b 7669 6465 6f5f 6d65 7461 5f64  -1:{video_meta_d
+0000e960: 6174 615b 2268 6569 6768 7422 5d7d 5b76  ata["height"]}[v
+0000e970: 305d 3b5b 7630 5d5b 313a 765d 6873 7461  0];[v0][1:v]hsta
+0000e980: 636b 3d69 6e70 7574 733d 3222 202d 633a  ck=inputs=2" -c:
+0000e990: 7620 6832 3634 5f6e 7665 6e63 2022 7b73  v h264_nvenc "{s
+0000e9a0: 6176 655f 7061 7468 7d22 270a 2020 2020  ave_path}"'.    
+0000e9b0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0000e9c0: 2020 2020 2020 636f 6d6d 616e 6420 3d20        command = 
+0000e9d0: 6627 6666 6d70 6567 202d 7920 2d69 2022  f'ffmpeg -y -i "
+0000e9e0: 7b76 6964 656f 5f6f 6e65 5f70 6174 687d  {video_one_path}
+0000e9f0: 2220 2d69 2022 7b76 6964 656f 5f74 776f  " -i "{video_two
+0000ea00: 5f70 6174 687d 2220 2d66 696c 7465 725f  _path}" -filter_
+0000ea10: 636f 6d70 6c65 7820 225b 303a 765d 7363  complex "[0:v]sc
+0000ea20: 616c 653d 2d31 3a7b 7669 6465 6f5f 6d65  ale=-1:{video_me
+0000ea30: 7461 5f64 6174 615b 2268 6569 6768 7422  ta_data["height"
+0000ea40: 5d7d 5b76 305d 3b5b 7630 5d5b 313a 765d  ]}[v0];[v0][1:v]
+0000ea50: 6873 7461 636b 3d69 6e70 7574 733d 3222  hstack=inputs=2"
+0000ea60: 2022 7b73 6176 655f 7061 7468 7d22 270a   "{save_path}"'.
+0000ea70: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
+0000ea80: 2020 2069 6620 6770 753a 0a20 2020 2020     if gpu:.     
+0000ea90: 2020 2020 2020 2063 6f6d 6d61 6e64 203d         command =
+0000eaa0: 2066 2766 666d 7065 6720 2d79 202d 6877   f'ffmpeg -y -hw
+0000eab0: 6163 6365 6c20 6175 746f 202d 633a 7620  accel auto -c:v 
+0000eac0: 6832 3634 5f63 7576 6964 202d 6920 227b  h264_cuvid -i "{
+0000ead0: 7669 6465 6f5f 6f6e 655f 7061 7468 7d22  video_one_path}"
+0000eae0: 202d 6877 6163 6365 6c20 6175 746f 202d   -hwaccel auto -
+0000eaf0: 633a 7620 6832 3634 5f63 7576 6964 202d  c:v h264_cuvid -
+0000eb00: 6920 227b 7669 6465 6f5f 7477 6f5f 7061  i "{video_two_pa
+0000eb10: 7468 7d22 202d 6669 6c74 6572 5f63 6f6d  th}" -filter_com
+0000eb20: 706c 6578 2022 5b30 3a76 5d73 6361 6c65  plex "[0:v]scale
+0000eb30: 3d7b 7669 6465 6f5f 6d65 7461 5f64 6174  ={video_meta_dat
+0000eb40: 615b 2277 6964 7468 225d 7d3a 2d31 5b76  a["width"]}:-1[v
+0000eb50: 305d 3b5b 7630 5d5b 313a 765d 7673 7461  0];[v0][1:v]vsta
+0000eb60: 636b 3d69 6e70 7574 733d 3222 202d 633a  ck=inputs=2" -c:
+0000eb70: 7620 6832 3634 5f6e 7665 6e63 2022 7b73  v h264_nvenc "{s
+0000eb80: 6176 655f 7061 7468 7d22 270a 2020 2020  ave_path}"'.    
+0000eb90: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0000eba0: 2020 2020 2020 636f 6d6d 616e 6420 3d20        command = 
+0000ebb0: 6627 6666 6d70 6567 202d 7920 2d69 2022  f'ffmpeg -y -i "
+0000ebc0: 7b76 6964 656f 5f6f 6e65 5f70 6174 687d  {video_one_path}
+0000ebd0: 2220 2d69 2022 7b76 6964 656f 5f74 776f  " -i "{video_two
+0000ebe0: 5f70 6174 687d 2220 2d66 696c 7465 725f  _path}" -filter_
+0000ebf0: 636f 6d70 6c65 7820 225b 303a 765d 7363  complex "[0:v]sc
+0000ec00: 616c 653d 7b76 6964 656f 5f6d 6574 615f  ale={video_meta_
+0000ec10: 6461 7461 5b22 7769 6474 6822 5d7d 3a2d  data["width"]}:-
+0000ec20: 315b 7630 5d3b 5b76 305d 5b31 3a76 5d76  1[v0];[v0][1:v]v
+0000ec30: 7374 6163 6b3d 696e 7075 7473 3d32 2220  stack=inputs=2" 
+0000ec40: 227b 7361 7665 5f70 6174 687d 2227 0a20  "{save_path}"'. 
+0000ec50: 2020 2069 6620 6770 753a 0a20 2020 2020     if gpu:.     
+0000ec60: 2020 2070 726f 6365 7373 203d 2073 7562     process = sub
+0000ec70: 7072 6f63 6573 732e 506f 7065 6e28 636f  process.Popen(co
+0000ec80: 6d6d 616e 642c 2073 6865 6c6c 3d54 7275  mmand, shell=Tru
+0000ec90: 6529 0a20 2020 2020 2020 206f 7574 7075  e).        outpu
+0000eca0: 742c 2065 7272 6f72 203d 2070 726f 6365  t, error = proce
+0000ecb0: 7373 2e63 6f6d 6d75 6e69 6361 7465 2829  ss.communicate()
+0000ecc0: 0a20 2020 2020 2020 2069 6620 7072 6f63  .        if proc
+0000ecd0: 6573 732e 7265 7475 726e 636f 6465 2021  ess.returncode !
+0000ece0: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
+0000ecf0: 2069 6620 2255 6e6b 6e6f 776e 2064 6563   if "Unknown dec
+0000ed00: 6f64 6572 2220 696e 2073 7472 2865 7272  oder" in str(err
+0000ed10: 6f72 2e73 706c 6974 2862 225c 6e22 295b  or.split(b"\n")[
+0000ed20: 2d32 5d29 3a0a 2020 2020 2020 2020 2020  -2]):.          
+0000ed30: 2020 2020 2020 7261 6973 6520 4646 4d50        raise FFMP
+0000ed40: 4547 436f 6465 6347 5055 4572 726f 7228  EGCodecGPUError(
+0000ed50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ed60: 2020 2020 206d 7367 3d22 4750 5520 636f       msg="GPU co
+0000ed70: 6465 6320 6e6f 7420 666f 756e 643a 2072  dec not found: r
+0000ed80: 6576 6572 7469 6e67 2074 6f20 4350 552e  everting to CPU.
+0000ed90: 2050 726f 7065 726c 7920 636f 6e66 6967   Properly config
+0000eda0: 7572 6520 4646 4d70 6567 2061 6e64 2065  ure FFMpeg and e
+0000edb0: 6e73 7572 6520 796f 7520 6861 7665 2047  nsure you have G
+0000edc0: 5055 2061 7661 696c 6162 6c65 206f 7220  PU available or 
+0000edd0: 7573 6520 4350 552e 222c 0a20 2020 2020  use CPU.",.     
+0000ede0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000edf0: 6f75 7263 653d 7669 6465 6f5f 636f 6e63  ource=video_conc
+0000ee00: 6174 656e 6174 6f72 2e5f 5f6e 616d 655f  atenator.__name_
+0000ee10: 5f2c 0a20 2020 2020 2020 2020 2020 2020  _,.             
+0000ee20: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0000ee30: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0000ee40: 2020 2020 2020 2072 6169 7365 2046 464d         raise FFM
+0000ee50: 5045 4743 6f64 6563 4750 5545 7272 6f72  PEGCodecGPUError
+0000ee60: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000ee70: 2020 2020 2020 6d73 673d 2247 5055 2065        msg="GPU e
+0000ee80: 7272 6f72 2e20 5072 6f70 6572 6c79 2063  rror. Properly c
+0000ee90: 6f6e 6669 6775 7265 2046 464d 7065 6720  onfigure FFMpeg 
+0000eea0: 616e 6420 656e 7375 7265 2079 6f75 2068  and ensure you h
+0000eeb0: 6176 6520 4750 5520 6176 6169 6c61 626c  ave GPU availabl
+0000eec0: 652c 206f 7220 7573 6520 4350 552e 222c  e, or use CPU.",
+0000eed0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000eee0: 2020 2020 2073 6f75 7263 653d 7669 6465       source=vide
+0000eef0: 6f5f 636f 6e63 6174 656e 6174 6f72 2e5f  o_concatenator._
+0000ef00: 5f6e 616d 655f 5f2c 0a20 2020 2020 2020  _name__,.       
+0000ef10: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0000ef20: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0000ef30: 2020 2020 2070 6173 730a 2020 2020 656c       pass.    el
+0000ef40: 7365 3a0a 2020 2020 2020 2020 7375 6270  se:.        subp
+0000ef50: 726f 6365 7373 2e63 616c 6c28 636f 6d6d  rocess.call(comm
+0000ef60: 616e 642c 2073 6865 6c6c 3d54 7275 652c  and, shell=True,
+0000ef70: 2073 7464 6f75 743d 7375 6270 726f 6365   stdout=subproce
+0000ef80: 7373 2e50 4950 4529 0a20 2020 2074 696d  ss.PIPE).    tim
+0000ef90: 6572 2e73 746f 705f 7469 6d65 7228 290a  er.stop_timer().
+0000efa0: 2020 2020 7374 646f 7574 5f73 7563 6365      stdout_succe
+0000efb0: 7373 280a 2020 2020 2020 2020 6d73 673d  ss(.        msg=
+0000efc0: 6622 5669 6465 6f73 2063 6f6e 6361 7465  f"Videos concate
+0000efd0: 6e61 7465 6420 616e 6420 7361 7665 6420  nated and saved 
+0000efe0: 6174 207b 7361 7665 5f70 6174 687d 222c  at {save_path}",
+0000eff0: 0a20 2020 2020 2020 2065 6c61 7073 6564  .        elapsed
+0000f000: 5f74 696d 653d 7469 6d65 722e 656c 6170  _time=timer.elap
+0000f010: 7365 645f 7469 6d65 5f73 7472 2c0a 2020  sed_time_str,.  
+0000f020: 2020 2020 2020 736f 7572 6365 3d76 6964        source=vid
+0000f030: 656f 5f63 6f6e 6361 7465 6e61 746f 722e  eo_concatenator.
+0000f040: 5f5f 6e61 6d65 5f5f 2c0a 2020 2020 290a  __name__,.    ).
+0000f050: 0a0a 2320 7669 6465 6f5f 636f 6e63 6174  ..# video_concat
+0000f060: 656e 6174 6f72 2876 6964 656f 5f6f 6e65  enator(video_one
+0000f070: 5f70 6174 683d 7227 2f55 7365 7273 2f73  _path=r'/Users/s
+0000f080: 696d 6f6e 2f44 6573 6b74 6f70 2f65 6e76  imon/Desktop/env
+0000f090: 732f 7369 6d62 612f 7472 6f75 626c 6573  s/simba/troubles
+0000f0a0: 686f 6f74 696e 672f 6d6f 7573 655f 6f70  hooting/mouse_op
+0000f0b0: 656e 5f66 6965 6c64 2f70 726f 6a65 6374  en_field/project
+0000f0c0: 5f66 6f6c 6465 722f 7669 6465 6f73 2f53  _folder/videos/S
+0000f0d0: 495f 4441 5933 5f33 3038 5f43 4431 5f50  I_DAY3_308_CD1_P
+0000f0e0: 5245 5345 4e54 5f64 6f77 6e73 616d 706c  RESENT_downsampl
+0000f0f0: 6564 2e6d 7034 272c 0a23 2020 2020 2020  ed.mp4',.#      
+0000f100: 2020 2020 2020 2020 2020 2020 2020 7669                vi
+0000f110: 6465 6f5f 7477 6f5f 7061 7468 3d72 272f  deo_two_path=r'/
+0000f120: 5573 6572 732f 7369 6d6f 6e2f 4465 736b  Users/simon/Desk
+0000f130: 746f 702f 656e 7673 2f73 696d 6261 2f74  top/envs/simba/t
+0000f140: 726f 7562 6c65 7368 6f6f 7469 6e67 2f6d  roubleshooting/m
+0000f150: 6f75 7365 5f6f 7065 6e5f 6669 656c 642f  ouse_open_field/
+0000f160: 7072 6f6a 6563 745f 666f 6c64 6572 2f76  project_folder/v
+0000f170: 6964 656f 732f 5349 5f44 4159 335f 3330  ideos/SI_DAY3_30
+0000f180: 385f 4344 315f 5052 4553 454e 545f 646f  8_CD1_PRESENT_do
+0000f190: 776e 7361 6d70 6c65 642e 6d70 3427 2c20  wnsampled.mp4', 
+0000f1a0: 7265 736f 6c75 7469 6f6e 3d27 5669 6465  resolution='Vide
+0000f1b0: 6f5f 3127 2c0a 2320 2020 2020 2020 2020  o_1',.#         
+0000f1c0: 2020 2020 2020 2020 2020 2068 6f72 697a             horiz
+0000f1d0: 6f6e 7461 6c3d 5472 7565 2c0a 2320 2020  ontal=True,.#   
+0000f1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f1f0: 2067 7075 3d46 616c 7365 290a 0a0a 636c   gpu=False)...cl
+0000f200: 6173 7320 5669 6465 6f52 6f74 6174 6f72  ass VideoRotator
+0000f210: 2843 6f6e 6669 6752 6561 6465 7229 3a0a  (ConfigReader):.
+0000f220: 2020 2020 2222 220a 2020 2020 4755 4920      """.    GUI 
+0000f230: 546f 6f6c 2066 6f72 2072 6f74 6174 696e  Tool for rotatin
+0000f240: 6720 7669 6465 6f2e 2052 6f74 6174 6564  g video. Rotated
+0000f250: 2076 6964 656f 2069 7320 7361 7665 6420   video is saved 
+0000f260: 7769 7468 2074 6865 2060 605f 726f 7461  with the ``_rota
+0000f270: 7465 645f 4441 5445 5449 4d45 2e6d 7034  ted_DATETIME.mp4
+0000f280: 6060 2073 7566 6669 782e 0a0a 2020 2020  `` suffix...    
+0000f290: 3a70 6172 616d 6574 6572 2073 7472 2069  :parameter str i
+0000f2a0: 6e70 7574 5f70 6174 683a 2050 6174 6820  nput_path: Path 
+0000f2b0: 746f 2076 6964 656f 2074 6f20 726f 7461  to video to rota
+0000f2c0: 7465 2e0a 2020 2020 3a70 6172 616d 6574  te..    :paramet
+0000f2d0: 6572 2073 7472 206f 7574 7075 745f 6469  er str output_di
+0000f2e0: 723a 2044 6972 6563 746f 7279 2077 6865  r: Directory whe
+0000f2f0: 7265 2074 6f20 7361 7665 2074 6865 2072  re to save the r
+0000f300: 6f74 6174 6564 2076 6964 656f 2e0a 2020  otated video..  
+0000f310: 2020 3a70 6172 616d 6574 6572 204f 7074    :parameter Opt
+0000f320: 696f 6e61 6c5b 626f 6f6c 5d20 6770 753a  ional[bool] gpu:
+0000f330: 2049 6620 5472 7565 2c20 7573 6520 4646   If True, use FF
+0000f340: 4d50 4547 204e 5649 4445 4120 4750 5520  MPEG NVIDEA GPU 
+0000f350: 636f 6465 6373 2e20 456c 7365 2043 5055  codecs. Else CPU
+0000f360: 2063 6f64 6563 732e 0a20 2020 203a 7061   codecs..    :pa
+0000f370: 7261 6d65 7465 7220 4f70 7469 6f6e 616c  rameter Optional
+0000f380: 5b62 6f6f 6c5d 2067 7075 3a20 4966 2054  [bool] gpu: If T
+0000f390: 7275 652c 2075 7365 2046 4650 4d50 4547  rue, use FFPMPEG
+0000f3a0: 2e20 456c 7365 2c20 4f70 656e 4356 2e0a  . Else, OpenCV..
+0000f3b0: 0a20 2020 203a 6578 616d 706c 653a 0a20  .    :example:. 
+0000f3c0: 2020 203e 3e3e 2056 6964 656f 526f 7461     >>> VideoRota
+0000f3d0: 746f 7228 696e 7075 745f 7061 7468 3d27  tor(input_path='
+0000f3e0: 7072 6f6a 6563 745f 666f 6c64 6572 2f76  project_folder/v
+0000f3f0: 6964 656f 732f 5669 6465 6f5f 312e 6d70  ideos/Video_1.mp
+0000f400: 3427 2c20 6f75 7470 7574 5f64 6972 3d27  4', output_dir='
+0000f410: 7072 6f6a 6563 745f 666f 6c64 6572 2f76  project_folder/v
+0000f420: 6964 656f 7327 290a 2020 2020 2222 220a  ideos').    """.
+0000f430: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+0000f440: 5f28 0a20 2020 2020 2020 2073 656c 662c  _(.        self,
+0000f450: 0a20 2020 2020 2020 2069 6e70 7574 5f70  .        input_p
+0000f460: 6174 683a 2055 6e69 6f6e 5b73 7472 2c20  ath: Union[str, 
+0000f470: 6f73 2e50 6174 684c 696b 655d 2c0a 2020  os.PathLike],.  
+0000f480: 2020 2020 2020 6f75 7470 7574 5f64 6972        output_dir
+0000f490: 3a20 556e 696f 6e5b 7374 722c 206f 732e  : Union[str, os.
+0000f4a0: 5061 7468 4c69 6b65 5d2c 0a20 2020 2020  PathLike],.     
+0000f4b0: 2020 2067 7075 3a20 4f70 7469 6f6e 616c     gpu: Optional
+0000f4c0: 5b62 6f6f 6c5d 203d 2046 616c 7365 2c0a  [bool] = False,.
+0000f4d0: 2020 2020 2020 2020 6666 6d70 6567 3a20          ffmpeg: 
+0000f4e0: 4f70 7469 6f6e 616c 5b62 6f6f 6c5d 203d  Optional[bool] =
+0000f4f0: 2046 616c 7365 2c0a 2020 2020 2920 2d3e   False,.    ) ->
+0000f500: 204e 6f6e 653a 0a20 2020 2020 2020 2069   None:.        i
+0000f510: 6620 6770 7520 616e 6420 6e6f 7420 6368  f gpu and not ch
+0000f520: 6563 6b5f 6e76 6964 6561 5f67 7075 5f61  eck_nvidea_gpu_a
+0000f530: 7661 696c 6162 6c65 2829 3a0a 2020 2020  vailable():.    
+0000f540: 2020 2020 2020 2020 7261 6973 6520 4646          raise FF
+0000f550: 4d50 4547 436f 6465 6347 5055 4572 726f  MPEGCodecGPUErro
+0000f560: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+0000f570: 2020 206d 7367 3d22 4e6f 2047 5055 2066     msg="No GPU f
+0000f580: 6f75 6e64 2028 6173 2065 7661 6c75 6174  ound (as evaluat
+0000f590: 6564 2062 7920 6e76 6964 6561 2d73 6d69  ed by nvidea-smi
+0000f5a0: 2072 6574 7572 6e69 6e67 204e 6f6e 6529   returning None)
+0000f5b0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0000f5c0: 2020 2073 6f75 7263 653d 7365 6c66 2e5f     source=self._
+0000f5d0: 5f63 6c61 7373 5f5f 2e5f 5f6e 616d 655f  _class__.__name_
+0000f5e0: 5f2c 0a20 2020 2020 2020 2020 2020 2029  _,.            )
+0000f5f0: 0a20 2020 2020 2020 2069 6620 6666 6d70  .        if ffmp
+0000f600: 6567 2061 6e64 206e 6f74 2063 6865 636b  eg and not check
+0000f610: 5f66 666d 7065 675f 6176 6169 6c61 626c  _ffmpeg_availabl
+0000f620: 6528 293a 0a20 2020 2020 2020 2020 2020  e():.           
+0000f630: 2072 6169 7365 2046 464d 5045 474e 6f74   raise FFMPEGNot
+0000f640: 466f 756e 6445 7272 6f72 280a 2020 2020  FoundError(.    
+0000f650: 2020 2020 2020 2020 2020 2020 6d73 673d              msg=
+0000f660: 2746 464d 5045 4720 6e6f 7420 666f 756e  'FFMPEG not foun
+0000f670: 6420 6f6e 2074 6865 2063 6f6d 7075 7465  d on the compute
+0000f680: 7220 2861 7320 6576 616c 7561 7465 6420  r (as evaluated 
+0000f690: 6279 2022 6666 6d70 6567 2220 7265 7475  by "ffmpeg" retu
+0000f6a0: 726e 696e 6720 4e6f 6e65 2927 2c0a 2020  rning None)',.  
+0000f6b0: 2020 2020 2020 2020 2020 2020 2020 736f                so
+0000f6c0: 7572 6365 3d73 656c 662e 5f5f 636c 6173  urce=self.__clas
+0000f6d0: 735f 5f2e 5f5f 6e61 6d65 5f5f 2c0a 2020  s__.__name__,.  
+0000f6e0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0000f6f0: 2020 2020 5f2c 2073 656c 662e 6370 755f      _, self.cpu_
+0000f700: 636e 7420 3d20 6669 6e64 5f63 6f72 655f  cnt = find_core_
+0000f710: 636e 7428 290a 2020 2020 2020 2020 7365  cnt().        se
+0000f720: 6c66 2e67 7075 2c20 7365 6c66 2e66 666d  lf.gpu, self.ffm
+0000f730: 7065 6720 3d20 6770 752c 2066 666d 7065  peg = gpu, ffmpe
+0000f740: 670a 2020 2020 2020 2020 7365 6c66 2e73  g.        self.s
+0000f750: 6176 655f 6469 7220 3d20 6f75 7470 7574  ave_dir = output
+0000f760: 5f64 6972 0a20 2020 2020 2020 2073 656c  _dir.        sel
+0000f770: 662e 6461 7465 7469 6d65 203d 2064 6174  f.datetime = dat
+0000f780: 6574 696d 652e 6e6f 7728 292e 7374 7266  etime.now().strf
+0000f790: 7469 6d65 2822 2559 256d 2564 2548 254d  time("%Y%m%d%H%M
+0000f7a0: 2553 2229 0a20 2020 2020 2020 2069 6620  %S").        if 
+0000f7b0: 6f73 2e70 6174 682e 6973 6669 6c65 2869  os.path.isfile(i
+0000f7c0: 6e70 7574 5f70 6174 6829 3a0a 2020 2020  nput_path):.    
+0000f7d0: 2020 2020 2020 2020 7365 6c66 2e76 6964          self.vid
+0000f7e0: 656f 5f70 6174 6873 203d 205b 696e 7075  eo_paths = [inpu
+0000f7f0: 745f 7061 7468 5d0a 2020 2020 2020 2020  t_path].        
+0000f800: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0000f810: 2020 7365 6c66 2e76 6964 656f 5f70 6174    self.video_pat
+0000f820: 6873 203d 2066 696e 645f 616c 6c5f 7669  hs = find_all_vi
+0000f830: 6465 6f73 5f69 6e5f 6469 7265 6374 6f72  deos_in_director
+0000f840: 7928 0a20 2020 2020 2020 2020 2020 2020  y(.             
+0000f850: 2020 2064 6972 6563 746f 7279 3d69 6e70     directory=inp
+0000f860: 7574 5f70 6174 682c 2061 735f 6469 6374  ut_path, as_dict
+0000f870: 3d54 7275 650a 2020 2020 2020 2020 2020  =True.          
+0000f880: 2020 292e 7661 6c75 6573 2829 0a20 2020    ).values().   
+0000f890: 2020 2020 2020 2020 2063 6865 636b 5f69           check_i
+0000f8a0: 665f 6669 6c65 7061 7468 5f6c 6973 745f  f_filepath_list_
+0000f8b0: 6973 5f65 6d70 7479 280a 2020 2020 2020  is_empty(.      
+0000f8c0: 2020 2020 2020 2020 2020 6669 6c65 7061            filepa
+0000f8d0: 7468 733d 7365 6c66 2e76 6964 656f 5f70  ths=self.video_p
+0000f8e0: 6174 6873 2c0a 2020 2020 2020 2020 2020  aths,.          
+0000f8f0: 2020 2020 2020 6572 726f 725f 6d73 673d        error_msg=
+0000f900: 6622 4e6f 2076 6964 656f 7320 666f 756e  f"No videos foun
+0000f910: 6420 696e 207b 696e 7075 745f 7061 7468  d in {input_path
+0000f920: 7d20 6469 7265 6374 6f72 7922 2c0a 2020  } directory",.  
+0000f930: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+0000f940: 2064 6566 205f 5f69 6e73 6572 745f 696d   def __insert_im
+0000f950: 6728 7365 6c66 2c20 696d 673a 206e 702e  g(self, img: np.
+0000f960: 6172 7261 7929 3a0a 2020 2020 2020 2020  array):.        
+0000f970: 6375 7272 656e 745f 6672 6d5f 7069 6c20  current_frm_pil 
+0000f980: 3d20 496d 6167 652e 6672 6f6d 6172 7261  = Image.fromarra
+0000f990: 7928 696d 6729 0a20 2020 2020 2020 2063  y(img).        c
+0000f9a0: 7572 7265 6e74 5f66 726d 5f70 696c 2e74  urrent_frm_pil.t
+0000f9b0: 6875 6d62 6e61 696c 284d 4158 5f46 524d  humbnail(MAX_FRM
+0000f9c0: 5f53 495a 452c 2049 6d61 6765 2e41 4e54  _SIZE, Image.ANT
+0000f9d0: 4941 4c49 4153 290a 2020 2020 2020 2020  IALIAS).        
+0000f9e0: 6375 7272 656e 745f 6672 6d5f 7069 6c20  current_frm_pil 
+0000f9f0: 3d20 496d 6167 6554 6b2e 5068 6f74 6f49  = ImageTk.PhotoI
+0000fa00: 6d61 6765 280a 2020 2020 2020 2020 2020  mage(.          
+0000fa10: 2020 6d61 7374 6572 3d73 656c 662e 6d61    master=self.ma
+0000fa20: 696e 5f66 726d 2c20 696d 6167 653d 6375  in_frm, image=cu
+0000fa30: 7272 656e 745f 6672 6d5f 7069 6c0a 2020  rrent_frm_pil.  
+0000fa40: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0000fa50: 7365 6c66 2e76 6964 656f 5f66 7261 6d65  self.video_frame
+0000fa60: 203d 204c 6162 656c 2873 656c 662e 6d61   = Label(self.ma
+0000fa70: 696e 5f66 726d 2c20 696d 6167 653d 6375  in_frm, image=cu
+0000fa80: 7272 656e 745f 6672 6d5f 7069 6c29 0a20  rrent_frm_pil). 
+0000fa90: 2020 2020 2020 2073 656c 662e 7669 6465         self.vide
+0000faa0: 6f5f 6672 616d 652e 696d 6167 6520 3d20  o_frame.image = 
+0000fab0: 6375 7272 656e 745f 6672 6d5f 7069 6c0a  current_frm_pil.
+0000fac0: 2020 2020 2020 2020 7365 6c66 2e76 6964          self.vid
+0000fad0: 656f 5f66 7261 6d65 2e67 7269 6428 726f  eo_frame.grid(ro
+0000fae0: 773d 302c 2063 6f6c 756d 6e3d 3029 0a0a  w=0, column=0)..
+0000faf0: 2020 2020 6465 6620 5f5f 726f 7461 7465      def __rotate
+0000fb00: 2873 656c 662c 2076 616c 7565 3a20 696e  (self, value: in
+0000fb10: 742c 2069 6d67 3a20 6e70 2e61 7272 6179  t, img: np.array
+0000fb20: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
+0000fb30: 6469 665f 616e 676c 6520 2b3d 2076 616c  dif_angle += val
+0000fb40: 7565 0a20 2020 2020 2020 2072 6f74 6174  ue.        rotat
+0000fb50: 696f 6e5f 6d61 7472 6978 203d 2063 7632  ion_matrix = cv2
+0000fb60: 2e67 6574 526f 7461 7469 6f6e 4d61 7472  .getRotationMatr
+0000fb70: 6978 3244 280a 2020 2020 2020 2020 2020  ix2D(.          
+0000fb80: 2020 2873 656c 662e 7669 6465 6f5f 6d65    (self.video_me
+0000fb90: 7461 5f64 6174 615b 2277 6964 7468 225d  ta_data["width"]
+0000fba0: 202f 2032 2c20 7365 6c66 2e76 6964 656f   / 2, self.video
+0000fbb0: 5f6d 6574 615f 6461 7461 5b22 6865 6967  _meta_data["heig
+0000fbc0: 6874 225d 202f 2032 292c 0a20 2020 2020  ht"] / 2),.     
+0000fbd0: 2020 2020 2020 2073 656c 662e 6469 665f         self.dif_
+0000fbe0: 616e 676c 652c 0a20 2020 2020 2020 2020  angle,.         
+0000fbf0: 2020 2031 2c0a 2020 2020 2020 2020 290a     1,.        ).
+0000fc00: 2020 2020 2020 2020 696d 6720 3d20 6376          img = cv
+0000fc10: 322e 7761 7270 4166 6669 6e65 280a 2020  2.warpAffine(.  
+0000fc20: 2020 2020 2020 2020 2020 696d 672c 0a20            img,. 
+0000fc30: 2020 2020 2020 2020 2020 2072 6f74 6174             rotat
+0000fc40: 696f 6e5f 6d61 7472 6978 2c0a 2020 2020  ion_matrix,.    
+0000fc50: 2020 2020 2020 2020 2873 656c 662e 7669          (self.vi
+0000fc60: 6465 6f5f 6d65 7461 5f64 6174 615b 2277  deo_meta_data["w
+0000fc70: 6964 7468 225d 2c20 7365 6c66 2e76 6964  idth"], self.vid
+0000fc80: 656f 5f6d 6574 615f 6461 7461 5b22 6865  eo_meta_data["he
+0000fc90: 6967 6874 225d 292c 0a20 2020 2020 2020  ight"]),.       
+0000fca0: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
+0000fcb0: 5f5f 696e 7365 7274 5f69 6d67 2869 6d67  __insert_img(img
+0000fcc0: 3d69 6d67 290a 0a20 2020 2064 6566 205f  =img)..    def _
+0000fcd0: 5f72 756e 5f72 6f74 6174 696f 6e28 7365  _run_rotation(se
+0000fce0: 6c66 293a 0a20 2020 2020 2020 2073 656c  lf):.        sel
+0000fcf0: 662e 6d61 696e 5f66 726d 2e64 6573 7472  f.main_frm.destr
+0000fd00: 6f79 2829 0a20 2020 2020 2020 2073 7461  oy().        sta
+0000fd10: 7274 203d 2074 696d 652e 7469 6d65 2829  rt = time.time()
+0000fd20: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+0000fd30: 2e66 666d 7065 6720 6f72 2073 656c 662e  .ffmpeg or self.
+0000fd40: 6770 753a 0a20 2020 2020 2020 2020 2020  gpu:.           
+0000fd50: 2066 6f72 2076 6964 656f 5f63 6e74 2c20   for video_cnt, 
+0000fd60: 2876 6964 656f 5f70 6174 682c 2072 6f74  (video_path, rot
+0000fd70: 6174 696f 6e29 2069 6e20 656e 756d 6572  ation) in enumer
+0000fd80: 6174 6528 7365 6c66 2e72 6573 756c 7473  ate(self.results
+0000fd90: 2e69 7465 6d73 2829 293a 0a20 2020 2020  .items()):.     
+0000fda0: 2020 2020 2020 2020 2020 205f 2c20 6e61             _, na
+0000fdb0: 6d65 2c20 5f20 3d20 6765 745f 666e 5f65  me, _ = get_fn_e
+0000fdc0: 7874 2866 696c 6570 6174 683d 7669 6465  xt(filepath=vide
+0000fdd0: 6f5f 7061 7468 290a 2020 2020 2020 2020  o_path).        
+0000fde0: 2020 2020 2020 2020 7361 7665 5f70 6174          save_pat
+0000fdf0: 6820 3d20 6f73 2e70 6174 682e 6a6f 696e  h = os.path.join
+0000fe00: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000fe10: 2020 2020 2020 7365 6c66 2e73 6176 655f        self.save_
+0000fe20: 6469 722c 2066 227b 6e61 6d65 7d5f 726f  dir, f"{name}_ro
+0000fe30: 7461 7465 645f 7b73 656c 662e 6461 7465  tated_{self.date
+0000fe40: 7469 6d65 7d2e 6d70 3422 0a20 2020 2020  time}.mp4".     
+0000fe50: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0000fe60: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0000fe70: 7365 6c66 2e67 7075 3a0a 2020 2020 2020  self.gpu:.      
+0000fe80: 2020 2020 2020 2020 2020 2020 2020 636d                cm
+0000fe90: 6420 3d20 6627 6666 6d70 6567 202d 6877  d = f'ffmpeg -hw
+0000fea0: 6163 6365 6c20 6175 746f 202d 6920 7b76  accel auto -i {v
+0000feb0: 6964 656f 5f70 6174 687d 202d 7666 2022  ideo_path} -vf "
+0000fec0: 6877 7570 6c6f 6164 5f63 7564 612c 726f  hwupload_cuda,ro
+0000fed0: 7461 7465 3d7b 726f 7461 7469 6f6e 7d2a  tate={rotation}*
+0000fee0: 2850 492f 3138 3029 2c66 6f72 6d61 743d  (PI/180),format=
+0000fef0: 6e76 3132 7c63 7564 6122 202d 633a 7620  nv12|cuda" -c:v 
+0000ff00: 6832 3634 5f6e 7665 6e63 207b 7361 7665  h264_nvenc {save
+0000ff10: 5f70 6174 687d 202d 7927 0a20 2020 2020  _path} -y'.     
+0000ff20: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0000ff30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ff40: 2020 2020 2063 6d64 203d 2066 2766 666d       cmd = f'ffm
+0000ff50: 7065 6720 2d69 207b 7669 6465 6f5f 7061  peg -i {video_pa
+0000ff60: 7468 7d20 2d76 6620 2272 6f74 6174 653d  th} -vf "rotate=
+0000ff70: 7b72 6f74 6174 696f 6e7d 2a28 5049 2f31  {rotation}*(PI/1
+0000ff80: 3830 2922 207b 7361 7665 5f70 6174 687d  80)" {save_path}
+0000ff90: 202d 7927 0a20 2020 2020 2020 2020 2020   -y'.           
+0000ffa0: 2020 2020 2073 7562 7072 6f63 6573 732e       subprocess.
+0000ffb0: 6361 6c6c 2863 6d64 2c20 7368 656c 6c3d  call(cmd, shell=
+0000ffc0: 5472 7565 2c20 7374 646f 7574 3d73 7562  True, stdout=sub
+0000ffd0: 7072 6f63 6573 732e 5049 5045 290a 2020  process.PIPE).  
+0000ffe0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000fff0: 2020 2020 2020 2020 666f 7220 7669 6465          for vide
+00010000: 6f5f 636e 742c 2028 7669 6465 6f5f 7061  o_cnt, (video_pa
+00010010: 7468 2c20 726f 7461 7469 6f6e 2920 696e  th, rotation) in
+00010020: 2065 6e75 6d65 7261 7465 2873 656c 662e   enumerate(self.
+00010030: 7265 7375 6c74 732e 6974 656d 7328 2929  results.items())
+00010040: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00010050: 2020 6361 7020 3d20 6376 322e 5669 6465    cap = cv2.Vide
+00010060: 6f43 6170 7475 7265 2876 6964 656f 5f70  oCapture(video_p
+00010070: 6174 6829 0a20 2020 2020 2020 2020 2020  ath).           
+00010080: 2020 2020 205f 2c20 6e61 6d65 2c20 5f20       _, name, _ 
+00010090: 3d20 6765 745f 666e 5f65 7874 2866 696c  = get_fn_ext(fil
+000100a0: 6570 6174 683d 7669 6465 6f5f 7061 7468  epath=video_path
+000100b0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000100c0: 2020 726f 7461 7469 6f6e 5f6d 6174 7269    rotation_matri
+000100d0: 7820 3d20 6376 322e 6765 7452 6f74 6174  x = cv2.getRotat
+000100e0: 696f 6e4d 6174 7269 7832 4428 0a20 2020  ionMatrix2D(.   
+000100f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010100: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+00010110: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00010120: 7669 6465 6f5f 6d65 7461 5f64 6174 615b  video_meta_data[
+00010130: 2277 6964 7468 225d 202f 2032 2c0a 2020  "width"] / 2,.  
+00010140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010150: 2020 2020 2020 7365 6c66 2e76 6964 656f        self.video
+00010160: 5f6d 6574 615f 6461 7461 5b22 6865 6967  _meta_data["heig
+00010170: 6874 225d 202f 2032 2c0a 2020 2020 2020  ht"] / 2,.      
+00010180: 2020 2020 2020 2020 2020 2020 2020 292c                ),
+00010190: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000101a0: 2020 2020 2072 6f74 6174 696f 6e2c 0a20       rotation,. 
+000101b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000101c0: 2020 2031 2c0a 2020 2020 2020 2020 2020     1,.          
+000101d0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000101e0: 2020 2020 2020 2020 7361 7665 5f70 6174          save_pat
+000101f0: 6820 3d20 6f73 2e70 6174 682e 6a6f 696e  h = os.path.join
+00010200: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00010210: 2020 2020 2020 7365 6c66 2e73 6176 655f        self.save_
+00010220: 6469 722c 2066 227b 6e61 6d65 7d5f 726f  dir, f"{name}_ro
+00010230: 7461 7465 645f 7b73 656c 662e 6461 7465  tated_{self.date
+00010240: 7469 6d65 7d2e 6d70 3422 0a20 2020 2020  time}.mp4".     
+00010250: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00010260: 2020 2020 2020 2020 2020 2020 2076 6964               vid
+00010270: 656f 5f6d 6574 6120 3d20 6765 745f 7669  eo_meta = get_vi
+00010280: 6465 6f5f 6d65 7461 5f64 6174 6128 7669  deo_meta_data(vi
+00010290: 6465 6f5f 7061 7468 3d76 6964 656f 5f70  deo_path=video_p
+000102a0: 6174 6829 0a20 2020 2020 2020 2020 2020  ath).           
+000102b0: 2020 2020 2066 6f75 7263 6320 3d20 6376       fourcc = cv
+000102c0: 322e 5669 6465 6f57 7269 7465 725f 666f  2.VideoWriter_fo
+000102d0: 7572 6363 282a 466f 726d 6174 732e 4d50  urcc(*Formats.MP
+000102e0: 345f 434f 4445 432e 7661 6c75 6529 0a20  4_CODEC.value). 
+000102f0: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+00010300: 7269 7465 7220 3d20 6376 322e 5669 6465  riter = cv2.Vide
+00010310: 6f57 7269 7465 7228 0a20 2020 2020 2020  oWriter(.       
+00010320: 2020 2020 2020 2020 2020 2020 2073 6176               sav
+00010330: 655f 7061 7468 2c0a 2020 2020 2020 2020  e_path,.        
+00010340: 2020 2020 2020 2020 2020 2020 666f 7572              four
+00010350: 6363 2c0a 2020 2020 2020 2020 2020 2020  cc,.            
+00010360: 2020 2020 2020 2020 7669 6465 6f5f 6d65          video_me
+00010370: 7461 5b22 6670 7322 5d2c 0a20 2020 2020  ta["fps"],.     
+00010380: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+00010390: 7669 6465 6f5f 6d65 7461 5b22 7769 6474  video_meta["widt
+000103a0: 6822 5d2c 2076 6964 656f 5f6d 6574 615b  h"], video_meta[
+000103b0: 2268 6569 6768 7422 5d29 2c0a 2020 2020  "height"]),.    
+000103c0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+000103d0: 2020 2020 2020 2020 2020 2020 2020 696d                im
+000103e0: 675f 636e 7420 3d20 300a 2020 2020 2020  g_cnt = 0.      
+000103f0: 2020 2020 2020 2020 2020 7768 696c 6520            while 
+00010400: 5472 7565 3a0a 2020 2020 2020 2020 2020  True:.          
+00010410: 2020 2020 2020 2020 2020 7265 742c 2069            ret, i
+00010420: 6d67 203d 2063 6170 2e72 6561 6428 290a  mg = cap.read().
+00010430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010440: 2020 2020 6966 206e 6f74 2072 6574 3a0a      if not ret:.
+00010450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010460: 2020 2020 2020 2020 6272 6561 6b0a 2020          break.  
+00010470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010480: 2020 696d 6720 3d20 6376 322e 7761 7270    img = cv2.warp
+00010490: 4166 6669 6e65 280a 2020 2020 2020 2020  Affine(.        
+000104a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000104b0: 696d 672c 0a20 2020 2020 2020 2020 2020  img,.           
+000104c0: 2020 2020 2020 2020 2020 2020 2072 6f74               rot
+000104d0: 6174 696f 6e5f 6d61 7472 6978 2c0a 2020  ation_matrix,.  
+000104e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000104f0: 2020 2020 2020 2873 656c 662e 7669 6465        (self.vide
+00010500: 6f5f 6d65 7461 5f64 6174 615b 2277 6964  o_meta_data["wid
+00010510: 7468 225d 2c20 7365 6c66 2e76 6964 656f  th"], self.video
+00010520: 5f6d 6574 615f 6461 7461 5b22 6865 6967  _meta_data["heig
+00010530: 6874 225d 292c 0a20 2020 2020 2020 2020  ht"]),.         
+00010540: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00010550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010560: 2077 7269 7465 722e 7772 6974 6528 696d   writer.write(im
+00010570: 6729 0a20 2020 2020 2020 2020 2020 2020  g).             
+00010580: 2020 2020 2020 2069 6d67 5f63 6e74 202b         img_cnt +
+00010590: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
+000105a0: 2020 2020 2020 2020 7072 696e 7428 0a20          print(. 
+000105b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000105c0: 2020 2020 2020 2066 2752 6f74 6174 696e         f'Rotatin
+000105d0: 6720 6672 616d 6520 7b69 6d67 5f63 6e74  g frame {img_cnt
+000105e0: 7d2f 7b76 6964 656f 5f6d 6574 615b 2266  }/{video_meta["f
+000105f0: 7261 6d65 5f63 6f75 6e74 225d 7d20 2856  rame_count"]} (V
+00010600: 6964 656f 207b 7669 6465 6f5f 636e 7420  ideo {video_cnt 
+00010610: 2b20 317d 2f7b 6c65 6e28 7365 6c66 2e72  + 1}/{len(self.r
+00010620: 6573 756c 7473 2e6b 6579 7328 2929 7d29  esults.keys())})
+00010630: 2027 0a20 2020 2020 2020 2020 2020 2020   '.             
+00010640: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00010650: 2020 2020 2020 2020 2063 6170 2e72 656c           cap.rel
+00010660: 6561 7365 2829 0a20 2020 2020 2020 2020  ease().         
+00010670: 2020 2020 2020 2077 7269 7465 722e 7265         writer.re
+00010680: 6c65 6173 6528 290a 2020 2020 2020 2020  lease().        
+00010690: 7374 646f 7574 5f73 7563 6365 7373 280a  stdout_success(.
+000106a0: 2020 2020 2020 2020 2020 2020 6d73 673d              msg=
+000106b0: 6622 416c 6c20 7669 6465 6f73 2072 6f74  f"All videos rot
+000106c0: 6174 6564 2061 6e64 2073 6176 6564 2069  ated and saved i
+000106d0: 6e20 7b73 656c 662e 7361 7665 5f64 6972  n {self.save_dir
+000106e0: 7d22 2c0a 2020 2020 2020 2020 2020 2020  }",.            
+000106f0: 656c 6170 7365 645f 7469 6d65 3d73 7472  elapsed_time=str
+00010700: 2872 6f75 6e64 2828 7469 6d65 2e74 696d  (round((time.tim
+00010710: 6528 2920 2d20 7374 6172 7429 2c20 3229  e() - start), 2)
+00010720: 292c 0a20 2020 2020 2020 2020 2020 2073  ),.            s
+00010730: 6f75 7263 653d 7365 6c66 2e5f 5f63 6c61  ource=self.__cla
+00010740: 7373 5f5f 2e5f 5f6e 616d 655f 5f2c 0a20  ss__.__name__,. 
+00010750: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+00010760: 6620 5f5f 7361 7665 2873 656c 6629 3a0a  f __save(self):.
+00010770: 2020 2020 2020 2020 7072 6f63 6573 7320          process 
+00010780: 3d20 4e6f 6e65 0a20 2020 2020 2020 2073  = None.        s
+00010790: 656c 662e 7265 7375 6c74 735b 7365 6c66  elf.results[self
+000107a0: 2e66 696c 655f 7061 7468 5d20 3d20 7365  .file_path] = se
+000107b0: 6c66 2e64 6966 5f61 6e67 6c65 0a20 2020  lf.dif_angle.   
+000107c0: 2020 2020 2069 6620 6c65 6e28 7365 6c66       if len(self
+000107d0: 2e72 6573 756c 7473 2e6b 6579 7328 2929  .results.keys())
+000107e0: 203d 3d20 6c65 6e28 7365 6c66 2e76 6964   == len(self.vid
+000107f0: 656f 5f70 6174 6873 293a 0a20 2020 2020  eo_paths):.     
+00010800: 2020 2020 2020 2070 726f 6365 7373 203d         process =
+00010810: 206d 756c 7469 7072 6f63 6573 7369 6e67   multiprocessing
+00010820: 2e50 726f 6365 7373 2874 6172 6765 743d  .Process(target=
+00010830: 7365 6c66 2e5f 5f72 756e 5f72 6f74 6174  self.__run_rotat
+00010840: 696f 6e28 2929 0a20 2020 2020 2020 2020  ion()).         
+00010850: 2020 2070 726f 6365 7373 2e73 7461 7274     process.start
+00010860: 2829 0a20 2020 2020 2020 2065 6c73 653a  ().        else:
+00010870: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00010880: 662e 5f5f 7275 6e5f 696e 7465 7266 6163  f.__run_interfac
+00010890: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+000108a0: 2020 2066 696c 655f 7061 7468 3d73 656c     file_path=sel
+000108b0: 662e 7669 6465 6f5f 7061 7468 735b 6c65  f.video_paths[le
+000108c0: 6e28 7365 6c66 2e72 6573 756c 7473 2e6b  n(self.results.k
+000108d0: 6579 7328 2929 202d 2031 5d0a 2020 2020  eys()) - 1].    
+000108e0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000108f0: 2020 6966 2070 726f 6365 7373 2069 7320    if process is 
+00010900: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00010910: 2020 2020 2020 7072 6f63 6573 732e 6a6f        process.jo
+00010920: 696e 2829 0a0a 2020 2020 6465 6620 5f5f  in()..    def __
+00010930: 6269 6e64 5f6b 6579 7328 7365 6c66 293a  bind_keys(self):
+00010940: 0a20 2020 2020 2020 2073 656c 662e 6d61  .        self.ma
+00010950: 696e 5f66 726d 2e62 696e 6428 0a20 2020  in_frm.bind(.   
+00010960: 2020 2020 2020 2020 2022 3c4c 6566 743e           "<Left>
+00010970: 222c 206c 616d 6264 6120 783a 2073 656c  ", lambda x: sel
+00010980: 662e 5f5f 726f 7461 7465 2876 616c 7565  f.__rotate(value
+00010990: 3d31 2c20 696d 673d 7365 6c66 2e5f 6f72  =1, img=self._or
+000109a0: 6967 5f69 6d67 290a 2020 2020 2020 2020  ig_img).        
+000109b0: 290a 2020 2020 2020 2020 7365 6c66 2e6d  ).        self.m
+000109c0: 6169 6e5f 6672 6d2e 6269 6e64 280a 2020  ain_frm.bind(.  
+000109d0: 2020 2020 2020 2020 2020 223c 5269 6768            "<Righ
+000109e0: 743e 222c 206c 616d 6264 6120 783a 2073  t>", lambda x: s
+000109f0: 656c 662e 5f5f 726f 7461 7465 2876 616c  elf.__rotate(val
+00010a00: 7565 3d2d 312c 2069 6d67 3d73 656c 662e  ue=-1, img=self.
+00010a10: 5f6f 7269 675f 696d 6729 0a20 2020 2020  _orig_img).     
+00010a20: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
+00010a30: 662e 6d61 696e 5f66 726d 2e62 696e 6428  f.main_frm.bind(
+00010a40: 223c 4573 6361 7065 3e22 2c20 6c61 6d62  "<Escape>", lamb
+00010a50: 6461 2078 3a20 7365 6c66 2e5f 5f73 6176  da x: self.__sav
+00010a60: 6528 2929 0a0a 2020 2020 6465 6620 5f5f  e())..    def __
+00010a70: 7275 6e5f 696e 7465 7266 6163 6528 7365  run_interface(se
+00010a80: 6c66 2c20 6669 6c65 5f70 6174 683a 2073  lf, file_path: s
+00010a90: 7472 293a 0a20 2020 2020 2020 2073 656c  tr):.        sel
+00010aa0: 662e 6469 665f 616e 676c 6520 3d20 300a  f.dif_angle = 0.
+00010ab0: 2020 2020 2020 2020 7072 696e 7428 6669          print(fi
+00010ac0: 6c65 5f70 6174 6829 0a20 2020 2020 2020  le_path).       
+00010ad0: 2073 656c 662e 7669 6465 6f5f 6d65 7461   self.video_meta
+00010ae0: 5f64 6174 6120 3d20 6765 745f 7669 6465  _data = get_vide
+00010af0: 6f5f 6d65 7461 5f64 6174 6128 7669 6465  o_meta_data(vide
+00010b00: 6f5f 7061 7468 3d66 696c 655f 7061 7468  o_path=file_path
+00010b10: 290a 2020 2020 2020 2020 7365 6c66 2e66  ).        self.f
+00010b20: 696c 655f 7061 7468 203d 2066 696c 655f  ile_path = file_
+00010b30: 7061 7468 0a20 2020 2020 2020 205f 2c20  path.        _, 
+00010b40: 7365 6c66 2e76 6964 656f 5f6e 616d 652c  self.video_name,
+00010b50: 205f 203d 2067 6574 5f66 6e5f 6578 7428   _ = get_fn_ext(
+00010b60: 6669 6c65 7061 7468 3d66 696c 655f 7061  filepath=file_pa
+00010b70: 7468 290a 2020 2020 2020 2020 7365 6c66  th).        self
+00010b80: 2e6d 6169 6e5f 6672 6d20 3d20 546f 706c  .main_frm = Topl
+00010b90: 6576 656c 2829 0a20 2020 2020 2020 2073  evel().        s
+00010ba0: 656c 662e 6d61 696e 5f66 726d 2e74 6974  elf.main_frm.tit
+00010bb0: 6c65 2866 2252 4f54 4154 4520 5649 4445  le(f"ROTATE VIDE
+00010bc0: 4f20 7b73 656c 662e 7669 6465 6f5f 6e61  O {self.video_na
+00010bd0: 6d65 7d22 290a 2020 2020 2020 2020 7365  me}").        se
+00010be0: 6c66 2e76 6964 656f 5f66 726d 203d 2046  lf.video_frm = F
+00010bf0: 7261 6d65 2873 656c 662e 6d61 696e 5f66  rame(self.main_f
+00010c00: 726d 290a 2020 2020 2020 2020 7365 6c66  rm).        self
+00010c10: 2e76 6964 656f 5f66 726d 2e67 7269 6428  .video_frm.grid(
+00010c20: 726f 773d 302c 2063 6f6c 756d 6e3d 3029  row=0, column=0)
+00010c30: 0a20 2020 2020 2020 2073 656c 662e 696e  .        self.in
+00010c40: 7374 7275 6374 696f 6e5f 6672 6d20 3d20  struction_frm = 
+00010c50: 4672 616d 6528 7365 6c66 2e6d 6169 6e5f  Frame(self.main_
+00010c60: 6672 6d2c 2077 6964 7468 3d31 3030 2c20  frm, width=100, 
+00010c70: 6865 6967 6874 3d31 3030 290a 2020 2020  height=100).    
+00010c80: 2020 2020 7365 6c66 2e69 6e73 7472 7563      self.instruc
+00010c90: 7469 6f6e 5f66 726d 2e67 7269 6428 726f  tion_frm.grid(ro
+00010ca0: 773d 302c 2063 6f6c 756d 6e3d 322c 2073  w=0, column=2, s
+00010cb0: 7469 636b 793d 4e57 290a 2020 2020 2020  ticky=NW).      
+00010cc0: 2020 7365 6c66 2e6b 6579 5f6c 626c 7320    self.key_lbls 
+00010cd0: 3d20 4c61 6265 6c28 0a20 2020 2020 2020  = Label(.       
+00010ce0: 2020 2020 2073 656c 662e 696e 7374 7275       self.instru
+00010cf0: 6374 696f 6e5f 6672 6d2c 0a20 2020 2020  ction_frm,.     
+00010d00: 2020 2020 2020 2074 6578 743d 225c 6e5c         text="\n\
+00010d10: 6e20 4e61 7669 6761 7469 6f6e 3a20 220a  n Navigation: ".
+00010d20: 2020 2020 2020 2020 2020 2020 225c 6e20              "\n 
+00010d30: 4c65 6674 2061 7272 6f77 203d 2031 c2b0  Left arrow = 1..
+00010d40: 206c 6566 7422 0a20 2020 2020 2020 2020   left".         
+00010d50: 2020 2022 5c6e 2052 6967 6874 2061 7272     "\n Right arr
+00010d60: 6f77 203d 2031 c2b0 2072 6967 6874 220a  ow = 1.. right".
+00010d70: 2020 2020 2020 2020 2020 2020 225c 6e20              "\n 
+00010d80: 4573 6320 3d20 5361 7665 222c 0a20 2020  Esc = Save",.   
+00010d90: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00010da0: 7365 6c66 2e6b 6579 5f6c 626c 732e 6772  self.key_lbls.gr
+00010db0: 6964 2873 7469 636b 793d 4e57 290a 2020  id(sticky=NW).  
+00010dc0: 2020 2020 2020 7365 6c66 2e63 6170 203d        self.cap =
+00010dd0: 2063 7632 2e56 6964 656f 4361 7074 7572   cv2.VideoCaptur
+00010de0: 6528 6669 6c65 5f70 6174 6829 0a20 2020  e(file_path).   
+00010df0: 2020 2020 205f 2c20 7365 6c66 2e69 6d67       _, self.img
+00010e00: 203d 2073 656c 662e 6361 702e 7265 6164   = self.cap.read
+00010e10: 2829 0a20 2020 2020 2020 2073 656c 662e  ().        self.
+00010e20: 5f6f 7269 675f 696d 6720 3d20 6376 322e  _orig_img = cv2.
+00010e30: 6376 7443 6f6c 6f72 2873 656c 662e 696d  cvtColor(self.im
+00010e40: 672c 2063 7632 2e43 4f4c 4f52 5f52 4742  g, cv2.COLOR_RGB
+00010e50: 3242 4752 290a 2020 2020 2020 2020 7365  2BGR).        se
+00010e60: 6c66 2e5f 5f69 6e73 6572 745f 696d 6728  lf.__insert_img(
+00010e70: 696d 673d 7365 6c66 2e5f 6f72 6967 5f69  img=self._orig_i
+00010e80: 6d67 290a 2020 2020 2020 2020 7365 6c66  mg).        self
+00010e90: 2e5f 5f62 696e 645f 6b65 7973 2829 0a0a  .__bind_keys()..
+00010ea0: 2020 2020 6465 6620 7275 6e28 7365 6c66      def run(self
+00010eb0: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
+00010ec0: 7265 7375 6c74 7320 3d20 7b7d 0a20 2020  results = {}.   
+00010ed0: 2020 2020 2066 6f72 2076 6964 656f 5f70       for video_p
+00010ee0: 6174 6820 696e 2073 656c 662e 7669 6465  ath in self.vide
+00010ef0: 6f5f 7061 7468 733a 0a20 2020 2020 2020  o_paths:.       
+00010f00: 2020 2020 2073 656c 662e 5f5f 7275 6e5f       self.__run_
+00010f10: 696e 7465 7266 6163 6528 7669 6465 6f5f  interface(video_
+00010f20: 7061 7468 290a 2020 2020 2020 2020 7365  path).        se
+00010f30: 6c66 2e6d 6169 6e5f 6672 6d2e 6d61 696e  lf.main_frm.main
+00010f40: 6c6f 6f70 2829 0a0a 0a64 6566 2065 7874  loop()...def ext
+00010f50: 7261 6374 5f66 7261 6d65 735f 6672 6f6d  ract_frames_from
+00010f60: 5f61 6c6c 5f76 6964 656f 735f 696e 5f64  _all_videos_in_d
+00010f70: 6972 6563 746f 7279 280a 2020 2020 636f  irectory(.    co
+00010f80: 6e66 6967 5f70 6174 683a 2055 6e69 6f6e  nfig_path: Union
+00010f90: 5b73 7472 2c20 6f73 2e50 6174 684c 696b  [str, os.PathLik
+00010fa0: 655d 2c20 6469 7265 6374 6f72 793a 2055  e], directory: U
+00010fb0: 6e69 6f6e 5b73 7472 2c20 6f73 2e50 6174  nion[str, os.Pat
+00010fc0: 684c 696b 655d 0a29 202d 3e20 4e6f 6e65  hLike].) -> None
+00010fd0: 3a0a 2020 2020 2222 220a 2020 2020 4578  :.    """.    Ex
+00010fe0: 7472 6163 7420 616c 6c20 6672 616d 6573  tract all frames
+00010ff0: 2066 726f 6d20 616c 6c20 7669 6465 6f73   from all videos
+00011000: 2069 6e20 6120 6469 7265 6374 6f72 792e   in a directory.
+00011010: 2054 6865 2072 6573 756c 7473 2061 7265   The results are
+00011020: 2073 6176 6564 2069 6e20 7468 6520 7072   saved in the pr
+00011030: 6f6a 6563 745f 666f 6c64 6572 2f66 7261  oject_folder/fra
+00011040: 6d65 732f 696e 7075 7420 6469 7265 6374  mes/input direct
+00011050: 6f72 7920 6f66 2074 6865 2053 696d 4241  ory of the SimBA
+00011060: 2070 726f 6a65 6374 0a0a 2020 2020 3a70   project..    :p
+00011070: 6172 616d 6574 6572 2073 7472 2063 6f6e  arameter str con
+00011080: 6669 675f 7061 7468 3a20 7061 7468 2074  fig_path: path t
+00011090: 6f20 5369 6d42 4120 7072 6f6a 6563 7420  o SimBA project 
+000110a0: 636f 6e66 6967 2066 696c 6520 696e 2043  config file in C
+000110b0: 6f6e 6669 6770 6172 7365 7220 666f 726d  onfigparser form
+000110c0: 6174 2e0a 2020 2020 3a70 6172 616d 6574  at..    :paramet
+000110d0: 6572 2073 7472 2064 6972 6563 746f 7279  er str directory
+000110e0: 3a20 7061 7468 2074 6f20 6669 6c65 206f  : path to file o
+000110f0: 7220 666f 6c64 6572 2063 6f6e 7461 696e  r folder contain
+00011100: 696e 6720 7669 6465 6f73 2069 6e20 6d70  ing videos in mp
+00011110: 3420 616e 642f 6f72 2061 7669 2066 6f72  4 and/or avi for
+00011120: 6d61 742e 0a0a 2020 2020 3a65 7861 6d70  mat...    :examp
+00011130: 6c65 3a0a 2020 2020 3e3e 3e20 6578 7472  le:.    >>> extr
+00011140: 6163 745f 6672 616d 6573 5f66 726f 6d5f  act_frames_from_
+00011150: 616c 6c5f 7669 6465 6f73 5f69 6e5f 6469  all_videos_in_di
+00011160: 7265 6374 6f72 7928 636f 6e66 6967 5f70  rectory(config_p
+00011170: 6174 683d 2770 726f 6a65 6374 5f66 6f6c  ath='project_fol
+00011180: 6465 722f 7072 6f6a 6563 745f 636f 6e66  der/project_conf
+00011190: 6967 2e69 6e69 272c 2073 6f75 7263 653d  ig.ini', source=
+000111a0: 272f 7465 7374 732f 7465 7374 5f64 6174  '/tests/test_dat
+000111b0: 612f 7669 6465 6f5f 7465 7374 7327 290a  a/video_tests').
+000111c0: 2020 2020 2222 220a 0a20 2020 2074 696d      """..    tim
+000111d0: 6572 203d 2053 696d 6261 5469 6d65 7228  er = SimbaTimer(
+000111e0: 7374 6172 743d 5472 7565 290a 2020 2020  start=True).    
+000111f0: 7669 6465 6f5f 7061 7468 732c 2076 6964  video_paths, vid
+00011200: 656f 5f74 7970 6573 203d 205b 5d2c 205b  eo_types = [], [
+00011210: 222e 6176 6922 2c20 222e 6d70 3422 5d0a  ".avi", ".mp4"].
+00011220: 2020 2020 6669 6c65 735f 696e 5f66 6f6c      files_in_fol
+00011230: 6465 7220 3d20 676c 6f62 2e67 6c6f 6228  der = glob.glob(
+00011240: 6469 7265 6374 6f72 7920 2b20 222f 2a22  directory + "/*"
+00011250: 290a 2020 2020 666f 7220 6669 6c65 5f70  ).    for file_p
+00011260: 6174 6820 696e 2066 696c 6573 5f69 6e5f  ath in files_in_
+00011270: 666f 6c64 6572 3a0a 2020 2020 2020 2020  folder:.        
+00011280: 5f2c 205f 2c20 6578 7420 3d20 6765 745f  _, _, ext = get_
+00011290: 666e 5f65 7874 2866 696c 6570 6174 683d  fn_ext(filepath=
+000112a0: 6669 6c65 5f70 6174 6829 0a20 2020 2020  file_path).     
+000112b0: 2020 2069 6620 6578 742e 6c6f 7765 7228     if ext.lower(
+000112c0: 2920 696e 2076 6964 656f 5f74 7970 6573  ) in video_types
+000112d0: 3a0a 2020 2020 2020 2020 2020 2020 7669  :.            vi
+000112e0: 6465 6f5f 7061 7468 732e 6170 7065 6e64  deo_paths.append
+000112f0: 2866 696c 655f 7061 7468 290a 2020 2020  (file_path).    
+00011300: 6966 206c 656e 2876 6964 656f 5f70 6174  if len(video_pat
+00011310: 6873 2920 3d3d 2030 3a0a 2020 2020 2020  hs) == 0:.      
+00011320: 2020 7261 6973 6520 4e6f 4669 6c65 7346    raise NoFilesF
+00011330: 6f75 6e64 4572 726f 7228 0a20 2020 2020  oundError(.     
+00011340: 2020 2020 2020 206d 7367 3d66 2253 494d         msg=f"SIM
+00011350: 4241 2045 5252 4f52 3a20 3020 7669 6465  BA ERROR: 0 vide
+00011360: 6f20 6669 6c65 7320 696e 206d 7034 206f  o files in mp4 o
+00011370: 7220 6176 6920 666f 726d 6174 2066 6f75  r avi format fou
+00011380: 6e64 2069 6e20 7b64 6972 6563 746f 7279  nd in {directory
+00011390: 7d22 2c0a 2020 2020 2020 2020 2020 2020  }",.            
+000113a0: 736f 7572 6365 3d65 7874 7261 6374 5f66  source=extract_f
+000113b0: 7261 6d65 735f 6672 6f6d 5f61 6c6c 5f76  rames_from_all_v
+000113c0: 6964 656f 735f 696e 5f64 6972 6563 746f  ideos_in_directo
+000113d0: 7279 2e5f 5f6e 616d 655f 5f2c 0a20 2020  ry.__name__,.   
+000113e0: 2020 2020 2029 0a20 2020 2063 6f6e 6669       ).    confi
+000113f0: 6720 3d20 7265 6164 5f63 6f6e 6669 675f  g = read_config_
+00011400: 6669 6c65 2863 6f6e 6669 675f 7061 7468  file(config_path
+00011410: 290a 2020 2020 7072 6f6a 6563 745f 7061  ).    project_pa
+00011420: 7468 203d 2072 6561 645f 636f 6e66 6967  th = read_config
+00011430: 5f65 6e74 7279 280a 2020 2020 2020 2020  _entry(.        
+00011440: 636f 6e66 6967 2c20 2247 656e 6572 616c  config, "General
+00011450: 2073 6574 7469 6e67 7322 2c20 2270 726f   settings", "pro
+00011460: 6a65 6374 5f70 6174 6822 2c20 6461 7461  ject_path", data
+00011470: 5f74 7970 653d 2266 6f6c 6465 725f 7061  _type="folder_pa
+00011480: 7468 220a 2020 2020 290a 0a20 2020 2070  th".    )..    p
+00011490: 7269 6e74 280a 2020 2020 2020 2020 2245  rint(.        "E
+000114a0: 7874 7261 6374 696e 6720 6672 616d 6573  xtracting frames
+000114b0: 2066 6f72 207b 7d20 7669 6465 6f73 2069   for {} videos i
+000114c0: 6e74 6f20 7072 6f6a 6563 745f 666f 6c64  nto project_fold
+000114d0: 6572 2f66 7261 6d65 732f 696e 7075 7420  er/frames/input 
+000114e0: 6469 7265 6374 6f72 792e 2e2e 222e 666f  directory...".fo
+000114f0: 726d 6174 280a 2020 2020 2020 2020 2020  rmat(.          
+00011500: 2020 6c65 6e28 7669 6465 6f5f 7061 7468    len(video_path
+00011510: 7329 0a20 2020 2020 2020 2029 0a20 2020  s).        ).   
+00011520: 2029 0a20 2020 2066 6f72 2076 6964 656f   ).    for video
+00011530: 5f70 6174 6820 696e 2076 6964 656f 5f70  _path in video_p
+00011540: 6174 6873 3a0a 2020 2020 2020 2020 6469  aths:.        di
+00011550: 725f 6e61 6d65 2c20 7669 6465 6f5f 6e61  r_name, video_na
+00011560: 6d65 2c20 6578 7420 3d20 6765 745f 666e  me, ext = get_fn
+00011570: 5f65 7874 2876 6964 656f 5f70 6174 6829  _ext(video_path)
+00011580: 0a20 2020 2020 2020 2073 6176 655f 7061  .        save_pa
+00011590: 7468 203d 206f 732e 7061 7468 2e6a 6f69  th = os.path.joi
+000115a0: 6e28 7072 6f6a 6563 745f 7061 7468 2c20  n(project_path, 
+000115b0: 2266 7261 6d65 7322 2c20 2269 6e70 7574  "frames", "input
+000115c0: 222c 2076 6964 656f 5f6e 616d 6529 0a20  ", video_name). 
+000115d0: 2020 2020 2020 2069 6620 6e6f 7420 6f73         if not os
+000115e0: 2e70 6174 682e 6578 6973 7473 2873 6176  .path.exists(sav
+000115f0: 655f 7061 7468 293a 0a20 2020 2020 2020  e_path):.       
+00011600: 2020 2020 206f 732e 6d61 6b65 6469 7273       os.makedirs
+00011610: 2873 6176 655f 7061 7468 290a 2020 2020  (save_path).    
+00011620: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00011630: 2020 2020 2020 7072 696e 7428 0a20 2020        print(.   
+00011640: 2020 2020 2020 2020 2020 2020 2066 2246               f"F
+00011650: 7261 6d65 7320 666f 7220 7669 6465 6f20  rames for video 
+00011660: 7b76 6964 656f 5f6e 616d 657d 2061 6c72  {video_name} alr
+00011670: 6561 6479 2065 7874 7261 6374 6564 2e20  eady extracted. 
+00011680: 5369 6d42 4120 6973 206f 7665 7277 7269  SimBA is overwri
+00011690: 7469 6e67 2070 7269 6f72 2066 7261 6d65  ting prior frame
+000116a0: 732e 2e2e 220a 2020 2020 2020 2020 2020  s...".          
+000116b0: 2020 290a 2020 2020 2020 2020 7669 6465    ).        vide
+000116c0: 6f5f 746f 5f66 7261 6d65 7328 7669 6465  o_to_frames(vide
+000116d0: 6f5f 7061 7468 2c20 7361 7665 5f70 6174  o_path, save_pat
+000116e0: 682c 206f 7665 7277 7269 7465 3d54 7275  h, overwrite=Tru
+000116f0: 652c 2065 7665 7279 3d31 2c20 6368 756e  e, every=1, chun
+00011700: 6b5f 7369 7a65 3d31 3030 3029 0a20 2020  k_size=1000).   
+00011710: 2074 696d 6572 2e73 746f 705f 7469 6d65   timer.stop_time
+00011720: 7228 290a 2020 2020 7374 646f 7574 5f73  r().    stdout_s
+00011730: 7563 6365 7373 280a 2020 2020 2020 2020  uccess(.        
+00011740: 6622 4672 616d 6573 2063 7265 6174 6564  f"Frames created
+00011750: 2066 6f72 207b 7374 7228 6c65 6e28 7669   for {str(len(vi
+00011760: 6465 6f5f 7061 7468 7329 297d 2076 6964  deo_paths))} vid
+00011770: 656f 7322 2c0a 2020 2020 2020 2020 656c  eos",.        el
+00011780: 6170 7365 645f 7469 6d65 3d74 696d 6572  apsed_time=timer
+00011790: 2e65 6c61 7073 6564 5f74 696d 655f 7374  .elapsed_time_st
+000117a0: 722c 0a20 2020 2020 2020 2073 6f75 7263  r,.        sourc
+000117b0: 653d 6578 7472 6163 745f 6672 616d 6573  e=extract_frames
+000117c0: 5f66 726f 6d5f 616c 6c5f 7669 6465 6f73  _from_all_videos
+000117d0: 5f69 6e5f 6469 7265 6374 6f72 792e 5f5f  _in_directory.__
+000117e0: 6e61 6d65 5f5f 2c0a 2020 2020 290a 0a0a  name__,.    )...
+000117f0: 6465 6620 636f 7079 5f69 6d67 5f66 6f6c  def copy_img_fol
+00011800: 6465 7228 0a20 2020 2063 6f6e 6669 675f  der(.    config_
+00011810: 7061 7468 3a20 556e 696f 6e5b 7374 722c  path: Union[str,
+00011820: 206f 732e 5061 7468 4c69 6b65 5d2c 2073   os.PathLike], s
+00011830: 6f75 7263 653a 2055 6e69 6f6e 5b73 7472  ource: Union[str
+00011840: 2c20 6f73 2e50 6174 684c 696b 655d 0a29  , os.PathLike].)
+00011850: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2222   -> None:.    ""
+00011860: 220a 2020 2020 436f 7079 2064 6972 6563  ".    Copy direc
+00011870: 746f 7279 206f 6620 706e 6720 6669 6c65  tory of png file
+00011880: 7320 746f 2074 6865 2053 696d 4241 2070  s to the SimBA p
+00011890: 726f 6a65 6374 2e20 5468 6520 6469 7265  roject. The dire
+000118a0: 6374 6f72 7920 6973 2073 746f 7265 6420  ctory is stored 
+000118b0: 696e 2074 6865 2070 726f 6a65 6374 5f66  in the project_f
+000118c0: 6f6c 6465 722f 6672 616d 6573 2f69 6e70  older/frames/inp
+000118d0: 7574 2066 6f6c 6465 7220 6f66 2074 6865  ut folder of the
+000118e0: 2053 696d 4241 2070 726f 6a65 6374 0a0a   SimBA project..
+000118f0: 2020 2020 3a70 6172 616d 6574 6572 2073      :parameter s
+00011900: 7472 2063 6f6e 6669 675f 7061 7468 3a20  tr config_path: 
+00011910: 7061 7468 2074 6f20 5369 6d42 4120 7072  path to SimBA pr
+00011920: 6f6a 6563 7420 636f 6e66 6967 2066 696c  oject config fil
+00011930: 6520 696e 2043 6f6e 6669 6770 6172 7365  e in Configparse
+00011940: 7220 666f 726d 6174 2e0a 2020 2020 3a70  r format..    :p
+00011950: 6172 616d 6574 6572 2073 7472 2073 6f75  arameter str sou
+00011960: 7263 653a 2070 6174 6820 746f 2069 6d61  rce: path to ima
+00011970: 6765 2066 6f6c 6465 7220 6f75 7473 6964  ge folder outsid
+00011980: 6520 5369 6d42 4120 7072 6f6a 6563 742e  e SimBA project.
+00011990: 0a0a 2020 2020 3a65 7861 6d70 6c65 3a0a  ..    :example:.
+000119a0: 2020 2020 3e3e 3e20 636f 7079 5f69 6d67      >>> copy_img
+000119b0: 5f66 6f6c 6465 7228 636f 6e66 6967 5f70  _folder(config_p
+000119c0: 6174 683d 274d 7953 696d 4241 7072 6f6a  ath='MySimBAproj
+000119d0: 6563 7443 6f6e 6669 6727 2c20 736f 7572  ectConfig', sour
+000119e0: 6365 3d27 2f44 6972 6563 746f 7279 5769  ce='/DirectoryWi
+000119f0: 7468 5669 6465 6f73 2f27 290a 0a20 2020  thVideos/')..   
+00011a00: 2022 2222 0a20 2020 2074 696d 6572 203d   """.    timer =
+00011a10: 2053 696d 6261 5469 6d65 7228 7374 6172   SimbaTimer(star
+00011a20: 743d 5472 7565 290a 2020 2020 6966 206e  t=True).    if n
+00011a30: 6f74 206f 732e 7061 7468 2e69 7364 6972  ot os.path.isdir
+00011a40: 2873 6f75 7263 6529 3a0a 2020 2020 2020  (source):.      
+00011a50: 2020 7261 6973 6520 4e6f 7444 6972 6563    raise NotDirec
+00011a60: 746f 7279 4572 726f 7228 0a20 2020 2020  toryError(.     
+00011a70: 2020 2020 2020 206d 7367 3d66 2253 494d         msg=f"SIM
+00011a80: 4241 2045 5252 4f52 3a20 736f 7572 6365  BA ERROR: source
+00011a90: 207b 736f 7572 6365 7d20 6973 206e 6f74   {source} is not
+00011aa0: 2061 2064 6972 6563 746f 7279 2e22 2c0a   a directory.",.
+00011ab0: 2020 2020 2020 2020 2020 2020 736f 7572              sour
+00011ac0: 6365 3d63 6f70 795f 696d 675f 666f 6c64  ce=copy_img_fold
+00011ad0: 6572 2e5f 5f6e 616d 655f 5f2c 0a20 2020  er.__name__,.   
+00011ae0: 2020 2020 2029 0a20 2020 2069 6620 6c65       ).    if le
+00011af0: 6e28 676c 6f62 2e67 6c6f 6228 736f 7572  n(glob.glob(sour
+00011b00: 6365 202b 2022 2f2a 2e70 6e67 2229 2920  ce + "/*.png")) 
+00011b10: 3d3d 2030 3a0a 2020 2020 2020 2020 7261  == 0:.        ra
+00011b20: 6973 6520 4e6f 4669 6c65 7346 6f75 6e64  ise NoFilesFound
+00011b30: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+00011b40: 2020 206d 7367 3d66 2253 494d 4241 2045     msg=f"SIMBA E
+00011b50: 5252 4f52 3a20 736f 7572 6365 207b 736f  RROR: source {so
+00011b60: 7572 6365 7d20 646f 6573 206e 6f74 2063  urce} does not c
+00011b70: 6f6e 7461 696e 2061 6e79 202e 706e 6720  ontain any .png 
+00011b80: 6669 6c65 732e 222c 0a20 2020 2020 2020  files.",.       
+00011b90: 2020 2020 2073 6f75 7263 653d 636f 7079       source=copy
+00011ba0: 5f69 6d67 5f66 6f6c 6465 722e 5f5f 6e61  _img_folder.__na
+00011bb0: 6d65 5f5f 2c0a 2020 2020 2020 2020 290a  me__,.        ).
+00011bc0: 2020 2020 696e 7075 745f 6261 7365 6e61      input_basena
+00011bd0: 6d65 203d 206f 732e 7061 7468 2e62 6173  me = os.path.bas
+00011be0: 656e 616d 6528 736f 7572 6365 290a 2020  ename(source).  
+00011bf0: 2020 636f 6e66 6967 203d 2072 6561 645f    config = read_
+00011c00: 636f 6e66 6967 5f66 696c 6528 636f 6e66  config_file(conf
+00011c10: 6967 5f70 6174 6829 0a20 2020 2070 726f  ig_path).    pro
+00011c20: 6a65 6374 5f70 6174 6820 3d20 7265 6164  ject_path = read
+00011c30: 5f63 6f6e 6669 675f 656e 7472 7928 0a20  _config_entry(. 
+00011c40: 2020 2020 2020 2063 6f6e 6669 672c 0a20         config,. 
+00011c50: 2020 2020 2020 2043 6f6e 6669 674b 6579         ConfigKey
+00011c60: 2e47 454e 4552 414c 5f53 4554 5449 4e47  .GENERAL_SETTING
+00011c70: 532e 7661 6c75 652c 0a20 2020 2020 2020  S.value,.       
+00011c80: 2043 6f6e 6669 674b 6579 2e50 524f 4a45   ConfigKey.PROJE
+00011c90: 4354 5f50 4154 482e 7661 6c75 652c 0a20  CT_PATH.value,. 
+00011ca0: 2020 2020 2020 2064 6174 615f 7479 7065         data_type
+00011cb0: 3d22 666f 6c64 6572 5f70 6174 6822 2c0a  ="folder_path",.
+00011cc0: 2020 2020 290a 2020 2020 696e 7075 745f      ).    input_
+00011cd0: 6672 616d 6573 5f64 6972 203d 206f 732e  frames_dir = os.
+00011ce0: 7061 7468 2e6a 6f69 6e28 7072 6f6a 6563  path.join(projec
+00011cf0: 745f 7061 7468 2c20 5061 7468 732e 494e  t_path, Paths.IN
+00011d00: 5055 545f 4652 414d 4553 5f44 4952 2e76  PUT_FRAMES_DIR.v
+00011d10: 616c 7565 290a 2020 2020 6465 7374 696e  alue).    destin
+00011d20: 6174 696f 6e20 3d20 6f73 2e70 6174 682e  ation = os.path.
+00011d30: 6a6f 696e 2869 6e70 7574 5f66 7261 6d65  join(input_frame
+00011d40: 735f 6469 722c 2069 6e70 7574 5f62 6173  s_dir, input_bas
+00011d50: 656e 616d 6529 0a20 2020 2069 6620 6f73  ename).    if os
+00011d60: 2e70 6174 682e 6973 6469 7228 6465 7374  .path.isdir(dest
+00011d70: 696e 6174 696f 6e29 3a0a 2020 2020 2020  ination):.      
+00011d80: 2020 7261 6973 6520 4469 7265 6374 6f72    raise Director
+00011d90: 7945 7869 7374 4572 726f 7228 0a20 2020  yExistError(.   
+00011da0: 2020 2020 2020 2020 206d 7367 3d66 2253           msg=f"S
+00011db0: 494d 4241 2045 5252 4f52 3a20 7b64 6573  IMBA ERROR: {des
+00011dc0: 7469 6e61 7469 6f6e 7d20 616c 7265 6164  tination} alread
+00011dd0: 7920 6578 6973 7420 696e 2053 696d 4241  y exist in SimBA
+00011de0: 2070 726f 6a65 6374 2e22 2c0a 2020 2020   project.",.    
+00011df0: 2020 2020 2020 2020 736f 7572 6365 3d63          source=c
+00011e00: 6f70 795f 696d 675f 666f 6c64 6572 2e5f  opy_img_folder._
+00011e10: 5f6e 616d 655f 5f2c 0a20 2020 2020 2020  _name__,.       
+00011e20: 2029 0a20 2020 2070 7269 6e74 2866 2249   ).    print(f"I
+00011e30: 6d70 6f72 7469 6e67 2069 6d61 6765 2066  mporting image f
+00011e40: 696c 6573 2066 6f72 207b 696e 7075 745f  iles for {input_
+00011e50: 6261 7365 6e61 6d65 7d2e 2e2e 2229 0a20  basename}..."). 
+00011e60: 2020 2073 6875 7469 6c2e 636f 7079 7472     shutil.copytr
+00011e70: 6565 2873 6f75 7263 652c 2064 6573 7469  ee(source, desti
+00011e80: 6e61 7469 6f6e 290a 2020 2020 7469 6d65  nation).    time
+00011e90: 722e 7374 6f70 5f74 696d 6572 2829 0a20  r.stop_timer(). 
+00011ea0: 2020 2073 7464 6f75 745f 7375 6363 6573     stdout_succes
+00011eb0: 7328 0a20 2020 2020 2020 206d 7367 3d66  s(.        msg=f
+00011ec0: 227b 6465 7374 696e 6174 696f 6e7d 2069  "{destination} i
+00011ed0: 6d70 6f72 7465 6420 746f 2053 696d 4241  mported to SimBA
+00011ee0: 2070 726f 6a65 6374 222c 0a20 2020 2020   project",.     
+00011ef0: 2020 2065 6c61 7073 6564 5f74 696d 653d     elapsed_time=
+00011f00: 7469 6d65 722e 656c 6170 7365 645f 7469  timer.elapsed_ti
+00011f10: 6d65 5f73 7472 2c0a 2020 2020 2020 2020  me_str,.        
+00011f20: 736f 7572 6365 3d63 6f70 795f 696d 675f  source=copy_img_
+00011f30: 666f 6c64 6572 2e5f 5f6e 616d 655f 5f2c  folder.__name__,
+00011f40: 0a20 2020 2029 0a0a 0a64 6566 2061 7070  .    )...def app
+00011f50: 656e 645f 6175 6469 6f28 0a20 2020 2076  end_audio(.    v
+00011f60: 6964 656f 5f70 6174 683a 2055 6e69 6f6e  ideo_path: Union
+00011f70: 5b73 7472 2c20 6f73 2e50 6174 684c 696b  [str, os.PathLik
+00011f80: 655d 2c0a 2020 2020 6175 6469 6f5f 7061  e],.    audio_pa
+00011f90: 7468 3a20 556e 696f 6e5b 7374 722c 206f  th: Union[str, o
+00011fa0: 732e 5061 7468 4c69 6b65 5d2c 0a20 2020  s.PathLike],.   
+00011fb0: 2061 7564 696f 5f73 7263 5f74 7970 653a   audio_src_type:
+00011fc0: 204c 6974 6572 616c 5b22 7669 6465 6f22   Literal["video"
+00011fd0: 2c20 2261 7564 696f 225d 203d 2022 7669  , "audio"] = "vi
+00011fe0: 6465 6f22 2c0a 2920 2d3e 204e 6f6e 653a  deo",.) -> None:
+00011ff0: 0a20 2020 2022 2222 0a20 2020 2041 7070  .    """.    App
+00012000: 656e 6420 6175 6469 6f20 7472 6163 6b20  end audio track 
+00012010: 6672 6f6d 206f 6e65 2076 6964 656f 2074  from one video t
+00012020: 6f20 616e 6f74 6865 7220 7669 6465 6f20  o another video 
+00012030: 7769 7468 6f75 7420 616e 2061 7564 696f  without an audio
+00012040: 2074 7261 636b 2e0a 0a20 2020 203a 7061   track...    :pa
+00012050: 7261 6d20 556e 696f 6e5b 7374 722c 206f  ram Union[str, o
+00012060: 732e 5061 7468 4c69 6b65 5d20 7669 6465  s.PathLike] vide
+00012070: 6f5f 6f6e 655f 7061 7468 3a20 5061 7468  o_one_path: Path
+00012080: 2074 6f20 7669 6465 6f20 6669 6c65 2077   to video file w
+00012090: 6974 686f 7574 2061 7564 696f 2074 7261  ithout audio tra
+000120a0: 636b 2e0a 2020 2020 3a70 6172 616d 2055  ck..    :param U
+000120b0: 6e69 6f6e 5b73 7472 2c20 6f73 2e50 6174  nion[str, os.Pat
+000120c0: 684c 696b 655d 2061 7564 696f 5f70 6174  hLike] audio_pat
+000120d0: 683a 2050 6174 6820 746f 2066 696c 6520  h: Path to file 
+000120e0: 2865 2e67 2e2c 2076 6964 656f 2920 7769  (e.g., video) wi
+000120f0: 7468 2061 7564 696f 2074 7261 636b 2e0a  th audio track..
+00012100: 2020 2020 3a70 6172 616d 204c 6974 6572      :param Liter
+00012110: 616c 5b27 7669 6465 6f27 2c20 2761 7564  al['video', 'aud
+00012120: 696f 275d 2061 7564 696f 5f73 7263 5f74  io'] audio_src_t
+00012130: 7970 653a 2054 7970 6520 6f66 2061 7564  ype: Type of aud
+00012140: 696f 2073 6f75 7263 6520 6f66 2022 7669  io source of "vi
+00012150: 6465 6f5f 7477 6f5f 7061 7468 2220 2865  deo_two_path" (e
+00012160: 2e67 2e2c 2076 6964 656f 206f 7220 6175  .g., video or au
+00012170: 6469 6f20 6669 6c65 292e 0a0a 2020 2020  dio file)...    
+00012180: 3a65 7861 6d70 6c65 3a0a 2020 2020 3e3e  :example:.    >>
+00012190: 3e20 6170 7065 6e64 5f61 7564 696f 2876  > append_audio(v
+000121a0: 6964 656f 5f70 6174 683d 272f 5573 6572  ideo_path='/User
+000121b0: 732f 7369 6d6f 6e2f 4465 736b 746f 702f  s/simon/Desktop/
+000121c0: 656e 7673 2f74 726f 7562 6c65 7368 6f6f  envs/troubleshoo
+000121d0: 7469 6e67 2f74 776f 5f62 6c61 636b 5f61  ting/two_black_a
+000121e0: 6e69 6d61 6c73 5f31 3462 702f 7072 6f6a  nimals_14bp/proj
+000121f0: 6563 745f 666f 6c64 6572 2f76 6964 656f  ect_folder/video
+00012200: 732f 6d65 7267 6564 5f76 6964 656f 5f32  s/merged_video_2
+00012210: 3032 3330 3432 3532 3031 3633 372e 6d70  0230425201637.mp
+00012220: 3427 2c0a 2020 2020 3e3e 3e20 6175 6469  4',.    >>> audi
+00012230: 6f5f 7061 7468 3d22 2f55 7365 7273 2f73  o_path="/Users/s
+00012240: 696d 6f6e 2f44 6f63 756d 656e 7473 2f5a  imon/Documents/Z
+00012250: 6f6f 6d2f 6464 642f 7669 6465 6f31 3138  oom/ddd/video118
+00012260: 3037 3332 3233 332e 6d70 3422 290a 2020  0732233.mp4").  
+00012270: 2020 2222 220a 0a20 2020 2069 6620 6e6f    """..    if no
+00012280: 7420 6368 6563 6b5f 6666 6d70 6567 5f61  t check_ffmpeg_a
+00012290: 7661 696c 6162 6c65 2829 3a0a 2020 2020  vailable():.    
+000122a0: 2020 2020 7261 6973 6520 4646 4d50 4547      raise FFMPEG
+000122b0: 4e6f 7446 6f75 6e64 4572 726f 7228 0a20  NotFoundError(. 
+000122c0: 2020 2020 2020 2020 2020 206d 7367 3d22             msg="
+000122d0: 4646 4d70 6567 206e 6f74 2066 6f75 6e64  FFMpeg not found
+000122e0: 206f 6e20 636f 6d70 7574 6572 2e20 5365   on computer. Se
+000122f0: 6520 5369 6d42 4120 646f 6373 2066 6f72  e SimBA docs for
+00012300: 2069 6e73 7461 6c6c 2069 6e73 7472 7563   install instruc
+00012310: 7469 6f6e 732e 222c 0a20 2020 2020 2020  tions.",.       
+00012320: 2020 2020 2073 6f75 7263 653d 6170 7065       source=appe
+00012330: 6e64 5f61 7564 696f 2e5f 5f6e 616d 655f  nd_audio.__name_
+00012340: 5f2c 0a20 2020 2020 2020 2029 0a20 2020  _,.        ).   
+00012350: 2063 6865 636b 5f66 696c 655f 6578 6973   check_file_exis
+00012360: 745f 616e 645f 7265 6164 6162 6c65 2866  t_and_readable(f
+00012370: 696c 655f 7061 7468 3d76 6964 656f 5f70  ile_path=video_p
+00012380: 6174 6829 0a20 2020 2063 6865 636b 5f66  ath).    check_f
+00012390: 696c 655f 6578 6973 745f 616e 645f 7265  ile_exist_and_re
+000123a0: 6164 6162 6c65 2866 696c 655f 7061 7468  adable(file_path
+000123b0: 3d61 7564 696f 5f70 6174 6829 0a20 2020  =audio_path).   
+000123c0: 2076 6964 656f 5f6d 6574 615f 6461 7461   video_meta_data
+000123d0: 203d 2067 6574 5f76 6964 656f 5f6d 6574   = get_video_met
+000123e0: 615f 6461 7461 2876 6964 656f 5f70 6174  a_data(video_pat
+000123f0: 683d 7669 6465 6f5f 7061 7468 290a 2020  h=video_path).  
+00012400: 2020 6175 6469 6f5f 7372 635f 6d65 7461    audio_src_meta
+00012410: 5f64 6174 6120 3d20 6765 745f 7669 6465  _data = get_vide
+00012420: 6f5f 6d65 7461 5f64 6174 6128 7669 6465  o_meta_data(vide
+00012430: 6f5f 7061 7468 3d61 7564 696f 5f70 6174  o_path=audio_pat
+00012440: 6829 0a20 2020 2073 6176 655f 7061 7468  h).    save_path
+00012450: 203d 206f 732e 7061 7468 2e6a 6f69 6e28   = os.path.join(
+00012460: 0a20 2020 2020 2020 206f 732e 7061 7468  .        os.path
+00012470: 2e64 6972 6e61 6d65 2876 6964 656f 5f70  .dirname(video_p
+00012480: 6174 6829 2c20 6765 745f 666e 5f65 7874  ath), get_fn_ext
+00012490: 2866 696c 6570 6174 683d 7669 6465 6f5f  (filepath=video_
+000124a0: 7061 7468 295b 315d 202b 2022 5f77 5f61  path)[1] + "_w_a
+000124b0: 7564 696f 2e6d 7034 220a 2020 2020 290a  udio.mp4".    ).
+000124c0: 2020 2020 636d 6420 3d20 5b0a 2020 2020      cmd = [.    
+000124d0: 2020 2020 2266 6670 726f 6265 222c 0a20      "ffprobe",. 
+000124e0: 2020 2020 2020 2022 2d76 222c 0a20 2020         "-v",.   
+000124f0: 2020 2020 2022 6572 726f 7222 2c0a 2020       "error",.  
+00012500: 2020 2020 2020 222d 7365 6c65 6374 5f73        "-select_s
+00012510: 7472 6561 6d73 222c 0a20 2020 2020 2020  treams",.       
+00012520: 2022 613a 3022 2c0a 2020 2020 2020 2020   "a:0",.        
+00012530: 222d 7368 6f77 5f65 6e74 7269 6573 222c  "-show_entries",
+00012540: 0a20 2020 2020 2020 2022 7374 7265 616d  .        "stream
+00012550: 3d63 6f64 6563 5f6e 616d 6522 2c0a 2020  =codec_name",.  
+00012560: 2020 2020 2020 222d 6f66 222c 0a20 2020        "-of",.   
+00012570: 2020 2020 2022 6465 6661 756c 743d 6e6f       "default=no
+00012580: 7072 696e 745f 7772 6170 7065 7273 3d31  print_wrappers=1
+00012590: 3a6e 6f6b 6579 3d31 222c 0a20 2020 2020  :nokey=1",.     
+000125a0: 2020 2061 7564 696f 5f70 6174 682c 0a20     audio_path,. 
+000125b0: 2020 205d 0a20 2020 2074 7279 3a0a 2020     ].    try:.  
+000125c0: 2020 2020 2020 7472 6163 6b5f 7479 7065        track_type
+000125d0: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+000125e0: 2073 7562 7072 6f63 6573 732e 6368 6563   subprocess.chec
+000125f0: 6b5f 6f75 7470 7574 2863 6d64 2c20 7374  k_output(cmd, st
+00012600: 6465 7272 3d73 7562 7072 6f63 6573 732e  derr=subprocess.
+00012610: 5354 444f 5554 290a 2020 2020 2020 2020  STDOUT).        
+00012620: 2020 2020 2e64 6563 6f64 6528 2275 7466      .decode("utf
+00012630: 2d38 2229 0a20 2020 2020 2020 2020 2020  -8").           
+00012640: 202e 7374 7269 7028 290a 2020 2020 2020   .strip().      
+00012650: 2020 290a 2020 2020 6578 6365 7074 2073    ).    except s
+00012660: 7562 7072 6f63 6573 732e 4361 6c6c 6564  ubprocess.Called
+00012670: 5072 6f63 6573 7345 7272 6f72 3a0a 2020  ProcessError:.  
+00012680: 2020 2020 2020 7261 6973 6520 4e6f 4461        raise NoDa
+00012690: 7461 4572 726f 7228 0a20 2020 2020 2020  taError(.       
+000126a0: 2020 2020 206d 7367 3d66 224e 6f20 6175       msg=f"No au
+000126b0: 6469 6f20 7472 6163 6b20 666f 756e 6420  dio track found 
+000126c0: 696e 2066 696c 6520 7b61 7564 696f 5f70  in file {audio_p
+000126d0: 6174 687d 222c 0a20 2020 2020 2020 2020  ath}",.         
+000126e0: 2020 2073 6f75 7263 653d 6170 7065 6e64     source=append
+000126f0: 5f61 7564 696f 2e5f 5f6e 616d 655f 5f2c  _audio.__name__,
+00012700: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00012710: 6966 2076 6964 656f 5f6d 6574 615f 6461  if video_meta_da
+00012720: 7461 5b22 6672 616d 655f 636f 756e 7422  ta["frame_count"
+00012730: 5d20 213d 2061 7564 696f 5f73 7263 5f6d  ] != audio_src_m
+00012740: 6574 615f 6461 7461 5b22 6672 616d 655f  eta_data["frame_
+00012750: 636f 756e 7422 5d3a 0a20 2020 2020 2020  count"]:.       
+00012760: 2049 6e56 616c 6964 5573 6572 496e 7075   InValidUserInpu
+00012770: 7457 6172 6e69 6e67 280a 2020 2020 2020  tWarning(.      
+00012780: 2020 2020 2020 6d73 673d 6627 5468 6520        msg=f'The 
+00012790: 7669 6465 6f20 287b 7669 6465 6f5f 6d65  video ({video_me
+000127a0: 7461 5f64 6174 615b 2266 7261 6d65 5f63  ta_data["frame_c
+000127b0: 6f75 6e74 225d 7d29 2061 6e64 2061 7564  ount"]}) and aud
+000127c0: 696f 2073 6f75 7263 6520 287b 6175 6469  io source ({audi
+000127d0: 6f5f 7372 635f 6d65 7461 5f64 6174 615b  o_src_meta_data[
+000127e0: 2266 7261 6d65 5f63 6f75 6e74 225d 7d29  "frame_count"]})
+000127f0: 2064 6f65 7320 6e6f 7420 6861 7665 2061   does not have a
+00012800: 6e20 6571 7561 6c20 6e75 6d62 6572 206f  n equal number o
+00012810: 6620 6672 616d 6573 2e27 2c0a 2020 2020  f frames.',.    
+00012820: 2020 2020 2020 2020 736f 7572 6365 3d61          source=a
+00012830: 7070 656e 645f 6175 6469 6f2e 5f5f 6e61  ppend_audio.__na
+00012840: 6d65 5f5f 2c0a 2020 2020 2020 2020 290a  me__,.        ).
+00012850: 0a20 2020 2063 6d64 203d 2066 2766 666d  .    cmd = f'ffm
+00012860: 7065 6720 2d69 2022 7b76 6964 656f 5f70  peg -i "{video_p
+00012870: 6174 687d 2220 2d69 2022 7b61 7564 696f  ath}" -i "{audio
+00012880: 5f70 6174 687d 2220 2d63 3a76 2063 6f70  _path}" -c:v cop
+00012890: 7920 2d6d 6170 2030 3a76 3a30 202d 6d61  y -map 0:v:0 -ma
+000128a0: 7020 313a 613a 3020 227b 7361 7665 5f70  p 1:a:0 "{save_p
+000128b0: 6174 687d 2220 2d79 270a 0a20 2020 2074  ath}" -y'..    t
+000128c0: 7279 3a0a 2020 2020 2020 2020 7375 6270  ry:.        subp
+000128d0: 726f 6365 7373 2e72 756e 2863 6d64 2c20  rocess.run(cmd, 
+000128e0: 7368 656c 6c3d 5472 7565 2c20 6368 6563  shell=True, chec
+000128f0: 6b3d 5472 7565 290a 2020 2020 6578 6365  k=True).    exce
+00012900: 7074 2073 7562 7072 6f63 6573 732e 4361  pt subprocess.Ca
+00012910: 6c6c 6564 5072 6f63 6573 7345 7272 6f72  lledProcessError
+00012920: 2061 7320 653a 0a20 2020 2020 2020 2070   as e:.        p
+00012930: 7269 6e74 2822 4572 726f 723a 222c 2065  rint("Error:", e
+00012940: 290a 0a20 2020 2073 7464 6f75 745f 7375  )..    stdout_su
+00012950: 6363 6573 7328 0a20 2020 2020 2020 206d  ccess(.        m
+00012960: 7367 3d66 2241 7564 696f 206d 6572 6765  sg=f"Audio merge
+00012970: 6420 7375 6363 6573 7366 756c 6c79 2c20  d successfully, 
+00012980: 6669 6c65 2073 6176 6564 2061 7420 7b73  file saved at {s
+00012990: 6176 655f 7061 7468 7d21 222c 0a20 2020  ave_path}!",.   
+000129a0: 2020 2020 2073 6f75 7263 653d 6170 7065       source=appe
+000129b0: 6e64 5f61 7564 696f 2e5f 5f6e 616d 655f  nd_audio.__name_
+000129c0: 5f2c 0a20 2020 2029 0a0a 0a64 6566 2063  _,.    )...def c
+000129d0: 726f 705f 7369 6e67 6c65 5f76 6964 656f  rop_single_video
+000129e0: 5f63 6972 636c 6528 6669 6c65 5f70 6174  _circle(file_pat
+000129f0: 683a 2055 6e69 6f6e 5b73 7472 2c20 6f73  h: Union[str, os
+00012a00: 2e50 6174 684c 696b 655d 2920 2d3e 204e  .PathLike]) -> N
+00012a10: 6f6e 653a 0a20 2020 2022 2222 0a20 2020  one:.    """.   
+00012a20: 2043 726f 7020 6120 7669 6465 6f20 6261   Crop a video ba
+00012a30: 7365 6420 6f6e 2063 6972 6375 6c61 7220  sed on circular 
+00012a40: 7265 6769 6f6e 7320 6f66 2069 6e74 6572  regions of inter
+00012a50: 6573 7420 2852 4f49 7329 2073 656c 6563  est (ROIs) selec
+00012a60: 7465 6420 6279 2074 6865 2075 7365 722e  ted by the user.
+00012a70: 0a0a 2020 2020 3a70 6172 616d 2020 556e  ..    :param  Un
+00012a80: 696f 6e5b 7374 722c 206f 732e 5061 7468  ion[str, os.Path
+00012a90: 4c69 6b65 5d20 6669 6c65 5f70 6174 683a  Like] file_path:
+00012aa0: 2054 6865 2070 6174 6820 746f 2074 6865   The path to the
+00012ab0: 2069 6e70 7574 2076 6964 656f 2066 696c   input video fil
+00012ac0: 652e 0a0a 2020 2020 2e2e 206e 6f74 653a  e...    .. note:
+00012ad0: 3a0a 2020 2020 2020 2054 6869 7320 6675  :.       This fu
+00012ae0: 6e63 7469 6f6e 2063 726f 7073 2074 6865  nction crops the
+00012af0: 2069 6e70 7574 2076 6964 656f 2062 6173   input video bas
+00012b00: 6564 206f 6e20 6369 7263 756c 6172 2072  ed on circular r
+00012b10: 6567 696f 6e73 206f 6620 696e 7465 7265  egions of intere
+00012b20: 7374 2028 524f 4973 2920 7365 6c65 6374  st (ROIs) select
+00012b30: 6564 2062 7920 7468 6520 7573 6572 2e0a  ed by the user..
+00012b40: 2020 2020 2020 2054 6865 2075 7365 7220         The user 
+00012b50: 6973 2070 726f 6d70 7465 6420 746f 2073  is prompted to s
+00012b60: 656c 6563 7420 6120 6369 7263 756c 6172  elect a circular
+00012b70: 2052 4f49 206f 6e20 7468 6520 7669 6465   ROI on the vide
+00012b80: 6f20 6672 616d 652c 2061 6e64 2074 6865  o frame, and the
+00012b90: 2066 756e 6374 696f 6e20 7468 656e 2063   function then c
+00012ba0: 726f 7073 2074 6865 2076 6964 656f 0a20  rops the video. 
+00012bb0: 2020 2020 2020 6261 7365 6420 6f6e 2074        based on t
+00012bc0: 6865 2073 656c 6563 7465 6420 524f 492e  he selected ROI.
+00012bd0: 2054 6865 2063 726f 7070 6564 2076 6964   The cropped vid
+00012be0: 656f 2069 7320 7361 7665 6420 7769 7468  eo is saved with
+00012bf0: 2022 5f63 6972 636c 655f 6372 6f70 7065   "_circle_croppe
+00012c00: 6422 2073 7566 6669 7820 696e 2074 6865  d" suffix in the
+00012c10: 2073 616d 6520 6469 7265 6374 6f72 790a   same directory.
+00012c20: 2020 2020 2020 2061 7320 7468 6520 696e         as the in
+00012c30: 7075 7420 7669 6465 6f20 6669 6c65 2e0a  put video file..
+00012c40: 0a20 2020 203a 6578 616d 706c 653a 0a20  .    :example:. 
+00012c50: 2020 203e 3e3e 2063 726f 705f 7369 6e67     >>> crop_sing
+00012c60: 6c65 5f76 6964 656f 5f63 6972 636c 6528  le_video_circle(
+00012c70: 6669 6c65 5f70 6174 683d 272f 5573 6572  file_path='/User
+00012c80: 732f 7369 6d6f 6e2f 4465 736b 746f 702f  s/simon/Desktop/
+00012c90: 4147 4752 4553 5349 5649 5459 5f34 5f31  AGGRESSIVITY_4_1
+00012ca0: 315f 3231 5f54 7269 616c 5f32 5f63 616d  1_21_Trial_2_cam
+00012cb0: 6572 6131 5f72 6f74 6174 6564 5f32 3032  era1_rotated_202
+00012cc0: 3430 3231 3131 3433 3335 352e 6d70 3427  40211143355.mp4'
+00012cd0: 290a 2020 2020 2222 220a 0a20 2020 2064  ).    """..    d
+00012ce0: 6972 2c20 7669 6465 6f5f 6e61 6d65 2c20  ir, video_name, 
+00012cf0: 5f20 3d20 6765 745f 666e 5f65 7874 2866  _ = get_fn_ext(f
+00012d00: 696c 6570 6174 683d 6669 6c65 5f70 6174  ilepath=file_pat
+00012d10: 6829 0a20 2020 2073 6176 655f 7061 7468  h).    save_path
+00012d20: 203d 206f 732e 7061 7468 2e6a 6f69 6e28   = os.path.join(
+00012d30: 6469 722c 2066 227b 7669 6465 6f5f 6e61  dir, f"{video_na
+00012d40: 6d65 7d5f 6369 7263 6c65 5f63 726f 7070  me}_circle_cropp
+00012d50: 6564 2e6d 7034 2229 0a20 2020 2076 6964  ed.mp4").    vid
+00012d60: 656f 5f6d 6574 615f 6461 7461 203d 2067  eo_meta_data = g
+00012d70: 6574 5f76 6964 656f 5f6d 6574 615f 6461  et_video_meta_da
+00012d80: 7461 2876 6964 656f 5f70 6174 683d 6669  ta(video_path=fi
+00012d90: 6c65 5f70 6174 6829 0a20 2020 2063 6865  le_path).    che
+00012da0: 636b 5f66 696c 655f 6578 6973 745f 616e  ck_file_exist_an
+00012db0: 645f 7265 6164 6162 6c65 2866 696c 655f  d_readable(file_
+00012dc0: 7061 7468 3d66 696c 655f 7061 7468 290a  path=file_path).
+00012dd0: 2020 2020 6369 7263 6c65 5f73 656c 6563      circle_selec
+00012de0: 746f 7220 3d20 524f 4953 656c 6563 746f  tor = ROISelecto
+00012df0: 7243 6972 636c 6528 7061 7468 3d66 696c  rCircle(path=fil
+00012e00: 655f 7061 7468 290a 2020 2020 6369 7263  e_path).    circ
+00012e10: 6c65 5f73 656c 6563 746f 722e 7275 6e28  le_selector.run(
+00012e20: 290a 2020 2020 7469 6d65 7220 3d20 5369  ).    timer = Si
+00012e30: 6d62 6154 696d 6572 2873 7461 7274 3d54  mbaTimer(start=T
+00012e40: 7275 6529 0a20 2020 2072 203d 2063 6972  rue).    r = cir
+00012e50: 636c 655f 7365 6c65 6374 6f72 2e63 6972  cle_selector.cir
+00012e60: 636c 655f 7261 6469 7573 0a20 2020 2078  cle_radius.    x
+00012e70: 2c20 7920 3d20 6369 7263 6c65 5f73 656c  , y = circle_sel
+00012e80: 6563 746f 722e 6369 7263 6c65 5f63 656e  ector.circle_cen
+00012e90: 7465 725b 305d 2c20 6369 7263 6c65 5f73  ter[0], circle_s
+00012ea0: 656c 6563 746f 722e 6369 7263 6c65 5f63  elector.circle_c
+00012eb0: 656e 7465 725b 315d 0a20 2020 2070 6f6c  enter[1].    pol
+00012ec0: 7967 6f6e 203d 2050 6f6c 7967 6f6e 280a  ygon = Polygon(.
+00012ed0: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
+00012ee0: 2020 2020 2020 2878 202b 2072 202a 206e        (x + r * n
+00012ef0: 702e 636f 7328 616e 676c 6529 2c20 7920  p.cos(angle), y 
+00012f00: 2b20 7220 2a20 6e70 2e73 696e 2861 6e67  + r * np.sin(ang
+00012f10: 6c65 2929 0a20 2020 2020 2020 2020 2020  le)).           
+00012f20: 2066 6f72 2061 6e67 6c65 2069 6e20 6e70   for angle in np
+00012f30: 2e6c 696e 7370 6163 6528 302c 2032 202a  .linspace(0, 2 *
+00012f40: 206e 702e 7069 2c20 3130 3029 0a20 2020   np.pi, 100).   
+00012f50: 2020 2020 205d 0a20 2020 2029 0a20 2020       ].    ).   
+00012f60: 2070 6f6c 7967 6f6e 7320 3d20 5b70 6f6c   polygons = [pol
+00012f70: 7967 6f6e 2066 6f72 2078 2069 6e20 7261  ygon for x in ra
+00012f80: 6e67 6528 7669 6465 6f5f 6d65 7461 5f64  nge(video_meta_d
+00012f90: 6174 615b 2266 7261 6d65 5f63 6f75 6e74  ata["frame_count
+00012fa0: 225d 295d 0a20 2020 2069 6620 2870 6c61  "])].    if (pla
+00012fb0: 7466 6f72 6d2e 7379 7374 656d 2829 203d  tform.system() =
+00012fc0: 3d20 2244 6172 7769 6e22 2920 616e 6420  = "Darwin") and 
+00012fd0: 286d 756c 7469 7072 6f63 6573 7369 6e67  (multiprocessing
+00012fe0: 2e67 6574 5f73 7461 7274 5f6d 6574 686f  .get_start_metho
+00012ff0: 6428 2920 6973 204e 6f6e 6529 3a0a 2020  d() is None):.  
+00013000: 2020 2020 2020 6d75 6c74 6970 726f 6365        multiproce
+00013010: 7373 696e 672e 7365 745f 7374 6172 745f  ssing.set_start_
+00013020: 6d65 7468 6f64 2822 7370 6177 6e22 2c20  method("spawn", 
+00013030: 666f 7263 653d 5472 7565 290a 2020 2020  force=True).    
+00013040: 706f 6c79 676f 6e73 203d 2049 6d61 6765  polygons = Image
+00013050: 4d69 7869 6e28 292e 736c 6963 655f 7368  Mixin().slice_sh
+00013060: 6170 6573 5f69 6e5f 696d 6773 280a 2020  apes_in_imgs(.  
+00013070: 2020 2020 2020 696d 6773 3d66 696c 655f        imgs=file_
+00013080: 7061 7468 2c20 7368 6170 6573 3d70 6f6c  path, shapes=pol
+00013090: 7967 6f6e 732c 2076 6572 626f 7365 3d46  ygons, verbose=F
+000130a0: 616c 7365 0a20 2020 2029 0a20 2020 2074  alse.    ).    t
+000130b0: 696d 652e 736c 6565 7028 3329 0a20 2020  ime.sleep(3).   
+000130c0: 205f 203d 2049 6d61 6765 4d69 7869 6e2e   _ = ImageMixin.
+000130d0: 696d 675f 7374 6163 6b5f 746f 5f76 6964  img_stack_to_vid
+000130e0: 656f 280a 2020 2020 2020 2020 696d 6773  eo(.        imgs
+000130f0: 3d70 6f6c 7967 6f6e 732c 2073 6176 655f  =polygons, save_
+00013100: 7061 7468 3d73 6176 655f 7061 7468 2c20  path=save_path, 
+00013110: 6670 733d 7669 6465 6f5f 6d65 7461 5f64  fps=video_meta_d
+00013120: 6174 615b 2266 7073 225d 0a20 2020 2029  ata["fps"].    )
+00013130: 0a20 2020 2074 696d 6572 2e73 746f 705f  .    timer.stop_
+00013140: 7469 6d65 7228 290a 2020 2020 7374 646f  timer().    stdo
+00013150: 7574 5f73 7563 6365 7373 280a 2020 2020  ut_success(.    
+00013160: 2020 2020 6d73 673d 6622 4369 7263 6c65      msg=f"Circle
+00013170: 2d62 6173 6564 2063 726f 7070 6564 2073  -based cropped s
+00013180: 6176 6564 2061 7420 746f 207b 7361 7665  aved at to {save
+00013190: 5f70 6174 687d 222c 0a20 2020 2020 2020  _path}",.       
+000131a0: 2065 6c61 7073 6564 5f74 696d 653d 7469   elapsed_time=ti
+000131b0: 6d65 722e 656c 6170 7365 645f 7469 6d65  mer.elapsed_time
+000131c0: 5f73 7472 2c0a 2020 2020 290a 0a0a 6465  _str,.    )...de
+000131d0: 6620 6372 6f70 5f6d 756c 7469 706c 655f  f crop_multiple_
+000131e0: 7669 6465 6f73 5f63 6972 636c 6573 280a  videos_circles(.
+000131f0: 2020 2020 696e 5f64 6972 3a20 556e 696f      in_dir: Unio
+00013200: 6e5b 7374 722c 206f 732e 5061 7468 4c69  n[str, os.PathLi
+00013210: 6b65 5d2c 206f 7574 5f64 6972 3a20 556e  ke], out_dir: Un
+00013220: 696f 6e5b 7374 722c 206f 732e 5061 7468  ion[str, os.Path
+00013230: 4c69 6b65 5d0a 2920 2d3e 204e 6f6e 653a  Like].) -> None:
+00013240: 0a20 2020 2022 2222 0a20 2020 2043 726f  .    """.    Cro
+00013250: 7020 6d75 6c74 6970 6c65 2076 6964 656f  p multiple video
+00013260: 7320 6261 7365 6420 6f6e 2063 6972 6375  s based on circu
+00013270: 6c61 7220 7265 6769 6f6e 7320 6f66 2069  lar regions of i
+00013280: 6e74 6572 6573 7420 2852 4f49 7329 2073  nterest (ROIs) s
+00013290: 656c 6563 7465 6420 6279 2074 6865 2075  elected by the u
+000132a0: 7365 722e 0a0a 2020 2020 3a70 6172 616d  ser...    :param
+000132b0: 2020 556e 696f 6e5b 7374 722c 206f 732e    Union[str, os.
+000132c0: 5061 7468 4c69 6b65 5d20 696e 5f64 6972  PathLike] in_dir
+000132d0: 3a20 5468 6520 6469 7265 6374 6f72 7920  : The directory 
+000132e0: 636f 6e74 6169 6e69 6e67 2069 6e70 7574  containing input
+000132f0: 2076 6964 656f 2066 696c 6573 2e0a 2020   video files..  
+00013300: 2020 3a70 6172 616d 2020 556e 696f 6e5b    :param  Union[
+00013310: 7374 722c 206f 732e 5061 7468 4c69 6b65  str, os.PathLike
+00013320: 5d20 6f75 745f 6469 723a 2054 6865 2064  ] out_dir: The d
+00013330: 6972 6563 746f 7279 2074 6f20 7361 7665  irectory to save
+00013340: 2074 6865 2063 726f 7070 6564 2076 6964   the cropped vid
+00013350: 656f 2066 696c 6573 2e0a 0a20 2020 202e  eo files...    .
+00013360: 2e20 6e6f 7465 3a3a 0a20 2020 2020 2020  . note::.       
+00013370: 5468 6973 2066 756e 6374 696f 6e20 6372  This function cr
+00013380: 6f70 7320 6d75 6c74 6970 6c65 2076 6964  ops multiple vid
+00013390: 656f 7320 6261 7365 6420 6f6e 2063 6972  eos based on cir
+000133a0: 6375 6c61 7220 524f 4973 2073 656c 6563  cular ROIs selec
+000133b0: 7465 6420 6279 2074 6865 2075 7365 722e  ted by the user.
+000133c0: 0a20 2020 2020 2020 5468 6520 7573 6572  .       The user
+000133d0: 2069 7320 6173 6b65 6420 746f 2064 6566   is asked to def
+000133e0: 696e 6520 6120 6369 7263 6c65 206d 616e  ine a circle man
+000133f0: 7561 6c6c 7920 696e 206f 6e65 2076 6964  ually in one vid
+00013400: 656f 2077 6974 6869 6e20 7468 6520 696e  eo within the in
+00013410: 7075 7420 6469 7265 6374 6f72 792e 0a20  put directory.. 
+00013420: 2020 2020 2020 5468 6520 6675 6e63 7469        The functi
+00013430: 6f6e 2074 6865 6e20 6372 6f70 7320 616c  on then crops al
+00013440: 6c20 7468 6520 7669 6465 6f20 696e 2074  l the video in t
+00013450: 6865 2069 6e70 7574 2064 6972 6563 746f  he input directo
+00013460: 7279 2061 6363 6f72 6469 6e67 2074 6f20  ry according to 
+00013470: 7468 6520 7368 6170 6520 6465 6669 6e65  the shape define
+00013480: 640a 2020 2020 2020 2075 7369 6e67 2074  d.       using t
+00013490: 6865 2066 6972 7374 2076 6964 656f 2061  he first video a
+000134a0: 6e64 2073 6176 6573 2074 6865 2076 6964  nd saves the vid
+000134b0: 656f 7320 696e 2074 6865 2060 606f 7574  eos in the ``out
+000134c0: 5f64 6972 6060 2077 6974 6820 7468 6520  _dir`` with the 
+000134d0: 7361 6d65 2066 696c 656e 616d 6573 2061  same filenames a
+000134e0: 7320 7468 6520 6f72 6967 696e 616c 2076  s the original v
+000134f0: 6964 656f 732e 2e0a 0a20 2020 203a 6578  ideos....    :ex
+00013500: 616d 706c 653a 0a20 2020 203e 3e3e 2063  ample:.    >>> c
+00013510: 726f 705f 6d75 6c74 6970 6c65 5f76 6964  rop_multiple_vid
+00013520: 656f 735f 6369 7263 6c65 7328 696e 5f64  eos_circles(in_d
+00013530: 6972 3d27 2f55 7365 7273 2f73 696d 6f6e  ir='/Users/simon
+00013540: 2f44 6573 6b74 6f70 2f65 6469 7465 642f  /Desktop/edited/
+00013550: 7465 7374 7327 2c20 6f75 745f 6469 723d  tests', out_dir=
+00013560: 272f 5573 6572 732f 7369 6d6f 6e2f 4465  '/Users/simon/De
+00013570: 736b 746f 7027 290a 2020 2020 2222 220a  sktop').    """.
+00013580: 0a20 2020 2063 6865 636b 5f69 665f 6469  .    check_if_di
+00013590: 725f 6578 6973 7473 2869 6e5f 6469 723d  r_exists(in_dir=
+000135a0: 696e 5f64 6972 290a 2020 2020 6368 6563  in_dir).    chec
+000135b0: 6b5f 6966 5f64 6972 5f65 7869 7374 7328  k_if_dir_exists(
+000135c0: 696e 5f64 6972 3d6f 7574 5f64 6972 290a  in_dir=out_dir).
+000135d0: 2020 2020 7669 6465 6f5f 6669 6c65 7320      video_files 
+000135e0: 3d20 6669 6e64 5f61 6c6c 5f76 6964 656f  = find_all_video
+000135f0: 735f 696e 5f64 6972 6563 746f 7279 2864  s_in_directory(d
+00013600: 6972 6563 746f 7279 3d69 6e5f 6469 7229  irectory=in_dir)
+00013610: 0a20 2020 2063 6972 636c 655f 7365 6c65  .    circle_sele
+00013620: 6374 6f72 203d 2052 4f49 5365 6c65 6374  ctor = ROISelect
+00013630: 6f72 4369 7263 6c65 2870 6174 683d 6f73  orCircle(path=os
+00013640: 2e70 6174 682e 6a6f 696e 2869 6e5f 6469  .path.join(in_di
+00013650: 722c 2076 6964 656f 5f66 696c 6573 5b30  r, video_files[0
+00013660: 5d29 290a 2020 2020 6369 7263 6c65 5f73  ])).    circle_s
+00013670: 656c 6563 746f 722e 7275 6e28 290a 2020  elector.run().  
+00013680: 2020 7220 3d20 6369 7263 6c65 5f73 656c    r = circle_sel
+00013690: 6563 746f 722e 6369 7263 6c65 5f72 6164  ector.circle_rad
+000136a0: 6975 730a 2020 2020 782c 2079 203d 2063  ius.    x, y = c
+000136b0: 6972 636c 655f 7365 6c65 6374 6f72 2e63  ircle_selector.c
+000136c0: 6972 636c 655f 6365 6e74 6572 5b30 5d2c  ircle_center[0],
+000136d0: 2063 6972 636c 655f 7365 6c65 6374 6f72   circle_selector
+000136e0: 2e63 6972 636c 655f 6365 6e74 6572 5b31  .circle_center[1
+000136f0: 5d0a 2020 2020 706f 6c79 676f 6e20 3d20  ].    polygon = 
+00013700: 506f 6c79 676f 6e28 0a20 2020 2020 2020  Polygon(.       
+00013710: 205b 0a20 2020 2020 2020 2020 2020 2028   [.            (
+00013720: 7820 2b20 7220 2a20 6e70 2e63 6f73 2861  x + r * np.cos(a
+00013730: 6e67 6c65 292c 2079 202b 2072 202a 206e  ngle), y + r * n
+00013740: 702e 7369 6e28 616e 676c 6529 290a 2020  p.sin(angle)).  
+00013750: 2020 2020 2020 2020 2020 666f 7220 616e            for an
+00013760: 676c 6520 696e 206e 702e 6c69 6e73 7061  gle in np.linspa
+00013770: 6365 2830 2c20 3220 2a20 6e70 2e70 692c  ce(0, 2 * np.pi,
+00013780: 2031 3030 290a 2020 2020 2020 2020 5d0a   100).        ].
+00013790: 2020 2020 290a 2020 2020 7469 6d65 7220      ).    timer 
+000137a0: 3d20 5369 6d62 6154 696d 6572 2873 7461  = SimbaTimer(sta
+000137b0: 7274 3d54 7275 6529 0a20 2020 2069 6620  rt=True).    if 
+000137c0: 2870 6c61 7466 6f72 6d2e 7379 7374 656d  (platform.system
+000137d0: 2829 203d 3d20 2244 6172 7769 6e22 2920  () == "Darwin") 
+000137e0: 616e 6420 286d 756c 7469 7072 6f63 6573  and (multiproces
+000137f0: 7369 6e67 2e67 6574 5f73 7461 7274 5f6d  sing.get_start_m
+00013800: 6574 686f 6428 2920 6973 204e 6f6e 6529  ethod() is None)
+00013810: 3a0a 2020 2020 2020 2020 6d75 6c74 6970  :.        multip
+00013820: 726f 6365 7373 696e 672e 7365 745f 7374  rocessing.set_st
+00013830: 6172 745f 6d65 7468 6f64 2822 7370 6177  art_method("spaw
+00013840: 6e22 2c20 666f 7263 653d 4661 6c73 6529  n", force=False)
+00013850: 0a20 2020 2066 6f72 2076 6964 656f 5f63  .    for video_c
+00013860: 6e74 2c20 7669 6465 6f5f 7061 7468 2069  nt, video_path i
+00013870: 6e20 656e 756d 6572 6174 6528 7669 6465  n enumerate(vide
+00013880: 6f5f 6669 6c65 7329 3a0a 2020 2020 2020  o_files):.      
+00013890: 2020 7072 696e 7428 0a20 2020 2020 2020    print(.       
+000138a0: 2020 2020 2066 2243 6972 636c 6520 6372       f"Circle cr
+000138b0: 6f70 7069 6e67 2076 6964 656f 207b 7669  opping video {vi
+000138c0: 6465 6f5f 7061 7468 7d20 287b 7669 6465  deo_path} ({vide
+000138d0: 6f5f 636e 742b 317d 2f7b 6c65 6e28 7669  o_cnt+1}/{len(vi
+000138e0: 6465 6f5f 6669 6c65 7329 7d29 2e2e 2e22  deo_files)})..."
+000138f0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00013900: 2020 2076 6964 656f 5f70 6174 6820 3d20     video_path = 
+00013910: 6f73 2e70 6174 682e 6a6f 696e 2869 6e5f  os.path.join(in_
+00013920: 6469 722c 2076 6964 656f 5f70 6174 6829  dir, video_path)
+00013930: 0a20 2020 2020 2020 205f 2c20 7669 6465  .        _, vide
+00013940: 6f5f 6e61 6d65 2c20 5f20 3d20 6765 745f  o_name, _ = get_
+00013950: 666e 5f65 7874 2866 696c 6570 6174 683d  fn_ext(filepath=
+00013960: 7669 6465 6f5f 7061 7468 290a 2020 2020  video_path).    
+00013970: 2020 2020 7361 7665 5f70 6174 6820 3d20      save_path = 
+00013980: 6f73 2e70 6174 682e 6a6f 696e 286f 7574  os.path.join(out
+00013990: 5f64 6972 2c20 6622 7b76 6964 656f 5f6e  _dir, f"{video_n
+000139a0: 616d 657d 2e6d 7034 2229 0a20 2020 2020  ame}.mp4").     
+000139b0: 2020 2076 6964 656f 5f6d 6574 615f 6461     video_meta_da
+000139c0: 7461 203d 2067 6574 5f76 6964 656f 5f6d  ta = get_video_m
+000139d0: 6574 615f 6461 7461 2876 6964 656f 5f70  eta_data(video_p
+000139e0: 6174 683d 7669 6465 6f5f 7061 7468 290a  ath=video_path).
+000139f0: 2020 2020 2020 2020 706f 6c79 676f 6e73          polygons
+00013a00: 203d 205b 706f 6c79 676f 6e20 666f 7220   = [polygon for 
+00013a10: 7820 696e 2072 616e 6765 2876 6964 656f  x in range(video
+00013a20: 5f6d 6574 615f 6461 7461 5b22 6672 616d  _meta_data["fram
+00013a30: 655f 636f 756e 7422 5d29 5d0a 2020 2020  e_count"])].    
+00013a40: 2020 2020 706f 6c79 676f 6e73 203d 2049      polygons = I
+00013a50: 6d61 6765 4d69 7869 6e28 292e 736c 6963  mageMixin().slic
+00013a60: 655f 7368 6170 6573 5f69 6e5f 696d 6773  e_shapes_in_imgs
+00013a70: 280a 2020 2020 2020 2020 2020 2020 696d  (.            im
+00013a80: 6773 3d76 6964 656f 5f70 6174 682c 2073  gs=video_path, s
+00013a90: 6861 7065 733d 706f 6c79 676f 6e73 2c20  hapes=polygons, 
+00013aa0: 7665 7262 6f73 653d 4661 6c73 650a 2020  verbose=False.  
+00013ab0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00013ac0: 7469 6d65 2e73 6c65 6570 2831 290a 2020  time.sleep(1).  
+00013ad0: 2020 2020 2020 5f20 3d20 496d 6167 654d        _ = ImageM
+00013ae0: 6978 696e 2e69 6d67 5f73 7461 636b 5f74  ixin.img_stack_t
+00013af0: 6f5f 7669 6465 6f28 0a20 2020 2020 2020  o_video(.       
+00013b00: 2020 2020 2069 6d67 733d 706f 6c79 676f       imgs=polygo
+00013b10: 6e73 2c20 7361 7665 5f70 6174 683d 7361  ns, save_path=sa
+00013b20: 7665 5f70 6174 682c 2066 7073 3d76 6964  ve_path, fps=vid
+00013b30: 656f 5f6d 6574 615f 6461 7461 5b22 6670  eo_meta_data["fp
+00013b40: 7322 5d0a 2020 2020 2020 2020 290a 2020  s"].        ).  
+00013b50: 2020 7469 6d65 722e 7374 6f70 5f74 696d    timer.stop_tim
+00013b60: 6572 2829 0a20 2020 2073 7464 6f75 745f  er().    stdout_
+00013b70: 7375 6363 6573 7328 0a20 2020 2020 2020  success(.       
+00013b80: 206d 7367 3d66 2243 6972 636c 652d 6261   msg=f"Circle-ba
+00013b90: 7365 6420 6372 6f70 7065 6420 7b6c 656e  sed cropped {len
+00013ba0: 2876 6964 656f 5f66 696c 6573 297d 2066  (video_files)} f
+00013bb0: 696c 6573 2074 6f20 6469 7265 6374 6f72  iles to director
+00013bc0: 7920 7b6f 7574 5f64 6972 7d22 2c0a 2020  y {out_dir}",.  
+00013bd0: 2020 2020 2020 656c 6170 7365 645f 7469        elapsed_ti
+00013be0: 6d65 3d74 696d 6572 2e65 6c61 7073 6564  me=timer.elapsed
+00013bf0: 5f74 696d 655f 7374 722c 0a20 2020 2029  _time_str,.    )
+00013c00: 0a0a 0a64 6566 2063 726f 705f 7369 6e67  ...def crop_sing
+00013c10: 6c65 5f76 6964 656f 5f70 6f6c 7967 6f6e  le_video_polygon
+00013c20: 2866 696c 655f 7061 7468 3a20 556e 696f  (file_path: Unio
+00013c30: 6e5b 7374 722c 206f 732e 5061 7468 4c69  n[str, os.PathLi
+00013c40: 6b65 5d29 202d 3e20 4e6f 6e65 3a0a 2020  ke]) -> None:.  
+00013c50: 2020 2222 220a 2020 2020 4372 6f70 2061    """.    Crop a
+00013c60: 2076 6964 656f 2062 6173 6564 206f 6e20   video based on 
+00013c70: 706f 6c79 676f 6e61 6c20 7265 6769 6f6e  polygonal region
+00013c80: 7320 6f66 2069 6e74 6572 6573 7420 2852  s of interest (R
+00013c90: 4f49 7329 2073 656c 6563 7465 6420 6279  OIs) selected by
+00013ca0: 2074 6865 2075 7365 722e 0a0a 2020 2020   the user...    
+00013cb0: 3a70 6172 616d 2020 556e 696f 6e5b 7374  :param  Union[st
+00013cc0: 722c 206f 732e 5061 7468 4c69 6b65 5d20  r, os.PathLike] 
+00013cd0: 6669 6c65 5f70 6174 683a 2054 6865 2070  file_path: The p
+00013ce0: 6174 6820 746f 2074 6865 2069 6e70 7574  ath to the input
+00013cf0: 2076 6964 656f 2066 696c 652e 0a0a 2020   video file...  
+00013d00: 2020 2e2e 206e 6f74 653a 3a0a 2020 2020    .. note::.    
+00013d10: 2020 2054 6869 7320 6675 6e63 7469 6f6e     This function
+00013d20: 2063 726f 7073 2074 6865 2069 6e70 7574   crops the input
+00013d30: 2076 6964 656f 2062 6173 6564 206f 6e20   video based on 
+00013d40: 706f 6c79 676f 6e61 6c20 7265 6769 6f6e  polygonal region
+00013d50: 7320 6f66 2069 6e74 6572 6573 7420 2852  s of interest (R
+00013d60: 4f49 7329 2073 656c 6563 7465 6420 6279  OIs) selected by
+00013d70: 2074 6865 2075 7365 722e 0a20 2020 2020   the user..     
+00013d80: 2020 5468 6520 7573 6572 2069 7320 7072    The user is pr
+00013d90: 6f6d 7074 6564 2074 6f20 7365 6c65 6374  ompted to select
+00013da0: 2061 2070 6f6c 7967 6f6e 616c 2052 4f49   a polygonal ROI
+00013db0: 206f 6e20 7468 6520 7669 6465 6f20 6672   on the video fr
+00013dc0: 616d 652c 2061 6e64 2074 6865 2066 756e  ame, and the fun
+00013dd0: 6374 696f 6e20 7468 656e 2063 726f 7073  ction then crops
+00013de0: 2074 6865 2076 6964 656f 0a20 2020 2020   the video.     
+00013df0: 2020 6261 7365 6420 6f6e 2074 6865 2073    based on the s
+00013e00: 656c 6563 7465 6420 524f 492e 2054 6865  elected ROI. The
+00013e10: 2063 726f 7070 6564 2076 6964 656f 2069   cropped video i
+00013e20: 7320 7361 7665 6420 7769 7468 2022 5f70  s saved with "_p
+00013e30: 6f6c 7967 6f6e 5f63 726f 7070 6564 2220  olygon_cropped" 
+00013e40: 7375 6666 6978 2069 6e20 7468 6520 7361  suffix in the sa
+00013e50: 6d65 2064 6972 6563 746f 7279 0a20 2020  me directory.   
+00013e60: 2020 2020 6173 2074 6865 2069 6e70 7574      as the input
+00013e70: 2076 6964 656f 2066 696c 652e 0a0a 2020   video file...  
+00013e80: 2020 3a65 7861 6d70 6c65 3a0a 2020 2020    :example:.    
+00013e90: 3e3e 3e20 6372 6f70 5f73 696e 676c 655f  >>> crop_single_
+00013ea0: 7669 6465 6f5f 706f 6c79 676f 6e28 6669  video_polygon(fi
+00013eb0: 6c65 5f70 6174 683d 272f 5573 6572 732f  le_path='/Users/
+00013ec0: 7369 6d6f 6e2f 4465 736b 746f 702f 4147  simon/Desktop/AG
+00013ed0: 4752 4553 5349 5649 5459 5f34 5f31 315f  GRESSIVITY_4_11_
+00013ee0: 3231 5f54 7269 616c 5f32 5f63 616d 6572  21_Trial_2_camer
+00013ef0: 6131 5f72 6f74 6174 6564 5f32 3032 3430  a1_rotated_20240
+00013f00: 3231 3131 3433 3335 352e 6d70 3427 290a  211143355.mp4').
+00013f10: 2020 2020 2222 220a 0a20 2020 2064 6972      """..    dir
+00013f20: 2c20 7669 6465 6f5f 6e61 6d65 2c20 5f20  , video_name, _ 
+00013f30: 3d20 6765 745f 666e 5f65 7874 2866 696c  = get_fn_ext(fil
+00013f40: 6570 6174 683d 6669 6c65 5f70 6174 6829  epath=file_path)
+00013f50: 0a20 2020 2073 6176 655f 7061 7468 203d  .    save_path =
+00013f60: 206f 732e 7061 7468 2e6a 6f69 6e28 6469   os.path.join(di
+00013f70: 722c 2066 227b 7669 6465 6f5f 6e61 6d65  r, f"{video_name
+00013f80: 7d5f 706f 6c79 676f 6e5f 6372 6f70 7065  }_polygon_croppe
+00013f90: 642e 6d70 3422 290a 2020 2020 7669 6465  d.mp4").    vide
+00013fa0: 6f5f 6d65 7461 5f64 6174 6120 3d20 6765  o_meta_data = ge
+00013fb0: 745f 7669 6465 6f5f 6d65 7461 5f64 6174  t_video_meta_dat
+00013fc0: 6128 7669 6465 6f5f 7061 7468 3d66 696c  a(video_path=fil
+00013fd0: 655f 7061 7468 290a 2020 2020 6368 6563  e_path).    chec
+00013fe0: 6b5f 6669 6c65 5f65 7869 7374 5f61 6e64  k_file_exist_and
+00013ff0: 5f72 6561 6461 626c 6528 6669 6c65 5f70  _readable(file_p
+00014000: 6174 683d 6669 6c65 5f70 6174 6829 0a20  ath=file_path). 
+00014010: 2020 2070 6f6c 7967 6f6e 5f73 656c 6563     polygon_selec
+00014020: 746f 7220 3d20 524f 4953 656c 6563 746f  tor = ROISelecto
+00014030: 7250 6f6c 7967 6f6e 2870 6174 683d 6669  rPolygon(path=fi
+00014040: 6c65 5f70 6174 6829 0a20 2020 2070 6f6c  le_path).    pol
+00014050: 7967 6f6e 5f73 656c 6563 746f 722e 7275  ygon_selector.ru
+00014060: 6e28 290a 2020 2020 7469 6d65 7220 3d20  n().    timer = 
+00014070: 5369 6d62 6154 696d 6572 2873 7461 7274  SimbaTimer(start
+00014080: 3d54 7275 6529 0a20 2020 2076 6572 7469  =True).    verti
+00014090: 6365 7320 3d20 706f 6c79 676f 6e5f 7365  ces = polygon_se
+000140a0: 6c65 6374 6f72 2e70 6f6c 7967 6f6e 5f76  lector.polygon_v
+000140b0: 6572 7469 6365 730a 2020 2020 706f 6c79  ertices.    poly
+000140c0: 676f 6e20 3d20 506f 6c79 676f 6e28 7665  gon = Polygon(ve
+000140d0: 7274 6963 6573 290a 2020 2020 706f 6c79  rtices).    poly
+000140e0: 676f 6e73 203d 205b 706f 6c79 676f 6e20  gons = [polygon 
+000140f0: 666f 7220 7820 696e 2072 616e 6765 2876  for x in range(v
+00014100: 6964 656f 5f6d 6574 615f 6461 7461 5b22  ideo_meta_data["
+00014110: 6672 616d 655f 636f 756e 7422 5d29 5d0a  frame_count"])].
+00014120: 2020 2020 6966 2028 706c 6174 666f 726d      if (platform
+00014130: 2e73 7973 7465 6d28 2920 3d3d 2022 4461  .system() == "Da
+00014140: 7277 696e 2229 2061 6e64 2028 6d75 6c74  rwin") and (mult
+00014150: 6970 726f 6365 7373 696e 672e 6765 745f  iprocessing.get_
+00014160: 7374 6172 745f 6d65 7468 6f64 2829 2069  start_method() i
+00014170: 7320 4e6f 6e65 293a 0a20 2020 2020 2020  s None):.       
+00014180: 206d 756c 7469 7072 6f63 6573 7369 6e67   multiprocessing
+00014190: 2e73 6574 5f73 7461 7274 5f6d 6574 686f  .set_start_metho
+000141a0: 6428 2273 7061 776e 222c 2066 6f72 6365  d("spawn", force
+000141b0: 3d46 616c 7365 290a 2020 2020 706f 6c79  =False).    poly
+000141c0: 676f 6e73 203d 2049 6d61 6765 4d69 7869  gons = ImageMixi
+000141d0: 6e28 292e 736c 6963 655f 7368 6170 6573  n().slice_shapes
+000141e0: 5f69 6e5f 696d 6773 280a 2020 2020 2020  _in_imgs(.      
+000141f0: 2020 696d 6773 3d66 696c 655f 7061 7468    imgs=file_path
+00014200: 2c20 7368 6170 6573 3d70 6f6c 7967 6f6e  , shapes=polygon
+00014210: 732c 2076 6572 626f 7365 3d54 7275 650a  s, verbose=True.
+00014220: 2020 2020 290a 2020 2020 5f20 3d20 496d      ).    _ = Im
+00014230: 6167 654d 6978 696e 2e69 6d67 5f73 7461  ageMixin.img_sta
+00014240: 636b 5f74 6f5f 7669 6465 6f28 0a20 2020  ck_to_video(.   
+00014250: 2020 2020 2069 6d67 733d 706f 6c79 676f       imgs=polygo
+00014260: 6e73 2c20 7361 7665 5f70 6174 683d 7361  ns, save_path=sa
+00014270: 7665 5f70 6174 682c 2066 7073 3d76 6964  ve_path, fps=vid
+00014280: 656f 5f6d 6574 615f 6461 7461 5b22 6670  eo_meta_data["fp
+00014290: 7322 5d0a 2020 2020 290a 2020 2020 7469  s"].    ).    ti
+000142a0: 6d65 722e 7374 6f70 5f74 696d 6572 2829  mer.stop_timer()
+000142b0: 0a20 2020 2073 7464 6f75 745f 7375 6363  .    stdout_succ
+000142c0: 6573 7328 0a20 2020 2020 2020 206d 7367  ess(.        msg
+000142d0: 3d66 2250 6f6c 7967 6f6e 2d62 6173 6564  =f"Polygon-based
+000142e0: 2063 726f 7070 6564 2073 6176 6564 2061   cropped saved a
+000142f0: 7420 746f 207b 7361 7665 5f70 6174 687d  t to {save_path}
+00014300: 222c 0a20 2020 2020 2020 2065 6c61 7073  ",.        elaps
+00014310: 6564 5f74 696d 653d 7469 6d65 722e 656c  ed_time=timer.el
+00014320: 6170 7365 645f 7469 6d65 5f73 7472 2c0a  apsed_time_str,.
+00014330: 2020 2020 290a 0a0a 6465 6620 6372 6f70      )...def crop
+00014340: 5f6d 756c 7469 706c 655f 7669 6465 6f73  _multiple_videos
+00014350: 5f70 6f6c 7967 6f6e 7328 0a20 2020 2069  _polygons(.    i
+00014360: 6e5f 6469 723a 2055 6e69 6f6e 5b73 7472  n_dir: Union[str
+00014370: 2c20 6f73 2e50 6174 684c 696b 655d 2c20  , os.PathLike], 
+00014380: 6f75 745f 6469 723a 2055 6e69 6f6e 5b73  out_dir: Union[s
+00014390: 7472 2c20 6f73 2e50 6174 684c 696b 655d  tr, os.PathLike]
+000143a0: 0a29 202d 3e20 4e6f 6e65 3a0a 2020 2020  .) -> None:.    
+000143b0: 2222 220a 2020 2020 4372 6f70 206d 756c  """.    Crop mul
+000143c0: 7469 706c 6520 7669 6465 6f73 2062 6173  tiple videos bas
+000143d0: 6564 206f 6e20 706f 6c79 676f 6e61 6c20  ed on polygonal 
+000143e0: 7265 6769 6f6e 7320 6f66 2069 6e74 6572  regions of inter
+000143f0: 6573 7420 2852 4f49 7329 2073 656c 6563  est (ROIs) selec
+00014400: 7465 6420 6279 2074 6865 2075 7365 722e  ted by the user.
+00014410: 0a0a 2020 2020 3a70 6172 616d 2020 556e  ..    :param  Un
+00014420: 696f 6e5b 7374 722c 206f 732e 5061 7468  ion[str, os.Path
+00014430: 4c69 6b65 5d20 696e 5f64 6972 3a20 5468  Like] in_dir: Th
+00014440: 6520 6469 7265 6374 6f72 7920 636f 6e74  e directory cont
+00014450: 6169 6e69 6e67 2069 6e70 7574 2076 6964  aining input vid
+00014460: 656f 2066 696c 6573 2e0a 2020 2020 3a70  eo files..    :p
+00014470: 6172 616d 2020 556e 696f 6e5b 7374 722c  aram  Union[str,
+00014480: 206f 732e 5061 7468 4c69 6b65 5d20 6f75   os.PathLike] ou
+00014490: 745f 6469 723a 2054 6865 2064 6972 6563  t_dir: The direc
+000144a0: 746f 7279 2074 6f20 7361 7665 2074 6865  tory to save the
+000144b0: 2063 726f 7070 6564 2076 6964 656f 2066   cropped video f
+000144c0: 696c 6573 2e0a 0a20 2020 202e 2e20 6e6f  iles...    .. no
+000144d0: 7465 3a3a 0a20 2020 2020 2020 5468 6973  te::.       This
+000144e0: 2066 756e 6374 696f 6e20 6372 6f70 7320   function crops 
+000144f0: 6d75 6c74 6970 6c65 2076 6964 656f 7320  multiple videos 
+00014500: 6261 7365 6420 6f6e 2070 6f6c 7967 6f6e  based on polygon
+00014510: 616c 2052 4f49 7320 7365 6c65 6374 6564  al ROIs selected
+00014520: 2062 7920 7468 6520 7573 6572 2e0a 2020   by the user..  
+00014530: 2020 2020 2054 6865 2075 7365 7220 6973       The user is
+00014540: 2061 736b 6564 2074 6f20 6465 6669 6e65   asked to define
+00014550: 2061 2070 6f6c 7967 6f6e 206d 616e 7561   a polygon manua
+00014560: 6c6c 7920 696e 206f 6e65 2076 6964 656f  lly in one video
+00014570: 2077 6974 6869 6e20 7468 6520 696e 7075   within the inpu
+00014580: 7420 6469 7265 6374 6f72 792e 0a20 2020  t directory..   
+00014590: 2020 2020 5468 6520 6675 6e63 7469 6f6e      The function
+000145a0: 2074 6865 6e20 6372 6f70 7320 616c 6c20   then crops all 
+000145b0: 7468 6520 7669 6465 6f20 696e 2074 6865  the video in the
+000145c0: 2069 6e70 7574 2064 6972 6563 746f 7279   input directory
+000145d0: 2061 6363 6f72 6469 6e67 2074 6f20 7468   according to th
+000145e0: 6520 7368 6170 6520 6465 6669 6e65 640a  e shape defined.
+000145f0: 2020 2020 2020 2075 7369 6e67 2074 6865         using the
+00014600: 2066 6972 7374 2076 6964 656f 2061 6e64   first video and
+00014610: 2073 6176 6573 2074 6865 2076 6964 656f   saves the video
+00014620: 7320 696e 2074 6865 2060 606f 7574 5f64  s in the ``out_d
+00014630: 6972 6060 2077 6974 6820 7468 6520 7361  ir`` with the sa
+00014640: 6d65 2066 696c 656e 616d 6573 2061 7320  me filenames as 
+00014650: 7468 6520 6f72 6967 696e 616c 2076 6964  the original vid
+00014660: 656f 732e 2e0a 0a20 2020 203a 6578 616d  eos....    :exam
+00014670: 706c 653a 0a20 2020 203e 3e3e 2063 726f  ple:.    >>> cro
+00014680: 705f 6d75 6c74 6970 6c65 5f76 6964 656f  p_multiple_video
+00014690: 735f 706f 6c79 676f 6e73 2869 6e5f 6469  s_polygons(in_di
+000146a0: 723d 272f 5573 6572 732f 7369 6d6f 6e2f  r='/Users/simon/
+000146b0: 4465 736b 746f 702f 6564 6974 6564 2f74  Desktop/edited/t
+000146c0: 6573 7473 272c 206f 7574 5f64 6972 3d27  ests', out_dir='
+000146d0: 2f55 7365 7273 2f73 696d 6f6e 2f44 6573  /Users/simon/Des
+000146e0: 6b74 6f70 2729 0a20 2020 2022 2222 0a0a  ktop').    """..
+000146f0: 2020 2020 6368 6563 6b5f 6966 5f64 6972      check_if_dir
+00014700: 5f65 7869 7374 7328 696e 5f64 6972 3d69  _exists(in_dir=i
+00014710: 6e5f 6469 7229 0a20 2020 2063 6865 636b  n_dir).    check
+00014720: 5f69 665f 6469 725f 6578 6973 7473 2869  _if_dir_exists(i
+00014730: 6e5f 6469 723d 6f75 745f 6469 7229 0a20  n_dir=out_dir). 
+00014740: 2020 2076 6964 656f 5f66 696c 6573 203d     video_files =
+00014750: 2066 696e 645f 616c 6c5f 7669 6465 6f73   find_all_videos
+00014760: 5f69 6e5f 6469 7265 6374 6f72 7928 6469  _in_directory(di
+00014770: 7265 6374 6f72 793d 696e 5f64 6972 290a  rectory=in_dir).
+00014780: 2020 2020 706f 6c79 676f 6e5f 7365 6c65      polygon_sele
+00014790: 6374 6f72 203d 2052 4f49 5365 6c65 6374  ctor = ROISelect
+000147a0: 6f72 506f 6c79 676f 6e28 7061 7468 3d6f  orPolygon(path=o
+000147b0: 732e 7061 7468 2e6a 6f69 6e28 696e 5f64  s.path.join(in_d
+000147c0: 6972 2c20 7669 6465 6f5f 6669 6c65 735b  ir, video_files[
+000147d0: 305d 2929 0a20 2020 2070 6f6c 7967 6f6e  0])).    polygon
+000147e0: 5f73 656c 6563 746f 722e 7275 6e28 290a  _selector.run().
+000147f0: 2020 2020 7665 7274 6963 6573 203d 2070      vertices = p
+00014800: 6f6c 7967 6f6e 5f73 656c 6563 746f 722e  olygon_selector.
+00014810: 706f 6c79 676f 6e5f 7665 7274 6963 6573  polygon_vertices
+00014820: 0a20 2020 2070 6f6c 7967 6f6e 203d 2050  .    polygon = P
+00014830: 6f6c 7967 6f6e 2876 6572 7469 6365 7329  olygon(vertices)
+00014840: 0a20 2020 2074 696d 6572 203d 2053 696d  .    timer = Sim
+00014850: 6261 5469 6d65 7228 7374 6172 743d 5472  baTimer(start=Tr
+00014860: 7565 290a 2020 2020 6966 2028 706c 6174  ue).    if (plat
+00014870: 666f 726d 2e73 7973 7465 6d28 2920 3d3d  form.system() ==
+00014880: 2022 4461 7277 696e 2229 2061 6e64 2028   "Darwin") and (
+00014890: 6d75 6c74 6970 726f 6365 7373 696e 672e  multiprocessing.
+000148a0: 6765 745f 7374 6172 745f 6d65 7468 6f64  get_start_method
+000148b0: 2829 2069 7320 4e6f 6e65 293a 0a20 2020  () is None):.   
+000148c0: 2020 2020 206d 756c 7469 7072 6f63 6573       multiproces
+000148d0: 7369 6e67 2e73 6574 5f73 7461 7274 5f6d  sing.set_start_m
+000148e0: 6574 686f 6428 2273 7061 776e 222c 2066  ethod("spawn", f
+000148f0: 6f72 6365 3d54 7275 6529 0a20 2020 2066  orce=True).    f
+00014900: 6f72 2076 6964 656f 5f63 6e74 2c20 7669  or video_cnt, vi
+00014910: 6465 6f5f 7061 7468 2069 6e20 656e 756d  deo_path in enum
+00014920: 6572 6174 6528 7669 6465 6f5f 6669 6c65  erate(video_file
+00014930: 7329 3a0a 2020 2020 2020 2020 7072 696e  s):.        prin
+00014940: 7428 0a20 2020 2020 2020 2020 2020 2066  t(.            f
+00014950: 2250 6f6c 7967 6f6e 2063 726f 7070 696e  "Polygon croppin
+00014960: 6720 7669 6465 6f20 7b76 6964 656f 5f70  g video {video_p
+00014970: 6174 687d 2028 7b76 6964 656f 5f63 6e74  ath} ({video_cnt
+00014980: 2b31 7d2f 7b6c 656e 2876 6964 656f 5f66  +1}/{len(video_f
+00014990: 696c 6573 297d 292e 2e2e 220a 2020 2020  iles)})...".    
+000149a0: 2020 2020 290a 2020 2020 2020 2020 7669      ).        vi
+000149b0: 6465 6f5f 7061 7468 203d 206f 732e 7061  deo_path = os.pa
+000149c0: 7468 2e6a 6f69 6e28 696e 5f64 6972 2c20  th.join(in_dir, 
+000149d0: 7669 6465 6f5f 7061 7468 290a 2020 2020  video_path).    
+000149e0: 2020 2020 5f2c 2076 6964 656f 5f6e 616d      _, video_nam
+000149f0: 652c 205f 203d 2067 6574 5f66 6e5f 6578  e, _ = get_fn_ex
+00014a00: 7428 6669 6c65 7061 7468 3d76 6964 656f  t(filepath=video
+00014a10: 5f70 6174 6829 0a20 2020 2020 2020 2073  _path).        s
+00014a20: 6176 655f 7061 7468 203d 206f 732e 7061  ave_path = os.pa
+00014a30: 7468 2e6a 6f69 6e28 6f75 745f 6469 722c  th.join(out_dir,
+00014a40: 2066 227b 7669 6465 6f5f 6e61 6d65 7d2e   f"{video_name}.
+00014a50: 6d70 3422 290a 2020 2020 2020 2020 7669  mp4").        vi
+00014a60: 6465 6f5f 6d65 7461 5f64 6174 6120 3d20  deo_meta_data = 
+00014a70: 6765 745f 7669 6465 6f5f 6d65 7461 5f64  get_video_meta_d
+00014a80: 6174 6128 7669 6465 6f5f 7061 7468 3d76  ata(video_path=v
+00014a90: 6964 656f 5f70 6174 6829 0a20 2020 2020  ideo_path).     
+00014aa0: 2020 2070 6f6c 7967 6f6e 7320 3d20 5b70     polygons = [p
+00014ab0: 6f6c 7967 6f6e 2066 6f72 2078 2069 6e20  olygon for x in 
+00014ac0: 7261 6e67 6528 7669 6465 6f5f 6d65 7461  range(video_meta
+00014ad0: 5f64 6174 615b 2266 7261 6d65 5f63 6f75  _data["frame_cou
+00014ae0: 6e74 225d 295d 0a20 2020 2020 2020 2070  nt"])].        p
+00014af0: 6f6c 7967 6f6e 7320 3d20 496d 6167 654d  olygons = ImageM
+00014b00: 6978 696e 2829 2e73 6c69 6365 5f73 6861  ixin().slice_sha
+00014b10: 7065 735f 696e 5f69 6d67 7328 0a20 2020  pes_in_imgs(.   
+00014b20: 2020 2020 2020 2020 2069 6d67 733d 7669           imgs=vi
+00014b30: 6465 6f5f 7061 7468 2c20 7368 6170 6573  deo_path, shapes
+00014b40: 3d70 6f6c 7967 6f6e 732c 2076 6572 626f  =polygons, verbo
+00014b50: 7365 3d46 616c 7365 0a20 2020 2020 2020  se=False.       
+00014b60: 2029 0a20 2020 2020 2020 205f 203d 2049   ).        _ = I
+00014b70: 6d61 6765 4d69 7869 6e2e 696d 675f 7374  mageMixin.img_st
+00014b80: 6163 6b5f 746f 5f76 6964 656f 280a 2020  ack_to_video(.  
+00014b90: 2020 2020 2020 2020 2020 696d 6773 3d70            imgs=p
+00014ba0: 6f6c 7967 6f6e 732c 2073 6176 655f 7061  olygons, save_pa
+00014bb0: 7468 3d73 6176 655f 7061 7468 2c20 6670  th=save_path, fp
+00014bc0: 733d 7669 6465 6f5f 6d65 7461 5f64 6174  s=video_meta_dat
+00014bd0: 615b 2266 7073 225d 0a20 2020 2020 2020  a["fps"].       
+00014be0: 2029 0a20 2020 2074 696d 6572 2e73 746f   ).    timer.sto
+00014bf0: 705f 7469 6d65 7228 290a 2020 2020 7374  p_timer().    st
+00014c00: 646f 7574 5f73 7563 6365 7373 280a 2020  dout_success(.  
+00014c10: 2020 2020 2020 6d73 673d 6622 506f 6c79        msg=f"Poly
+00014c20: 676f 6e2d 6261 7365 6420 6372 6f70 7065  gon-based croppe
+00014c30: 6420 7b6c 656e 2876 6964 656f 5f66 696c  d {len(video_fil
+00014c40: 6573 297d 2066 696c 6573 2074 6f20 6469  es)} files to di
+00014c50: 7265 6374 6f72 7920 7b6f 7574 5f64 6972  rectory {out_dir
+00014c60: 7d22 2c0a 2020 2020 2020 2020 656c 6170  }",.        elap
+00014c70: 7365 645f 7469 6d65 3d74 696d 6572 2e65  sed_time=timer.e
+00014c80: 6c61 7073 6564 5f74 696d 655f 7374 722c  lapsed_time_str,
+00014c90: 0a20 2020 2029 0a0a 0a64 6566 2072 6573  .    )...def res
+00014ca0: 697a 655f 7669 6465 6f73 5f62 795f 6865  ize_videos_by_he
+00014cb0: 6967 6874 280a 2020 2020 7669 6465 6f5f  ight(.    video_
+00014cc0: 7061 7468 733a 204c 6973 745b 556e 696f  paths: List[Unio
+00014cd0: 6e5b 7374 722c 206f 732e 5061 7468 4c69  n[str, os.PathLi
+00014ce0: 6b65 5d5d 2c0a 2020 2020 6865 6967 6874  ke]],.    height
+00014cf0: 3a20 556e 696f 6e5b 696e 742c 2073 7472  : Union[int, str
+00014d00: 5d2c 0a20 2020 206f 7665 7277 7269 7465  ],.    overwrite
+00014d10: 3a20 4f70 7469 6f6e 616c 5b62 6f6f 6c5d  : Optional[bool]
+00014d20: 203d 2046 616c 7365 2c0a 2020 2020 7361   = False,.    sa
+00014d30: 7665 5f64 6972 3a20 4f70 7469 6f6e 616c  ve_dir: Optional
+00014d40: 5b55 6e69 6f6e 5b73 7472 2c20 6f73 2e50  [Union[str, os.P
+00014d50: 6174 684c 696b 655d 5d20 3d20 4e6f 6e65  athLike]] = None
+00014d60: 2c0a 2020 2020 6770 753a 204f 7074 696f  ,.    gpu: Optio
+00014d70: 6e61 6c5b 626f 6f6c 5d20 3d20 4661 6c73  nal[bool] = Fals
+00014d80: 652c 0a20 2020 2076 6572 626f 7365 3a20  e,.    verbose: 
+00014d90: 4f70 7469 6f6e 616c 5b62 6f6f 6c5d 203d  Optional[bool] =
+00014da0: 2054 7275 652c 0a29 202d 3e20 556e 696f   True,.) -> Unio
+00014db0: 6e5b 4e6f 6e65 2c20 4c69 7374 5b55 6e69  n[None, List[Uni
+00014dc0: 6f6e 5b4e 6f6e 652c 2073 7472 2c20 6f73  on[None, str, os
+00014dd0: 2e50 6174 684c 696b 655d 5d5d 3a0a 2020  .PathLike]]]:.  
+00014de0: 2020 2222 220a 2020 2020 5265 2d73 697a    """.    Re-siz
+00014df0: 6520 6120 6c69 7374 206f 6620 7669 6465  e a list of vide
+00014e00: 6f73 2074 6f20 6120 7370 6563 6966 6965  os to a specifie
+00014e10: 6420 6865 6967 6874 2077 6869 6c65 2072  d height while r
+00014e20: 6574 6169 6e69 6e67 2074 6865 6972 2061  etaining their a
+00014e30: 7370 6563 7420 7261 7469 6f73 2e0a 0a20  spect ratios... 
+00014e40: 2020 203a 7061 7261 6d20 4c69 7374 5b55     :param List[U
+00014e50: 6e69 6f6e 5b73 7472 2c20 6f73 2e50 6174  nion[str, os.Pat
+00014e60: 684c 696b 655d 5d20 7669 6465 6f5f 7061  hLike]] video_pa
+00014e70: 7468 733a 204c 6973 7420 6f66 2070 6174  ths: List of pat
+00014e80: 6820 746f 2076 6964 656f 732e 0a20 2020  h to videos..   
+00014e90: 203a 7061 7261 6d20 556e 696f 6e5b 696e   :param Union[in
+00014ea0: 742c 2073 7472 5d20 6865 6967 6874 3a20  t, str] height: 
+00014eb0: 5468 6520 6865 6967 6874 206f 6620 7468  The height of th
+00014ec0: 6520 6f75 7470 7574 2076 6964 656f 732e  e output videos.
+00014ed0: 2049 6620 696e 742c 2074 6865 6e20 7468   If int, then th
+00014ee0: 6520 6865 6967 6874 2069 6e20 7069 7865  e height in pixe
+00014ef0: 6c73 2e20 4966 2073 7472 2c20 7468 656e  ls. If str, then
+00014f00: 2074 6865 2069 6e64 6578 2069 6e20 6060   the index in ``
+00014f10: 7669 6465 6f5f 7061 7468 7360 6020 6672  video_paths`` fr
+00014f20: 6f6d 2077 6869 6368 2074 6f20 6772 6162  om which to grab
+00014f30: 2074 6865 2068 6569 6768 742e 0a20 2020   the height..   
+00014f40: 203a 7061 7261 6d20 4f70 7469 6f6e 616c   :param Optional
+00014f50: 5b62 6f6f 6c5d 206f 7665 7277 7269 7465  [bool] overwrite
+00014f60: 3a20 4966 2054 7275 652c 2074 6865 6e20  : If True, then 
+00014f70: 6f76 6572 7772 6974 6573 2074 6865 206f  overwrites the o
+00014f80: 7269 6769 6e61 6c20 7669 6465 6f73 2e20  riginal videos. 
+00014f90: 4465 6661 756c 7420 4661 6c73 652e 0a20  Default False.. 
+00014fa0: 2020 203a 7061 7261 6d20 4f70 7469 6f6e     :param Option
+00014fb0: 616c 5b55 6e69 6f6e 5b73 7472 2c20 6f73  al[Union[str, os
+00014fc0: 2e50 6174 684c 696b 655d 5d20 7361 7665  .PathLike]] save
+00014fd0: 5f64 6972 3a20 4966 206e 6f74 204e 6f6e  _dir: If not Non
+00014fe0: 652c 2074 6865 6e20 7468 6520 6469 7265  e, then the dire
+00014ff0: 6374 6f72 7920 7768 6572 6520 746f 2073  ctory where to s
+00015000: 746f 7265 2074 6865 2072 652d 7369 7a65  tore the re-size
+00015010: 6420 7669 6465 6f73 2e0a 2020 2020 3a70  d videos..    :p
+00015020: 6172 616d 204f 7074 696f 6e61 6c5b 626f  aram Optional[bo
+00015030: 6f6c 5d20 6770 753a 2049 6620 5472 7565  ol] gpu: If True
+00015040: 2c20 7468 656e 2075 7365 2046 466d 7065  , then use FFmpe
+00015050: 6720 4750 5520 636f 6465 6373 2e20 4465  g GPU codecs. De
+00015060: 6661 756c 7420 4661 6c73 652e 0a20 2020  fault False..   
+00015070: 203a 7061 7261 6d20 4f70 7469 6f6e 616c   :param Optional
+00015080: 5b62 6f6f 6c5d 2076 6572 626f 7365 3a20  [bool] verbose: 
+00015090: 4966 2054 7275 652c 2070 7269 6e74 7320  If True, prints 
+000150a0: 7072 6f67 7265 7373 2e20 4465 6661 756c  progress. Defaul
+000150b0: 7420 5472 7565 2e0a 2020 2020 3a72 6574  t True..    :ret
+000150c0: 7572 6e20 556e 696f 6e5b 4e6f 6e65 2c20  urn Union[None, 
+000150d0: 4c69 7374 5b55 6e69 6f6e 5b73 7472 2c20  List[Union[str, 
+000150e0: 6f73 2e50 6174 684c 696b 655d 5d5d 3a20  os.PathLike]]]: 
+000150f0: 4966 2073 6176 655f 6469 7220 6973 206e  If save_dir is n
+00015100: 6f74 204e 6f6e 652c 2072 6574 7572 6e73  ot None, returns
+00015110: 2074 6865 2070 6174 6873 206f 6620 7468   the paths of th
+00015120: 6520 7265 2d73 697a 6564 2076 6964 656f  e re-sized video
+00015130: 732e 2045 6c73 6520 7265 7475 726e 7320  s. Else returns 
+00015140: 656d 7074 7920 6c69 7374 2e0a 0a20 2020  empty list...   
+00015150: 203a 6578 616d 706c 653a 0a20 2020 203e   :example:.    >
+00015160: 3e3e 2076 6964 656f 5f70 6174 6873 3d20  >> video_paths= 
+00015170: 5b27 2f55 7365 7273 2f73 696d 6f6e 2f44  ['/Users/simon/D
+00015180: 6573 6b74 6f70 2f65 6e76 732f 7369 6d62  esktop/envs/simb
+00015190: 612f 7472 6f75 626c 6573 686f 6f74 696e  a/troubleshootin
+000151a0: 672f 5241 545f 4e4f 522f 7072 6f6a 6563  g/RAT_NOR/projec
+000151b0: 745f 666f 6c64 6572 2f76 6964 656f 732f  t_folder/videos/
+000151c0: 7465 7374 2f30 3831 3032 3032 315f 444f  test/08102021_DO
+000151d0: 545f 5261 7437 5f38 2832 292e 6d70 3427  T_Rat7_8(2).mp4'
+000151e0: 2c20 272f 5573 6572 732f 7369 6d6f 6e2f  , '/Users/simon/
+000151f0: 4465 736b 746f 702f 656e 7673 2f73 696d  Desktop/envs/sim
+00015200: 6261 2f74 726f 7562 6c65 7368 6f6f 7469  ba/troubleshooti
+00015210: 6e67 2f52 4154 5f4e 4f52 2f70 726f 6a65  ng/RAT_NOR/proje
+00015220: 6374 5f66 6f6c 6465 722f 7669 6465 6f73  ct_folder/videos
+00015230: 2f74 6573 742f 3038 3130 3230 3231 5f44  /test/08102021_D
+00015240: 4f54 5f52 6174 3131 5f31 322e 6d70 3427  OT_Rat11_12.mp4'
+00015250: 5d0a 2020 2020 3e3e 3e20 5f20 3d20 7265  ].    >>> _ = re
+00015260: 7369 7a65 5f76 6964 656f 735f 6279 5f68  size_videos_by_h
+00015270: 6569 6768 7428 7669 6465 6f5f 7061 7468  eight(video_path
+00015280: 733d 7669 6465 6f5f 7061 7468 732c 2068  s=video_paths, h
+00015290: 6569 6768 743d 3330 302c 206f 7665 7277  eight=300, overw
+000152a0: 7269 7465 3d46 616c 7365 2c20 7361 7665  rite=False, save
+000152b0: 5f64 6972 3d27 2f55 7365 7273 2f73 696d  _dir='/Users/sim
+000152c0: 6f6e 2f44 6573 6b74 6f70 2f65 6e76 732f  on/Desktop/envs/
+000152d0: 7369 6d62 612f 7472 6f75 626c 6573 686f  simba/troublesho
+000152e0: 6f74 696e 672f 5241 545f 4e4f 522f 7072  oting/RAT_NOR/pr
+000152f0: 6f6a 6563 745f 666f 6c64 6572 2f76 6964  oject_folder/vid
+00015300: 656f 732f 7465 7374 2f6e 6577 2729 0a20  eos/test/new'). 
+00015310: 2020 2022 2222 0a20 2020 2074 696d 6572     """.    timer
+00015320: 203d 2053 696d 6261 5469 6d65 7228 7374   = SimbaTimer(st
+00015330: 6172 743d 5472 7565 290a 2020 2020 6966  art=True).    if
+00015340: 2028 6e6f 7420 6f76 6572 7772 6974 6529   (not overwrite)
+00015350: 2061 6e64 2028 7361 7665 5f64 6972 2069   and (save_dir i
+00015360: 7320 4e6f 6e65 293a 0a20 2020 2020 2020  s None):.       
+00015370: 2072 6169 7365 2049 6e76 616c 6964 496e   raise InvalidIn
+00015380: 7075 7445 7272 6f72 280a 2020 2020 2020  putError(.      
+00015390: 2020 2020 2020 6d73 673d 2250 6173 7320        msg="Pass 
+000153a0: 6120 7361 7665 5f64 6972 204f 5220 7365  a save_dir OR se
+000153b0: 7420 6f76 6572 7772 6974 6520 746f 2054  t overwrite to T
+000153c0: 7275 6522 2c0a 2020 2020 2020 2020 2020  rue",.          
+000153d0: 2020 736f 7572 6365 3d72 6573 697a 655f    source=resize_
+000153e0: 7669 6465 6f73 5f62 795f 6865 6967 6874  videos_by_height
+000153f0: 2e5f 5f6e 616d 655f 5f2c 0a20 2020 2020  .__name__,.     
+00015400: 2020 2029 0a20 2020 2065 6c69 6620 286f     ).    elif (o
+00015410: 7665 7277 7269 7465 2920 616e 6420 2873  verwrite) and (s
+00015420: 6176 655f 6469 7220 6973 206e 6f74 204e  ave_dir is not N
+00015430: 6f6e 6529 3a0a 2020 2020 2020 2020 7261  one):.        ra
+00015440: 6973 6520 496e 7661 6c69 6449 6e70 7574  ise InvalidInput
+00015450: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+00015460: 2020 206d 7367 3d22 5061 7373 2045 4954     msg="Pass EIT
+00015470: 4845 5220 6f76 6572 7772 6974 6520 6173  HER overwrite as
+00015480: 2054 7275 6520 4f52 2070 6173 7320 6120   True OR pass a 
+00015490: 7361 7665 5f64 6972 222c 0a20 2020 2020  save_dir",.     
+000154a0: 2020 2020 2020 2073 6f75 7263 653d 7265         source=re
+000154b0: 7369 7a65 5f76 6964 656f 735f 6279 5f68  size_videos_by_h
+000154c0: 6569 6768 742e 5f5f 6e61 6d65 5f5f 2c0a  eight.__name__,.
+000154d0: 2020 2020 2020 2020 290a 2020 2020 6966          ).    if
+000154e0: 2073 6176 655f 6469 7220 6973 206e 6f74   save_dir is not
+000154f0: 204e 6f6e 653a 0a20 2020 2020 2020 2069   None:.        i
+00015500: 6620 6e6f 7420 6f73 2e70 6174 682e 6973  f not os.path.is
+00015510: 6469 7228 7361 7665 5f64 6972 293a 0a20  dir(save_dir):. 
+00015520: 2020 2020 2020 2020 2020 206f 732e 6d61             os.ma
+00015530: 6b65 6469 7273 2873 6176 655f 6469 7229  kedirs(save_dir)
+00015540: 0a20 2020 2063 6865 636b 5f76 616c 6964  .    check_valid
+00015550: 5f6c 7374 280a 2020 2020 2020 2020 6461  _lst(.        da
+00015560: 7461 3d76 6964 656f 5f70 6174 6873 2c20  ta=video_paths, 
+00015570: 736f 7572 6365 3d72 6573 697a 655f 7669  source=resize_vi
+00015580: 6465 6f73 5f62 795f 6865 6967 6874 2e5f  deos_by_height._
+00015590: 5f6e 616d 655f 5f2c 206d 696e 5f6c 656e  _name__, min_len
+000155a0: 3d31 0a20 2020 2029 0a20 2020 205f 203d  =1.    ).    _ =
+000155b0: 205b 6368 6563 6b5f 6669 6c65 5f65 7869   [check_file_exi
+000155c0: 7374 5f61 6e64 5f72 6561 6461 626c 6528  st_and_readable(
+000155d0: 7829 2066 6f72 2078 2069 6e20 7669 6465  x) for x in vide
+000155e0: 6f5f 7061 7468 735d 0a20 2020 206e 6577  o_paths].    new
+000155f0: 5f76 6964 656f 5f70 6174 6873 203d 205b  _video_paths = [
+00015600: 5d0a 2020 2020 6966 2069 7369 6e73 7461  ].    if isinsta
+00015610: 6e63 6528 6865 6967 6874 2c20 7374 7229  nce(height, str)
+00015620: 3a0a 2020 2020 2020 2020 6368 6563 6b5f  :.        check_
+00015630: 696e 7428 0a20 2020 2020 2020 2020 2020  int(.           
+00015640: 206e 616d 653d 6622 7b72 6573 697a 655f   name=f"{resize_
+00015650: 7669 6465 6f73 5f62 795f 6865 6967 6874  videos_by_height
+00015660: 2e5f 5f6e 616d 655f 5f7d 2068 6569 6768  .__name__} heigh
+00015670: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
+00015680: 7661 6c75 653d 6865 6967 6874 2c0a 2020  value=height,.  
+00015690: 2020 2020 2020 2020 2020 6d69 6e5f 7661            min_va
+000156a0: 6c75 653d 302c 0a20 2020 2020 2020 2020  lue=0,.         
+000156b0: 2020 206d 6178 5f76 616c 7565 3d6c 656e     max_value=len
+000156c0: 2876 6964 656f 5f70 6174 6873 292c 0a20  (video_paths),. 
+000156d0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000156e0: 2076 6964 656f 5f68 6569 6768 7473 203d   video_heights =
+000156f0: 205b 5d0a 2020 2020 2020 2020 666f 7220   [].        for 
+00015700: 6920 696e 2076 6964 656f 5f70 6174 6873  i in video_paths
+00015710: 3a0a 2020 2020 2020 2020 2020 2020 7669  :.            vi
+00015720: 6465 6f5f 6865 6967 6874 732e 6170 7065  deo_heights.appe
+00015730: 6e64 2867 6574 5f76 6964 656f 5f6d 6574  nd(get_video_met
+00015740: 615f 6461 7461 2876 6964 656f 5f70 6174  a_data(video_pat
+00015750: 683d 6929 5b22 6865 6967 6874 225d 290a  h=i)["height"]).
+00015760: 2020 2020 2020 2020 6865 6967 6874 203d          height =
+00015770: 2076 6964 656f 5f68 6569 6768 7473 5b69   video_heights[i
+00015780: 6e74 2868 6569 6768 7429 5d0a 2020 2020  nt(height)].    
+00015790: 666f 7220 636e 742c 2076 6964 656f 5f70  for cnt, video_p
+000157a0: 6174 6820 696e 2065 6e75 6d65 7261 7465  ath in enumerate
+000157b0: 2876 6964 656f 5f70 6174 6873 293a 0a20  (video_paths):. 
+000157c0: 2020 2020 2020 2064 6972 5f6e 616d 652c         dir_name,
+000157d0: 2076 6964 656f 5f6e 616d 652c 2065 7874   video_name, ext
+000157e0: 203d 2067 6574 5f66 6e5f 6578 7428 7669   = get_fn_ext(vi
+000157f0: 6465 6f5f 7061 7468 290a 2020 2020 2020  deo_path).      
+00015800: 2020 6966 2076 6572 626f 7365 3a0a 2020    if verbose:.  
+00015810: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00015820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015830: 2066 2252 6573 697a 696e 6720 6865 6967   f"Resizing heig
+00015840: 6874 2076 6964 656f 207b 7669 6465 6f5f  ht video {video_
+00015850: 6e61 6d65 7d20 2856 6964 656f 207b 636e  name} (Video {cn
+00015860: 742b 317d 2f7b 6c65 6e28 7669 6465 6f5f  t+1}/{len(video_
+00015870: 7061 7468 7329 7d29 2e2e 2e22 0a20 2020  paths)})...".   
+00015880: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00015890: 2020 2069 6620 6f76 6572 7772 6974 653a     if overwrite:
+000158a0: 0a20 2020 2020 2020 2020 2020 2064 7420  .            dt 
+000158b0: 3d20 6461 7465 7469 6d65 2e6e 6f77 2829  = datetime.now()
+000158c0: 2e73 7472 6674 696d 6528 2225 5925 6d25  .strftime("%Y%m%
+000158d0: 6425 4825 4d25 5322 290a 2020 2020 2020  d%H%M%S").      
+000158e0: 2020 2020 2020 7361 7665 5f70 6174 6820        save_path 
+000158f0: 3d20 6f73 2e70 6174 682e 6a6f 696e 2864  = os.path.join(d
+00015900: 6972 5f6e 616d 652c 2066 227b 7669 6465  ir_name, f"{vide
+00015910: 6f5f 6e61 6d65 7d5f 7b64 747d 2e6d 7034  o_name}_{dt}.mp4
+00015920: 2229 0a20 2020 2020 2020 2065 6c73 653a  ").        else:
+00015930: 0a20 2020 2020 2020 2020 2020 2073 6176  .            sav
+00015940: 655f 7061 7468 203d 206f 732e 7061 7468  e_path = os.path
+00015950: 2e6a 6f69 6e28 7361 7665 5f64 6972 2c20  .join(save_dir, 
+00015960: 6622 7b76 6964 656f 5f6e 616d 657d 2e6d  f"{video_name}.m
+00015970: 7034 2229 0a20 2020 2020 2020 2020 2020  p4").           
+00015980: 206e 6577 5f76 6964 656f 5f70 6174 6873   new_video_paths
+00015990: 2e61 7070 656e 6428 7361 7665 5f70 6174  .append(save_pat
+000159a0: 6829 0a20 2020 2020 2020 2069 6620 6770  h).        if gp
+000159b0: 753a 0a20 2020 2020 2020 2020 2020 2063  u:.            c
+000159c0: 6d64 203d 2066 2766 666d 7065 6720 2d79  md = f'ffmpeg -y
+000159d0: 202d 6877 6163 6365 6c20 6175 746f 202d   -hwaccel auto -
+000159e0: 633a 7620 6832 3634 5f63 7576 6964 202d  c:v h264_cuvid -
+000159f0: 6920 227b 7669 6465 6f5f 7061 7468 7d22  i "{video_path}"
+00015a00: 202d 7666 2073 6361 6c65 5f6e 7070 3d2d   -vf scale_npp=-
+00015a10: 323a 7b68 6569 6768 747d 202d 633a 7620  2:{height} -c:v 
+00015a20: 6832 3634 5f6e 7665 6e63 2022 7b73 6176  h264_nvenc "{sav
+00015a30: 655f 7061 7468 7d22 202d 6869 6465 5f62  e_path}" -hide_b
+00015a40: 616e 6e65 7220 2d6c 6f67 6c65 7665 6c20  anner -loglevel 
+00015a50: 6572 726f 7220 2d79 270a 2020 2020 2020  error -y'.      
+00015a60: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00015a70: 2020 2020 636d 6420 3d20 6627 6666 6d70      cmd = f'ffmp
+00015a80: 6567 202d 7920 2d69 2022 7b76 6964 656f  eg -y -i "{video
+00015a90: 5f70 6174 687d 2220 2d76 6620 7363 616c  _path}" -vf scal
+00015aa0: 653d 2d32 3a7b 6865 6967 6874 7d20 227b  e=-2:{height} "{
+00015ab0: 7361 7665 5f70 6174 687d 2220 2d68 6964  save_path}" -hid
+00015ac0: 655f 6261 6e6e 6572 202d 6c6f 676c 6576  e_banner -loglev
+00015ad0: 656c 2065 7272 6f72 202d 7927 0a20 2020  el error -y'.   
+00015ae0: 2020 2020 2073 7562 7072 6f63 6573 732e       subprocess.
+00015af0: 6361 6c6c 2863 6d64 2c20 7368 656c 6c3d  call(cmd, shell=
+00015b00: 5472 7565 2c20 7374 646f 7574 3d73 7562  True, stdout=sub
+00015b10: 7072 6f63 6573 732e 5049 5045 290a 2020  process.PIPE).  
+00015b20: 2020 2020 2020 6966 206f 7665 7277 7269        if overwri
+00015b30: 7465 3a0a 2020 2020 2020 2020 2020 2020  te:.            
+00015b40: 7368 7574 696c 2e63 6f70 7928 7361 7665  shutil.copy(save
+00015b50: 5f70 6174 682c 2076 6964 656f 5f70 6174  _path, video_pat
+00015b60: 6829 0a20 2020 2020 2020 2020 2020 206f  h).            o
+00015b70: 732e 7265 6d6f 7665 2873 6176 655f 7061  s.remove(save_pa
+00015b80: 7468 290a 2020 2020 7469 6d65 722e 7374  th).    timer.st
+00015b90: 6f70 5f74 696d 6572 2829 0a20 2020 2069  op_timer().    i
+00015ba0: 6620 7665 7262 6f73 653a 0a20 2020 2020  f verbose:.     
+00015bb0: 2020 2070 7269 6e74 280a 2020 2020 2020     print(.      
+00015bc0: 2020 2020 2020 6622 5265 7369 7a65 6420        f"Resized 
+00015bd0: 6865 6967 6874 207b 6c65 6e28 7669 6465  height {len(vide
+00015be0: 6f5f 7061 7468 7329 7d20 7669 6465 6f28  o_paths)} video(
+00015bf0: 7329 2e20 456c 6170 7365 6420 7469 6d65  s). Elapsed time
+00015c00: 3a20 7b74 696d 6572 2e65 6c61 7073 6564  : {timer.elapsed
+00015c10: 5f74 696d 655f 7374 727d 732e 220a 2020  _time_str}s.".  
+00015c20: 2020 2020 2020 290a 2020 2020 7265 7475        ).    retu
+00015c30: 726e 206e 6577 5f76 6964 656f 5f70 6174  rn new_video_pat
+00015c40: 6873 0a0a 0a64 6566 2072 6573 697a 655f  hs...def resize_
+00015c50: 7669 6465 6f73 5f62 795f 7769 6474 6828  videos_by_width(
+00015c60: 0a20 2020 2076 6964 656f 5f70 6174 6873  .    video_paths
+00015c70: 3a20 4c69 7374 5b55 6e69 6f6e 5b73 7472  : List[Union[str
+00015c80: 2c20 6f73 2e50 6174 684c 696b 655d 5d2c  , os.PathLike]],
+00015c90: 0a20 2020 2077 6964 7468 3a20 556e 696f  .    width: Unio
+00015ca0: 6e5b 696e 742c 2073 7472 5d2c 0a20 2020  n[int, str],.   
+00015cb0: 206f 7665 7277 7269 7465 3a20 4f70 7469   overwrite: Opti
+00015cc0: 6f6e 616c 5b62 6f6f 6c5d 203d 2046 616c  onal[bool] = Fal
+00015cd0: 7365 2c0a 2020 2020 7361 7665 5f64 6972  se,.    save_dir
+00015ce0: 3a20 4f70 7469 6f6e 616c 5b55 6e69 6f6e  : Optional[Union
+00015cf0: 5b73 7472 2c20 6f73 2e50 6174 684c 696b  [str, os.PathLik
+00015d00: 655d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  e]] = None,.    
+00015d10: 6770 753a 204f 7074 696f 6e61 6c5b 626f  gpu: Optional[bo
+00015d20: 6f6c 5d20 3d20 4661 6c73 652c 0a20 2020  ol] = False,.   
+00015d30: 2076 6572 626f 7365 3a20 4f70 7469 6f6e   verbose: Option
+00015d40: 616c 5b62 6f6f 6c5d 203d 2054 7275 652c  al[bool] = True,
+00015d50: 0a29 202d 3e20 556e 696f 6e5b 4e6f 6e65  .) -> Union[None
+00015d60: 2c20 4c69 7374 5b55 6e69 6f6e 5b4e 6f6e  , List[Union[Non
+00015d70: 652c 2073 7472 2c20 6f73 2e50 6174 684c  e, str, os.PathL
+00015d80: 696b 655d 5d5d 3a0a 2020 2020 2222 220a  ike]]]:.    """.
+00015d90: 2020 2020 5265 2d73 697a 6520 6120 6c69      Re-size a li
+00015da0: 7374 206f 6620 7669 6465 6f73 2074 6f20  st of videos to 
+00015db0: 6120 7370 6563 6966 6965 6420 7769 6474  a specified widt
+00015dc0: 6820 7768 696c 6520 7265 7461 696e 696e  h while retainin
+00015dd0: 6720 7468 6569 7220 6173 7065 6374 2072  g their aspect r
+00015de0: 6174 696f 732e 0a0a 2020 2020 3a70 6172  atios...    :par
+00015df0: 616d 204c 6973 745b 556e 696f 6e5b 7374  am List[Union[st
+00015e00: 722c 206f 732e 5061 7468 4c69 6b65 5d5d  r, os.PathLike]]
+00015e10: 2076 6964 656f 5f70 6174 6873 3a20 4c69   video_paths: Li
+00015e20: 7374 206f 6620 7061 7468 2074 6f20 7669  st of path to vi
+00015e30: 6465 6f73 2e0a 2020 2020 3a70 6172 616d  deos..    :param
+00015e40: 2055 6e69 6f6e 5b69 6e74 2c20 7374 725d   Union[int, str]
+00015e50: 2077 6964 7468 3a20 5468 6520 7769 6474   width: The widt
+00015e60: 6820 6f66 2074 6865 206f 7574 7075 7420  h of the output 
+00015e70: 7669 6465 6f73 2e20 4966 2069 6e74 2c20  videos. If int, 
+00015e80: 7468 656e 2074 6865 2077 6964 7468 2069  then the width i
+00015e90: 6e20 7069 7865 6c73 2e20 4966 2073 7472  n pixels. If str
+00015ea0: 2c20 7468 656e 2074 6865 2069 6e64 6578  , then the index
+00015eb0: 2069 6e20 6060 7669 6465 6f5f 7061 7468   in ``video_path
+00015ec0: 7360 6020 6672 6f6d 2077 6869 6368 2074  s`` from which t
+00015ed0: 6f20 6772 6162 2074 6865 2077 6964 7468  o grab the width
+00015ee0: 2e0a 2020 2020 3a70 6172 616d 204f 7074  ..    :param Opt
+00015ef0: 696f 6e61 6c5b 626f 6f6c 5d20 6f76 6572  ional[bool] over
+00015f00: 7772 6974 653a 2049 6620 5472 7565 2c20  write: If True, 
+00015f10: 7468 656e 206f 7665 7277 7269 7465 7320  then overwrites 
+00015f20: 7468 6520 6f72 6967 696e 616c 2076 6964  the original vid
+00015f30: 656f 732e 2044 6566 6175 6c74 2046 616c  eos. Default Fal
+00015f40: 7365 2e0a 2020 2020 3a70 6172 616d 204f  se..    :param O
+00015f50: 7074 696f 6e61 6c5b 556e 696f 6e5b 7374  ptional[Union[st
+00015f60: 722c 206f 732e 5061 7468 4c69 6b65 5d5d  r, os.PathLike]]
+00015f70: 2073 6176 655f 6469 723a 2049 6620 6e6f   save_dir: If no
+00015f80: 7420 4e6f 6e65 2c20 7468 656e 2074 6865  t None, then the
+00015f90: 2064 6972 6563 746f 7279 2077 6865 7265   directory where
+00015fa0: 2074 6f20 7374 6f72 6520 7468 6520 7265   to store the re
+00015fb0: 2d73 697a 6564 2076 6964 656f 732e 0a20  -sized videos.. 
+00015fc0: 2020 203a 7061 7261 6d20 4f70 7469 6f6e     :param Option
+00015fd0: 616c 5b62 6f6f 6c5d 2067 7075 3a20 4966  al[bool] gpu: If
+00015fe0: 2054 7275 652c 2074 6865 6e20 7573 6520   True, then use 
+00015ff0: 4646 6d70 6567 2047 5055 2063 6f64 6563  FFmpeg GPU codec
+00016000: 732e 2044 6566 6175 6c74 2046 616c 7365  s. Default False
+00016010: 2e0a 2020 2020 3a70 6172 616d 204f 7074  ..    :param Opt
+00016020: 696f 6e61 6c5b 626f 6f6c 5d20 7665 7262  ional[bool] verb
+00016030: 6f73 653a 2049 6620 5472 7565 2c20 7072  ose: If True, pr
+00016040: 696e 7473 2070 726f 6772 6573 732e 2044  ints progress. D
+00016050: 6566 6175 6c74 2054 7275 652e 0a20 2020  efault True..   
+00016060: 203a 7265 7475 726e 2055 6e69 6f6e 5b4e   :return Union[N
+00016070: 6f6e 652c 204c 6973 745b 556e 696f 6e5b  one, List[Union[
+00016080: 7374 722c 206f 732e 5061 7468 4c69 6b65  str, os.PathLike
+00016090: 5d5d 5d3a 2049 6620 7361 7665 5f64 6972  ]]]: If save_dir
+000160a0: 2069 7320 6e6f 7420 4e6f 6e65 2c20 7265   is not None, re
+000160b0: 7475 726e 7320 7468 6520 7061 7468 7320  turns the paths 
+000160c0: 6f66 2074 6865 2072 652d 7369 7a65 6420  of the re-sized 
+000160d0: 7669 6465 6f73 2e20 456c 7365 2072 6574  videos. Else ret
+000160e0: 7572 6e73 2065 6d70 7479 206c 6973 742e  urns empty list.
+000160f0: 0a0a 2020 2020 3a65 7861 6d70 6c65 3a0a  ..    :example:.
+00016100: 2020 2020 3e3e 3e20 7669 6465 6f5f 7061      >>> video_pa
+00016110: 7468 733d 205b 272f 5573 6572 732f 7369  ths= ['/Users/si
+00016120: 6d6f 6e2f 4465 736b 746f 702f 656e 7673  mon/Desktop/envs
+00016130: 2f73 696d 6261 2f74 726f 7562 6c65 7368  /simba/troublesh
+00016140: 6f6f 7469 6e67 2f52 4154 5f4e 4f52 2f70  ooting/RAT_NOR/p
+00016150: 726f 6a65 6374 5f66 6f6c 6465 722f 7669  roject_folder/vi
+00016160: 6465 6f73 2f74 6573 742f 3038 3130 3230  deos/test/081020
+00016170: 3231 5f44 4f54 5f52 6174 375f 3828 3229  21_DOT_Rat7_8(2)
+00016180: 2e6d 7034 272c 2027 2f55 7365 7273 2f73  .mp4', '/Users/s
+00016190: 696d 6f6e 2f44 6573 6b74 6f70 2f65 6e76  imon/Desktop/env
+000161a0: 732f 7369 6d62 612f 7472 6f75 626c 6573  s/simba/troubles
+000161b0: 686f 6f74 696e 672f 5241 545f 4e4f 522f  hooting/RAT_NOR/
+000161c0: 7072 6f6a 6563 745f 666f 6c64 6572 2f76  project_folder/v
+000161d0: 6964 656f 732f 7465 7374 2f30 3831 3032  ideos/test/08102
+000161e0: 3032 315f 444f 545f 5261 7431 315f 3132  021_DOT_Rat11_12
+000161f0: 2e6d 7034 275d 0a20 2020 203e 3e3e 205f  .mp4'].    >>> _
+00016200: 203d 2072 6573 697a 655f 7669 6465 6f73   = resize_videos
+00016210: 5f62 795f 7769 6474 6828 7669 6465 6f5f  _by_width(video_
+00016220: 7061 7468 733d 7669 6465 6f5f 7061 7468  paths=video_path
+00016230: 732c 2077 6964 7468 3d33 3030 2c20 6f76  s, width=300, ov
+00016240: 6572 7772 6974 653d 4661 6c73 652c 2073  erwrite=False, s
+00016250: 6176 655f 6469 723d 272f 5573 6572 732f  ave_dir='/Users/
+00016260: 7369 6d6f 6e2f 4465 736b 746f 702f 656e  simon/Desktop/en
+00016270: 7673 2f73 696d 6261 2f74 726f 7562 6c65  vs/simba/trouble
+00016280: 7368 6f6f 7469 6e67 2f52 4154 5f4e 4f52  shooting/RAT_NOR
+00016290: 2f70 726f 6a65 6374 5f66 6f6c 6465 722f  /project_folder/
+000162a0: 7669 6465 6f73 2f74 6573 742f 6e65 7727  videos/test/new'
+000162b0: 290a 2020 2020 2222 220a 0a20 2020 2074  ).    """..    t
+000162c0: 696d 6572 203d 2053 696d 6261 5469 6d65  imer = SimbaTime
+000162d0: 7228 7374 6172 743d 5472 7565 290a 2020  r(start=True).  
+000162e0: 2020 6966 2028 6e6f 7420 6f76 6572 7772    if (not overwr
+000162f0: 6974 6529 2061 6e64 2028 7361 7665 5f64  ite) and (save_d
+00016300: 6972 2069 7320 4e6f 6e65 293a 0a20 2020  ir is None):.   
+00016310: 2020 2020 2072 6169 7365 2049 6e76 616c       raise Inval
+00016320: 6964 496e 7075 7445 7272 6f72 280a 2020  idInputError(.  
+00016330: 2020 2020 2020 2020 2020 6d73 673d 2250            msg="P
+00016340: 726f 7669 6465 2061 2073 6176 655f 6469  rovide a save_di
+00016350: 7220 6f72 2073 6574 206f 7665 7277 7269  r or set overwri
+00016360: 7465 2074 6f20 5472 7565 222c 0a20 2020  te to True",.   
+00016370: 2020 2020 2020 2020 2073 6f75 7263 653d           source=
+00016380: 7265 7369 7a65 5f76 6964 656f 735f 6279  resize_videos_by
+00016390: 5f77 6964 7468 2e5f 5f6e 616d 655f 5f2c  _width.__name__,
+000163a0: 0a20 2020 2020 2020 2029 0a20 2020 2065  .        ).    e
+000163b0: 6c69 6620 286f 7665 7277 7269 7465 2920  lif (overwrite) 
+000163c0: 616e 6420 2873 6176 655f 6469 7220 6973  and (save_dir is
+000163d0: 206e 6f74 204e 6f6e 6529 3a0a 2020 2020   not None):.    
+000163e0: 2020 2020 7261 6973 6520 496e 7661 6c69      raise Invali
+000163f0: 6449 6e70 7574 4572 726f 7228 0a20 2020  dInputError(.   
+00016400: 2020 2020 2020 2020 206d 7367 3d22 5365           msg="Se
+00016410: 7420 4549 5448 4552 206f 7665 7277 7269  t EITHER overwri
+00016420: 7465 2074 6f20 5472 7565 204f 5220 5072  te to True OR Pr
+00016430: 6f76 6964 6520 6120 7361 7665 5f64 6972  ovide a save_dir
+00016440: 222c 0a20 2020 2020 2020 2020 2020 2073  ",.            s
+00016450: 6f75 7263 653d 7265 7369 7a65 5f76 6964  ource=resize_vid
+00016460: 656f 735f 6279 5f77 6964 7468 2e5f 5f6e  eos_by_width.__n
+00016470: 616d 655f 5f2c 0a20 2020 2020 2020 2029  ame__,.        )
+00016480: 0a20 2020 2069 6620 7361 7665 5f64 6972  .    if save_dir
+00016490: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+000164a0: 2020 2020 2020 6966 206e 6f74 206f 732e        if not os.
+000164b0: 7061 7468 2e69 7364 6972 2873 6176 655f  path.isdir(save_
+000164c0: 6469 7229 3a0a 2020 2020 2020 2020 2020  dir):.          
+000164d0: 2020 6f73 2e6d 616b 6564 6972 7328 7361    os.makedirs(sa
+000164e0: 7665 5f64 6972 290a 2020 2020 6368 6563  ve_dir).    chec
+000164f0: 6b5f 7661 6c69 645f 6c73 7428 6461 7461  k_valid_lst(data
+00016500: 3d76 6964 656f 5f70 6174 6873 2c20 736f  =video_paths, so
+00016510: 7572 6365 3d72 6573 697a 655f 7669 6465  urce=resize_vide
+00016520: 6f73 5f62 795f 7769 6474 682e 5f5f 6e61  os_by_width.__na
+00016530: 6d65 5f5f 2c20 6d69 6e5f 6c65 6e3d 3129  me__, min_len=1)
+00016540: 0a20 2020 205f 203d 205b 6368 6563 6b5f  .    _ = [check_
+00016550: 6669 6c65 5f65 7869 7374 5f61 6e64 5f72  file_exist_and_r
+00016560: 6561 6461 626c 6528 7829 2066 6f72 2078  eadable(x) for x
+00016570: 2069 6e20 7669 6465 6f5f 7061 7468 735d   in video_paths]
+00016580: 0a20 2020 206e 6577 5f76 6964 656f 5f70  .    new_video_p
+00016590: 6174 6873 203d 205b 5d0a 2020 2020 6966  aths = [].    if
+000165a0: 2069 7369 6e73 7461 6e63 6528 7769 6474   isinstance(widt
+000165b0: 682c 2073 7472 293a 0a20 2020 2020 2020  h, str):.       
+000165c0: 2063 6865 636b 5f69 6e74 280a 2020 2020   check_int(.    
+000165d0: 2020 2020 2020 2020 6e61 6d65 3d66 227b          name=f"{
+000165e0: 7265 7369 7a65 5f76 6964 656f 735f 6279  resize_videos_by
+000165f0: 5f77 6964 7468 2e5f 5f6e 616d 655f 5f7d  _width.__name__}
+00016600: 2068 6569 6768 7422 2c0a 2020 2020 2020   height",.      
+00016610: 2020 2020 2020 7661 6c75 653d 7769 6474        value=widt
+00016620: 682c 0a20 2020 2020 2020 2020 2020 206d  h,.            m
+00016630: 696e 5f76 616c 7565 3d30 2c0a 2020 2020  in_value=0,.    
+00016640: 2020 2020 2020 2020 6d61 785f 7661 6c75          max_valu
+00016650: 653d 6c65 6e28 7669 6465 6f5f 7061 7468  e=len(video_path
+00016660: 7329 2c0a 2020 2020 2020 2020 290a 2020  s),.        ).  
+00016670: 2020 2020 2020 7669 6465 6f5f 7769 6474        video_widt
+00016680: 6873 203d 205b 5d0a 2020 2020 2020 2020  hs = [].        
+00016690: 666f 7220 6920 696e 2076 6964 656f 5f70  for i in video_p
+000166a0: 6174 6873 3a0a 2020 2020 2020 2020 2020  aths:.          
+000166b0: 2020 7669 6465 6f5f 7769 6474 6873 2e61    video_widths.a
+000166c0: 7070 656e 6428 6765 745f 7669 6465 6f5f  ppend(get_video_
+000166d0: 6d65 7461 5f64 6174 6128 7669 6465 6f5f  meta_data(video_
+000166e0: 7061 7468 3d69 295b 2277 6964 7468 225d  path=i)["width"]
+000166f0: 290a 2020 2020 2020 2020 7769 6474 6820  ).        width 
+00016700: 3d20 7669 6465 6f5f 7769 6474 6873 5b69  = video_widths[i
+00016710: 6e74 2877 6964 7468 295d 0a20 2020 2066  nt(width)].    f
+00016720: 6f72 2063 6e74 2c20 7669 6465 6f5f 7061  or cnt, video_pa
+00016730: 7468 2069 6e20 656e 756d 6572 6174 6528  th in enumerate(
+00016740: 7669 6465 6f5f 7061 7468 7329 3a0a 2020  video_paths):.  
+00016750: 2020 2020 2020 6469 725f 6e61 6d65 2c20        dir_name, 
+00016760: 7669 6465 6f5f 6e61 6d65 2c20 6578 7420  video_name, ext 
+00016770: 3d20 6765 745f 666e 5f65 7874 2876 6964  = get_fn_ext(vid
+00016780: 656f 5f70 6174 6829 0a20 2020 2020 2020  eo_path).       
+00016790: 2069 6620 7665 7262 6f73 653a 0a20 2020   if verbose:.   
+000167a0: 2020 2020 2020 2020 2070 7269 6e74 280a           print(.
+000167b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000167c0: 6622 5265 7369 7a69 6e67 2077 6964 7468  f"Resizing width
+000167d0: 2076 6964 656f 207b 7669 6465 6f5f 6e61   video {video_na
+000167e0: 6d65 7d20 2856 6964 656f 207b 636e 742b  me} (Video {cnt+
+000167f0: 317d 2f7b 6c65 6e28 7669 6465 6f5f 7061  1}/{len(video_pa
+00016800: 7468 7329 7d29 2e2e 2e22 0a20 2020 2020  ths)})...".     
+00016810: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00016820: 2069 6620 6f76 6572 7772 6974 653a 0a20   if overwrite:. 
+00016830: 2020 2020 2020 2020 2020 2064 7420 3d20             dt = 
+00016840: 6461 7465 7469 6d65 2e6e 6f77 2829 2e73  datetime.now().s
+00016850: 7472 6674 696d 6528 2225 5925 6d25 6425  trftime("%Y%m%d%
+00016860: 4825 4d25 5322 290a 2020 2020 2020 2020  H%M%S").        
+00016870: 2020 2020 7361 7665 5f70 6174 6820 3d20      save_path = 
+00016880: 6f73 2e70 6174 682e 6a6f 696e 2864 6972  os.path.join(dir
+00016890: 5f6e 616d 652c 2066 227b 7669 6465 6f5f  _name, f"{video_
+000168a0: 6e61 6d65 7d5f 7b64 747d 2e6d 7034 2229  name}_{dt}.mp4")
+000168b0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+000168c0: 2020 2020 2020 2020 2020 2073 6176 655f             save_
+000168d0: 7061 7468 203d 206f 732e 7061 7468 2e6a  path = os.path.j
+000168e0: 6f69 6e28 7361 7665 5f64 6972 2c20 6622  oin(save_dir, f"
+000168f0: 7b76 6964 656f 5f6e 616d 657d 2e6d 7034  {video_name}.mp4
+00016900: 2229 0a20 2020 2020 2020 2020 2020 206e  ").            n
+00016910: 6577 5f76 6964 656f 5f70 6174 6873 2e61  ew_video_paths.a
+00016920: 7070 656e 6428 7361 7665 5f70 6174 6829  ppend(save_path)
+00016930: 0a20 2020 2020 2020 2069 6620 6770 753a  .        if gpu:
+00016940: 0a20 2020 2020 2020 2020 2020 2063 6d64  .            cmd
+00016950: 203d 2066 2766 666d 7065 6720 2d79 202d   = f'ffmpeg -y -
+00016960: 6877 6163 6365 6c20 6175 746f 202d 6920  hwaccel auto -i 
+00016970: 227b 7669 6465 6f5f 7061 7468 7d22 202d  "{video_path}" -
+00016980: 7666 2073 6361 6c65 5f6e 7070 3d7b 7769  vf scale_npp={wi
+00016990: 6474 687d 3a2d 3220 2d63 3a76 2068 3236  dth}:-2 -c:v h26
+000169a0: 345f 6e76 656e 6320 227b 7361 7665 5f70  4_nvenc "{save_p
+000169b0: 6174 687d 2220 2d68 6964 655f 6261 6e6e  ath}" -hide_bann
+000169c0: 6572 202d 6c6f 676c 6576 656c 2065 7272  er -loglevel err
+000169d0: 6f72 202d 7927 0a20 2020 2020 2020 2065  or -y'.        e
+000169e0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+000169f0: 2063 6d64 203d 2066 2766 666d 7065 6720   cmd = f'ffmpeg 
+00016a00: 2d79 202d 6920 227b 7669 6465 6f5f 7061  -y -i "{video_pa
+00016a10: 7468 7d22 202d 7666 2073 6361 6c65 3d7b  th}" -vf scale={
+00016a20: 7769 6474 687d 3a2d 3220 227b 7361 7665  width}:-2 "{save
+00016a30: 5f70 6174 687d 2220 2d68 6964 655f 6261  _path}" -hide_ba
+00016a40: 6e6e 6572 202d 6c6f 676c 6576 656c 2065  nner -loglevel e
+00016a50: 7272 6f72 202d 7927 0a20 2020 2020 2020  rror -y'.       
+00016a60: 2073 7562 7072 6f63 6573 732e 6361 6c6c   subprocess.call
+00016a70: 2863 6d64 2c20 7368 656c 6c3d 5472 7565  (cmd, shell=True
+00016a80: 2c20 7374 646f 7574 3d73 7562 7072 6f63  , stdout=subproc
+00016a90: 6573 732e 5049 5045 290a 2020 2020 2020  ess.PIPE).      
+00016aa0: 2020 6966 206f 7665 7277 7269 7465 3a0a    if overwrite:.
+00016ab0: 2020 2020 2020 2020 2020 2020 7368 7574              shut
+00016ac0: 696c 2e63 6f70 7928 7361 7665 5f70 6174  il.copy(save_pat
+00016ad0: 682c 2076 6964 656f 5f70 6174 6829 0a20  h, video_path). 
+00016ae0: 2020 2020 2020 2020 2020 206f 732e 7265             os.re
+00016af0: 6d6f 7665 2873 6176 655f 7061 7468 290a  move(save_path).
+00016b00: 2020 2020 7469 6d65 722e 7374 6f70 5f74      timer.stop_t
+00016b10: 696d 6572 2829 0a20 2020 2069 6620 7665  imer().    if ve
+00016b20: 7262 6f73 653a 0a20 2020 2020 2020 2070  rbose:.        p
+00016b30: 7269 6e74 280a 2020 2020 2020 2020 2020  rint(.          
+00016b40: 2020 6622 5265 7369 7a65 6420 7769 6474    f"Resized widt
+00016b50: 6820 7b6c 656e 2876 6964 656f 5f70 6174  h {len(video_pat
+00016b60: 6873 297d 2076 6964 656f 2873 292e 2045  hs)} video(s). E
+00016b70: 6c61 7073 6564 2074 696d 653a 207b 7469  lapsed time: {ti
+00016b80: 6d65 722e 656c 6170 7365 645f 7469 6d65  mer.elapsed_time
+00016b90: 5f73 7472 7d73 2e22 0a20 2020 2020 2020  _str}s.".       
+00016ba0: 2029 0a20 2020 2072 6574 7572 6e20 6e65   ).    return ne
+00016bb0: 775f 7669 6465 6f5f 7061 7468 730a 0a0a  w_video_paths...
+00016bc0: 6465 6620 6372 6561 7465 5f62 6c61 6e6b  def create_blank
+00016bd0: 5f76 6964 656f 280a 2020 2020 7061 7468  _video(.    path
+00016be0: 3a20 556e 696f 6e5b 7374 722c 206f 732e  : Union[str, os.
+00016bf0: 5061 7468 4c69 6b65 5d2c 0a20 2020 206c  PathLike],.    l
+00016c00: 656e 6774 683a 2069 6e74 2c0a 2020 2020  ength: int,.    
+00016c10: 7769 6474 683a 2069 6e74 2c0a 2020 2020  width: int,.    
+00016c20: 6865 6967 6874 3a20 696e 742c 0a20 2020  height: int,.   
+00016c30: 2063 6f6c 6f72 3a20 4f70 7469 6f6e 616c   color: Optional
+00016c40: 5b73 7472 5d20 3d20 2262 6c61 636b 222c  [str] = "black",
+00016c50: 0a20 2020 2067 7075 3a20 4f70 7469 6f6e  .    gpu: Option
+00016c60: 616c 5b62 6f6f 6c5d 203d 2046 616c 7365  al[bool] = False
+00016c70: 2c0a 2020 2020 7665 7262 6f73 653a 204f  ,.    verbose: O
+00016c80: 7074 696f 6e61 6c5b 626f 6f6c 5d20 3d20  ptional[bool] = 
+00016c90: 4661 6c73 652c 0a29 202d 3e20 4e6f 6e65  False,.) -> None
+00016ca0: 3a0a 2020 2020 2222 220a 2020 2020 4372  :.    """.    Cr
+00016cb0: 6561 7465 2061 2022 626c 616e 6b22 2075  eate a "blank" u
+00016cc0: 6e69 2d63 6f6c 6f72 6564 2076 6964 656f  ni-colored video
+00016cd0: 206f 6620 7370 6563 6966 6965 6420 7369   of specified si
+00016ce0: 7a65 2061 6e64 206c 656e 6774 682e 0a0a  ze and length...
+00016cf0: 2020 2020 3a70 6172 616d 2055 6e69 6f6e      :param Union
+00016d00: 5b73 7472 2c20 6f73 2e50 6174 684c 696b  [str, os.PathLik
+00016d10: 655d 2070 6174 683a 204c 6f63 6174 696f  e] path: Locatio
+00016d20: 6e20 7768 6572 6520 746f 2073 746f 7265  n where to store
+00016d30: 2074 6865 2062 6c61 6e6b 2076 6964 656f   the blank video
+00016d40: 2e0a 2020 2020 3a70 6172 616d 2069 6e74  ..    :param int
+00016d50: 206c 656e 6774 683a 204c 656e 6774 6820   length: Length 
+00016d60: 6f66 2074 6865 2062 6c61 6e6b 2076 6964  of the blank vid
+00016d70: 656f 2069 6e20 7365 636f 6e64 732e 0a20  eo in seconds.. 
+00016d80: 2020 203a 7061 7261 6d20 696e 7420 7769     :param int wi
+00016d90: 6474 683a 2057 6964 7468 206f 6620 7468  dth: Width of th
+00016da0: 6520 626c 616e 6b20 7669 6465 6f20 696e  e blank video in
+00016db0: 2070 6978 656c 732e 0a20 2020 203a 7061   pixels..    :pa
+00016dc0: 7261 6d20 696e 7420 6865 6967 6874 3a20  ram int height: 
+00016dd0: 4865 6967 6874 206f 6620 7468 6520 626c  Height of the bl
+00016de0: 616e 6b20 7669 6465 6f20 696e 2070 6978  ank video in pix
+00016df0: 656c 732e 0a20 2020 203a 7061 7261 6d20  els..    :param 
+00016e00: 4f70 7469 6f6e 616c 5b73 7472 5d20 636f  Optional[str] co
+00016e10: 6c6f 723a 2043 6f6c 6f72 206f 6620 7468  lor: Color of th
+00016e20: 6520 626c 616e 6b20 7669 6465 6f2e 2044  e blank video. D
+00016e30: 6566 6175 6c74 2062 6c61 636b 2e0a 2020  efault black..  
+00016e40: 2020 3a70 6172 616d 204f 7074 696f 6e61    :param Optiona
+00016e50: 6c5b 626f 6f6c 5d20 6770 753a 2049 6620  l[bool] gpu: If 
+00016e60: 5472 7565 2c20 7468 656e 2075 7365 2046  True, then use F
+00016e70: 466d 7065 6720 4750 5520 636f 6465 6373  Fmpeg GPU codecs
+00016e80: 2e20 4465 6661 756c 7420 4661 6c73 652e  . Default False.
+00016e90: 0a20 2020 203a 7061 7261 6d20 4f70 7469  .    :param Opti
+00016ea0: 6f6e 616c 5b62 6f6f 6c5d 2076 6572 626f  onal[bool] verbo
+00016eb0: 7365 3a20 4966 2054 7275 652c 2070 7269  se: If True, pri
+00016ec0: 6e74 7320 7072 6f67 7265 7373 2e20 4465  nts progress. De
+00016ed0: 6661 756c 7420 5472 7565 2e0a 2020 2020  fault True..    
+00016ee0: 3a72 6574 7572 6e3a 204e 6f6e 652e 0a0a  :return: None...
+00016ef0: 2020 2020 3a65 7861 6d70 6c65 3a0a 2020      :example:.  
+00016f00: 2020 3e3e 3e20 5f20 3d20 6372 6561 7465    >>> _ = create
+00016f10: 5f62 6c61 6e6b 5f76 6964 656f 2870 6174  _blank_video(pat
+00016f20: 683d 272f 5573 6572 732f 7369 6d6f 6e2f  h='/Users/simon/
+00016f30: 4465 736b 746f 702f 656e 7673 2f73 696d  Desktop/envs/sim
+00016f40: 6261 2f74 726f 7562 6c65 7368 6f6f 7469  ba/troubleshooti
+00016f50: 6e67 2f52 4154 5f4e 4f52 2f70 726f 6a65  ng/RAT_NOR/proje
+00016f60: 6374 5f66 6f6c 6465 722f 7669 6465 6f73  ct_folder/videos
+00016f70: 2f74 6573 742f 6e65 772f 626c 616e 6b5f  /test/new/blank_
+00016f80: 7465 7374 2e6d 7034 272c 206c 656e 6774  test.mp4', lengt
+00016f90: 683d 352c 2077 6964 7468 3d33 3030 2c20  h=5, width=300, 
+00016fa0: 6865 6967 6874 3d34 3030 2c20 6770 753d  height=400, gpu=
+00016fb0: 4661 6c73 652c 2076 6572 626f 7365 3d54  False, verbose=T
+00016fc0: 7275 652c 2063 6f6c 6f72 3d27 6f72 616e  rue, color='oran
+00016fd0: 6765 2729 0a20 2020 2022 2222 0a0a 2020  ge').    """..  
+00016fe0: 2020 6368 6563 6b5f 696e 7428 6e61 6d65    check_int(name
+00016ff0: 3d66 227b 6372 6561 7465 5f62 6c61 6e6b  =f"{create_blank
+00017000: 5f76 6964 656f 2e5f 5f6e 616d 655f 5f7d  _video.__name__}
+00017010: 206c 656e 6774 6822 2c20 7661 6c75 653d   length", value=
+00017020: 6c65 6e67 7468 2c20 6d69 6e5f 7661 6c75  length, min_valu
+00017030: 653d 3129 0a20 2020 2063 6865 636b 5f69  e=1).    check_i
+00017040: 6e74 286e 616d 653d 6622 7b63 7265 6174  nt(name=f"{creat
+00017050: 655f 626c 616e 6b5f 7669 6465 6f2e 5f5f  e_blank_video.__
+00017060: 6e61 6d65 5f5f 7d20 7769 6474 6822 2c20  name__} width", 
+00017070: 7661 6c75 653d 7769 6474 682c 206d 696e  value=width, min
+00017080: 5f76 616c 7565 3d31 290a 2020 2020 6368  _value=1).    ch
+00017090: 6563 6b5f 696e 7428 6e61 6d65 3d66 227b  eck_int(name=f"{
+000170a0: 6372 6561 7465 5f62 6c61 6e6b 5f76 6964  create_blank_vid
+000170b0: 656f 2e5f 5f6e 616d 655f 5f7d 2068 6569  eo.__name__} hei
+000170c0: 6768 7422 2c20 7661 6c75 653d 6865 6967  ght", value=heig
+000170d0: 6874 2c20 6d69 6e5f 7661 6c75 653d 3129  ht, min_value=1)
+000170e0: 0a20 2020 2063 6865 636b 5f69 665f 6469  .    check_if_di
+000170f0: 725f 6578 6973 7473 2869 6e5f 6469 723d  r_exists(in_dir=
+00017100: 6f73 2e70 6174 682e 6469 726e 616d 6528  os.path.dirname(
+00017110: 7061 7468 2929 0a20 2020 2074 696d 6572  path)).    timer
+00017120: 203d 2053 696d 6261 5469 6d65 7228 7374   = SimbaTimer(st
+00017130: 6172 743d 5472 7565 290a 2020 2020 6966  art=True).    if
+00017140: 2076 6572 626f 7365 3a0a 2020 2020 2020   verbose:.      
+00017150: 2020 7072 696e 7428 2243 7265 6174 696e    print("Creatin
+00017160: 6720 626c 616e 6b20 7669 6465 6f2e 2e2e  g blank video...
+00017170: 2229 0a20 2020 2069 6620 6770 753a 0a20  ").    if gpu:. 
+00017180: 2020 2020 2020 2063 6d64 203d 2066 2766         cmd = f'f
+00017190: 666d 7065 6720 2d79 202d 7420 7b6c 656e  fmpeg -y -t {len
+000171a0: 6774 687d 202d 6620 6c61 7666 6920 2d69  gth} -f lavfi -i
+000171b0: 2063 6f6c 6f72 3d63 3d7b 636f 6c6f 727d   color=c={color}
+000171c0: 3a73 3d7b 7769 6474 687d 787b 6865 6967  :s={width}x{heig
+000171d0: 6874 7d20 2d63 3a76 2068 3236 345f 6e76  ht} -c:v h264_nv
+000171e0: 656e 6320 2d70 7265 7365 7420 736c 6f77  enc -preset slow
+000171f0: 202d 7475 6e65 2073 7469 6c6c 696d 6167   -tune stillimag
+00017200: 6520 2d70 6978 5f66 6d74 2079 7576 3432  e -pix_fmt yuv42
+00017210: 3070 2022 7b70 6174 687d 2220 2d68 6964  0p "{path}" -hid
+00017220: 655f 6261 6e6e 6572 202d 6c6f 676c 6576  e_banner -loglev
+00017230: 656c 2065 7272 6f72 202d 7927 0a20 2020  el error -y'.   
+00017240: 2065 6c73 653a 0a20 2020 2020 2020 2063   else:.        c
+00017250: 6d64 203d 2066 2766 666d 7065 6720 2d79  md = f'ffmpeg -y
+00017260: 202d 7420 7b6c 656e 6774 687d 202d 6620   -t {length} -f 
+00017270: 6c61 7666 6920 2d69 2063 6f6c 6f72 3d63  lavfi -i color=c
+00017280: 3d7b 636f 6c6f 727d 3a73 3d7b 7769 6474  ={color}:s={widt
+00017290: 687d 787b 6865 6967 6874 7d20 2d63 3a76  h}x{height} -c:v
+000172a0: 206c 6962 7832 3634 202d 7475 6e65 2073   libx264 -tune s
+000172b0: 7469 6c6c 696d 6167 6520 2d70 6978 5f66  tillimage -pix_f
+000172c0: 6d74 2079 7576 3432 3070 2022 7b70 6174  mt yuv420p "{pat
+000172d0: 687d 2220 2d68 6964 655f 6261 6e6e 6572  h}" -hide_banner
+000172e0: 202d 6c6f 676c 6576 656c 2065 7272 6f72   -loglevel error
+000172f0: 202d 7927 0a20 2020 2073 7562 7072 6f63   -y'.    subproc
+00017300: 6573 732e 6361 6c6c 2863 6d64 2c20 7368  ess.call(cmd, sh
+00017310: 656c 6c3d 5472 7565 2c20 7374 646f 7574  ell=True, stdout
+00017320: 3d73 7562 7072 6f63 6573 732e 5049 5045  =subprocess.PIPE
+00017330: 290a 2020 2020 7469 6d65 722e 7374 6f70  ).    timer.stop
+00017340: 5f74 696d 6572 2829 0a20 2020 2069 6620  _timer().    if 
+00017350: 7665 7262 6f73 653a 0a20 2020 2020 2020  verbose:.       
+00017360: 2070 7269 6e74 2866 2242 6c61 6e6b 2076   print(f"Blank v
+00017370: 6964 656f 2063 6f6d 706c 6574 652e 2045  ideo complete. E
+00017380: 6c61 7073 6564 2074 696d 653a 207b 7469  lapsed time: {ti
+00017390: 6d65 722e 656c 6170 7365 645f 7469 6d65  mer.elapsed_time
+000173a0: 5f73 7472 7d73 2e22 290a 0a0a 6465 6620  _str}s.")...def 
+000173b0: 686f 7269 7a6f 6e74 616c 5f76 6964 656f  horizontal_video
+000173c0: 5f63 6f6e 6361 7465 6e61 746f 7228 0a20  _concatenator(. 
+000173d0: 2020 2076 6964 656f 5f70 6174 6873 3a20     video_paths: 
+000173e0: 4c69 7374 5b55 6e69 6f6e 5b73 7472 2c20  List[Union[str, 
+000173f0: 6f73 2e50 6174 684c 696b 655d 5d2c 0a20  os.PathLike]],. 
+00017400: 2020 2073 6176 655f 7061 7468 3a20 556e     save_path: Un
+00017410: 696f 6e5b 7374 722c 206f 732e 5061 7468  ion[str, os.Path
+00017420: 4c69 6b65 5d2c 0a20 2020 2068 6569 6768  Like],.    heigh
+00017430: 745f 7078 3a20 4f70 7469 6f6e 616c 5b55  t_px: Optional[U
+00017440: 6e69 6f6e 5b69 6e74 2c20 7374 725d 5d20  nion[int, str]] 
+00017450: 3d20 4e6f 6e65 2c0a 2020 2020 6865 6967  = None,.    heig
+00017460: 6874 5f69 6478 3a20 4f70 7469 6f6e 616c  ht_idx: Optional
+00017470: 5b55 6e69 6f6e 5b69 6e74 2c20 7374 725d  [Union[int, str]
+00017480: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 6770  ] = None,.    gp
+00017490: 753a 204f 7074 696f 6e61 6c5b 626f 6f6c  u: Optional[bool
+000174a0: 5d20 3d20 4661 6c73 652c 0a20 2020 2076  ] = False,.    v
+000174b0: 6572 626f 7365 3a20 4f70 7469 6f6e 616c  erbose: Optional
+000174c0: 5b62 6f6f 6c5d 203d 2054 7275 652c 0a29  [bool] = True,.)
+000174d0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2222   -> None:.    ""
+000174e0: 220a 2020 2020 436f 6e63 6174 656e 6174  ".    Concatenat
+000174f0: 6573 206d 756c 7469 706c 6520 7669 6465  es multiple vide
+00017500: 6f73 2068 6f72 697a 6f6e 7461 6c6c 792e  os horizontally.
+00017510: 0a0a 2020 2020 2e2e 2069 6d61 6765 3a3a  ..    .. image::
+00017520: 205f 7374 6174 6963 2f69 6d67 2f68 6f72   _static/img/hor
+00017530: 697a 6f6e 7461 6c5f 7669 6465 6f5f 636f  izontal_video_co
+00017540: 6e63 6174 656e 6174 6f72 2e70 6e67 0a20  ncatenator.png. 
+00017550: 2020 2020 2020 3a77 6964 7468 3a20 3330        :width: 30
+00017560: 300a 2020 2020 2020 203a 616c 6967 6e3a  0.       :align:
+00017570: 2063 656e 7465 720a 0a20 2020 203a 7061   center..    :pa
+00017580: 7261 6d20 4c69 7374 5b55 6e69 6f6e 5b73  ram List[Union[s
+00017590: 7472 2c20 6f73 2e50 6174 684c 696b 655d  tr, os.PathLike]
+000175a0: 5d20 7669 6465 6f5f 7061 7468 733a 204c  ] video_paths: L
+000175b0: 6973 7420 6f66 2069 6e70 7574 2076 6964  ist of input vid
+000175c0: 656f 2066 696c 6520 7061 7468 732e 0a20  eo file paths.. 
+000175d0: 2020 203a 7061 7261 6d20 556e 696f 6e5b     :param Union[
+000175e0: 7374 722c 206f 732e 5061 7468 4c69 6b65  str, os.PathLike
+000175f0: 5d20 7361 7665 5f70 6174 683a 2046 696c  ] save_path: Fil
+00017600: 6520 7061 7468 2074 6f20 7361 7665 2074  e path to save t
+00017610: 6865 2063 6f6e 6361 7465 6e61 7465 6420  he concatenated 
+00017620: 7669 6465 6f2e 0a20 2020 203a 7061 7261  video..    :para
+00017630: 6d20 4f70 7469 6f6e 616c 5b69 6e74 5d20  m Optional[int] 
+00017640: 6865 6967 6874 5f70 783a 2048 6569 6768  height_px: Heigh
+00017650: 7420 6f66 2074 6865 206f 7574 7075 7420  t of the output 
+00017660: 7669 6465 6f20 696e 2070 6978 656c 732e  video in pixels.
+00017670: 0a20 2020 203a 7061 7261 6d20 4f70 7469  .    :param Opti
+00017680: 6f6e 616c 5b69 6e74 5d20 6865 6967 6874  onal[int] height
+00017690: 5f69 6478 3a20 496e 6465 7820 6f66 2074  _idx: Index of t
+000176a0: 6865 2076 6964 656f 2074 6f20 7573 6520  he video to use 
+000176b0: 666f 7220 6465 7465 726d 696e 696e 6720  for determining 
+000176c0: 4865 6967 6874 2e0a 2020 2020 3a70 6172  Height..    :par
+000176d0: 616d 204f 7074 696f 6e61 6c5b 626f 6f6c  am Optional[bool
+000176e0: 5d20 6770 753a 2057 6865 7468 6572 2074  ] gpu: Whether t
+000176f0: 6f20 7573 6520 4750 552d 6163 6365 6c65  o use GPU-accele
+00017700: 7261 7465 6420 636f 6465 6320 2864 6566  rated codec (def
+00017710: 6175 6c74 3a20 4661 6c73 6529 2e0a 2020  ault: False)..  
+00017720: 2020 3a70 6172 616d 204f 7074 696f 6e61    :param Optiona
+00017730: 6c5b 626f 6f6c 5d20 7665 7262 6f73 653a  l[bool] verbose:
+00017740: 5768 6574 6865 7220 746f 2070 7269 6e74  Whether to print
+00017750: 2070 726f 6772 6573 7320 6d65 7373 6167   progress messag
+00017760: 6573 2028 6465 6661 756c 743a 2054 7275  es (default: Tru
+00017770: 6529 2e0a 0a20 2020 203a 6578 616d 706c  e)...    :exampl
+00017780: 653a 0a20 2020 203e 3e3e 2076 6964 656f  e:.    >>> video
+00017790: 5f70 6174 6873 203d 205b 2776 6964 656f  _paths = ['video
+000177a0: 312e 6d70 3427 2c20 2776 6964 656f 322e  1.mp4', 'video2.
+000177b0: 6d70 3427 5d0a 2020 2020 3e3e 3e20 7820  mp4'].    >>> x 
+000177c0: 3d20 686f 7269 7a6f 6e74 616c 5f76 6964  = horizontal_vid
+000177d0: 656f 5f63 6f6e 6361 7465 6e61 746f 7228  eo_concatenator(
+000177e0: 7669 6465 6f5f 7061 7468 733d 7669 6465  video_paths=vide
+000177f0: 6f5f 7061 7468 732c 2068 6569 6768 745f  o_paths, height_
+00017800: 7078 3d35 302c 2073 6176 655f 7061 7468  px=50, save_path
+00017810: 3d27 2f55 7365 7273 2f73 696d 6f6e 2f44  ='/Users/simon/D
+00017820: 6573 6b74 6f70 2f65 6e76 732f 7369 6d62  esktop/envs/simb
+00017830: 612f 7472 6f75 626c 6573 686f 6f74 696e  a/troubleshootin
+00017840: 672f 5241 545f 4e4f 522f 7072 6f6a 6563  g/RAT_NOR/projec
+00017850: 745f 666f 6c64 6572 2f76 6964 656f 732f  t_folder/videos/
+00017860: 7465 7374 2f6e 6577 2f30 3831 3032 3032  test/new/0810202
+00017870: 315f 444f 545f 5261 7437 5f38 2832 295f  1_DOT_Rat7_8(2)_
+00017880: 2e6d 7034 272c 2067 7075 3d46 616c 7365  .mp4', gpu=False
+00017890: 290a 2020 2020 2222 220a 2020 2020 6368  ).    """.    ch
+000178a0: 6563 6b5f 6666 6d70 6567 5f61 7661 696c  eck_ffmpeg_avail
+000178b0: 6162 6c65 2829 0a20 2020 2069 6620 6770  able().    if gp
+000178c0: 7520 616e 6420 6e6f 7420 6368 6563 6b5f  u and not check_
+000178d0: 6e76 6964 6561 5f67 7075 5f61 7661 696c  nvidea_gpu_avail
+000178e0: 6162 6c65 2829 3a0a 2020 2020 2020 2020  able():.        
+000178f0: 7261 6973 6520 4646 4d50 4547 436f 6465  raise FFMPEGCode
+00017900: 6347 5055 4572 726f 7228 0a20 2020 2020  cGPUError(.     
+00017910: 2020 2020 2020 206d 7367 3d22 4e56 4944         msg="NVID
+00017920: 4541 2047 5055 206e 6f74 2061 7661 696c  EA GPU not avail
+00017930: 6162 6c65 2028 6173 2065 7661 6c75 6174  able (as evaluat
+00017940: 6564 2062 7920 6e76 6964 6561 2d73 6d69  ed by nvidea-smi
+00017950: 2072 6574 7572 6e69 6e67 204e 6f6e 6529   returning None)
+00017960: 222c 0a20 2020 2020 2020 2020 2020 2073  ",.            s
+00017970: 6f75 7263 653d 686f 7269 7a6f 6e74 616c  ource=horizontal
+00017980: 5f76 6964 656f 5f63 6f6e 6361 7465 6e61  _video_concatena
+00017990: 746f 722e 5f5f 6e61 6d65 5f5f 2c0a 2020  tor.__name__,.  
+000179a0: 2020 2020 2020 290a 2020 2020 7469 6d65        ).    time
+000179b0: 7220 3d20 5369 6d62 6154 696d 6572 2873  r = SimbaTimer(s
+000179c0: 7461 7274 3d54 7275 6529 0a20 2020 2063  tart=True).    c
+000179d0: 6865 636b 5f76 616c 6964 5f6c 7374 280a  heck_valid_lst(.
+000179e0: 2020 2020 2020 2020 6461 7461 3d76 6964          data=vid
+000179f0: 656f 5f70 6174 6873 2c20 736f 7572 6365  eo_paths, source
+00017a00: 3d68 6f72 697a 6f6e 7461 6c5f 7669 6465  =horizontal_vide
+00017a10: 6f5f 636f 6e63 6174 656e 6174 6f72 2e5f  o_concatenator._
+00017a20: 5f6e 616d 655f 5f2c 206d 696e 5f6c 656e  _name__, min_len
+00017a30: 3d32 0a20 2020 2029 0a20 2020 2063 6865  =2.    ).    che
+00017a40: 636b 5f69 665f 6469 725f 6578 6973 7473  ck_if_dir_exists
+00017a50: 280a 2020 2020 2020 2020 696e 5f64 6972  (.        in_dir
+00017a60: 3d6f 732e 7061 7468 2e64 6972 6e61 6d65  =os.path.dirname
+00017a70: 2873 6176 655f 7061 7468 292c 2073 6f75  (save_path), sou
+00017a80: 7263 653d 686f 7269 7a6f 6e74 616c 5f76  rce=horizontal_v
+00017a90: 6964 656f 5f63 6f6e 6361 7465 6e61 746f  ideo_concatenato
+00017aa0: 722e 5f5f 6e61 6d65 5f5f 0a20 2020 2029  r.__name__.    )
+00017ab0: 0a20 2020 2076 6964 656f 5f6d 6574 615f  .    video_meta_
+00017ac0: 6461 7461 203d 205b 0a20 2020 2020 2020  data = [.       
+00017ad0: 2067 6574 5f76 6964 656f 5f6d 6574 615f   get_video_meta_
+00017ae0: 6461 7461 2876 6964 656f 5f70 6174 683d  data(video_path=
+00017af0: 7669 6465 6f5f 7061 7468 2920 666f 7220  video_path) for 
+00017b00: 7669 6465 6f5f 7061 7468 2069 6e20 7669  video_path in vi
+00017b10: 6465 6f5f 7061 7468 730a 2020 2020 5d0a  deo_paths.    ].
+00017b20: 2020 2020 6966 2028 2868 6569 6768 745f      if ((height_
+00017b30: 7078 2069 7320 4e6f 6e65 2920 616e 6420  px is None) and 
+00017b40: 2868 6569 6768 745f 6964 7820 6973 204e  (height_idx is N
+00017b50: 6f6e 6529 2920 6f72 2028 0a20 2020 2020  one)) or (.     
+00017b60: 2020 2028 6865 6967 6874 5f70 7820 6973     (height_px is
+00017b70: 206e 6f74 204e 6f6e 6529 2061 6e64 2028   not None) and (
+00017b80: 6865 6967 6874 5f69 6478 2069 7320 6e6f  height_idx is no
+00017b90: 7420 4e6f 6e65 290a 2020 2020 293a 0a20  t None).    ):. 
+00017ba0: 2020 2020 2020 2072 6169 7365 2049 6e76         raise Inv
+00017bb0: 616c 6964 496e 7075 7445 7272 6f72 280a  alidInputError(.
+00017bc0: 2020 2020 2020 2020 2020 2020 6d73 673d              msg=
+00017bd0: 2250 726f 7669 6465 2061 2068 6569 6768  "Provide a heigh
+00017be0: 745f 7078 204f 5220 6865 6967 6874 5f69  t_px OR height_i
+00017bf0: 6478 222c 0a20 2020 2020 2020 2020 2020  dx",.           
+00017c00: 2073 6f75 7263 653d 686f 7269 7a6f 6e74   source=horizont
+00017c10: 616c 5f76 6964 656f 5f63 6f6e 6361 7465  al_video_concate
+00017c20: 6e61 746f 722e 5f5f 6e61 6d65 5f5f 2c0a  nator.__name__,.
+00017c30: 2020 2020 2020 2020 290a 2020 2020 6966          ).    if
+00017c40: 2068 6569 6768 745f 6964 7820 6973 206e   height_idx is n
+00017c50: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+00017c60: 2063 6865 636b 5f69 6e74 280a 2020 2020   check_int(.    
+00017c70: 2020 2020 2020 2020 6e61 6d65 3d66 227b          name=f"{
+00017c80: 686f 7269 7a6f 6e74 616c 5f76 6964 656f  horizontal_video
+00017c90: 5f63 6f6e 6361 7465 6e61 746f 722e 5f5f  _concatenator.__
+00017ca0: 6e61 6d65 5f5f 7d20 6865 6967 6874 222c  name__} height",
+00017cb0: 0a20 2020 2020 2020 2020 2020 2076 616c  .            val
+00017cc0: 7565 3d68 6569 6768 745f 6964 782c 0a20  ue=height_idx,. 
+00017cd0: 2020 2020 2020 2020 2020 206d 696e 5f76             min_v
+00017ce0: 616c 7565 3d30 2c0a 2020 2020 2020 2020  alue=0,.        
+00017cf0: 2020 2020 6d61 785f 7661 6c75 653d 6c65      max_value=le
+00017d00: 6e28 7669 6465 6f5f 7061 7468 7329 202d  n(video_paths) -
+00017d10: 2031 2c0a 2020 2020 2020 2020 290a 2020   1,.        ).  
+00017d20: 2020 2020 2020 6865 6967 6874 203d 2069        height = i
+00017d30: 6e74 2876 6964 656f 5f6d 6574 615f 6461  nt(video_meta_da
+00017d40: 7461 5b68 6569 6768 745f 6964 785d 5b22  ta[height_idx]["
+00017d50: 6865 6967 6874 225d 290a 2020 2020 656c  height"]).    el
+00017d60: 7365 3a0a 2020 2020 2020 2020 6368 6563  se:.        chec
+00017d70: 6b5f 696e 7428 0a20 2020 2020 2020 2020  k_int(.         
+00017d80: 2020 206e 616d 653d 6622 7b68 6f72 697a     name=f"{horiz
+00017d90: 6f6e 7461 6c5f 7669 6465 6f5f 636f 6e63  ontal_video_conc
+00017da0: 6174 656e 6174 6f72 2e5f 5f6e 616d 655f  atenator.__name_
+00017db0: 5f7d 2068 6569 6768 7422 2c0a 2020 2020  _} height",.    
+00017dc0: 2020 2020 2020 2020 7661 6c75 653d 6865          value=he
+00017dd0: 6967 6874 5f70 782c 0a20 2020 2020 2020  ight_px,.       
+00017de0: 2020 2020 206d 696e 5f76 616c 7565 3d31       min_value=1
+00017df0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+00017e00: 2020 2020 6865 6967 6874 203d 2069 6e74      height = int
+00017e10: 2868 6569 6768 745f 7078 290a 2020 2020  (height_px).    
+00017e20: 7669 6465 6f5f 7061 7468 5f73 7472 203d  video_path_str =
+00017e30: 2022 2022 2e6a 6f69 6e28 5b66 272d 6920   " ".join([f'-i 
+00017e40: 227b 7061 7468 7d22 2720 666f 7220 7061  "{path}"' for pa
+00017e50: 7468 2069 6e20 7669 6465 6f5f 7061 7468  th in video_path
+00017e60: 735d 290a 2020 2020 636f 6465 6320 3d20  s]).    codec = 
+00017e70: 2268 3236 345f 6e76 656e 6322 2069 6620  "h264_nvenc" if 
+00017e80: 6770 7520 656c 7365 2022 6c69 6276 7078  gpu else "libvpx
+00017e90: 2d76 7039 220a 2020 2020 6669 6c74 6572  -vp9".    filter
+00017ea0: 5f63 6f6d 706c 6578 203d 2022 3b22 2e6a  _complex = ";".j
+00017eb0: 6f69 6e28 0a20 2020 2020 2020 205b 6622  oin(.        [f"
+00017ec0: 5b7b 6964 787d 3a76 5d73 6361 6c65 3d2d  [{idx}:v]scale=-
+00017ed0: 313a 7b68 6569 6768 747d 5b76 7b69 6478  1:{height}[v{idx
+00017ee0: 7d5d 2220 666f 7220 6964 7820 696e 2072  }]" for idx in r
+00017ef0: 616e 6765 286c 656e 2876 6964 656f 5f70  ange(len(video_p
+00017f00: 6174 6873 2929 5d0a 2020 2020 290a 2020  aths))].    ).  
+00017f10: 2020 6669 6c74 6572 5f63 6f6d 706c 6578    filter_complex
+00017f20: 202b 3d20 6622 3b7b 2727 2e6a 6f69 6e28   += f";{''.join(
+00017f30: 5b66 275b 767b 6964 787d 5d27 2066 6f72  [f'[v{idx}]' for
+00017f40: 2069 6478 2069 6e20 7261 6e67 6528 6c65   idx in range(le
+00017f50: 6e28 7669 6465 6f5f 7061 7468 7329 295d  n(video_paths))]
+00017f60: 297d 6873 7461 636b 3d69 6e70 7574 733d  )}hstack=inputs=
+00017f70: 7b6c 656e 2876 6964 656f 5f70 6174 6873  {len(video_paths
+00017f80: 297d 5b76 5d22 0a20 2020 2069 6620 7665  )}[v]".    if ve
+00017f90: 7262 6f73 653a 0a20 2020 2020 2020 2070  rbose:.        p
+00017fa0: 7269 6e74 280a 2020 2020 2020 2020 2020  rint(.          
+00017fb0: 2020 6622 436f 6e63 6174 656e 6174 696e    f"Concatenatin
+00017fc0: 6720 7b6c 656e 2876 6964 656f 5f70 6174  g {len(video_pat
+00017fd0: 6873 297d 2076 6964 656f 7320 686f 7269  hs)} videos hori
+00017fe0: 7a6f 6e74 616c 6c79 2077 6974 6820 6120  zontally with a 
+00017ff0: 7b68 6569 6768 747d 2070 6978 656c 2068  {height} pixel h
+00018000: 6569 6768 742e 2e2e 2022 0a20 2020 2020  eight... ".     
+00018010: 2020 2029 0a20 2020 2063 6d64 203d 2066     ).    cmd = f
+00018020: 2766 666d 7065 6720 7b76 6964 656f 5f70  'ffmpeg {video_p
+00018030: 6174 685f 7374 727d 202d 6669 6c74 6572  ath_str} -filter
+00018040: 5f63 6f6d 706c 6578 2022 7b66 696c 7465  _complex "{filte
+00018050: 725f 636f 6d70 6c65 787d 2220 2d6d 6170  r_complex}" -map
+00018060: 2022 5b76 5d22 202d 633a 7620 7b63 6f64   "[v]" -c:v {cod
+00018070: 6563 7d20 2d6c 6f67 6c65 7665 6c20 6572  ec} -loglevel er
+00018080: 726f 7220 2d73 7461 7473 2022 7b73 6176  ror -stats "{sav
+00018090: 655f 7061 7468 7d22 202d 7927 0a20 2020  e_path}" -y'.   
+000180a0: 2073 7562 7072 6f63 6573 732e 6361 6c6c   subprocess.call
+000180b0: 2863 6d64 2c20 7368 656c 6c3d 5472 7565  (cmd, shell=True
+000180c0: 2c20 7374 646f 7574 3d73 7562 7072 6f63  , stdout=subproc
+000180d0: 6573 732e 5049 5045 290a 2020 2020 7469  ess.PIPE).    ti
+000180e0: 6d65 722e 7374 6f70 5f74 696d 6572 2829  mer.stop_timer()
+000180f0: 0a20 2020 2069 6620 7665 7262 6f73 653a  .    if verbose:
+00018100: 0a20 2020 2020 2020 2070 7269 6e74 280a  .        print(.
+00018110: 2020 2020 2020 2020 2020 2020 6622 486f              f"Ho
+00018120: 7269 7a6f 6e74 616c 2063 6f6e 6361 7465  rizontal concate
+00018130: 6e61 7469 6f6e 2063 6f6d 706c 6574 652c  nation complete,
+00018140: 2073 6176 6564 2061 7420 7b73 6176 655f   saved at {save_
+00018150: 7061 7468 7d20 2865 6c61 7073 6564 2074  path} (elapsed t
+00018160: 696d 653a 207b 7469 6d65 722e 656c 6170  ime: {timer.elap
+00018170: 7365 645f 7469 6d65 5f73 7472 7d73 2e29  sed_time_str}s.)
+00018180: 220a 2020 2020 2020 2020 290a 0a0a 6465  ".        )...de
+00018190: 6620 7665 7274 6963 616c 5f76 6964 656f  f vertical_video
+000181a0: 5f63 6f6e 6361 7465 6e61 746f 7228 0a20  _concatenator(. 
+000181b0: 2020 2076 6964 656f 5f70 6174 6873 3a20     video_paths: 
+000181c0: 4c69 7374 5b55 6e69 6f6e 5b73 7472 2c20  List[Union[str, 
+000181d0: 6f73 2e50 6174 684c 696b 655d 5d2c 0a20  os.PathLike]],. 
+000181e0: 2020 2073 6176 655f 7061 7468 3a20 556e     save_path: Un
+000181f0: 696f 6e5b 7374 722c 206f 732e 5061 7468  ion[str, os.Path
+00018200: 4c69 6b65 5d2c 0a20 2020 2077 6964 7468  Like],.    width
+00018210: 5f70 783a 204f 7074 696f 6e61 6c5b 696e  _px: Optional[in
+00018220: 745d 203d 204e 6f6e 652c 0a20 2020 2077  t] = None,.    w
+00018230: 6964 7468 5f69 6478 3a20 4f70 7469 6f6e  idth_idx: Option
+00018240: 616c 5b69 6e74 5d20 3d20 4e6f 6e65 2c0a  al[int] = None,.
+00018250: 2020 2020 6770 753a 204f 7074 696f 6e61      gpu: Optiona
+00018260: 6c5b 626f 6f6c 5d20 3d20 4661 6c73 652c  l[bool] = False,
+00018270: 0a20 2020 2076 6572 626f 7365 3a20 4f70  .    verbose: Op
+00018280: 7469 6f6e 616c 5b62 6f6f 6c5d 203d 2054  tional[bool] = T
+00018290: 7275 652c 0a29 202d 3e20 4e6f 6e65 3a0a  rue,.) -> None:.
+000182a0: 2020 2020 2222 220a 2020 2020 436f 6e63      """.    Conc
+000182b0: 6174 656e 6174 6573 206d 756c 7469 706c  atenates multipl
+000182c0: 6520 7669 6465 6f73 2076 6572 7469 6361  e videos vertica
+000182d0: 6c6c 792e 0a0a 2020 2020 2e2e 2069 6d61  lly...    .. ima
+000182e0: 6765 3a3a 205f 7374 6174 6963 2f69 6d67  ge:: _static/img
+000182f0: 2f76 6572 7469 6361 6c5f 7669 6465 6f5f  /vertical_video_
+00018300: 636f 6e63 6174 656e 6174 6f72 2e70 6e67  concatenator.png
+00018310: 0a20 2020 2020 2020 3a77 6964 7468 3a20  .       :width: 
+00018320: 3330 300a 2020 2020 2020 203a 616c 6967  300.       :alig
+00018330: 6e3a 2063 656e 7465 720a 0a20 2020 203a  n: center..    :
+00018340: 7061 7261 6d20 4c69 7374 5b55 6e69 6f6e  param List[Union
+00018350: 5b73 7472 2c20 6f73 2e50 6174 684c 696b  [str, os.PathLik
+00018360: 655d 5d20 7669 6465 6f5f 7061 7468 733a  e]] video_paths:
+00018370: 204c 6973 7420 6f66 2069 6e70 7574 2076   List of input v
+00018380: 6964 656f 2066 696c 6520 7061 7468 732e  ideo file paths.
+00018390: 0a20 2020 203a 7061 7261 6d20 556e 696f  .    :param Unio
+000183a0: 6e5b 7374 722c 206f 732e 5061 7468 4c69  n[str, os.PathLi
+000183b0: 6b65 5d20 7361 7665 5f70 6174 683a 2046  ke] save_path: F
+000183c0: 696c 6520 7061 7468 2074 6f20 7361 7665  ile path to save
+000183d0: 2074 6865 2063 6f6e 6361 7465 6e61 7465   the concatenate
+000183e0: 6420 7669 6465 6f2e 0a20 2020 203a 7061  d video..    :pa
+000183f0: 7261 6d20 4f70 7469 6f6e 616c 5b69 6e74  ram Optional[int
+00018400: 5d20 7769 6474 685f 7078 3a20 5769 6474  ] width_px: Widt
+00018410: 6820 6f66 2074 6865 206f 7574 7075 7420  h of the output 
+00018420: 7669 6465 6f20 696e 2070 6978 656c 732e  video in pixels.
+00018430: 0a20 2020 203a 7061 7261 6d20 4f70 7469  .    :param Opti
+00018440: 6f6e 616c 5b69 6e74 5d20 7769 6474 685f  onal[int] width_
+00018450: 6964 783a 2049 6e64 6578 206f 6620 7468  idx: Index of th
+00018460: 6520 7669 6465 6f20 746f 2075 7365 2066  e video to use f
+00018470: 6f72 2064 6574 6572 6d69 6e69 6e67 2077  or determining w
+00018480: 6964 7468 2e0a 2020 2020 3a70 6172 616d  idth..    :param
+00018490: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
+000184a0: 6770 753a 2057 6865 7468 6572 2074 6f20  gpu: Whether to 
+000184b0: 7573 6520 4750 552d 6163 6365 6c65 7261  use GPU-accelera
+000184c0: 7465 6420 636f 6465 6320 2864 6566 6175  ted codec (defau
+000184d0: 6c74 3a20 4661 6c73 6529 2e0a 2020 2020  lt: False)..    
+000184e0: 3a70 6172 616d 204f 7074 696f 6e61 6c5b  :param Optional[
+000184f0: 626f 6f6c 5d20 7665 7262 6f73 653a 5768  bool] verbose:Wh
+00018500: 6574 6865 7220 746f 2070 7269 6e74 2070  ether to print p
+00018510: 726f 6772 6573 7320 6d65 7373 6167 6573  rogress messages
+00018520: 2028 6465 6661 756c 743a 2054 7275 6529   (default: True)
+00018530: 2e0a 2020 2020 3a72 6169 7365 7320 4646  ..    :raises FF
+00018540: 4d50 4547 436f 6465 6347 5055 4572 726f  MPEGCodecGPUErro
+00018550: 723a 2049 6620 4750 5520 6973 2072 6571  r: If GPU is req
+00018560: 7565 7374 6564 2062 7574 206e 6f74 2061  uested but not a
+00018570: 7661 696c 6162 6c65 2e0a 2020 2020 3a72  vailable..    :r
+00018580: 6169 7365 7320 496e 7661 6c69 6449 6e70  aises InvalidInp
+00018590: 7574 4572 726f 723a 2049 6620 626f 7468  utError: If both
+000185a0: 206f 7220 6e65 6974 6865 7220 7769 6474   or neither widt
+000185b0: 685f 7078 2061 6e64 2077 6964 7468 5f69  h_px and width_i
+000185c0: 6478 2061 7265 2070 726f 7669 6465 642e  dx are provided.
+000185d0: 0a0a 2020 2020 3a65 7861 6d70 6c65 3a0a  ..    :example:.
+000185e0: 2020 2020 3e3e 3e20 7669 6465 6f5f 7061      >>> video_pa
+000185f0: 7468 7320 3d20 5b27 2f55 7365 7273 2f73  ths = ['/Users/s
+00018600: 696d 6f6e 2f44 6573 6b74 6f70 2f65 6e76  imon/Desktop/env
+00018610: 732f 7369 6d62 612f 7472 6f75 626c 6573  s/simba/troubles
+00018620: 686f 6f74 696e 672f 5241 545f 4e4f 522f  hooting/RAT_NOR/
+00018630: 7072 6f6a 6563 745f 666f 6c64 6572 2f76  project_folder/v
+00018640: 6964 656f 732f 7465 7374 2f30 3831 3032  ideos/test/08102
+00018650: 3032 315f 444f 545f 5261 7437 5f38 2832  021_DOT_Rat7_8(2
+00018660: 292e 6d70 3427 2c0a 2020 2020 3e3e 3e20  ).mp4',.    >>> 
+00018670: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00018680: 2f55 7365 7273 2f73 696d 6f6e 2f44 6573  /Users/simon/Des
+00018690: 6b74 6f70 2f65 6e76 732f 7369 6d62 612f  ktop/envs/simba/
+000186a0: 7472 6f75 626c 6573 686f 6f74 696e 672f  troubleshooting/
+000186b0: 5241 545f 4e4f 522f 7072 6f6a 6563 745f  RAT_NOR/project_
+000186c0: 666f 6c64 6572 2f76 6964 656f 732f 7465  folder/videos/te
+000186d0: 7374 2f30 3831 3032 3032 315f 444f 545f  st/08102021_DOT_
+000186e0: 5261 7431 315f 3132 2e6d 7034 272c 0a20  Rat11_12.mp4',. 
+000186f0: 2020 203e 3e3e 2020 2020 2020 2020 2020     >>>          
+00018700: 2020 2020 2020 272f 5573 6572 732f 7369        '/Users/si
+00018710: 6d6f 6e2f 4465 736b 746f 702f 656e 7673  mon/Desktop/envs
+00018720: 2f73 696d 6261 2f74 726f 7562 6c65 7368  /simba/troublesh
+00018730: 6f6f 7469 6e67 2f52 4154 5f4e 4f52 2f70  ooting/RAT_NOR/p
+00018740: 726f 6a65 6374 5f66 6f6c 6465 722f 7669  roject_folder/vi
+00018750: 6465 6f73 2f74 6573 742f 3038 3130 3230  deos/test/081020
+00018760: 3231 5f44 4f54 5f52 6174 3131 5f31 325f  21_DOT_Rat11_12_
+00018770: 312e 6d70 3427 5d0a 2020 2020 3e3e 3e20  1.mp4'].    >>> 
+00018780: 5f20 3d20 7665 7274 6963 616c 5f76 6964  _ = vertical_vid
+00018790: 656f 5f63 6f6e 6361 7465 6e61 746f 7228  eo_concatenator(
+000187a0: 7669 6465 6f5f 7061 7468 733d 7669 6465  video_paths=vide
+000187b0: 6f5f 7061 7468 732c 2077 6964 7468 5f69  o_paths, width_i
+000187c0: 6478 3d31 2c20 7361 7665 5f70 6174 683d  dx=1, save_path=
+000187d0: 272f 5573 6572 732f 7369 6d6f 6e2f 4465  '/Users/simon/De
+000187e0: 736b 746f 702f 656e 7673 2f73 696d 6261  sktop/envs/simba
+000187f0: 2f74 726f 7562 6c65 7368 6f6f 7469 6e67  /troubleshooting
+00018800: 2f52 4154 5f4e 4f52 2f70 726f 6a65 6374  /RAT_NOR/project
+00018810: 5f66 6f6c 6465 722f 7669 6465 6f73 2f74  _folder/videos/t
+00018820: 6573 742f 6e65 772f 3038 3130 3230 3231  est/new/08102021
+00018830: 5f44 4f54 5f52 6174 375f 3828 3229 5f2e  _DOT_Rat7_8(2)_.
+00018840: 6d70 3427 2c20 6770 753d 4661 6c73 6529  mp4', gpu=False)
+00018850: 0a20 2020 2022 2222 0a0a 2020 2020 6368  .    """..    ch
+00018860: 6563 6b5f 6666 6d70 6567 5f61 7661 696c  eck_ffmpeg_avail
+00018870: 6162 6c65 2829 0a20 2020 2069 6620 6770  able().    if gp
+00018880: 7520 616e 6420 6e6f 7420 6368 6563 6b5f  u and not check_
+00018890: 6e76 6964 6561 5f67 7075 5f61 7661 696c  nvidea_gpu_avail
+000188a0: 6162 6c65 2829 3a0a 2020 2020 2020 2020  able():.        
+000188b0: 7261 6973 6520 4646 4d50 4547 436f 6465  raise FFMPEGCode
+000188c0: 6347 5055 4572 726f 7228 0a20 2020 2020  cGPUError(.     
+000188d0: 2020 2020 2020 206d 7367 3d22 4e56 4944         msg="NVID
+000188e0: 4941 2047 5055 206e 6f74 2061 7661 696c  IA GPU not avail
+000188f0: 6162 6c65 222c 2073 6f75 7263 653d 7665  able", source=ve
+00018900: 7274 6963 616c 5f76 6964 656f 5f63 6f6e  rtical_video_con
+00018910: 6361 7465 6e61 746f 722e 5f5f 6e61 6d65  catenator.__name
+00018920: 5f5f 0a20 2020 2020 2020 2029 0a20 2020  __.        ).   
+00018930: 2076 6964 656f 5f6d 6574 615f 6461 7461   video_meta_data
+00018940: 203d 205b 0a20 2020 2020 2020 2067 6574   = [.        get
+00018950: 5f76 6964 656f 5f6d 6574 615f 6461 7461  _video_meta_data
+00018960: 2876 6964 656f 5f70 6174 683d 7669 6465  (video_path=vide
+00018970: 6f5f 7061 7468 2920 666f 7220 7669 6465  o_path) for vide
+00018980: 6f5f 7061 7468 2069 6e20 7669 6465 6f5f  o_path in video_
+00018990: 7061 7468 730a 2020 2020 5d0a 2020 2020  paths.    ].    
+000189a0: 7469 6d65 7220 3d20 5369 6d62 6154 696d  timer = SimbaTim
+000189b0: 6572 2873 7461 7274 3d54 7275 6529 0a20  er(start=True). 
+000189c0: 2020 2063 6865 636b 5f76 616c 6964 5f6c     check_valid_l
+000189d0: 7374 280a 2020 2020 2020 2020 6461 7461  st(.        data
+000189e0: 3d76 6964 656f 5f70 6174 6873 2c20 736f  =video_paths, so
+000189f0: 7572 6365 3d76 6572 7469 6361 6c5f 7669  urce=vertical_vi
+00018a00: 6465 6f5f 636f 6e63 6174 656e 6174 6f72  deo_concatenator
+00018a10: 2e5f 5f6e 616d 655f 5f2c 206d 696e 5f6c  .__name__, min_l
+00018a20: 656e 3d32 0a20 2020 2029 0a20 2020 2063  en=2.    ).    c
+00018a30: 6865 636b 5f69 665f 6469 725f 6578 6973  heck_if_dir_exis
+00018a40: 7473 280a 2020 2020 2020 2020 696e 5f64  ts(.        in_d
+00018a50: 6972 3d6f 732e 7061 7468 2e64 6972 6e61  ir=os.path.dirna
+00018a60: 6d65 2873 6176 655f 7061 7468 292c 2073  me(save_path), s
+00018a70: 6f75 7263 653d 7665 7274 6963 616c 5f76  ource=vertical_v
+00018a80: 6964 656f 5f63 6f6e 6361 7465 6e61 746f  ideo_concatenato
+00018a90: 722e 5f5f 6e61 6d65 5f5f 0a20 2020 2029  r.__name__.    )
+00018aa0: 0a20 2020 2069 6620 2828 7769 6474 685f  .    if ((width_
+00018ab0: 7078 2069 7320 4e6f 6e65 2920 616e 6420  px is None) and 
+00018ac0: 2877 6964 7468 5f69 6478 2069 7320 4e6f  (width_idx is No
+00018ad0: 6e65 2929 206f 7220 280a 2020 2020 2020  ne)) or (.      
+00018ae0: 2020 2877 6964 7468 5f70 7820 6973 206e    (width_px is n
+00018af0: 6f74 204e 6f6e 6529 2061 6e64 2028 7769  ot None) and (wi
+00018b00: 6474 685f 6964 7820 6973 206e 6f74 204e  dth_idx is not N
+00018b10: 6f6e 6529 0a20 2020 2029 3a0a 2020 2020  one).    ):.    
+00018b20: 2020 2020 7261 6973 6520 496e 7661 6c69      raise Invali
+00018b30: 6449 6e70 7574 4572 726f 7228 0a20 2020  dInputError(.   
+00018b40: 2020 2020 2020 2020 206d 7367 3d22 5072           msg="Pr
+00018b50: 6f76 6964 6520 6120 7769 6474 685f 7078  ovide a width_px
+00018b60: 204f 5220 7769 6474 685f 6964 7822 2c0a   OR width_idx",.
+00018b70: 2020 2020 2020 2020 2020 2020 736f 7572              sour
+00018b80: 6365 3d76 6572 7469 6361 6c5f 7669 6465  ce=vertical_vide
+00018b90: 6f5f 636f 6e63 6174 656e 6174 6f72 2e5f  o_concatenator._
+00018ba0: 5f6e 616d 655f 5f2c 0a20 2020 2020 2020  _name__,.       
+00018bb0: 2029 0a20 2020 2069 6620 7769 6474 685f   ).    if width_
+00018bc0: 6964 7820 6973 206e 6f74 204e 6f6e 653a  idx is not None:
+00018bd0: 0a20 2020 2020 2020 2063 6865 636b 5f69  .        check_i
+00018be0: 6e74 280a 2020 2020 2020 2020 2020 2020  nt(.            
+00018bf0: 6e61 6d65 3d66 227b 7665 7274 6963 616c  name=f"{vertical
+00018c00: 5f76 6964 656f 5f63 6f6e 6361 7465 6e61  _video_concatena
+00018c10: 746f 722e 5f5f 6e61 6d65 5f5f 7d20 7769  tor.__name__} wi
+00018c20: 6474 6820 696e 6465 7822 2c0a 2020 2020  dth index",.    
+00018c30: 2020 2020 2020 2020 7661 6c75 653d 7769          value=wi
+00018c40: 6474 685f 6964 782c 0a20 2020 2020 2020  dth_idx,.       
+00018c50: 2020 2020 206d 696e 5f76 616c 7565 3d30       min_value=0
+00018c60: 2c0a 2020 2020 2020 2020 2020 2020 6d61  ,.            ma
+00018c70: 785f 7661 6c75 653d 6c65 6e28 7669 6465  x_value=len(vide
+00018c80: 6f5f 7061 7468 7329 202d 2031 2c0a 2020  o_paths) - 1,.  
+00018c90: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00018ca0: 7769 6474 6820 3d20 696e 7428 7669 6465  width = int(vide
+00018cb0: 6f5f 6d65 7461 5f64 6174 615b 7769 6474  o_meta_data[widt
+00018cc0: 685f 6964 785d 5b22 7769 6474 6822 5d29  h_idx]["width"])
+00018cd0: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
+00018ce0: 2020 2063 6865 636b 5f69 6e74 280a 2020     check_int(.  
+00018cf0: 2020 2020 2020 2020 2020 6e61 6d65 3d66            name=f
+00018d00: 227b 7665 7274 6963 616c 5f76 6964 656f  "{vertical_video
+00018d10: 5f63 6f6e 6361 7465 6e61 746f 722e 5f5f  _concatenator.__
+00018d20: 6e61 6d65 5f5f 7d20 7769 6474 6822 2c0a  name__} width",.
+00018d30: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+00018d40: 653d 7769 6474 685f 7078 2c0a 2020 2020  e=width_px,.    
+00018d50: 2020 2020 2020 2020 6d69 6e5f 7661 6c75          min_valu
+00018d60: 653d 312c 0a20 2020 2020 2020 2029 0a20  e=1,.        ). 
+00018d70: 2020 2020 2020 2077 6964 7468 203d 2069         width = i
+00018d80: 6e74 2877 6964 7468 5f70 7829 0a20 2020  nt(width_px).   
+00018d90: 2076 6964 656f 5f70 6174 685f 7374 7220   video_path_str 
+00018da0: 3d20 2220 222e 6a6f 696e 285b 6627 2d69  = " ".join([f'-i
+00018db0: 2022 7b70 6174 687d 2227 2066 6f72 2070   "{path}"' for p
+00018dc0: 6174 6820 696e 2076 6964 656f 5f70 6174  ath in video_pat
+00018dd0: 6873 5d29 0a20 2020 2063 6f64 6563 203d  hs]).    codec =
+00018de0: 2022 6832 3634 5f6e 7665 6e63 2220 6966   "h264_nvenc" if
+00018df0: 2067 7075 2065 6c73 6520 226c 6962 7670   gpu else "libvp
+00018e00: 782d 7670 3922 0a20 2020 2066 696c 7465  x-vp9".    filte
+00018e10: 725f 636f 6d70 6c65 7820 3d20 223b 222e  r_complex = ";".
+00018e20: 6a6f 696e 280a 2020 2020 2020 2020 5b66  join(.        [f
+00018e30: 225b 7b69 6478 7d3a 765d 7363 616c 653d  "[{idx}:v]scale=
+00018e40: 7b77 6964 7468 7d3a 2d31 5b76 7b69 6478  {width}:-1[v{idx
+00018e50: 7d5d 2220 666f 7220 6964 7820 696e 2072  }]" for idx in r
+00018e60: 616e 6765 286c 656e 2876 6964 656f 5f70  ange(len(video_p
+00018e70: 6174 6873 2929 5d0a 2020 2020 290a 2020  aths))].    ).  
+00018e80: 2020 6669 6c74 6572 5f63 6f6d 706c 6578    filter_complex
+00018e90: 202b 3d20 6622 3b7b 2727 2e6a 6f69 6e28   += f";{''.join(
+00018ea0: 5b66 275b 767b 6964 787d 5d27 2066 6f72  [f'[v{idx}]' for
+00018eb0: 2069 6478 2069 6e20 7261 6e67 6528 6c65   idx in range(le
+00018ec0: 6e28 7669 6465 6f5f 7061 7468 7329 295d  n(video_paths))]
+00018ed0: 297d 220a 2020 2020 6669 6c74 6572 5f63  )}".    filter_c
+00018ee0: 6f6d 706c 6578 202b 3d20 6622 7673 7461  omplex += f"vsta
+00018ef0: 636b 3d69 6e70 7574 733d 7b6c 656e 2876  ck=inputs={len(v
+00018f00: 6964 656f 5f70 6174 6873 297d 5b76 5d22  ideo_paths)}[v]"
+00018f10: 0a20 2020 2069 6620 7665 7262 6f73 653a  .    if verbose:
+00018f20: 0a20 2020 2020 2020 2070 7269 6e74 280a  .        print(.
+00018f30: 2020 2020 2020 2020 2020 2020 6622 436f              f"Co
+00018f40: 6e63 6174 656e 6174 696e 6720 7b6c 656e  ncatenating {len
+00018f50: 2876 6964 656f 5f70 6174 6873 297d 2076  (video_paths)} v
+00018f60: 6964 656f 7320 7665 7274 6963 616c 6c79  ideos vertically
+00018f70: 2077 6974 6820 6120 7b77 6964 7468 7d20   with a {width} 
+00018f80: 7069 7865 6c20 7769 6474 682e 2e2e 220a  pixel width...".
+00018f90: 2020 2020 2020 2020 290a 2020 2020 636d          ).    cm
+00018fa0: 6420 3d20 6627 6666 6d70 6567 207b 7669  d = f'ffmpeg {vi
+00018fb0: 6465 6f5f 7061 7468 5f73 7472 7d20 2d66  deo_path_str} -f
+00018fc0: 696c 7465 725f 636f 6d70 6c65 7820 227b  ilter_complex "{
+00018fd0: 6669 6c74 6572 5f63 6f6d 706c 6578 7d22  filter_complex}"
+00018fe0: 202d 6d61 7020 225b 765d 2220 2d63 3a76   -map "[v]" -c:v
+00018ff0: 207b 636f 6465 637d 202d 6c6f 676c 6576   {codec} -loglev
+00019000: 656c 2065 7272 6f72 202d 7374 6174 7320  el error -stats 
+00019010: 227b 7361 7665 5f70 6174 687d 2220 2d79  "{save_path}" -y
+00019020: 270a 2020 2020 7375 6270 726f 6365 7373  '.    subprocess
+00019030: 2e63 616c 6c28 636d 642c 2073 6865 6c6c  .call(cmd, shell
+00019040: 3d54 7275 652c 2073 7464 6f75 743d 7375  =True, stdout=su
+00019050: 6270 726f 6365 7373 2e50 4950 4529 0a20  bprocess.PIPE). 
+00019060: 2020 2074 696d 6572 2e73 746f 705f 7469     timer.stop_ti
+00019070: 6d65 7228 290a 2020 2020 6966 2076 6572  mer().    if ver
+00019080: 626f 7365 3a0a 2020 2020 2020 2020 7072  bose:.        pr
+00019090: 696e 7428 0a20 2020 2020 2020 2020 2020  int(.           
+000190a0: 2066 2256 6572 7469 6361 6c20 636f 6e63   f"Vertical conc
+000190b0: 6174 656e 6174 696f 6e20 636f 6d70 6c65  atenation comple
+000190c0: 7465 2e20 5361 7665 6420 6174 207b 7361  te. Saved at {sa
+000190d0: 7665 5f70 6174 687d 2028 456c 6170 7365  ve_path} (Elapse
+000190e0: 6420 7469 6d65 3a20 7b74 696d 6572 2e65  d time: {timer.e
+000190f0: 6c61 7073 6564 5f74 696d 655f 7374 727d  lapsed_time_str}
+00019100: 732e 2922 0a20 2020 2020 2020 2029 0a0a  s.)".        )..
+00019110: 0a64 6566 206d 6f73 6169 635f 636f 6e63  .def mosaic_conc
+00019120: 6174 656e 6174 6f72 280a 2020 2020 7669  atenator(.    vi
+00019130: 6465 6f5f 7061 7468 733a 204c 6973 745b  deo_paths: List[
+00019140: 556e 696f 6e5b 7374 722c 206f 732e 5061  Union[str, os.Pa
+00019150: 7468 4c69 6b65 5d5d 2c0a 2020 2020 7361  thLike]],.    sa
+00019160: 7665 5f70 6174 683a 2055 6e69 6f6e 5b73  ve_path: Union[s
+00019170: 7472 2c20 6f73 2e50 6174 684c 696b 655d  tr, os.PathLike]
+00019180: 2c0a 2020 2020 7769 6474 685f 6964 783a  ,.    width_idx:
+00019190: 204f 7074 696f 6e61 6c5b 556e 696f 6e5b   Optional[Union[
+000191a0: 696e 742c 2073 7472 5d5d 203d 204e 6f6e  int, str]] = Non
+000191b0: 652c 0a20 2020 2077 6964 7468 5f70 783a  e,.    width_px:
+000191c0: 204f 7074 696f 6e61 6c5b 556e 696f 6e5b   Optional[Union[
+000191d0: 696e 742c 2073 7472 5d5d 203d 204e 6f6e  int, str]] = Non
+000191e0: 652c 0a20 2020 2068 6569 6768 745f 6964  e,.    height_id
+000191f0: 783a 204f 7074 696f 6e61 6c5b 556e 696f  x: Optional[Unio
+00019200: 6e5b 696e 742c 2073 7472 5d5d 203d 204e  n[int, str]] = N
+00019210: 6f6e 652c 0a20 2020 2068 6569 6768 745f  one,.    height_
+00019220: 7078 3a20 4f70 7469 6f6e 616c 5b55 6e69  px: Optional[Uni
+00019230: 6f6e 5b69 6e74 2c20 7374 725d 5d20 3d20  on[int, str]] = 
+00019240: 4e6f 6e65 2c0a 2020 2020 6770 753a 204f  None,.    gpu: O
+00019250: 7074 696f 6e61 6c5b 626f 6f6c 5d20 3d20  ptional[bool] = 
+00019260: 4661 6c73 652c 0a20 2020 2076 6572 626f  False,.    verbo
+00019270: 7365 3a20 4f70 7469 6f6e 616c 5b62 6f6f  se: Optional[boo
+00019280: 6c5d 203d 2054 7275 652c 0a20 2020 2075  l] = True,.    u
+00019290: 6e65 7665 6e5f 6669 6c6c 5f63 6f6c 6f72  neven_fill_color
+000192a0: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
+000192b0: 3d20 2262 6c61 636b 222c 0a29 202d 3e20  = "black",.) -> 
+000192c0: 4e6f 6e65 3a0a 2020 2020 2222 220a 2020  None:.    """.  
+000192d0: 2020 436f 6e63 6174 656e 6174 6573 206d    Concatenates m
+000192e0: 756c 7469 706c 6520 7669 6465 6f73 2069  ultiple videos i
+000192f0: 6e74 6f20 6120 6d6f 7361 6963 206c 6179  nto a mosaic lay
+00019300: 6f75 742e 0a0a 2020 2020 2e2e 2069 6d61  out...    .. ima
+00019310: 6765 3a3a 205f 7374 6174 6963 2f69 6d67  ge:: _static/img
+00019320: 2f6d 6f73 6169 635f 636f 6e63 6174 656e  /mosaic_concaten
+00019330: 6174 6f72 2e70 6e67 0a20 2020 2020 2020  ator.png.       
+00019340: 3a77 6964 7468 3a20 3630 300a 2020 2020  :width: 600.    
+00019350: 2020 203a 616c 6967 6e3a 2063 656e 7465     :align: cente
+00019360: 720a 0a20 2020 202e 2e20 6e6f 7465 3a3a  r..    .. note::
+00019370: 0a20 2020 2020 2020 6966 2061 6e20 756e  .       if an un
+00019380: 6576 656e 206e 756d 6265 7220 6f66 2076  even number of v
+00019390: 6964 656f 732c 2074 6865 206c 6173 7420  ideos, the last 
+000193a0: 696e 6465 7820 7769 6c6c 2062 6520 6669  index will be fi
+000193b0: 6c6c 6564 2062 7920 6060 756e 6576 656e  lled by ``uneven
+000193c0: 5f66 696c 6c5f 636f 6c6f 7260 602e 0a0a  _fill_color``...
+000193d0: 2020 2020 3a70 6172 616d 204c 6973 745b      :param List[
+000193e0: 556e 696f 6e5b 7374 722c 206f 732e 5061  Union[str, os.Pa
+000193f0: 7468 4c69 6b65 5d5d 2076 6964 656f 5f70  thLike]] video_p
+00019400: 6174 6873 3a20 4c69 7374 206f 6620 696e  aths: List of in
+00019410: 7075 7420 7669 6465 6f20 6669 6c65 2070  put video file p
+00019420: 6174 6873 2e0a 2020 2020 3a70 6172 616d  aths..    :param
+00019430: 2055 6e69 6f6e 5b73 7472 2c20 6f73 2e50   Union[str, os.P
+00019440: 6174 684c 696b 655d 2073 6176 655f 7061  athLike] save_pa
+00019450: 7468 3a20 4669 6c65 2070 6174 6820 746f  th: File path to
+00019460: 2073 6176 6520 7468 6520 636f 6e63 6174   save the concat
+00019470: 656e 6174 6564 2076 6964 656f 2e0a 2020  enated video..  
+00019480: 2020 3a70 6172 616d 204f 7074 696f 6e61    :param Optiona
+00019490: 6c5b 696e 745d 2077 6964 7468 5f70 783a  l[int] width_px:
+000194a0: 2057 6964 7468 206f 6620 7468 6520 6f75   Width of the ou
+000194b0: 7470 7574 2076 6964 656f 2069 6e20 7069  tput video in pi
+000194c0: 7865 6c73 2e0a 2020 2020 3a70 6172 616d  xels..    :param
+000194d0: 204f 7074 696f 6e61 6c5b 696e 745d 2077   Optional[int] w
+000194e0: 6964 7468 5f69 6478 3a20 496e 6465 7820  idth_idx: Index 
+000194f0: 6f66 2074 6865 2076 6964 656f 2074 6f20  of the video to 
+00019500: 7573 6520 666f 7220 6465 7465 726d 696e  use for determin
+00019510: 696e 6720 7769 6474 682e 0a20 2020 203a  ing width..    :
+00019520: 7061 7261 6d20 4f70 7469 6f6e 616c 5b69  param Optional[i
+00019530: 6e74 5d20 6865 6967 6874 5f70 783a 2048  nt] height_px: H
+00019540: 6569 6768 7420 6f66 2074 6865 206f 7574  eight of the out
+00019550: 7075 7420 7669 6465 6f20 7061 6e65 6c73  put video panels
+00019560: 2069 6e20 7069 7865 6c73 2e0a 2020 2020   in pixels..    
+00019570: 3a70 6172 616d 204f 7074 696f 6e61 6c5b  :param Optional[
+00019580: 696e 745d 2068 6569 6768 745f 6964 783a  int] height_idx:
+00019590: 2048 6569 6768 7420 6f66 2074 6865 2076   Height of the v
+000195a0: 6964 656f 2074 6f20 7573 6520 666f 7220  ideo to use for 
+000195b0: 6465 7465 726d 696e 696e 6720 7769 6474  determining widt
+000195c0: 682e 0a20 2020 203a 7061 7261 6d20 4f70  h..    :param Op
+000195d0: 7469 6f6e 616c 5b62 6f6f 6c5d 2067 7075  tional[bool] gpu
+000195e0: 3a20 5768 6574 6865 7220 746f 2075 7365  : Whether to use
+000195f0: 2047 5055 2d61 6363 656c 6572 6174 6564   GPU-accelerated
+00019600: 2063 6f64 6563 2028 6465 6661 756c 743a   codec (default:
+00019610: 2046 616c 7365 292e 0a20 2020 203a 7061   False)..    :pa
+00019620: 7261 6d20 4f70 7469 6f6e 616c 5b62 6f6f  ram Optional[boo
+00019630: 6c5d 2076 6572 626f 7365 3a20 5768 6574  l] verbose: Whet
+00019640: 6865 7220 746f 2070 7269 6e74 2070 726f  her to print pro
+00019650: 6772 6573 7320 6d65 7373 6167 6573 2028  gress messages (
+00019660: 6465 6661 756c 743a 2054 7275 6529 2e0a  default: True)..
+00019670: 0a20 2020 203a 6578 616d 706c 653a 0a20  .    :example:. 
+00019680: 2020 203e 3e3e 2076 6964 656f 5f70 6174     >>> video_pat
+00019690: 6873 203d 205b 272f 5573 6572 732f 7369  hs = ['/Users/si
+000196a0: 6d6f 6e2f 4465 736b 746f 702f 656e 7673  mon/Desktop/envs
+000196b0: 2f73 696d 6261 2f74 726f 7562 6c65 7368  /simba/troublesh
+000196c0: 6f6f 7469 6e67 2f52 4154 5f4e 4f52 2f70  ooting/RAT_NOR/p
+000196d0: 726f 6a65 6374 5f66 6f6c 6465 722f 7669  roject_folder/vi
+000196e0: 6465 6f73 2f74 6573 742f 3038 3130 3230  deos/test/081020
+000196f0: 3231 5f44 4f54 5f52 6174 375f 3828 3229  21_DOT_Rat7_8(2)
+00019700: 2e6d 7034 272c 2027 2f55 7365 7273 2f73  .mp4', '/Users/s
+00019710: 696d 6f6e 2f44 6573 6b74 6f70 2f65 6e76  imon/Desktop/env
+00019720: 732f 7369 6d62 612f 7472 6f75 626c 6573  s/simba/troubles
+00019730: 686f 6f74 696e 672f 5241 545f 4e4f 522f  hooting/RAT_NOR/
+00019740: 7072 6f6a 6563 745f 666f 6c64 6572 2f76  project_folder/v
+00019750: 6964 656f 732f 7465 7374 2f30 3831 3032  ideos/test/08102
+00019760: 3032 315f 444f 545f 5261 7431 315f 3132  021_DOT_Rat11_12
+00019770: 2e6d 7034 272c 2027 2f55 7365 7273 2f73  .mp4', '/Users/s
+00019780: 696d 6f6e 2f44 6573 6b74 6f70 2f65 6e76  imon/Desktop/env
+00019790: 732f 7369 6d62 612f 7472 6f75 626c 6573  s/simba/troubles
+000197a0: 686f 6f74 696e 672f 5241 545f 4e4f 522f  hooting/RAT_NOR/
+000197b0: 7072 6f6a 6563 745f 666f 6c64 6572 2f76  project_folder/v
+000197c0: 6964 656f 732f 7465 7374 2f6e 6577 2f32  ideos/test/new/2
+000197d0: 3032 322d 3036 2d32 315f 4e4f 425f 494f  022-06-21_NOB_IO
+000197e0: 545f 3233 2e6d 7034 275d 0a20 2020 203e  T_23.mp4'].    >
+000197f0: 3e3e 2073 6176 655f 7061 7468 203d 2027  >> save_path = '
+00019800: 2f55 7365 7273 2f73 696d 6f6e 2f44 6573  /Users/simon/Des
+00019810: 6b74 6f70 2f65 6e76 732f 7369 6d62 612f  ktop/envs/simba/
+00019820: 7472 6f75 626c 6573 686f 6f74 696e 672f  troubleshooting/
+00019830: 5241 545f 4e4f 522f 7072 6f6a 6563 745f  RAT_NOR/project_
+00019840: 666f 6c64 6572 2f76 6964 656f 732f 7465  folder/videos/te
+00019850: 7374 2f6e 6577 2f62 6c61 6e6b 5f74 6573  st/new/blank_tes
+00019860: 742e 6d70 3427 0a20 2020 203e 3e3e 206d  t.mp4'.    >>> m
+00019870: 6f73 6169 635f 636f 6e63 6174 656e 6174  osaic_concatenat
+00019880: 6f72 2876 6964 656f 5f70 6174 6873 3d76  or(video_paths=v
+00019890: 6964 656f 5f70 6174 6873 2c20 7361 7665  ideo_paths, save
+000198a0: 5f70 6174 683d 7361 7665 5f70 6174 682c  _path=save_path,
+000198b0: 2077 6964 7468 5f69 6478 3d31 2c20 6865   width_idx=1, he
+000198c0: 6967 6874 5f69 6478 3d31 2c20 6770 753d  ight_idx=1, gpu=
+000198d0: 4661 6c73 6529 0a20 2020 2022 2222 0a0a  False).    """..
+000198e0: 2020 2020 6368 6563 6b5f 6666 6d70 6567      check_ffmpeg
+000198f0: 5f61 7661 696c 6162 6c65 2829 0a20 2020  _available().   
+00019900: 2069 6620 6770 7520 616e 6420 6e6f 7420   if gpu and not 
+00019910: 6368 6563 6b5f 6e76 6964 6561 5f67 7075  check_nvidea_gpu
+00019920: 5f61 7661 696c 6162 6c65 2829 3a0a 2020  _available():.  
+00019930: 2020 2020 2020 7261 6973 6520 4646 4d50        raise FFMP
+00019940: 4547 436f 6465 6347 5055 4572 726f 7228  EGCodecGPUError(
+00019950: 0a20 2020 2020 2020 2020 2020 206d 7367  .            msg
+00019960: 3d22 4e56 4944 4941 2047 5055 206e 6f74  ="NVIDIA GPU not
+00019970: 2061 7661 696c 6162 6c65 222c 2073 6f75   available", sou
+00019980: 7263 653d 6d6f 7361 6963 5f63 6f6e 6361  rce=mosaic_conca
+00019990: 7465 6e61 746f 722e 5f5f 6e61 6d65 5f5f  tenator.__name__
+000199a0: 0a20 2020 2020 2020 2029 0a20 2020 2074  .        ).    t
+000199b0: 696d 6572 203d 2053 696d 6261 5469 6d65  imer = SimbaTime
+000199c0: 7228 7374 6172 743d 5472 7565 290a 2020  r(start=True).  
+000199d0: 2020 6474 203d 2064 6174 6574 696d 652e    dt = datetime.
+000199e0: 6e6f 7728 292e 7374 7266 7469 6d65 2822  now().strftime("
+000199f0: 2559 256d 2564 2548 254d 2553 2229 0a20  %Y%m%d%H%M%S"). 
+00019a00: 2020 2063 6865 636b 5f76 616c 6964 5f6c     check_valid_l
+00019a10: 7374 280a 2020 2020 2020 2020 6461 7461  st(.        data
+00019a20: 3d76 6964 656f 5f70 6174 6873 2c0a 2020  =video_paths,.  
+00019a30: 2020 2020 2020 736f 7572 6365 3d66 227b        source=f"{
+00019a40: 6d6f 7361 6963 5f63 6f6e 6361 7465 6e61  mosaic_concatena
+00019a50: 746f 722e 5f5f 6e61 6d65 5f5f 7d20 7669  tor.__name__} vi
+00019a60: 6465 6f5f 7061 7468 7322 2c0a 2020 2020  deo_paths",.    
+00019a70: 2020 2020 6d69 6e5f 6c65 6e3d 332c 0a20      min_len=3,. 
+00019a80: 2020 2029 0a20 2020 2076 6964 656f 5f6d     ).    video_m
+00019a90: 6574 615f 6461 7461 203d 205b 0a20 2020  eta_data = [.   
+00019aa0: 2020 2020 2067 6574 5f76 6964 656f 5f6d       get_video_m
+00019ab0: 6574 615f 6461 7461 2876 6964 656f 5f70  eta_data(video_p
+00019ac0: 6174 683d 7669 6465 6f5f 7061 7468 2920  ath=video_path) 
+00019ad0: 666f 7220 7669 6465 6f5f 7061 7468 2069  for video_path i
+00019ae0: 6e20 7669 6465 6f5f 7061 7468 730a 2020  n video_paths.  
+00019af0: 2020 5d0a 2020 2020 6d61 785f 7669 6465    ].    max_vide
+00019b00: 6f5f 6c65 6e67 7468 203d 206d 6178 285b  o_length = max([
+00019b10: 785b 2276 6964 656f 5f6c 656e 6774 685f  x["video_length_
+00019b20: 7322 5d20 666f 7220 7820 696e 2076 6964  s"] for x in vid
+00019b30: 656f 5f6d 6574 615f 6461 7461 5d29 0a20  eo_meta_data]). 
+00019b40: 2020 2069 6620 2828 7769 6474 685f 7078     if ((width_px
+00019b50: 2069 7320 4e6f 6e65 2920 616e 6420 2877   is None) and (w
+00019b60: 6964 7468 5f69 6478 2069 7320 4e6f 6e65  idth_idx is None
+00019b70: 2929 206f 7220 280a 2020 2020 2020 2020  )) or (.        
+00019b80: 2877 6964 7468 5f70 7820 6973 206e 6f74  (width_px is not
+00019b90: 204e 6f6e 6529 2061 6e64 2028 7769 6474   None) and (widt
+00019ba0: 685f 6964 7820 6973 206e 6f74 204e 6f6e  h_idx is not Non
+00019bb0: 6529 0a20 2020 2029 3a0a 2020 2020 2020  e).    ):.      
+00019bc0: 2020 7261 6973 6520 496e 7661 6c69 6449    raise InvalidI
+00019bd0: 6e70 7574 4572 726f 7228 0a20 2020 2020  nputError(.     
+00019be0: 2020 2020 2020 206d 7367 3d22 5072 6f76         msg="Prov
+00019bf0: 6964 6520 6120 7769 6474 685f 7078 204f  ide a width_px O
+00019c00: 5220 7769 6474 685f 6964 7822 2c20 736f  R width_idx", so
+00019c10: 7572 6365 3d6d 6f73 6169 635f 636f 6e63  urce=mosaic_conc
+00019c20: 6174 656e 6174 6f72 2e5f 5f6e 616d 655f  atenator.__name_
+00019c30: 5f0a 2020 2020 2020 2020 290a 2020 2020  _.        ).    
+00019c40: 6966 2028 2868 6569 6768 745f 7078 2069  if ((height_px i
+00019c50: 7320 4e6f 6e65 2920 616e 6420 2868 6569  s None) and (hei
+00019c60: 6768 745f 6964 7820 6973 204e 6f6e 6529  ght_idx is None)
+00019c70: 2920 6f72 2028 0a20 2020 2020 2020 2028  ) or (.        (
+00019c80: 6865 6967 6874 5f70 7820 6973 206e 6f74  height_px is not
+00019c90: 204e 6f6e 6529 2061 6e64 2028 6865 6967   None) and (heig
+00019ca0: 6874 5f69 6478 2069 7320 6e6f 7420 4e6f  ht_idx is not No
+00019cb0: 6e65 290a 2020 2020 293a 0a20 2020 2020  ne).    ):.     
+00019cc0: 2020 2072 6169 7365 2049 6e76 616c 6964     raise Invalid
+00019cd0: 496e 7075 7445 7272 6f72 280a 2020 2020  InputError(.    
+00019ce0: 2020 2020 2020 2020 6d73 673d 2250 726f          msg="Pro
+00019cf0: 7669 6465 2061 2068 6569 6768 745f 7078  vide a height_px
+00019d00: 204f 5220 6865 6967 6874 5f69 6478 222c   OR height_idx",
+00019d10: 2073 6f75 7263 653d 6d6f 7361 6963 5f63   source=mosaic_c
+00019d20: 6f6e 6361 7465 6e61 746f 722e 5f5f 6e61  oncatenator.__na
+00019d30: 6d65 5f5f 0a20 2020 2020 2020 2029 0a20  me__.        ). 
+00019d40: 2020 2069 6620 7769 6474 685f 6964 7820     if width_idx 
+00019d50: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+00019d60: 2020 2020 2063 6865 636b 5f69 6e74 280a       check_int(.
+00019d70: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+00019d80: 3d66 227b 7665 7274 6963 616c 5f76 6964  =f"{vertical_vid
+00019d90: 656f 5f63 6f6e 6361 7465 6e61 746f 722e  eo_concatenator.
+00019da0: 5f5f 6e61 6d65 5f5f 7d20 7769 6474 6820  __name__} width 
+00019db0: 696e 6465 7822 2c0a 2020 2020 2020 2020  index",.        
+00019dc0: 2020 2020 7661 6c75 653d 7769 6474 685f      value=width_
+00019dd0: 6964 782c 0a20 2020 2020 2020 2020 2020  idx,.           
+00019de0: 206d 696e 5f76 616c 7565 3d31 2c0a 2020   min_value=1,.  
+00019df0: 2020 2020 2020 2020 2020 6d61 785f 7661            max_va
+00019e00: 6c75 653d 6c65 6e28 7669 6465 6f5f 7061  lue=len(video_pa
+00019e10: 7468 7329 202d 2031 2c0a 2020 2020 2020  ths) - 1,.      
+00019e20: 2020 290a 2020 2020 2020 2020 7769 6474    ).        widt
+00019e30: 6820 3d20 696e 7428 7669 6465 6f5f 6d65  h = int(video_me
+00019e40: 7461 5f64 6174 615b 7769 6474 685f 6964  ta_data[width_id
+00019e50: 785d 5b22 7769 6474 6822 5d29 0a20 2020  x]["width"]).   
+00019e60: 2065 6c73 653a 0a20 2020 2020 2020 2077   else:.        w
+00019e70: 6964 7468 203d 2077 6964 7468 5f70 780a  idth = width_px.
+00019e80: 2020 2020 6966 2068 6569 6768 745f 6964      if height_id
+00019e90: 7820 6973 206e 6f74 204e 6f6e 653a 0a20  x is not None:. 
+00019ea0: 2020 2020 2020 2063 6865 636b 5f69 6e74         check_int
+00019eb0: 280a 2020 2020 2020 2020 2020 2020 6e61  (.            na
+00019ec0: 6d65 3d66 227b 7665 7274 6963 616c 5f76  me=f"{vertical_v
+00019ed0: 6964 656f 5f63 6f6e 6361 7465 6e61 746f  ideo_concatenato
+00019ee0: 722e 5f5f 6e61 6d65 5f5f 7d20 6865 6967  r.__name__} heig
+00019ef0: 6874 2069 6e64 6578 222c 0a20 2020 2020  ht index",.     
+00019f00: 2020 2020 2020 2076 616c 7565 3d77 6964         value=wid
+00019f10: 7468 5f69 6478 2c0a 2020 2020 2020 2020  th_idx,.        
+00019f20: 2020 2020 6d69 6e5f 7661 6c75 653d 312c      min_value=1,
+00019f30: 0a20 2020 2020 2020 2020 2020 206d 6178  .            max
+00019f40: 5f76 616c 7565 3d6c 656e 2876 6964 656f  _value=len(video
+00019f50: 5f70 6174 6873 2920 2d20 312c 0a20 2020  _paths) - 1,.   
+00019f60: 2020 2020 2029 0a20 2020 2020 2020 2068       ).        h
+00019f70: 6569 6768 7420 3d20 696e 7428 7669 6465  eight = int(vide
+00019f80: 6f5f 6d65 7461 5f64 6174 615b 7769 6474  o_meta_data[widt
+00019f90: 685f 6964 785d 5b22 6865 6967 6874 225d  h_idx]["height"]
+00019fa0: 290a 2020 2020 656c 7365 3a0a 2020 2020  ).    else:.    
+00019fb0: 2020 2020 6865 6967 6874 203d 2068 6569      height = hei
+00019fc0: 6768 745f 7078 0a20 2020 2069 6620 7665  ght_px.    if ve
+00019fd0: 7262 6f73 653a 0a20 2020 2020 2020 2070  rbose:.        p
+00019fe0: 7269 6e74 2866 2243 7265 6174 696e 6720  rint(f"Creating 
+00019ff0: 6d6f 7361 6963 2076 6964 656f 202e 2e2e  mosaic video ...
+0001a000: 2229 0a20 2020 2074 656d 705f 6469 7220  ").    temp_dir 
+0001a010: 3d20 6f73 2e70 6174 682e 6a6f 696e 286f  = os.path.join(o
+0001a020: 732e 7061 7468 2e64 6972 6e61 6d65 2876  s.path.dirname(v
+0001a030: 6964 656f 5f70 6174 6873 5b30 5d29 2c20  ideo_paths[0]), 
+0001a040: 6622 7465 6d70 5f7b 6474 7d22 290a 2020  f"temp_{dt}").  
+0001a050: 2020 6f73 2e6d 616b 6564 6972 7328 7465    os.makedirs(te
+0001a060: 6d70 5f64 6972 290a 2020 2020 6966 206e  mp_dir).    if n
+0001a070: 6f74 2028 6c65 6e28 7669 6465 6f5f 7061  ot (len(video_pa
+0001a080: 7468 7329 2025 2032 2920 3d3d 2030 3a0a  ths) % 2) == 0:.
+0001a090: 2020 2020 2020 2020 626c 616e 6b5f 7061          blank_pa
+0001a0a0: 7468 203d 206f 732e 7061 7468 2e6a 6f69  th = os.path.joi
+0001a0b0: 6e28 7465 6d70 5f64 6972 2c20 6622 7b64  n(temp_dir, f"{d
+0001a0c0: 747d 2e6d 7034 2229 0a20 2020 2020 2020  t}.mp4").       
+0001a0d0: 2063 7265 6174 655f 626c 616e 6b5f 7669   create_blank_vi
+0001a0e0: 6465 6f28 0a20 2020 2020 2020 2020 2020  deo(.           
+0001a0f0: 2070 6174 683d 626c 616e 6b5f 7061 7468   path=blank_path
+0001a100: 2c0a 2020 2020 2020 2020 2020 2020 6c65  ,.            le
+0001a110: 6e67 7468 3d6d 6178 5f76 6964 656f 5f6c  ngth=max_video_l
+0001a120: 656e 6774 682c 0a20 2020 2020 2020 2020  ength,.         
+0001a130: 2020 2077 6964 7468 3d77 6964 7468 2c0a     width=width,.
+0001a140: 2020 2020 2020 2020 2020 2020 6865 6967              heig
+0001a150: 6874 3d68 6569 6768 742c 0a20 2020 2020  ht=height,.     
+0001a160: 2020 2020 2020 2067 7075 3d67 7075 2c0a         gpu=gpu,.
+0001a170: 2020 2020 2020 2020 2020 2020 7665 7262              verb
+0001a180: 6f73 653d 7665 7262 6f73 652c 0a20 2020  ose=verbose,.   
+0001a190: 2020 2020 2020 2020 2063 6f6c 6f72 3d75           color=u
+0001a1a0: 6e65 7665 6e5f 6669 6c6c 5f63 6f6c 6f72  neven_fill_color
+0001a1b0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+0001a1c0: 2020 2020 7669 6465 6f5f 7061 7468 732e      video_paths.
+0001a1d0: 6170 7065 6e64 2862 6c61 6e6b 5f70 6174  append(blank_pat
+0001a1e0: 6829 0a20 2020 2075 7070 6572 5f76 6964  h).    upper_vid
+0001a1f0: 656f 732c 206c 6f77 6572 5f76 6964 656f  eos, lower_video
+0001a200: 7320 3d20 280a 2020 2020 2020 2020 7669  s = (.        vi
+0001a210: 6465 6f5f 7061 7468 735b 3a20 6c65 6e28  deo_paths[: len(
+0001a220: 7669 6465 6f5f 7061 7468 7329 202f 2f20  video_paths) // 
+0001a230: 325d 2c0a 2020 2020 2020 2020 7669 6465  2],.        vide
+0001a240: 6f5f 7061 7468 735b 6c65 6e28 7669 6465  o_paths[len(vide
+0001a250: 6f5f 7061 7468 7329 202f 2f20 3220 3a5d  o_paths) // 2 :]
+0001a260: 2c0a 2020 2020 290a 2020 2020 6966 2076  ,.    ).    if v
+0001a270: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
+0001a280: 7072 696e 7428 2243 7265 6174 696e 6720  print("Creating 
+0001a290: 7570 7065 7220 6d6f 7361 6963 2e2e 2e20  upper mosaic... 
+0001a2a0: 2853 7465 7020 312f 3329 2229 0a20 2020  (Step 1/3)").   
+0001a2b0: 2069 6620 6c65 6e28 7570 7065 725f 7669   if len(upper_vi
+0001a2c0: 6465 6f73 2920 3e20 313a 0a20 2020 2020  deos) > 1:.     
+0001a2d0: 2020 2075 7070 6572 5f70 6174 6820 3d20     upper_path = 
+0001a2e0: 6f73 2e70 6174 682e 6a6f 696e 2874 656d  os.path.join(tem
+0001a2f0: 705f 6469 722c 2022 7570 7065 722e 6d70  p_dir, "upper.mp
+0001a300: 3422 290a 2020 2020 2020 2020 686f 7269  4").        hori
+0001a310: 7a6f 6e74 616c 5f76 6964 656f 5f63 6f6e  zontal_video_con
+0001a320: 6361 7465 6e61 746f 7228 0a20 2020 2020  catenator(.     
+0001a330: 2020 2020 2020 2076 6964 656f 5f70 6174         video_pat
+0001a340: 6873 3d75 7070 6572 5f76 6964 656f 732c  hs=upper_videos,
+0001a350: 0a20 2020 2020 2020 2020 2020 2073 6176  .            sav
+0001a360: 655f 7061 7468 3d75 7070 6572 5f70 6174  e_path=upper_pat
+0001a370: 682c 0a20 2020 2020 2020 2020 2020 2067  h,.            g
+0001a380: 7075 3d67 7075 2c0a 2020 2020 2020 2020  pu=gpu,.        
+0001a390: 2020 2020 6865 6967 6874 5f70 783d 6865      height_px=he
+0001a3a0: 6967 6874 2c0a 2020 2020 2020 2020 2020  ight,.          
+0001a3b0: 2020 7665 7262 6f73 653d 7665 7262 6f73    verbose=verbos
+0001a3c0: 652c 0a20 2020 2020 2020 2029 0a20 2020  e,.        ).   
+0001a3d0: 2065 6c73 653a 0a20 2020 2020 2020 2075   else:.        u
+0001a3e0: 7070 6572 5f70 6174 6820 3d20 7570 7065  pper_path = uppe
+0001a3f0: 725f 7669 6465 6f73 5b30 5d0a 2020 2020  r_videos[0].    
+0001a400: 6966 2076 6572 626f 7365 3a0a 2020 2020  if verbose:.    
+0001a410: 2020 2020 7072 696e 7428 2243 7265 6174      print("Creat
+0001a420: 696e 6720 6c6f 7765 7220 6d6f 7361 6963  ing lower mosaic
+0001a430: 2e2e 2e20 2853 7465 7020 322f 3329 2229  ... (Step 2/3)")
+0001a440: 0a20 2020 2069 6620 6c65 6e28 6c6f 7765  .    if len(lowe
+0001a450: 725f 7669 6465 6f73 2920 3e20 313a 0a20  r_videos) > 1:. 
+0001a460: 2020 2020 2020 206c 6f77 6572 5f70 6174         lower_pat
+0001a470: 6820 3d20 6f73 2e70 6174 682e 6a6f 696e  h = os.path.join
+0001a480: 2874 656d 705f 6469 722c 2022 6c6f 7765  (temp_dir, "lowe
+0001a490: 722e 6d70 3422 290a 2020 2020 2020 2020  r.mp4").        
+0001a4a0: 686f 7269 7a6f 6e74 616c 5f76 6964 656f  horizontal_video
+0001a4b0: 5f63 6f6e 6361 7465 6e61 746f 7228 0a20  _concatenator(. 
+0001a4c0: 2020 2020 2020 2020 2020 2076 6964 656f             video
+0001a4d0: 5f70 6174 6873 3d6c 6f77 6572 5f76 6964  _paths=lower_vid
+0001a4e0: 656f 732c 0a20 2020 2020 2020 2020 2020  eos,.           
+0001a4f0: 2073 6176 655f 7061 7468 3d6c 6f77 6572   save_path=lower
+0001a500: 5f70 6174 682c 0a20 2020 2020 2020 2020  _path,.         
+0001a510: 2020 2067 7075 3d67 7075 2c0a 2020 2020     gpu=gpu,.    
+0001a520: 2020 2020 2020 2020 6865 6967 6874 5f70          height_p
+0001a530: 783d 6865 6967 6874 2c0a 2020 2020 2020  x=height,.      
+0001a540: 2020 2020 2020 7665 7262 6f73 653d 7665        verbose=ve
+0001a550: 7262 6f73 652c 0a20 2020 2020 2020 2029  rbose,.        )
+0001a560: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
+0001a570: 2020 206c 6f77 6572 5f70 6174 6820 3d20     lower_path = 
+0001a580: 6c6f 7765 725f 7669 6465 6f73 5b30 5d0a  lower_videos[0].
+0001a590: 2020 2020 7061 6e65 6c73 5f6d 6574 6120      panels_meta 
+0001a5a0: 3d20 5b0a 2020 2020 2020 2020 6765 745f  = [.        get_
+0001a5b0: 7669 6465 6f5f 6d65 7461 5f64 6174 6128  video_meta_data(
+0001a5c0: 7669 6465 6f5f 7061 7468 3d76 6964 656f  video_path=video
+0001a5d0: 5f70 6174 6829 0a20 2020 2020 2020 2066  _path).        f
+0001a5e0: 6f72 2076 6964 656f 5f70 6174 6820 696e  or video_path in
+0001a5f0: 205b 6c6f 7765 725f 7061 7468 2c20 7570   [lower_path, up
+0001a600: 7065 725f 7061 7468 5d0a 2020 2020 5d0a  per_path].    ].
+0001a610: 2020 2020 6966 2076 6572 626f 7365 3a0a      if verbose:.
+0001a620: 2020 2020 2020 2020 7072 696e 7428 224a          print("J
+0001a630: 6f69 6e69 6e67 2075 7070 6572 2061 6e64  oining upper and
+0001a640: 206c 6f77 6572 206d 6f73 6169 632e 2e2e   lower mosaic...
+0001a650: 2028 5374 6570 2032 2f33 2922 290a 2020   (Step 2/3)").  
+0001a660: 2020 7665 7274 6963 616c 5f76 6964 656f    vertical_video
+0001a670: 5f63 6f6e 6361 7465 6e61 746f 7228 0a20  _concatenator(. 
+0001a680: 2020 2020 2020 2076 6964 656f 5f70 6174         video_pat
+0001a690: 6873 3d5b 7570 7065 725f 7061 7468 2c20  hs=[upper_path, 
+0001a6a0: 6c6f 7765 725f 7061 7468 5d2c 0a20 2020  lower_path],.   
+0001a6b0: 2020 2020 2073 6176 655f 7061 7468 3d73       save_path=s
+0001a6c0: 6176 655f 7061 7468 2c0a 2020 2020 2020  ave_path,.      
+0001a6d0: 2020 7665 7262 6f73 653d 7665 7262 6f73    verbose=verbos
+0001a6e0: 652c 0a20 2020 2020 2020 2067 7075 3d67  e,.        gpu=g
+0001a6f0: 7075 2c0a 2020 2020 2020 2020 7769 6474  pu,.        widt
+0001a700: 685f 7078 3d6d 6178 285b 785b 2277 6964  h_px=max([x["wid
+0001a710: 7468 225d 2066 6f72 2078 2069 6e20 7061  th"] for x in pa
+0001a720: 6e65 6c73 5f6d 6574 615d 292c 0a20 2020  nels_meta]),.   
+0001a730: 2029 0a20 2020 2074 696d 6572 2e73 746f   ).    timer.sto
+0001a740: 705f 7469 6d65 7228 290a 2020 2020 7368  p_timer().    sh
+0001a750: 7574 696c 2e72 6d74 7265 6528 7465 6d70  util.rmtree(temp
+0001a760: 5f64 6972 290a 2020 2020 6966 2076 6572  _dir).    if ver
+0001a770: 626f 7365 3a0a 2020 2020 2020 2020 7072  bose:.        pr
+0001a780: 696e 7428 0a20 2020 2020 2020 2020 2020  int(.           
+0001a790: 2066 224d 6f73 6169 6320 636f 6e63 6174   f"Mosaic concat
+0001a7a0: 656e 6174 696f 6e20 636f 6d70 6c65 7465  enation complete
+0001a7b0: 2e20 5361 7665 6420 6174 207b 7361 7665  . Saved at {save
+0001a7c0: 5f70 6174 687d 2028 456c 6170 7365 6420  _path} (Elapsed 
+0001a7d0: 7469 6d65 3a20 7b74 696d 6572 2e65 6c61  time: {timer.ela
+0001a7e0: 7073 6564 5f74 696d 655f 7374 727d 732e  psed_time_str}s.
+0001a7f0: 2922 0a20 2020 2020 2020 2029 0a0a 0a64  )".        )...d
+0001a800: 6566 206d 6978 6564 5f6d 6f73 6169 635f  ef mixed_mosaic_
+0001a810: 636f 6e63 6174 656e 6174 6f72 280a 2020  concatenator(.  
+0001a820: 2020 7669 6465 6f5f 7061 7468 733a 204c    video_paths: L
+0001a830: 6973 745b 556e 696f 6e5b 7374 722c 206f  ist[Union[str, o
+0001a840: 732e 5061 7468 4c69 6b65 5d5d 2c0a 2020  s.PathLike]],.  
+0001a850: 2020 7361 7665 5f70 6174 683a 2055 6e69    save_path: Uni
+0001a860: 6f6e 5b73 7472 2c20 6f73 2e50 6174 684c  on[str, os.PathL
+0001a870: 696b 655d 2c0a 2020 2020 6770 753a 204f  ike],.    gpu: O
+0001a880: 7074 696f 6e61 6c5b 626f 6f6c 5d20 3d20  ptional[bool] = 
+0001a890: 4661 6c73 652c 0a20 2020 2076 6572 626f  False,.    verbo
+0001a8a0: 7365 3a20 4f70 7469 6f6e 616c 5b62 6f6f  se: Optional[boo
+0001a8b0: 6c5d 203d 2054 7275 652c 0a20 2020 2075  l] = True,.    u
+0001a8c0: 6e65 7665 6e5f 6669 6c6c 5f63 6f6c 6f72  neven_fill_color
+0001a8d0: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
+0001a8e0: 3d20 2262 6c61 636b 222c 0a29 202d 3e20  = "black",.) -> 
+0001a8f0: 4e6f 6e65 3a0a 2020 2020 2222 220a 2020  None:.    """.  
+0001a900: 2020 4372 6561 7465 2061 206d 6978 6564    Create a mixed
+0001a910: 206d 6f73 6169 6320 7669 6465 6f20 6279   mosaic video by
+0001a920: 2063 6f6e 6361 7465 6e61 7469 6e67 206d   concatenating m
+0001a930: 756c 7469 706c 6520 696e 7075 7420 7669  ultiple input vi
+0001a940: 6465 6f73 2069 6e20 6120 6d6f 7361 6963  deos in a mosaic
+0001a950: 206c 6179 6f75 7420 6f66 2076 6172 696f   layout of vario
+0001a960: 7573 2073 697a 6573 2e0a 0a20 2020 202e  us sizes...    .
+0001a970: 2e20 696d 6167 653a 3a20 5f73 7461 7469  . image:: _stati
+0001a980: 632f 696d 672f 6d69 7865 645f 6d6f 7361  c/img/mixed_mosa
+0001a990: 6963 5f63 6f6e 6361 7465 6e61 746f 722e  ic_concatenator.
+0001a9a0: 706e 670a 2020 2020 2020 203a 7769 6474  png.       :widt
+0001a9b0: 683a 2036 3030 0a20 2020 2020 2020 3a61  h: 600.       :a
+0001a9c0: 6c69 676e 3a20 6365 6e74 6572 0a0a 2020  lign: center..  
+0001a9d0: 2020 2e2e 206e 6f74 653a 3a0a 2020 2020    .. note::.    
+0001a9e0: 2020 2054 6865 2072 6573 6f6c 7574 696f     The resolutio
+0001a9f0: 6e20 6f66 2074 6865 206f 7574 7075 7420  n of the output 
+0001aa00: 7669 6465 6f20 6973 2064 6574 6572 6d69  video is determi
+0001aa10: 6e65 6420 6279 2074 6865 2072 6573 6f6c  ned by the resol
+0001aa20: 7574 696f 6e20 6f66 2074 6865 2076 6964  ution of the vid
+0001aa30: 656f 2070 6174 6820 6174 2074 6865 2066  eo path at the f
+0001aa40: 6972 7374 2069 6e64 6578 2e0a 0a20 2020  irst index...   
+0001aa50: 2020 2020 4966 2061 6e20 756e 6576 656e      If an uneven
+0001aa60: 206e 756d 6265 7220 6f66 2072 6967 6874   number of right
+0001aa70: 2d70 616e 656c 2076 6964 656f 7320 2820  -panel videos ( 
+0001aa80: 6966 206e 6f74 2028 6c65 6e28 7669 6465  if not (len(vide
+0001aa90: 6f5f 7061 7468 7329 2d31 2920 2520 3229  o_paths)-1) % 2)
+0001aaa0: 203d 3d20 3029 2c20 7468 656e 2074 6865   == 0), then the
+0001aab0: 206c 6173 7420 696e 6465 7820 7769 6c6c   last index will
+0001aac0: 2062 6520 6669 6c6c 6564 2062 7920 6060   be filled by ``
+0001aad0: 756e 6576 656e 5f66 696c 6c5f 636f 6c6f  uneven_fill_colo
+0001aae0: 7260 602e 0a0a 2020 2020 3a70 6172 616d  r``...    :param
+0001aaf0: 204c 6973 745b 556e 696f 6e5b 7374 722c   List[Union[str,
+0001ab00: 206f 732e 5061 7468 4c69 6b65 5d5d 2076   os.PathLike]] v
+0001ab10: 6964 656f 5f70 6174 6873 3a20 4c69 7374  ideo_paths: List
+0001ab20: 206f 6620 696e 7075 7420 7669 6465 6f20   of input video 
+0001ab30: 6669 6c65 2070 6174 6873 2e0a 2020 2020  file paths..    
+0001ab40: 3a70 6172 616d 2055 6e69 6f6e 5b73 7472  :param Union[str
+0001ab50: 2c20 6f73 2e50 6174 684c 696b 655d 2073  , os.PathLike] s
+0001ab60: 6176 655f 7061 7468 3a20 4669 6c65 2070  ave_path: File p
+0001ab70: 6174 6820 746f 2073 6176 6520 7468 6520  ath to save the 
+0001ab80: 636f 6e63 6174 656e 6174 6564 2076 6964  concatenated vid
+0001ab90: 656f 2e0a 2020 2020 3a70 6172 616d 204f  eo..    :param O
+0001aba0: 7074 696f 6e61 6c5b 626f 6f6c 5d20 6770  ptional[bool] gp
+0001abb0: 753a 2057 6865 7468 6572 2074 6f20 7573  u: Whether to us
+0001abc0: 6520 4750 552d 6163 6365 6c65 7261 7465  e GPU-accelerate
+0001abd0: 6420 636f 6465 6320 2864 6566 6175 6c74  d codec (default
+0001abe0: 3a20 4661 6c73 6529 2e0a 2020 2020 3a70  : False)..    :p
+0001abf0: 6172 616d 204f 7074 696f 6e61 6c5b 626f  aram Optional[bo
+0001ac00: 6f6c 5d20 7665 7262 6f73 653a 2057 6865  ol] verbose: Whe
+0001ac10: 7468 6572 2074 6f20 7072 696e 7420 7072  ther to print pr
+0001ac20: 6f67 7265 7373 206d 6573 7361 6765 7320  ogress messages 
+0001ac30: 2864 6566 6175 6c74 3a20 5472 7565 292e  (default: True).
+0001ac40: 0a0a 2020 2020 3a65 7861 6d70 6c65 3a0a  ..    :example:.
+0001ac50: 2020 2020 3e3e 3e20 7669 6465 6f5f 7061      >>> video_pa
+0001ac60: 7468 7320 3d20 5b27 7669 6465 6f31 2e6d  ths = ['video1.m
+0001ac70: 7034 272c 2027 7669 6465 6f32 2e6d 7034  p4', 'video2.mp4
+0001ac80: 272c 2027 7669 6465 6f33 2e6d 7034 275d  ', 'video3.mp4']
+0001ac90: 0a20 2020 203e 3e3e 2073 6176 655f 7061  .    >>> save_pa
+0001aca0: 7468 203d 2027 2f55 7365 7273 2f73 696d  th = '/Users/sim
+0001acb0: 6f6e 2f44 6573 6b74 6f70 2f65 6e76 732f  on/Desktop/envs/
+0001acc0: 7369 6d62 612f 7472 6f75 626c 6573 686f  simba/troublesho
+0001acd0: 6f74 696e 672f 5241 545f 4e4f 522f 7072  oting/RAT_NOR/pr
+0001ace0: 6f6a 6563 745f 666f 6c64 6572 2f76 6964  oject_folder/vid
+0001acf0: 656f 732f 7465 7374 2f6e 6577 2f62 6c61  eos/test/new/bla
+0001ad00: 6e6b 5f74 6573 742e 6d70 3427 0a20 2020  nk_test.mp4'.   
+0001ad10: 203e 3e3e 206d 6978 6564 5f6d 6f73 6169   >>> mixed_mosai
+0001ad20: 635f 636f 6e63 6174 656e 6174 6f72 2876  c_concatenator(v
+0001ad30: 6964 656f 5f70 6174 6873 3d76 6964 656f  ideo_paths=video
+0001ad40: 5f70 6174 6873 2c20 7361 7665 5f70 6174  _paths, save_pat
+0001ad50: 683d 7361 7665 5f70 6174 682c 2067 7075  h=save_path, gpu
+0001ad60: 3d46 616c 7365 2c20 7665 7262 6f73 653d  =False, verbose=
+0001ad70: 5472 7565 290a 2020 2020 2222 220a 0a20  True).    """.. 
+0001ad80: 2020 2063 6865 636b 5f66 666d 7065 675f     check_ffmpeg_
+0001ad90: 6176 6169 6c61 626c 6528 290a 2020 2020  available().    
+0001ada0: 6966 2067 7075 2061 6e64 206e 6f74 2063  if gpu and not c
+0001adb0: 6865 636b 5f6e 7669 6465 615f 6770 755f  heck_nvidea_gpu_
+0001adc0: 6176 6169 6c61 626c 6528 293a 0a20 2020  available():.   
+0001add0: 2020 2020 2072 6169 7365 2046 464d 5045       raise FFMPE
+0001ade0: 4743 6f64 6563 4750 5545 7272 6f72 280a  GCodecGPUError(.
+0001adf0: 2020 2020 2020 2020 2020 2020 6d73 673d              msg=
+0001ae00: 224e 5649 4449 4120 4750 5520 6e6f 7420  "NVIDIA GPU not 
+0001ae10: 6176 6169 6c61 626c 6522 2c20 736f 7572  available", sour
+0001ae20: 6365 3d6d 6978 6564 5f6d 6f73 6169 635f  ce=mixed_mosaic_
+0001ae30: 636f 6e63 6174 656e 6174 6f72 2e5f 5f6e  concatenator.__n
+0001ae40: 616d 655f 5f0a 2020 2020 2020 2020 290a  ame__.        ).
+0001ae50: 2020 2020 7469 6d65 7220 3d20 5369 6d62      timer = Simb
+0001ae60: 6154 696d 6572 2873 7461 7274 3d54 7275  aTimer(start=Tru
+0001ae70: 6529 0a20 2020 2063 6865 636b 5f76 616c  e).    check_val
+0001ae80: 6964 5f6c 7374 280a 2020 2020 2020 2020  id_lst(.        
+0001ae90: 6461 7461 3d76 6964 656f 5f70 6174 6873  data=video_paths
+0001aea0: 2c20 736f 7572 6365 3d6d 6978 6564 5f6d  , source=mixed_m
+0001aeb0: 6f73 6169 635f 636f 6e63 6174 656e 6174  osaic_concatenat
+0001aec0: 6f72 2e5f 5f6e 616d 655f 5f2c 206d 696e  or.__name__, min
+0001aed0: 5f6c 656e 3d32 0a20 2020 2029 0a20 2020  _len=2.    ).   
+0001aee0: 2064 7420 3d20 6461 7465 7469 6d65 2e6e   dt = datetime.n
+0001aef0: 6f77 2829 2e73 7472 6674 696d 6528 2225  ow().strftime("%
+0001af00: 5925 6d25 6425 4825 4d25 5322 290a 2020  Y%m%d%H%M%S").  
+0001af10: 2020 7669 6465 6f5f 6d65 7461 5f64 6174    video_meta_dat
+0001af20: 6120 3d20 5b0a 2020 2020 2020 2020 6765  a = [.        ge
+0001af30: 745f 7669 6465 6f5f 6d65 7461 5f64 6174  t_video_meta_dat
+0001af40: 6128 7669 6465 6f5f 7061 7468 3d76 6964  a(video_path=vid
+0001af50: 656f 5f70 6174 6829 2066 6f72 2076 6964  eo_path) for vid
+0001af60: 656f 5f70 6174 6820 696e 2076 6964 656f  eo_path in video
+0001af70: 5f70 6174 6873 0a20 2020 205d 0a20 2020  _paths.    ].   
+0001af80: 206d 6178 5f76 6964 656f 5f6c 656e 6774   max_video_lengt
+0001af90: 6820 3d20 6d61 7828 5b78 5b22 7669 6465  h = max([x["vide
+0001afa0: 6f5f 6c65 6e67 7468 5f73 225d 2066 6f72  o_length_s"] for
+0001afb0: 2078 2069 6e20 7669 6465 6f5f 6d65 7461   x in video_meta
+0001afc0: 5f64 6174 615d 290a 2020 2020 6368 6563  _data]).    chec
+0001afd0: 6b5f 6966 5f64 6972 5f65 7869 7374 7328  k_if_dir_exists(
+0001afe0: 0a20 2020 2020 2020 2069 6e5f 6469 723d  .        in_dir=
+0001aff0: 6f73 2e70 6174 682e 6469 726e 616d 6528  os.path.dirname(
+0001b000: 7361 7665 5f70 6174 6829 2c20 736f 7572  save_path), sour
+0001b010: 6365 3d6d 6978 6564 5f6d 6f73 6169 635f  ce=mixed_mosaic_
+0001b020: 636f 6e63 6174 656e 6174 6f72 2e5f 5f6e  concatenator.__n
+0001b030: 616d 655f 5f0a 2020 2020 290a 2020 2020  ame__.    ).    
+0001b040: 6c61 7267 655f 6d6f 7361 6963 5f70 6174  large_mosaic_pat
+0001b050: 682c 2076 6964 656f 5f70 6174 6873 203d  h, video_paths =
+0001b060: 2076 6964 656f 5f70 6174 6873 5b30 5d2c   video_paths[0],
+0001b070: 2076 6964 656f 5f70 6174 6873 5b31 3a5d   video_paths[1:]
+0001b080: 0a20 2020 206d 6f73 6169 635f 6865 6967  .    mosaic_heig
+0001b090: 6874 203d 2069 6e74 2876 6964 656f 5f6d  ht = int(video_m
+0001b0a0: 6574 615f 6461 7461 5b30 5d5b 2268 6569  eta_data[0]["hei
+0001b0b0: 6768 7422 5d20 2f20 3229 0a20 2020 2069  ght"] / 2).    i
+0001b0c0: 6620 7665 7262 6f73 653a 0a20 2020 2020  f verbose:.     
+0001b0d0: 2020 2070 7269 6e74 2822 4372 6561 7469     print("Creati
+0001b0e0: 6e67 206d 6978 6564 206d 6f73 6169 6320  ng mixed mosaic 
+0001b0f0: 7669 6465 6f2e 2e2e 2022 290a 2020 2020  video... ").    
+0001b100: 7465 6d70 5f64 6972 203d 206f 732e 7061  temp_dir = os.pa
+0001b110: 7468 2e6a 6f69 6e28 6f73 2e70 6174 682e  th.join(os.path.
+0001b120: 6469 726e 616d 6528 7669 6465 6f5f 7061  dirname(video_pa
+0001b130: 7468 735b 305d 292c 2066 2274 656d 705f  ths[0]), f"temp_
+0001b140: 7b64 747d 2229 0a20 2020 206f 732e 6d61  {dt}").    os.ma
+0001b150: 6b65 6469 7273 2874 656d 705f 6469 7229  kedirs(temp_dir)
+0001b160: 0a20 2020 2069 6620 6e6f 7420 286c 656e  .    if not (len
+0001b170: 2876 6964 656f 5f70 6174 6873 2920 2520  (video_paths) % 
+0001b180: 3229 203d 3d20 303a 0a20 2020 2020 2020  2) == 0:.       
+0001b190: 2062 6c61 6e6b 5f70 6174 6820 3d20 6f73   blank_path = os
+0001b1a0: 2e70 6174 682e 6a6f 696e 2874 656d 705f  .path.join(temp_
+0001b1b0: 6469 722c 2066 227b 6474 7d2e 6d70 3422  dir, f"{dt}.mp4"
+0001b1c0: 290a 2020 2020 2020 2020 6372 6561 7465  ).        create
+0001b1d0: 5f62 6c61 6e6b 5f76 6964 656f 280a 2020  _blank_video(.  
+0001b1e0: 2020 2020 2020 2020 2020 7061 7468 3d62            path=b
+0001b1f0: 6c61 6e6b 5f70 6174 682c 0a20 2020 2020  lank_path,.     
+0001b200: 2020 2020 2020 206c 656e 6774 683d 6d61         length=ma
+0001b210: 785f 7669 6465 6f5f 6c65 6e67 7468 2c0a  x_video_length,.
+0001b220: 2020 2020 2020 2020 2020 2020 7769 6474              widt
+0001b230: 683d 7669 6465 6f5f 6d65 7461 5f64 6174  h=video_meta_dat
+0001b240: 615b 2d31 5d5b 2277 6964 7468 225d 2c0a  a[-1]["width"],.
+0001b250: 2020 2020 2020 2020 2020 2020 6865 6967              heig
+0001b260: 6874 3d6d 6f73 6169 635f 6865 6967 6874  ht=mosaic_height
+0001b270: 2c0a 2020 2020 2020 2020 2020 2020 6770  ,.            gp
+0001b280: 753d 6770 752c 0a20 2020 2020 2020 2020  u=gpu,.         
+0001b290: 2020 2076 6572 626f 7365 3d54 7275 652c     verbose=True,
+0001b2a0: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
+0001b2b0: 6f72 3d75 6e65 7665 6e5f 6669 6c6c 5f63  or=uneven_fill_c
+0001b2c0: 6f6c 6f72 2c0a 2020 2020 2020 2020 290a  olor,.        ).
+0001b2d0: 2020 2020 2020 2020 7669 6465 6f5f 7061          video_pa
+0001b2e0: 7468 732e 6170 7065 6e64 2862 6c61 6e6b  ths.append(blank
+0001b2f0: 5f70 6174 6829 0a20 2020 2075 7070 6572  _path).    upper
+0001b300: 5f76 6964 656f 732c 206c 6f77 6572 5f76  _videos, lower_v
+0001b310: 6964 656f 7320 3d20 280a 2020 2020 2020  ideos = (.      
+0001b320: 2020 7669 6465 6f5f 7061 7468 735b 3a20    video_paths[: 
+0001b330: 6c65 6e28 7669 6465 6f5f 7061 7468 7329  len(video_paths)
+0001b340: 202f 2f20 325d 2c0a 2020 2020 2020 2020   // 2],.        
+0001b350: 7669 6465 6f5f 7061 7468 735b 6c65 6e28  video_paths[len(
+0001b360: 7669 6465 6f5f 7061 7468 7329 202f 2f20  video_paths) // 
+0001b370: 3220 3a5d 2c0a 2020 2020 290a 2020 2020  2 :],.    ).    
+0001b380: 6966 2076 6572 626f 7365 3a0a 2020 2020  if verbose:.    
+0001b390: 2020 2020 7072 696e 7428 2243 7265 6174      print("Creat
+0001b3a0: 696e 6720 7570 7065 7220 7269 6768 7420  ing upper right 
+0001b3b0: 6d6f 7361 6963 202e 2e2e 2028 5374 6570  mosaic ... (Step
+0001b3c0: 2031 2f34 2922 290a 2020 2020 6966 206c   1/4)").    if l
+0001b3d0: 656e 2875 7070 6572 5f76 6964 656f 7329  en(upper_videos)
+0001b3e0: 203e 2031 3a0a 2020 2020 2020 2020 7570   > 1:.        up
+0001b3f0: 7065 725f 7061 7468 203d 206f 732e 7061  per_path = os.pa
+0001b400: 7468 2e6a 6f69 6e28 7465 6d70 5f64 6972  th.join(temp_dir
+0001b410: 2c20 2275 7070 6572 2e6d 7034 2229 0a20  , "upper.mp4"). 
+0001b420: 2020 2020 2020 2068 6f72 697a 6f6e 7461         horizonta
+0001b430: 6c5f 7669 6465 6f5f 636f 6e63 6174 656e  l_video_concaten
+0001b440: 6174 6f72 280a 2020 2020 2020 2020 2020  ator(.          
+0001b450: 2020 7669 6465 6f5f 7061 7468 733d 7570    video_paths=up
+0001b460: 7065 725f 7669 6465 6f73 2c0a 2020 2020  per_videos,.    
+0001b470: 2020 2020 2020 2020 7361 7665 5f70 6174          save_pat
+0001b480: 683d 7570 7065 725f 7061 7468 2c0a 2020  h=upper_path,.  
+0001b490: 2020 2020 2020 2020 2020 6770 753d 6770            gpu=gp
+0001b4a0: 752c 0a20 2020 2020 2020 2020 2020 2068  u,.            h
+0001b4b0: 6569 6768 745f 7078 3d6d 6f73 6169 635f  eight_px=mosaic_
+0001b4c0: 6865 6967 6874 2c0a 2020 2020 2020 2020  height,.        
+0001b4d0: 2020 2020 7665 7262 6f73 653d 7665 7262      verbose=verb
+0001b4e0: 6f73 652c 0a20 2020 2020 2020 2029 0a20  ose,.        ). 
+0001b4f0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0001b500: 2075 7070 6572 5f70 6174 6820 3d20 7570   upper_path = up
+0001b510: 7065 725f 7669 6465 6f73 5b30 5d0a 2020  per_videos[0].  
+0001b520: 2020 6966 2076 6572 626f 7365 3a0a 2020    if verbose:.  
+0001b530: 2020 2020 2020 7072 696e 7428 2243 7265        print("Cre
+0001b540: 6174 696e 6720 6c6f 7765 7220 7269 6768  ating lower righ
+0001b550: 7420 6d6f 7361 6963 202e 2e2e 2028 5374  t mosaic ... (St
+0001b560: 6570 2032 2f34 2922 290a 2020 2020 6966  ep 2/4)").    if
+0001b570: 206c 656e 286c 6f77 6572 5f76 6964 656f   len(lower_video
+0001b580: 7329 203e 2031 3a0a 2020 2020 2020 2020  s) > 1:.        
+0001b590: 6c6f 7765 725f 7061 7468 203d 206f 732e  lower_path = os.
+0001b5a0: 7061 7468 2e6a 6f69 6e28 7465 6d70 5f64  path.join(temp_d
+0001b5b0: 6972 2c20 226c 6f77 6572 2e6d 7034 2229  ir, "lower.mp4")
+0001b5c0: 0a20 2020 2020 2020 2068 6f72 697a 6f6e  .        horizon
+0001b5d0: 7461 6c5f 7669 6465 6f5f 636f 6e63 6174  tal_video_concat
+0001b5e0: 656e 6174 6f72 280a 2020 2020 2020 2020  enator(.        
+0001b5f0: 2020 2020 7669 6465 6f5f 7061 7468 733d      video_paths=
+0001b600: 6c6f 7765 725f 7669 6465 6f73 2c20 7361  lower_videos, sa
+0001b610: 7665 5f70 6174 683d 6c6f 7765 725f 7061  ve_path=lower_pa
+0001b620: 7468 2c20 6770 753d 6770 752c 2076 6572  th, gpu=gpu, ver
+0001b630: 626f 7365 3d76 6572 626f 7365 0a20 2020  bose=verbose.   
+0001b640: 2020 2020 2029 0a20 2020 2065 6c73 653a       ).    else:
+0001b650: 0a20 2020 2020 2020 206c 6f77 6572 5f70  .        lower_p
+0001b660: 6174 6820 3d20 6c6f 7765 725f 7669 6465  ath = lower_vide
+0001b670: 6f73 5b30 5d0a 2020 2020 7061 6e65 6c73  os[0].    panels
+0001b680: 5f6d 6574 6120 3d20 5b0a 2020 2020 2020  _meta = [.      
+0001b690: 2020 6765 745f 7669 6465 6f5f 6d65 7461    get_video_meta
+0001b6a0: 5f64 6174 6128 7669 6465 6f5f 7061 7468  _data(video_path
+0001b6b0: 3d76 6964 656f 5f70 6174 6829 0a20 2020  =video_path).   
+0001b6c0: 2020 2020 2066 6f72 2076 6964 656f 5f70       for video_p
+0001b6d0: 6174 6820 696e 205b 6c6f 7765 725f 7061  ath in [lower_pa
+0001b6e0: 7468 2c20 7570 7065 725f 7061 7468 5d0a  th, upper_path].
+0001b6f0: 2020 2020 5d0a 2020 2020 6d6f 7361 6963      ].    mosaic
+0001b700: 5f70 6174 6820 3d20 6f73 2e70 6174 682e  _path = os.path.
+0001b710: 6a6f 696e 2874 656d 705f 6469 722c 2022  join(temp_dir, "
+0001b720: 6d6f 7361 6963 2e6d 7034 2229 0a20 2020  mosaic.mp4").   
+0001b730: 2069 6620 7665 7262 6f73 653a 0a20 2020   if verbose:.   
+0001b740: 2020 2020 2070 7269 6e74 2822 4a6f 696e       print("Join
+0001b750: 696e 6720 7570 7065 7220 616e 6420 6c6f  ing upper and lo
+0001b760: 7765 7220 7269 6768 7420 6d6f 7361 6963  wer right mosaic
+0001b770: 2e2e 2e20 2853 7465 7020 332f 3429 2229  ... (Step 3/4)")
+0001b780: 0a20 2020 2076 6572 7469 6361 6c5f 7669  .    vertical_vi
+0001b790: 6465 6f5f 636f 6e63 6174 656e 6174 6f72  deo_concatenator
+0001b7a0: 280a 2020 2020 2020 2020 7669 6465 6f5f  (.        video_
+0001b7b0: 7061 7468 733d 5b75 7070 6572 5f70 6174  paths=[upper_pat
+0001b7c0: 682c 206c 6f77 6572 5f70 6174 685d 2c0a  h, lower_path],.
+0001b7d0: 2020 2020 2020 2020 7769 6474 685f 7078          width_px
+0001b7e0: 3d6d 696e 285b 785b 2277 6964 7468 225d  =min([x["width"]
+0001b7f0: 2066 6f72 2078 2069 6e20 7061 6e65 6c73   for x in panels
+0001b800: 5f6d 6574 615d 292c 0a20 2020 2020 2020  _meta]),.       
+0001b810: 2073 6176 655f 7061 7468 3d6d 6f73 6169   save_path=mosai
+0001b820: 635f 7061 7468 2c0a 2020 2020 2020 2020  c_path,.        
+0001b830: 6770 753d 6770 752c 0a20 2020 2020 2020  gpu=gpu,.       
+0001b840: 2076 6572 626f 7365 3d76 6572 626f 7365   verbose=verbose
+0001b850: 2c0a 2020 2020 290a 2020 2020 6966 2076  ,.    ).    if v
+0001b860: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
+0001b870: 7072 696e 7428 224a 6f69 6e69 6e67 206c  print("Joining l
+0001b880: 6566 7420 616e 6420 7269 6768 7420 6d6f  eft and right mo
+0001b890: 7361 6963 2e2e 2e20 2853 7465 7020 342f  saic... (Step 4/
+0001b8a0: 3429 2229 0a20 2020 2068 6f72 697a 6f6e  4)").    horizon
+0001b8b0: 7461 6c5f 7669 6465 6f5f 636f 6e63 6174  tal_video_concat
+0001b8c0: 656e 6174 6f72 280a 2020 2020 2020 2020  enator(.        
+0001b8d0: 7669 6465 6f5f 7061 7468 733d 5b6c 6172  video_paths=[lar
+0001b8e0: 6765 5f6d 6f73 6169 635f 7061 7468 2c20  ge_mosaic_path, 
+0001b8f0: 6d6f 7361 6963 5f70 6174 685d 2c0a 2020  mosaic_path],.  
+0001b900: 2020 2020 2020 6865 6967 6874 5f69 6478        height_idx
+0001b910: 3d30 2c0a 2020 2020 2020 2020 7361 7665  =0,.        save
+0001b920: 5f70 6174 683d 7361 7665 5f70 6174 682c  _path=save_path,
+0001b930: 0a20 2020 2020 2020 2067 7075 3d67 7075  .        gpu=gpu
+0001b940: 2c0a 2020 2020 290a 2020 2020 7469 6d65  ,.    ).    time
+0001b950: 722e 7374 6f70 5f74 696d 6572 2829 0a20  r.stop_timer(). 
+0001b960: 2020 2073 6875 7469 6c2e 726d 7472 6565     shutil.rmtree
+0001b970: 2874 656d 705f 6469 7229 0a20 2020 2069  (temp_dir).    i
+0001b980: 6620 7665 7262 6f73 653a 0a20 2020 2020  f verbose:.     
+0001b990: 2020 2070 7269 6e74 280a 2020 2020 2020     print(.      
+0001b9a0: 2020 2020 2020 6622 4d69 7865 6420 6d6f        f"Mixed mo
+0001b9b0: 7361 6963 2063 6f6e 6361 7465 6e61 7469  saic concatenati
+0001b9c0: 6f6e 2063 6f6d 706c 6574 652e 2053 6176  on complete. Sav
+0001b9d0: 6564 2061 7420 7b73 6176 655f 7061 7468  ed at {save_path
+0001b9e0: 7d20 2845 6c61 7073 6564 2074 696d 653a  } (Elapsed time:
+0001b9f0: 207b 7469 6d65 722e 656c 6170 7365 645f   {timer.elapsed_
+0001ba00: 7469 6d65 5f73 7472 7d73 2e29 220a 2020  time_str}s.)".  
+0001ba10: 2020 2020 2020 290a                            ).
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/video_processors/.DS_Store` & `Simba-UW-tf-dev-1.89.5/simba/video_processors/.DS_Store`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/video_processors/roi_selector_circle.py` & `Simba-UW-tf-dev-1.89.5/simba/video_processors/roi_selector_circle.py`

 * *Files 2% similar despite different names*

```diff
@@ -26,15 +26,15 @@
     :raises InvalidFileTypeError: If the file type is not supported.
     :raises CropWarning: If the selected ROI extends beyond the image boundaries or if the ROI radius equals zero.
 
     .. image:: _static/img/circle_crop_2.gif
        :width: 700
        :align: center
 
-    .. notes::
+    .. note::
        `Circle crop tutorial <https://github.com/sgoldenlab/simba/blob/master/docs/Tutorial_tools.md#circle-crop>`__.
 
     :example:
     >>> circle_selector = ROISelectorCircle(path='/Users/simon/Desktop/amber.png')
     >>> circle_selector.run()
     >>> circle_selector = ROISelectorCircle(path='/Users/simon/Desktop/Box2_IF19_7_20211109T173625_4_851_873_1_cropped.mp4')
     >>> circle_selector.run()
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/video_processors/px_to_mm.py` & `Simba-UW-tf-dev-1.89.5/simba/video_processors/px_to_mm.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/video_processors/batch_process_menus.py` & `Simba-UW-tf-dev-1.89.5/simba/video_processors/batch_process_menus.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/video_processors/multi_cropper.py` & `Simba-UW-tf-dev-1.89.5/simba/video_processors/multi_cropper.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/video_processors/extract_frames.py` & `Simba-UW-tf-dev-1.89.5/simba/video_processors/extract_frames.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/video_processors/roi_selector.py` & `Simba-UW-tf-dev-1.89.5/simba/video_processors/roi_selector.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/video_processors/calculate_px_dist.py` & `Simba-UW-tf-dev-1.89.5/simba/video_processors/calculate_px_dist.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/video_processors/roi_selector_polygon.py` & `Simba-UW-tf-dev-1.89.5/simba/video_processors/roi_selector_polygon.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/video_processors/extract_seqframes.py` & `Simba-UW-tf-dev-1.89.5/simba/video_processors/extract_seqframes.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/video_processors/batch_process_create_ffmpeg_commands.py` & `Simba-UW-tf-dev-1.89.5/simba/video_processors/batch_process_create_ffmpeg_commands.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/outlier_tools/outlier_corrector_movement.py` & `Simba-UW-tf-dev-1.89.5/simba/outlier_tools/outlier_corrector_movement.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/outlier_tools/outlier_corrector_location_advanced.py` & `Simba-UW-tf-dev-1.89.5/simba/outlier_tools/outlier_corrector_location_advanced.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/outlier_tools/skip_outlier_correction.py` & `Simba-UW-tf-dev-1.89.5/simba/outlier_tools/skip_outlier_correction.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/SimBA.py` & `Simba-UW-tf-dev-1.89.5/simba/SimBA.py`

 * *Files 0% similar despite different names*

```diff
@@ -1458,16 +1458,17 @@
         rf_model_runner = InferenceBatch(config_path=self.config_path)
         rf_model_runner.run()
 
     def trainmachinemodelsetting(self):
         _ = MachineModelSettingsPopUp(config_path=self.config_path)
 
     def run_feature_extraction(self):
+        print("Running feature extraction...")
         print(
-            f"Pose-estimation body part setting for feature extraction: {str(self.animal_cnt)} animals {str(self.pose_setting)} body-parts"
+            f"Pose-estimation body part setting for feature extraction: {str(self.animal_cnt)} animals {str(self.pose_setting)} body-parts..."
         )
         feature_extractor_classes = get_bp_config_code_class_pairs()
         if self.user_defined_var.get():
             custom_feature_extractor = CustomFeatureExtractor(
                 extractor_file_path=self.scriptfile.file_path,
                 config_path=self.config_path,
             )
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/unsupervised/model_names.parquet` & `Simba-UW-tf-dev-1.89.5/simba/assets/unsupervised/model_names.parquet`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/unsupervised/features.csv` & `Simba-UW-tf-dev-1.89.5/simba/assets/unsupervised/features.csv`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/shap/down_arrow.jpg` & `Simba-UW-tf-dev-1.89.5/simba/assets/shap/down_arrow.jpg`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/shap/intruder_shape.jpg` & `Simba-UW-tf-dev-1.89.5/simba/assets/shap/intruder_shape.jpg`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/shap/feature_categories/shap_feature_categories.csv` & `Simba-UW-tf-dev-1.89.5/simba/assets/shap/feature_categories/shap_feature_categories.csv`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/shap/resident_shape.jpg` & `Simba-UW-tf-dev-1.89.5/simba/assets/shap/resident_shape.jpg`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/shap/resident_intruder_shape.jpg` & `Simba-UW-tf-dev-1.89.5/simba/assets/shap/resident_intruder_shape.jpg`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/shap/animal_distances.jpg` & `Simba-UW-tf-dev-1.89.5/simba/assets/shap/animal_distances.jpg`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/shap/baseline_scale.jpg` & `Simba-UW-tf-dev-1.89.5/simba/assets/shap/baseline_scale.jpg`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/shap/ubuntu.regular.ttf` & `Simba-UW-tf-dev-1.89.5/simba/assets/shap/ubuntu.regular.ttf`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/shap/side_scale.jpg` & `Simba-UW-tf-dev-1.89.5/simba/assets/shap/side_scale.jpg`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/shap/UbuntuMono-Regular.ttf` & `Simba-UW-tf-dev-1.89.5/simba/assets/shap/UbuntuMono-Regular.ttf`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/shap/side_scale_5.jpg` & `Simba-UW-tf-dev-1.89.5/simba/assets/shap/side_scale_5.jpg`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/shap/intruder_movement.jpg` & `Simba-UW-tf-dev-1.89.5/simba/assets/shap/intruder_movement.jpg`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/shap/resident_movement.jpg` & `Simba-UW-tf-dev-1.89.5/simba/assets/shap/resident_movement.jpg`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/shap/color_bar.jpg` & `Simba-UW-tf-dev-1.89.5/simba/assets/shap/color_bar.jpg`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/shap/resident_intruder_movement.jpg` & `Simba-UW-tf-dev-1.89.5/simba/assets/shap/resident_intruder_movement.jpg`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/.DS_Store` & `Simba-UW-tf-dev-1.89.5/simba/assets/.DS_Store`

 * *Files 6% similar despite different names*

```diff
@@ -252,205 +252,205 @@
 00000fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001000: 0000 0000 0000 0000 0000 0020 0000 0005  ........... ....
 00001010: 0069 0063 006f 006e 0073 6277 7370 626c  .i.c.o.n.sbwspbl
-00001020: 6f62 0000 00b8 6270 6c69 7374 3030 d601  ob....bplist00..
+00001020: 6f62 0000 00b7 6270 6c69 7374 3030 d601  ob....bplist00..
 00001030: 0203 0405 0607 0807 080b 085d 5368 6f77  ...........]Show
 00001040: 5374 6174 7573 4261 725b 5368 6f77 546f  StatusBar[ShowTo
 00001050: 6f6c 6261 725b 5368 6f77 5461 6256 6965  olbar[ShowTabVie
 00001060: 775f 1014 436f 6e74 6169 6e65 7253 686f  w_..ContainerSho
 00001070: 7753 6964 6562 6172 5c57 696e 646f 7742  wSidebar\WindowB
 00001080: 6f75 6e64 735b 5368 6f77 5369 6465 6261  ounds[ShowSideba
-00001090: 7208 0908 095f 1018 7b7b 3238 392c 2033  r...._..{{289, 3
-000010a0: 3030 7d2c 207b 3932 302c 2034 3336 7d7d  00}, {920, 436}}
-000010b0: 0908 1523 2f3b 525f 6b6c 6d6e 6f8a 0000  ...#/;R_klmno...
-000010c0: 0000 0000 0101 0000 0000 0000 000d 0000  ................
-000010d0: 0000 0000 0000 0000 0000 0000 008b 0000  ................
-000010e0: 0005 0069 0063 006f 006e 0073 6c67 3153  ...i.c.o.n.slg1S
-000010f0: 636f 6d70 0000 0000 0009 1caa 0000 0005  comp............
-00001100: 0069 0063 006f 006e 0073 6c73 7643 626c  .i.c.o.n.slsvCbl
-00001110: 6f62 0000 0323 6270 6c69 7374 3030 da01  ob...#bplist00..
-00001120: 0203 0405 0607 0809 0a0b 0c0d 1a54 5554  .............TUT
-00001130: 560c 5858 6963 6f6e 5369 7a65 5f10 0f73  V.XXiconSize_..s
-00001140: 686f 7749 636f 6e50 7265 7669 6577 5763  howIconPreviewWc
-00001150: 6f6c 756d 6e73 5f10 1163 616c 6375 6c61  olumns_..calcula
-00001160: 7465 416c 6c53 697a 6573 5f10 0f73 6372  teAllSizes_..scr
-00001170: 6f6c 6c50 6f73 6974 696f 6e59 5874 6578  ollPositionYXtex
-00001180: 7453 697a 655f 100f 7363 726f 6c6c 506f  tSize_..scrollPo
-00001190: 7369 7469 6f6e 585a 736f 7274 436f 6c75  sitionXZsortColu
-000011a0: 6d6e 5f10 1075 7365 5265 6c61 7469 7665  mn_..useRelative
-000011b0: 4461 7465 735f 1012 7669 6577 4f70 7469  Dates_..viewOpti
-000011c0: 6f6e 7356 6572 7369 6f6e 2340 3000 0000  onsVersion#@0...
-000011d0: 0000 0009 ae0e 171c 2125 2a2f 3439 3d42  ........!%*/49=B
-000011e0: 464b 4fd4 0f10 1112 1314 0c0c 5a69 6465  FKO.........Zide
-000011f0: 6e74 6966 6965 7255 7769 6474 6859 6173  ntifierUwidthYas
-00001200: 6365 6e64 696e 6757 7669 7369 626c 6554  cendingWvisibleT
-00001210: 6e61 6d65 1101 2c09 09d4 0f10 1112 1819  name..,.........
-00001220: 1a1a 5875 6269 7175 6974 7910 2308 08d4  ..Xubiquity.#...
-00001230: 0f10 1112 1d1e 1a0c 5c64 6174 654d 6f64  ........\dateMod
-00001240: 6966 6965 6410 b508 09d4 0f10 1112 221e  ified.........".
-00001250: 1a1a 5b64 6174 6543 7265 6174 6564 0808  ..[dateCreated..
-00001260: d40f 1011 1226 271a 0c54 7369 7a65 1061  .....&'..Tsize.a
-00001270: 0809 d40f 1011 122b 2c0c 0c54 6b69 6e64  .......+,..Tkind
-00001280: 1073 0909 d40f 1011 1230 310c 1a55 6c61  .s.......01..Ula
-00001290: 6265 6c10 6409 08d4 0f10 1112 3536 0c1a  bel.d.......56..
-000012a0: 5776 6572 7369 6f6e 104b 0908 d40f 1011  Wversion.K......
-000012b0: 123a 140c 1a58 636f 6d6d 656e 7473 0908  .:...Xcomments..
-000012c0: d40f 1011 123e 3f1a 1a5e 6461 7465 4c61  .....>?..^dateLa
-000012d0: 7374 4f70 656e 6564 10c8 0808 d40f 1011  stOpened........
-000012e0: 1243 1e1a 1a59 6461 7465 4164 6465 6408  .C...YdateAdded.
-000012f0: 08d4 1210 110f 1a48 1a4a 0810 d208 5a73  .......H.J....Zs
-00001300: 6861 7265 4f77 6e65 72d4 1210 110f 1a48  hareOwner......H
-00001310: 1a4e 0808 5f10 0f73 6861 7265 4c61 7374  .N.._..shareLast
-00001320: 4564 6974 6f72 d412 1011 0f1a 481a 5208  Editor......H.R.
-00001330: 085f 1010 696e 7669 7461 7469 6f6e 5374  ._..invitationSt
-00001340: 6174 7573 0823 0000 0000 0000 0000 2340  atus.#........#@
-00001350: 2800 0000 0000 005c 6461 7465 4d6f 6469  (......\dateModi
-00001360: 6669 6564 0910 0100 0800 1d00 2600 3800  fied........&.8.
-00001370: 4000 5400 6600 6f00 8100 8c00 9f00 b400  @.T.f.o.........
-00001380: bd00 be00 cd00 d600 e100 e700 f100 f900  ................
-00001390: fe01 0101 0201 0301 0c01 1501 1701 1801  ................
-000013a0: 1901 2201 2f01 3101 3201 3301 3c01 4801  .."./.1.2.3.<.H.
-000013b0: 4901 4a01 5301 5801 5a01 5b01 5c01 6501  I.J.S.X.Z.[.\.e.
-000013c0: 6a01 6c01 6d01 6e01 7701 7d01 7f01 8001  j.l.m.n.w.}.....
-000013d0: 8101 8a01 9201 9401 9501 9601 9f01 a801  ................
-000013e0: a901 aa01 b301 c201 c401 c501 c601 cf01  ................
-000013f0: d901 da01 db01 e401 e501 e701 e801 f301  ................
-00001400: fc01 fd01 fe02 1002 1902 1a02 1b02 2e02  ................
-00001410: 2f02 3802 4102 4e02 4f00 0000 0000 0002  /.8.A.N.O.......
-00001420: 0100 0000 0000 0000 5900 0000 0000 0000  ........Y.......
-00001430: 0000 0000 0000 0002 5100 0000 0500 6900  ........Q.....i.
-00001440: 6300 6f00 6e00 736c 7376 7062 6c6f 6200  c.o.n.slsvpblob.
-00001450: 0002 9862 706c 6973 7430 30da 0102 0304  ...bplist00.....
-00001460: 0506 0708 090a 0b0c 0d1c 4748 4749 0c37  ..........GHGI.7
-00001470: 5869 636f 6e53 697a 655f 100f 7368 6f77  XiconSize_..show
-00001480: 4963 6f6e 5072 6576 6965 7757 636f 6c75  IconPreviewWcolu
-00001490: 6d6e 735f 1011 6361 6c63 756c 6174 6541  mns_..calculateA
-000014a0: 6c6c 5369 7a65 735f 100f 7363 726f 6c6c  llSizes_..scroll
-000014b0: 506f 7369 7469 6f6e 5958 7465 7874 5369  PositionYXtextSi
-000014c0: 7a65 5f10 0f73 6372 6f6c 6c50 6f73 6974  ze_..scrollPosit
-000014d0: 696f 6e58 5a73 6f72 7443 6f6c 756d 6e5f  ionXZsortColumn_
-000014e0: 1010 7573 6552 656c 6174 6976 6544 6174  ..useRelativeDat
-000014f0: 6573 5f10 1276 6965 774f 7074 696f 6e73  es_..viewOptions
-00001500: 5665 7273 696f 6e23 4030 0000 0000 0000  Version#@0......
-00001510: 09d9 0e0f 1011 1213 1415 1617 2025 2a2f  ............ %*/
-00001520: 3438 3d41 5863 6f6d 6d65 6e74 7355 6c61  48=AXcommentsUla
-00001530: 6265 6c57 7665 7273 696f 6e5b 6461 7465  belWversion[date
-00001540: 4372 6561 7465 6454 7369 7a65 5c64 6174  CreatedTsize\dat
-00001550: 654d 6f64 6966 6965 6454 6b69 6e64 546e  eModifiedTkindTn
-00001560: 616d 655e 6461 7465 4c61 7374 4f70 656e  ame^dateLastOpen
-00001570: 6564 d418 191a 1b1c 1d0c 1f57 7669 7369  ed.........Wvisi
-00001580: 626c 6555 7769 6474 6859 6173 6365 6e64  bleUwidthYascend
-00001590: 696e 6755 696e 6465 7808 1101 2c09 1007  ingUindex...,...
-000015a0: d418 191a 1b1c 220c 2408 1064 0910 05d4  ......".$..d....
-000015b0: 1819 1a1b 1c27 0c29 0810 4b09 1006 d418  .....'.)..K.....
-000015c0: 191a 1b1c 2c1c 2e08 10b5 0810 02d4 1819  ....,...........
-000015d0: 1a1b 0c31 1c33 0910 6108 1003 d418 191a  ...1.3..a.......
-000015e0: 1b0c 2c1c 3709 0810 01d4 1819 1a1b 0c3a  ..,.7..........:
-000015f0: 0c3c 0910 7309 1004 d418 191a 1b0c 1d0c  .<..s...........
-00001600: 4009 0910 00d4 1819 1a1b 1c43 1c45 0810  @..........C.E..
-00001610: c808 1008 0823 0000 0000 0000 0000 2340  .....#........#@
-00001620: 2800 0000 0000 005c 6461 7465 4d6f 6469  (......\dateModi
-00001630: 6669 6564 0900 0800 1d00 2600 3800 4000  fied......&.8.@.
-00001640: 5400 6600 6f00 8100 8c00 9f00 b400 bd00  T.f.o...........
-00001650: be00 d100 da00 e000 e800 f400 f901 0601  ................
-00001660: 0b01 1001 1f01 2801 3001 3601 4001 4601  ......(.0.6.@.F.
-00001670: 4701 4a01 4b01 4d01 5601 5701 5901 5a01  G.J.K.M.V.W.Y.Z.
-00001680: 5c01 6501 6601 6801 6901 6b01 7401 7501  \.e.f.h.i.k.t.u.
-00001690: 7701 7801 7a01 8301 8401 8601 8701 8901  w.x.z...........
-000016a0: 9201 9301 9401 9601 9f01 a001 a201 a301  ................
-000016b0: a501 ae01 af01 b001 b201 bb01 bc01 be01  ................
-000016c0: bf01 c101 c201 cb01 d401 e100 0000 0000  ................
-000016d0: 0002 0100 0000 0000 0000 4b00 0000 0000  ..........K.....
-000016e0: 0000 0000 0000 0000 0001 e200 0000 0500  ................
-000016f0: 6900 6300 6f00 6e00 736d 6f44 4462 6c6f  i.c.o.n.smoDDblo
-00001700: 6200 0000 0821 dad9 4897 c6c5 4100 0000  b....!..H...A...
-00001710: 0500 6900 6300 6f00 6e00 736d 6f64 4462  ..i.c.o.n.smodDb
-00001720: 6c6f 6200 0000 0821 dad9 4897 c6c5 4100  lob....!..H...A.
-00001730: 0000 0500 6900 6300 6f00 6e00 7370 6831  ....i.c.o.n.sph1
-00001740: 5363 6f6d 7000 0000 0000 0ba0 0000 0000  Scomp...........
-00001750: 0500 6900 6300 6f00 6e00 7376 5372 6e6c  ..i.c.o.n.svSrnl
-00001760: 6f6e 6700 0000 0100 0000 0300 6900 6d00  ong.........i.m.
-00001770: 676c 6731 5363 6f6d 7000 0000 0000 19a9  glg1Scomp.......
-00001780: 5e00 0000 0300 6900 6d00 676d 6f44 4462  ^.....i.m.gmoDDb
-00001790: 6c6f 6200 0000 0814 dc41 9f0a bac5 4100  lob......A....A.
-000017a0: 0000 0300 6900 6d00 676d 6f64 4462 6c6f  ....i.m.gmodDblo
-000017b0: 6200 0000 0814 dc41 9f0a bac5 4100 0000  b......A....A...
-000017c0: 0300 6900 6d00 6770 6831 5363 6f6d 7000  ..i.m.gph1Scomp.
-000017d0: 0000 0000 19e0 0000 0000 0700 6c00 6f00  ............l.o.
-000017e0: 6f00 6b00 7500 7000 7362 7773 7062 6c6f  o.k.u.p.sbwspblo
-000017f0: 6200 0000 b862 706c 6973 7430 30d6 0102  b....bplist00...
-00001800: 0304 0506 0708 0708 0b08 5d53 686f 7753  ..........]ShowS
-00001810: 7461 7475 7342 6172 5b53 686f 7754 6f6f  tatusBar[ShowToo
-00001820: 6c62 6172 5b53 686f 7754 6162 5669 6577  lbar[ShowTabView
-00001830: 5f10 1443 6f6e 7461 696e 6572 5368 6f77  _..ContainerShow
-00001840: 5369 6465 6261 725c 5769 6e64 6f77 426f  Sidebar\WindowBo
-00001850: 756e 6473 5b53 686f 7753 6964 6562 6172  unds[ShowSidebar
-00001860: 0809 0809 5f10 187b 7b32 3630 2c20 3332  ...._..{{260, 32
-00001870: 397d 2c20 7b39 3230 2c20 3433 367d 7d09  9}, {920, 436}}.
-00001880: 0815 232f 3b52 5f6b 6c6d 6e6f 8a00 0000  ..#/;R_klmno....
-00001890: 0000 0001 0100 0000 0000 0000 0d00 0000  ................
-000018a0: 0000 0000 0000 0000 0000 0000 8b00 0000  ................
-000018b0: 0700 6c00 6f00 6f00 6b00 7500 7000 736c  ..l.o.o.k.u.p.sl
-000018c0: 6731 5363 6f6d 7000 0000 0000 0502 b800  g1Scomp.........
-000018d0: 0000 0700 6c00 6f00 6f00 6b00 7500 7000  ....l.o.o.k.u.p.
-000018e0: 736d 6f44 4462 6c6f 6200 0000 083e 3494  smoDDblob....>4.
-000018f0: a30a bac5 4100 0000 0700 6c00 6f00 6f00  ....A.....l.o.o.
-00001900: 6b00 7500 7000 736d 6f64 4462 6c6f 6200  k.u.p.smodDblob.
-00001910: 0000 083e 3494 a30a bac5 4100 0000 0700  ...>4.....A.....
-00001920: 6c00 6f00 6f00 6b00 7500 7000 7370 6831  l.o.o.k.u.p.sph1
-00001930: 5363 6f6d 7000 0000 0000 0530 0000 0000  Scomp......0....
-00001940: 0700 6c00 6f00 6f00 6b00 7500 7000 7376  ..l.o.o.k.u.p.sv
-00001950: 5372 6e6c 6f6e 6700 0000 0100 0000 0400  Srnlong.........
-00001960: 7300 6800 6100 706c 6731 5363 6f6d 7000  s.h.a.plg1Scomp.
-00001970: 0000 0000 0906 c300 0000 0400 7300 6800  ............s.h.
-00001980: 6100 706d 6f44 4462 6c6f 6200 0000 0886  a.pmoDDblob.....
-00001990: 8aa4 a80a bac5 4100 0000 0400 7300 6800  ......A.....s.h.
-000019a0: 6100 706d 6f64 4462 6c6f 6200 0000 0886  a.pmodDblob.....
-000019b0: 8aa4 a80a bac5 4100 0000 0400 7300 6800  ......A.....s.h.
-000019c0: 6100 7070 6831 5363 6f6d 7000 0000 0000  a.pph1Scomp.....
-000019d0: 0990 0000 0000 0300 7300 7400 6c6c 6731  ........s.t.llg1
-000019e0: 5363 6f6d 7000 0000 0000 537f 6700 0000  Scomp.....S.g...
-000019f0: 0300 7300 7400 6c6d 6f44 4462 6c6f 6200  ..s.t.lmoDDblob.
-00001a00: 0000 0839 8bb9 ad0a bac5 4100 0000 0300  ...9......A.....
-00001a10: 7300 7400 6c6d 6f64 4462 6c6f 6200 0000  s.t.lmodDblob...
-00001a20: 0839 8bb9 ad0a bac5 4100 0000 0300 7300  .9......A.....s.
-00001a30: 7400 6c70 6831 5363 6f6d 7000 0000 0000  t.lph1Scomp.....
-00001a40: 53a0 0000 0000 0c00 7500 6e00 7300 7500  S.......u.n.s.u.
-00001a50: 7000 6500 7200 7600 6900 7300 6500 6462  p.e.r.v.i.s.e.db
-00001a60: 7773 7062 6c6f 6200 0000 b962 706c 6973  wspblob....bplis
-00001a70: 7430 30d6 0102 0304 0506 0708 0708 0b08  t00.............
-00001a80: 5d53 686f 7753 7461 7475 7342 6172 5b53  ]ShowStatusBar[S
-00001a90: 686f 7754 6f6f 6c62 6172 5b53 686f 7754  howToolbar[ShowT
-00001aa0: 6162 5669 6577 5f10 1443 6f6e 7461 696e  abView_..Contain
-00001ab0: 6572 5368 6f77 5369 6465 6261 725c 5769  erShowSidebar\Wi
-00001ac0: 6e64 6f77 426f 756e 6473 5b53 686f 7753  ndowBounds[ShowS
-00001ad0: 6964 6562 6172 0809 0809 5f10 197b 7b32  idebar...._..{{2
-00001ae0: 3630 2c20 3132 387d 2c20 7b31 3134 342c  60, 128}, {1144,
-00001af0: 2036 3338 7d7d 0908 1523 2f3b 525f 6b6c   638}}...#/;R_kl
-00001b00: 6d6e 6f8b 0000 0000 0000 0101 0000 0000  mno.............
-00001b10: 0000 000d 0000 0000 0000 0000 0000 0000  ................
-00001b20: 0000 008c 0000 000c 0075 006e 0073 0075  .........u.n.s.u
-00001b30: 0070 0065 0072 0076 0069 0073 0065 0064  .p.e.r.v.i.s.e.d
-00001b40: 6c67 3153 636f 6d70 0000 0000 0001 e30a  lg1Scomp........
-00001b50: 0000 000c 0075 006e 0073 0075 0070 0065  .....u.n.s.u.p.e
-00001b60: 0072 0076 0069 0073 0065 0064 6d6f 4444  .r.v.i.s.e.dmoDD
-00001b70: 626c 6f62 0000 0008 b583 0bb0 0aba c541  blob...........A
-00001b80: 0000 000c 0075 006e 0073 0075 0070 0065  .....u.n.s.u.p.e
-00001b90: 0072 0076 0069 0073 0065 0064 6d6f 6444  .r.v.i.s.e.dmodD
-00001ba0: 626c 6f62 0000 0008 b583 0bb0 0aba c541  blob...........A
-00001bb0: 0000 000c 0075 006e 0073 0075 0070 0065  .....u.n.s.u.p.e
-00001bc0: 0072 0076 0069 0073 0065 0064 7068 3153  .r.v.i.s.e.dph1S
-00001bd0: 636f 6d70 0000 0000 0001 f000 0000 000c  comp............
-00001be0: 0075 006e 0073 0075 0070 0065 0072 0076  .u.n.s.u.p.e.r.v
-00001bf0: 0069 0073 0065 0064 7653 726e 6c6f 6e67  .i.s.e.dvSrnlong
-00001c00: 0000 0001 0000 0000 0000 0000 0000 0000  ................
+00001090: 7208 0908 095f 1017 7b7b 3433 2c20 3834  r...._..{{43, 84
+000010a0: 7d2c 207b 3131 3830 2c20 3536 387d 7d09  }, {1180, 568}}.
+000010b0: 0815 232f 3b52 5f6b 6c6d 6e6f 8900 0000  ..#/;R_klmno....
+000010c0: 0000 0001 0100 0000 0000 0000 0d00 0000  ................
+000010d0: 0000 0000 0000 0000 0000 0000 8a00 0000  ................
+000010e0: 0500 6900 6300 6f00 6e00 736c 6731 5363  ..i.c.o.n.slg1Sc
+000010f0: 6f6d 7000 0000 0000 0934 ae00 0000 0500  omp......4......
+00001100: 6900 6300 6f00 6e00 736c 7376 4362 6c6f  i.c.o.n.slsvCblo
+00001110: 6200 0003 2362 706c 6973 7430 30da 0102  b...#bplist00...
+00001120: 0304 0506 0708 090a 0b0c 0d1a 5455 5456  ............TUTV
+00001130: 0c58 5869 636f 6e53 697a 655f 100f 7368  .XXiconSize_..sh
+00001140: 6f77 4963 6f6e 5072 6576 6965 7757 636f  owIconPreviewWco
+00001150: 6c75 6d6e 735f 1011 6361 6c63 756c 6174  lumns_..calculat
+00001160: 6541 6c6c 5369 7a65 735f 100f 7363 726f  eAllSizes_..scro
+00001170: 6c6c 506f 7369 7469 6f6e 5958 7465 7874  llPositionYXtext
+00001180: 5369 7a65 5f10 0f73 6372 6f6c 6c50 6f73  Size_..scrollPos
+00001190: 6974 696f 6e58 5a73 6f72 7443 6f6c 756d  itionXZsortColum
+000011a0: 6e5f 1010 7573 6552 656c 6174 6976 6544  n_..useRelativeD
+000011b0: 6174 6573 5f10 1276 6965 774f 7074 696f  ates_..viewOptio
+000011c0: 6e73 5665 7273 696f 6e23 4030 0000 0000  nsVersion#@0....
+000011d0: 0000 09ae 0e17 1c21 252a 2f34 393d 4246  .......!%*/49=BF
+000011e0: 4b4f d40f 1011 1213 140c 0c5a 6964 656e  KO.........Ziden
+000011f0: 7469 6669 6572 5577 6964 7468 5961 7363  tifierUwidthYasc
+00001200: 656e 6469 6e67 5776 6973 6962 6c65 546e  endingWvisibleTn
+00001210: 616d 6511 012c 0909 d40f 1011 1218 191a  ame..,..........
+00001220: 1a58 7562 6971 7569 7479 1023 0808 d40f  .Xubiquity.#....
+00001230: 1011 121d 1e1a 0c5c 6461 7465 4d6f 6469  .......\dateModi
+00001240: 6669 6564 10b5 0809 d40f 1011 1222 1e1a  fied........."..
+00001250: 1a5b 6461 7465 4372 6561 7465 6408 08d4  .[dateCreated...
+00001260: 0f10 1112 2627 1a0c 5473 697a 6510 6108  ....&'..Tsize.a.
+00001270: 09d4 0f10 1112 2b2c 0c0c 546b 696e 6410  ......+,..Tkind.
+00001280: 7309 09d4 0f10 1112 3031 0c1a 556c 6162  s.......01..Ulab
+00001290: 656c 1064 0908 d40f 1011 1235 360c 1a57  el.d.......56..W
+000012a0: 7665 7273 696f 6e10 4b09 08d4 0f10 1112  version.K.......
+000012b0: 3a14 0c1a 5863 6f6d 6d65 6e74 7309 08d4  :...Xcomments...
+000012c0: 0f10 1112 3e3f 1a1a 5e64 6174 654c 6173  ....>?..^dateLas
+000012d0: 744f 7065 6e65 6410 c808 08d4 0f10 1112  tOpened.........
+000012e0: 431e 1a1a 5964 6174 6541 6464 6564 0808  C...YdateAdded..
+000012f0: d412 1011 0f1a 481a 4a08 10d2 085a 7368  ......H.J....Zsh
+00001300: 6172 654f 776e 6572 d412 1011 0f1a 481a  areOwner......H.
+00001310: 4e08 085f 100f 7368 6172 654c 6173 7445  N.._..shareLastE
+00001320: 6469 746f 72d4 1210 110f 1a48 1a52 0808  ditor......H.R..
+00001330: 5f10 1069 6e76 6974 6174 696f 6e53 7461  _..invitationSta
+00001340: 7475 7308 2300 0000 0000 0000 0023 4028  tus.#........#@(
+00001350: 0000 0000 0000 5c64 6174 654d 6f64 6966  ......\dateModif
+00001360: 6965 6409 1001 0008 001d 0026 0038 0040  ied........&.8.@
+00001370: 0054 0066 006f 0081 008c 009f 00b4 00bd  .T.f.o..........
+00001380: 00be 00cd 00d6 00e1 00e7 00f1 00f9 00fe  ................
+00001390: 0101 0102 0103 010c 0115 0117 0118 0119  ................
+000013a0: 0122 012f 0131 0132 0133 013c 0148 0149  ."./.1.2.3.<.H.I
+000013b0: 014a 0153 0158 015a 015b 015c 0165 016a  .J.S.X.Z.[.\.e.j
+000013c0: 016c 016d 016e 0177 017d 017f 0180 0181  .l.m.n.w.}......
+000013d0: 018a 0192 0194 0195 0196 019f 01a8 01a9  ................
+000013e0: 01aa 01b3 01c2 01c4 01c5 01c6 01cf 01d9  ................
+000013f0: 01da 01db 01e4 01e5 01e7 01e8 01f3 01fc  ................
+00001400: 01fd 01fe 0210 0219 021a 021b 022e 022f  .............../
+00001410: 0238 0241 024e 024f 0000 0000 0000 0201  .8.A.N.O........
+00001420: 0000 0000 0000 0059 0000 0000 0000 0000  .......Y........
+00001430: 0000 0000 0000 0251 0000 0005 0069 0063  .......Q.....i.c
+00001440: 006f 006e 0073 6c73 7670 626c 6f62 0000  .o.n.slsvpblob..
+00001450: 0298 6270 6c69 7374 3030 da01 0203 0405  ..bplist00......
+00001460: 0607 0809 0a0b 0c0d 1c47 4847 490c 3758  .........GHGI.7X
+00001470: 6963 6f6e 5369 7a65 5f10 0f73 686f 7749  iconSize_..showI
+00001480: 636f 6e50 7265 7669 6577 5763 6f6c 756d  conPreviewWcolum
+00001490: 6e73 5f10 1163 616c 6375 6c61 7465 416c  ns_..calculateAl
+000014a0: 6c53 697a 6573 5f10 0f73 6372 6f6c 6c50  lSizes_..scrollP
+000014b0: 6f73 6974 696f 6e59 5874 6578 7453 697a  ositionYXtextSiz
+000014c0: 655f 100f 7363 726f 6c6c 506f 7369 7469  e_..scrollPositi
+000014d0: 6f6e 585a 736f 7274 436f 6c75 6d6e 5f10  onXZsortColumn_.
+000014e0: 1075 7365 5265 6c61 7469 7665 4461 7465  .useRelativeDate
+000014f0: 735f 1012 7669 6577 4f70 7469 6f6e 7356  s_..viewOptionsV
+00001500: 6572 7369 6f6e 2340 3000 0000 0000 0009  ersion#@0.......
+00001510: d90e 0f10 1112 1314 1516 1720 252a 2f34  ........... %*/4
+00001520: 383d 4158 636f 6d6d 656e 7473 556c 6162  8=AXcommentsUlab
+00001530: 656c 5776 6572 7369 6f6e 5b64 6174 6543  elWversion[dateC
+00001540: 7265 6174 6564 5473 697a 655c 6461 7465  reatedTsize\date
+00001550: 4d6f 6469 6669 6564 546b 696e 6454 6e61  ModifiedTkindTna
+00001560: 6d65 5e64 6174 654c 6173 744f 7065 6e65  me^dateLastOpene
+00001570: 64d4 1819 1a1b 1c1d 0c1f 5776 6973 6962  d.........Wvisib
+00001580: 6c65 5577 6964 7468 5961 7363 656e 6469  leUwidthYascendi
+00001590: 6e67 5569 6e64 6578 0811 012c 0910 07d4  ngUindex...,....
+000015a0: 1819 1a1b 1c22 0c24 0810 6409 1005 d418  .....".$..d.....
+000015b0: 191a 1b1c 270c 2908 104b 0910 06d4 1819  ....'.)..K......
+000015c0: 1a1b 1c2c 1c2e 0810 b508 1002 d418 191a  ...,............
+000015d0: 1b0c 311c 3309 1061 0810 03d4 1819 1a1b  ..1.3..a........
+000015e0: 0c2c 1c37 0908 1001 d418 191a 1b0c 3a0c  .,.7..........:.
+000015f0: 3c09 1073 0910 04d4 1819 1a1b 0c1d 0c40  <..s...........@
+00001600: 0909 1000 d418 191a 1b1c 431c 4508 10c8  ..........C.E...
+00001610: 0810 0808 2300 0000 0000 0000 0023 4028  ....#........#@(
+00001620: 0000 0000 0000 5c64 6174 654d 6f64 6966  ......\dateModif
+00001630: 6965 6409 0008 001d 0026 0038 0040 0054  ied......&.8.@.T
+00001640: 0066 006f 0081 008c 009f 00b4 00bd 00be  .f.o............
+00001650: 00d1 00da 00e0 00e8 00f4 00f9 0106 010b  ................
+00001660: 0110 011f 0128 0130 0136 0140 0146 0147  .....(.0.6.@.F.G
+00001670: 014a 014b 014d 0156 0157 0159 015a 015c  .J.K.M.V.W.Y.Z.\
+00001680: 0165 0166 0168 0169 016b 0174 0175 0177  .e.f.h.i.k.t.u.w
+00001690: 0178 017a 0183 0184 0186 0187 0189 0192  .x.z............
+000016a0: 0193 0194 0196 019f 01a0 01a2 01a3 01a5  ................
+000016b0: 01ae 01af 01b0 01b2 01bb 01bc 01be 01bf  ................
+000016c0: 01c1 01c2 01cb 01d4 01e1 0000 0000 0000  ................
+000016d0: 0201 0000 0000 0000 004b 0000 0000 0000  .........K......
+000016e0: 0000 0000 0000 0000 01e2 0000 0005 0069  ...............i
+000016f0: 0063 006f 006e 0073 6d6f 4444 626c 6f62  .c.o.n.smoDDblob
+00001700: 0000 0008 8eb0 1baf cce2 c541 0000 0005  ...........A....
+00001710: 0069 0063 006f 006e 0073 6d6f 6444 626c  .i.c.o.n.smodDbl
+00001720: 6f62 0000 0008 8eb0 1baf cce2 c541 0000  ob...........A..
+00001730: 0005 0069 0063 006f 006e 0073 7068 3153  ...i.c.o.n.sph1S
+00001740: 636f 6d70 0000 0000 000b c000 0000 0005  comp............
+00001750: 0069 0063 006f 006e 0073 7653 726e 6c6f  .i.c.o.n.svSrnlo
+00001760: 6e67 0000 0001 0000 0003 0069 006d 0067  ng.........i.m.g
+00001770: 6c67 3153 636f 6d70 0000 0000 0019 a95e  lg1Scomp.......^
+00001780: 0000 0003 0069 006d 0067 6d6f 4444 626c  .....i.m.gmoDDbl
+00001790: 6f62 0000 0008 14dc 419f 0aba c541 0000  ob......A....A..
+000017a0: 0003 0069 006d 0067 6d6f 6444 626c 6f62  ...i.m.gmodDblob
+000017b0: 0000 0008 14dc 419f 0aba c541 0000 0003  ......A....A....
+000017c0: 0069 006d 0067 7068 3153 636f 6d70 0000  .i.m.gph1Scomp..
+000017d0: 0000 0019 e000 0000 0007 006c 006f 006f  ...........l.o.o
+000017e0: 006b 0075 0070 0073 6277 7370 626c 6f62  .k.u.p.sbwspblob
+000017f0: 0000 00b8 6270 6c69 7374 3030 d601 0203  ....bplist00....
+00001800: 0405 0607 0807 080b 085d 5368 6f77 5374  .........]ShowSt
+00001810: 6174 7573 4261 725b 5368 6f77 546f 6f6c  atusBar[ShowTool
+00001820: 6261 725b 5368 6f77 5461 6256 6965 775f  bar[ShowTabView_
+00001830: 1014 436f 6e74 6169 6e65 7253 686f 7753  ..ContainerShowS
+00001840: 6964 6562 6172 5c57 696e 646f 7742 6f75  idebar\WindowBou
+00001850: 6e64 735b 5368 6f77 5369 6465 6261 7208  nds[ShowSidebar.
+00001860: 0908 095f 1018 7b7b 3236 302c 2033 3239  ..._..{{260, 329
+00001870: 7d2c 207b 3932 302c 2034 3336 7d7d 0908  }, {920, 436}}..
+00001880: 1523 2f3b 525f 6b6c 6d6e 6f8a 0000 0000  .#/;R_klmno.....
+00001890: 0000 0101 0000 0000 0000 000d 0000 0000  ................
+000018a0: 0000 0000 0000 0000 0000 008b 0000 0007  ................
+000018b0: 006c 006f 006f 006b 0075 0070 0073 6c67  .l.o.o.k.u.p.slg
+000018c0: 3153 636f 6d70 0000 0000 0005 02b8 0000  1Scomp..........
+000018d0: 0007 006c 006f 006f 006b 0075 0070 0073  ...l.o.o.k.u.p.s
+000018e0: 6d6f 4444 626c 6f62 0000 0008 3e34 94a3  moDDblob....>4..
+000018f0: 0aba c541 0000 0007 006c 006f 006f 006b  ...A.....l.o.o.k
+00001900: 0075 0070 0073 6d6f 6444 626c 6f62 0000  .u.p.smodDblob..
+00001910: 0008 3e34 94a3 0aba c541 0000 0007 006c  ..>4.....A.....l
+00001920: 006f 006f 006b 0075 0070 0073 7068 3153  .o.o.k.u.p.sph1S
+00001930: 636f 6d70 0000 0000 0005 3000 0000 0007  comp......0.....
+00001940: 006c 006f 006f 006b 0075 0070 0073 7653  .l.o.o.k.u.p.svS
+00001950: 726e 6c6f 6e67 0000 0001 0000 0004 0073  rnlong.........s
+00001960: 0068 0061 0070 6c67 3153 636f 6d70 0000  .h.a.plg1Scomp..
+00001970: 0000 0009 06c3 0000 0004 0073 0068 0061  ...........s.h.a
+00001980: 0070 6d6f 4444 626c 6f62 0000 0008 868a  .pmoDDblob......
+00001990: a4a8 0aba c541 0000 0004 0073 0068 0061  .....A.....s.h.a
+000019a0: 0070 6d6f 6444 626c 6f62 0000 0008 868a  .pmodDblob......
+000019b0: a4a8 0aba c541 0000 0004 0073 0068 0061  .....A.....s.h.a
+000019c0: 0070 7068 3153 636f 6d70 0000 0000 0009  .pph1Scomp......
+000019d0: 9000 0000 0003 0073 0074 006c 6c67 3153  .......s.t.llg1S
+000019e0: 636f 6d70 0000 0000 0053 7f67 0000 0003  comp.....S.g....
+000019f0: 0073 0074 006c 6d6f 4444 626c 6f62 0000  .s.t.lmoDDblob..
+00001a00: 0008 398b b9ad 0aba c541 0000 0003 0073  ..9......A.....s
+00001a10: 0074 006c 6d6f 6444 626c 6f62 0000 0008  .t.lmodDblob....
+00001a20: 398b b9ad 0aba c541 0000 0003 0073 0074  9......A.....s.t
+00001a30: 006c 7068 3153 636f 6d70 0000 0000 0053  .lph1Scomp.....S
+00001a40: a000 0000 000c 0075 006e 0073 0075 0070  .......u.n.s.u.p
+00001a50: 0065 0072 0076 0069 0073 0065 0064 6277  .e.r.v.i.s.e.dbw
+00001a60: 7370 626c 6f62 0000 00b9 6270 6c69 7374  spblob....bplist
+00001a70: 3030 d601 0203 0405 0607 0807 080b 085d  00.............]
+00001a80: 5368 6f77 5374 6174 7573 4261 725b 5368  ShowStatusBar[Sh
+00001a90: 6f77 546f 6f6c 6261 725b 5368 6f77 5461  owToolbar[ShowTa
+00001aa0: 6256 6965 775f 1014 436f 6e74 6169 6e65  bView_..Containe
+00001ab0: 7253 686f 7753 6964 6562 6172 5c57 696e  rShowSidebar\Win
+00001ac0: 646f 7742 6f75 6e64 735b 5368 6f77 5369  dowBounds[ShowSi
+00001ad0: 6465 6261 7208 0908 095f 1019 7b7b 3236  debar...._..{{26
+00001ae0: 302c 2031 3238 7d2c 207b 3131 3434 2c20  0, 128}, {1144, 
+00001af0: 3633 387d 7d09 0815 232f 3b52 5f6b 6c6d  638}}...#/;R_klm
+00001b00: 6e6f 8b00 0000 0000 0001 0100 0000 0000  no..............
+00001b10: 0000 0d00 0000 0000 0000 0000 0000 0000  ................
+00001b20: 0000 8c00 0000 0c00 7500 6e00 7300 7500  ........u.n.s.u.
+00001b30: 7000 6500 7200 7600 6900 7300 6500 646c  p.e.r.v.i.s.e.dl
+00001b40: 6731 5363 6f6d 7000 0000 0000 01e3 0a00  g1Scomp.........
+00001b50: 0000 0c00 7500 6e00 7300 7500 7000 6500  ....u.n.s.u.p.e.
+00001b60: 7200 7600 6900 7300 6500 646d 6f44 4462  r.v.i.s.e.dmoDDb
+00001b70: 6c6f 6200 0000 08b5 830b b00a bac5 4100  lob...........A.
+00001b80: 0000 0c00 7500 6e00 7300 7500 7000 6500  ....u.n.s.u.p.e.
+00001b90: 7200 7600 6900 7300 6500 646d 6f64 4462  r.v.i.s.e.dmodDb
+00001ba0: 6c6f 6200 0000 08b5 830b b00a bac5 4100  lob...........A.
+00001bb0: 0000 0c00 7500 6e00 7300 7500 7000 6500  ....u.n.s.u.p.e.
+00001bc0: 7200 7600 6900 7300 6500 6470 6831 5363  r.v.i.s.e.dph1Sc
+00001bd0: 6f6d 7000 0000 0000 01f0 0000 0000 0c00  omp.............
+00001be0: 7500 6e00 7300 7500 7000 6500 7200 7600  u.n.s.u.p.e.r.v.
+00001bf0: 6900 7300 6500 6476 5372 6e6c 6f6e 6700  i.s.e.dvSrnlong.
+00001c00: 0000 0100 0000 0000 0000 0000 0000 0000  ................
 00001c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -586,56 +586,56 @@
 00002490: 0100 0200 0000 0000 0100 0400 0000 0000  ................
 000024a0: 0100 0800 0000 0000 0100 1000 0000 0000  ................
 000024b0: 0100 2000 0000 0000 0100 4000 0000 0000  .. .......@.....
 000024c0: 0100 8000 0000 0000 0101 0000 0000 0000  ................
 000024d0: 0102 0000 0000 0000 0104 0000 0000 0000  ................
 000024e0: 0108 0000 0000 0000 0110 0000 0000 0000  ................
 000024f0: 0120 0000 0000 0000 0140 0000 0000 0000  . .......@......
-00002500: 0065 7273 696f 6e23 4030 0000 0000 0000  .ersion#@0......
-00002510: 09d9 0e0f 1011 1213 1415 1617 2025 2a2f  ............ %*/
-00002520: 3438 3d41 5863 6f6d 6d65 6e74 7355 6c61  48=AXcommentsUla
-00002530: 6265 6c57 7665 7273 696f 6e5b 6461 7465  belWversion[date
-00002540: 4372 6561 7465 6454 7369 7a65 5c64 6174  CreatedTsize\dat
-00002550: 654d 6f64 6966 6965 6454 6b69 6e64 546e  eModifiedTkindTn
-00002560: 616d 655e 6461 7465 4c61 7374 4f70 656e  ame^dateLastOpen
-00002570: 6564 d418 191a 1b1c 1d0c 1f57 7669 7369  ed.........Wvisi
-00002580: 626c 6555 7769 6474 6859 6173 6365 6e64  bleUwidthYascend
-00002590: 696e 6755 696e 6465 7808 1101 2c09 1007  ingUindex...,...
-000025a0: d418 191a 1b1c 220c 2408 1064 0910 05d4  ......".$..d....
-000025b0: 1819 1a1b 1c27 0c29 0810 4b09 1006 d418  .....'.)..K.....
-000025c0: 191a 1b1c 2c1c 2e08 10b5 0810 02d4 1819  ....,...........
-000025d0: 1a1b 0c31 1c33 0910 6108 1003 d418 191a  ...1.3..a.......
-000025e0: 1b0c 2c1c 3709 0810 01d4 1819 1a1b 0c3a  ..,.7..........:
-000025f0: 0c3c 0910 7309 1004 d418 191a 1b0c 1d0c  .<..s...........
-00002600: 4009 0910 00d4 1819 1a1b 1c43 1c45 0810  @..........C.E..
-00002610: c808 1008 0823 0000 0000 0000 0000 2340  .....#........#@
-00002620: 2800 0000 0000 005c 6461 7465 4d6f 6469  (......\dateModi
-00002630: 6669 6564 0900 0800 1d00 2600 3800 4000  fied......&.8.@.
-00002640: 5400 6600 6f00 8100 8c00 9f00 b400 bd00  T.f.o...........
-00002650: be00 d100 da00 e000 e800 f400 f901 0601  ................
-00002660: 0b01 1001 1f01 2801 3001 3601 4001 4601  ......(.0.6.@.F.
-00002670: 4701 4a01 4b01 4d01 5601 5701 5901 5a01  G.J.K.M.V.W.Y.Z.
-00002680: 5c01 6501 6601 6801 6901 6b01 7401 7501  \.e.f.h.i.k.t.u.
-00002690: 7701 7801 7a01 8301 8401 8601 8701 8901  w.x.z...........
-000026a0: 9201 9301 9401 9601 9f01 a001 a201 a301  ................
-000026b0: a501 ae01 af01 b001 b201 bb01 bc01 be01  ................
-000026c0: bf01 c101 c201 cb01 d401 e100 0000 0000  ................
-000026d0: 0002 0100 0000 0000 0000 4b00 0000 0000  ..........K.....
-000026e0: 0000 0000 0000 0000 0001 e200 0000 0500  ................
-000026f0: 6900 6300 6f00 6e00 736d 6f44 4462 6c6f  i.c.o.n.smoDDblo
-00002700: 6200 0000 0821 dad9 4897 c6c5 4100 0000  b....!..H...A...
-00002710: 0500 6900 6300 6f00 6e00 736d 6f64 4462  ..i.c.o.n.smodDb
-00002720: 6c6f 6200 0000 0821 dad9 4897 c6c5 4100  lob....!..H...A.
-00002730: 0000 0500 6900 6300 6f00 6e00 7370 6831  ....i.c.o.n.sph1
-00002740: 5363 6f6d 7000 0000 0000 0ba0 0000 0000  Scomp...........
-00002750: 0500 6900 6300 6f00 6e00 7376 5372 6e6c  ..i.c.o.n.svSrnl
-00002760: 6f6e 6700 0000 0100 0000 0300 6900 6d00  ong.........i.m.
-00002770: 676c 6731 5363 6f6d 7000 0000 0000 19a9  glg1Scomp.......
-00002780: 5e00 0000 0300 6900 6d00 676d 6f44 4462  ^.....i.m.gmoDDb
-00002790: 6c6f 6200 0000 0814 dc41 9f0a bac5 4100  lob......A....A.
-000027a0: 0000 0300 6900 6d00 676d 6f64 4462 6c6f  ....i.m.gmodDblo
-000027b0: 6200 0000 0814 dc41 9f0a bac5 4100 0000  b......A....A...
-000027c0: 0300 6900 6d00 6770 6831 5363 6f6d 7000  ..i.m.gph1Scomp.
-000027d0: 0000 0000 19e0 0000 0000 0700 6c00 6f00  ............l.o.
-000027e0: 6f00 6b00 7500 7000 7362 7773 7062 6c6f  o.k.u.p.sbwspblo
-000027f0: 6200 0000 b862 706c 6973 7430 30d6 0102  b....bplist00...
-00002800: 0304 0506                                ....
+00002500: 0072 7369 6f6e 2340 3000 0000 0000 0009  .rsion#@0.......
+00002510: d90e 0f10 1112 1314 1516 1720 252a 2f34  ........... %*/4
+00002520: 383d 4158 636f 6d6d 656e 7473 556c 6162  8=AXcommentsUlab
+00002530: 656c 5776 6572 7369 6f6e 5b64 6174 6543  elWversion[dateC
+00002540: 7265 6174 6564 5473 697a 655c 6461 7465  reatedTsize\date
+00002550: 4d6f 6469 6669 6564 546b 696e 6454 6e61  ModifiedTkindTna
+00002560: 6d65 5e64 6174 654c 6173 744f 7065 6e65  me^dateLastOpene
+00002570: 64d4 1819 1a1b 1c1d 0c1f 5776 6973 6962  d.........Wvisib
+00002580: 6c65 5577 6964 7468 5961 7363 656e 6469  leUwidthYascendi
+00002590: 6e67 5569 6e64 6578 0811 012c 0910 07d4  ngUindex...,....
+000025a0: 1819 1a1b 1c22 0c24 0810 6409 1005 d418  .....".$..d.....
+000025b0: 191a 1b1c 270c 2908 104b 0910 06d4 1819  ....'.)..K......
+000025c0: 1a1b 1c2c 1c2e 0810 b508 1002 d418 191a  ...,............
+000025d0: 1b0c 311c 3309 1061 0810 03d4 1819 1a1b  ..1.3..a........
+000025e0: 0c2c 1c37 0908 1001 d418 191a 1b0c 3a0c  .,.7..........:.
+000025f0: 3c09 1073 0910 04d4 1819 1a1b 0c1d 0c40  <..s...........@
+00002600: 0909 1000 d418 191a 1b1c 431c 4508 10c8  ..........C.E...
+00002610: 0810 0808 2300 0000 0000 0000 0023 4028  ....#........#@(
+00002620: 0000 0000 0000 5c64 6174 654d 6f64 6966  ......\dateModif
+00002630: 6965 6409 0008 001d 0026 0038 0040 0054  ied......&.8.@.T
+00002640: 0066 006f 0081 008c 009f 00b4 00bd 00be  .f.o............
+00002650: 00d1 00da 00e0 00e8 00f4 00f9 0106 010b  ................
+00002660: 0110 011f 0128 0130 0136 0140 0146 0147  .....(.0.6.@.F.G
+00002670: 014a 014b 014d 0156 0157 0159 015a 015c  .J.K.M.V.W.Y.Z.\
+00002680: 0165 0166 0168 0169 016b 0174 0175 0177  .e.f.h.i.k.t.u.w
+00002690: 0178 017a 0183 0184 0186 0187 0189 0192  .x.z............
+000026a0: 0193 0194 0196 019f 01a0 01a2 01a3 01a5  ................
+000026b0: 01ae 01af 01b0 01b2 01bb 01bc 01be 01bf  ................
+000026c0: 01c1 01c2 01cb 01d4 01e1 0000 0000 0000  ................
+000026d0: 0201 0000 0000 0000 004b 0000 0000 0000  .........K......
+000026e0: 0000 0000 0000 0000 01e2 0000 0005 0069  ...............i
+000026f0: 0063 006f 006e 0073 6d6f 4444 626c 6f62  .c.o.n.smoDDblob
+00002700: 0000 0008 8eb0 1baf cce2 c541 0000 0005  ...........A....
+00002710: 0069 0063 006f 006e 0073 6d6f 6444 626c  .i.c.o.n.smodDbl
+00002720: 6f62 0000 0008 8eb0 1baf cce2 c541 0000  ob...........A..
+00002730: 0005 0069 0063 006f 006e 0073 7068 3153  ...i.c.o.n.sph1S
+00002740: 636f 6d70 0000 0000 000b c000 0000 0005  comp............
+00002750: 0069 0063 006f 006e 0073 7653 726e 6c6f  .i.c.o.n.svSrnlo
+00002760: 6e67 0000 0001 0000 0003 0069 006d 0067  ng.........i.m.g
+00002770: 6c67 3153 636f 6d70 0000 0000 0019 a95e  lg1Scomp.......^
+00002780: 0000 0003 0069 006d 0067 6d6f 4444 626c  .....i.m.gmoDDbl
+00002790: 6f62 0000 0008 14dc 419f 0aba c541 0000  ob......A....A..
+000027a0: 0003 0069 006d 0067 6d6f 6444 626c 6f62  ...i.m.gmodDblob
+000027b0: 0000 0008 14dc 419f 0aba c541 0000 0003  ......A....A....
+000027c0: 0069 006d 0067 7068 3153 636f 6d70 0000  .i.m.gph1Scomp..
+000027d0: 0000 0019 e000 0000 0007 006c 006f 006f  ...........l.o.o
+000027e0: 006b 0075 0070 0073 6277 7370 626c 6f62  .k.u.p.sbwspblob
+000027f0: 0000 00b8 6270 6c69 7374 3030 d601 0203  ....bplist00....
+00002800: 0405 0607                                ....
```

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/lookups/model_names.parquet` & `Simba-UW-tf-dev-1.89.5/simba/assets/lookups/model_names.parquet`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/lookups/feature_extraction_headers.csv` & `Simba-UW-tf-dev-1.89.5/simba/assets/lookups/feature_extraction_headers.csv`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/lookups/critical_values_05.pickle` & `Simba-UW-tf-dev-1.89.5/simba/assets/lookups/critical_values_05.pickle`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/lookups/features.csv` & `Simba-UW-tf-dev-1.89.5/simba/assets/lookups/features.csv`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/lookups/unsupervised_example_x.csv` & `Simba-UW-tf-dev-1.89.5/simba/assets/lookups/unsupervised_example_x.csv`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/stl/operant_tray.stl` & `Simba-UW-tf-dev-1.89.5/simba/assets/stl/operant_tray.stl`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/stl/operant_lever.stl` & `Simba-UW-tf-dev-1.89.5/simba/assets/stl/operant_lever.stl`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/stl/operant_walls.stl` & `Simba-UW-tf-dev-1.89.5/simba/assets/stl/operant_walls.stl`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/stl/grid_floor.stl` & `Simba-UW-tf-dev-1.89.5/simba/assets/stl/grid_floor.stl`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/img/splash_2024.mp4` & `Simba-UW-tf-dev-1.89.5/simba/assets/img/splash_2024.mp4`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/img/bg_2024.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/img/bg_2024.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/img/about_me.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/img/about_me.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/img/splash.mp4` & `Simba-UW-tf-dev-1.89.5/simba/assets/img/splash.mp4`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/img/bg_2.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/img/bg_2.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/img/splash.pptx` & `Simba-UW-tf-dev-1.89.5/simba/assets/img/splash.pptx`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/img/bg.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/img/bg.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/UbuntuMono-Regular.ttf` & `Simba-UW-tf-dev-1.89.5/simba/assets/UbuntuMono-Regular.ttf`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/factory.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/factory.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/cluster.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/cluster.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/load.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/load.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/gif.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/gif.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/pose.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/pose.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/features.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/features.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/settings.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/settings.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/stopwatch.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/stopwatch.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/link.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/link.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/dash_simba.css` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/dash_simba.css`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/documentation.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/documentation.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/fps.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/fps.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/dimensionality_reduction.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/dimensionality_reduction.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/roi.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/roi.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/simba_logo_2.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/simba_logo_2.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/superimpose.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/superimpose.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/label.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/label.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/change.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/change.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/readthedocs_logo.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/readthedocs_logo.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/crop.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/crop.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/rotate.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/rotate.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/circle.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/circle.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/path.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/path.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/polygon.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/polygon.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/clip.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/clip.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/restart.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/restart.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/calipher.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/calipher.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/add_on.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/add_on.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/create.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/create.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/SimBA_logo.ico` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/SimBA_logo.ico`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/print.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/print.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/clf.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/clf.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/concat_icons/mosaic.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/concat_icons/mosaic.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/concat_icons/vertical.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/concat_icons/vertical.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/concat_icons/horizontal.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/concat_icons/horizontal.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/concat_icons/mixed_mosaic.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/concat_icons/mixed_mosaic.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/merge.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/merge.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/clean.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/clean.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/clf_2.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/clf_2.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/visualize.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/visualize.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/concat.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/concat.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/boris.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/boris.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/frames.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/frames.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/video.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/video.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/sample.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/sample.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/metrics.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/metrics.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/grey.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/grey.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/exit.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/exit.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/outlier.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/outlier.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/clahe.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/clahe.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/trash.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/trash.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/about.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/about.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/convert.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/convert.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/SimBA_logo.icns` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/SimBA_logo.icns`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/reorganize.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/reorganize.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/browse.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/browse.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/SimBA_logo.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/SimBA_logo.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/ethovision.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/ethovision.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/icons/close.png` & `Simba-UW-tf-dev-1.89.5/simba/assets/icons/close.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/dash_simba_base.css` & `Simba-UW-tf-dev-1.89.5/simba/assets/dash_simba_base.css`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/simba/assets/TheGoldenLab.PNG` & `Simba-UW-tf-dev-1.89.5/simba/assets/TheGoldenLab.PNG`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/Simba_UW_tf_dev.egg-info/PKG-INFO` & `Simba-UW-tf-dev-1.89.5/Simba_UW_tf_dev.egg-info/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: Simba-UW-tf-dev
-Version: 1.89.4
+Version: 1.89.5
 Summary: Toolkit for computer classification of behaviors in experimental animals
 Home-page: https://github.com/sgoldenlab/simba
 Author: Simon Nilsson, Jia Jie Choong, Sophia Hwang
 Author-email: sronilsson@gmail.com
 License: GNU Lesser General Public License v3 (LGPLv3)
 Platform: UNKNOWN
 Classifier: Programming Language :: Python :: 3
```

### Comparing `Simba-UW-tf-dev-1.89.4/Simba_UW_tf_dev.egg-info/SOURCES.txt` & `Simba-UW-tf-dev-1.89.5/Simba_UW_tf_dev.egg-info/SOURCES.txt`

 * *Files 2% similar despite different names*

```diff
@@ -14,14 +14,15 @@
 simba/__init__.py
 simba/requirements.txt
 simba/assets/.DS_Store
 simba/assets/TheGoldenLab.PNG
 simba/assets/UbuntuMono-Regular.ttf
 simba/assets/__init__.py
 simba/assets/dash_simba_base.css
+simba/assets/icons/.DS_Store
 simba/assets/icons/SimBA_logo.icns
 simba/assets/icons/SimBA_logo.ico
 simba/assets/icons/SimBA_logo.png
 simba/assets/icons/__init__.py
 simba/assets/icons/about.png
 simba/assets/icons/add_on.png
 simba/assets/icons/boris.png
@@ -328,20 +329,22 @@
 simba/roi_tools/ROI_size_standardizer.py
 simba/roi_tools/ROI_time_bin_calculator.py
 simba/roi_tools/ROI_zoom.py
 simba/roi_tools/__init__.py
 simba/sandbox/.DS_Store
 simba/sandbox/AmberFeatureExtractor.py.zip
 simba/sandbox/__init__.py
+simba/sandbox/abod.py
 simba/sandbox/add_body_part.py
 simba/sandbox/add_body_part.py.zip
 simba/sandbox/add_probability_cnt_features.py
 simba/sandbox/adjusted_rand_score.py
 simba/sandbox/amber_featurizer.py
 simba/sandbox/amber_tests.py
+simba/sandbox/batch_video_to_greyscale.py
 simba/sandbox/berger_parker.py
 simba/sandbox/biweight_midcorrelation.py
 simba/sandbox/calc_N_degree_direction_switches.py
 simba/sandbox/calinski_harabasz.py
 simba/sandbox/cochran_q.py
 simba/sandbox/cohens_kappa.py
 simba/sandbox/colinear_features.py
@@ -373,30 +376,35 @@
 simba/sandbox/grangercausalitytests.py
 simba/sandbox/graph_3d_plotter.py
 simba/sandbox/graph_creator.py
 simba/sandbox/grubbs_test.py
 simba/sandbox/hartley_fmax.py
 simba/sandbox/hausdorff.py
 simba/sandbox/heading.py
+simba/sandbox/horizontal_videos_concat.py
+simba/sandbox/isolation_forest.py
 simba/sandbox/joint_plotter.py
 simba/sandbox/lcs.py
 simba/sandbox/line_locate_point.py
 simba/sandbox/line_plot.py
+simba/sandbox/line_plot_plotly.py
 simba/sandbox/linear_fretchet.py
 simba/sandbox/linestring_path.py
 simba/sandbox/madmedianrule.py
 simba/sandbox/make_splash.py
 simba/sandbox/margalef_diversification_index.py
 simba/sandbox/mcnamar.py
 simba/sandbox/menhinicks_index.py
+simba/sandbox/mosaic.py
 simba/sandbox/multiframe_is_shape_covered.py
 simba/sandbox/multifrm_to_points.py
 simba/sandbox/mutual_exclusive.py
 simba/sandbox/outliers_tietjen.py
 simba/sandbox/paths.py
+simba/sandbox/pct_counts_in_top_N.py
 simba/sandbox/peaks.py
 simba/sandbox/piotr_120324 2.py.zip
 simba/sandbox/piotr_120324 3.py.zip
 simba/sandbox/piotr_120324 4.py.zip
 simba/sandbox/piotr_120324.py
 simba/sandbox/piotr_120324.py.zip
 simba/sandbox/read_in_mp.py
@@ -408,26 +416,31 @@
 simba/sandbox/runs_test.py
 simba/sandbox/sequential_lag_analysis.py
 simba/sandbox/shannon_diversity_index.py
 simba/sandbox/siegel_tukey.py
 simba/sandbox/silhouette_score.py
 simba/sandbox/simpson_diversity_index.py
 simba/sandbox/slide_circ_mean.py
+simba/sandbox/sliding_autoc.py
+simba/sandbox/sliding_crosscorrelation.py
 simba/sandbox/sliding_displacement.py
 simba/sandbox/spontaneous_alternation_calculator.py
 simba/sandbox/spontaneuous_alternation_plotter.py
 simba/sandbox/spontanous_alternations.py
 simba/sandbox/statistics_ex.py
 simba/sandbox/termite_rois.csv
 simba/sandbox/time_stamp_calculator.py
 simba/sandbox/total_variation_distance.py
 simba/sandbox/train_model.py
-simba/sandbox/two_fish_feature_extractor_040324.py
+simba/sandbox/two_fish_feature_extractor_040924.py
+simba/sandbox/two_fish_feature_extractor_040924.py.zip
 simba/sandbox/unsupervised_lof.py
+simba/sandbox/unsupervised_outliers.py
 simba/sandbox/velocity_aggregator.py
+simba/sandbox/vertical_video_concatenator.py
 simba/sandbox/video_color.py
 simba/sandbox/video_rotator.py
 simba/sandbox/video_rotator_mp.py
 simba/sandbox/wald_wolfowitz.py
 simba/sandbox/wilcoxon.py
 simba/third_party_label_appenders/.DS_Store
 simba/third_party_label_appenders/BENTO_appender.py
```

### Comparing `Simba-UW-tf-dev-1.89.4/Simba_UW_tf_dev.egg-info/requires.txt` & `Simba-UW-tf-dev-1.89.5/Simba_UW_tf_dev.egg-info/requires.txt`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/LICENSE` & `Simba-UW-tf-dev-1.89.5/LICENSE`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/tests/test_data_processors.py` & `Simba-UW-tf-dev-1.89.5/tests/test_data_processors.py`

 * *Files 2% similar despite different names*

```diff
@@ -70,11 +70,8 @@
 
 @pytest.mark.parametrize("config_path, bin_length, plots, body_parts", [('tests/data/test_projects/two_c57/project_folder/project_config.ini', 10, True, ['Nose_1', 'Nose_2'])])
 def test_time_bins_movement_calculator_use_case(config_path, bin_length, plots, body_parts):
     calculator = TimeBinsMovementCalculator(config_path=config_path,
                                             bin_length=bin_length,
                                             plots=plots,
                                             body_parts=body_parts)
-    calculator.run()
-    assert os.path.isfile(calculator.save_path); os.remove(calculator.save_path)
-    if plots:
-        assert os.path.isfile(calculator.plot_save_path); os.remove(calculator.plot_save_path)
+    calculator.run()
```

### Comparing `Simba-UW-tf-dev-1.89.4/tests/test_circlular_stats.py` & `Simba-UW-tf-dev-1.89.5/tests/test_circlular_stats.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/tests/test_stats.py` & `Simba-UW-tf-dev-1.89.5/tests/test_stats.py`

 * *Files 0% similar despite different names*

```diff
@@ -165,15 +165,15 @@
 def test_local_outlier_factor(sample_data, expected_results, sample_data_dir):
     data_path = os.path.join(sample_data_dir, sample_data)
     data = np.load(data_path)
     results = Statistics().local_outlier_factor(data=data, k=5)
     assert results.shape == expected_results
     assert np.issubdtype(results.dtype, np.number)
 
-@pytest.mark.skipif(IN_GITHUB_ACTIONS, reason="descretizier .")
+@pytest.mark.skipif(IN_GITHUB_ACTIONS, reason="descretizier.")
 @pytest.mark.parametrize('sample_data, expected_results', [('8x100_f32.npy', (8, ))])
 def test_hbos(sample_data, expected_results, sample_data_dir):
     data_path = os.path.join(sample_data_dir, sample_data)
     data = np.load(data_path)
     results = Statistics().hbos(data=data)
     assert results.shape == expected_results
     assert np.issubdtype(results.dtype, np.number)
```

### Comparing `Simba-UW-tf-dev-1.89.4/tests/test_distance_plotter.py` & `Simba-UW-tf-dev-1.89.5/tests/test_distance_plotter.py`

 * *Files 1% similar despite different names*

```diff
@@ -52,15 +52,15 @@
     def opacity_args(self, request):
         return request
 
     @pytest.fixture(params=[1])
     def core_cnt_args(self, request):
         return request
 
-    @pytest.fixture(params=[{0: ['Center_1', 'Center_2', 'Green'], 1: ['Ear_left_2', 'Ear_left_1', 'Red']}])
+    @pytest.fixture(params=[['Center_1', 'Center_2', 'Green'],['Ear_left_2', 'Ear_left_1', 'Red']])
     def line_attr_args(self, request):
         return request
 
     def test_distance_plotter_single_core(self,
                                           data_path_args,
                                           config_path_args,
                                           width_args,
@@ -77,15 +77,15 @@
         style_attr = {'width': width_args.param, 'height': height_args.param, 'line width': line_width_args.param, 'font size': font_size_args.param, 'y_max': y_max_args.param, 'opacity': opacity_args.param}
 
         distance_plotter = DistancePlotterSingleCore(config_path=config_path_args.param,
                                                      frame_setting=False,
                                                      video_setting=True,
                                                      style_attr=style_attr,
                                                      final_img=True,
-                                                     files_found=data_path_args.param,
+                                                     data_paths=data_path_args.param,
                                                      line_attr=line_attr_args.param)
         distance_plotter.run()
 
     @pytest.mark.skipif(IN_GITHUB_ACTIONS, reason="LONG RUNNING TIME.")
     def test_distance_plotter_single_multicore(self,
                                                core_cnt_args,
                                                data_path_args,
```

### Comparing `Simba-UW-tf-dev-1.89.4/tests/test_train_model_mixin.py` & `Simba-UW-tf-dev-1.89.5/tests/test_train_model_mixin.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/tests/test_feature_extraction_mixin.py` & `Simba-UW-tf-dev-1.89.5/tests/test_feature_extraction_mixin.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/tests/test_utils_data.py` & `Simba-UW-tf-dev-1.89.5/tests/test_utils_data.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/tests/test_config_reader_mixin.py` & `Simba-UW-tf-dev-1.89.5/tests/test_config_reader_mixin.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/tests/test_outlier_correctors.py` & `Simba-UW-tf-dev-1.89.5/tests/test_outlier_correctors.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/tests/test_visualize_directing_animals.py` & `Simba-UW-tf-dev-1.89.5/tests/test_visualize_directing_animals.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/tests/test_featurizers.py` & `Simba-UW-tf-dev-1.89.5/tests/test_featurizers.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/tests/test_video_processors.py` & `Simba-UW-tf-dev-1.89.5/tests/test_video_processors.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/tests/test_thirdparty_appenders.py` & `Simba-UW-tf-dev-1.89.5/tests/test_thirdparty_appenders.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/tests/test_validation_clips.py` & `Simba-UW-tf-dev-1.89.5/tests/test_validation_clips.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/tests/test_roi_tools.py` & `Simba-UW-tf-dev-1.89.5/tests/test_roi_tools.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/README.md` & `Simba-UW-tf-dev-1.89.5/README.md`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.89.4/setup.py` & `Simba-UW-tf-dev-1.89.5/setup.py`

 * *Files 1% similar despite different names*

```diff
@@ -13,15 +13,15 @@
 with open("requirements.txt", "r") as f:
     requirements = f.read().splitlines()
 
 exclusion_patterns = ["pose_configurations_archive"]
 
 setuptools.setup(
     name="Simba-UW-tf-dev",
-    version="1.89.4",
+    version="1.89.5",
     author="Simon Nilsson, Jia Jie Choong, Sophia Hwang",
     author_email="sronilsson@gmail.com",
     description="Toolkit for computer classification of behaviors in experimental animals",
     long_description=long_description,
     long_description_content_type="text/markdown",
     url="https://github.com/sgoldenlab/simba",
     install_requires=requirements,
```

